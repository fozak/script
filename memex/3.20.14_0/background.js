/*! For license information please see background.js.LICENSE.txt */
!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1274)}([,,function(e,t,n){(function(n){var r,i,o,s,a,c,l,u,d,h,f,p,g,m,y,v,b,_,w,T,E,A,S,O,I;!function(){var C="object"==typeof n?n:"object"==typeof self?self:"object"==typeof this?this:{};function k(e,t){return e!==C&&("function"==typeof Object.create?Object.defineProperty(e,"__esModule",{value:!0}):e.__esModule=!0),function(n,r){return e[n]=t?t(n,r):r}}r=function(e){!function(e){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])};i=function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)},o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},a=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},c=function(e,t){return function(n,r){t(n,r,e)}},l=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},u=function(e,t,n,r){function i(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function a(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):i(e.value).then(s,a)}c((r=r.apply(e,t||[])).next())}))},d=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return c([e,t])}}function c(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},h=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||I(t,e,n)},I=Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]},f=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},p=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s},g=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e},m=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r},y=function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e},v=function(e){return this instanceof v?(this.v=e,this):new v(e)},b=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){o.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{c(i[e](t))}catch(e){d(o[0][3],e)}}function c(e){e.value instanceof v?Promise.resolve(e.value.v).then(l,u):d(o[0][2],e)}function l(e){a("next",e)}function u(e){a("throw",e)}function d(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}},_=function(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:v(e[r](t)),done:"return"===r}:i?i(t):t}:i}},w=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=f(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){i(r,o,(t=e[n](t)).done,t.value)}))}}function i(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)}},T=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};var n=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};E=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&I(t,e,r);return n(t,e),t},A=function(e){return e&&e.__esModule?e:{default:e}},S=function(e,t,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},O=function(e,t,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},e("__extends",i),e("__assign",o),e("__rest",s),e("__decorate",a),e("__param",c),e("__metadata",l),e("__awaiter",u),e("__generator",d),e("__exportStar",h),e("__createBinding",I),e("__values",f),e("__read",p),e("__spread",g),e("__spreadArrays",m),e("__spreadArray",y),e("__await",v),e("__asyncGenerator",b),e("__asyncDelegator",_),e("__asyncValues",w),e("__makeTemplateObject",T),e("__importStar",E),e("__importDefault",A),e("__classPrivateFieldGet",S),e("__classPrivateFieldSet",O)}(k(C,k(e)))}.apply(t,[t]),void 0===r||(e.exports=r)}()}).call(this,n(61))},function(e,t,n){var r,i,o;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,i=[e],r=function(e){"use strict";if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)e.exports=globalThis.browser;else{const t="The message port closed before a response was received.",n=e=>{const n={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(n).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class r extends WeakMap{constructor(e,t=void 0){super(t),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const i=e=>e&&"object"==typeof e&&"function"==typeof e.then,o=(t,n)=>(...r)=>{e.runtime.lastError?t.reject(new Error(e.runtime.lastError.message)):n.singleCallbackArg||r.length<=1&&!1!==n.singleCallbackArg?t.resolve(r[0]):t.resolve(r)},s=e=>1==e?"argument":"arguments",a=(e,t)=>function(n,...r){if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${s(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${s(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((i,s)=>{if(t.fallbackToNoCallback)try{n[e](...r,o({resolve:i,reject:s},t))}catch(o){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,o),n[e](...r),t.fallbackToNoCallback=!1,t.noCallback=!0,i()}else t.noCallback?(n[e](...r),i()):n[e](...r,o({resolve:i,reject:s},t))}))},c=(e,t,n)=>new Proxy(t,{apply:(t,r,i)=>n.call(r,e,...i)});let l=Function.call.bind(Object.prototype.hasOwnProperty);const u=(e,t={},n={})=>{let r=Object.create(null),i={has:(t,n)=>n in e||n in r,get(i,o,s){if(o in r)return r[o];if(!(o in e))return;let d=e[o];if("function"==typeof d)if("function"==typeof t[o])d=c(e,e[o],t[o]);else if(l(n,o)){let t=a(o,n[o]);d=c(e,e[o],t)}else d=d.bind(e);else if("object"==typeof d&&null!==d&&(l(t,o)||l(n,o)))d=u(d,t[o],n[o]);else{if(!l(n,"*"))return Object.defineProperty(r,o,{configurable:!0,enumerable:!0,get:()=>e[o],set(t){e[o]=t}}),d;d=u(d,t[o],n["*"])}return r[o]=d,d},set:(t,n,i,o)=>(n in r?r[n]=i:e[n]=i,!0),defineProperty:(e,t,n)=>Reflect.defineProperty(r,t,n),deleteProperty:(e,t)=>Reflect.deleteProperty(r,t)},o=Object.create(e);return new Proxy(o,i)},d=e=>({addListener(t,n,...r){t.addListener(e.get(n),...r)},hasListener:(t,n)=>t.hasListener(e.get(n)),removeListener(t,n){t.removeListener(e.get(n))}}),h=new r((e=>"function"!=typeof e?e:function(t){const n=u(t,{},{getContent:{minArgs:0,maxArgs:0}});e(n)})),f=new r((e=>"function"!=typeof e?e:function(t,n,r){let o,s,a=!1,c=new Promise((e=>{o=function(t){a=!0,e(t)}}));try{s=e(t,n,o)}catch(e){s=Promise.reject(e)}const l=!0!==s&&i(s);if(!0!==s&&!l&&!a)return!1;const u=e=>{e.then((e=>{r(e)}),(e=>{let t;t=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",r({__mozWebExtensionPolyfillReject__:!0,message:t})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)}))};return u(l?s:c),!0})),p=({reject:n,resolve:r},i)=>{e.runtime.lastError?e.runtime.lastError.message===t?r():n(new Error(e.runtime.lastError.message)):i&&i.__mozWebExtensionPolyfillReject__?n(new Error(i.message)):r(i)},g=(e,t,n,...r)=>{if(r.length<t.minArgs)throw new Error(`Expected at least ${t.minArgs} ${s(t.minArgs)} for ${e}(), got ${r.length}`);if(r.length>t.maxArgs)throw new Error(`Expected at most ${t.maxArgs} ${s(t.maxArgs)} for ${e}(), got ${r.length}`);return new Promise(((e,t)=>{const i=p.bind(null,{resolve:e,reject:t});r.push(i),n.sendMessage(...r)}))},m={devtools:{network:{onRequestFinished:d(h)}},runtime:{onMessage:d(f),onMessageExternal:d(f),sendMessage:g.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:g.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},y={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return n.privacy={network:{"*":y},services:{"*":y},websites:{"*":y}},u(e,m,n)};e.exports=n(chrome)}},void 0===(o="function"==typeof r?r.apply(t,i):r)||(e.exports=o)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"i",(function(){return y})),n.d(t,"j",(function(){return v})),n.d(t,"f",(function(){return b})),n.d(t,"k",(function(){return _})),n.d(t,"l",(function(){return w})),n.d(t,"m",(function(){return T})),n.d(t,"h",(function(){return E})),n.d(t,"n",(function(){return S})),n.d(t,"e",(function(){return O})),n.d(t,"d",(function(){return I})),n.d(t,"b",(function(){return C})),n.d(t,"g",(function(){return x})),n.d(t,"c",(function(){return D})),n.d(t,"o",(function(){return j}));var r=n(2),i=n(277),o=n.n(i),s=n(3),a=n.n(s),c=n(53),l=n(157),u=n.n(l),d=n(238),h=n.n(d);const f=(e,t)=>({headers:{type:"RPC_REQUEST",id:h()(),name:e.name,tabId:e.tabId,proxy:e.proxy,originSide:e.originSide,recipientSide:e.recipientSide},payload:t});var p=n(130);class g{constructor(e){this.deps=e,this.log=(e,t)=>{(!0===this.deps.debug||globalThis["memex-rpc-debug"])&&(e=`RPC::side=${this.deps.sideName}::`+e,console.log(e,null!=t?t:{}))},this.postMessageRequestToBackground=(e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=f({name:e,originSide:this.deps.sideName,recipientSide:"background"},t);return this.postMessageRequestToRPC(n)})),this.postMessageRequestToContentScript=(e,t,n)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=f({name:t,tabId:e,originSide:this.deps.sideName,recipientSide:"content-script-global"},n);return this.postMessageRequestToRPC(r)})),this.postMessageRequestToCSViaBG=(e,t,n)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=f({tabId:e,name:t,proxy:"background",originSide:this.deps.sideName,recipientSide:"background"},n);return this.postMessageRequestToRPC(r)})),this.messageResponder=(e,t,n)=>{if(e[C])return!0;const{headers:i,payload:o,error:s,serializedError:a}=e,{id:c,name:l,type:u}=i,d=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var r,s;if("RPC_REQUEST"===u){if(this.log(`messageResponder:: REQUEST received for [${l}]:`,e),this.deps.sideName!==e.headers.recipientSide)return void this.log(`messageResponder:: REQUEST ignored for [${l}] - wrong recipient:`,e);if("background"===i.proxy)yield this.postMessageRequestToContentScript(i.tabId,l,o);else{const i=this.deps.getRegisteredRemoteFunction(l);if(!i)throw console.error({side:this.deps.sideName,packet:e}),Error(`No registered remote function called ${l}`);Object.defineProperty(i,"name",{value:l}),this.log(`messageResponder:: RUNNING Function [${l}]`);let a=null!==(r=t.tab)&&void 0!==r?r:null!=e.headers.tabId?yield null===(s=this.deps.browserAPIs.tabs)||void 0===s?void 0:s.get(e.headers.tabId):void 0;a=Object(p.b)(a);try{const t=yield i({tab:a},...o);this.log(`messageResponder:: FINISHED Function [${l}]`,t);const r=(e=>{const{request:{headers:t}}=e;return{headers:{type:"RPC_RESPONSE",id:t.id,name:t.name,originSide:e.originSide,recipientSide:e.recipientSide},payload:e.payload,error:e.error,serializedError:e.serializedError}})({request:e,payload:t,originSide:this.deps.sideName,recipientSide:e.headers.originSide});n(r)}catch(e){throw this.log(`messageResponder:: ERRORED Function [${l}]`),new m(e)}}}else"RPC_RESPONSE"===u&&this.log(`messageResponder:: RESPONSE received for [${l}]`)}));return this.paused?this.paused.then(d):d(),!0},this.setup=()=>{this.deps.browserAPIs.runtime.onMessage.addListener(this.messageResponder)},this.unpause=()=>{const e=this.paused;delete this.paused,null==e||e.resolve()},e.initPaused&&(this.paused=u()())}postMessageRequestToRPC(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t;this.log(`messageRequester:: Requested for [${e.headers.name}]`,{request:e});try{t="background"===this.deps.sideName?yield this.deps.browserAPIs.tabs.sendMessage(e.headers.tabId,e):yield this.deps.browserAPIs.runtime.sendMessage(e)}catch(e){throw new m(e)}return this.log(`messageRequester:: Got response for [${e.headers.name}]`,t.payload),t.payload}))}}class m extends Error{constructor(e){super(e.message),this.name=this.constructor.name,this.message=e.message,this.stack=e.stack,this.cause=e.cause}}function y(e){return{withExtraArgs:!0,function:e}}function v(e){return{withExtraArgs:!1,function:e}}function b(e){for(const[t,n]of Object.entries(e)){const e=n;I({[t]:e.function},{insertExtraArg:e.withExtraArgs})}}function _(){return new Proxy({},{get(e,t){return(...e)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!N)throw new Error(`runInBackground: RPC connection has not been setup.\nfn name: ${t.toString()}\nargs: ${e}\n\nIf you are calling direct from content-script code, instead pass it down from the global content-script.\n`);return N.postMessageRequestToBackground(t.toString(),e)}))}})}function w(e,t){return new Proxy({},{get:(n,r)=>(...n)=>N.postMessageRequestToContentScript(e,r.toString(),n,t)})}function T(e){return new Proxy({},{get:(t,n)=>(...t)=>N.postMessageRequestToCSViaBG(e,n.toString(),t)})}function E(e,{tabId:t}={}){return t?(...n)=>N.postMessageRequestToContentScript(t,e,n):(...t)=>N.postMessageRequestToBackground(e,t)}const A="undefined"!=typeof globalThis&&globalThis.remoteFunctions||{};function S(e){for(const[t,n]of Object.entries(e))O(n)}function O(e,{insertExtraArg:t=!1}={}){return I(e,{insertExtraArg:t})}function I(e,{insertExtraArg:t=!1}={}){if(!t){e=o()((e=>(t,...n)=>e(...n)))(e)}for(const t of Object.keys(e))if(A.hasOwnProperty(t)){const e=`RPC function with name ${t} has already been registered `;console.warn(e)}Object.assign(A,e)}"undefined"!=typeof globalThis&&(globalThis.remoteFunctions=A);const C="__REMOTE_EVENT__",k="__REMOTE_EVENT_TYPE__",P="__REMOTE_EVENT_NAME__";function x(e,{broadcastToTabs:t=!1,silenceBroadcastFailures:n=!1}={}){const i={__REMOTE_EVENT__:C,[k]:e};return{emit:t?(t,...o)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var r;const s=null!==(r=yield a.a.tabs.query({}))&&void 0!==r?r:[];for(const{id:r}of s)try{yield a.a.tabs.sendMessage(r,Object.assign(Object.assign({},i),{[P]:t,data:o[0]}))}catch(i){n||console.error(`Remote event emitter "${e}" failed to emit event "${String(t)}" to tab ${r}:\n\tError message: "${i.message}"`)}})):(t,...n)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){try{yield a.a.runtime.sendMessage(Object.assign(Object.assign({},i),{[P]:t,data:n[0]}))}catch(n){let r=["A listener indicated an asynchronous response by returning true, but the message channel closed before a response was received","Could not establish connection."];n.message.includes(r[0])||n.message.includes(r[1])||console.error(`Remote event emitter "${e}" failed to emit event "${String(t)}":\n\tError message: "${n.message}"`)}})),emitToTab:(t,n,...o)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){try{yield a.a.tabs.sendMessage(n,Object.assign(Object.assign({},i),{[P]:t,data:o[0]}))}catch(r){console.error(`Remote event emitter "${e}" failed to emit event "${String(t)}" to tab ${n}:\n\tError message: "${r.message}"`)}}))}}const R={};const L=(e,t)=>{if(null==e||e[C]!==C)return!1;const n=e[k],r=R[n];if(null==r)return!1;r.emit(e[P],e.data)};function D(e){const t=R[e];if(t)return t;const n=new c.EventEmitter;return R[e]=n,a.a.runtime.onMessage.hasListener(L)||a.a.runtime.onMessage.addListener(L),n}let N;const j=e=>(N=new g({getRegisteredRemoteFunction:e=>A[e],browserAPIs:e.browserAPIs,initPaused:e.paused,sideName:e.sideName,role:e.role}),N.setup(),N)},,,,,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.PROTECTED=0]="PROTECTED",e[e.PRIVATE=100]="PRIVATE",e[e.SHARED=200]="SHARED",e[e.SHARED_PROTECTED=300]="SHARED_PROTECTED"}(r||(r={}))},,,,,function(e,t,n){(function(e){e.exports=function(){"use strict";var t,n;function r(){return t.apply(null,arguments)}function i(e){t=e}function o(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function s(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function a(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}function c(e){return void 0===e}function l(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function u(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function d(e,t){var n,r=[];for(n=0;n<e.length;++n)r.push(t(e[n],n));return r}function h(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function f(e,t){for(var n in t)h(t,n)&&(e[n]=t[n]);return h(t,"toString")&&(e.toString=t.toString),h(t,"valueOf")&&(e.valueOf=t.valueOf),e}function p(e,t,n,r){return zn(e,t,n,r,!0).utc()}function g(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function m(e){return null==e._pf&&(e._pf=g()),e._pf}function y(e){if(null==e._isValid){var t=m(e),r=n.call(t.parsedDateParts,(function(e){return null!=e})),i=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r);if(e._strict&&(i=i&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return i;e._isValid=i}return e._isValid}function v(e){var t=p(NaN);return null!=e?f(m(t),e):m(t).userInvalidated=!0,t}n=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,r=0;r<n;r++)if(r in t&&e.call(this,t[r],r,t))return!0;return!1};var b=r.momentProperties=[];function _(e,t){var n,r,i;if(c(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),c(t._i)||(e._i=t._i),c(t._f)||(e._f=t._f),c(t._l)||(e._l=t._l),c(t._strict)||(e._strict=t._strict),c(t._tzm)||(e._tzm=t._tzm),c(t._isUTC)||(e._isUTC=t._isUTC),c(t._offset)||(e._offset=t._offset),c(t._pf)||(e._pf=m(t)),c(t._locale)||(e._locale=t._locale),b.length>0)for(n=0;n<b.length;n++)c(i=t[r=b[n]])||(e[r]=i);return e}var w=!1;function T(e){_(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===w&&(w=!0,r.updateOffset(this),w=!1)}function E(e){return e instanceof T||null!=e&&null!=e._isAMomentObject}function A(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function S(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=A(t)),n}function O(e,t,n){var r,i=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),s=0;for(r=0;r<i;r++)(n&&e[r]!==t[r]||!n&&S(e[r])!==S(t[r]))&&s++;return s+o}function I(e){!1===r.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function C(e,t){var n=!0;return f((function(){if(null!=r.deprecationHandler&&r.deprecationHandler(null,e),n){for(var i,o=[],s=0;s<arguments.length;s++){if(i="","object"==typeof arguments[s]){for(var a in i+="\n["+s+"] ",arguments[0])i+=a+": "+arguments[0][a]+", ";i=i.slice(0,-2)}else i=arguments[s];o.push(i)}I(e+"\nArguments: "+Array.prototype.slice.call(o).join("")+"\n"+(new Error).stack),n=!1}return t.apply(this,arguments)}),t)}var k,P={};function x(e,t){null!=r.deprecationHandler&&r.deprecationHandler(e,t),P[e]||(I(t),P[e]=!0)}function R(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function L(e){var t,n;for(n in e)R(t=e[n])?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function D(e,t){var n,r=f({},e);for(n in t)h(t,n)&&(s(e[n])&&s(t[n])?(r[n]={},f(r[n],e[n]),f(r[n],t[n])):null!=t[n]?r[n]=t[n]:delete r[n]);for(n in e)h(e,n)&&!h(t,n)&&s(e[n])&&(r[n]=f({},r[n]));return r}function N(e){null!=e&&this.set(e)}r.suppressDeprecationWarnings=!1,r.deprecationHandler=null,k=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)h(e,t)&&n.push(t);return n};var j={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function M(e,t,n){var r=this._calendar[e]||this._calendar.sameElse;return R(r)?r.call(t,n):r}var F={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function U(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,(function(e){return e.slice(1)})),this._longDateFormat[e])}var B="Invalid date";function G(){return this._invalidDate}var q="%d",H=/\d{1,2}/;function $(e){return this._ordinal.replace("%d",e)}var W={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function z(e,t,n,r){var i=this._relativeTime[n];return R(i)?i(e,t,n,r):i.replace(/%d/i,e)}function V(e,t){var n=this._relativeTime[e>0?"future":"past"];return R(n)?n(t):n.replace(/%s/i,t)}var K={};function Y(e,t){var n=e.toLowerCase();K[n]=K[n+"s"]=K[t]=e}function Q(e){return"string"==typeof e?K[e]||K[e.toLowerCase()]:void 0}function X(e){var t,n,r={};for(n in e)h(e,n)&&(t=Q(n))&&(r[t]=e[n]);return r}var J={};function Z(e,t){J[e]=t}function ee(e){var t=[];for(var n in e)t.push({unit:n,priority:J[n]});return t.sort((function(e,t){return e.priority-t.priority})),t}function te(e,t,n){var r=""+Math.abs(e),i=t-r.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}var ne=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,re=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,ie={},oe={};function se(e,t,n,r){var i=r;"string"==typeof r&&(i=function(){return this[r]()}),e&&(oe[e]=i),t&&(oe[t[0]]=function(){return te(i.apply(this,arguments),t[1],t[2])}),n&&(oe[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function ae(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function ce(e){var t,n,r=e.match(ne);for(t=0,n=r.length;t<n;t++)oe[r[t]]?r[t]=oe[r[t]]:r[t]=ae(r[t]);return function(t){var i,o="";for(i=0;i<n;i++)o+=R(r[i])?r[i].call(t,e):r[i];return o}}function le(e,t){return e.isValid()?(t=ue(t,e.localeData()),ie[t]=ie[t]||ce(t),ie[t](e)):e.localeData().invalidDate()}function ue(e,t){var n=5;function r(e){return t.longDateFormat(e)||e}for(re.lastIndex=0;n>=0&&re.test(e);)e=e.replace(re,r),re.lastIndex=0,n-=1;return e}var de=/\d/,he=/\d\d/,fe=/\d{3}/,pe=/\d{4}/,ge=/[+-]?\d{6}/,me=/\d\d?/,ye=/\d\d\d\d?/,ve=/\d\d\d\d\d\d?/,be=/\d{1,3}/,_e=/\d{1,4}/,we=/[+-]?\d{1,6}/,Te=/\d+/,Ee=/[+-]?\d+/,Ae=/Z|[+-]\d\d:?\d\d/gi,Se=/Z|[+-]\d\d(?::?\d\d)?/gi,Oe=/[+-]?\d+(\.\d{1,3})?/,Ie=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Ce={};function ke(e,t,n){Ce[e]=R(t)?t:function(e,r){return e&&n?n:t}}function Pe(e,t){return h(Ce,e)?Ce[e](t._strict,t._locale):new RegExp(xe(e))}function xe(e){return Re(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,n,r,i){return t||n||r||i})))}function Re(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var Le={};function De(e,t){var n,r=t;for("string"==typeof e&&(e=[e]),l(t)&&(r=function(e,n){n[t]=S(e)}),n=0;n<e.length;n++)Le[e[n]]=r}function Ne(e,t){De(e,(function(e,n,r,i){r._w=r._w||{},t(e,r._w,r,i)}))}function je(e,t,n){null!=t&&h(Le,e)&&Le[e](t,n._a,n,e)}var Me=0,Fe=1,Ue=2,Be=3,Ge=4,qe=5,He=6,$e=7,We=8;function ze(e){return Ve(e)?366:365}function Ve(e){return e%4==0&&e%100!=0||e%400==0}se("Y",0,0,(function(){var e=this.year();return e<=9999?""+e:"+"+e})),se(0,["YY",2],0,(function(){return this.year()%100})),se(0,["YYYY",4],0,"year"),se(0,["YYYYY",5],0,"year"),se(0,["YYYYYY",6,!0],0,"year"),Y("year","y"),Z("year",1),ke("Y",Ee),ke("YY",me,he),ke("YYYY",_e,pe),ke("YYYYY",we,ge),ke("YYYYYY",we,ge),De(["YYYYY","YYYYYY"],Me),De("YYYY",(function(e,t){t[Me]=2===e.length?r.parseTwoDigitYear(e):S(e)})),De("YY",(function(e,t){t[Me]=r.parseTwoDigitYear(e)})),De("Y",(function(e,t){t[Me]=parseInt(e,10)})),r.parseTwoDigitYear=function(e){return S(e)+(S(e)>68?1900:2e3)};var Ke,Ye=Xe("FullYear",!0);function Qe(){return Ve(this.year())}function Xe(e,t){return function(n){return null!=n?(Ze(this,e,n),r.updateOffset(this,t),this):Je(this,e)}}function Je(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function Ze(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&Ve(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),rt(n,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function et(e){return R(this[e=Q(e)])?this[e]():this}function tt(e,t){if("object"==typeof e)for(var n=ee(e=X(e)),r=0;r<n.length;r++)this[n[r].unit](e[n[r].unit]);else if(R(this[e=Q(e)]))return this[e](t);return this}function nt(e,t){return(e%t+t)%t}function rt(e,t){if(isNaN(e)||isNaN(t))return NaN;var n=nt(t,12);return e+=(t-n)/12,1===n?Ve(e)?29:28:31-n%7%2}Ke=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},se("M",["MM",2],"Mo",(function(){return this.month()+1})),se("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),se("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),Y("month","M"),Z("month",8),ke("M",me),ke("MM",me,he),ke("MMM",(function(e,t){return t.monthsShortRegex(e)})),ke("MMMM",(function(e,t){return t.monthsRegex(e)})),De(["M","MM"],(function(e,t){t[Fe]=S(e)-1})),De(["MMM","MMMM"],(function(e,t,n,r){var i=n._locale.monthsParse(e,r,n._strict);null!=i?t[Fe]=i:m(n).invalidMonth=e}));var it=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,ot="January_February_March_April_May_June_July_August_September_October_November_December".split("_");function st(e,t){return e?o(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||it).test(t)?"format":"standalone"][e.month()]:o(this._months)?this._months:this._months.standalone}var at="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_");function ct(e,t){return e?o(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[it.test(t)?"format":"standalone"][e.month()]:o(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function lt(e,t,n){var r,i,o,s=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=p([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(i=Ke.call(this._shortMonthsParse,s))?i:null:-1!==(i=Ke.call(this._longMonthsParse,s))?i:null:"MMM"===t?-1!==(i=Ke.call(this._shortMonthsParse,s))||-1!==(i=Ke.call(this._longMonthsParse,s))?i:null:-1!==(i=Ke.call(this._longMonthsParse,s))||-1!==(i=Ke.call(this._shortMonthsParse,s))?i:null}function ut(e,t,n){var r,i,o;if(this._monthsParseExact)return lt.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=p([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}}function dt(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=S(t);else if(!l(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),rt(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function ht(e){return null!=e?(dt(this,e),r.updateOffset(this,!0),this):Je(this,"Month")}function ft(){return rt(this.year(),this.month())}var pt=Ie;function gt(e){return this._monthsParseExact?(h(this,"_monthsRegex")||vt.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(h(this,"_monthsShortRegex")||(this._monthsShortRegex=pt),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}var mt=Ie;function yt(e){return this._monthsParseExact?(h(this,"_monthsRegex")||vt.call(this),e?this._monthsStrictRegex:this._monthsRegex):(h(this,"_monthsRegex")||(this._monthsRegex=mt),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function vt(){function e(e,t){return t.length-e.length}var t,n,r=[],i=[],o=[];for(t=0;t<12;t++)n=p([2e3,t]),r.push(this.monthsShort(n,"")),i.push(this.months(n,"")),o.push(this.months(n,"")),o.push(this.monthsShort(n,""));for(r.sort(e),i.sort(e),o.sort(e),t=0;t<12;t++)r[t]=Re(r[t]),i[t]=Re(i[t]);for(t=0;t<24;t++)o[t]=Re(o[t]);this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function bt(e,t,n,r,i,o,s){var a=new Date(e,t,n,r,i,o,s);return e<100&&e>=0&&isFinite(a.getFullYear())&&a.setFullYear(e),a}function _t(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function wt(e,t,n){var r=7+t-n;return-(7+_t(e,0,r).getUTCDay()-t)%7+r-1}function Tt(e,t,n,r,i){var o,s,a=1+7*(t-1)+(7+n-r)%7+wt(e,r,i);return a<=0?s=ze(o=e-1)+a:a>ze(e)?(o=e+1,s=a-ze(e)):(o=e,s=a),{year:o,dayOfYear:s}}function Et(e,t,n){var r,i,o=wt(e.year(),t,n),s=Math.floor((e.dayOfYear()-o-1)/7)+1;return s<1?r=s+At(i=e.year()-1,t,n):s>At(e.year(),t,n)?(r=s-At(e.year(),t,n),i=e.year()+1):(i=e.year(),r=s),{week:r,year:i}}function At(e,t,n){var r=wt(e,t,n),i=wt(e+1,t,n);return(ze(e)-r+i)/7}function St(e){return Et(e,this._week.dow,this._week.doy).week}se("w",["ww",2],"wo","week"),se("W",["WW",2],"Wo","isoWeek"),Y("week","w"),Y("isoWeek","W"),Z("week",5),Z("isoWeek",5),ke("w",me),ke("ww",me,he),ke("W",me),ke("WW",me,he),Ne(["w","ww","W","WW"],(function(e,t,n,r){t[r.substr(0,1)]=S(e)}));var Ot={dow:0,doy:6};function It(){return this._week.dow}function Ct(){return this._week.doy}function kt(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Pt(e){var t=Et(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function xt(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}function Rt(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}se("d",0,"do","day"),se("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),se("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),se("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),se("e",0,0,"weekday"),se("E",0,0,"isoWeekday"),Y("day","d"),Y("weekday","e"),Y("isoWeekday","E"),Z("day",11),Z("weekday",11),Z("isoWeekday",11),ke("d",me),ke("e",me),ke("E",me),ke("dd",(function(e,t){return t.weekdaysMinRegex(e)})),ke("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),ke("dddd",(function(e,t){return t.weekdaysRegex(e)})),Ne(["dd","ddd","dddd"],(function(e,t,n,r){var i=n._locale.weekdaysParse(e,r,n._strict);null!=i?t.d=i:m(n).invalidWeekday=e})),Ne(["d","e","E"],(function(e,t,n,r){t[r]=S(e)}));var Lt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_");function Dt(e,t){return e?o(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]:o(this._weekdays)?this._weekdays:this._weekdays.standalone}var Nt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_");function jt(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort}var Mt="Su_Mo_Tu_We_Th_Fr_Sa".split("_");function Ft(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Ut(e,t,n){var r,i,o,s=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=p([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(i=Ke.call(this._weekdaysParse,s))?i:null:"ddd"===t?-1!==(i=Ke.call(this._shortWeekdaysParse,s))?i:null:-1!==(i=Ke.call(this._minWeekdaysParse,s))?i:null:"dddd"===t?-1!==(i=Ke.call(this._weekdaysParse,s))||-1!==(i=Ke.call(this._shortWeekdaysParse,s))||-1!==(i=Ke.call(this._minWeekdaysParse,s))?i:null:"ddd"===t?-1!==(i=Ke.call(this._shortWeekdaysParse,s))||-1!==(i=Ke.call(this._weekdaysParse,s))||-1!==(i=Ke.call(this._minWeekdaysParse,s))?i:null:-1!==(i=Ke.call(this._minWeekdaysParse,s))||-1!==(i=Ke.call(this._weekdaysParse,s))||-1!==(i=Ke.call(this._shortWeekdaysParse,s))?i:null}function Bt(e,t,n){var r,i,o;if(this._weekdaysParseExact)return Ut.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=p([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(n&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(n&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!n&&this._weekdaysParse[r].test(e))return r}}function Gt(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=xt(e,this.localeData()),this.add(e-t,"d")):t}function qt(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Ht(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=Rt(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}var $t=Ie;function Wt(e){return this._weekdaysParseExact?(h(this,"_weekdaysRegex")||Qt.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(h(this,"_weekdaysRegex")||(this._weekdaysRegex=$t),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}var zt=Ie;function Vt(e){return this._weekdaysParseExact?(h(this,"_weekdaysRegex")||Qt.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(h(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=zt),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}var Kt=Ie;function Yt(e){return this._weekdaysParseExact?(h(this,"_weekdaysRegex")||Qt.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(h(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Kt),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Qt(){function e(e,t){return t.length-e.length}var t,n,r,i,o,s=[],a=[],c=[],l=[];for(t=0;t<7;t++)n=p([2e3,1]).day(t),r=this.weekdaysMin(n,""),i=this.weekdaysShort(n,""),o=this.weekdays(n,""),s.push(r),a.push(i),c.push(o),l.push(r),l.push(i),l.push(o);for(s.sort(e),a.sort(e),c.sort(e),l.sort(e),t=0;t<7;t++)a[t]=Re(a[t]),c[t]=Re(c[t]),l[t]=Re(l[t]);this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function Xt(){return this.hours()%12||12}function Jt(){return this.hours()||24}function Zt(e,t){se(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function en(e,t){return t._meridiemParse}function tn(e){return"p"===(e+"").toLowerCase().charAt(0)}se("H",["HH",2],0,"hour"),se("h",["hh",2],0,Xt),se("k",["kk",2],0,Jt),se("hmm",0,0,(function(){return""+Xt.apply(this)+te(this.minutes(),2)})),se("hmmss",0,0,(function(){return""+Xt.apply(this)+te(this.minutes(),2)+te(this.seconds(),2)})),se("Hmm",0,0,(function(){return""+this.hours()+te(this.minutes(),2)})),se("Hmmss",0,0,(function(){return""+this.hours()+te(this.minutes(),2)+te(this.seconds(),2)})),Zt("a",!0),Zt("A",!1),Y("hour","h"),Z("hour",13),ke("a",en),ke("A",en),ke("H",me),ke("h",me),ke("k",me),ke("HH",me,he),ke("hh",me,he),ke("kk",me,he),ke("hmm",ye),ke("hmmss",ve),ke("Hmm",ye),ke("Hmmss",ve),De(["H","HH"],Be),De(["k","kk"],(function(e,t,n){var r=S(e);t[Be]=24===r?0:r})),De(["a","A"],(function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e})),De(["h","hh"],(function(e,t,n){t[Be]=S(e),m(n).bigHour=!0})),De("hmm",(function(e,t,n){var r=e.length-2;t[Be]=S(e.substr(0,r)),t[Ge]=S(e.substr(r)),m(n).bigHour=!0})),De("hmmss",(function(e,t,n){var r=e.length-4,i=e.length-2;t[Be]=S(e.substr(0,r)),t[Ge]=S(e.substr(r,2)),t[qe]=S(e.substr(i)),m(n).bigHour=!0})),De("Hmm",(function(e,t,n){var r=e.length-2;t[Be]=S(e.substr(0,r)),t[Ge]=S(e.substr(r))})),De("Hmmss",(function(e,t,n){var r=e.length-4,i=e.length-2;t[Be]=S(e.substr(0,r)),t[Ge]=S(e.substr(r,2)),t[qe]=S(e.substr(i))}));var nn=/[ap]\.?m?\.?/i;function rn(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}var on,sn=Xe("Hours",!0),an={calendar:j,longDateFormat:F,invalidDate:B,ordinal:q,dayOfMonthOrdinalParse:H,relativeTime:W,months:ot,monthsShort:at,week:Ot,weekdays:Lt,weekdaysMin:Mt,weekdaysShort:Nt,meridiemParse:nn},cn={},ln={};function un(e){return e?e.toLowerCase().replace("_","-"):e}function dn(e){for(var t,n,r,i,o=0;o<e.length;){for(t=(i=un(e[o]).split("-")).length,n=(n=un(e[o+1]))?n.split("-"):null;t>0;){if(r=hn(i.slice(0,t).join("-")))return r;if(n&&n.length>=t&&O(i,n,!0)>=t-1)break;t--}o++}return on}function hn(t){var n=null;if(!cn[t]&&void 0!==e&&e&&e.exports)try{n=on._abbr,!function(){var e=new Error("Cannot find module 'undefined'");throw e.code="MODULE_NOT_FOUND",e}(),fn(n)}catch(e){}return cn[t]}function fn(e,t){var n;return e&&((n=c(t)?mn(e):pn(e,t))?on=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),on._abbr}function pn(e,t){if(null!==t){var n,r=an;if(t.abbr=e,null!=cn[e])x("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=cn[e]._config;else if(null!=t.parentLocale)if(null!=cn[t.parentLocale])r=cn[t.parentLocale]._config;else{if(null==(n=hn(t.parentLocale)))return ln[t.parentLocale]||(ln[t.parentLocale]=[]),ln[t.parentLocale].push({name:e,config:t}),null;r=n._config}return cn[e]=new N(D(r,t)),ln[e]&&ln[e].forEach((function(e){pn(e.name,e.config)})),fn(e),cn[e]}return delete cn[e],null}function gn(e,t){if(null!=t){var n,r,i=an;null!=(r=hn(e))&&(i=r._config),(n=new N(t=D(i,t))).parentLocale=cn[e],cn[e]=n,fn(e)}else null!=cn[e]&&(null!=cn[e].parentLocale?cn[e]=cn[e].parentLocale:null!=cn[e]&&delete cn[e]);return cn[e]}function mn(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return on;if(!o(e)){if(t=hn(e))return t;e=[e]}return dn(e)}function yn(){return k(cn)}function vn(e){var t,n=e._a;return n&&-2===m(e).overflow&&(t=n[Fe]<0||n[Fe]>11?Fe:n[Ue]<1||n[Ue]>rt(n[Me],n[Fe])?Ue:n[Be]<0||n[Be]>24||24===n[Be]&&(0!==n[Ge]||0!==n[qe]||0!==n[He])?Be:n[Ge]<0||n[Ge]>59?Ge:n[qe]<0||n[qe]>59?qe:n[He]<0||n[He]>999?He:-1,m(e)._overflowDayOfYear&&(t<Me||t>Ue)&&(t=Ue),m(e)._overflowWeeks&&-1===t&&(t=$e),m(e)._overflowWeekday&&-1===t&&(t=We),m(e).overflow=t),e}function bn(e,t,n){return null!=e?e:null!=t?t:n}function _n(e){var t=new Date(r.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function wn(e){var t,n,r,i,o,s=[];if(!e._d){for(r=_n(e),e._w&&null==e._a[Ue]&&null==e._a[Fe]&&Tn(e),null!=e._dayOfYear&&(o=bn(e._a[Me],r[Me]),(e._dayOfYear>ze(o)||0===e._dayOfYear)&&(m(e)._overflowDayOfYear=!0),n=_t(o,0,e._dayOfYear),e._a[Fe]=n.getUTCMonth(),e._a[Ue]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=s[t]=r[t];for(;t<7;t++)e._a[t]=s[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[Be]&&0===e._a[Ge]&&0===e._a[qe]&&0===e._a[He]&&(e._nextDay=!0,e._a[Be]=0),e._d=(e._useUTC?_t:bt).apply(null,s),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Be]=24),e._w&&void 0!==e._w.d&&e._w.d!==i&&(m(e).weekdayMismatch=!0)}}function Tn(e){var t,n,r,i,o,s,a,c;if(null!=(t=e._w).GG||null!=t.W||null!=t.E)o=1,s=4,n=bn(t.GG,e._a[Me],Et(Vn(),1,4).year),r=bn(t.W,1),((i=bn(t.E,1))<1||i>7)&&(c=!0);else{o=e._locale._week.dow,s=e._locale._week.doy;var l=Et(Vn(),o,s);n=bn(t.gg,e._a[Me],l.year),r=bn(t.w,l.week),null!=t.d?((i=t.d)<0||i>6)&&(c=!0):null!=t.e?(i=t.e+o,(t.e<0||t.e>6)&&(c=!0)):i=o}r<1||r>At(n,o,s)?m(e)._overflowWeeks=!0:null!=c?m(e)._overflowWeekday=!0:(a=Tt(n,r,i,o,s),e._a[Me]=a.year,e._dayOfYear=a.dayOfYear)}var En=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,An=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Sn=/Z|[+-]\d\d(?::?\d\d)?/,On=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],In=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Cn=/^\/?Date\((\-?\d+)/i;function kn(e){var t,n,r,i,o,s,a=e._i,c=En.exec(a)||An.exec(a);if(c){for(m(e).iso=!0,t=0,n=On.length;t<n;t++)if(On[t][1].exec(c[1])){i=On[t][0],r=!1!==On[t][2];break}if(null==i)return void(e._isValid=!1);if(c[3]){for(t=0,n=In.length;t<n;t++)if(In[t][1].exec(c[3])){o=(c[2]||" ")+In[t][0];break}if(null==o)return void(e._isValid=!1)}if(!r&&null!=o)return void(e._isValid=!1);if(c[4]){if(!Sn.exec(c[4]))return void(e._isValid=!1);s="Z"}e._f=i+(o||"")+(s||""),Un(e)}else e._isValid=!1}var Pn=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/;function xn(e,t,n,r,i,o){var s=[Rn(e),at.indexOf(t),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&s.push(parseInt(o,10)),s}function Rn(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function Ln(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Dn(e,t,n){return!e||Nt.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(m(n).weekdayMismatch=!0,n._isValid=!1,!1)}var Nn={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function jn(e,t,n){if(e)return Nn[e];if(t)return 0;var r=parseInt(n,10),i=r%100;return(r-i)/100*60+i}function Mn(e){var t=Pn.exec(Ln(e._i));if(t){var n=xn(t[4],t[3],t[2],t[5],t[6],t[7]);if(!Dn(t[1],n,e))return;e._a=n,e._tzm=jn(t[8],t[9],t[10]),e._d=_t.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),m(e).rfc2822=!0}else e._isValid=!1}function Fn(e){var t=Cn.exec(e._i);null===t?(kn(e),!1===e._isValid&&(delete e._isValid,Mn(e),!1===e._isValid&&(delete e._isValid,r.createFromInputFallback(e)))):e._d=new Date(+t[1])}function Un(e){if(e._f!==r.ISO_8601)if(e._f!==r.RFC_2822){e._a=[],m(e).empty=!0;var t,n,i,o,s,a=""+e._i,c=a.length,l=0;for(i=ue(e._f,e._locale).match(ne)||[],t=0;t<i.length;t++)o=i[t],(n=(a.match(Pe(o,e))||[])[0])&&((s=a.substr(0,a.indexOf(n))).length>0&&m(e).unusedInput.push(s),a=a.slice(a.indexOf(n)+n.length),l+=n.length),oe[o]?(n?m(e).empty=!1:m(e).unusedTokens.push(o),je(o,n,e)):e._strict&&!n&&m(e).unusedTokens.push(o);m(e).charsLeftOver=c-l,a.length>0&&m(e).unusedInput.push(a),e._a[Be]<=12&&!0===m(e).bigHour&&e._a[Be]>0&&(m(e).bigHour=void 0),m(e).parsedDateParts=e._a.slice(0),m(e).meridiem=e._meridiem,e._a[Be]=Bn(e._locale,e._a[Be],e._meridiem),wn(e),vn(e)}else Mn(e);else kn(e)}function Bn(e,t,n){var r;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((r=e.isPM(n))&&t<12&&(t+=12),r||12!==t||(t=0),t):t}function Gn(e){var t,n,r,i,o;if(0===e._f.length)return m(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<e._f.length;i++)o=0,t=_({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],Un(t),y(t)&&(o+=m(t).charsLeftOver,o+=10*m(t).unusedTokens.length,m(t).score=o,(null==r||o<r)&&(r=o,n=t));f(e,n||t)}function qn(e){if(!e._d){var t=X(e._i);e._a=d([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),wn(e)}}function Hn(e){var t=new T(vn($n(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function $n(e){var t=e._i,n=e._f;return e._locale=e._locale||mn(e._l),null===t||void 0===n&&""===t?v({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),E(t)?new T(vn(t)):(u(t)?e._d=t:o(n)?Gn(e):n?Un(e):Wn(e),y(e)||(e._d=null),e))}function Wn(e){var t=e._i;c(t)?e._d=new Date(r.now()):u(t)?e._d=new Date(t.valueOf()):"string"==typeof t?Fn(e):o(t)?(e._a=d(t.slice(0),(function(e){return parseInt(e,10)})),wn(e)):s(t)?qn(e):l(t)?e._d=new Date(t):r.createFromInputFallback(e)}function zn(e,t,n,r,i){var c={};return!0!==n&&!1!==n||(r=n,n=void 0),(s(e)&&a(e)||o(e)&&0===e.length)&&(e=void 0),c._isAMomentObject=!0,c._useUTC=c._isUTC=i,c._l=n,c._i=e,c._f=t,c._strict=r,Hn(c)}function Vn(e,t,n,r){return zn(e,t,n,r,!1)}r.createFromInputFallback=C("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),r.ISO_8601=function(){},r.RFC_2822=function(){};var Kn=C("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Vn.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:v()})),Yn=C("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Vn.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:v()}));function Qn(e,t){var n,r;if(1===t.length&&o(t[0])&&(t=t[0]),!t.length)return Vn();for(n=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](n)||(n=t[r]);return n}function Xn(){return Qn("isBefore",[].slice.call(arguments,0))}function Jn(){return Qn("isAfter",[].slice.call(arguments,0))}var Zn=function(){return Date.now?Date.now():+new Date},er=["year","quarter","month","week","day","hour","minute","second","millisecond"];function tr(e){for(var t in e)if(-1===Ke.call(er,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,r=0;r<er.length;++r)if(e[er[r]]){if(n)return!1;parseFloat(e[er[r]])!==S(e[er[r]])&&(n=!0)}return!0}function nr(){return this._isValid}function rr(){return Sr(NaN)}function ir(e){var t=X(e),n=t.year||0,r=t.quarter||0,i=t.month||0,o=t.week||0,s=t.day||0,a=t.hour||0,c=t.minute||0,l=t.second||0,u=t.millisecond||0;this._isValid=tr(t),this._milliseconds=+u+1e3*l+6e4*c+1e3*a*60*60,this._days=+s+7*o,this._months=+i+3*r+12*n,this._data={},this._locale=mn(),this._bubble()}function or(e){return e instanceof ir}function sr(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function ar(e,t){se(e,0,0,(function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+te(~~(e/60),2)+t+te(~~e%60,2)}))}ar("Z",":"),ar("ZZ",""),ke("Z",Se),ke("ZZ",Se),De(["Z","ZZ"],(function(e,t,n){n._useUTC=!0,n._tzm=lr(Se,e)}));var cr=/([\+\-]|\d\d)/gi;function lr(e,t){var n=(t||"").match(e);if(null===n)return null;var r=((n[n.length-1]||[])+"").match(cr)||["-",0,0],i=60*r[1]+S(r[2]);return 0===i?0:"+"===r[0]?i:-i}function ur(e,t){var n,i;return t._isUTC?(n=t.clone(),i=(E(e)||u(e)?e.valueOf():Vn(e).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),r.updateOffset(n,!1),n):Vn(e).local()}function dr(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function hr(e,t,n){var i,o=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=lr(Se,e)))return this}else Math.abs(e)<16&&!n&&(e*=60);return!this._isUTC&&t&&(i=dr(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),o!==e&&(!t||this._changeInProgress?Pr(this,Sr(e-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,r.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?o:dr(this)}function fr(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function pr(e){return this.utcOffset(0,e)}function gr(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(dr(this),"m")),this}function mr(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=lr(Ae,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function yr(e){return!!this.isValid()&&(e=e?Vn(e).utcOffset():0,(this.utcOffset()-e)%60==0)}function vr(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function br(){if(!c(this._isDSTShifted))return this._isDSTShifted;var e={};if(_(e,this),(e=$n(e))._a){var t=e._isUTC?p(e._a):Vn(e._a);this._isDSTShifted=this.isValid()&&O(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function _r(){return!!this.isValid()&&!this._isUTC}function wr(){return!!this.isValid()&&this._isUTC}function Tr(){return!!this.isValid()&&this._isUTC&&0===this._offset}r.updateOffset=function(){};var Er=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Ar=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Sr(e,t){var n,r,i,o=e,s=null;return or(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:l(e)?(o={},t?o[t]=e:o.milliseconds=e):(s=Er.exec(e))?(n="-"===s[1]?-1:1,o={y:0,d:S(s[Ue])*n,h:S(s[Be])*n,m:S(s[Ge])*n,s:S(s[qe])*n,ms:S(sr(1e3*s[He]))*n}):(s=Ar.exec(e))?(n="-"===s[1]?-1:(s[1],1),o={y:Or(s[2],n),M:Or(s[3],n),w:Or(s[4],n),d:Or(s[5],n),h:Or(s[6],n),m:Or(s[7],n),s:Or(s[8],n)}):null==o?o={}:"object"==typeof o&&("from"in o||"to"in o)&&(i=Cr(Vn(o.from),Vn(o.to)),(o={}).ms=i.milliseconds,o.M=i.months),r=new ir(o),or(e)&&h(e,"_locale")&&(r._locale=e._locale),r}function Or(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Ir(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Cr(e,t){var n;return e.isValid()&&t.isValid()?(t=ur(t,e),e.isBefore(t)?n=Ir(e,t):((n=Ir(t,e)).milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function kr(e,t){return function(n,r){var i;return null===r||isNaN(+r)||(x(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=n,n=r,r=i),Pr(this,Sr(n="string"==typeof n?+n:n,r),e),this}}function Pr(e,t,n,i){var o=t._milliseconds,s=sr(t._days),a=sr(t._months);e.isValid()&&(i=null==i||i,a&&dt(e,Je(e,"Month")+a*n),s&&Ze(e,"Date",Je(e,"Date")+s*n),o&&e._d.setTime(e._d.valueOf()+o*n),i&&r.updateOffset(e,s||a))}Sr.fn=ir.prototype,Sr.invalid=rr;var xr=kr(1,"add"),Rr=kr(-1,"subtract");function Lr(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function Dr(e,t){var n=e||Vn(),i=ur(n,this).startOf("day"),o=r.calendarFormat(this,i)||"sameElse",s=t&&(R(t[o])?t[o].call(this,n):t[o]);return this.format(s||this.localeData().calendar(o,this,Vn(n)))}function Nr(){return new T(this)}function jr(e,t){var n=E(e)?e:Vn(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=Q(c(t)?"millisecond":t))?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())}function Mr(e,t){var n=E(e)?e:Vn(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=Q(c(t)?"millisecond":t))?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())}function Fr(e,t,n,r){return("("===(r=r||"()")[0]?this.isAfter(e,n):!this.isBefore(e,n))&&(")"===r[1]?this.isBefore(t,n):!this.isAfter(t,n))}function Ur(e,t){var n,r=E(e)?e:Vn(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=Q(t||"millisecond"))?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))}function Br(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Gr(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function qr(e,t,n){var r,i,o;if(!this.isValid())return NaN;if(!(r=ur(e,this)).isValid())return NaN;switch(i=6e4*(r.utcOffset()-this.utcOffset()),t=Q(t)){case"year":o=Hr(this,r)/12;break;case"month":o=Hr(this,r);break;case"quarter":o=Hr(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:A(o)}function Hr(e,t){var n=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(n,"months");return-(n+(t-r<0?(t-r)/(r-e.clone().add(n-1,"months")):(t-r)/(e.clone().add(n+1,"months")-r)))||0}function $r(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Wr(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?le(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):R(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",le(n,"Z")):le(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function zr(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",o=t+'[")]';return this.format(n+r+i+o)}function Vr(e){e||(e=this.isUtc()?r.defaultFormatUtc:r.defaultFormat);var t=le(this,e);return this.localeData().postformat(t)}function Kr(e,t){return this.isValid()&&(E(e)&&e.isValid()||Vn(e).isValid())?Sr({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Yr(e){return this.from(Vn(),e)}function Qr(e,t){return this.isValid()&&(E(e)&&e.isValid()||Vn(e).isValid())?Sr({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function Xr(e){return this.to(Vn(),e)}function Jr(e){var t;return void 0===e?this._locale._abbr:(null!=(t=mn(e))&&(this._locale=t),this)}r.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",r.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Zr=C("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function ei(){return this._locale}function ti(e){switch(e=Q(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function ni(e){return void 0===(e=Q(e))||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))}function ri(){return this._d.valueOf()-6e4*(this._offset||0)}function ii(){return Math.floor(this.valueOf()/1e3)}function oi(){return new Date(this.valueOf())}function si(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function ai(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function ci(){return this.isValid()?this.toISOString():null}function li(){return y(this)}function ui(){return f({},m(this))}function di(){return m(this).overflow}function hi(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function fi(e,t){se(0,[e,e.length],0,t)}function pi(e){return vi.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function gi(e){return vi.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function mi(){return At(this.year(),1,4)}function yi(){var e=this.localeData()._week;return At(this.year(),e.dow,e.doy)}function vi(e,t,n,r,i){var o;return null==e?Et(this,r,i).year:(t>(o=At(e,r,i))&&(t=o),bi.call(this,e,t,n,r,i))}function bi(e,t,n,r,i){var o=Tt(e,t,n,r,i),s=_t(o.year,0,o.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}function _i(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}se(0,["gg",2],0,(function(){return this.weekYear()%100})),se(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),fi("gggg","weekYear"),fi("ggggg","weekYear"),fi("GGGG","isoWeekYear"),fi("GGGGG","isoWeekYear"),Y("weekYear","gg"),Y("isoWeekYear","GG"),Z("weekYear",1),Z("isoWeekYear",1),ke("G",Ee),ke("g",Ee),ke("GG",me,he),ke("gg",me,he),ke("GGGG",_e,pe),ke("gggg",_e,pe),ke("GGGGG",we,ge),ke("ggggg",we,ge),Ne(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,n,r){t[r.substr(0,2)]=S(e)})),Ne(["gg","GG"],(function(e,t,n,i){t[i]=r.parseTwoDigitYear(e)})),se("Q",0,"Qo","quarter"),Y("quarter","Q"),Z("quarter",7),ke("Q",de),De("Q",(function(e,t){t[Fe]=3*(S(e)-1)})),se("D",["DD",2],"Do","date"),Y("date","D"),Z("date",9),ke("D",me),ke("DD",me,he),ke("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),De(["D","DD"],Ue),De("Do",(function(e,t){t[Ue]=S(e.match(me)[0])}));var wi=Xe("Date",!0);function Ti(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}se("DDD",["DDDD",3],"DDDo","dayOfYear"),Y("dayOfYear","DDD"),Z("dayOfYear",4),ke("DDD",be),ke("DDDD",fe),De(["DDD","DDDD"],(function(e,t,n){n._dayOfYear=S(e)})),se("m",["mm",2],0,"minute"),Y("minute","m"),Z("minute",14),ke("m",me),ke("mm",me,he),De(["m","mm"],Ge);var Ei=Xe("Minutes",!1);se("s",["ss",2],0,"second"),Y("second","s"),Z("second",15),ke("s",me),ke("ss",me,he),De(["s","ss"],qe);var Ai,Si=Xe("Seconds",!1);for(se("S",0,0,(function(){return~~(this.millisecond()/100)})),se(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),se(0,["SSS",3],0,"millisecond"),se(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),se(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),se(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),se(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),se(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),se(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),Y("millisecond","ms"),Z("millisecond",16),ke("S",be,de),ke("SS",be,he),ke("SSS",be,fe),Ai="SSSS";Ai.length<=9;Ai+="S")ke(Ai,Te);function Oi(e,t){t[He]=S(1e3*("0."+e))}for(Ai="S";Ai.length<=9;Ai+="S")De(Ai,Oi);var Ii=Xe("Milliseconds",!1);function Ci(){return this._isUTC?"UTC":""}function ki(){return this._isUTC?"Coordinated Universal Time":""}se("z",0,0,"zoneAbbr"),se("zz",0,0,"zoneName");var Pi=T.prototype;function xi(e){return Vn(1e3*e)}function Ri(){return Vn.apply(null,arguments).parseZone()}function Li(e){return e}Pi.add=xr,Pi.calendar=Dr,Pi.clone=Nr,Pi.diff=qr,Pi.endOf=ni,Pi.format=Vr,Pi.from=Kr,Pi.fromNow=Yr,Pi.to=Qr,Pi.toNow=Xr,Pi.get=et,Pi.invalidAt=di,Pi.isAfter=jr,Pi.isBefore=Mr,Pi.isBetween=Fr,Pi.isSame=Ur,Pi.isSameOrAfter=Br,Pi.isSameOrBefore=Gr,Pi.isValid=li,Pi.lang=Zr,Pi.locale=Jr,Pi.localeData=ei,Pi.max=Yn,Pi.min=Kn,Pi.parsingFlags=ui,Pi.set=tt,Pi.startOf=ti,Pi.subtract=Rr,Pi.toArray=si,Pi.toObject=ai,Pi.toDate=oi,Pi.toISOString=Wr,Pi.inspect=zr,Pi.toJSON=ci,Pi.toString=$r,Pi.unix=ii,Pi.valueOf=ri,Pi.creationData=hi,Pi.year=Ye,Pi.isLeapYear=Qe,Pi.weekYear=pi,Pi.isoWeekYear=gi,Pi.quarter=Pi.quarters=_i,Pi.month=ht,Pi.daysInMonth=ft,Pi.week=Pi.weeks=kt,Pi.isoWeek=Pi.isoWeeks=Pt,Pi.weeksInYear=yi,Pi.isoWeeksInYear=mi,Pi.date=wi,Pi.day=Pi.days=Gt,Pi.weekday=qt,Pi.isoWeekday=Ht,Pi.dayOfYear=Ti,Pi.hour=Pi.hours=sn,Pi.minute=Pi.minutes=Ei,Pi.second=Pi.seconds=Si,Pi.millisecond=Pi.milliseconds=Ii,Pi.utcOffset=hr,Pi.utc=pr,Pi.local=gr,Pi.parseZone=mr,Pi.hasAlignedHourOffset=yr,Pi.isDST=vr,Pi.isLocal=_r,Pi.isUtcOffset=wr,Pi.isUtc=Tr,Pi.isUTC=Tr,Pi.zoneAbbr=Ci,Pi.zoneName=ki,Pi.dates=C("dates accessor is deprecated. Use date instead.",wi),Pi.months=C("months accessor is deprecated. Use month instead",ht),Pi.years=C("years accessor is deprecated. Use year instead",Ye),Pi.zone=C("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",fr),Pi.isDSTShifted=C("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",br);var Di=N.prototype;function Ni(e,t,n,r){var i=mn(),o=p().set(r,t);return i[n](o,e)}function ji(e,t,n){if(l(e)&&(t=e,e=void 0),e=e||"",null!=t)return Ni(e,t,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Ni(e,r,n,"month");return i}function Mi(e,t,n,r){"boolean"==typeof e?(l(t)&&(n=t,t=void 0),t=t||""):(n=t=e,e=!1,l(t)&&(n=t,t=void 0),t=t||"");var i,o=mn(),s=e?o._week.dow:0;if(null!=n)return Ni(t,(n+s)%7,r,"day");var a=[];for(i=0;i<7;i++)a[i]=Ni(t,(i+s)%7,r,"day");return a}function Fi(e,t){return ji(e,t,"months")}function Ui(e,t){return ji(e,t,"monthsShort")}function Bi(e,t,n){return Mi(e,t,n,"weekdays")}function Gi(e,t,n){return Mi(e,t,n,"weekdaysShort")}function qi(e,t,n){return Mi(e,t,n,"weekdaysMin")}Di.calendar=M,Di.longDateFormat=U,Di.invalidDate=G,Di.ordinal=$,Di.preparse=Li,Di.postformat=Li,Di.relativeTime=z,Di.pastFuture=V,Di.set=L,Di.months=st,Di.monthsShort=ct,Di.monthsParse=ut,Di.monthsRegex=yt,Di.monthsShortRegex=gt,Di.week=St,Di.firstDayOfYear=Ct,Di.firstDayOfWeek=It,Di.weekdays=Dt,Di.weekdaysMin=Ft,Di.weekdaysShort=jt,Di.weekdaysParse=Bt,Di.weekdaysRegex=Wt,Di.weekdaysShortRegex=Vt,Di.weekdaysMinRegex=Yt,Di.isPM=tn,Di.meridiem=rn,fn("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===S(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),r.lang=C("moment.lang is deprecated. Use moment.locale instead.",fn),r.langData=C("moment.langData is deprecated. Use moment.localeData instead.",mn);var Hi=Math.abs;function $i(){var e=this._data;return this._milliseconds=Hi(this._milliseconds),this._days=Hi(this._days),this._months=Hi(this._months),e.milliseconds=Hi(e.milliseconds),e.seconds=Hi(e.seconds),e.minutes=Hi(e.minutes),e.hours=Hi(e.hours),e.months=Hi(e.months),e.years=Hi(e.years),this}function Wi(e,t,n,r){var i=Sr(t,n);return e._milliseconds+=r*i._milliseconds,e._days+=r*i._days,e._months+=r*i._months,e._bubble()}function zi(e,t){return Wi(this,e,t,1)}function Vi(e,t){return Wi(this,e,t,-1)}function Ki(e){return e<0?Math.floor(e):Math.ceil(e)}function Yi(){var e,t,n,r,i,o=this._milliseconds,s=this._days,a=this._months,c=this._data;return o>=0&&s>=0&&a>=0||o<=0&&s<=0&&a<=0||(o+=864e5*Ki(Xi(a)+s),s=0,a=0),c.milliseconds=o%1e3,e=A(o/1e3),c.seconds=e%60,t=A(e/60),c.minutes=t%60,n=A(t/60),c.hours=n%24,s+=A(n/24),a+=i=A(Qi(s)),s-=Ki(Xi(i)),r=A(a/12),a%=12,c.days=s,c.months=a,c.years=r,this}function Qi(e){return 4800*e/146097}function Xi(e){return 146097*e/4800}function Ji(e){if(!this.isValid())return NaN;var t,n,r=this._milliseconds;if("month"===(e=Q(e))||"year"===e)return t=this._days+r/864e5,n=this._months+Qi(t),"month"===e?n:n/12;switch(t=this._days+Math.round(Xi(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}}function Zi(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*S(this._months/12):NaN}function eo(e){return function(){return this.as(e)}}var to=eo("ms"),no=eo("s"),ro=eo("m"),io=eo("h"),oo=eo("d"),so=eo("w"),ao=eo("M"),co=eo("y");function lo(){return Sr(this)}function uo(e){return e=Q(e),this.isValid()?this[e+"s"]():NaN}function ho(e){return function(){return this.isValid()?this._data[e]:NaN}}var fo=ho("milliseconds"),po=ho("seconds"),go=ho("minutes"),mo=ho("hours"),yo=ho("days"),vo=ho("months"),bo=ho("years");function _o(){return A(this.days()/7)}var wo=Math.round,To={ss:44,s:45,m:45,h:22,d:26,M:11};function Eo(e,t,n,r,i){return i.relativeTime(t||1,!!n,e,r)}function Ao(e,t,n){var r=Sr(e).abs(),i=wo(r.as("s")),o=wo(r.as("m")),s=wo(r.as("h")),a=wo(r.as("d")),c=wo(r.as("M")),l=wo(r.as("y")),u=i<=To.ss&&["s",i]||i<To.s&&["ss",i]||o<=1&&["m"]||o<To.m&&["mm",o]||s<=1&&["h"]||s<To.h&&["hh",s]||a<=1&&["d"]||a<To.d&&["dd",a]||c<=1&&["M"]||c<To.M&&["MM",c]||l<=1&&["y"]||["yy",l];return u[2]=t,u[3]=+e>0,u[4]=n,Eo.apply(null,u)}function So(e){return void 0===e?wo:"function"==typeof e&&(wo=e,!0)}function Oo(e,t){return void 0!==To[e]&&(void 0===t?To[e]:(To[e]=t,"s"===e&&(To.ss=t-1),!0))}function Io(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),n=Ao(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)}var Co=Math.abs;function ko(e){return(e>0)-(e<0)||+e}function Po(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n=Co(this._milliseconds)/1e3,r=Co(this._days),i=Co(this._months);e=A(n/60),t=A(e/60),n%=60,e%=60;var o=A(i/12),s=i%=12,a=r,c=t,l=e,u=n?n.toFixed(3).replace(/\.?0+$/,""):"",d=this.asSeconds();if(!d)return"P0D";var h=d<0?"-":"",f=ko(this._months)!==ko(d)?"-":"",p=ko(this._days)!==ko(d)?"-":"",g=ko(this._milliseconds)!==ko(d)?"-":"";return h+"P"+(o?f+o+"Y":"")+(s?f+s+"M":"")+(a?p+a+"D":"")+(c||l||u?"T":"")+(c?g+c+"H":"")+(l?g+l+"M":"")+(u?g+u+"S":"")}var xo=ir.prototype;return xo.isValid=nr,xo.abs=$i,xo.add=zi,xo.subtract=Vi,xo.as=Ji,xo.asMilliseconds=to,xo.asSeconds=no,xo.asMinutes=ro,xo.asHours=io,xo.asDays=oo,xo.asWeeks=so,xo.asMonths=ao,xo.asYears=co,xo.valueOf=Zi,xo._bubble=Yi,xo.clone=lo,xo.get=uo,xo.milliseconds=fo,xo.seconds=po,xo.minutes=go,xo.hours=mo,xo.days=yo,xo.weeks=_o,xo.months=vo,xo.years=bo,xo.humanize=Io,xo.toISOString=Po,xo.toString=Po,xo.toJSON=Po,xo.locale=Jr,xo.localeData=ei,xo.toIsoString=C("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Po),xo.lang=Zr,se("X",0,0,"unix"),se("x",0,0,"valueOf"),ke("x",Ee),ke("X",Oe),De("X",(function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))})),De("x",(function(e,t,n){n._d=new Date(S(e))})),r.version="2.22.2",i(Vn),r.fn=Pi,r.min=Xn,r.max=Jn,r.now=Zn,r.utc=p,r.unix=xi,r.months=Fi,r.isDate=u,r.locale=fn,r.invalid=v,r.duration=Sr,r.isMoment=E,r.weekdays=Bi,r.parseZone=Ri,r.localeData=mn,r.isDuration=or,r.monthsShort=Ui,r.weekdaysMin=qi,r.defineLocale=pn,r.updateLocale=gn,r.locales=yn,r.weekdaysShort=Gi,r.normalizeUnits=Q,r.relativeTimeRounding=So,r.relativeTimeThreshold=Oo,r.calendarFormat=Lr,r.prototype=Pi,r.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"YYYY-[W]WW",MONTH:"YYYY-MM"},r}()}).call(this,n(111)(e))},,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Commenter=100]="Commenter",e[e.SuggestOnly=200]="SuggestOnly",e[e.AddOnly=400]="AddOnly",e[e.ReadWrite=800]="ReadWrite",e[e.Admin=900]="Admin",e[e.Owner=1e3]="Owner"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return i.b})),n.d(t,"a",(function(){return i.a})),n.d(t,"c",(function(){return l}));var r=n(207),i=n(133);const o={normalizeProtocol:!0,stripHash:!0,stripWWW:!0,removeTrailingSlash:!0,removeQueryParameters:[/^utm_\w+/i],removeDirectoryIndex:[/^(default|index)\.\w{2,4}$/]};var s=new Map(Object.entries({"youtube.com":{rules:["v"],type:"keep"},"facebook.com":{rules:["fbid","q"],type:"keep"},"twitter.com":{rules:["q"],type:"keep"},"google.com":{rules:["q"],type:"keep"},"google.com.vn":{rules:["q"],type:"keep"},"google.com.au":{rules:["q"],type:"keep"},"google.com.tw":{rules:["q"],type:"keep"},"google.com.br":{rules:["q"],type:"keep"},"google.com.tr":{rules:["q"],type:"keep"},"google.com.gr":{rules:["q"],type:"keep"},"google.com.mx":{rules:["q"],type:"keep"},"google.com.ar":{rules:["q"],type:"keep"},"google.com.co":{rules:["q"],type:"keep"},"google.com.pk":{rules:["q"],type:"keep"},"google.co.jp":{rules:["q"],type:"keep"},"google.co.uk":{rules:["q"],type:"keep"},"google.co.in":{rules:["q"],type:"keep"},"google.co.kr":{rules:["q"],type:"keep"},"google.es":{rules:["q"],type:"keep"},"google.pl":{rules:["q"],type:"keep"},"google.pt":{rules:["q"],type:"keep"},"google.ie":{rules:["q"],type:"keep"},"google.cl":{rules:["q"],type:"keep"},"google.at":{rules:["q"],type:"keep"},"google.dk":{rules:["q"],type:"keep"},"google.be":{rules:["q"],type:"keep"},"google.ca":{rules:["q"],type:"keep"},"google.de":{rules:["q"],type:"keep"},"google.it":{rules:["q"],type:"keep"},"google.fr":{rules:["q"],type:"keep"},"google.nl":{rules:["q"],type:"keep"},"instagram.com":{rules:["taken-by"],type:"remove"},"blogspot.com":{rules:[],type:"keep"},"substack.com":{rules:[],type:"keep"}}));const a=/^\w+:\/\//;function c(e){const t=Object(r.parse)(e,!0),n=s.get(t.hostname);if(!n)return e;const i=new Set(n.rules),o=n.type;for(const e of[...Object.keys(t.query)]){("keep"===o?!i.has(e):i.has(e))&&delete t.query[e]}return function({protocol:e,hostname:t,pathname:n,query:r}){return`${e}//${t}${n}${Object.entries(r).reduce(((e,[t,n],r)=>e+`${0===r?"?":"&"}${t}=${n}`),"")}`}(t)}function l(e,t={}){var n;let r;try{r=Object(i.c)(e,Object.assign(Object.assign({},o),t))}catch(i){if(null!==(n=null==t?void 0:t.suppressParseError)&&void 0!==n&&!n)throw i;r=e}return t.skipQueryRules||(r=c(r)),t.skipProtocolTrim?r:r.replace(a,"")}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return h}));const r=Math.pow(2,32),i=Number.MAX_SAFE_INTEGER,o=0,s=Math.floor(i/2);class a extends Error{constructor(){super(...arguments),this.type="item-order"}}const c=(e,t)=>({create:{id:t,key:e},update:[]});function l(e,t,n=r,o=s,l=i){const u=e[e.length-1],d=null==u?void 0:u.key;if(!d)return c(o,t);if(l-d<n)throw new a("No space left to push ordered item");return c(d+n,t)}function u(e,t,n,s=r,l=i){const u=e[n];if(!u)throw new Error(`Tried to insert item before non-existing index: ${n}`);if(u.id===t)return c(u.key,t);const d=e[n-1],h=u.key,f=null==d?void 0:d.key;let p;if(p=f?Math.floor((f+h)/2):h-s,p===f||p===h||p<o||p>l)throw new a(`No space left to insert ordered item before index: ${n}`);return c(p,t)}function d(e,t){return e.order-t.order}function h(e,t=r,n=s){const i=[...e].sort(d),o=Math.floor(i.length/2);for(let e=0;e<i.length;e++){const r=(e-o)*t;i[e].order=e===o?n:n+r}return i}},,,function(e,t,n){var r=n(16);function i(e){e=e||{},this.ref=e.ref,this.index=e.index,this.text=e.text,this.tags=e.tags||{},this.start=new o(e.start,e.ref),e.end&&(this.end=new o(e.end,e.ref))}function o(e,t){if(this.knownValues={},this.impliedValues={},e)for(key in e)this.knownValues[key]=e[key];t&&(t=r(t),this.imply("day",t.date()),this.imply("month",t.month()+1),this.imply("year",t.year())),this.imply("hour",12),this.imply("minute",0),this.imply("second",0),this.imply("millisecond",0)}i.prototype.clone=function(){var e=new i(this);e.tags=JSON.parse(JSON.stringify(this.tags)),e.start=this.start.clone(),this.end&&(e.end=this.end.clone())},i.prototype.hasPossibleDates=function(){return this.start.isPossibleDate()&&(!this.end||this.end.isPossibleDate())},o.prototype.clone=function(){var e=new o;return e.knownValues=JSON.parse(JSON.stringify(this.knownValues)),e.impliedValues=JSON.parse(JSON.stringify(this.impliedValues)),e},o.prototype.get=function(e,t){return e in this.knownValues?this.knownValues[e]:e in this.impliedValues?this.impliedValues[e]:void 0},o.prototype.assign=function(e,t){this.knownValues[e]=t,delete this.impliedValues[e]},o.prototype.imply=function(e,t){e in this.knownValues||(this.impliedValues[e]=t)},o.prototype.isCertain=function(e){return e in this.knownValues},o.prototype.isPossibleDate=function(){var e=this.moment();return this.isCertain("timezoneOffset")&&e.utcOffset(this.get("timezoneOffset")),e.get("year")==this.get("year")&&(e.get("month")==this.get("month")-1&&(e.get("date")==this.get("day")&&(e.get("hour")==this.get("hour")&&e.get("minute")==this.get("minute"))))},o.prototype.date=function(){return this.moment().toDate()},o.prototype.moment=function(){var e=r();e.set("year",this.get("year")),e.set("month",this.get("month")-1),e.set("date",this.get("day")),e.set("hour",this.get("hour")),e.set("minute",this.get("minute")),e.set("second",this.get("second")),e.set("millisecond",this.get("millisecond"));var t=e.utcOffset(),n=(this.isCertain("timezoneOffset")?this.get("timezoneOffset"):t)-t;return e.add(-n,"minutes"),e},t.ParsedComponents=o,t.ParsedResult=i},function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"j",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"g",(function(){return a})),n.d(t,"i",(function(){return c})),n.d(t,"k",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return p}));const r={ALL:"all",FAIL:"fail",SUCC:"success"},i={SKIP:"Skipped",FAIL:"Failed",SUCC:"Success"},o={LOADING:"loading",IDLE:"idle",RUNNING:"running",PAUSED:"paused",STOPPED:"stopped"},s={BOOKMARK:"b",HISTORY:"h",OTHERS:"o"},a={POCKET:"p",NETSCAPE:"n"},c={[s.BOOKMARK]:"bookmarks",[s.HISTORY]:"history",[s.OTHERS]:"pocket"},l={HISTORY_STATS:"history_stats",BOOKMARK_STATS:"bookmark_stats",ALLOW_TYPES:"allow_types",DOWNLOAD_DATA:"import_progress",IMPORT_STATE:"import_state",TOTALS_STATE:"import_totals_state",SUCCESS_STATE:"import_success_progress_state",FAIL_STATE:"import_fail_progress_state"},u="imports-bg-ui-runtime-connection",d="imports/",h={INIT:`${d}INIT`,START:`${d}START`,PAUSE:`${d}PAUSE`,RESUME:`${d}RESUME`,FINISH:`${d}FINISH`,CANCEL:`${d}CANCEL`,NEXT:`${d}NEXT`,COMPLETE:`${d}COMPLETE`,RECALC:`${d}RECALC`,SET_CONCURRENCY:`${d}SET_CONCURRENCY`,SET_PROCESS_ERRS:`${d}SET_PROCESS_ERRS`},f=.5,p=10;s.HISTORY,s.BOOKMARK,s.OTHERS},,function(e,t,n){t.Parser=function(e){var t=(e=e||{}).strict;this.isStrictMode=function(){return 1==t},this.pattern=function(){return/./i},this.extract=function(e,t,n,r){return null},this.execute=function(e,t,n){for(var r=[],i=this.pattern(),o=e,s=i.exec(o);s;){s.index+=e.length-o.length;var a=this.extract(e,t,s,n);a?(o=e.substring(a.index+a.text.length),this.isStrictMode()&&!a.hasPossibleDates()||r.push(a)):o=e.substring(s.index+1),s=i.exec(o)}return this.refiners&&this.refiners.forEach((function(){r=refiner.refine(r,e,options)})),r}},t.ENISOFormatParser=n(803).Parser,t.ENDeadlineFormatParser=n(804).Parser,t.ENRelativeDateFormatParser=n(805).Parser,t.ENMonthNameLittleEndianParser=n(806).Parser,t.ENMonthNameMiddleEndianParser=n(807).Parser,t.ENMonthNameParser=n(808).Parser,t.ENSlashDateFormatParser=n(809).Parser,t.ENSlashDateFormatStartWithYearParser=n(810).Parser,t.ENSlashMonthFormatParser=n(811).Parser,t.ENTimeAgoFormatParser=n(812).Parser,t.ENTimeExpressionParser=n(813).Parser,t.ENTimeFromNowFormatParser=n(814).Parser,t.ENWeekdayParser=n(348).Parser,t.ENCasualDateParser=n(815).Parser,t.ENCasualTimeParser=n(816).Parser,t.JPStandardParser=n(817).Parser,t.JPCasualDateParser=n(819).Parser,t.ESCasualDateParser=n(820).Parser,t.ESDeadlineFormatParser=n(821).Parser,t.ESTimeAgoFormatParser=n(822).Parser,t.ESTimeExpressionParser=n(823).Parser,t.ESWeekdayParser=n(824).Parser,t.ESMonthNameLittleEndianParser=n(825).Parser,t.ESSlashDateFormatParser=n(827).Parser,t.FRCasualDateParser=n(828).Parser,t.FRDeadlineFormatParser=n(829).Parser,t.FRMonthNameLittleEndianParser=n(830).Parser,t.FRSlashDateFormatParser=n(831).Parser,t.FRTimeAgoFormatParser=n(832).Parser,t.FRTimeExpressionParser=n(833).Parser,t.FRWeekdayParser=n(834).Parser,t.FRRelativeDateFormatParser=n(835).Parser,t.ZHHantDateParser=n(837).Parser,t.ZHHantWeekdayParser=n(838).Parser,t.ZHHantTimeExpressionParser=n(839).Parser,t.ZHHantCasualDateParser=n(840).Parser,t.ZHHantDeadlineFormatParser=n(841).Parser,t.DEDeadlineFormatParser=n(842).Parser,t.DEMonthNameLittleEndianParser=n(843).Parser,t.DEMonthNameParser=n(844).Parser,t.DESlashDateFormatParser=n(845).Parser,t.DETimeAgoFormatParser=n(846).Parser,t.DETimeExpressionParser=n(847).Parser,t.DEWeekdayParser=n(848).Parser,t.DECasualDateParser=n(849).Parser},,,function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));const r="desc",i="asc",o={production:"https://cloudfare-memex.memex.workers.dev",staging:"https://cloudflare-memex-staging.memex.workers.dev",development:"https://cloudflare-memex-staging.memex.workers.dev"}},function(e,t,n){"use strict";n.r(t),function(e,r){n.d(t,"CONSTANTS",(function(){return i})),n.d(t,"DecodeBase64StringError",(function(){return l})),n.d(t,"Deferred",(function(){return T})),n.d(t,"ErrorFactory",(function(){return U})),n.d(t,"FirebaseError",(function(){return F})),n.d(t,"MAX_VALUE_MILLIS",(function(){return be})),n.d(t,"RANDOM_FACTOR",(function(){return _e})),n.d(t,"Sha1",(function(){return ie})),n.d(t,"areCookiesEnabled",(function(){return M})),n.d(t,"assert",(function(){return o})),n.d(t,"assertionError",(function(){return s})),n.d(t,"async",(function(){return ae})),n.d(t,"base64",(function(){return c})),n.d(t,"base64Decode",(function(){return h})),n.d(t,"base64Encode",(function(){return u})),n.d(t,"base64urlEncodeWithoutPadding",(function(){return d})),n.d(t,"calculateBackoffMillis",(function(){return we})),n.d(t,"contains",(function(){return K})),n.d(t,"createMockUserToken",(function(){return E})),n.d(t,"createSubscribe",(function(){return oe})),n.d(t,"decode",(function(){return H})),n.d(t,"deepCopy",(function(){return f})),n.d(t,"deepEqual",(function(){return J})),n.d(t,"deepExtend",(function(){return p})),n.d(t,"errorPrefix",(function(){return ue})),n.d(t,"extractQuerystring",(function(){return re})),n.d(t,"getDefaultAppConfig",(function(){return _})),n.d(t,"getDefaultEmulatorHost",(function(){return v})),n.d(t,"getDefaultEmulatorHostnameAndPort",(function(){return b})),n.d(t,"getDefaults",(function(){return y})),n.d(t,"getExperimentalSetting",(function(){return w})),n.d(t,"getGlobal",(function(){return m})),n.d(t,"getModularInstance",(function(){return Ee})),n.d(t,"getUA",(function(){return A})),n.d(t,"isAdmin",(function(){return V})),n.d(t,"isBrowser",(function(){return I})),n.d(t,"isBrowserExtension",(function(){return C})),n.d(t,"isElectron",(function(){return P})),n.d(t,"isEmpty",(function(){return Q})),n.d(t,"isIE",(function(){return x})),n.d(t,"isIndexedDBAvailable",(function(){return N})),n.d(t,"isMobileCordova",(function(){return S})),n.d(t,"isNode",(function(){return O})),n.d(t,"isNodeSdk",(function(){return L})),n.d(t,"isReactNative",(function(){return k})),n.d(t,"isSafari",(function(){return D})),n.d(t,"isUWP",(function(){return R})),n.d(t,"isValidFormat",(function(){return z})),n.d(t,"isValidTimestamp",(function(){return $})),n.d(t,"issuedAtTime",(function(){return W})),n.d(t,"jsonEval",(function(){return G})),n.d(t,"map",(function(){return X})),n.d(t,"ordinal",(function(){return Te})),n.d(t,"promiseWithTimeout",(function(){return ee})),n.d(t,"querystring",(function(){return te})),n.d(t,"querystringDecode",(function(){return ne})),n.d(t,"safeGet",(function(){return Y})),n.d(t,"stringLength",(function(){return ge})),n.d(t,"stringToByteArray",(function(){return pe})),n.d(t,"stringify",(function(){return q})),n.d(t,"uuidv4",(function(){return me})),n.d(t,"validateArgCount",(function(){return le})),n.d(t,"validateCallback",(function(){return he})),n.d(t,"validateContextObject",(function(){return fe})),n.d(t,"validateIndexedDBOpenable",(function(){return j})),n.d(t,"validateNamespace",(function(){return de}));const i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(e,t){if(!e)throw s(t)},s=function(e){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},a=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],o=t+1<e.length,s=o?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,l=i>>2,u=(3&i)<<4|s>>4;let d=(15&s)<<2|c>>6,h=63&c;a||(h=64,o||(d=64)),r.push(n[l],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(a(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{const o=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],o=t<e.length?n[e.charAt(t)]:0;++t;const s=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==o||null==s||null==a)throw new l;const c=i<<2|o>>4;if(r.push(c),64!==s){const e=o<<4&240|s>>2;if(r.push(e),64!==a){const e=s<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class l extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const u=function(e){const t=a(e);return c.encodeByteArray(t,!0)},d=function(e){return u(e).replace(/\./g,"")},h=function(e){try{return c.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function f(e){return p(void 0,e)}function p(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&g(n)&&(e[n]=p(e[n],t[n]));return e}function g(e){return"__proto__"!==e}function m(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e)return e;throw new Error("Unable to locate global object.")}const y=()=>{try{return m().__FIREBASE_DEFAULTS__||(()=>{if(void 0===r||void 0===r.env)return;const e=r.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&h(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},v=e=>{var t,n;return null===(n=null===(t=y())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},b=e=>{const t=v(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},_=()=>{var e;return null===(e=y())||void 0===e?void 0:e.config},w=e=>{var t;return null===(t=y())||void 0===t?void 0:t[`_${e}`]};class T{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function E(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[d(JSON.stringify({alg:"none",type:"JWT"})),d(JSON.stringify(o)),""].join(".")}function A(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function S(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(A())}function O(){var t;const n=null===(t=y())||void 0===t?void 0:t.forceEnvironment;if("node"===n)return!0;if("browser"===n)return!1;try{return"[object process]"===Object.prototype.toString.call(e.process)}catch(e){return!1}}function I(){return"object"==typeof self&&self.self===self}function C(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function k(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function P(){return A().indexOf("Electron/")>=0}function x(){const e=A();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function R(){return A().indexOf("MSAppHost/")>=0}function L(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN}function D(){return!O()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function N(){try{return"object"==typeof indexedDB}catch(e){return!1}}function j(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}function M(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}class F extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,F.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,U.prototype.create)}}class U{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?function(e,t){return e.replace(B,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",s=`${this.serviceName}: ${o} (${r}).`;return new F(r,s,n)}}const B=/\{\$([^}]+)}/g;function G(e){return JSON.parse(e)}function q(e){return JSON.stringify(e)}const H=function(e){let t={},n={},r={},i="";try{const o=e.split(".");t=G(h(o[0])||""),n=G(h(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}},$=function(e){const t=H(e).claims,n=Math.floor((new Date).getTime()/1e3);let r=0,i=0;return"object"==typeof t&&(t.hasOwnProperty("nbf")?r=t.nbf:t.hasOwnProperty("iat")&&(r=t.iat),i=t.hasOwnProperty("exp")?t.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},W=function(e){const t=H(e).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null},z=function(e){const t=H(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},V=function(e){const t=H(e).claims;return"object"==typeof t&&!0===t.admin};function K(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Y(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function Q(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function X(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function J(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],o=t[i];if(Z(n)&&Z(o)){if(!J(n,o))return!1}else if(n!==o)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function Z(e){return null!==e&&"object"==typeof e}function ee(e,t=2e3){const n=new T;return setTimeout((()=>n.reject("timeout!")),t),e.then(n.resolve,n.reject),n.promise}function te(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function ne(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function re(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class ie{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let r,i,o=this.chain_[0],s=this.chain_[1],a=this.chain_[2],c=this.chain_[3],l=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(r=c^s&(a^c),i=1518500249):(r=s^a^c,i=1859775393):e<60?(r=s&a|c&(s|a),i=2400959708):(r=s^a^c,i=3395469782);const t=(o<<5|o>>>27)+r+l+i+n[e]&4294967295;l=c,c=a,a=4294967295&(s<<30|s>>>2),s=o,o=t}this.chain_[0]=this.chain_[0]+o&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let o=this.inbuf_;for(;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}}function oe(e,t){const n=new se(e,t);return n.subscribe.bind(n)}class se{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=ce),void 0===r.error&&(r.error=ce),void 0===r.complete&&(r.complete=ce);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function ae(e,t){return(...n)=>{Promise.resolve(!0).then((()=>{e(...n)})).catch((e=>{t&&t(e)}))}}function ce(){}const le=function(e,t,n,r){let i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i){throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")}};function ue(e,t){return`${e} failed: ${t} argument `}function de(e,t,n){if((!n||t)&&"string"!=typeof t)throw new Error(ue(e,"namespace")+"must be a valid firebase namespace.")}function he(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(ue(e,t)+"must be a valid function.")}function fe(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(ue(e,t)+"must be a valid context object.")}const pe=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){const t=i-55296;r++,o(r<e.length,"Surrogate pair missing trail surrogate.");i=65536+(t<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},ge=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t},me=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},ye=1e3,ve=2,be=144e5,_e=.5;function we(e,t=ye,n=ve){const r=t*Math.pow(n,e),i=Math.round(_e*r*(Math.random()-.5)*2);return Math.min(be,r+i)}function Te(e){return Number.isFinite(e)?e+function(e){e=Math.abs(e);const t=e%100;if(t>=10&&t<=20)return"th";const n=e%10;if(1===n)return"st";if(2===n)return"nd";if(3===n)return"rd";return"th"}(e):`${e}`}function Ee(e){return e&&e._delegate?e._delegate:e}}.call(this,n(61),n(131))},function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return c}));new Date(Date.now());const r="@tabAI",i="@status",o="localSettings.signupTimestamp",s={pU:{AIpowerup:!1,Unlimited:!1,AIpowerupOwnKey:!1,bookmarksPowerUp:!1,lifetime:!1}},a={bookmarksPowerUp:3,AIpowerup:3},c=15},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return a}));var r=n(2),i=n(3),o=n.n(i);function s(e,t,n=null){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{[e]:r}=yield(n||o.a.storage.local).get(e);return void 0===r&&null!=t?a(e,t):r}))}function a(e,t,n=null){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield(n||o.a.storage.local).set({[e]:t}),t}))}},,function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return a}));var r=n(62);const i={INBOX:"Inbox",MOBILE:"Saved from Mobile",FEED:"Notifications"},o={INBOX:20201014,MOBILE:20201015,FEED:20201016},s={list:"customLists",listEntry:"pageListEntries",listTrees:"customListTrees",listDescription:"customListDescriptions",listEntryDescription:"pageListEntryDescriptions"},a={[s.list]:{version:r.a[28].version,fields:{id:{type:"int"},type:{type:"string",optional:!0},name:{type:"string"},searchableName:{type:"text",optional:!0},isDeletable:{type:"boolean",optional:!0},isNestable:{type:"boolean",optional:!0},createdAt:{type:"datetime"}},indices:[{field:"id",pk:!0},{field:"name"},{field:"searchableName",fullTextIndexName:"nameTerms"},{field:"isDeletable"},{field:"isNestable"},{field:"createdAt"}],history:[{version:new Date("2020-10-18"),fields:{id:{type:"int"},name:{type:"string"},searchableName:{type:"text",optional:!0},isDeletable:{type:"boolean",optional:!0},isNestable:{type:"boolean",optional:!0},createdAt:{type:"datetime"}},indices:[{field:"id",pk:!0},{field:"name"},{field:"searchableName",fullTextIndexName:"nameTerms"},{field:"isDeletable"},{field:"isNestable"},{field:"createdAt"}]},{version:new Date("2019-09-13"),fields:{id:{type:"int"},name:{type:"string"},isDeletable:{type:"boolean",optional:!0},isNestable:{type:"boolean",optional:!0},createdAt:{type:"datetime"}},indices:[{field:"id",pk:!0},{field:"name"},{field:"isDeletable"},{field:"isNestable"},{field:"createdAt"}]},{version:new Date("2018-07-12"),fields:{id:{type:"int"},name:{type:"string"},isDeletable:{type:"boolean",optional:!0},isNestable:{type:"boolean",optional:!0},createdAt:{type:"datetime"}},indices:[{field:"id",pk:!0},{field:"name",unique:!0},{field:"isDeletable"},{field:"isNestable"},{field:"createdAt"}]},{version:new Date("2019-08-21"),fields:{id:{type:"int"},name:{type:"string"},isDeletable:{type:"boolean",optional:!0},isNestable:{type:"boolean",optional:!0},createdAt:{type:"datetime"},updatedAt:{type:"datetime",optional:!0}},indices:[{field:"id",pk:!0},{field:"name",unique:!0},{field:"isDeletable"},{field:"isNestable"},{field:"createdAt"}]},{version:new Date("2019-08-29"),fields:{id:{type:"int"},name:{type:"string"},isDeletable:{type:"boolean",optional:!0},isNestable:{type:"boolean",optional:!0},createdAt:{type:"datetime"}},indices:[{field:"id",pk:!0},{field:"name",unique:!0},{field:"isDeletable"},{field:"isNestable"},{field:"createdAt"}]}]},[s.listEntry]:{version:r.a[39].version,fields:{listId:{type:"int"},pageUrl:{type:"string"},fullUrl:{type:"string"},createdAt:{type:"datetime"}},indices:[{field:["listId","pageUrl"],pk:!0},{field:"listId"},{field:"pageUrl"},{field:"createdAt"}],history:[{version:new Date("2018-07-12"),fields:{listId:{type:"int"},pageUrl:{type:"string"},fullUrl:{type:"string"},createdAt:{type:"datetime"}},indices:[{field:["listId","pageUrl"],pk:!0},{field:"listId"},{field:"pageUrl"}]}]},[s.listDescription]:{version:new Date(r.a[20].version),fields:{listId:{type:"int"},description:{type:"text"}},indices:[{field:"listId",pk:!0}]},[s.listEntryDescription]:{version:new Date(r.a[20].version),fields:{listId:{type:"int"},pageUrl:{type:"string"},description:{type:"text"}},indices:[{field:["listId","pageUrl"],pk:!0}]},[s.listTrees]:{version:new Date(r.a[36].version),fields:{listId:{type:"int",optional:null},linkTarget:{type:"int",optional:!0},path:{type:"string",optional:!0},parentListId:{type:"int",optional:!0},order:{type:"int"},createdWhen:{type:"timestamp"},updatedWhen:{type:"timestamp"}},indices:[{field:"listId"},{field:"path"},{field:"parentListId"},{field:"order"}]}}},,function(e,t,n){"use strict";n.d(t,"g",(function(){return i}));var r=n(86);function i(e){return`https://memex.social${Object(r.h)({remoteListId:e.remoteListId,remoteListEntryId:e.remoteListEntryId,collaborationKey:e.collaborationKey})}`}n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.c})),n.d(t,"c",(function(){return r.d})),n.d(t,"d",(function(){return r.e})),n.d(t,"e",(function(){return r.f})),n.d(t,"f",(function(){return r.g})),n.d(t,"h",(function(){return r.i}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2);class i{constructor(e,t){this.localBrowserStorage=e,this.options=t}set(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=this._makeStorageKey(e);yield this.localBrowserStorage.set({[n]:t})}))}get(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=this._makeStorageKey(e);return this.__rawGet(t)}))}remove(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=this._makeStorageKey(e);yield this.localBrowserStorage.remove(t)}))}__rawGet(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.localBrowserStorage.get(e);return null!==(t=n[e])&&void 0!==t?t:null}))}_makeStorageKey(e){var t,n;return(null!==(n=null===(t=this.options)||void 0===t?void 0:t.prefix)&&void 0!==n?n:"")+e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return c}));const r="https://en.wikipedia.org/wiki/Memex",i="https://memex.garden/onboarding",o={NEW_USER:"install"},s={annotation:"annotation",powerSearch:"powerSearch",backup:"backup"},a={shouldShowOnboarding:"should-show-onboarding",onboardingFlows:{[s.annotation]:"step-one-annotations",[s.powerSearch]:"step-two-power-search",[s.backup]:"step-four-backup"}},c={unvisited:"unvisited",redirected:"redirected",done:"DONE",annotation:{notifiedHighlightText:"highlight-text-notification-shown",notifiedSelectOption:"select-option-notification-shown",annotationCreated:"annotation-created"},powerSearch:{notifiedBrowsePage:"power-search-browse-shown"},tagging:{notifiedTagPage:"tag-page-notification-shown"}}},,function(e,t,n){var r=n(248),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},function(e,t){var n=Array.isArray;e.exports=n},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));const r={settings:"settings"},i={ACTIVITY_INDICATOR:"@ActivityIndicator-",SEARCH_INJECTION:"@SearchInjection-",CONTENT_SHARING:"@ContentSharing-",PDF_INTEGRATION:"@PDFIntegration-",IN_PAGE_UI:"@InPageUI-",DASHBOARD:"@Dashboard-",EXTENSION:"@Extension-",READWISE:"readwise.",OPENAI:"openAI.",HIGHLIGHT_COLORS:"highlightColors.",BETA_FEATURES:"@BetaFeatures-"},o={activityIndicator:{feedHasActivity:i.ACTIVITY_INDICATOR+"feedHasActivity"},contentSharing:{lastSharedAnnotationTimestamp:i.CONTENT_SHARING+"lastSharedAnnotationTimestamp"},dashboard:{listSidebarLocked:i.DASHBOARD+"listSidebarLocked",onboardingMsgSeen:i.DASHBOARD+"onboardingMsgSeen",subscribeBannerShownAfter:i.DASHBOARD+"subscribeBannerShownAfter"},extension:{blocklist:i.EXTENSION+"blocklist",keyboardShortcuts:i.EXTENSION+"keyboard_shortcuts",areTagsMigratedToSpaces:i.EXTENSION+"are_tags_migrated_to_spaces",shouldTrackAnalytics:i.EXTENSION+"should_track_analytics",shouldAutoCreateNoteLink:i.EXTENSION+"shouldAutoCreateNoteLink",shouldAutoAddSpaces:i.EXTENSION+"shouldAutoAddSpaces"},betaFeatures:{imageOverlay:i.BETA_FEATURES+"imageOverlay"},pdfIntegration:{shouldAutoOpen:i.PDF_INTEGRATION+"should_auto_open",shouldAutoUpload:i.PDF_INTEGRATION+"should_auto_upload"},inPageUI:{ribbonEnabled:i.IN_PAGE_UI+"ribbon_enabled",tooltipEnabled:i.IN_PAGE_UI+"tooltip_enabled",highlightsEnabled:i.IN_PAGE_UI+"highlights_enabled",ribbonPosition:i.IN_PAGE_UI+"ribbon_position"},searchInjection:{hideMemexResults:i.SEARCH_INJECTION+"hideMemexResults",memexResultsPosition:i.SEARCH_INJECTION+"memexResultsPosition",searchEnginesEnabled:i.SEARCH_INJECTION+"searchEnginesEnabled",stickyContainerEnabled:i.SEARCH_INJECTION+"stickyContainerEnabled"},readwise:{apiKey:i.READWISE+"apiKey"},openAI:{apiKey:i.OPENAI+"apiKey",promptSuggestions:i.OPENAI+"promptSuggestions",videoPromptSetting:i.OPENAI+"videoPromptSetting",selectedModel:i.OPENAI+"selectedModel"},highlightColors:{highlightColors:i.HIGHLIGHT_COLORS+"highlightColors"}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(37),i=n(43);const o=e=>({activityIndicator:new r.a(e.syncSettingsBG,{prefix:i.b.ACTIVITY_INDICATOR}),inPageUI:new r.a(e.syncSettingsBG,{prefix:i.b.IN_PAGE_UI}),dashboard:new r.a(e.syncSettingsBG,{prefix:i.b.DASHBOARD}),extension:new r.a(e.syncSettingsBG,{prefix:i.b.EXTENSION}),contentSharing:new r.a(e.syncSettingsBG,{prefix:i.b.CONTENT_SHARING}),pdfIntegration:new r.a(e.syncSettingsBG,{prefix:i.b.PDF_INTEGRATION}),readwise:new r.a(e.syncSettingsBG,{prefix:i.b.READWISE}),openAI:new r.a(e.syncSettingsBG,{prefix:i.b.OPENAI}),searchInjection:new r.a(e.syncSettingsBG,{prefix:i.b.SEARCH_INJECTION}),highlightColors:new r.a(e.syncSettingsBG,{prefix:i.b.HIGHLIGHT_COLORS}),betaFeatures:new r.a(e.syncSettingsBG,{prefix:i.b.BETA_FEATURES})})},,function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"j",(function(){return c})),n.d(t,"k",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"f",(function(){return h})),n.d(t,"i",(function(){return f})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return g}));var r=n(6);const i={analytics:Object(r.k)(),notifications:Object(r.k)(),bookmarks:Object(r.k)(),auth:Object(r.k)(),subscription:Object(r.k)(),featuresBeta:Object(r.k)(),tags:Object(r.k)(),pageActivityIndicator:Object(r.k)(),collections:Object(r.k)(),copyPaster:Object(r.k)(),readablePageArchives:Object(r.k)(),contentSharing:Object(r.k)(),personalCloud:Object(r.k)(),pdf:Object(r.k)(),analyticsBG:Object(r.k)()},o=i.notifications,s=i.bookmarks,a=i.auth,c=i.subscription,l=i.tags,u=i.collections,d=i.pageActivityIndicator,h=i.copyPaster,f=i.readablePageArchives,p=i.contentSharing,g=(Object(r.k)(),i.analyticsBG)},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return f}));var r=n(337),i=n.n(r),o=n(338),s=n.n(o);const a=/^(chrome|moz)-extension:\/\//,c=i.a;let l=!0;function u({reduxMiddlewares:e,stateTransformer:t=e=>e}){c.config("https://205014a0f65e4160a29db2935250b47c@sentry.io/305612",{shouldSendCallback:()=>l,whitelistUrls:[a],includePaths:[a],ignoreErrors:p}).install(),e&&e.push(s()(c,{stateTransformer:t}))}const d=e=>c.setUserContext(null!=e?e:void 0),h=(e,t)=>c.captureException(e,t),f=e=>c.captureBreadcrumb(e),p=["No registered remote function called handleHistoryStateUpdate","No registered remote function called confirmTabScriptLoaded","No registered remote function called teardownContentScripts","Error: Could not get a port to content-script-background","Cannot destructure property 'id' of 'i' as it is undefined.","NotAllowedError: Registration failed - permission denied","An error occurred. See https://git.io/JUIaE#17 for more information.","AbortError: Registration failed - push service error","Could not establish connection. Receiving end does not exist.","Error: Cannot inject content-scripts into page","Error: No tab with id:","Unable to download all specified images.","Could not establish connection. Receiving end does not exist.","A listener indicated an asynchronous response by returning true","DatabaseClosedError: UnknownError","DatabaseClosedError: InvalidStateError","DatabaseClosedError: UpgradeError","UpgradeError Not yet support for changing primary key","Tried to do 'findObjects' operation on non-existing collection: settings","Invariant Violation: update(): You provided an invalid spec to update()."]},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return a}));const r=e=>{try{const t=e.includes("youtube.com/"),n=e.includes("youtu.be/"),r=new URL(e);let i;if(n?(i=r.pathname.split("/")[1],i=i.split(/[?#&]/)[0]):t&&(i=r.searchParams.get("v")),!i)throw new Error("Could not extract YouTube video ID from URL: "+e);return i}catch(e){return null}},i=["youtube.com/","youtu.be/"],o=e=>{if(!(null==e?void 0:e.length))return!1;const t=e.includes(i[0]),n=e.includes(i[1]);return t||n},s=["odysee.com/","bitchute.com/","crowdbunker.com/","dailymotion.com/","vimeo.com/"],a=e=>o(e)||(e=>s.some((t=>e.startsWith(t))))(e)},function(e,t,n){"use strict";var r=n(2);let i;i=new class{constructor(){this.reset()}reset(){this.events=[],this.newEvents=[]}trackEvent(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.events.push({eventArgs:e,options:t}),this.newEvents.push({eventArgs:e,options:t})}))}popNew(){const e=this.newEvents;return this.newEvents=[],e}};t.a=i},function(e,t,n){"use strict";var r,i="object"==typeof Reflect?Reflect:null,o=i&&"function"==typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function l(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function u(e,t,n,r){var i,o,s,a;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),s=o[t]),void 0===s)s=o[t]=n,++e._eventsCount;else if("function"==typeof s?s=o[t]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(i=l(e))>0&&s.length>i&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return e}function d(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,o(this.listener,this.target,e))}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=d.bind(r);return i.listener=n,r.wrapFn=i,i}function f(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):g(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return l(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=i[e];if(void 0===c)return!1;if("function"==typeof c)o(c,this,t);else{var l=c.length,u=g(c,l);for(n=0;n<l;++n)o(u[n],this,t)}return!0},a.prototype.addListener=function(e,t){return u(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return u(this,e,t,!0)},a.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,h(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,h(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,r,i,o,s;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},a.prototype.listeners=function(e){return f(this,e,!0)},a.prototype.rawListeners=function(e){return f(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},a.prototype.listenerCount=p,a.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},,function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return a})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u}));const r={header:{heightPx:60},searchBar:{heightPx:50,widthPx:800},listsSidebar:{width:250},syncStatusMenu:{widthPx:150},searchResults:{widthPx:800}},i="DD MMM YYYY hh:mma",o=10,s="@Dashboard-",a={__OLD_subBannerDismissed:s+"subscribe_banner_dismissed",__OLD_listSidebarLocked:s+"list_sidebar_locked",__OLD_onboardingMsgSeen:s+"onboarding_msg_seen",mobileAdSeen:s+"mobile_ad_seen",useOldDash:s+"use_old_dashboard"},c=-1,l=20,u="missing-pdf"},function(e,t){e.exports=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r}},,,,,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r={0:{version:new Date("2018-02-01")},1:{version:new Date("2018-07-01")},2:{version:new Date("2018-07-12")},3:{version:new Date("2018-07-14")},4:{version:new Date("2018-08-03")},5:{version:new Date("2018-08-04")},6:{version:new Date("2018-08-26")},7:{version:new Date("2018-12-13")},8:{version:new Date("2019-01-04")},9:{version:new Date("2019-01-05")},10:{version:new Date("2019-02-02")},11:{version:new Date("2019-02-19")},12:{version:new Date("2019-04-22")},13:{version:new Date("2019-05-15")},14:{version:new Date("2019-05-17")},15:{version:new Date("2019-08-18")},16:{version:new Date("2019-08-21")},17:{version:new Date("2019-08-29")},18:{version:new Date("2019-09-13")},19:{version:new Date("2020-06-03")},20:{version:new Date("2020-07-15")},21:{version:new Date("2020-08-07")},22:{version:new Date("2020-10-13")},23:{version:new Date("2020-10-18")},24:{version:new Date("2021-04-12")},25:{version:new Date("2021-05-26")},26:{version:new Date("2021-09-07")},27:{version:new Date("2021-12-02")},28:{version:new Date("2022-12-06")},29:{version:new Date("2023-04-28")},30:{version:new Date("2023-05-03")},31:{version:new Date("2023-09-13")},32:{version:new Date("2023-09-15")},33:{version:new Date("2023-11-02")},34:{version:new Date("2023-11-03")},35:{version:new Date("2023-12-08")},36:{version:new Date("2023-12-12")},37:{version:new Date("2024-02-15")},38:{version:new Date("2024-03-05")},39:{version:new Date("2024-05-07")}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(129);const i=[{id:"default",color:Object.assign({},r.a),label:null},{id:"one",color:{r:112,g:214,b:255,a:1},label:null},{id:"two",color:{r:255,g:112,b:166,a:1},label:null},{id:"three",color:{r:255,g:151,b:112,a:1},label:null},{id:"four",color:{r:255,g:214,b:112,a:1},label:null},{id:"five",color:{r:233,g:255,b:112,a:1},label:null}]},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"i",(function(){return c})),n.d(t,"l",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h})),n.d(t,"j",(function(){return f})),n.d(t,"k",(function(){return p})),n.d(t,"h",(function(){return g}));var r=n(2);function i(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return e.trackBqEvent({eventName:"trackHitPaywall",str1:t.type})}))}function o(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return e.trackBqEvent({eventName:"onboardingSelection",str1:t.type})}))}function s(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return e.trackBqEvent({eventName:"trackPageLinkCreate",str1:t.source})}))}function a(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return e.trackBqEvent({eventName:"trackCopyInviteLink",str1:t.inviteType,str2:t.linkType,str3:t.source})}))}function c(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return e.trackBqEvent({eventName:"trackSharedAnnotation",str1:t.type})}))}function l(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return e.trackBqEvent({eventName:"trackUnSharedAnnotation",str1:t.type})}))}function u(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return e.trackBqEvent({eventName:"trackUnSharedAnnotation"})}))}function d(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return e.trackBqEvent({eventName:"createAnnotation",str1:t.annotationType})}))}function h(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return e.trackBqEvent({eventName:"createBookmark"})}))}function f(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return e.trackBqEvent({eventName:"trackSpaceCreate",str1:t.type})}))}function p(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return e.trackBqEvent({eventName:"trackSpaceEntryCreate",str1:t.type})}))}function g(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return e.trackBqEvent({eventName:"trackQueryAI"})}))}},function(e,t,n){"use strict";(function(e,r){n.d(t,"a",(function(){return Ju})),n.d(t,"b",(function(){return Xl})),n.d(t,"c",(function(){return Ml})),n.d(t,"d",(function(){return Il})),n.d(t,"e",(function(){return nd})),n.d(t,"f",(function(){return Jl})),n.d(t,"g",(function(){return A})),n.d(t,"h",(function(){return eu})),n.d(t,"i",(function(){return rd})),n.d(t,"j",(function(){return id})),n.d(t,"k",(function(){return U})),n.d(t,"l",(function(){return Ed})),n.d(t,"m",(function(){return yt})),n.d(t,"n",(function(){return W})),n.d(t,"o",(function(){return $})),n.d(t,"p",(function(){return wl})),n.d(t,"q",(function(){return w})),n.d(t,"r",(function(){return at})),n.d(t,"s",(function(){return y})),n.d(t,"t",(function(){return yl})),n.d(t,"u",(function(){return yd})),n.d(t,"v",(function(){return Pd})),n.d(t,"w",(function(){return kd})),n.d(t,"x",(function(){return $l})),n.d(t,"y",(function(){return kl})),n.d(t,"z",(function(){return Pl})),n.d(t,"A",(function(){return Sl})),n.d(t,"B",(function(){return md})),n.d(t,"C",(function(){return Id})),n.d(t,"D",(function(){return Vl})),n.d(t,"E",(function(){return xl})),n.d(t,"F",(function(){return Gl})),n.d(t,"G",(function(){return ql})),n.d(t,"H",(function(){return zl})),n.d(t,"I",(function(){return Vu})),n.d(t,"J",(function(){return zu})),n.d(t,"K",(function(){return Ul})),n.d(t,"L",(function(){return _d})),n.d(t,"M",(function(){return ad})),n.d(t,"N",(function(){return ld})),n.d(t,"O",(function(){return ud})),n.d(t,"P",(function(){return dd})),n.d(t,"Q",(function(){return hd})),n.d(t,"R",(function(){return fd})),n.d(t,"S",(function(){return xd})),n.d(t,"T",(function(){return Bu})),n.d(t,"U",(function(){return Gu})),n.d(t,"V",(function(){return Kl})),n.d(t,"W",(function(){return Yl})),n.d(t,"X",(function(){return vd})),n.d(t,"Y",(function(){return bd})),n.d(t,"Z",(function(){return Fu})),n.d(t,"ab",(function(){return Lu})),n.d(t,"bb",(function(){return Ll})),n.d(t,"cb",(function(){return Rl})),n.d(t,"db",(function(){return Od})),n.d(t,"eb",(function(){return Cd})),n.d(t,"fb",(function(){return pd})),n.d(t,"gb",(function(){return p})),n.d(t,"hb",(function(){return sd})),n.d(t,"ib",(function(){return $u})),n.d(t,"jb",(function(){return Hu})),n.d(t,"kb",(function(){return gd})),n.d(t,"lb",(function(){return Wl})),n.d(t,"mb",(function(){return Nu}));var i=n(74),o=n(201),s=n(322),a=n(30),c=n(323);const l="@firebase/firestore";class u{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}u.UNAUTHENTICATED=new u(null),u.GOOGLE_CREDENTIALS=new u("google-credentials-uid"),u.FIRST_PARTY=new u("first-party-uid"),u.MOCK_USER=new u("mock-user");let d="10.11.0";const h=new s.Logger("@firebase/firestore");function f(){return h.logLevel}function p(e){h.setLogLevel(e)}function g(e,...t){if(h.logLevel<=s.LogLevel.DEBUG){const n=t.map(v);h.debug(`Firestore (${d}): ${e}`,...n)}}function m(e,...t){if(h.logLevel<=s.LogLevel.ERROR){const n=t.map(v);h.error(`Firestore (${d}): ${e}`,...n)}}function y(e,...t){if(h.logLevel<=s.LogLevel.WARN){const n=t.map(v);h.warn(`Firestore (${d}): ${e}`,...n)}}function v(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function b(e="Unexpected state"){const t=`FIRESTORE (${d}) INTERNAL ASSERTION FAILED: `+e;throw m(t),new Error(t)}function _(e,t){e||b()}function w(e,t){e||b()}function T(e,t){return e}const E={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class A extends a.FirebaseError{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class S{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class O{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class I{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(u.UNAUTHENTICATED)))}shutdown(){}}class C{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class k{constructor(e){this.t=e,this.currentUser=u.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new S;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new S,e.enqueueRetryable((()=>r(this.currentUser)))};const o=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},s=e=>{g("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit((e=>s(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(g("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new S)}}),0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(g("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(_("string"==typeof t.accessToken),new O(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return _(null===e||"string"==typeof e),new u(e)}}class P{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=u.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class x{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new P(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(u.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class R{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class L{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const n=e=>{null!=e.error&&g("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,g("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{g("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):g("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(_("string"==typeof e.token),this.R=e.token,new R(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function D(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class N{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=D(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function j(e,t){return e<t?-1:e>t?1:0}function M(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function F(e){return e+"\0"}class U{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new A(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new A(E.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new A(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new A(E.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return U.fromMillis(Date.now())}static fromDate(e){return U.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new U(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?j(this.nanoseconds,e.nanoseconds):j(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class B{constructor(e){this.timestamp=e}static fromTimestamp(e){return new B(e)}static min(){return new B(new U(0,0))}static max(){return new B(new U(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class G{constructor(e,t,n){void 0===t?t=0:t>e.length&&b(),void 0===n?n=e.length-t:n>e.length-t&&b(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===G.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof G?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class q extends G{construct(e,t,n){return new q(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new A(E.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new q(t)}static emptyPath(){return new q([])}}const H=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class $ extends G{construct(e,t,n){return new $(e,t,n)}static isValidIdentifier(e){return H.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),$.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new $(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new A(E.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new A(E.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new A(E.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(o=!o,r++):"."!==t||o?(n+=t,r++):(i(),r++)}if(i(),o)throw new A(E.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new $(t)}static emptyPath(){return new $([])}}class W{constructor(e){this.path=e}static fromPath(e){return new W(q.fromString(e))}static fromName(e){return new W(q.fromString(e).popFirst(5))}static empty(){return new W(q.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===q.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return q.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new W(new q(e.slice()))}}class z{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function V(e){return e.fields.find((e=>2===e.kind))}function K(e){return e.fields.filter((e=>2!==e.kind))}z.UNKNOWN_ID=-1;class Y{constructor(e,t){this.fieldPath=e,this.kind=t}}class Q{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Q(0,Z.min())}}function X(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=B.fromTimestamp(1e9===r?new U(n+1,0):new U(n,r));return new Z(i,W.empty(),t)}function J(e){return new Z(e.readTime,e.key,-1)}class Z{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Z(B.min(),W.empty(),-1)}static max(){return new Z(B.max(),W.empty(),-1)}}function ee(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=W.comparator(e.documentKey,t.documentKey),0!==n?n:j(e.largestBatchId,t.largestBatchId))}const te="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ne{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function re(e){if(e.code!==E.FAILED_PRECONDITION||e.message!==te)throw e;g("LocalStore","Unexpectedly lost primary lease")}class ie{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&b(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ie(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ie?t:ie.resolve(t)}catch(e){return ie.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ie.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ie.reject(t)}static resolve(e){return new ie(((t,n)=>{t(e)}))}static reject(e){return new ie(((t,n)=>{n(e)}))}static waitFor(e){return new ie(((t,n)=>{let r=0,i=0,o=!1;e.forEach((e=>{++r,e.next((()=>{++i,o&&i===r&&t()}),(e=>n(e)))})),o=!0,i===r&&t()}))}static or(e){let t=ie.resolve(!1);for(const n of e)t=t.next((e=>e?ie.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new ie(((n,r)=>{const i=e.length,o=new Array(i);let s=0;for(let a=0;a<i;a++){const c=a;t(e[c]).next((e=>{o[c]=e,++s,s===i&&n(o)}),(e=>r(e)))}}))}static doWhile(e,t){return new ie(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}class oe{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new S,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new ce(e,t.error)):this.V.resolve()},this.transaction.onerror=t=>{const n=fe(t.target.error);this.V.reject(new ce(e,n))}}static open(e,t,n,r){try{return new oe(t,e.transaction(r,n))}catch(e){throw new ce(t,e)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(g("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new ue(t)}}class se{constructor(e,t,n){this.name=e,this.version=t,this.p=n,12.2===se.S(Object(a.getUA)())&&m("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return g("SimpleDb","Removing database:",e),de(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Object(a.isIndexedDBAvailable)())return!1;if(se.C())return!0;const e=Object(a.getUA)(),t=se.S(e),n=0<t&&t<10,r=se.v(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static C(){var t;return void 0!==e&&"YES"===(null===(t=e.__PRIVATE_env)||void 0===t?void 0:t.F)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static v(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(e){return this.db||(g("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new ce(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new A(E.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new A(E.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new ce(e,r))},r.onupgradeneeded=e=>{g("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.p.N(t,r.transaction,e.oldVersion,this.version).next((()=>{g("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.L&&(this.db.onversionchange=e=>this.L(e)),this.db}B(e){this.L=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let o=0;for(;;){++o;try{this.db=await this.O(e);const t=oe.open(this.db,e,i?"readonly":"readwrite",n),o=r(t).next((e=>(t.g(),e))).catch((e=>(t.abort(e),ie.reject(e)))).toPromise();return o.catch((()=>{})),await t.m,o}catch(e){const t=e,n="FirebaseError"!==t.name&&o<3;if(g("SimpleDb","Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}class ae{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return de(this.k.delete())}}class ce extends A{constructor(e,t){super(E.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function le(e){return"IndexedDbTransactionError"===e.name}class ue{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(g("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(g("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),de(n)}add(e){return g("SimpleDb","ADD",this.store.name,e,e),de(this.store.add(e))}get(e){return de(this.store.get(e)).next((t=>(void 0===t&&(t=null),g("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return g("SimpleDb","DELETE",this.store.name,e),de(this.store.delete(e))}count(){return g("SimpleDb","COUNT",this.store.name),de(this.store.count())}W(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const e=r.getAll(n.range);return new ie(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}{const e=this.cursor(n),t=[];return this.G(e,((e,n)=>{t.push(n)})).next((()=>t))}}j(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new ie(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}H(e,t){g("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.J=!1;const r=this.cursor(n);return this.G(r,((e,t,n)=>n.delete()))}Y(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.G(r,t)}Z(e){const t=this.cursor({});return new ie(((n,r)=>{t.onerror=e=>{const t=fe(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}G(e,t){const n=[];return new ie(((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const o=new ae(i),s=t(i.primaryKey,i.value,o);if(s instanceof ie){const e=s.catch((e=>(o.done(),ie.reject(e))));n.push(e)}o.isDone?r():null===o.$?i.continue():i.continue(o.$)}})).next((()=>ie.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.J?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function de(e){return new ie(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=fe(e.target.error);n(t)}}))}let he=!1;function fe(e){const t=se.S(Object(a.getUA)());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new A("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return he||(he=!0,setTimeout((()=>{throw e}),0)),e}}return e}class pe{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ee(e){g("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{g("IndexBackfiller",`Documents written: ${await this.X.te()}`)}catch(e){le(e)?g("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",e):await re(e)}await this.ee(6e4)}))}}class ge{constructor(e,t){this.localStore=e,this.persistence=t}async te(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.ne(t,e)))}ne(e,t){const n=new Set;let r=t,i=!0;return ie.doWhile((()=>!0===i&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((t=>{if(null!==t&&!n.has(t))return g("IndexBackfiller",`Processing collection: ${t}`),this.re(e,t,r).next((e=>{r-=e,n.add(t)}));i=!1})))).next((()=>t-r))}re(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next((n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next((()=>this.ie(r,n))).next((n=>(g("IndexBackfiller",`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n)))).next((()=>i.size))}))))}ie(e,t){let n=e;return t.changes.forEach(((e,t)=>{const r=J(t);ee(r,n)>0&&(n=r)})),new Z(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class me{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.se(e),this.oe=e=>t.writeSequenceNumber(e))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}function ye(e){return null==e}function ve(e){return 0===e&&1/e==-1/0}function be(e){return"number"==typeof e&&Number.isInteger(e)&&!ve(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function _e(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Te(t)),t=we(e.get(n),t);return Te(t)}function we(e,t){let n=t;const r=e.length;for(let t=0;t<r;t++){const r=e.charAt(t);switch(r){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=r}}return n}function Te(e){return e+"\x01\x01"}function Ee(e){const t=e.length;if(_(t>=2),2===t)return _("\x01"===e.charAt(0)&&"\x01"===e.charAt(1)),q.emptyPath();const n=t-2,r=[];let i="";for(let o=0;o<t;){const t=e.indexOf("\x01",o);switch((t<0||t>n)&&b(),e.charAt(t+1)){case"\x01":const n=e.substring(o,t);let s;0===i.length?s=n:(i+=n,s=i,i=""),r.push(s);break;case"\x10":i+=e.substring(o,t),i+="\0";break;case"\x11":i+=e.substring(o,t+1);break;default:b()}o=t+2}return new q(r)}me._e=-1;const Ae=["userId","batchId"];function Se(e,t){return[e,_e(t)]}function Oe(e,t,n){return[e,_e(t),n]}const Ie={},Ce=["prefixPath","collectionGroup","readTime","documentId"],ke=["prefixPath","collectionGroup","documentId"],Pe=["collectionGroup","readTime","prefixPath","documentId"],xe=["canonicalId","targetId"],Re=["targetId","path"],Le=["path","targetId"],De=["collectionId","parent"],Ne=["indexId","uid"],je=["uid","sequenceNumber"],Me=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Fe=["indexId","uid","orderedDocumentKey"],Ue=["userId","collectionPath","documentId"],Be=["userId","collectionPath","largestBatchId"],Ge=["userId","collectionGroup","largestBatchId"],qe=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],He=[...qe,"documentOverlays"],$e=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],We=$e,ze=[...We,"indexConfiguration","indexState","indexEntries"],Ve=ze;class Ke extends ne{constructor(e,t){super(),this.ae=e,this.currentSequenceNumber=t}}function Ye(e,t){const n=T(e);return se.M(n.ae,t)}function Qe(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Xe(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Je(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Ze{constructor(e,t){this.comparator=e,this.root=t||tt.EMPTY}insert(e,t){return new Ze(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,tt.BLACK,null,null))}remove(e){return new Ze(this.comparator,this.root.remove(e,this.comparator).copy(null,null,tt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new et(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new et(this.root,e,this.comparator,!1)}getReverseIterator(){return new et(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new et(this.root,e,this.comparator,!0)}}class et{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class tt{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:tt.RED,this.left=null!=r?r:tt.EMPTY,this.right=null!=i?i:tt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new tt(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return tt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return tt.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,tt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,tt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw b();if(this.right.isRed())throw b();const e=this.left.check();if(e!==this.right.check())throw b();return e+(this.isRed()?0:1)}}tt.EMPTY=null,tt.RED=!0,tt.BLACK=!1,tt.EMPTY=new class{constructor(){this.size=0}get key(){throw b()}get value(){throw b()}get color(){throw b()}get left(){throw b()}get right(){throw b()}copy(e,t,n,r,i){return this}insert(e,t,n){return new tt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class nt{constructor(e){this.comparator=e,this.data=new Ze(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new rt(this.data.getIterator())}getIteratorFrom(e){return new rt(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof nt))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new nt(this.comparator);return t.data=e,t}}class rt{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function it(e){return e.hasNext()?e.getNext():void 0}class ot{constructor(e){this.fields=e,e.sort($.comparator)}static empty(){return new ot([])}unionWith(e){let t=new nt($.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new ot(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return M(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class st extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function at(){return"undefined"!=typeof atob}class ct{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new st("Invalid base64 string: "+e):e}}(e);return new ct(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new ct(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return j(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ct.EMPTY_BYTE_STRING=new ct("");const lt=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ut(e){if(_(!!e),"string"==typeof e){let t=0;const n=lt.exec(e);if(_(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:dt(e.seconds),nanos:dt(e.nanos)}}function dt(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function ht(e){return"string"==typeof e?ct.fromBase64String(e):ct.fromUint8Array(e)}function ft(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function pt(e){const t=e.mapValue.fields.__previous_value__;return ft(t)?pt(t):t}function gt(e){const t=ut(e.mapValue.fields.__local_write_time__.timestampValue);return new U(t.seconds,t.nanos)}class mt{constructor(e,t,n,r,i,o,s,a,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.longPollingOptions=a,this.useFetchStreams=c}}class yt{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new yt("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof yt&&e.projectId===this.projectId&&e.database===this.database}}const vt={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},bt={nullValue:"NULL_VALUE"};function _t(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?ft(e)?4:Dt(e)?9007199254740991:10:b()}function wt(e,t){if(e===t)return!0;const n=_t(e);if(n!==_t(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return gt(e).isEqual(gt(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=ut(e.timestampValue),r=ut(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return ht(e.bytesValue).isEqual(ht(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return dt(e.geoPointValue.latitude)===dt(t.geoPointValue.latitude)&&dt(e.geoPointValue.longitude)===dt(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return dt(e.integerValue)===dt(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=dt(e.doubleValue),r=dt(t.doubleValue);return n===r?ve(n)===ve(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return M(e.arrayValue.values||[],t.arrayValue.values||[],wt);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Qe(n)!==Qe(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!wt(n[e],r[e])))return!1;return!0}(e,t);default:return b()}}function Tt(e,t){return void 0!==(e.values||[]).find((e=>wt(e,t)))}function Et(e,t){if(e===t)return 0;const n=_t(e),r=_t(t);if(n!==r)return j(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return j(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=dt(e.integerValue||e.doubleValue),r=dt(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return At(e.timestampValue,t.timestampValue);case 4:return At(gt(e),gt(t));case 5:return j(e.stringValue,t.stringValue);case 6:return function(e,t){const n=ht(e),r=ht(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=j(n[e],r[e]);if(0!==t)return t}return j(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=j(dt(e.latitude),dt(t.latitude));return 0!==n?n:j(dt(e.longitude),dt(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=Et(n[e],r[e]);if(t)return t}return j(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===vt.mapValue&&t===vt.mapValue)return 0;if(e===vt.mapValue)return 1;if(t===vt.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},o=Object.keys(i);r.sort(),o.sort();for(let e=0;e<r.length&&e<o.length;++e){const t=j(r[e],o[e]);if(0!==t)return t;const s=Et(n[r[e]],i[o[e]]);if(0!==s)return s}return j(r.length,o.length)}(e.mapValue,t.mapValue);default:throw b()}}function At(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return j(e,t);const n=ut(e),r=ut(t),i=j(n.seconds,r.seconds);return 0!==i?i:j(n.nanos,r.nanos)}function St(e){return Ot(e)}function Ot(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=ut(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return ht(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return W.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Ot(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${Ot(e.fields[i])}`;return n+"}"}(e.mapValue):b()}function It(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Ct(e){return!!e&&"integerValue"in e}function kt(e){return!!e&&"arrayValue"in e}function Pt(e){return!!e&&"nullValue"in e}function xt(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Rt(e){return!!e&&"mapValue"in e}function Lt(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Xe(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Lt(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Lt(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Dt(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function Nt(e){return"nullValue"in e?bt:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?It(yt.empty(),W.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:b()}function jt(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?It(yt.empty(),W.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?vt:b()}function Mt(e,t){const n=Et(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function Ft(e,t){const n=Et(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class Ut{constructor(e){this.value=e}static empty(){return new Ut({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Rt(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Lt(t)}setAll(e){let t=$.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Lt(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Rt(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return wt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Rt(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Xe(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new Ut(Lt(this.value))}}function Bt(e){const t=[];return Xe(e.fields,((e,n)=>{const r=new $([e]);if(Rt(n)){const e=Bt(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new ot(t)}class Gt{constructor(e,t,n,r,i,o,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=o,this.documentState=s}static newInvalidDocument(e){return new Gt(e,0,B.min(),B.min(),B.min(),Ut.empty(),0)}static newFoundDocument(e,t,n,r){return new Gt(e,1,t,B.min(),n,r,0)}static newNoDocument(e,t){return new Gt(e,2,t,B.min(),B.min(),Ut.empty(),0)}static newUnknownDocument(e,t){return new Gt(e,3,t,B.min(),B.min(),Ut.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(B.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ut.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ut.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=B.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Gt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Gt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class qt{constructor(e,t){this.position=e,this.inclusive=t}}function Ht(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const o=t[i],s=e.position[i];if(r=o.field.isKeyField()?W.comparator(W.fromName(s.referenceValue),n.key):Et(s,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return r}function $t(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!wt(e.position[n],t.position[n]))return!1;return!0}class Wt{constructor(e,t="asc"){this.field=e,this.dir=t}}function zt(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Vt{}class Kt extends Vt{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new on(e,t,n):"array-contains"===t?new ln(e,n):"in"===t?new un(e,n):"not-in"===t?new dn(e,n):"array-contains-any"===t?new hn(e,n):new Kt(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new sn(e,n):new an(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Et(t,this.value)):null!==t&&_t(this.value)===_t(t)&&this.matchesComparison(Et(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return b()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Yt extends Vt{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new Yt(e,t)}matches(e){return Qt(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Qt(e){return"and"===e.op}function Xt(e){return"or"===e.op}function Jt(e){return Zt(e)&&Qt(e)}function Zt(e){for(const t of e.filters)if(t instanceof Yt)return!1;return!0}function en(e){if(e instanceof Kt)return e.field.canonicalString()+e.op.toString()+St(e.value);if(Jt(e))return e.filters.map((e=>en(e))).join(",");{const t=e.filters.map((e=>en(e))).join(",");return`${e.op}(${t})`}}function tn(e,t){return e instanceof Kt?function(e,t){return t instanceof Kt&&e.op===t.op&&e.field.isEqual(t.field)&&wt(e.value,t.value)}(e,t):e instanceof Yt?function(e,t){return t instanceof Yt&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&tn(n,t.filters[r])),!0)}(e,t):void b()}function nn(e,t){const n=e.filters.concat(t);return Yt.create(n,e.op)}function rn(e){return e instanceof Kt?function(e){return`${e.field.canonicalString()} ${e.op} ${St(e.value)}`}(e):e instanceof Yt?function(e){return e.op.toString()+" {"+e.getFilters().map(rn).join(" ,")+"}"}(e):"Filter"}class on extends Kt{constructor(e,t,n){super(e,t,n),this.key=W.fromName(n.referenceValue)}matches(e){const t=W.comparator(e.key,this.key);return this.matchesComparison(t)}}class sn extends Kt{constructor(e,t){super(e,"in",t),this.keys=cn("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class an extends Kt{constructor(e,t){super(e,"not-in",t),this.keys=cn("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function cn(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>W.fromName(e.referenceValue)))}class ln extends Kt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return kt(t)&&Tt(t.arrayValue,this.value)}}class un extends Kt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Tt(this.value.arrayValue,t)}}class dn extends Kt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Tt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Tt(this.value.arrayValue,t)}}class hn extends Kt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!kt(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Tt(this.value.arrayValue,e)))}}class fn{constructor(e,t=null,n=[],r=[],i=null,o=null,s=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.ce=null}}function pn(e,t=null,n=[],r=[],i=null,o=null,s=null){return new fn(e,t,n,r,i,o,s)}function gn(e){const t=T(e);if(null===t.ce){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>en(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),ye(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>St(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>St(e))).join(",")),t.ce=e}return t.ce}function mn(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!zt(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!tn(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!$t(e.startAt,t.startAt)&&$t(e.endAt,t.endAt)}function yn(e){return W.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function vn(e,t){return e.filters.filter((e=>e instanceof Kt&&e.field.isEqual(t)))}function bn(e,t,n){let r=bt,i=!0;for(const n of vn(e,t)){let e=bt,t=!0;switch(n.op){case"<":case"<=":e=Nt(n.value);break;case"==":case"in":case">=":e=n.value;break;case">":e=n.value,t=!1;break;case"!=":case"not-in":e=bt}Mt({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let o=0;o<e.orderBy.length;++o)if(e.orderBy[o].field.isEqual(t)){const e=n.position[o];Mt({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function _n(e,t,n){let r=vt,i=!0;for(const n of vn(e,t)){let e=vt,t=!0;switch(n.op){case">=":case">":e=jt(n.value),t=!1;break;case"==":case"in":case"<=":e=n.value;break;case"<":e=n.value,t=!1;break;case"!=":case"not-in":e=vt}Ft({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let o=0;o<e.orderBy.length;++o)if(e.orderBy[o].field.isEqual(t)){const e=n.position[o];Ft({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}class wn{constructor(e,t=null,n=[],r=[],i=null,o="F",s=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function Tn(e,t,n,r,i,o,s,a){return new wn(e,t,n,r,i,o,s,a)}function En(e){return new wn(e)}function An(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Sn(e){return null!==e.collectionGroup}function On(e){const t=T(e);if(null===t.le){t.le=[];const e=new Set;for(const n of t.explicitOrderBy)t.le.push(n),e.add(n.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new nt($.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.le.push(new Wt(r,n))})),e.has($.keyField().canonicalString())||t.le.push(new Wt($.keyField(),n))}return t.le}function In(e){const t=T(e);return t.he||(t.he=Cn(t,On(e))),t.he}function Cn(e,t){if("F"===e.limitType)return pn(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new Wt(e.field,t)}));const n=e.endAt?new qt(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new qt(e.startAt.position,e.startAt.inclusive):null;return pn(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function kn(e,t){const n=e.filters.concat([t]);return new wn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Pn(e,t,n){return new wn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function xn(e,t){return mn(In(e),In(t))&&e.limitType===t.limitType}function Rn(e){return`${gn(In(e))}|lt:${e.limitType}`}function Ln(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>rn(e))).join(", ")}]`),ye(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>St(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>St(e))).join(",")),`Target(${t})`}(In(e))}; limitType=${e.limitType})`}function Dn(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):W.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of On(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Ht(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,On(e),t))&&!(e.endAt&&!function(e,t,n){const r=Ht(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,On(e),t))}(e,t)}function Nn(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function jn(e){return(t,n)=>{let r=!1;for(const i of On(e)){const e=Mn(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Mn(e,t,n){const r=e.field.isKeyField()?W.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?Et(r,i):b()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return b()}}class Fn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Xe(this.inner,((t,n)=>{for(const[t,r]of n)e(t,r)}))}isEmpty(){return Je(this.inner)}size(){return this.innerSize}}const Un=new Ze(W.comparator);function Bn(){return Un}const Gn=new Ze(W.comparator);function qn(...e){let t=Gn;for(const n of e)t=t.insert(n.key,n);return t}function Hn(e){let t=Gn;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function $n(){return zn()}function Wn(){return zn()}function zn(){return new Fn((e=>e.toString()),((e,t)=>e.isEqual(t)))}const Vn=new Ze(W.comparator),Kn=new nt(W.comparator);function Yn(...e){let t=Kn;for(const n of e)t=t.add(n);return t}const Qn=new nt(j);function Xn(){return Qn}function Jn(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ve(t)?"-0":t}}function Zn(e){return{integerValue:""+e}}function er(e,t){return be(t)?Zn(t):Jn(e,t)}class tr{constructor(){this._=void 0}}function nr(e,t,n){return e instanceof or?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&ft(t)&&(t=pt(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof sr?ar(e,t):e instanceof cr?lr(e,t):function(e,t){const n=ir(e,t),r=dr(n)+dr(e.Ie);return Ct(n)&&Ct(e.Ie)?Zn(r):Jn(e.serializer,r)}(e,t)}function rr(e,t,n){return e instanceof sr?ar(e,t):e instanceof cr?lr(e,t):n}function ir(e,t){return e instanceof ur?function(e){return Ct(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class or extends tr{}class sr extends tr{constructor(e){super(),this.elements=e}}function ar(e,t){const n=hr(t);for(const t of e.elements)n.some((e=>wt(e,t)))||n.push(t);return{arrayValue:{values:n}}}class cr extends tr{constructor(e){super(),this.elements=e}}function lr(e,t){let n=hr(t);for(const t of e.elements)n=n.filter((e=>!wt(e,t)));return{arrayValue:{values:n}}}class ur extends tr{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function dr(e){return dt(e.integerValue||e.doubleValue)}function hr(e){return kt(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class fr{constructor(e,t){this.field=e,this.transform=t}}class pr{constructor(e,t){this.version=e,this.transformResults=t}}class gr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new gr}static exists(e){return new gr(void 0,e)}static updateTime(e){return new gr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function mr(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class yr{}function vr(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Cr(e.key,gr.none()):new Er(e.key,e.data,gr.none());{const n=e.data,r=Ut.empty();let i=new nt($.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Ar(e.key,r,new ot(i.toArray()),gr.none())}}function br(e,t,n){e instanceof Er?function(e,t,n){const r=e.value.clone(),i=Or(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Ar?function(e,t,n){if(!mr(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Or(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Sr(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function _r(e,t,n,r){return e instanceof Er?function(e,t,n,r){if(!mr(e.precondition,t))return n;const i=e.value.clone(),o=Ir(e.fieldTransforms,r,t);return i.setAll(o),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Ar?function(e,t,n,r){if(!mr(e.precondition,t))return n;const i=Ir(e.fieldTransforms,r,t),o=t.data;return o.setAll(Sr(e)),o.setAll(i),t.convertToFoundDocument(t.version,o).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return mr(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function wr(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=ir(r.transform,e||null);null!=i&&(null===n&&(n=Ut.empty()),n.set(r.field,i))}return n||null}function Tr(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&M(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof sr&&t instanceof sr||e instanceof cr&&t instanceof cr?M(e.elements,t.elements,wt):e instanceof ur&&t instanceof ur?wt(e.Ie,t.Ie):e instanceof or&&t instanceof or}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Er extends yr{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Ar extends yr{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Sr(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function Or(e,t,n){const r=new Map;_(e.length===n.length);for(let i=0;i<n.length;i++){const o=e[i],s=o.transform,a=t.data.field(o.field);r.set(o.field,rr(s,a,n[i]))}return r}function Ir(e,t,n){const r=new Map;for(const i of e){const e=i.transform,o=n.data.field(i.field);r.set(i.field,nr(e,o,t))}return r}class Cr extends yr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class kr extends yr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Pr{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&br(r,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=_r(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=_r(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Wn();return this.mutations.forEach((r=>{const i=e.get(r.key),o=i.overlayedDocument;let s=this.applyToLocalView(o,i.mutatedFields);s=t.has(r.key)?null:s;const a=vr(o,s);null!==a&&n.set(r.key,a),o.isValidDocument()||o.convertToNoDocument(B.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Yn())}isEqual(e){return this.batchId===e.batchId&&M(this.mutations,e.mutations,((e,t)=>Tr(e,t)))&&M(this.baseMutations,e.baseMutations,((e,t)=>Tr(e,t)))}}class xr{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){_(e.mutations.length===n.length);let r=Vn;const i=e.mutations;for(let e=0;e<i.length;e++)r=r.insert(i[e].key,n[e].version);return new xr(e,t,n,r)}}class Rr{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Lr{constructor(e,t){this.count=e,this.unchangedNames=t}}var Dr,Nr;function jr(e){switch(e){default:return b();case E.CANCELLED:case E.UNKNOWN:case E.DEADLINE_EXCEEDED:case E.RESOURCE_EXHAUSTED:case E.INTERNAL:case E.UNAVAILABLE:case E.UNAUTHENTICATED:return!1;case E.INVALID_ARGUMENT:case E.NOT_FOUND:case E.ALREADY_EXISTS:case E.PERMISSION_DENIED:case E.FAILED_PRECONDITION:case E.ABORTED:case E.OUT_OF_RANGE:case E.UNIMPLEMENTED:case E.DATA_LOSS:return!0}}function Mr(e){if(void 0===e)return m("GRPC error has no .code"),E.UNKNOWN;switch(e){case Dr.OK:return E.OK;case Dr.CANCELLED:return E.CANCELLED;case Dr.UNKNOWN:return E.UNKNOWN;case Dr.DEADLINE_EXCEEDED:return E.DEADLINE_EXCEEDED;case Dr.RESOURCE_EXHAUSTED:return E.RESOURCE_EXHAUSTED;case Dr.INTERNAL:return E.INTERNAL;case Dr.UNAVAILABLE:return E.UNAVAILABLE;case Dr.UNAUTHENTICATED:return E.UNAUTHENTICATED;case Dr.INVALID_ARGUMENT:return E.INVALID_ARGUMENT;case Dr.NOT_FOUND:return E.NOT_FOUND;case Dr.ALREADY_EXISTS:return E.ALREADY_EXISTS;case Dr.PERMISSION_DENIED:return E.PERMISSION_DENIED;case Dr.FAILED_PRECONDITION:return E.FAILED_PRECONDITION;case Dr.ABORTED:return E.ABORTED;case Dr.OUT_OF_RANGE:return E.OUT_OF_RANGE;case Dr.UNIMPLEMENTED:return E.UNIMPLEMENTED;case Dr.DATA_LOSS:return E.DATA_LOSS;default:return b()}}(Nr=Dr||(Dr={}))[Nr.OK=0]="OK",Nr[Nr.CANCELLED=1]="CANCELLED",Nr[Nr.UNKNOWN=2]="UNKNOWN",Nr[Nr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Nr[Nr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Nr[Nr.NOT_FOUND=5]="NOT_FOUND",Nr[Nr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Nr[Nr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Nr[Nr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Nr[Nr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Nr[Nr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Nr[Nr.ABORTED=10]="ABORTED",Nr[Nr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Nr[Nr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Nr[Nr.INTERNAL=13]="INTERNAL",Nr[Nr.UNAVAILABLE=14]="UNAVAILABLE",Nr[Nr.DATA_LOSS=15]="DATA_LOSS";let Fr=null;function Ur(){return new TextEncoder}const Br=new c.Integer([4294967295,4294967295],0);function Gr(e){const t=Ur().encode(e),n=new c.Md5;return n.update(t),new Uint8Array(n.digest())}function qr(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new c.Integer([n,r],0),new c.Integer([i,o],0)]}class Hr{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new $r(`Invalid padding: ${t}`);if(n<0)throw new $r(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new $r(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new $r(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ee=c.Integer.fromNumber(this.Te)}de(e,t,n){let r=e.add(t.multiply(c.Integer.fromNumber(n)));return 1===r.compare(Br)&&(r=new c.Integer([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Ee).toNumber()}Ae(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const t=Gr(e),[n,r]=qr(t);for(let e=0;e<this.hashCount;e++){const t=this.de(n,r,e);if(!this.Ae(t))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Hr(i,r,t);return n.forEach((e=>o.insert(e))),o}insert(e){if(0===this.Te)return;const t=Gr(e),[n,r]=qr(t);for(let e=0;e<this.hashCount;e++){const t=this.de(n,r,e);this.Re(t)}}Re(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class $r extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Wr{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,zr.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Wr(B.min(),r,new Ze(j),Bn(),Yn())}}class zr{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new zr(n,t,Yn(),Yn(),Yn())}}class Vr{constructor(e,t,n,r){this.Ve=e,this.removedTargetIds=t,this.key=n,this.me=r}}class Kr{constructor(e,t){this.targetId=e,this.fe=t}}class Yr{constructor(e,t,n=ct.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Qr{constructor(){this.ge=0,this.pe=Zr(),this.ye=ct.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=Yn(),t=Yn(),n=Yn();return this.pe.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:b()}})),new zr(this.ye,this.we,e,t,n)}Fe(){this.Se=!1,this.pe=Zr()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,_(this.ge>=0)}Le(){this.Se=!0,this.we=!0}}class Xr{constructor(e){this.Be=e,this.ke=new Map,this.qe=Bn(),this.Qe=Jr(),this.Ke=new Ze(j)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,(t=>{const n=this.ze(t);switch(e.state){case 0:this.je(t)&&n.Ce(e.resumeToken);break;case 1:n.Ne(),n.be||n.Fe(),n.Ce(e.resumeToken);break;case 2:n.Ne(),n.be||this.removeTarget(t);break;case 3:this.je(t)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),n.Ce(e.resumeToken));break;default:b()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach(((e,n)=>{this.je(n)&&t(n)}))}Je(e){const t=e.targetId,n=e.fe.count,r=this.Ye(t);if(r){const i=r.target;if(yn(i))if(0===n){const e=new W(i.path);this.We(t,e,Gt.newNoDocument(e,B.min()))}else _(1===n);else{const r=this.Ze(t);if(r!==n){const n=this.Xe(e),i=n?this.et(n,e,r):1;if(0!==i){this.He(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,e)}null==Fr||Fr.tt(function(e,t,n,r,i){var o,s,a,c,l,u;const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(d.bloomFilter={applied:0===i,hashCount:null!==(o=null==h?void 0:h.hashCount)&&void 0!==o?o:0,bitmapLength:null!==(c=null===(a=null===(s=null==h?void 0:h.bits)||void 0===s?void 0:s.bitmap)||void 0===a?void 0:a.length)&&void 0!==c?c:0,padding:null!==(u=null===(l=null==h?void 0:h.bits)||void 0===l?void 0:l.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),d}(r,e.fe,this.Be.nt(),n,i))}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let o,s;try{o=ht(n).toUint8Array()}catch(e){if(e instanceof st)return y("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{s=new Hr(o,r,i)}catch(e){return y(e instanceof $r?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===s.Te?null:s}et(e,t,n){return t.fe.count===n-this.rt(e,t.targetId)?0:2}rt(e,t){const n=this.Be.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.Be.nt(),o=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(o)||(this.We(t,n,null),r++)})),r}it(e){const t=new Map;this.ke.forEach(((n,r)=>{const i=this.Ye(r);if(i){if(n.current&&yn(i.target)){const t=new W(i.target.path);null!==this.qe.get(t)||this.st(r,t)||this.We(r,t,Gt.newNoDocument(t,e))}n.De&&(t.set(r,n.ve()),n.Fe())}}));let n=Yn();this.Qe.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Ye(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.qe.forEach(((t,n)=>n.setReadTime(e)));const r=new Wr(e,t,this.Ke,this.qe,n);return this.qe=Bn(),this.Qe=Jr(),this.Ke=new Ze(j),r}Ue(e,t){if(!this.je(e))return;const n=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,n),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,n){if(!this.je(e))return;const r=this.ze(e);this.st(e,t)?r.Me(t,1):r.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),n&&(this.qe=this.qe.insert(t,n))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Be.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new Qr,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new nt(j),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=null!==this.Ye(e);return t||g("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Be._t(e)}He(e){this.ke.set(e,new Qr),this.Be.getRemoteKeysForTarget(e).forEach((t=>{this.We(e,t,null)}))}st(e,t){return this.Be.getRemoteKeysForTarget(e).has(t)}}function Jr(){return new Ze(W.comparator)}function Zr(){return new Ze(W.comparator)}const ei={asc:"ASCENDING",desc:"DESCENDING"},ti={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ni={and:"AND",or:"OR"};class ri{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function ii(e,t){return e.useProto3Json||ye(t)?t:{value:t}}function oi(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function si(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function ai(e,t){return oi(e,t.toTimestamp())}function ci(e){return _(!!e),B.fromTimestamp(function(e){const t=ut(e);return new U(t.seconds,t.nanos)}(e))}function li(e,t){return ui(e,t).canonicalString()}function ui(e,t){const n=function(e){return new q(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function di(e){const t=q.fromString(e);return _(Li(t)),t}function hi(e,t){return li(e.databaseId,t.path)}function fi(e,t){const n=di(t);if(n.get(1)!==e.databaseId.projectId)throw new A(E.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new A(E.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new W(yi(n))}function pi(e,t){return li(e.databaseId,t)}function gi(e){const t=di(e);return 4===t.length?q.emptyPath():yi(t)}function mi(e){return new q(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function yi(e){return _(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function vi(e,t,n){return{name:hi(e,t),fields:n.value.mapValue.fields}}function bi(e,t,n){const r=fi(e,t.name),i=ci(t.updateTime),o=t.createTime?ci(t.createTime):B.min(),s=new Ut({mapValue:{fields:t.fields}}),a=Gt.newFoundDocument(r,i,o,s);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function _i(e,t){let n;if(t instanceof Er)n={update:vi(e,t.key,t.value)};else if(t instanceof Cr)n={delete:hi(e,t.key)};else if(t instanceof Ar)n={update:vi(e,t.key,t.data),updateMask:Ri(t.fieldMask)};else{if(!(t instanceof kr))return b();n={verify:hi(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof or)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof sr)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof cr)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof ur)return{fieldPath:t.field.canonicalString(),increment:n.Ie};throw b()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:ai(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:b()}(e,t.precondition)),n}function wi(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?gr.updateTime(ci(e.updateTime)):void 0!==e.exists?gr.exists(e.exists):gr.none()}(t.currentDocument):gr.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)_("REQUEST_TIME"===t.setToServerValue),n=new or;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new sr(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new cr(e)}else"increment"in t?n=new ur(e,t.increment):b();const r=$.fromServerFormat(t.fieldPath);return new fr(r,n)}(e,t))):[];if(t.update){t.update.name;const i=fi(e,t.update.name),o=new Ut({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new ot(t.map((e=>$.fromServerFormat(e))))}(t.updateMask);return new Ar(i,o,e,n,r)}return new Er(i,o,n,r)}if(t.delete){const r=fi(e,t.delete);return new Cr(r,n)}if(t.verify){const r=fi(e,t.verify);return new kr(r,n)}return b()}function Ti(e,t){return{documents:[pi(e,t.path)]}}function Ei(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=pi(e,i);const o=function(e){if(0!==e.length)return xi(Yt.create(e,"and"))}(t.filters);o&&(n.structuredQuery.where=o);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:ki(e.field),direction:Oi(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const a=ii(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ut:n,parent:i}}function Ai(e){let t=gi(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){_(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let o=[];n.where&&(o=function(e){const t=Si(e);return t instanceof Yt&&Jt(t)?t.getFilters():[t]}(n.where));let s=[];n.orderBy&&(s=function(e){return e.map((e=>function(e){return new Wt(Pi(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,ye(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new qt(n,t)}(n.startAt));let l=null;return n.endAt&&(l=function(e){const t=!e.before,n=e.values||[];return new qt(n,t)}(n.endAt)),Tn(t,i,s,o,a,"F",c,l)}function Si(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Pi(e.unaryFilter.field);return Kt.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Pi(e.unaryFilter.field);return Kt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Pi(e.unaryFilter.field);return Kt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Pi(e.unaryFilter.field);return Kt.create(i,"!=",{nullValue:"NULL_VALUE"});default:return b()}}(e):void 0!==e.fieldFilter?function(e){return Kt.create(Pi(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return b()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Yt.create(e.compositeFilter.filters.map((e=>Si(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return b()}}(e.compositeFilter.op))}(e):b()}function Oi(e){return ei[e]}function Ii(e){return ti[e]}function Ci(e){return ni[e]}function ki(e){return{fieldPath:e.canonicalString()}}function Pi(e){return $.fromServerFormat(e.fieldPath)}function xi(e){return e instanceof Kt?function(e){if("=="===e.op){if(xt(e.value))return{unaryFilter:{field:ki(e.field),op:"IS_NAN"}};if(Pt(e.value))return{unaryFilter:{field:ki(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(xt(e.value))return{unaryFilter:{field:ki(e.field),op:"IS_NOT_NAN"}};if(Pt(e.value))return{unaryFilter:{field:ki(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ki(e.field),op:Ii(e.op),value:e.value}}}(e):e instanceof Yt?function(e){const t=e.getFilters().map((e=>xi(e)));return 1===t.length?t[0]:{compositeFilter:{op:Ci(e.op),filters:t}}}(e):b()}function Ri(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Li(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Di{constructor(e,t,n,r,i=B.min(),o=B.min(),s=ct.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s,this.expectedCount=a}withSequenceNumber(e){return new Di(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Di(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Di(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Di(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Ni{constructor(e){this.ct=e}}function ji(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Mi(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:hi(e,t.key),fields:t.data.value.mapValue.fields,updateTime:oi(e,t.version.toTimestamp()),createTime:oi(e,t.createTime.toTimestamp())}}(e.ct,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Fi(t.version)};else{if(!t.isUnknownDocument())return b();r.unknownDocument={path:n.path.toArray(),version:Fi(t.version)}}return r}function Mi(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function Fi(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Ui(e){const t=new U(e.seconds,e.nanoseconds);return B.fromTimestamp(t)}function Bi(e,t){const n=(t.baseMutations||[]).map((t=>wi(e.ct,t)));for(let e=0;e<t.mutations.length-1;++e){const n=t.mutations[e];if(e+1<t.mutations.length&&void 0!==t.mutations[e+1].transform){const r=t.mutations[e+1];n.updateTransforms=r.transform.fieldTransforms,t.mutations.splice(e+1,1),++e}}const r=t.mutations.map((t=>wi(e.ct,t))),i=U.fromMillis(t.localWriteTimeMs);return new Pr(t.batchId,i,n,r)}function Gi(e){const t=Ui(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?Ui(e.lastLimboFreeSnapshotVersion):B.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){return _(1===e.documents.length),In(En(gi(e.documents[0])))}(e.query):function(e){return In(Ai(e))}(e.query),new Di(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,ct.fromBase64String(e.resumeToken))}function qi(e,t){const n=Fi(t.snapshotVersion),r=Fi(t.lastLimboFreeSnapshotVersion);let i;i=yn(t.target)?Ti(e.ct,t.target):Ei(e.ct,t.target).ut;const o=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:gn(t.target),readTime:n,resumeToken:o,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Hi(e){const t=Ai({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Pn(t,t.limit,"L"):t}function $i(e,t){return new Rr(t.largestBatchId,wi(e.ct,t.overlayMutation))}function Wi(e,t){const n=t.path.lastSegment();return[e,_e(t.path.popLast()),n]}function zi(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:Fi(r.readTime),documentKey:_e(r.documentKey.path),largestBatchId:r.largestBatchId}}class Vi{getBundleMetadata(e,t){return Ki(e).get(t).next((e=>{if(e)return function(e){return{id:e.bundleId,createTime:Ui(e.createTime),version:e.version}}(e)}))}saveBundleMetadata(e,t){return Ki(e).put(function(e){return{bundleId:e.id,createTime:Fi(ci(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return Yi(e).get(t).next((e=>{if(e)return function(e){return{name:e.name,query:Hi(e.bundledQuery),readTime:Ui(e.readTime)}}(e)}))}saveNamedQuery(e,t){return Yi(e).put(function(e){return{name:e.name,readTime:Fi(ci(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function Ki(e){return Ye(e,"bundles")}function Yi(e){return Ye(e,"namedQueries")}class Qi{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const n=t.uid||"";return new Qi(e,n)}getOverlay(e,t){return Xi(e).get(Wi(this.userId,t)).next((e=>e?$i(this.serializer,e):null))}getOverlays(e,t){const n=$n();return ie.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){const r=[];return n.forEach(((n,i)=>{const o=new Rr(t,i);r.push(this.ht(e,o))})),ie.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach((e=>r.add(_e(e.getCollectionPath()))));const i=[];return r.forEach((t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(Xi(e).H("collectionPathOverlayIndex",r))})),ie.waitFor(i)}getOverlaysForCollection(e,t,n){const r=$n(),i=_e(t),o=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Xi(e).W("collectionPathOverlayIndex",o).next((e=>{for(const t of e){const e=$i(this.serializer,t);r.set(e.getKey(),e)}return r}))}getOverlaysForCollectionGroup(e,t,n,r){const i=$n();let o;const s=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Xi(e).Y({index:"collectionGroupOverlayIndex",range:s},((e,t,n)=>{const s=$i(this.serializer,t);i.size()<r||s.largestBatchId===o?(i.set(s.getKey(),s),o=s.largestBatchId):n.done()})).next((()=>i))}ht(e,t){return Xi(e).put(function(e,t,n){const[r,i,o]=Wi(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:o,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:_i(e.ct,n.mutation)}}(this.serializer,this.userId,t))}}function Xi(e){return Ye(e,"documentOverlays")}class Ji{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(dt(e.integerValue));else if("doubleValue"in e){const n=dt(e.doubleValue);isNaN(n)?this.Et(t,13):(this.Et(t,15),ve(n)?t.dt(0):t.dt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Et(t,20),"string"==typeof n&&(n=ut(n)),t.At(`${n.seconds||""}`),t.dt(n.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(ht(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Et(t,45),t.dt(n.latitude||0),t.dt(n.longitude||0)}else"mapValue"in e?Dt(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):b()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){const n=e.fields||{};this.Et(t,55);for(const e of Object.keys(n))this.Rt(e,t),this.It(n[e],t)}wt(e,t){const n=e.values||[];this.Et(t,50);for(const e of n)this.It(e,t)}gt(e,t){this.Et(t,37),W.fromName(e).path.forEach((e=>{this.Et(t,60),this.St(e,t)}))}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}}function Zi(e){if(0===e)return 8;let t=0;return!(e>>4)&&(t+=4,e<<=4),!(e>>6)&&(t+=2,e<<=2),!(e>>7)&&(t+=1),t}function eo(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=Zi(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}Ji.bt=new Ji;class to{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ct(n.value),n=t.next();this.vt()}Ft(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Mt(n.value),n=t.next();this.xt()}Ot(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ct(e);else if(e<2048)this.Ct(960|e>>>6),this.Ct(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ct(480|e>>>12),this.Ct(128|63&e>>>6),this.Ct(128|63&e);else{const e=t.codePointAt(0);this.Ct(240|e>>>18),this.Ct(128|63&e>>>12),this.Ct(128|63&e>>>6),this.Ct(128|63&e)}}this.vt()}Nt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Mt(e);else if(e<2048)this.Mt(960|e>>>6),this.Mt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Mt(480|e>>>12),this.Mt(128|63&e>>>6),this.Mt(128|63&e);else{const e=t.codePointAt(0);this.Mt(240|e>>>18),this.Mt(128|63&e>>>12),this.Mt(128|63&e>>>6),this.Mt(128|63&e)}}this.xt()}Lt(e){const t=this.Bt(e),n=eo(t);this.kt(1+n),this.buffer[this.position++]=255&n;for(let e=t.length-n;e<t.length;++e)this.buffer[this.position++]=255&t[e]}qt(e){const t=this.Bt(e),n=eo(t);this.kt(1+n),this.buffer[this.position++]=~(255&n);for(let e=t.length-n;e<t.length;++e)this.buffer[this.position++]=~(255&t[e])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let e=1;e<t.length;++e)t[e]^=n?255:0;return t}Ct(e){const t=255&e;0===t?(this.Kt(0),this.Kt(255)):255===t?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){const t=255&e;0===t?(this.Ut(0),this.Ut(255)):255===t?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class no{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}}class ro{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}}class io{constructor(){this.Gt=new to,this.zt=new no(this.Gt),this.jt=new ro(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return 0===e?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}}class oo{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Jt(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new oo(this.indexId,this.documentKey,this.arrayValue,n)}}function so(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=ao(e.arrayValue,t.arrayValue),0!==n?n:(n=ao(e.directionalValue,t.directionalValue),0!==n?n:W.comparator(e.documentKey,t.documentKey)))}function ao(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}class co{constructor(e){this.Yt=new nt(((e,t)=>$.comparator(e.field,t.field))),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(const t of e.filters){const e=t;e.isInequality()?this.Yt=this.Yt.add(e):this.Xt.push(e)}}get en(){return this.Yt.size>1}tn(e){if(_(e.collectionGroup===this.collectionId),this.en)return!1;const t=V(e);if(void 0!==t&&!this.nn(t))return!1;const n=K(e);let r=new Set,i=0,o=0;for(;i<n.length&&this.nn(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(this.Yt.size>0){const e=this.Yt.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[i];if(!this.rn(e,t)||!this.sn(this.Zt[o++],t))return!1}++i}for(;i<n.length;++i){const e=n[i];if(o>=this.Zt.length||!this.sn(this.Zt[o++],e))return!1}return!0}on(){if(this.en)return null;let e=new nt($.comparator);const t=[];for(const n of this.Xt)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new Y(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new Y(n.field,0))}for(const n of this.Zt)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new Y(n.field,"asc"===n.dir?0:1)));return new z(z.UNKNOWN_ID,this.collectionId,t,Q.empty())}nn(e){for(const t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function lo(e){var t,n;if(_(e instanceof Kt||e instanceof Yt),e instanceof Kt){if(e instanceof un){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((t=>Kt.create(e.field,"==",t))))||[];return Yt.create(r,"or")}return e}const r=e.filters.map((e=>lo(e)));return Yt.create(r,e.op)}function uo(e){if(0===e.getFilters().length)return[];const t=go(lo(e));return _(po(t)),ho(t)||fo(t)?[t]:t.getFilters()}function ho(e){return e instanceof Kt}function fo(e){return e instanceof Yt&&Jt(e)}function po(e){return ho(e)||fo(e)||function(e){if(e instanceof Yt&&Xt(e)){for(const t of e.getFilters())if(!ho(t)&&!fo(t))return!1;return!0}return!1}(e)}function go(e){if(_(e instanceof Kt||e instanceof Yt),e instanceof Kt)return e;if(1===e.filters.length)return go(e.filters[0]);const t=e.filters.map((e=>go(e)));let n=Yt.create(t,e.op);return n=vo(n),po(n)?n:(_(n instanceof Yt),_(Qt(n)),_(n.filters.length>1),n.filters.reduce(((e,t)=>mo(e,t))))}function mo(e,t){let n;return _(e instanceof Kt||e instanceof Yt),_(t instanceof Kt||t instanceof Yt),n=e instanceof Kt?t instanceof Kt?function(e,t){return Yt.create([e,t],"and")}(e,t):yo(e,t):t instanceof Kt?yo(t,e):function(e,t){if(_(e.filters.length>0&&t.filters.length>0),Qt(e)&&Qt(t))return nn(e,t.getFilters());const n=Xt(e)?e:t,r=Xt(e)?t:e,i=n.filters.map((e=>mo(e,r)));return Yt.create(i,"or")}(e,t),vo(n)}function yo(e,t){if(Qt(t))return nn(t,e.getFilters());{const n=t.filters.map((t=>mo(e,t)));return Yt.create(n,"or")}}function vo(e){if(_(e instanceof Kt||e instanceof Yt),e instanceof Kt)return e;const t=e.getFilters();if(1===t.length)return vo(t[0]);if(Zt(e))return e;const n=t.map((e=>vo(e))),r=[];return n.forEach((t=>{t instanceof Kt?r.push(t):t instanceof Yt&&(t.op===e.op?r.push(...t.filters):r.push(t))})),1===r.length?r[0]:Yt.create(r,e.op)}class bo{constructor(){this._n=new _o}addToCollectionParentIndex(e,t){return this._n.add(t),ie.resolve()}getCollectionParents(e,t){return ie.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return ie.resolve()}deleteFieldIndex(e,t){return ie.resolve()}deleteAllFieldIndexes(e){return ie.resolve()}createTargetIndexes(e,t){return ie.resolve()}getDocumentsMatchingTarget(e,t){return ie.resolve(null)}getIndexType(e,t){return ie.resolve(0)}getFieldIndexes(e,t){return ie.resolve([])}getNextCollectionGroupToUpdate(e){return ie.resolve(null)}getMinOffset(e,t){return ie.resolve(Z.min())}getMinOffsetFromCollectionGroup(e,t){return ie.resolve(Z.min())}updateCollectionGroup(e,t,n){return ie.resolve()}updateIndexEntries(e,t){return ie.resolve()}}class _o{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new nt(q.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new nt(q.comparator)).toArray()}}const wo=new Uint8Array(0);class To{constructor(e,t){this.databaseId=t,this.an=new _o,this.un=new Fn((e=>gn(e)),((e,t)=>mn(e,t))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.an.add(t)}));const i={collectionId:n,parent:_e(r)};return Eo(e).put(i)}return ie.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[F(t),""],!1,!0);return Eo(e).W(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(Ee(r.parent))}return n}))}addFieldIndex(e,t){const n=So(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((e=>[e.fieldPath.canonicalString(),e.kind]))}}(t);delete r.indexId;const i=n.add(r);if(t.indexState){const n=Oo(e);return i.next((e=>{n.put(zi(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return i.next()}deleteFieldIndex(e,t){const n=So(e),r=Oo(e),i=Ao(e);return n.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=So(e),n=Ao(e),r=Oo(e);return t.H().next((()=>n.H())).next((()=>r.H()))}createTargetIndexes(e,t){return ie.forEach(this.cn(t),(t=>this.getIndexType(e,t).next((n=>{if(0===n||1===n){const n=new co(t).on();if(null!=n)return this.addFieldIndex(e,n)}}))))}getDocumentsMatchingTarget(e,t){const n=Ao(e);let r=!0;const i=new Map;return ie.forEach(this.cn(t),(t=>this.ln(e,t).next((e=>{r&&(r=!!e),i.set(t,e)})))).next((()=>{if(r){let e=Yn();const r=[];return ie.forEach(i,((i,o)=>{g("IndexedDbIndexManager",`Using index ${function(e){return`id=${e.indexId}|cg=${e.collectionGroup}|f=${e.fields.map((e=>`${e.fieldPath}:${e.kind}`)).join(",")}`}(i)} to execute ${gn(t)}`);const s=function(e,t){const n=V(t);if(void 0===n)return null;for(const t of vn(e,n.fieldPath))switch(t.op){case"array-contains-any":return t.value.arrayValue.values||[];case"array-contains":return[t.value]}return null}(o,i),a=function(e,t){const n=new Map;for(const r of K(t))for(const t of vn(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(o,i),c=function(e,t){const n=[];let r=!0;for(const i of K(t)){const t=0===i.kind?bn(e,i.fieldPath,e.startAt):_n(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new qt(n,r)}(o,i),l=function(e,t){const n=[];let r=!0;for(const i of K(t)){const t=0===i.kind?_n(e,i.fieldPath,e.endAt):bn(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new qt(n,r)}(o,i),u=this.hn(i,o,c),d=this.hn(i,o,l),h=this.Pn(i,o,a),f=this.In(i.indexId,s,u,c.inclusive,d,l.inclusive,h);return ie.forEach(f,(i=>n.j(i,t.limit).next((t=>{t.forEach((t=>{const n=W.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))}))}))))})).next((()=>r))}return ie.resolve(null)}))}cn(e){let t=this.un.get(e);return t||(t=0===e.filters.length?[e]:uo(Yt.create(e.filters,"and")).map((t=>pn(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt))),this.un.set(e,t),t)}In(e,t,n,r,i,o,s){const a=(null!=t?t.length:1)*Math.max(n.length,i.length),c=a/(null!=t?t.length:1),l=[];for(let u=0;u<a;++u){const a=t?this.Tn(t[u/c]):wo,d=this.En(e,a,n[u%c],r),h=this.dn(e,a,i[u%c],o),f=s.map((t=>this.En(e,a,t,!0)));l.push(...this.createRange(d,h,f))}return l}En(e,t,n,r){const i=new oo(e,W.empty(),t,n);return r?i:i.Jt()}dn(e,t,n,r){const i=new oo(e,W.empty(),t,n);return r?i.Jt():i}ln(e,t){const n=new co(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((e=>{let t=null;for(const r of e)n.tn(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t}))}getIndexType(e,t){let n=2;const r=this.cn(t);return ie.forEach(r,(t=>this.ln(e,t).next((e=>{e?0!==n&&e.fields.length<function(e){let t=new nt($.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const n of e.orderBy)n.field.isKeyField()||(t=t.add(n.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})))).next((()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n))}An(e,t){const n=new io;for(const r of K(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.Ht(r.kind);Ji.bt.Pt(e,i)}return n.Wt()}Tn(e){const t=new io;return Ji.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){const n=new io;return Ji.bt.Pt(It(this.databaseId,t),n.Ht(function(e){const t=K(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Wt()}Pn(e,t,n){if(null===n)return[];let r=[];r.push(new io);let i=0;for(const o of K(e)){const e=n[i++];for(const n of r)if(this.Vn(t,o.fieldPath)&&kt(e))r=this.mn(r,o,e);else{const t=n.Ht(o.kind);Ji.bt.Pt(e,t)}}return this.fn(r)}hn(e,t,n){return this.Pn(e,t,n.position)}fn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Wt();return t}mn(e,t,n){const r=[...e],i=[];for(const e of n.arrayValue.values||[])for(const n of r){const r=new io;r.seed(n.Wt()),Ji.bt.Pt(e,r.Ht(t.kind)),i.push(r)}return i}Vn(e,t){return!!e.filters.find((e=>e instanceof Kt&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)))}getFieldIndexes(e,t){const n=So(e),r=Oo(e);return(t?n.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.W()).next((e=>{const t=[];return ie.forEach(e,(e=>r.get([e.indexId,this.uid]).next((n=>{t.push(function(e,t){const n=t?new Q(t.sequenceNumber,new Z(Ui(t.readTime),new W(Ee(t.documentKey)),t.largestBatchId)):Q.empty(),r=e.fields.map((([e,t])=>new Y($.fromServerFormat(e),t)));return new z(e.indexId,e.collectionGroup,r,n)}(e,n))})))).next((()=>t))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((e=>0===e.length?null:(e.sort(((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:j(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(e,t,n){const r=So(e),i=Oo(e);return this.gn(e).next((e=>r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((t=>ie.forEach(t,(t=>i.put(zi(t.indexId,this.uid,e,n))))))))}updateIndexEntries(e,t){const n=new Map;return ie.forEach(t,((t,r)=>{const i=n.get(t.collectionGroup);return(i?ie.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next((i=>(n.set(t.collectionGroup,i),ie.forEach(i,(n=>this.pn(e,t,n).next((t=>{const i=this.yn(r,n);return t.isEqual(i)?ie.resolve():this.wn(e,r,n,t,i)})))))))}))}Sn(e,t,n,r){return Ao(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.Rn(n,t.key),documentKey:t.key.path.toArray()})}bn(e,t,n,r){return Ao(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.Rn(n,t.key),t.key.path.toArray()])}pn(e,t,n){const r=Ao(e);let i=new nt(so);return r.Y({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.Rn(n,t)])},((e,r)=>{i=i.add(new oo(n.indexId,t,r.arrayValue,r.directionalValue))})).next((()=>i))}yn(e,t){let n=new nt(so);const r=this.An(t,e);if(null==r)return n;const i=V(t);if(null!=i){const o=e.data.field(i.fieldPath);if(kt(o))for(const i of o.arrayValue.values||[])n=n.add(new oo(t.indexId,e.key,this.Tn(i),r))}else n=n.add(new oo(t.indexId,e.key,wo,r));return n}wn(e,t,n,r,i){g("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(e,t,n,r,i){const o=e.getIterator(),s=t.getIterator();let a=it(o),c=it(s);for(;a||c;){let e=!1,t=!1;if(a&&c){const r=n(a,c);r<0?t=!0:r>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(c),c=it(s)):t?(i(a),a=it(o)):(a=it(o),c=it(s))}}(r,i,so,(r=>{o.push(this.Sn(e,t,n,r))}),(r=>{o.push(this.bn(e,t,n,r))})),ie.waitFor(o)}gn(e){let t=1;return Oo(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((e,n,r)=>{r.done(),t=n.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((e,t)=>so(e,t))).filter(((e,t,n)=>!t||0!==so(e,n[t-1])));const r=[];r.push(e);for(const i of n){const n=so(i,e),o=so(i,t);if(0===n)r[0]=e.Jt();else if(n>0&&o<0)r.push(i),r.push(i.Jt());else if(o>0)break}r.push(t);const i=[];for(let e=0;e<r.length;e+=2){if(this.Dn(r[e],r[e+1]))return[];const t=[r[e].indexId,this.uid,r[e].arrayValue,r[e].directionalValue,wo,[]],n=[r[e+1].indexId,this.uid,r[e+1].arrayValue,r[e+1].directionalValue,wo,[]];i.push(IDBKeyRange.bound(t,n))}return i}Dn(e,t){return so(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Io)}getMinOffset(e,t){return ie.mapArray(this.cn(t),(t=>this.ln(e,t).next((e=>e||b())))).next(Io)}}function Eo(e){return Ye(e,"collectionParents")}function Ao(e){return Ye(e,"indexEntries")}function So(e){return Ye(e,"indexConfiguration")}function Oo(e){return Ye(e,"indexState")}function Io(e){_(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;ee(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Z(t.readTime,t.documentKey,n)}const Co={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class ko{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new ko(e,ko.DEFAULT_COLLECTION_PERCENTILE,ko.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Po(e,t,n){const r=e.store("mutations"),i=e.store("documentMutations"),o=[],s=IDBKeyRange.only(n.batchId);let a=0;const c=r.Y({range:s},((e,t,n)=>(a++,n.delete())));o.push(c.next((()=>{_(1===a)})));const l=[];for(const e of n.mutations){const r=Oe(t,e.key.path,n.batchId);o.push(i.delete(r)),l.push(e.key)}return ie.waitFor(o).next((()=>l))}function xo(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw b();t=e.noDocument}return JSON.stringify(t).length}ko.DEFAULT_COLLECTION_PERCENTILE=10,ko.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ko.DEFAULT=new ko(41943040,ko.DEFAULT_COLLECTION_PERCENTILE,ko.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ko.DISABLED=new ko(-1,0,0);class Ro{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Cn={}}static lt(e,t,n,r){_(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new Ro(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Do(e).Y({index:"userMutationsIndex",range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const i=No(e),o=Do(e);return o.add({}).next((s=>{_("number"==typeof s);const a=new Pr(s,t,n,r),c=function(e,t,n){const r=n.baseMutations.map((t=>_i(e.ct,t))),i=n.mutations.map((t=>_i(e.ct,t)));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,a),l=[];let u=new nt(((e,t)=>j(e.canonicalString(),t.canonicalString())));for(const e of r){const t=Oe(this.userId,e.key.path,s);u=u.add(e.key.path.popLast()),l.push(o.put(c)),l.push(i.put(t,Ie))}return u.forEach((t=>{l.push(this.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.Cn[s]=a.keys()})),ie.waitFor(l).next((()=>a))}))}lookupMutationBatch(e,t){return Do(e).get(t).next((e=>e?(_(e.userId===this.userId),Bi(this.serializer,e)):null))}vn(e,t){return this.Cn[t]?ie.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.Cn[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return Do(e).Y({index:"userMutationsIndex",range:r},((e,t,r)=>{t.userId===this.userId&&(_(t.batchId>=n),i=Bi(this.serializer,t)),r.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return Do(e).Y({index:"userMutationsIndex",range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Do(e).W("userMutationsIndex",t).next((e=>e.map((e=>Bi(this.serializer,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Se(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return No(e).Y({range:r},((n,r,o)=>{const[s,a,c]=n,l=Ee(a);if(s===this.userId&&t.path.isEqual(l))return Do(e).get(c).next((e=>{if(!e)throw b();_(e.userId===this.userId),i.push(Bi(this.serializer,e))}));o.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new nt(j);const r=[];return t.forEach((t=>{const i=Se(this.userId,t.path),o=IDBKeyRange.lowerBound(i),s=No(e).Y({range:o},((e,r,i)=>{const[o,s,a]=e,c=Ee(s);o===this.userId&&t.path.isEqual(c)?n=n.add(a):i.done()}));r.push(s)})),ie.waitFor(r).next((()=>this.Fn(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=Se(this.userId,n),o=IDBKeyRange.lowerBound(i);let s=new nt(j);return No(e).Y({range:o},((e,t,i)=>{const[o,a,c]=e,l=Ee(a);o===this.userId&&n.isPrefixOf(l)?l.length===r&&(s=s.add(c)):i.done()})).next((()=>this.Fn(e,s)))}Fn(e,t){const n=[],r=[];return t.forEach((t=>{r.push(Do(e).get(t).next((e=>{if(null===e)throw b();_(e.userId===this.userId),n.push(Bi(this.serializer,e))})))})),ie.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return Po(e.ae,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.Mn(t.batchId)})),ie.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return ie.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return No(e).Y({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=Ee(e[1]);r.push(t)}else n.done()})).next((()=>{_(0===r.length)}))}))}containsKey(e,t){return Lo(e,this.userId,t)}xn(e){return jo(e).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}))}}function Lo(e,t,n){const r=Se(t,n.path),i=r[1],o=IDBKeyRange.lowerBound(r);let s=!1;return No(e).Y({range:o,J:!0},((e,n,r)=>{const[o,a,c]=e;o===t&&a===i&&(s=!0),r.done()})).next((()=>s))}function Do(e){return Ye(e,"mutations")}function No(e){return Ye(e,"documentMutations")}function jo(e){return Ye(e,"mutationQueues")}class Mo{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new Mo(0)}static Ln(){return new Mo(-1)}}class Fo{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Bn(e).next((t=>{const n=new Mo(t.highestTargetId);return t.highestTargetId=n.next(),this.kn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.Bn(e).next((e=>B.fromTimestamp(new U(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.Bn(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.Bn(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.kn(e,r))))}addTargetData(e,t){return this.qn(e,t).next((()=>this.Bn(e).next((n=>(n.targetCount+=1,this.Qn(t,n),this.kn(e,n))))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Uo(e).delete(t.targetId))).next((()=>this.Bn(e))).next((t=>(_(t.targetCount>0),t.targetCount-=1,this.kn(e,t))))}removeTargets(e,t,n){let r=0;const i=[];return Uo(e).Y(((o,s)=>{const a=Gi(s);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))})).next((()=>ie.waitFor(i))).next((()=>r))}forEachTarget(e,t){return Uo(e).Y(((e,n)=>{const r=Gi(n);t(r)}))}Bn(e){return Bo(e).get("targetGlobalKey").next((e=>(_(null!==e),e)))}kn(e,t){return Bo(e).put("targetGlobalKey",t)}qn(e,t){return Uo(e).put(qi(this.serializer,t))}Qn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Bn(e).next((e=>e.targetCount))}getTargetData(e,t){const n=gn(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return Uo(e).Y({range:r,index:"queryTargetsIndex"},((e,n,r)=>{const o=Gi(n);mn(t,o.target)&&(i=o,r.done())})).next((()=>i))}addMatchingKeys(e,t,n){const r=[],i=Go(e);return t.forEach((t=>{const o=_e(t.path);r.push(i.put({targetId:n,path:o})),r.push(this.referenceDelegate.addReference(e,n,t))})),ie.waitFor(r)}removeMatchingKeys(e,t,n){const r=Go(e);return ie.forEach(t,(t=>{const i=_e(t.path);return ie.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=Go(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=Go(e);let i=Yn();return r.Y({range:n,J:!0},((e,t,n)=>{const r=Ee(e[1]),o=new W(r);i=i.add(o)})).next((()=>i))}containsKey(e,t){const n=_e(t.path),r=IDBKeyRange.bound([n],[F(n)],!1,!0);let i=0;return Go(e).Y({index:"documentTargetsIndex",J:!0,range:r},(([e,t],n,r)=>{0!==e&&(i++,r.done())})).next((()=>i>0))}_t(e,t){return Uo(e).get(t).next((e=>e?Gi(e):null))}}function Uo(e){return Ye(e,"targets")}function Bo(e){return Ye(e,"targetGlobal")}function Go(e){return Ye(e,"targetDocuments")}function qo([e,t],[n,r]){const i=j(e,n);return 0===i?j(t,r):i}class Ho{constructor(e){this.Kn=e,this.buffer=new nt(qo),this.$n=0}Un(){return++this.$n}Wn(e){const t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();qo(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class $o{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Gn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return null!==this.Gn}zn(e){g("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Gn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){le(e)?g("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await re(e)}await this.zn(3e5)}))}}class Wo{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return ie.resolve(me._e);const n=new Ho(t);return this.jn.forEachTarget(e,(e=>n.Wn(e.sequenceNumber))).next((()=>this.jn.Jn(e,(e=>n.Wn(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(g("LruGarbageCollector","Garbage collection skipped; disabled"),ie.resolve(Co)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(g("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Co):this.Yn(e,t)))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let n,r,i,o,a,c,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(g("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,o=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,a=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,c=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(l=Date.now(),f()<=s.LogLevel.DEBUG&&g("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-u}ms\n\tDetermined least recently used ${r} in `+(a-o)+"ms\n"+`\tRemoved ${i} targets in `+(c-a)+"ms\n"+`\tRemoved ${e} documents in `+(l-c)+"ms\n"+`Total Duration: ${l-u}ms`),ie.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}}function zo(e,t){return new Wo(e,t)}class Vo{constructor(e,t){this.db=e,this.garbageCollector=zo(this,t)}Hn(e){const t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}Zn(e){let t=0;return this.Jn(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,((e,n)=>t(n)))}addReference(e,t,n){return Ko(e,n)}removeReference(e,t,n){return Ko(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Ko(e,t)}er(e,t){return function(e,t){let n=!1;return jo(e).Z((r=>Lo(e,r,t).next((e=>(e&&(n=!0),ie.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Xn(e,((o,s)=>{if(s<=t){const t=this.er(e,o).next((t=>{if(!t)return i++,n.getEntry(e,o).next((()=>(n.removeEntry(o,B.min()),Go(e).delete(function(e){return[0,_e(e.path)]}(o)))))}));r.push(t)}})).next((()=>ie.waitFor(r))).next((()=>n.apply(e))).next((()=>i))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Ko(e,t)}Xn(e,t){const n=Go(e);let r,i=me._e;return n.Y({index:"documentTargetsIndex"},(([e,n],{path:o,sequenceNumber:s})=>{0===e?(i!==me._e&&t(new W(Ee(r)),i),i=s,r=o):i=me._e})).next((()=>{i!==me._e&&t(new W(Ee(r)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Ko(e,t){return Go(e).put(function(e,t){return{targetId:0,path:_e(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class Yo{constructor(){this.changes=new Fn((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Gt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?ie.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Qo{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return es(e).put(n)}removeEntry(e,t,n){return es(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],Mi(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.tr(e,n))))}getEntry(e,t){let n=Gt.newInvalidDocument(t);return es(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(ts(t))},((e,r)=>{n=this.nr(t,r)})).next((()=>n))}rr(e,t){let n={size:0,document:Gt.newInvalidDocument(t)};return es(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(ts(t))},((e,r)=>{n={document:this.nr(t,r),size:xo(r)}})).next((()=>n))}getEntries(e,t){let n=Bn();return this.ir(e,t,((e,t)=>{const r=this.nr(e,t);n=n.insert(e,r)})).next((()=>n))}sr(e,t){let n=Bn(),r=new Ze(W.comparator);return this.ir(e,t,((e,t)=>{const i=this.nr(e,t);n=n.insert(e,i),r=r.insert(e,xo(t))})).next((()=>({documents:n,_r:r})))}ir(e,t,n){if(t.isEmpty())return ie.resolve();let r=new nt(rs);t.forEach((e=>r=r.add(e)));const i=IDBKeyRange.bound(ts(r.first()),ts(r.last())),o=r.getIterator();let s=o.getNext();return es(e).Y({index:"documentKeyIndex",range:i},((e,t,r)=>{const i=W.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;s&&rs(s,i)<0;)n(s,null),s=o.getNext();s&&s.isEqual(i)&&(n(s,t),s=o.hasNext()?o.getNext():null),s?r.U(ts(s)):r.done()})).next((()=>{for(;s;)n(s,null),s=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,n,r,i){const o=t.path,s=[o.popLast().toArray(),o.lastSegment(),Mi(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return es(e).W(IDBKeyRange.bound(s,a,!0)).next((e=>{null==i||i.incrementDocumentReadCount(e.length);let n=Bn();for(const i of e){const e=this.nr(W.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(Dn(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n}))}getAllFromCollectionGroup(e,t,n,r){let i=Bn();const o=ns(t,n),s=ns(t,Z.max());return es(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,s,!0)},((e,t,n)=>{const o=this.nr(W.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(o.key,o),i.size===r&&n.done()})).next((()=>i))}newChangeBuffer(e){return new Jo(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return Zo(e).get("remoteDocumentGlobalKey").next((e=>(_(!!e),e)))}tr(e,t){return Zo(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){const e=function(e,t){let n;if(t.document)n=bi(e.ct,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=W.fromSegments(t.noDocument.path),r=Ui(t.noDocument.readTime);n=Gt.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return b();{const e=W.fromSegments(t.unknownDocument.path),r=Ui(t.unknownDocument.version);n=Gt.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new U(e[0],e[1]);return B.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(B.min()))return e}return Gt.newInvalidDocument(e)}}function Xo(e){return new Qo(e)}class Jo extends Yo{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new Fn((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new nt(((e,t)=>j(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((i,o)=>{const s=this.ur.get(i);if(t.push(this.ar.removeEntry(e,i,s.readTime)),o.isValidDocument()){const a=ji(this.ar.serializer,o);r=r.add(i.path.popLast());const c=xo(a);n+=c-s.size,t.push(this.ar.addEntry(e,i,a))}else if(n-=s.size,this.trackRemovals){const n=ji(this.ar.serializer,o.convertToNoDocument(B.min()));t.push(this.ar.addEntry(e,i,n))}})),r.forEach((n=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,n))})),t.push(this.ar.updateMetadata(e,n)),ie.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next((e=>(this.ur.set(t,{size:e.size,readTime:e.document.readTime}),e.document)))}getAllFromCache(e,t){return this.ar.sr(e,t).next((({documents:e,_r:t})=>(t.forEach(((t,n)=>{this.ur.set(t,{size:n,readTime:e.get(t).readTime})})),e)))}}function Zo(e){return Ye(e,"remoteDocumentGlobal")}function es(e){return Ye(e,"remoteDocumentsV14")}function ts(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function ns(e,t){const n=t.documentKey.path.toArray();return[e,Mi(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function rs(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let e=0;e<n.length-2&&e<r.length-2;++e)if(i=j(n[e],r[e]),i)return i;return i=j(n.length,r.length),i||(i=j(n[n.length-2],r[r.length-2]),i||j(n[n.length-1],r[r.length-1]))}class is{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class os{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&_r(n.mutation,e,ot.empty(),U.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Yn()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=Yn()){const r=$n();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=qn();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=$n();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Yn())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=Bn();const o=zn(),s=zn();return t.forEach(((e,t)=>{const s=n.get(t.key);r.has(t.key)&&(void 0===s||s.mutation instanceof Ar)?i=i.insert(t.key,t):void 0!==s?(o.set(t.key,s.mutation.getFieldMask()),_r(s.mutation,t,s.mutation.getFieldMask(),U.now())):o.set(t.key,ot.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>o.set(e,t))),t.forEach(((e,t)=>{var n;return s.set(e,new is(t,null!==(n=o.get(e))&&void 0!==n?n:null))})),s)))}recalculateAndSaveOverlays(e,t){const n=zn();let r=new Ze(((e,t)=>e-t)),i=Yn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const o=t.get(e);if(null===o)return;let s=n.get(e)||ot.empty();s=i.applyToLocalView(o,s),n.set(e,s);const a=(r.get(i.batchId)||Yn()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const o=[],s=r.getReverseIterator();for(;s.hasNext();){const r=s.getNext(),a=r.key,c=r.value,l=Wn();c.forEach((e=>{if(!i.has(e)){const r=vr(t.get(e),n.get(e));null!==r&&l.set(e,r),i=i.add(e)}})),o.push(this.documentOverlayCache.saveOverlays(e,a,l))}return ie.waitFor(o)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return W.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Sn(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):ie.resolve($n());let s=-1,a=i;return o.next((t=>ie.forEach(t,((t,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),i.get(t)?ie.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,Yn()))).next((e=>({batchId:s,changes:Hn(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new W(t)).next((e=>{let t=qn();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let o=qn();return this.indexManager.getCollectionParents(e,i).next((s=>ie.forEach(s,(s=>{const a=function(e,t){return new wn(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next((e=>{e.forEach(((e,t)=>{o=o.insert(e,t)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Gt.newInvalidDocument(r)))}));let n=qn();return e.forEach(((e,r)=>{const o=i.get(e);void 0!==o&&_r(o.mutation,r,ot.empty(),U.now()),Dn(t,r)&&(n=n.insert(e,r))})),n}))}}class ss{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return ie.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:ci(e.createTime)}}(t)),ie.resolve()}getNamedQuery(e,t){return ie.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(e){return{name:e.name,query:Hi(e.bundledQuery),readTime:ci(e.readTime)}}(t)),ie.resolve()}}class as{constructor(){this.overlays=new Ze(W.comparator),this.hr=new Map}getOverlay(e,t){return ie.resolve(this.overlays.get(t))}getOverlays(e,t){const n=$n();return ie.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.ht(e,t,r)})),ie.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.hr.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.hr.delete(n)),ie.resolve()}getOverlaysForCollection(e,t,n){const r=$n(),i=t.length+1,o=new W(t.child("")),s=this.overlays.getIteratorFrom(o);for(;s.hasNext();){const e=s.getNext().value,o=e.getKey();if(!t.isPrefixOf(o.path))break;o.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return ie.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Ze(((e,t)=>e-t));const o=this.overlays.getIterator();for(;o.hasNext();){const e=o.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=$n(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const s=$n(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>s.set(e,t))),!(s.size()>=r)););return ie.resolve(s)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.hr.get(r.largestBatchId).delete(n.key);this.hr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Rr(t,n));let i=this.hr.get(t);void 0===i&&(i=Yn(),this.hr.set(t,i)),this.hr.set(t,i.add(n.key))}}class cs{constructor(){this.Pr=new nt(ls.Ir),this.Tr=new nt(ls.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){const n=new ls(e,t);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Ar(new ls(e,t))}Rr(e,t){e.forEach((e=>this.removeReference(e,t)))}Vr(e){const t=new W(new q([])),n=new ls(t,e),r=new ls(t,e+1),i=[];return this.Tr.forEachInRange([n,r],(e=>{this.Ar(e),i.push(e.key)})),i}mr(){this.Pr.forEach((e=>this.Ar(e)))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const t=new W(new q([])),n=new ls(t,e),r=new ls(t,e+1);let i=Yn();return this.Tr.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new ls(e,0),n=this.Pr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class ls{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return W.comparator(e.key,t.key)||j(e.pr,t.pr)}static Er(e,t){return j(e.pr,t.pr)||W.comparator(e.key,t.key)}}class us{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new nt(ls.Ir)}checkEmpty(e){return ie.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Pr(i,t,n,r);this.mutationQueue.push(o);for(const t of r)this.wr=this.wr.add(new ls(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return ie.resolve(o)}lookupMutationBatch(e,t){return ie.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.br(n),i=r<0?0:r;return ie.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ie.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(e){return ie.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new ls(t,0),r=new ls(t,Number.POSITIVE_INFINITY),i=[];return this.wr.forEachInRange([n,r],(e=>{const t=this.Sr(e.pr);i.push(t)})),ie.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new nt(j);return t.forEach((e=>{const t=new ls(e,0),r=new ls(e,Number.POSITIVE_INFINITY);this.wr.forEachInRange([t,r],(e=>{n=n.add(e.pr)}))})),ie.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;W.isDocumentKey(i)||(i=i.child(""));const o=new ls(new W(i),0);let s=new nt(j);return this.wr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(s=s.add(e.pr)),!0)}),o),ie.resolve(this.Dr(s))}Dr(e){const t=[];return e.forEach((e=>{const n=this.Sr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){_(0===this.Cr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return ie.forEach(t.mutations,(r=>{const i=new ls(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.wr=n}))}Mn(e){}containsKey(e,t){const n=new ls(t,0),r=this.wr.firstAfterOrEqual(n);return ie.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ie.resolve()}Cr(e,t){return this.br(e)}br(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Sr(e){const t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ds{constructor(e){this.vr=e,this.docs=new Ze(W.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,o=this.vr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ie.resolve(n?n.document.mutableCopy():Gt.newInvalidDocument(t))}getEntries(e,t){let n=Bn();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Gt.newInvalidDocument(e))})),ie.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Bn();const o=t.path,s=new W(o.child("")),a=this.docs.getIteratorFrom(s);for(;a.hasNext();){const{key:e,value:{document:s}}=a.getNext();if(!o.isPrefixOf(e.path))break;e.path.length>o.length+1||ee(J(s),n)<=0||(r.has(s.key)||Dn(t,s))&&(i=i.insert(s.key,s.mutableCopy()))}return ie.resolve(i)}getAllFromCollectionGroup(e,t,n,r){b()}Fr(e,t){return ie.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new hs(this)}getSize(e){return ie.resolve(this.size)}}class hs extends Yo{constructor(e){super(),this.ar=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.ar.addEntry(e,r)):this.ar.removeEntry(n)})),ie.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}}class fs{constructor(e){this.persistence=e,this.Mr=new Fn((e=>gn(e)),mn),this.lastRemoteSnapshotVersion=B.min(),this.highestTargetId=0,this.Or=0,this.Nr=new cs,this.targetCount=0,this.Lr=Mo.Nn()}forEachTarget(e,t){return this.Mr.forEach(((e,n)=>t(n))),ie.resolve()}getLastRemoteSnapshotVersion(e){return ie.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ie.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),ie.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Or&&(this.Or=t),ie.resolve()}qn(e){this.Mr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Lr=new Mo(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,ie.resolve()}updateTargetData(e,t){return this.qn(t),ie.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,ie.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Mr.forEach(((o,s)=>{s.sequenceNumber<=t&&null===n.get(s.targetId)&&(this.Mr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,s.targetId)),r++)})),ie.waitFor(i).next((()=>r))}getTargetCount(e){return ie.resolve(this.targetCount)}getTargetData(e,t){const n=this.Mr.get(t)||null;return ie.resolve(n)}addMatchingKeys(e,t,n){return this.Nr.dr(t,n),ie.resolve()}removeMatchingKeys(e,t,n){this.Nr.Rr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),ie.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),ie.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Nr.gr(t);return ie.resolve(n)}containsKey(e,t){return ie.resolve(this.Nr.containsKey(t))}}class ps{constructor(e,t){this.Br={},this.overlays={},this.kr=new me(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new fs(this),this.indexManager=new bo,this.remoteDocumentCache=function(e){return new ds(e)}((e=>this.referenceDelegate.Kr(e))),this.serializer=new Ni(t),this.$r=new ss(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new as,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Br[e.toKey()];return n||(n=new us(t,this.referenceDelegate),this.Br[e.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,n){g("MemoryPersistence","Starting transaction:",e);const r=new gs(this.kr.next());return this.referenceDelegate.Ur(),n(r).next((e=>this.referenceDelegate.Wr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Gr(e,t){return ie.or(Object.values(this.Br).map((n=>()=>n.containsKey(e,t))))}}class gs extends ne{constructor(e){super(),this.currentSequenceNumber=e}}class ms{constructor(e){this.persistence=e,this.zr=new cs,this.jr=null}static Hr(e){return new ms(e)}get Jr(){if(this.jr)return this.jr;throw b()}addReference(e,t,n){return this.zr.addReference(n,t),this.Jr.delete(n.toString()),ie.resolve()}removeReference(e,t,n){return this.zr.removeReference(n,t),this.Jr.add(n.toString()),ie.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),ie.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach((e=>this.Jr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Jr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Ur(){this.jr=new Set}Wr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ie.forEach(this.Jr,(n=>{const r=W.fromPath(n);return this.Yr(e,r).next((e=>{e||t.removeEntry(r,B.min())}))})).next((()=>(this.jr=null,t.apply(e))))}updateLimboDocument(e,t){return this.Yr(e,t).next((e=>{e?this.Jr.delete(t.toString()):this.Jr.add(t.toString())}))}Kr(e){return 0}Yr(e,t){return ie.or([()=>ie.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}}class ys{constructor(e){this.serializer=e}N(e,t,n,r){const i=new oe("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Ae,{unique:!0}),e.createObjectStore("documentMutations")}(e),vs(e),function(e){e.createObjectStore("remoteDocuments")}(e));let o=ie.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),vs(e)),o=o.next((()=>function(e){const t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:B.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(i)))),n<4&&r>=4&&(0!==n&&(o=o.next((()=>function(e,t){return t.store("mutations").W().next((n=>{e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Ae,{unique:!0});const r=t.store("mutations"),i=n.map((e=>r.put(e)));return ie.waitFor(i)}))}(e,i)))),o=o.next((()=>{!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(o=o.next((()=>this.Xr(i)))),n<6&&r>=6&&(o=o.next((()=>(function(e){e.createObjectStore("remoteDocumentGlobal")}(e),this.ei(i))))),n<7&&r>=7&&(o=o.next((()=>this.ti(i)))),n<8&&r>=8&&(o=o.next((()=>this.ni(e,i)))),n<9&&r>=9&&(o=o.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(o=o.next((()=>this.ri(i)))),n<11&&r>=11&&(o=o.next((()=>{!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(o=o.next((()=>{!function(e){const t=e.createObjectStore("documentOverlays",{keyPath:Ue});t.createIndex("collectionPathOverlayIndex",Be,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",Ge,{unique:!1})}(e)}))),n<13&&r>=13&&(o=o.next((()=>function(e){const t=e.createObjectStore("remoteDocumentsV14",{keyPath:Ce});t.createIndex("documentKeyIndex",ke),t.createIndex("collectionGroupIndex",Pe)}(e))).next((()=>this.ii(e,i))).next((()=>e.deleteObjectStore("remoteDocuments")))),n<14&&r>=14&&(o=o.next((()=>this.si(e,i)))),n<15&&r>=15&&(o=o.next((()=>function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:Ne}).createIndex("sequenceNumberIndex",je,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:Me}).createIndex("documentKeyIndex",Fe,{unique:!1})}(e)))),n<16&&r>=16&&(o=o.next((()=>{t.objectStore("indexState").clear()})).next((()=>{t.objectStore("indexEntries").clear()}))),o}ei(e){let t=0;return e.store("remoteDocuments").Y(((e,n)=>{t+=xo(n)})).next((()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}Xr(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.W().next((t=>ie.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.W("userMutationsIndex",r).next((n=>ie.forEach(n,(n=>{_(n.userId===t.userId);const r=Bi(this.serializer,n);return Po(e,t.userId,r).next((()=>{}))}))))}))))}ti(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((e=>{const r=[];return n.Y(((n,i)=>{const o=new q(n),s=function(e){return[0,_e(e)]}(o);r.push(t.get(s).next((n=>n?ie.resolve():(n=>t.put({targetId:0,path:_e(n),sequenceNumber:e.highestListenSequenceNumber}))(o))))})).next((()=>ie.waitFor(r)))}))}ni(e,t){e.createObjectStore("collectionParents",{keyPath:De});const n=t.store("collectionParents"),r=new _o,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:_e(r)})}};return t.store("remoteDocuments").Y({J:!0},((e,t)=>{const n=new q(e);return i(n.popLast())})).next((()=>t.store("documentMutations").Y({J:!0},(([e,t,n],r)=>{const o=Ee(t);return i(o.popLast())}))))}ri(e){const t=e.store("targets");return t.Y(((e,n)=>{const r=Gi(n),i=qi(this.serializer,r);return t.put(i)}))}ii(e,t){const n=t.store("remoteDocuments"),r=[];return n.Y(((e,n)=>{const i=t.store("remoteDocumentsV14"),o=function(e){return e.document?new W(q.fromString(e.document.name).popFirst(5)):e.noDocument?W.fromSegments(e.noDocument.path):e.unknownDocument?W.fromSegments(e.unknownDocument.path):b()}(n).path.toArray(),s={prefixPath:o.slice(0,o.length-2),collectionGroup:o[o.length-2],documentId:o[o.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(s))})).next((()=>ie.waitFor(r)))}si(e,t){const n=t.store("mutations"),r=Xo(this.serializer),i=new ps(ms.Hr,this.serializer.ct);return n.W().next((e=>{const n=new Map;return e.forEach((e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:Yn();Bi(this.serializer,e).keys().forEach((e=>r=r.add(e))),n.set(e.userId,r)})),ie.forEach(n,((e,n)=>{const o=new u(n),s=Qi.lt(this.serializer,o),a=i.getIndexManager(o),c=Ro.lt(o,this.serializer,a,i.referenceDelegate);return new os(r,c,s,a).recalculateAndSaveOverlaysForDocumentKeys(new Ke(t,me._e),e).next()}))}))}}function vs(e){e.createObjectStore("targetDocuments",{keyPath:Re}).createIndex("documentTargetsIndex",Le,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",xe,{unique:!0}),e.createObjectStore("targetGlobal")}const bs="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class _s{constructor(e,t,n,r,i,o,s,a,c,l,u=16){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.oi=i,this.window=o,this.document=s,this._i=c,this.ai=l,this.ui=u,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=e=>Promise.resolve(),!_s.D())throw new A(E.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Vo(this,r),this.Ti=t+"main",this.serializer=new Ni(a),this.Ei=new se(this.Ti,this.ui,new ys(this.serializer)),this.Qr=new Fo(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Xo(this.serializer),this.$r=new Vi,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,!1===l&&m("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new A(E.FAILED_PRECONDITION,bs);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Qr.getHighestSequenceNumber(e)))})).then((e=>{this.kr=new me(e,this._i)})).then((()=>{this.qr=!0})).catch((e=>(this.Ei&&this.Ei.close(),Promise.reject(e))))}fi(e){return this.Ii=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.B((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget((async()=>{this.started&&await this.Ai()})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Ts(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.gi(e).next((e=>{e||(this.isPrimary=!1,this.oi.enqueueRetryable((()=>this.Ii(!1))))}))})).next((()=>this.pi(e))).next((t=>this.isPrimary&&!t?this.yi(e).next((()=>!1)):!!t&&this.wi(e).next((()=>!0)))))).catch((e=>{if(le(e))return g("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return g("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.oi.enqueueRetryable((()=>this.Ii(e))),this.isPrimary=e}))}gi(e){return ws(e).get("owner").next((e=>ie.resolve(this.Si(e))))}bi(e){return Ts(e).delete(this.clientId)}async Di(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=Ye(e,"clientMetadata");return t.W().next((e=>{const n=this.vi(e,18e5),r=e.filter((e=>-1===n.indexOf(e)));return ie.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.di)for(const t of e)this.di.removeItem(this.Fi(t.clientId))}}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Ai().then((()=>this.Di())).then((()=>this.mi()))))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?ie.resolve(!0):ws(e).get("owner").next((t=>{if(null!==t&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new A(E.FAILED_PRECONDITION,bs);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ts(e).W().next((e=>void 0===this.vi(e,5e3).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&g("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),await this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(e=>{const t=new Ke(e,me._e);return this.yi(t).next((()=>this.bi(t)))})),this.Ei.close(),this.Li()}vi(e,t){return e.filter((e=>this.Ci(e.updateTimeMs,t)&&!this.Mi(e.clientId)))}Bi(){return this.runTransaction("getActiveClients","readonly",(e=>Ts(e).W().next((e=>this.vi(e,18e5).map((e=>e.clientId))))))}get started(){return this.qr}getMutationQueue(e,t){return Ro.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new To(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Qi.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,n){g("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=function(e){return 16===e?Ve:15===e?ze:14===e?We:13===e?$e:12===e?He:11===e?qe:void b()}(this.ui);let o;return this.Ei.runTransaction(e,r,i,(r=>(o=new Ke(r,this.kr?this.kr.next():me._e),"readwrite-primary"===t?this.gi(o).next((e=>!!e||this.pi(o))).next((t=>{if(!t)throw m(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable((()=>this.Ii(!1))),new A(E.FAILED_PRECONDITION,te);return n(o)})).next((e=>this.wi(o).next((()=>e)))):this.ki(o).next((()=>n(o)))))).then((e=>(o.raiseOnCommittedEvent(),e)))}ki(e){return ws(e).get("owner").next((e=>{if(null!==e&&this.Ci(e.leaseTimestampMs,5e3)&&!this.Mi(e.ownerId)&&!this.Si(e)&&!(this.ai||this.allowTabSynchronization&&e.allowTabSynchronization))throw new A(E.FAILED_PRECONDITION,bs)}))}wi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ws(e).put("owner",t)}static D(){return se.D()}yi(e){const t=ws(e);return t.get("owner").next((e=>this.Si(e)?(g("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):ie.resolve()))}Ci(e,t){const n=Date.now();return!(e<n-t||e>n&&(m(`Detected an update time that is in the future: ${e} > ${n}`),1))}Ri(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.li=()=>{this.oi.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.Ai())))},this.document.addEventListener("visibilitychange",this.li),this.inForeground="visible"===this.document.visibilityState)}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ci=()=>{this.xi();const e=/(?:Version|Mobile)\/1[456]/;Object(a.isSafari)()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{const n=null!==(null===(t=this.di)||void 0===t?void 0:t.getItem(this.Fi(e)));return g("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return m("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){m("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch(e){}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ws(e){return Ye(e,"owner")}function Ts(e){return Ye(e,"clientMetadata")}function Es(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class As{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.qi=n,this.Qi=r}static Ki(e,t){let n=Yn(),r=Yn();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new As(e,t.fromCache,n,r)}}class Ss{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Os{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=Object(a.isSafari)()?8:se.v(Object(a.getUA)())>0?6:4}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ji(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.Hi(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new Ss;return this.Ji(e,t,n).next((r=>{if(i.result=r,this.Ui)return this.Yi(e,t,n,r.size)}))})).next((()=>i.result))}Yi(e,t,n,r){return n.documentReadCount<this.Wi?(f()<=s.LogLevel.DEBUG&&g("QueryEngine","SDK will not create cache indexes for query:",Ln(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),ie.resolve()):(f()<=s.LogLevel.DEBUG&&g("QueryEngine","Query:",Ln(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Gi*r?(f()<=s.LogLevel.DEBUG&&g("QueryEngine","The SDK decides to create cache indexes for query:",Ln(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,In(t))):ie.resolve())}ji(e,t){if(An(t))return ie.resolve(null);let n=In(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=Pn(t,null,"F"),n=In(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=Yn(...r);return this.zi.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const o=this.Zi(t,r);return this.Xi(t,o,i,n.readTime)?this.ji(e,Pn(t,null,"F")):this.es(e,o,t,n)}))))})))))}Hi(e,t,n,r){return An(t)||r.isEqual(B.min())?ie.resolve(null):this.zi.getDocuments(e,n).next((i=>{const o=this.Zi(t,i);return this.Xi(t,o,n,r)?ie.resolve(null):(f()<=s.LogLevel.DEBUG&&g("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Ln(t)),this.es(e,o,t,X(r,-1)).next((e=>e)))}))}Zi(e,t){let n=new nt(jn(e));return t.forEach(((t,r)=>{Dn(e,r)&&(n=n.add(r))})),n}Xi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ji(e,t,n){return f()<=s.LogLevel.DEBUG&&g("QueryEngine","Using full collection scan to execute query:",Ln(t)),this.zi.getDocumentsMatchingQuery(e,t,Z.min(),n)}es(e,t,n,r){return this.zi.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class Is{constructor(e,t,n,r){this.persistence=e,this.ts=t,this.serializer=r,this.ns=new Ze(j),this.rs=new Fn((e=>gn(e)),mn),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(n)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new os(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.ns)))}}function Cs(e,t,n,r){return new Is(e,t,n,r)}async function ks(e,t){const n=T(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n._s(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],o=[];let s=Yn();for(const e of r){i.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}for(const e of t){o.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}return n.localDocuments.getDocuments(e,s).next((e=>({us:e,removedBatchIds:i,addedBatchIds:o})))}))}))}function Ps(e){const t=T(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Qr.getLastRemoteSnapshotVersion(e)))}function xs(e,t,n){let r=Yn(),i=Yn();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=Bn();return n.forEach(((n,o)=>{const s=e.get(n);o.isFoundDocument()!==s.isFoundDocument()&&(i=i.add(n)),o.isNoDocument()&&o.version.isEqual(B.min())?(t.removeEntry(n,o.readTime),r=r.insert(n,o)):!s.isValidDocument()||o.version.compareTo(s.version)>0||0===o.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(o),r=r.insert(n,o)):g("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",o.version)})),{cs:r,ls:i}}))}function Rs(e,t){const n=T(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function Ls(e,t){const n=T(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Qr.getTargetData(e,t).next((i=>i?(r=i,ie.resolve(r)):n.Qr.allocateTargetId(e).next((i=>(r=new Di(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Qr.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.ns.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.ns=n.ns.insert(e.targetId,e),n.rs.set(t,e.targetId)),e}))}async function Ds(e,t,n){const r=T(e),i=r.ns.get(t),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!le(e))throw e;g("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.ns=r.ns.remove(t),r.rs.delete(i.target)}function Ns(e,t,n){const r=T(e);let i=B.min(),o=Yn();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=T(e),i=r.rs.get(n);return void 0!==i?ie.resolve(r.ns.get(i)):r.Qr.getTargetData(t,n)}(r,e,In(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{o=e}))})).next((()=>r.ts.getDocumentsMatchingQuery(e,t,n?i:B.min(),n?o:Yn()))).next((e=>(Fs(r,Nn(t),e),{documents:e,hs:o})))))}function js(e,t){const n=T(e),r=T(n.Qr),i=n.ns.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(e=>r._t(e,t).next((e=>e?e.target:null))))}function Ms(e,t){const n=T(e),r=n.ss.get(t)||B.min();return n.persistence.runTransaction("Get new document changes","readonly",(e=>n.os.getAllFromCollectionGroup(e,t,X(r,-1),Number.MAX_SAFE_INTEGER))).then((e=>(Fs(n,t,e),e)))}function Fs(e,t,n){let r=e.ss.get(t)||B.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.ss.set(t,r)}async function Us(e,t,n=Yn()){const r=await Ls(e,In(Hi(t.bundledQuery))),i=T(e);return i.persistence.runTransaction("Save named query","readwrite",(e=>{const o=ci(t.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.$r.saveNamedQuery(e,t);const s=r.withResumeToken(ct.EMPTY_BYTE_STRING,o);return i.ns=i.ns.insert(s.targetId,s),i.Qr.updateTargetData(e,s).next((()=>i.Qr.removeMatchingKeysForTargetId(e,r.targetId))).next((()=>i.Qr.addMatchingKeys(e,n,r.targetId))).next((()=>i.$r.saveNamedQuery(e,t)))}))}function Bs(e,t){return`firestore_clients_${e}_${t}`}function Gs(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function qs(e,t){return`firestore_targets_${e}_${t}`}class Hs{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Es(e,t,n){const r=JSON.parse(n);let i,o="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return o&&r.error&&(o="string"==typeof r.error.message&&"string"==typeof r.error.code,o&&(i=new A(r.error.code,r.error.message))),o?new Hs(e,t,r.state,i):(m("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}ds(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class $s{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Es(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new A(n.error.code,n.error.message))),i?new $s(e,n.state,r):(m("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ws{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Xn();for(let e=0;r&&e<n.activeTargetIds.length;++e)r=be(n.activeTargetIds[e]),i=i.add(n.activeTargetIds[e]);return r?new Ws(e,i):(m("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class zs{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new zs(t.clientId,t.onlineState):(m("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Vs{constructor(){this.activeTargetIds=Xn()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ks{constructor(e,t,n,r,i){this.window=e,this.oi=t,this.persistenceKey=n,this.Vs=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Ze(j),this.started=!1,this.ys=[];const o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.ws=Bs(this.persistenceKey,this.Vs),this.Ss=function(e){return`firestore_sequence_number_${e}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Vs),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.Fs=function(e){return`firestore_bundle_loaded_v2_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Bi();for(const t of e){if(t===this.Vs)continue;const e=this.getItem(Bs(this.persistenceKey,t));if(e){const n=Ws.Es(t,e);n&&(this.ps=this.ps.insert(n.clientId,n))}}this.Ms();const t=this.storage.getItem(this.vs);if(t){const e=this.xs(t);e&&this.Os(e)}for(const e of this.ys)this.gs(e);this.ys=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach(((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,t,n){this.Ls(e,t,n),this.Bs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(qs(this.persistenceKey,e));if(n){const r=$s.Es(e,n);r&&(t=r.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(qs(this.persistenceKey,e))}updateQueryState(e,t,n){this.qs(e,t,n)}handleUserChange(e,t,n){t.forEach((e=>{this.Bs(e)})),this.currentUser=e,n.forEach((e=>{this.addPendingMutation(e)}))}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return g("SharedClientState","READ",e,t),t}setItem(e,t){g("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){g("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){const t=e;if(t.storageArea===this.storage){if(g("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void m("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable((async()=>{if(this.started){if(null!==t.key)if(this.bs.test(t.key)){if(null==t.newValue){const e=this.$s(t.key);return this.Us(e,null)}{const e=this.Ws(t.key,t.newValue);if(e)return this.Us(e.clientId,e)}}else if(this.Ds.test(t.key)){if(null!==t.newValue){const e=this.Gs(t.key,t.newValue);if(e)return this.zs(e)}}else if(this.Cs.test(t.key)){if(null!==t.newValue){const e=this.js(t.key,t.newValue);if(e)return this.Hs(e)}}else if(t.key===this.vs){if(null!==t.newValue){const e=this.xs(t.newValue);if(e)return this.Os(e)}}else if(t.key===this.Ss){const e=function(e){let t=me._e;if(null!=e)try{const n=JSON.parse(e);_("number"==typeof n),t=n}catch(e){m("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==me._e&&this.sequenceNumberHandler(e)}else if(t.key===this.Fs){const e=this.Js(t.newValue);await Promise.all(e.map((e=>this.syncEngine.Ys(e))))}}else this.ys.push(t)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,t,n){const r=new Hs(this.currentUser,e,t,n),i=Gs(this.persistenceKey,this.currentUser,e);this.setItem(i,r.ds())}Bs(e){const t=Gs(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){const t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,n){const r=qs(this.persistenceKey,e),i=new $s(e,t,n);this.setItem(r,i.ds())}Ks(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){const t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){const n=this.$s(e);return Ws.Es(n,t)}Gs(e,t){const n=this.Ds.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Hs.Es(new u(i),r,t)}js(e,t){const n=this.Cs.exec(e),r=Number(n[1]);return $s.Es(r,t)}xs(e){return zs.Es(e)}Js(e){return JSON.parse(e)}async zs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);g("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){const n=t?this.ps.insert(e,t):this.ps.remove(e),r=this.Ns(this.ps),i=this.Ns(n),o=[],s=[];return i.forEach((e=>{r.has(e)||o.push(e)})),r.forEach((e=>{i.has(e)||s.push(e)})),this.syncEngine.eo(o,s).then((()=>{this.ps=n}))}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=Xn();return e.forEach(((e,n)=>{t=t.unionWith(n.activeTargetIds)})),t}}class Ys{constructor(){this.no=new Vs,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,n){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Vs,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Qs{io(e){}shutdown(){}}class Xs{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){g("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.uo)e(0)}ao(){g("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.uo)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Js=null;function Zs(){return null===Js?Js=268435456+Math.round(2147483648*Math.random()):Js++,"0x"+Js.toString(16)}const ea={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class ta{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}}const na="WebChannelConnection";class ra extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.fo=t+"://"+e.host,this.po=`projects/${n}/databases/${r}`,this.yo="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get wo(){return!1}So(e,t,n,r,i){const o=Zs(),s=this.bo(e,t.toUriEncodedString());g("RestConnection",`Sending RPC '${e}' ${o}:`,s,n);const a={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(a,r,i),this.Co(e,s,a,n).then((t=>(g("RestConnection",`Received RPC '${e}' ${o}: `,t),t)),(t=>{throw y("RestConnection",`RPC '${e}' ${o} failed with error: `,t,"url: ",s,"request:",n),t}))}vo(e,t,n,r,i,o){return this.So(e,t,n,r,i)}Do(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+d,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}bo(e,t){const n=ea[e];return`${this.fo}/v1/${t}:${n}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,t,n,r){const i=Zs();return new Promise(((o,s)=>{const a=new c.XhrIo;a.setWithCredentials(!0),a.listenOnce(c.EventType.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case c.ErrorCode.NO_ERROR:const t=a.getResponseJson();g(na,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),o(t);break;case c.ErrorCode.TIMEOUT:g(na,`RPC '${e}' ${i} timed out`),s(new A(E.DEADLINE_EXCEEDED,"Request time out"));break;case c.ErrorCode.HTTP_ERROR:const n=a.getStatus();if(g(na,`RPC '${e}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(E).indexOf(t)>=0?t:E.UNKNOWN}(t.status);s(new A(e,t.message))}else s(new A(E.UNKNOWN,"Server responded with status "+a.getStatus()))}else s(new A(E.UNAVAILABLE,"Connection failed."));break;default:b()}}finally{g(na,`RPC '${e}' ${i} completed.`)}}));const l=JSON.stringify(r);g(na,`RPC '${e}' ${i} sending request:`,r),a.send(t,"POST",l,n,15)}))}Fo(e,t,n){const r=Zs(),i=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Object(c.createWebChannelTransport)(),s=Object(c.getStatEventTarget)(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Do(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const u=i.join("");g(na,`Creating RPC '${e}' stream ${r}: ${u}`,a);const d=o.createWebChannel(u,a);let h=!1,f=!1;const p=new ta({lo:t=>{f?g(na,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(h||(g(na,`Opening RPC '${e}' stream ${r} transport.`),d.open(),h=!0),g(na,`RPC '${e}' stream ${r} sending:`,t),d.send(t))},ho:()=>d.close()}),m=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return m(d,c.WebChannel.EventType.OPEN,(()=>{f||g(na,`RPC '${e}' stream ${r} transport opened.`)})),m(d,c.WebChannel.EventType.CLOSE,(()=>{f||(f=!0,g(na,`RPC '${e}' stream ${r} transport closed`),p.Vo())})),m(d,c.WebChannel.EventType.ERROR,(t=>{f||(f=!0,y(na,`RPC '${e}' stream ${r} transport errored:`,t),p.Vo(new A(E.UNAVAILABLE,"The operation could not be completed")))})),m(d,c.WebChannel.EventType.MESSAGE,(t=>{var n;if(!f){const i=t.data[0];_(!!i);const o=i,s=o.error||(null===(n=o[0])||void 0===n?void 0:n.error);if(s){g(na,`RPC '${e}' stream ${r} received error:`,s);const t=s.status;let n=function(e){const t=Dr[e];if(void 0!==t)return Mr(t)}(t),i=s.message;void 0===n&&(n=E.INTERNAL,i="Unknown error status: "+t+" with message "+s.message),f=!0,p.Vo(new A(n,i)),d.close()}else g(na,`RPC '${e}' stream ${r} received:`,i),p.mo(i)}})),m(s,c.Event.STAT_EVENT,(t=>{t.stat===c.Stat.PROXY?g(na,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===c.Stat.NOPROXY&&g(na,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{p.Ro()}),0),p}}function ia(){return"undefined"!=typeof window?window:null}function oa(){return"undefined"!=typeof document?document:null}function sa(e){return new ri(e,!0)}class aa{constructor(e,t,n=1e3,r=1.5,i=6e4){this.oi=e,this.timerId=t,this.Mo=n,this.xo=r,this.Oo=i,this.No=0,this.Lo=null,this.Bo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();const t=Math.floor(this.No+this.Qo()),n=Math.max(0,Date.now()-this.Bo),r=Math.max(0,t-n);r>0&&g("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.No} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Lo=this.oi.enqueueAfterDelay(this.timerId,r,(()=>(this.Bo=Date.now(),e()))),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Lo&&(this.Lo.skipDelay(),this.Lo=null)}cancel(){null!==this.Lo&&(this.Lo.cancel(),this.Lo=null)}Qo(){return(Math.random()-.5)*this.No}}class ca{constructor(e,t,n,r,i,o,s,a){this.oi=e,this.$o=n,this.Uo=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=a,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new aa(e,t)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,(()=>this.e_())))}t_(e){this.n_(),this.stream.send(e)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(e,t){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==e?this.jo.reset():t&&t.code===E.RESOURCE_EXHAUSTED?(m(t.toString()),m("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):t&&t.code===E.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.To(t)}i_(){}auth(){this.state=1;const e=this.s_(this.Wo),t=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.Wo===t&&this.o_(e,n)}),(t=>{e((()=>{const e=new A(E.UNKNOWN,"Fetching auth token failed: "+t.message);return this.__(e)}))}))}o_(e,t){const n=this.s_(this.Wo);this.stream=this.a_(e,t),this.stream.Po((()=>{n((()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,(()=>(this.Jo()&&(this.state=3),Promise.resolve()))),this.listener.Po())))})),this.stream.To((e=>{n((()=>this.__(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Yo(){this.state=5,this.jo.qo((async()=>{this.state=0,this.start()}))}__(e){return g("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return t=>{this.oi.enqueueAndForget((()=>this.Wo===e?t():(g("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class la extends ca{constructor(e,t,n,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i}a_(e,t){return this.connection.Fo("Listen",e,t)}onMessage(e){this.jo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const i=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:b()}(t.targetChange.targetChangeType||"NO_CHANGE"),o=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(_(void 0===t||"string"==typeof t),ct.fromBase64String(t||"")):(_(void 0===t||t instanceof r||t instanceof Uint8Array),ct.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,c=a&&function(e){const t=void 0===e.code?E.UNKNOWN:Mr(e.code);return new A(t,e.message||"")}(a);n=new Yr(i,o,s,c||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=fi(e,r.document.name),o=ci(r.document.updateTime),s=r.document.createTime?ci(r.document.createTime):B.min(),a=new Ut({mapValue:{fields:r.document.fields}}),c=Gt.newFoundDocument(i,o,s,a),l=r.targetIds||[],u=r.removedTargetIds||[];n=new Vr(l,u,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=fi(e,r.document),o=r.readTime?ci(r.readTime):B.min(),s=Gt.newNoDocument(i,o),a=r.removedTargetIds||[];n=new Vr([],a,s.key,s)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=fi(e,r.document),o=r.removedTargetIds||[];n=new Vr([],o,i,null)}else{if(!("filter"in t))return b();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,o=new Lr(r,i),s=e.targetId;n=new Kr(s,o)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return B.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?B.min():t.readTime?ci(t.readTime):B.min()}(e);return this.listener.u_(t,n)}c_(e){const t={};t.database=mi(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=yn(r)?{documents:Ti(e,r)}:{query:Ei(e,r).ut},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=si(e,t.resumeToken);const r=ii(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(B.min())>0){n.readTime=oi(e,t.snapshotVersion.toTimestamp());const r=ii(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return b()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.t_(t)}l_(e){const t={};t.database=mi(this.serializer),t.removeTarget=e,this.t_(t)}}class ua extends ca{constructor(e,t,n,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,o),this.serializer=i,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,t){return this.connection.Fo("Write",e,t)}onMessage(e){if(_(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();const t=function(e,t){return e&&e.length>0?(_(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?ci(e.updateTime):ci(t);return n.isEqual(B.min())&&(n=ci(t)),new pr(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=ci(e.commitTime);return this.listener.T_(n,t)}return _(!e.writeResults||0===e.writeResults.length),this.h_=!0,this.listener.E_()}d_(){const e={};e.database=mi(this.serializer),this.t_(e)}I_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>_i(this.serializer,e)))};this.t_(t)}}class da extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.A_=!1}R_(){if(this.A_)throw new A(E.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n,r){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,o])=>this.connection.So(e,ui(t,n),r,i,o))).catch((e=>{throw"FirebaseError"===e.name?(e.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new A(E.UNKNOWN,e.toString())}))}vo(e,t,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,s])=>this.connection.vo(e,ui(t,n),r,o,s,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===E.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new A(E.UNKNOWN,e.toString())}))}terminate(){this.A_=!0,this.connection.terminate()}}class ha{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve()))))}S_(e){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,"Online"===e&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(m(t),this.g_=!1):g("OnlineStateTracker",t)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class fa{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=i,this.M_.io((e=>{n.enqueueAndForget((async()=>{Ta(this)&&(g("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=T(e);t.v_.add(4),await ga(t),t.x_.set("Unknown"),t.v_.delete(4),await pa(t)}(this))}))})),this.x_=new ha(n,r)}}async function pa(e){if(Ta(e))for(const t of e.F_)await t(!0)}async function ga(e){for(const t of e.F_)await t(!1)}function ma(e,t){const n=T(e);n.C_.has(t.targetId)||(n.C_.set(t.targetId,t),wa(n)?_a(n):Ba(n).Jo()&&va(n,t))}function ya(e,t){const n=T(e),r=Ba(n);n.C_.delete(t),r.Jo()&&ba(n,t),0===n.C_.size&&(r.Jo()?r.Xo():Ta(n)&&n.x_.set("Unknown"))}function va(e,t){if(e.O_.Oe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(B.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Ba(e).c_(t)}function ba(e,t){e.O_.Oe(t),Ba(e).l_(t)}function _a(e){e.O_=new Xr({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),_t:t=>e.C_.get(t)||null,nt:()=>e.datastore.serializer.databaseId}),Ba(e).start(),e.x_.p_()}function wa(e){return Ta(e)&&!Ba(e).Ho()&&e.C_.size>0}function Ta(e){return 0===T(e).v_.size}function Ea(e){e.O_=void 0}async function Aa(e){e.C_.forEach(((t,n)=>{va(e,t)}))}async function Sa(e,t){Ea(e),wa(e)?(e.x_.S_(t),_a(e)):e.x_.set("Unknown")}async function Oa(e,t,n){if(e.x_.set("Online"),t instanceof Yr&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.C_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.C_.delete(r),e.O_.removeTarget(r))}(e,t)}catch(n){g("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Ia(e,n)}else if(t instanceof Vr?e.O_.$e(t):t instanceof Kr?e.O_.Je(t):e.O_.Ge(t),!n.isEqual(B.min()))try{const t=await Ps(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.O_.it(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.C_.get(r);i&&e.C_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.C_.get(t);if(!r)return;e.C_.set(t,r.withResumeToken(ct.EMPTY_BYTE_STRING,r.snapshotVersion)),ba(e,t);const i=new Di(r.target,t,n,r.sequenceNumber);va(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){g("RemoteStore","Failed to raise snapshot:",t),await Ia(e,t)}}async function Ia(e,t,n){if(!le(t))throw t;e.v_.add(1),await ga(e),e.x_.set("Offline"),n||(n=()=>Ps(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{g("RemoteStore","Retrying IndexedDB access"),await n(),e.v_.delete(1),await pa(e)}))}function Ca(e,t){return t().catch((n=>Ia(e,n,t)))}async function ka(e){const t=T(e),n=Ga(t);let r=t.D_.length>0?t.D_[t.D_.length-1].batchId:-1;for(;Pa(t);)try{const e=await Rs(t.localStore,r);if(null===e){0===t.D_.length&&n.Xo();break}r=e.batchId,xa(t,e)}catch(e){await Ia(t,e)}Ra(t)&&La(t)}function Pa(e){return Ta(e)&&e.D_.length<10}function xa(e,t){e.D_.push(t);const n=Ga(e);n.Jo()&&n.P_&&n.I_(t.mutations)}function Ra(e){return Ta(e)&&!Ga(e).Ho()&&e.D_.length>0}function La(e){Ga(e).start()}async function Da(e){Ga(e).d_()}async function Na(e){const t=Ga(e);for(const n of e.D_)t.I_(n.mutations)}async function ja(e,t,n){const r=e.D_.shift(),i=xr.from(r,t,n);await Ca(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await ka(e)}async function Ma(e,t){t&&Ga(e).P_&&await async function(e,t){if(function(e){return jr(e)&&e!==E.ABORTED}(t.code)){const n=e.D_.shift();Ga(e).Zo(),await Ca(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await ka(e)}}(e,t),Ra(e)&&La(e)}async function Fa(e,t){const n=T(e);n.asyncQueue.verifyOperationInProgress(),g("RemoteStore","RemoteStore received new credentials");const r=Ta(n);n.v_.add(3),await ga(n),r&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.v_.delete(3),await pa(n)}async function Ua(e,t){const n=T(e);t?(n.v_.delete(2),await pa(n)):t||(n.v_.add(2),await ga(n),n.x_.set("Unknown"))}function Ba(e){return e.N_||(e.N_=function(e,t,n){const r=T(e);return r.R_(),new la(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Po:Aa.bind(null,e),To:Sa.bind(null,e),u_:Oa.bind(null,e)}),e.F_.push((async t=>{t?(e.N_.Zo(),wa(e)?_a(e):e.x_.set("Unknown")):(await e.N_.stop(),Ea(e))}))),e.N_}function Ga(e){return e.L_||(e.L_=function(e,t,n){const r=T(e);return r.R_(),new ua(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Po:Da.bind(null,e),To:Ma.bind(null,e),E_:Na.bind(null,e),T_:ja.bind(null,e)}),e.F_.push((async t=>{t?(e.L_.Zo(),await ka(e)):(await e.L_.stop(),e.D_.length>0&&(g("RemoteStore",`Stopping write stream with ${e.D_.length} pending writes`),e.D_=[]))}))),e.L_}class qa{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new S,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const o=Date.now()+n,s=new qa(e,t,o,r,i);return s.start(n),s}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new A(E.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ha(e,t){if(m("AsyncQueue",`${t}: ${e}`),le(e))return new A(E.UNAVAILABLE,`${t}: ${e}`);throw e}class $a{constructor(e){this.comparator=e?(t,n)=>e(t,n)||W.comparator(t.key,n.key):(e,t)=>W.comparator(e.key,t.key),this.keyedMap=qn(),this.sortedSet=new Ze(this.comparator)}static emptySet(e){return new $a(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof $a))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new $a;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Wa{constructor(){this.B_=new Ze(W.comparator)}track(e){const t=e.doc.key,n=this.B_.get(t);n?0!==e.type&&3===n.type?this.B_=this.B_.insert(t,e):3===e.type&&1!==n.type?this.B_=this.B_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.B_=this.B_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.B_=this.B_.remove(t):1===e.type&&2===n.type?this.B_=this.B_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.B_=this.B_.insert(t,{type:2,doc:e.doc}):b():this.B_=this.B_.insert(t,e)}k_(){const e=[];return this.B_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class za{constructor(e,t,n,r,i,o,s,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,i){const o=[];return t.forEach((e=>{o.push({type:0,doc:e})})),new za(e,t,$a.emptySet(t),o,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&xn(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class Va{constructor(){this.q_=void 0,this.Q_=[]}K_(){return this.Q_.some((e=>e.U_()))}}class Ka{constructor(){this.queries=new Fn((e=>Rn(e)),xn),this.onlineState="Unknown",this.W_=new Set}}async function Ya(e,t){const n=T(e);let r=3;const i=t.query;let o=n.queries.get(i);o?!o.K_()&&t.U_()&&(r=2):(o=new Va,r=t.U_()?0:1);try{switch(r){case 0:o.q_=await n.onListen(i,!0);break;case 1:o.q_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=Ha(e,`Initialization of query '${Ln(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,o),o.Q_.push(t),t.G_(n.onlineState),o.q_&&t.z_(o.q_)&&Za(n)}async function Qa(e,t){const n=T(e),r=t.query;let i=3;const o=n.queries.get(r);if(o){const e=o.Q_.indexOf(t);e>=0&&(o.Q_.splice(e,1),0===o.Q_.length?i=t.U_()?0:1:!o.K_()&&t.U_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Xa(e,t){const n=T(e);let r=!1;for(const e of t){const t=e.query,i=n.queries.get(t);if(i){for(const t of i.Q_)t.z_(e)&&(r=!0);i.q_=e}}r&&Za(n)}function Ja(e,t,n){const r=T(e),i=r.queries.get(t);if(i)for(const e of i.Q_)e.onError(n);r.queries.delete(t)}function Za(e){e.W_.forEach((e=>{e.next()}))}var ec,tc;(tc=ec||(ec={})).j_="default",tc.Cache="cache";class nc{constructor(e,t,n){this.query=e,this.H_=t,this.J_=!1,this.Y_=null,this.onlineState="Unknown",this.options=n||{}}z_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new za(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.J_?this.Z_(e)&&(this.H_.next(e),t=!0):this.X_(e,this.onlineState)&&(this.ea(e),t=!0),this.Y_=e,t}onError(e){this.H_.error(e)}G_(e){this.onlineState=e;let t=!1;return this.Y_&&!this.J_&&this.X_(this.Y_,e)&&(this.ea(this.Y_),t=!0),t}X_(e,t){if(!e.fromCache)return!0;if(!this.U_())return!0;const n="Offline"!==t;return(!this.options.ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Z_(e){if(e.docChanges.length>0)return!0;const t=this.Y_&&this.Y_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ea(e){e=za.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.J_=!0,this.H_.next(e)}U_(){return this.options.source!==ec.Cache}}class rc{constructor(e,t){this.na=e,this.byteLength=t}ra(){return"metadata"in this.na}}class ic{constructor(e){this.serializer=e}Ps(e){return fi(this.serializer,e)}Is(e){return e.metadata.exists?bi(this.serializer,e.document,!1):Gt.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return ci(e)}}class oc{constructor(e,t,n){this.ia=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=sc(e)}sa(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.na.namedQuery)this.queries.push(e.na.namedQuery);else if(e.na.documentMetadata){this.documents.push({metadata:e.na.documentMetadata}),e.na.documentMetadata.exists||++t;const n=q.fromString(e.na.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.na.document&&(this.documents[this.documents.length-1].document=e.na.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}oa(e){const t=new Map,n=new ic(this.serializer);for(const r of e)if(r.metadata.queries){const e=n.Ps(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||Yn()).add(e);t.set(n,r)}}return t}async complete(){const e=await async function(e,t,n,r){const i=T(e);let o=Yn(),s=Bn();for(const e of n){const n=t.Ps(e.metadata.name);e.document&&(o=o.add(n));const r=t.Is(e);r.setReadTime(t.Ts(e.metadata.readTime)),s=s.insert(n,r)}const a=i.os.newChangeBuffer({trackRemovals:!0}),c=await Ls(i,function(e){return In(En(q.fromString(`__bundle__/docs/${e}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(e=>xs(e,a,s).next((t=>(a.apply(e),t))).next((t=>i.Qr.removeMatchingKeysForTargetId(e,c.targetId).next((()=>i.Qr.addMatchingKeys(e,o,c.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(e,t.cs,t.ls))).next((()=>t.cs))))))}(this.localStore,new ic(this.serializer),this.documents,this.ia.id),t=this.oa(this.documents);for(const e of this.queries)await Us(this.localStore,e,t.get(e.name));return this.progress.taskState="Success",{progress:this.progress,_a:this.collectionGroups,aa:e}}}function sc(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class ac{constructor(e){this.key=e}}class cc{constructor(e){this.key=e}}class lc{constructor(e,t){this.query=e,this.ua=t,this.ca=null,this.hasCachedResults=!1,this.current=!1,this.la=Yn(),this.mutatedKeys=Yn(),this.ha=jn(e),this.Pa=new $a(this.ha)}get Ia(){return this.ua}Ta(e,t){const n=t?t.Ea:new Wa,r=t?t.Pa:this.Pa;let i=t?t.mutatedKeys:this.mutatedKeys,o=r,s=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const l=r.get(e),u=Dn(this.query,t)?t:null,d=!!l&&this.mutatedKeys.has(l.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;l&&u?l.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),f=!0):this.da(l,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.ha(u,a)>0||c&&this.ha(u,c)<0)&&(s=!0)):!l&&u?(n.track({type:0,doc:u}),f=!0):l&&!u&&(n.track({type:1,doc:l}),f=!0,(a||c)&&(s=!0)),f&&(u?(o=o.add(u),i=h?i.add(e):i.delete(e)):(o=o.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;o.size>this.query.limit;){const e="F"===this.query.limitType?o.last():o.first();o=o.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Pa:o,Ea:n,Xi:s,mutatedKeys:i}}da(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.Pa;this.Pa=e.Pa,this.mutatedKeys=e.mutatedKeys;const o=e.Ea.k_();o.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return b()}};return n(e)-n(t)}(e.type,t.type)||this.ha(e.doc,t.doc))),this.Aa(n),r=null!=r&&r;const s=t&&!r?this.Ra():[],a=0===this.la.size&&this.current&&!r?1:0,c=a!==this.ca;return this.ca=a,0!==o.length||c?{snapshot:new za(this.query,e.Pa,i,o,e.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),Va:s}:{Va:s}}G_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Pa:this.Pa,Ea:new Wa,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{Va:[]}}ma(e){return!this.ua.has(e)&&!!this.Pa.has(e)&&!this.Pa.get(e).hasLocalMutations}Aa(e){e&&(e.addedDocuments.forEach((e=>this.ua=this.ua.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.ua=this.ua.delete(e))),this.current=e.current)}Ra(){if(!this.current)return[];const e=this.la;this.la=Yn(),this.Pa.forEach((e=>{this.ma(e.key)&&(this.la=this.la.add(e.key))}));const t=[];return e.forEach((e=>{this.la.has(e)||t.push(new cc(e))})),this.la.forEach((n=>{e.has(n)||t.push(new ac(n))})),t}fa(e){this.ua=e.hs,this.la=Yn();const t=this.Ta(e.documents);return this.applyChanges(t,!0)}ga(){return za.fromInitialDocuments(this.query,this.Pa,this.mutatedKeys,0===this.ca,this.hasCachedResults)}}class uc{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class dc{constructor(e){this.key=e,this.pa=!1}}class hc{constructor(e,t,n,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.ya={},this.wa=new Fn((e=>Rn(e)),xn),this.Sa=new Map,this.ba=new Set,this.Da=new Ze(W.comparator),this.Ca=new Map,this.va=new cs,this.Fa={},this.Ma=new Map,this.xa=Mo.Ln(),this.onlineState="Unknown",this.Oa=void 0}get isPrimaryClient(){return!0===this.Oa}}async function fc(e,t,n=!0){const r=qc(e);let i;const o=r.wa.get(t);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.ga()):i=await gc(r,t,n,!0),i}async function pc(e,t){const n=qc(e);await gc(n,t,!0,!1)}async function gc(e,t,n,r){const i=await Ls(e.localStore,In(t)),o=i.targetId,s=n?e.sharedClientState.addLocalQueryTarget(o):"not-current";let a;return r&&(a=await mc(e,t,o,"current"===s,i.resumeToken)),e.isPrimaryClient&&n&&ma(e.remoteStore,i),a}async function mc(e,t,n,r,i){e.Na=(t,n,r)=>async function(e,t,n,r){let i=t.view.Ta(n);i.Xi&&(i=await Ns(e.localStore,t.query,!1).then((({documents:e})=>t.view.Ta(e,i))));const o=r&&r.targetChanges.get(t.targetId),s=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,o,s);return Cc(e,t.targetId,a.Va),a.snapshot}(e,t,n,r);const o=await Ns(e.localStore,t,!0),s=new lc(t,o.hs),a=s.Ta(o.documents),c=zr.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),l=s.applyChanges(a,e.isPrimaryClient,c);Cc(e,n,l.Va);const u=new uc(t,n,s);return e.wa.set(t,u),e.Sa.has(n)?e.Sa.get(n).push(t):e.Sa.set(n,[t]),l.snapshot}async function yc(e,t,n){const r=T(e),i=r.wa.get(t),o=r.Sa.get(i.targetId);if(o.length>1)return r.Sa.set(i.targetId,o.filter((e=>!xn(e,t)))),void r.wa.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Ds(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&ya(r.remoteStore,i.targetId),Oc(r,i.targetId)})).catch(re)):(Oc(r,i.targetId),await Ds(r.localStore,i.targetId,!0))}async function vc(e,t){const n=T(e),r=n.wa.get(t),i=n.Sa.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),ya(n.remoteStore,r.targetId))}async function bc(e,t){const n=T(e);try{const e=await function(e,t){const n=T(e),r=t.snapshotVersion;let i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;const s=[];t.targetChanges.forEach(((o,a)=>{const c=i.get(a);if(!c)return;s.push(n.Qr.removeMatchingKeys(e,o.removedDocuments,a).next((()=>n.Qr.addMatchingKeys(e,o.addedDocuments,a))));let l=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?l=l.withResumeToken(ct.EMPTY_BYTE_STRING,B.min()).withLastLimboFreeSnapshotVersion(B.min()):o.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(o.resumeToken,r)),i=i.insert(a,l),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,l,o)&&s.push(n.Qr.updateTargetData(e,l))}));let a=Bn(),c=Yn();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),s.push(xs(e,o,t.documentUpdates).next((e=>{a=e.cs,c=e.ls}))),!r.isEqual(B.min())){const t=n.Qr.getLastRemoteSnapshotVersion(e).next((t=>n.Qr.setTargetsMetadata(e,e.currentSequenceNumber,r)));s.push(t)}return ie.waitFor(s).next((()=>o.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,c))).next((()=>a))})).then((e=>(n.ns=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Ca.get(t);r&&(_(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.pa=!0:e.modifiedDocuments.size>0?_(r.pa):e.removedDocuments.size>0&&(_(r.pa),r.pa=!1))})),await xc(n,e,t)}catch(e){await re(e)}}function _c(e,t,n){const r=T(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.wa.forEach(((n,r)=>{const i=r.view.G_(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=T(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const e of n.Q_)e.G_(t)&&(r=!0)})),r&&Za(n)}(r.eventManager,t),e.length&&r.ya.u_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function wc(e,t,n){const r=T(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Ca.get(t),o=i&&i.key;if(o){let e=new Ze(W.comparator);e=e.insert(o,Gt.newNoDocument(o,B.min()));const n=Yn().add(o),i=new Wr(B.min(),new Map,new Ze(j),e,n);await bc(r,i),r.Da=r.Da.remove(o),r.Ca.delete(t),Pc(r)}else await Ds(r.localStore,t,!1).then((()=>Oc(r,t,n))).catch(re)}async function Tc(e,t){const n=T(e),r=t.batch.batchId;try{const e=await function(e,t){const n=T(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.os.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,o=i.keys();let s=ie.resolve();return o.forEach((e=>{s=s.next((()=>r.getEntry(t,e))).next((t=>{const o=n.docVersions.get(e);_(null!==o),t.version.compareTo(o)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),s.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Yn();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);Sc(n,r,null),Ac(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await xc(n,e)}catch(e){await re(e)}}async function Ec(e,t,n){const r=T(e);try{const e=await function(e,t){const n=T(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(_(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);Sc(r,t,n),Ac(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await xc(r,e)}catch(n){await re(n)}}function Ac(e,t){(e.Ma.get(t)||[]).forEach((e=>{e.resolve()})),e.Ma.delete(t)}function Sc(e,t,n){const r=T(e);let i=r.Fa[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Fa[r.currentUser.toKey()]=i}}function Oc(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Sa.get(t))e.wa.delete(r),n&&e.ya.La(r,n);e.Sa.delete(t),e.isPrimaryClient&&e.va.Vr(t).forEach((t=>{e.va.containsKey(t)||Ic(e,t)}))}function Ic(e,t){e.ba.delete(t.path.canonicalString());const n=e.Da.get(t);null!==n&&(ya(e.remoteStore,n),e.Da=e.Da.remove(t),e.Ca.delete(n),Pc(e))}function Cc(e,t,n){for(const r of n)r instanceof ac?(e.va.addReference(r.key,t),kc(e,r)):r instanceof cc?(g("SyncEngine","Document no longer in limbo: "+r.key),e.va.removeReference(r.key,t),e.va.containsKey(r.key)||Ic(e,r.key)):b()}function kc(e,t){const n=t.key,r=n.path.canonicalString();e.Da.get(n)||e.ba.has(r)||(g("SyncEngine","New document in limbo: "+n),e.ba.add(r),Pc(e))}function Pc(e){for(;e.ba.size>0&&e.Da.size<e.maxConcurrentLimboResolutions;){const t=e.ba.values().next().value;e.ba.delete(t);const n=new W(q.fromString(t)),r=e.xa.next();e.Ca.set(r,new dc(n)),e.Da=e.Da.insert(n,r),ma(e.remoteStore,new Di(In(En(n.path)),r,"TargetPurposeLimboResolution",me._e))}}async function xc(e,t,n){const r=T(e),i=[],o=[],s=[];r.wa.isEmpty()||(r.wa.forEach(((e,a)=>{s.push(r.Na(a,t,n).then((e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);const t=As.Ki(a.targetId,e);o.push(t)}})))})),await Promise.all(s),r.ya.u_(i),await async function(e,t){const n=T(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>ie.forEach(t,(t=>ie.forEach(t.qi,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>ie.forEach(t.Qi,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!le(e))throw e;g("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.ns.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.ns=n.ns.insert(t,i)}}}(r.localStore,o))}async function Rc(e,t){const n=T(e);if(!n.currentUser.isEqual(t)){g("SyncEngine","User change. New user:",t.toKey());const e=await ks(n.localStore,t);n.currentUser=t,function(e,t){e.Ma.forEach((e=>{e.forEach((e=>{e.reject(new A(E.CANCELLED,t))}))})),e.Ma.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await xc(n,e.us)}}function Lc(e,t){const n=T(e),r=n.Ca.get(t);if(r&&r.pa)return Yn().add(r.key);{let e=Yn();const r=n.Sa.get(t);if(!r)return e;for(const t of r){const r=n.wa.get(t);e=e.unionWith(r.view.Ia)}return e}}async function Dc(e,t){const n=T(e),r=await Ns(n.localStore,t.query,!0),i=t.view.fa(r);return n.isPrimaryClient&&Cc(n,t.targetId,i.Va),i}async function Nc(e,t){const n=T(e);return Ms(n.localStore,t).then((e=>xc(n,e)))}async function jc(e,t,n,r){const i=T(e),o=await function(e,t){const n=T(e),r=T(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(e=>r.vn(e,t).next((t=>t?n.localDocuments.getDocuments(e,t):ie.resolve(null)))))}(i.localStore,t);null!==o?("pending"===n?await ka(i.remoteStore):"acknowledged"===n||"rejected"===n?(Sc(i,t,r||null),Ac(i,t),function(e,t){T(T(e).mutationQueue).Mn(t)}(i.localStore,t)):b(),await xc(i,o)):g("SyncEngine","Cannot apply mutation batch with id: "+t)}async function Mc(e,t,n){const r=T(e),i=[],o=[];for(const e of t){let t;const n=r.Sa.get(e);if(n&&0!==n.length){t=await Ls(r.localStore,In(n[0]));for(const e of n){const t=r.wa.get(e),n=await Dc(r,t);n.snapshot&&o.push(n.snapshot)}}else{const n=await js(r.localStore,e);t=await Ls(r.localStore,n),await mc(r,Fc(n),e,!1,t.resumeToken)}i.push(t)}return r.ya.u_(o),i}function Fc(e){return Tn(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Uc(e){return function(e){return T(T(e).persistence).Bi()}(T(e).localStore)}async function Bc(e,t,n,r){const i=T(e);if(i.Oa)return void g("SyncEngine","Ignoring unexpected query state notification.");const o=i.Sa.get(t);if(o&&o.length>0)switch(n){case"current":case"not-current":{const e=await Ms(i.localStore,Nn(o[0])),r=Wr.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,ct.EMPTY_BYTE_STRING);await xc(i,e,r);break}case"rejected":await Ds(i.localStore,t,!0),Oc(i,t,r);break;default:b()}}async function Gc(e,t,n){const r=qc(e);if(r.Oa){for(const e of t){if(r.Sa.has(e)&&r.sharedClientState.isActiveQueryTarget(e)){g("SyncEngine","Adding an already active target "+e);continue}const t=await js(r.localStore,e),n=await Ls(r.localStore,t);await mc(r,Fc(t),n.targetId,!1,n.resumeToken),ma(r.remoteStore,n)}for(const e of n)r.Sa.has(e)&&await Ds(r.localStore,e,!1).then((()=>{ya(r.remoteStore,e),Oc(r,e)})).catch(re)}}function qc(e){const t=T(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=bc.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Lc.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=wc.bind(null,t),t.ya.u_=Xa.bind(null,t.eventManager),t.ya.La=Ja.bind(null,t.eventManager),t}function Hc(e){const t=T(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Tc.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Ec.bind(null,t),t}class $c{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=sa(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return Cs(this.persistence,new Os,e.initialUser,this.serializer)}createPersistence(e){return new ps(ms.Hr,this.serializer)}createSharedClientState(e){return new Ys}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Wc extends $c{constructor(e,t,n){super(),this.ka=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.ka.initialize(this,e),await Hc(this.ka.syncEngine),await ka(this.ka.remoteStore),await this.persistence.fi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}createLocalStore(e){return Cs(this.persistence,new Os,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new $o(n,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const n=new ge(t,this.persistence);return new pe(e.asyncQueue,n)}createPersistence(e){const t=Es(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?ko.withCacheSize(this.cacheSizeBytes):ko.DEFAULT;return new _s(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,ia(),oa(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Ys}}class zc extends Wc{constructor(e,t){super(e,t,!1),this.ka=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.ka.syncEngine;this.sharedClientState instanceof Ks&&(this.sharedClientState.syncEngine={Zs:jc.bind(null,t),Xs:Bc.bind(null,t),eo:Gc.bind(null,t),Bi:Uc.bind(null,t),Ys:Nc.bind(null,t)},await this.sharedClientState.start()),await this.persistence.fi((async e=>{await async function(e,t){const n=T(e);if(qc(n),Hc(n),!0===t&&!0!==n.Oa){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await Mc(n,e.toArray());n.Oa=!0,await Ua(n.remoteStore,!0);for(const e of t)ma(n.remoteStore,e)}else if(!1===t&&!1!==n.Oa){const e=[];let t=Promise.resolve();n.Sa.forEach(((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then((()=>(Oc(n,i),Ds(n.localStore,i,!0)))),ya(n.remoteStore,i)})),await t,await Mc(n,e),function(e){const t=T(e);t.Ca.forEach(((e,n)=>{ya(t.remoteStore,n)})),t.va.mr(),t.Ca=new Map,t.Da=new Ze(W.comparator)}(n),n.Oa=!1,await Ua(n.remoteStore,!1)}}(this.ka.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())}))}createSharedClientState(e){const t=ia();if(!Ks.D(t))throw new A(E.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=Es(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ks(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class Vc{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>_c(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Rc.bind(null,this.syncEngine),await Ua(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Ka}createDatastore(e){const t=sa(e.databaseInfo.databaseId),n=function(e){return new ra(e)}(e.databaseInfo);return function(e,t,n,r){return new da(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new fa(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>_c(this.syncEngine,e,0)),Xs.D()?new Xs:new Qs)}createSyncEngine(e,t){return function(e,t,n,r,i,o,s){const a=new hc(e,t,n,r,i,o);return s&&(a.Oa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e;await async function(e){const t=T(e);g("RemoteStore","RemoteStore shutting down."),t.v_.add(5),await ga(t),t.M_.shutdown(),t.x_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate()}}function Kc(e,t=10240){let n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class Yc{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.qa(this.observer.next,e)}error(e){this.observer.error?this.qa(this.observer.error,e):m("Uncaught Error in snapshot listener:",e.toString())}Qa(){this.muted=!0}qa(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class Qc{constructor(e,t){this.Ka=e,this.serializer=t,this.metadata=new S,this.buffer=new Uint8Array,this.$a=new TextDecoder("utf-8"),this.Ua().then((e=>{e&&e.ra()?this.metadata.resolve(e.na.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==e?void 0:e.na)}`))}),(e=>this.metadata.reject(e)))}close(){return this.Ka.cancel()}async getMetadata(){return this.metadata.promise}async Ba(){return await this.getMetadata(),this.Ua()}async Ua(){const e=await this.Wa();if(null===e)return null;const t=this.$a.decode(e),n=Number(t);isNaN(n)&&this.Ga(`length string (${t}) is not valid number`);const r=await this.za(n);return new rc(JSON.parse(r),e.length+n)}ja(){return this.buffer.findIndex((e=>e==="{".charCodeAt(0)))}async Wa(){for(;this.ja()<0&&!await this.Ha(););if(0===this.buffer.length)return null;const e=this.ja();e<0&&this.Ga("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async za(e){for(;this.buffer.length<e;)await this.Ha()&&this.Ga("Reached the end of bundle when more is expected.");const t=this.$a.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Ga(e){throw this.Ka.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ha(){const e=await this.Ka.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class Xc{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new A(E.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(e,t){const n=T(e),r={documents:t.map((e=>hi(n.serializer,e)))},i=await n.vo("BatchGetDocuments",n.serializer.databaseId,q.emptyPath(),r,t.length),o=new Map;i.forEach((e=>{const t=function(e,t){return"found"in t?function(e,t){_(!!t.found),t.found.name,t.found.updateTime;const n=fi(e,t.found.name),r=ci(t.found.updateTime),i=t.found.createTime?ci(t.found.createTime):B.min(),o=new Ut({mapValue:{fields:t.found.fields}});return Gt.newFoundDocument(n,r,i,o)}(e,t):"missing"in t?function(e,t){_(!!t.missing),_(!!t.readTime);const n=fi(e,t.missing),r=ci(t.readTime);return Gt.newNoDocument(n,r)}(e,t):b()}(n.serializer,e);o.set(t.key.toString(),t)}));const s=[];return t.forEach((e=>{const t=o.get(e.toString());_(!!t),s.push(t)})),s}(this.datastore,e);return t.forEach((e=>this.recordVersion(e))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new Cr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((e,t)=>{const n=W.fromPath(t);this.mutations.push(new kr(n,this.precondition(n)))})),await async function(e,t){const n=T(e),r={writes:t.map((e=>_i(n.serializer,e)))};await n.So("Commit",n.serializer.databaseId,q.emptyPath(),r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw b();t=B.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new A(E.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(B.min())?gr.exists(!1):gr.updateTime(t):gr.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(B.min()))throw new A(E.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return gr.updateTime(t)}return gr.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Jc{constructor(e,t,n,r,i){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=i,this.Ja=n.maxAttempts,this.jo=new aa(this.asyncQueue,"transaction_retry")}Ya(){this.Ja-=1,this.Za()}Za(){this.jo.qo((async()=>{const e=new Xc(this.datastore),t=this.Xa(e);t&&t.then((t=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(t)})).catch((e=>{this.eu(e)}))))})).catch((e=>{this.eu(e)}))}))}Xa(e){try{const t=this.updateFunction(e);return!ye(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}eu(e){this.Ja>0&&this.tu(e)?(this.Ja-=1,this.asyncQueue.enqueueAndForget((()=>(this.Za(),Promise.resolve())))):this.deferred.reject(e)}tu(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!jr(t)}return!1}}class Zc{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=u.UNAUTHENTICATED,this.clientId=N.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{g("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(g("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new A(E.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new S;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Ha(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function el(e,t){e.asyncQueue.verifyOperationInProgress(),g("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await ks(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function tl(e,t){e.asyncQueue.verifyOperationInProgress();const n=await rl(e);g("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>Fa(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Fa(t.remoteStore,n))),e._onlineComponents=t}function nl(e){return"FirebaseError"===e.name?e.code===E.FAILED_PRECONDITION||e.code===E.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function rl(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){g("FirestoreClient","Using user provided OfflineComponentProvider");try{await el(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!nl(n))throw n;y("Error using user provided cache. Falling back to memory cache: "+n),await el(e,new $c)}}else g("FirestoreClient","Using default OfflineComponentProvider"),await el(e,new $c);return e._offlineComponents}async function il(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(g("FirestoreClient","Using user provided OnlineComponentProvider"),await tl(e,e._uninitializedComponentsProvider._online)):(g("FirestoreClient","Using default OnlineComponentProvider"),await tl(e,new Vc))),e._onlineComponents}function ol(e){return rl(e).then((e=>e.persistence))}function sl(e){return rl(e).then((e=>e.localStore))}function al(e){return il(e).then((e=>e.remoteStore))}function cl(e){return il(e).then((e=>e.syncEngine))}function ll(e){return il(e).then((e=>e.datastore))}async function ul(e){const t=await il(e),n=t.eventManager;return n.onListen=fc.bind(null,t.syncEngine),n.onUnlisten=yc.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=pc.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=vc.bind(null,t.syncEngine),n}function dl(e,t,n={}){const r=new S;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const o=new Yc({next:o=>{t.enqueueAndForget((()=>Qa(e,s)));const a=o.docs.has(n);!a&&o.fromCache?i.reject(new A(E.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&o.fromCache&&r&&"server"===r.source?i.reject(new A(E.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:e=>i.reject(e)}),s=new nc(En(n.path),o,{includeMetadataChanges:!0,ta:!0});return Ya(e,s)}(await ul(e),e.asyncQueue,t,n,r))),r.promise}function hl(e,t,n={}){const r=new S;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const o=new Yc({next:n=>{t.enqueueAndForget((()=>Qa(e,s))),n.fromCache&&"server"===r.source?i.reject(new A(E.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),s=new nc(n,o,{includeMetadataChanges:!0,ta:!0});return Ya(e,s)}(await ul(e),e.asyncQueue,t,n,r))),r.promise}function fl(e,t,n,r){const i=function(e,t){let n;return n="string"==typeof e?Ur().encode(e):e,function(e,t){return new Qc(e,t)}(function(e,t){if(e instanceof Uint8Array)return Kc(e,t);if(e instanceof ArrayBuffer)return Kc(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),t)}(n,sa(t));e.asyncQueue.enqueueAndForget((async()=>{!function(e,t,n){const r=T(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=T(e),r=ci(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(e=>n.$r.getBundleMetadata(e,t.id))).then((e=>!!e&&e.createTime.compareTo(r)>=0))}(e.localStore,r))return await t.close(),n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r)),Promise.resolve(new Set);n._updateProgress(sc(r));const i=new oc(r,e.localStore,t.serializer);let o=await t.Ba();for(;o;){const e=await i.sa(o);e&&n._updateProgress(e),o=await t.Ba()}const s=await i.complete();return await xc(e,s.aa,void 0),await function(e,t){const n=T(e);return n.persistence.runTransaction("Save bundle","readwrite",(e=>n.$r.saveBundleMetadata(e,t)))}(e.localStore,r),n._completeWith(s.progress),Promise.resolve(s._a)}catch(e){return y("SyncEngine",`Loading bundle failed with ${e}`),n._failWith(e),Promise.resolve(new Set)}})(r,t,n).then((e=>{r.sharedClientState.notifyBundleLoaded(e)}))}(await cl(e),i,r)}))}function pl(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const gl=new Map;function ml(e,t,n){if(!n)throw new A(E.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function yl(e,t,n,r){if(!0===t&&!0===r)throw new A(E.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function vl(e){if(!W.isDocumentKey(e))throw new A(E.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function bl(e){if(W.isDocumentKey(e))throw new A(E.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function _l(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":b()}function wl(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new A(E.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=_l(e);throw new A(E.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Tl(e,t){if(t<=0)throw new A(E.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}class El{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new A(E.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new A(E.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}yl("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=pl(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new A(E.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new A(E.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new A(E.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Al{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new El({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new A(E.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new A(E.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new El(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new I;switch(e.type){case"firstParty":return new x(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new A(E.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=gl.get(e);t&&(g("ComponentProvider","Removing Datastore"),gl.delete(e),t.terminate())}(this),Promise.resolve()}}function Sl(e,t,n,r={}){var i;const o=(e=wl(e,Al))._getSettings(),s=`${t}:${n}`;if("firestore.googleapis.com"!==o.host&&o.host!==s&&y("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=u.MOCK_USER;else{t=Object(a.createMockUserToken)(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const o=r.mockUserToken.sub||r.mockUserToken.user_id;if(!o)throw new A(E.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new u(o)}e._authCredentials=new C(new O(t,n))}}class Ol{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ol(this.firestore,e,this._query)}}class Il{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Cl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Il(this.firestore,e,this._key)}}class Cl extends Ol{constructor(e,t,n){super(e,t,En(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Il(this.firestore,null,new W(e))}withConverter(e){return new Cl(this.firestore,e,this._path)}}function kl(e,t,...n){if(e=Object(a.getModularInstance)(e),ml("collection","path",t),e instanceof Al){const r=q.fromString(t,...n);return bl(r),new Cl(e,null,r)}{if(!(e instanceof Il||e instanceof Cl))throw new A(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(q.fromString(t,...n));return bl(r),new Cl(e.firestore,null,r)}}function Pl(e,t){if(e=wl(e,Al),ml("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new A(E.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Ol(e,null,function(e){return new wn(q.emptyPath(),e)}(t))}function xl(e,t,...n){if(e=Object(a.getModularInstance)(e),1===arguments.length&&(t=N.newId()),ml("doc","path",t),e instanceof Al){const r=q.fromString(t,...n);return vl(r),new Il(e,null,new W(r))}{if(!(e instanceof Il||e instanceof Cl))throw new A(E.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(q.fromString(t,...n));return vl(r),new Il(e.firestore,e instanceof Cl?e.converter:null,new W(r))}}function Rl(e,t){return e=Object(a.getModularInstance)(e),t=Object(a.getModularInstance)(t),(e instanceof Il||e instanceof Cl)&&(t instanceof Il||t instanceof Cl)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function Ll(e,t){return e=Object(a.getModularInstance)(e),t=Object(a.getModularInstance)(t),e instanceof Ol&&t instanceof Ol&&e.firestore===t.firestore&&xn(e._query,t._query)&&e.converter===t.converter}class Dl{constructor(){this.nu=Promise.resolve(),this.ru=[],this.iu=!1,this.su=[],this.ou=null,this._u=!1,this.au=!1,this.uu=[],this.jo=new aa(this,"async_queue_retry"),this.cu=()=>{const e=oa();e&&g("AsyncQueue","Visibility state changed to "+e.visibilityState),this.jo.Ko()};const e=oa();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.cu)}get isShuttingDown(){return this.iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.lu(),this.hu(e)}enterRestrictedMode(e){if(!this.iu){this.iu=!0,this.au=e||!1;const t=oa();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.cu)}}enqueue(e){if(this.lu(),this.iu)return new Promise((()=>{}));const t=new S;return this.hu((()=>this.iu&&this.au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.ru.push(e),this.Pu())))}async Pu(){if(0!==this.ru.length){try{await this.ru[0](),this.ru.shift(),this.jo.reset()}catch(e){if(!le(e))throw e;g("AsyncQueue","Operation failed with retryable error: "+e)}this.ru.length>0&&this.jo.qo((()=>this.Pu()))}}hu(e){const t=this.nu.then((()=>(this._u=!0,e().catch((e=>{this.ou=e,this._u=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw m("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this._u=!1,e))))));return this.nu=t,t}enqueueAfterDelay(e,t,n){this.lu(),this.uu.indexOf(e)>-1&&(t=0);const r=qa.createAndSchedule(this,e,t,n,(e=>this.Iu(e)));return this.su.push(r),r}lu(){this.ou&&b()}verifyOperationInProgress(){}async Tu(){let e;do{e=this.nu,await e}while(e!==this.nu)}Eu(e){for(const t of this.su)if(t.timerId===e)return!0;return!1}du(e){return this.Tu().then((()=>{this.su.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.su)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tu()}))}Au(e){this.uu.push(e)}Iu(e){const t=this.su.indexOf(e);this.su.splice(t,1)}}function Nl(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of t)if(e in n&&"function"==typeof n[e])return!0;return!1}(e,["next","error","complete"])}class jl{constructor(){this._progressObserver={},this._taskCompletionResolver=new S,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const Ml=-1;class Fl extends Al{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Dl,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Bl(this),this._firestoreClient.terminate()}}function Ul(e){return e._firestoreClient||Bl(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Bl(e){var t,n,r;const i=e._freezeSettings(),o=function(e,t,n,r){return new mt(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,pl(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._firestoreClient=new Zc(e._authCredentials,e._appCheckCredentials,e._queue,o),(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function Gl(e,t){Ql(e=wl(e,Fl));const n=Ul(e);if(n._uninitializedComponentsProvider)throw new A(E.FAILED_PRECONDITION,"SDK cache is already specified.");y("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=e._freezeSettings(),i=new Vc;return Hl(n,i,new Wc(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}function ql(e){Ql(e=wl(e,Fl));const t=Ul(e);if(t._uninitializedComponentsProvider)throw new A(E.FAILED_PRECONDITION,"SDK cache is already specified.");y("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings(),r=new Vc;return Hl(t,r,new zc(r,n.cacheSizeBytes))}function Hl(e,t,n){const r=new S;return e.asyncQueue.enqueue((async()=>{try{await el(e,n),await tl(e,t),r.resolve()}catch(e){const t=e;if(!nl(t))throw t;y("Error enabling indexeddb cache. Falling back to memory cache: "+t),r.reject(t)}})).then((()=>r.promise))}function $l(e){if(e._initialized&&!e._terminated)throw new A(E.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new S;return e._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await async function(e){if(!se.D())return Promise.resolve();const t=e+"main";await se.delete(t)}(Es(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}})),t.promise}function Wl(e){return function(e){const t=new S;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t){const n=T(e);Ta(n.remoteStore)||g("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=T(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e)))}(n.localStore);if(-1===e)return void t.resolve();const r=n.Ma.get(e)||[];r.push(t),n.Ma.set(e,r)}catch(e){const n=Ha(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}(await cl(e),t))),t.promise}(Ul(e=wl(e,Fl)))}function zl(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await ol(e),n=await al(e);return t.setNetworkEnabled(!0),function(e){const t=T(e);return t.v_.delete(0),pa(t)}(n)}))}(Ul(e=wl(e,Fl)))}function Vl(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await ol(e),n=await al(e);return t.setNetworkEnabled(!1),async function(e){const t=T(e);t.v_.add(0),await ga(t),t.x_.set("Offline")}(n)}))}(Ul(e=wl(e,Fl)))}function Kl(e,t){const n=Ul(e=wl(e,Fl)),r=new jl;return fl(n,e._databaseId,t,r),r}function Yl(e,t){return function(e,t){return e.asyncQueue.enqueue((async()=>function(e,t){const n=T(e);return n.persistence.runTransaction("Get named query","readonly",(e=>n.$r.getNamedQuery(e,t)))}(await sl(e),t)))}(Ul(e=wl(e,Fl)),t).then((t=>t?new Ol(e,null,t.query):null))}function Ql(e){if(e._initialized||e._terminated)throw new A(E.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Xl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Xl(ct.fromBase64String(e))}catch(e){throw new A(E.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Xl(ct.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Jl{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new A(E.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Zl{constructor(e){this._methodName=e}}class eu{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new A(E.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new A(E.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return j(this._lat,e._lat)||j(this._long,e._long)}}const tu=/^__.*__$/;class nu{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Ar(e,this.data,this.fieldMask,t,this.fieldTransforms):new Er(e,this.data,t,this.fieldTransforms)}}class ru{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ar(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function iu(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw b()}}class ou{constructor(e,t,n,r,i,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Ru(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Vu(){return this.settings.Vu}mu(e){return new ou(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}fu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.mu({path:n,gu:!1});return r.pu(e),r}yu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.mu({path:n,gu:!1});return r.Ru(),r}wu(e){return this.mu({path:void 0,gu:!0})}Su(e){return Su(e,this.settings.methodName,this.settings.bu||!1,this.path,this.settings.Du)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Ru(){if(this.path)for(let e=0;e<this.path.length;e++)this.pu(this.path.get(e))}pu(e){if(0===e.length)throw this.Su("Document fields must not be empty");if(iu(this.Vu)&&tu.test(e))throw this.Su('Document fields cannot begin and end with "__"')}}class su{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||sa(e)}Cu(e,t,n,r=!1){return new ou({Vu:e,methodName:t,Du:n,path:$.emptyPath(),gu:!1,bu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function au(e){const t=e._freezeSettings(),n=sa(e._databaseId);return new su(e._databaseId,!!t.ignoreUndefinedProperties,n)}function cu(e,t,n,r,i,o={}){const s=e.Cu(o.merge||o.mergeFields?2:0,t,n,i);wu("Data must be an object, but it was:",s,r);const a=bu(r,s);let c,l;if(o.merge)c=new ot(s.fieldMask),l=s.fieldTransforms;else if(o.mergeFields){const e=[];for(const r of o.mergeFields){const i=Tu(t,r,n);if(!s.contains(i))throw new A(E.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Ou(e,i)||e.push(i)}c=new ot(e),l=s.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,l=s.fieldTransforms;return new nu(new Ut(a),c,l)}class lu extends Zl{_toFieldTransform(e){if(2!==e.Vu)throw 1===e.Vu?e.Su(`${this._methodName}() can only appear at the top level of your update data`):e.Su(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof lu}}function uu(e,t,n){return new ou({Vu:3,Du:t.settings.Du,methodName:e._methodName,gu:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class du extends Zl{_toFieldTransform(e){return new fr(e.path,new or)}isEqual(e){return e instanceof du}}class hu extends Zl{constructor(e,t){super(e),this.vu=t}_toFieldTransform(e){const t=uu(this,e,!0),n=this.vu.map((e=>vu(e,t))),r=new sr(n);return new fr(e.path,r)}isEqual(e){return e instanceof hu&&Object(a.deepEqual)(this.vu,e.vu)}}class fu extends Zl{constructor(e,t){super(e),this.vu=t}_toFieldTransform(e){const t=uu(this,e,!0),n=this.vu.map((e=>vu(e,t))),r=new cr(n);return new fr(e.path,r)}isEqual(e){return e instanceof fu&&Object(a.deepEqual)(this.vu,e.vu)}}class pu extends Zl{constructor(e,t){super(e),this.Fu=t}_toFieldTransform(e){const t=new ur(e.serializer,er(e.serializer,this.Fu));return new fr(e.path,t)}isEqual(e){return e instanceof pu&&this.Fu===e.Fu}}function gu(e,t,n,r){const i=e.Cu(1,t,n);wu("Data must be an object, but it was:",i,r);const o=[],s=Ut.empty();Xe(r,((e,r)=>{const c=Au(t,e,n);r=Object(a.getModularInstance)(r);const l=i.yu(c);if(r instanceof lu)o.push(c);else{const e=vu(r,l);null!=e&&(o.push(c),s.set(c,e))}}));const c=new ot(o);return new ru(s,c,i.fieldTransforms)}function mu(e,t,n,r,i,o){const s=e.Cu(1,t,n),c=[Tu(t,r,n)],l=[i];if(o.length%2!=0)throw new A(E.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<o.length;e+=2)c.push(Tu(t,o[e])),l.push(o[e+1]);const u=[],d=Ut.empty();for(let e=c.length-1;e>=0;--e)if(!Ou(u,c[e])){const t=c[e];let n=l[e];n=Object(a.getModularInstance)(n);const r=s.yu(t);if(n instanceof lu)u.push(t);else{const e=vu(n,r);null!=e&&(u.push(t),d.set(t,e))}}const h=new ot(u);return new ru(d,h,s.fieldTransforms)}function yu(e,t,n,r=!1){return vu(n,e.Cu(r?4:3,t))}function vu(e,t){if(_u(e=Object(a.getModularInstance)(e)))return wu("Unsupported field value:",t,e),bu(e,t);if(e instanceof Zl)return function(e,t){if(!iu(t.Vu))throw t.Su(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Su(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.gu&&4!==t.Vu)throw t.Su("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=vu(i,t.wu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Object(a.getModularInstance)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return er(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=U.fromDate(e);return{timestampValue:oi(t.serializer,n)}}if(e instanceof U){const n=new U(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:oi(t.serializer,n)}}if(e instanceof eu)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Xl)return{bytesValue:si(t.serializer,e._byteString)};if(e instanceof Il){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Su(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:li(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Su(`Unsupported field value: ${_l(e)}`)}(e,t)}function bu(e,t){const n={};return Je(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Xe(e,((e,r)=>{const i=vu(r,t.fu(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function _u(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof U||e instanceof eu||e instanceof Xl||e instanceof Il||e instanceof Zl)}function wu(e,t,n){if(!_u(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=_l(n);throw"an object"===r?t.Su(e+" a custom object"):t.Su(e+" "+r)}}function Tu(e,t,n){if((t=Object(a.getModularInstance)(t))instanceof Jl)return t._internalPath;if("string"==typeof t)return Au(e,t);throw Su("Field path arguments must be of type string or ",e,!1,void 0,n)}const Eu=new RegExp("[~\\*/\\[\\]]");function Au(e,t,n){if(t.search(Eu)>=0)throw Su(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Jl(...t.split("."))._internalPath}catch(r){throw Su(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Su(e,t,n,r,i){const o=r&&!r.isEmpty(),s=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${r}`),s&&(c+=` in document ${i}`),c+=")"),new A(E.INVALID_ARGUMENT,a+e+c)}function Ou(e,t){return e.some((e=>e.isEqual(t)))}class Iu{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Il(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Cu(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ku("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Cu extends Iu{data(){return super.data()}}function ku(e,t){return"string"==typeof t?Au(e,t):t instanceof Jl?t._internalPath:t._delegate._internalPath}function Pu(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new A(E.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class xu{}class Ru extends xu{}function Lu(e,t,...n){let r=[];t instanceof xu&&r.push(t),r=r.concat(n),function(e){const t=e.filter((e=>e instanceof ju)).length,n=e.filter((e=>e instanceof Du)).length;if(t>1||t>0&&n>0)throw new A(E.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const t of r)e=t._apply(e);return e}class Du extends Ru{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Du(e,t,n)}_apply(e){const t=this._parse(e);return Xu(e._query,t),new Ol(e.firestore,e.converter,kn(e._query,t))}_parse(e){const t=au(e.firestore),n=function(e,t,n,r,i,o,s){let a;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new A(E.INVALID_ARGUMENT,`Invalid Query. You can't perform '${o}' queries on documentId().`);if("in"===o||"not-in"===o){Qu(s,o);const t=[];for(const n of s)t.push(Yu(r,e,n));a={arrayValue:{values:t}}}else a=Yu(r,e,s)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Qu(s,o),a=yu(n,t,s,"in"===o||"not-in"===o);return Kt.create(i,o,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function Nu(e,t,n){const r=t,i=ku("where",e);return Du._create(i,r,n)}class ju extends xu{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new ju(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:Yt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const e of r)Xu(n,e),n=kn(n,e)}(e._query,t),new Ol(e.firestore,e.converter,kn(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Mu extends Ru{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Mu(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new A(E.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new A(E.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Wt(t,n)}(e._query,this._field,this._direction);return new Ol(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new wn(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function Fu(e,t="asc"){const n=t,r=ku("orderBy",e);return Mu._create(r,n)}class Uu extends Ru{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Uu(e,t,n)}_apply(e){return new Ol(e.firestore,e.converter,Pn(e._query,this._limit,this._limitType))}}function Bu(e){return Tl("limit",e),Uu._create("limit",e,"F")}function Gu(e){return Tl("limitToLast",e),Uu._create("limitToLast",e,"L")}class qu extends Ru{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new qu(e,t,n)}_apply(e){const t=Ku(e,this.type,this._docOrFields,this._inclusive);return new Ol(e.firestore,e.converter,function(e,t){return new wn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}function Hu(...e){return qu._create("startAt",e,!0)}function $u(...e){return qu._create("startAfter",e,!1)}class Wu extends Ru{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Wu(e,t,n)}_apply(e){const t=Ku(e,this.type,this._docOrFields,this._inclusive);return new Ol(e.firestore,e.converter,function(e,t){return new wn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function zu(...e){return Wu._create("endBefore",e,!1)}function Vu(...e){return Wu._create("endAt",e,!0)}function Ku(e,t,n,r){if(n[0]=Object(a.getModularInstance)(n[0]),n[0]instanceof Iu)return function(e,t,n,r,i){if(!r)throw new A(E.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const o=[];for(const n of On(e))if(n.field.isKeyField())o.push(It(t,r.key));else{const e=r.data.field(n.field);if(ft(e))throw new A(E.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=n.field.canonicalString();throw new A(E.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}o.push(e)}return new qt(o,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=au(e.firestore);return function(e,t,n,r,i,o){const s=e.explicitOrderBy;if(i.length>s.length)throw new A(E.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let o=0;o<i.length;o++){const c=i[o];if(s[o].field.isKeyField()){if("string"!=typeof c)throw new A(E.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof c}`);if(!Sn(e)&&-1!==c.indexOf("/"))throw new A(E.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${r}() must be a plain document ID, but '${c}' contains a slash.`);const n=e.path.child(q.fromString(c));if(!W.isDocumentKey(n))throw new A(E.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new W(n);a.push(It(t,i))}else{const e=yu(n,r,c);a.push(e)}}return new qt(a,o)}(e._query,e.firestore._databaseId,i,t,n,r)}}function Yu(e,t,n){if("string"==typeof(n=Object(a.getModularInstance)(n))){if(""===n)throw new A(E.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Sn(t)&&-1!==n.indexOf("/"))throw new A(E.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(q.fromString(n));if(!W.isDocumentKey(r))throw new A(E.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return It(e,new W(r))}if(n instanceof Il)return It(e,n._key);throw new A(E.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${_l(n)}.`)}function Qu(e,t){if(!Array.isArray(e)||0===e.length)throw new A(E.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Xu(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new A(E.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new A(E.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class Ju{convertValue(e,t="none"){switch(_t(e)){case 0:return null;case 1:return e.booleanValue;case 2:return dt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ht(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw b()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Xe(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new eu(dt(e.latitude),dt(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=pt(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(gt(e));default:return null}}convertTimestamp(e){const t=ut(e);return new U(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=q.fromString(e);_(Li(n));const r=new yt(n.get(1),n.get(3)),i=new W(n.popFirst(5));return r.isEqual(t)||m(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function Zu(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class ed extends Ju{constructor(e){super(),this.firestore=e}convertBytes(e){return new Xl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Il(this.firestore,null,t)}}class td{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class nd extends Iu{constructor(e,t,n,r,i,o){super(e,t,n,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new rd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(ku("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class rd extends nd{data(e={}){return super.data(e)}}class id{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new td(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new rd(this._firestore,this._userDataWriter,n.key,n,new td(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new A(E.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new rd(e._firestore,e._userDataWriter,n.doc.key,n.doc,new td(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new rd(e._firestore,e._userDataWriter,t.doc.key,t.doc,new td(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,o=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),o=n.indexOf(t.doc.key)),{type:od(t.type),doc:r,oldIndex:i,newIndex:o}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function od(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return b()}}function sd(e,t){return e instanceof nd&&t instanceof nd?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof id&&t instanceof id&&e._firestore===t._firestore&&Ll(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}function ad(e){e=wl(e,Il);const t=wl(e.firestore,Fl);return dl(Ul(t),e._key).then((n=>wd(t,e,n)))}class cd extends Ju{constructor(e){super(),this.firestore=e}convertBytes(e){return new Xl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Il(this.firestore,null,t)}}function ld(e){e=wl(e,Il);const t=wl(e.firestore,Fl),n=Ul(t),r=new cd(t);return function(e,t){const n=new S;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await function(e,t){const n=T(e);return n.persistence.runTransaction("read document","readonly",(e=>n.localDocuments.getDocument(e,t)))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new A(E.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=Ha(e,`Failed to get document '${t} from cache`);n.reject(r)}}(await sl(e),t,n))),n.promise}(n,e._key).then((n=>new nd(t,r,e._key,n,new td(null!==n&&n.hasLocalMutations,!0),e.converter)))}function ud(e){e=wl(e,Il);const t=wl(e.firestore,Fl);return dl(Ul(t),e._key,{source:"server"}).then((n=>wd(t,e,n)))}function dd(e){e=wl(e,Ol);const t=wl(e.firestore,Fl),n=Ul(t),r=new cd(t);return Pu(e._query),hl(n,e._query).then((n=>new id(t,r,e,n)))}function hd(e){e=wl(e,Ol);const t=wl(e.firestore,Fl),n=Ul(t),r=new cd(t);return function(e,t){const n=new S;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await Ns(e,t,!0),i=new lc(t,r.hs),o=i.Ta(r.documents),s=i.applyChanges(o,!1);n.resolve(s.snapshot)}catch(e){const r=Ha(e,`Failed to execute query '${t} against cache`);n.reject(r)}}(await sl(e),t,n))),n.promise}(n,e._query).then((n=>new id(t,r,e,n)))}function fd(e){e=wl(e,Ol);const t=wl(e.firestore,Fl),n=Ul(t),r=new cd(t);return hl(n,e._query,{source:"server"}).then((n=>new id(t,r,e,n)))}function pd(e,t,n){e=wl(e,Il);const r=wl(e.firestore,Fl),i=Zu(e.converter,t,n);return _d(r,[cu(au(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,gr.none())])}function gd(e,t,n,...r){e=wl(e,Il);const i=wl(e.firestore,Fl),o=au(i);let s;return s="string"==typeof(t=Object(a.getModularInstance)(t))||t instanceof Jl?mu(o,"updateDoc",e._key,t,n,r):gu(o,"updateDoc",e._key,t),_d(i,[s.toMutation(e._key,gr.exists(!0))])}function md(e){return _d(wl(e.firestore,Fl),[new Cr(e._key,gr.none())])}function yd(e,t){const n=wl(e.firestore,Fl),r=xl(e),i=Zu(e.converter,t);return _d(n,[cu(au(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,gr.exists(!1))]).then((()=>r))}function vd(e,...t){var n,r,i;e=Object(a.getModularInstance)(e);let o={includeMetadataChanges:!1,source:"default"},s=0;"object"!=typeof t[s]||Nl(t[s])||(o=t[s],s++);const c={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Nl(t[s])){const e=t[s];t[s]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[s+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[s+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let l,u,d;if(e instanceof Il)u=wl(e.firestore,Fl),d=En(e._key.path),l={next:n=>{t[s]&&t[s](wd(u,e,n))},error:t[s+1],complete:t[s+2]};else{const n=wl(e,Ol);u=wl(n.firestore,Fl),d=n._query;const r=new cd(u);l={next:e=>{t[s]&&t[s](new id(u,r,n,e))},error:t[s+1],complete:t[s+2]},Pu(e._query)}return function(e,t,n,r){const i=new Yc(r),o=new nc(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>Ya(await ul(e),o))),()=>{i.Qa(),e.asyncQueue.enqueueAndForget((async()=>Qa(await ul(e),o)))}}(Ul(u),d,c,l)}function bd(e,t){return function(e,t){const n=new Yc(t);return e.asyncQueue.enqueueAndForget((async()=>function(e,t){T(e).W_.add(t),t.next()}(await ul(e),n))),()=>{n.Qa(),e.asyncQueue.enqueueAndForget((async()=>function(e,t){T(e).W_.delete(t)}(await ul(e),n)))}}(Ul(e=wl(e,Fl)),Nl(t)?t:{next:t})}function _d(e,t){return function(e,t){const n=new S;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=Hc(e);try{const e=await function(e,t){const n=T(e),r=U.now(),i=t.reduce(((e,t)=>e.add(t.key)),Yn());let o,s;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=Bn(),c=Yn();return n.os.getEntries(e,i).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((i=>{o=i;const s=[];for(const e of t){const t=wr(e,o.get(e.key).overlayedDocument);null!=t&&s.push(new Ar(e.key,t,Bt(t.value.mapValue),gr.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,s,t)})).next((t=>{s=t;const r=t.applyToLocalDocumentSet(o,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:s.batchId,changes:Hn(o)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Fa[e.currentUser.toKey()];r||(r=new Ze(j)),r=r.insert(t,n),e.Fa[e.currentUser.toKey()]=r}(r,e.batchId,n),await xc(r,e.changes),await ka(r.remoteStore)}catch(e){const t=Ha(e,"Failed to persist write");n.reject(t)}}(await cl(e),t,n))),n.promise}(Ul(e),t)}function wd(e,t,n){const r=n.docs.get(t._key),i=new cd(e);return new nd(e,i,t._key,r,new td(n.hasPendingWrites,n.fromCache),t.converter)}const Td={maxAttempts:5};class Ed{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=au(e)}set(e,t,n){this._verifyNotCommitted();const r=Ad(e,this._firestore),i=Zu(r.converter,t,n),o=cu(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,gr.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=Ad(e,this._firestore);let o;return o="string"==typeof(t=Object(a.getModularInstance)(t))||t instanceof Jl?mu(this._dataReader,"WriteBatch.update",i._key,t,n,r):gu(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,gr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Ad(e,this._firestore);return this._mutations=this._mutations.concat(new Cr(t._key,gr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new A(E.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Ad(e,t){if((e=Object(a.getModularInstance)(e)).firestore!==t)throw new A(E.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class Sd extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=au(e)}get(e){const t=Ad(e,this._firestore),n=new ed(this._firestore);return this._transaction.lookup([t._key]).then((e=>{if(!e||1!==e.length)return b();const r=e[0];if(r.isFoundDocument())return new Iu(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new Iu(this._firestore,n,t._key,null,t.converter);throw b()}))}set(e,t,n){const r=Ad(e,this._firestore),i=Zu(r.converter,t,n),o=cu(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this}update(e,t,n,...r){const i=Ad(e,this._firestore);let o;return o="string"==typeof(t=Object(a.getModularInstance)(t))||t instanceof Jl?mu(this._dataReader,"Transaction.update",i._key,t,n,r):gu(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,o),this}delete(e){const t=Ad(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Ad(e,this._firestore),n=new cd(this._firestore);return super.get(e).then((e=>new nd(this._firestore,n,t._key,e._document,new td(!1,!1),t.converter)))}}function Od(e,t,n){e=wl(e,Fl);const r=Object.assign(Object.assign({},Td),n);return function(e){if(e.maxAttempts<1)throw new A(E.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){const r=new S;return e.asyncQueue.enqueueAndForget((async()=>{const i=await ll(e);new Jc(e.asyncQueue,i,n,t,r).Ya()})),r.promise}(Ul(e),(n=>t(new Sd(e,n))),r)}function Id(){return new lu("deleteField")}function Cd(){return new du("serverTimestamp")}function kd(...e){return new hu("arrayUnion",e)}function Pd(...e){return new fu("arrayRemove",e)}function xd(e){return new pu("increment",e)}new WeakMap;!function(e,t=!0){!function(e){d=e}(i.SDK_VERSION),Object(i._registerComponent)(new o.Component("firestore",((e,{instanceIdentifier:n,options:r})=>{const i=e.getProvider("app").getImmediate(),o=new Fl(new k(e.getProvider("auth-internal")),new L(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new A(E.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new yt(e.options.projectId,t)}(i,n),i);return r=Object.assign({useFetchStreams:t},r),o._setSettings(r),o}),"PUBLIC").setMultipleInstances(!0)),Object(i.registerVersion)(l,"4.6.0",e),Object(i.registerVersion)(l,"4.6.0","esm2017")}()}).call(this,n(131),n(287).Buffer)},,function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return h})),n.d(t,"f",(function(){return f}));var r=n(2),i=n(31),o=n(65),s=n(29),a=n(19);function c(t,n){var o;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=`${(null===(o=e.env.REACT_APP_FIREBASE_PROJECT_ID)||void 0===o?void 0:o.includes("staging"))||!1?s.b.staging:s.b.production}/stripe-subscriptions`,a=yield fetch(r,{method:"POST",headers:{},body:JSON.stringify({email:t})}),c=yield a.json();yield n.storage.local.set({[i.a]:{pU:c.status}});return{AIpowerup:c.status.AIpowerup||c.status.Unlimited,AIpowerupOwnKey:c.status.AIpowerupOwnKey||c.status.Unlimited,bookmarksPowerUp:c.status.bookmarksPowerUp||c.status.Unlimited,lifetime:c.status.lifetime}}))}function l(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let n;if(t)n=t,yield e.storage.local.set({[i.e]:t});else{if(n=(yield e.storage.local.get([i.e]))[i.e],!n)return console.error("Install timestamp not found!"),-1}const r=(new Date).getTime(),o=24*i.d*60*60*1e3,s=r-n;if(s<o){const e=o-s;return Math.ceil(e/864e5)}return-1}))}function u(e,t,n,i,s){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let r;if(null!=i&&(r=null!=(yield n.findPageByUrl(Object(a.c)(i)))),r)return!0;if(yield p("bookmarksPowerUp",e))return!0;if(t)try{yield Object(o.d)(t,{type:"pagesLimit"})}catch(e){}return!1}))}function d(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if("gpt-4o"===i&&!n)return!1;if(yield p("AIpowerup",e,i,n))return!0;if(t)try{yield Object(o.d)(t,{type:"aiLimit"})}catch(e){}return!1}))}function h(t){var n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=t.os,i=t.arch,o=(null===(n=e.env.REACT_APP_FIREBASE_PROJECT_ID)||void 0===n?void 0:n.includes("staging"))||!1?s.b.staging:s.b.production,a=yield fetch(o+"/download_memex_desktop",{method:"POST",body:JSON.stringify({OS:r,arch:i}),headers:{"Content-Type":"application/json"}});return(yield a.json()).downloadUrl}))}function f(e,t){var n,o;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=(yield e.storage.local.get(i.f))[i.f];let s=[],a=null;if(t)s=null!==(n=null==r?void 0:r.filter((e=>e!==t)))&&void 0!==n?n:[];else{const t=yield e.tabs.query({active:!0,currentWindow:!0});if(a=null===(o=t[0])||void 0===o?void 0:o.id,void 0===r)s=[a];else{if(r.includes(a))return!0;s=[...r,a]}}yield e.storage.local.set({[i.f]:s})}))}function p(e,t,n,o){var s,a,c,u,d,h,f,p,g;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield t.storage.local.get(i.a);let r=null!==(s=n[i.a])&&void 0!==s?s:i.b;const m=null!=r?r:i.b;if((null===(a=m.pU)||void 0===a?void 0:a.Unlimited)||(null===(c=m.pU)||void 0===c?void 0:c.lifetime))return!0;if("bookmarksPowerUp"===e){if(null!==(d=null===(u=m.pU)||void 0===u?void 0:u.bookmarksPowerUp)&&void 0!==d&&d)return!0}if("AIpowerup"===e){const e=null!==(f=null===(h=m.pU)||void 0===h?void 0:h.AIpowerupOwnKey)&&void 0!==f&&f,t=null!==(g=null===(p=m.pU)||void 0===p?void 0:p.AIpowerup)&&void 0!==g&&g;if(!o&&e&&!t)return!1;if(o&&(e||t))return!0;if(t)return!0}return!!(-1!==(yield l(t)))}))}}).call(this,n(131))},,,function(e,t,n){"use strict";var r,i,o,s,a,c,l,u,d,h,f;n.d(t,"d",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"f",(function(){return h})),n.d(t,"e",(function(){return f})),function(e){e[e.Delete=0]="Delete",e[e.Create=1]="Create"}(r||(r={})),function(e){e[e.UploadError=0]="UploadError",e[e.DownloadError=1]="DownloadError"}(i||(i={})),function(e){e.Mobile="mobile",e.DesktopBrowser="desktop-browser"}(o||(o={})),function(e){e.Android="android",e.IOS="ios",e.Linux="linux",e.Windows="windows",e.MacOS="macos"}(s||(s={})),function(e){e.Firefox="firefox",e.Chrome="chrome",e.Edge="edge",e.Brave="brave",e.Vivaldi="vivaldi"}(a||(a={})),function(e){e.Extension="extension",e.MobileApp="mobile-app",e.WebUI="web-ui"}(c||(c={})),function(e){e.Create="create",e.Modify="modify",e.Delete="delete",e.ListTreeMove="listTreeMove",e.ListTreeDelete="listTreeDelete"}(l||(l={})),function(e){e.Local="local",e.Remote="remote",e.MemexCloud="memex-cloud"}(u||(u={})),function(e){e.HTML="html",e.PDF="pdf",e.EPUB="epub",e.TXT="txt",e.SpotifyLink="spotify-link",e.HtmlSnapshot="html-snapshot"}(d||(d={})),function(e){e.NormalizedUrlV1="normalized-url-v1",e.FilesystemPathV1="filesystem-path-v1",e.UploadStorage="upload-storage-v1"}(h||(h={})),function(e){e.PdfV1="x-pdf-v1"}(f||(f={}))},,function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return l}));const r="extension_install_time",i="/options.html",o=`${i}#/settings`,s=`${i}#/overview`,a=`${i}#/account`,c="tag_suggestions",l="@UNDO_HISTORY"},function(e,t,n){"use strict";n.r(t),n.d(t,"SDK_VERSION",(function(){return J})),n.d(t,"_DEFAULT_ENTRY_NAME",(function(){return N})),n.d(t,"_addComponent",(function(){return B})),n.d(t,"_addOrOverwriteComponent",(function(){return G})),n.d(t,"_apps",(function(){return M})),n.d(t,"_clearComponents",(function(){return V})),n.d(t,"_components",(function(){return U})),n.d(t,"_getProvider",(function(){return H})),n.d(t,"_isFirebaseApp",(function(){return W})),n.d(t,"_isFirebaseServerApp",(function(){return z})),n.d(t,"_registerComponent",(function(){return q})),n.d(t,"_removeServiceInstance",(function(){return $})),n.d(t,"_serverApps",(function(){return F})),n.d(t,"deleteApp",(function(){return re})),n.d(t,"getApp",(function(){return te})),n.d(t,"getApps",(function(){return ne})),n.d(t,"initializeApp",(function(){return Z})),n.d(t,"initializeServerApp",(function(){return ee})),n.d(t,"onLog",(function(){return oe})),n.d(t,"registerVersion",(function(){return ie})),n.d(t,"setLogLevel",(function(){return se}));var r=n(201),i=n(322),o=n(30);n.d(t,"FirebaseError",(function(){return o.FirebaseError}));var s=n(697);class a{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const c="@firebase/app",l="0.10.1",u=new i.Logger("@firebase/app"),d="@firebase/app-compat",h="@firebase/analytics-compat",f="@firebase/analytics",p="@firebase/app-check-compat",g="@firebase/app-check",m="@firebase/auth",y="@firebase/auth-compat",v="@firebase/database",b="@firebase/database-compat",_="@firebase/functions",w="@firebase/functions-compat",T="@firebase/installations",E="@firebase/installations-compat",A="@firebase/messaging",S="@firebase/messaging-compat",O="@firebase/performance",I="@firebase/performance-compat",C="@firebase/remote-config",k="@firebase/remote-config-compat",P="@firebase/storage",x="@firebase/storage-compat",R="@firebase/firestore",L="@firebase/firestore-compat",D="firebase",N="[DEFAULT]",j={[c]:"fire-core",[d]:"fire-core-compat",[f]:"fire-analytics",[h]:"fire-analytics-compat",[g]:"fire-app-check",[p]:"fire-app-check-compat",[m]:"fire-auth",[y]:"fire-auth-compat",[v]:"fire-rtdb",[b]:"fire-rtdb-compat",[_]:"fire-fn",[w]:"fire-fn-compat",[T]:"fire-iid",[E]:"fire-iid-compat",[A]:"fire-fcm",[S]:"fire-fcm-compat",[O]:"fire-perf",[I]:"fire-perf-compat",[C]:"fire-rc",[k]:"fire-rc-compat",[P]:"fire-gcs",[x]:"fire-gcs-compat",[R]:"fire-fst",[L]:"fire-fst-compat","fire-js":"fire-js",[D]:"fire-js-all"},M=new Map,F=new Map,U=new Map;function B(e,t){try{e.container.addComponent(t)}catch(n){u.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function G(e,t){e.container.addOrOverwriteComponent(t)}function q(e){const t=e.name;if(U.has(t))return u.debug(`There were multiple attempts to register component ${t}.`),!1;U.set(t,e);for(const t of M.values())B(t,e);for(const t of F.values())B(t,e);return!0}function H(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function $(e,t,n=N){H(e,t).clearInstance(n)}function W(e){return void 0!==e.options}function z(e){return void 0!==e.settings}function V(){U.clear()}const K={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Y=new o.ErrorFactory("app","Firebase",K);class Q{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new r.Component("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Y.create("app-deleted",{appName:this._name})}}class X extends Q{constructor(e,t,n,r){const i=void 0!==t.automaticDataCollectionEnabled&&t.automaticDataCollectionEnabled,o={name:n,automaticDataCollectionEnabled:i};if(void 0!==e.apiKey)super(e,o,r);else{super(e.options,o,r)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:i},t),this._finalizationRegistry=new FinalizationRegistry((()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,ie(c,l,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,void 0!==e&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){re(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Y.create("server-app-deleted")}}const J="10.11.0";function Z(e,t={}){let n=e;if("object"!=typeof t){t={name:t}}const i=Object.assign({name:N,automaticDataCollectionEnabled:!1},t),s=i.name;if("string"!=typeof s||!s)throw Y.create("bad-app-name",{appName:String(s)});if(n||(n=Object(o.getDefaultAppConfig)()),!n)throw Y.create("no-options");const a=M.get(s);if(a){if(Object(o.deepEqual)(n,a.options)&&Object(o.deepEqual)(i,a.config))return a;throw Y.create("duplicate-app",{appName:s})}const c=new r.ComponentContainer(s);for(const e of U.values())c.addComponent(e);const l=new Q(n,i,c);return M.set(s,l),l}function ee(e,t){if(Object(o.isBrowser)())throw Y.create("invalid-server-app-environment");let n;void 0===t.automaticDataCollectionEnabled&&(t.automaticDataCollectionEnabled=!1),n=W(e)?e.options:e;const i=Object.assign(Object.assign({},t),n);void 0!==i.releaseOnDeref&&delete i.releaseOnDeref;if(void 0!==t.releaseOnDeref&&"undefined"==typeof FinalizationRegistry)throw Y.create("finalization-registry-not-supported",{});const s=""+(a=JSON.stringify(i),[...a].reduce(((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0),0));var a;const c=F.get(s);if(c)return c.incRefCount(t.releaseOnDeref),c;const l=new r.ComponentContainer(s);for(const e of U.values())l.addComponent(e);const u=new X(n,t,s,l);return F.set(s,u),u}function te(e=N){const t=M.get(e);if(!t&&e===N&&Object(o.getDefaultAppConfig)())return Z();if(!t)throw Y.create("no-app",{appName:e});return t}function ne(){return Array.from(M.values())}async function re(e){let t=!1;const n=e.name;if(M.has(n))t=!0,M.delete(n);else if(F.has(n)){e.decRefCount()<=0&&(F.delete(n),t=!0)}t&&(await Promise.all(e.container.getProviders().map((e=>e.delete()))),e.isDeleted=!0)}function ie(e,t,n){var i;let o=null!==(i=j[e])&&void 0!==i?i:e;n&&(o+=`-${n}`);const s=o.match(/\s|\//),a=t.match(/\s|\//);if(s||a){const e=[`Unable to register library "${o}" with version "${t}":`];return s&&e.push(`library name "${o}" contains illegal characters (whitespace or "/")`),s&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void u.warn(e.join(" "))}q(new r.Component(`${o}-version`,(()=>({library:o,version:t})),"VERSION"))}function oe(e,t){if(null!==e&&"function"!=typeof e)throw Y.create("invalid-log-argument");Object(i.setUserLogHandler)(e,t)}function se(e){Object(i.setLogLevel)(e)}const ae="firebase-heartbeat-store";let ce=null;function le(){return ce||(ce=Object(s.openDB)("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(ae)}catch(e){console.warn(e)}}}).catch((e=>{throw Y.create("idb-open",{originalErrorMessage:e.message})}))),ce}async function ue(e,t){try{const n=(await le()).transaction(ae,"readwrite"),r=n.objectStore(ae);await r.put(t,de(e)),await n.done}catch(e){if(e instanceof o.FirebaseError)u.warn(e.message);else{const t=Y.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});u.warn(t.message)}}}function de(e){return`${e.name}!${e.options.appId}`}class he{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new pe(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=fe();if((null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=fe(),{heartbeatsToSend:n,unsentEntries:r}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),ge(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),ge(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=Object(o.base64urlEncodeWithoutPadding)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function fe(){return(new Date).toISOString().substring(0,10)}class pe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!Object(o.isIndexedDBAvailable)()&&Object(o.validateIndexedDBOpenable)().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await le()).transaction(ae),n=await t.objectStore(ae).get(de(e));return await t.done,n}catch(e){if(e instanceof o.FirebaseError)u.warn(e.message);else{const t=Y.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});u.warn(t.message)}}}(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ue(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ue(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function ge(e){return Object(o.base64urlEncodeWithoutPadding)(JSON.stringify({version:2,heartbeats:e})).length}var me;me="",q(new r.Component("platform-logger",(e=>new a(e)),"PRIVATE")),q(new r.Component("heartbeat",(e=>new he(e)),"PRIVATE")),ie(c,l,me),ie(c,l,"esm2017"),ie("fire-js","")},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return a}));var r=n(19),i=n(11);const o="@ContentSharing-last-shared-annotation-timestamp",s=e=>{const{pageUrl:t,now:n}=e;return`${Object(r.c)(t)}/#${n()}`};function a(e){return(null==e?void 0:e.shouldShare)?e.isBulkShareProtected?i.a.SHARED_PROTECTED:i.a.SHARED:(null==e?void 0:e.isBulkShareProtected)?i.a.PROTECTED:i.a.PRIVATE}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s}));const r=(e,t)=>{var n;if(!e.descriptor)return{start:0};return null!==(n=e.descriptor.content.find((e=>e&&e.type===t)))&&void 0!==n?n:{start:0}},i=e=>/#\d{10,}$/.test(e);function o(e){const t=[];for(let n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n).cloneRange());return{anchorNode:e.anchorNode,anchorOffset:e.anchorOffset,focusNode:e.focusNode,focusOffset:e.focusOffset,isCollapsed:!1,rangeCount:e.rangeCount,type:e.type,ranges:t,toString:()=>e.toString(),getRangeAt:e=>{if(e>=0&&e<t.length)return t[e].cloneRange();throw new Error("Index out of bounds")},containsNode:(e,n=!1)=>t.some((t=>n?e===t.commonAncestorContainer||e.contains(t.commonAncestorContainer):e===t.startContainer&&e===t.endContainer))}}function s(e){var t,n,r,i,o,s="";if(void 0!==e){var c=e;if(c.toString().length>0){let e,d=document.createElement("div");if(e=null!=c.getRangeAt(0).cloneContents().firstChild&&"LI"===(null===(t=c.getRangeAt(0).cloneContents().firstChild)||void 0===t?void 0:t.nodeName)?document.createElement("ul"):"TR"===(null===(n=c.getRangeAt(0).cloneContents().firstChild)||void 0===n?void 0:n.nodeName)&&"TR"===(null===(r=c.getRangeAt(0).cloneContents().lastChild)||void 0===r?void 0:r.nodeName)?document.createElement("tbody"):document.createElement("div"),"TR"===(null===(i=c.getRangeAt(0).cloneContents().firstChild)||void 0===i?void 0:i.nodeName)&&"TR"===(null===(o=c.getRangeAt(0).cloneContents().lastChild)||void 0===o?void 0:o.nodeName)){let t=document.createElement("div");t.classList.add("table-container");let n=document.createElement("table");t.appendChild(n),d.appendChild(t),n.appendChild(e)}else d.appendChild(e);for(var l=0,u=c.rangeCount;l<u;++l){let t=c.getRangeAt(l).cloneContents();t.querySelectorAll("*").forEach((e=>{var t,n;let r=null!==(n=null===(t=e.childNodes[0])||void 0===t?void 0:t.nodeValue)&&void 0!==n?n:void 0;null!=r&&(r.trim().length||(e.childNodes[0].nodeValue="")),(e.getAttribute("hidden")||""===e.getAttribute("hidden")||0===e.textContent.length)&&e.parentNode.removeChild(e)})),t.querySelectorAll("*").forEach((e=>{if(t=e.nodeName,!a.some((e=>e===t)))if(null!=e.childNodes&&e.childNodes.length>0){let t=document.createElement("span");e.childNodes.forEach((e=>{t.appendChild(e)})),e.parentNode.replaceChild(t,e)}else e.parentNode.removeChild(e);var t})),t.querySelectorAll("*").forEach((e=>{var t,n;let r=null!==(n=null===(t=e.childNodes[0])||void 0===t?void 0:t.nodeValue)&&void 0!==n?n:void 0;null!=r&&(r.trim().length||(e.childNodes[0].nodeValue="")),0===e.textContent.length&&e.parentNode.removeChild(e)})),t.querySelectorAll("*").forEach((e=>{e.removeAttribute("style"),e.removeAttribute("class"),e.removeAttribute("id")})),e.appendChild(t)}const h=c.getRangeAt(0).commonAncestorContainer;let f=h.nodeType===Node.ELEMENT_NODE?h:h.parentElement,p=[];for(let e=0;e<6&&f;e++){if("PRE"===f.nodeName||"CODE"===f.nodeName){p=["CODE","PRE"];break}f=f.parentNode}let g,m=null;p.forEach(((t,n)=>{if(g=document.createElement(t.toLowerCase()),0===n){for(;e.firstChild;)g.appendChild(e.firstChild);d.removeChild(e)}else g.appendChild(m);m=g})),p.length>0&&d.appendChild(m),s=d.innerHTML}}let d=null==s?void 0:s.replace(new RegExp("-</span><span>","g"),"");return d=null==d?void 0:d.replace(new RegExp("</span><span>","g")," </span><span>"),d=null==d?void 0:d.replace(new RegExp("  ","g")," "),d}const a=["A","ABBR","AREA","ARTICLE","ASIDE","AUDIO","B","BASE","BDI","BDO","BLOCKQUOTE","BODY","BR","CAPTION","CITE","CODE","COL","COLGROUP","DATA","DATALIST","DD","DEL","DETAILS","DFN","DIALOG","DIV","DL","DT","EM","FIELDSET","FIGCAPTION","FIGURE","FOOTER","H1","H2","H3","H4","H5","H6","HEAD","HEADER","HGROUP","HR","I","IMG","INS","KBD","LABEL","LEGEND","LI","LINK","MAIN","MARK","MENU","META","METER","NAV","OBJECT","OL","OPTGROUP","OPTION","OUTPUT","P","PICTURE","PRE","PROGRESS","Q","RP","RT","S","SAMP","SECTION","SMALL","SOURCE","SPAN","STRONG","SUB","SUMMARY","SUP","SVG","TABLE","TBODY","TD","TEMPLATE","TEXTAREA","TFOOT","TH","THEAD","TIME","TITLE","TR","TRACK","U","UL","VAR","VIDEO","WBR"]},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r={0:{date:new Date("2020-06-22")},1:{date:new Date("2020-07-29")},2:{date:new Date("2020-08-26")},3:{date:new Date("2020-10-21")},4:{date:new Date("2020-12-10")},5:{date:new Date("2021-01-12")},6:{date:new Date("2021-01-15")},7:{date:new Date("2021-03-02")},8:{date:new Date("2021-05-12")},9:{date:new Date("2021-09-13")},10:{date:new Date("2021-11-16")},11:{date:new Date("2022-02-14")},12:{date:new Date("2022-07-29")},13:{date:new Date("2022-08-22")},14:{date:new Date("2022-10-01")},15:{date:new Date("2023-02-25")},16:{date:new Date("2023-09-15")},17:{date:new Date("2023-10-12")},18:{date:new Date("2023-11-08")},19:{date:new Date("2023-11-28")},20:{date:new Date("2023-12-12")},21:{date:new Date("2024-03-07")},22:{date:new Date("2025-02-04")}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return _})),n.d(t,"c",(function(){return w})),n.d(t,"b",(function(){return E}));var r=n(2),i=n(321),o=n(1159);const s=n(1171),a=n(1282),c={literal:function e({definition:t,parse:n}){let r;if(t instanceof Array){const i=t.map((t=>e({definition:t,parse:n})));r=e=>i.map((t=>t.evaluate(e)))}else if(t&&t.$logic){const e=n(t.$logic);r=t=>e.evaluate(t)}else if(s(t)){const i=Object.entries(t).map((([t,r])=>[t,e({definition:r,parse:n})]));r=e=>a(i.map((([t,n])=>[t,n.evaluate(e)])))}else r=()=>t;return{evaluate:r}},valueTemplate:l,stringTemplate:function({definition:e,parse:t}){return{evaluate:n=>e.replace(/\$\{([^}]+)}/g,(function(e,r){const i=t(`$${r}`).evaluate(n);return void 0!==i?i:e}))}},if:function({definition:e,parse:t}){const[n,r,i]=e.map(t);return{evaluate:e=>n.evaluate(e)?r.evaluate(e):i.evaluate(e)}},typeof:d((e=>typeof e())),not:d((e=>!e())),and:h(((e,t)=>e()&&t())),or:h(((e,t)=>e()||t())),eq:h(((e,t)=>e()===t())),gt:h(((e,t)=>e()>t())),gte:h(((e,t)=>e()>=t())),lt:h(((e,t)=>e()<t())),lte:h(((e,t)=>e()<=t())),array:function({definition:e,parse:t}){const n=e.map((e=>t(e)));return{evaluate:e=>n.map((t=>t.evaluate(e)))}},object:function({definition:e,parse:t}){const n=[];for(const[r,i]of Object.entries(e))n.push([r,t(i)]);return{evaluate:e=>{const t={};for(const[r,i]of n)t[r]=i.evaluate(e);return t}}},"object-property":function({definition:e,parse:t}){const n=e.map((e=>t(e)));return{evaluate:e=>{const t=n.map((t=>t.evaluate(e)));let r=t[0];for(const e of t.slice(1))r=o.get(r,e);return r}}},map:function({definition:e,parse:t}){const n=t(e[0]),r=t(e[1]);return{evaluate:e=>{const t=n.evaluate(e);if(s(t)){const n={};for(const[i,o]of Object.entries(t))n[i]=r.evaluate(Object.assign(Object.assign({},e),{map:{value:o,key:i}}));return n}return t.map(((t,n)=>r.evaluate(Object.assign(Object.assign({},e),{map:{value:t,index:n}}))))}}},debug:function({definition:e,parse:t}){let n=0;const r=e=>{const i=t(e,{childParse:r});return{evaluate:t=>{const r=++n;Object.keys(e)[0];console.log("USER-LOGIC (%d): evaluating %o with context %o",r,e,t);const o=i.evaluate(t);return console.log("USER-LOGIC (%d): result = %o",r,o),o}}},i=r(e);return{evaluate:e=>i.evaluate(e)}},capitalize:d((e=>{const t=e();return t.substr(0,1).toUpperCase()+t.substr(1)})),concat:h(((e,t)=>e()+t())),split:u((([e,t])=>e().split(t()))),join:u((([e,t])=>e().join(t())))};function l({definition:e,reportLookup:t}){const n=e.split(".");t(n);const r={path:n,evaluate:e=>o.withInheritedProps.get(e,r.path)};return r}function u(e){return({definition:t,parse:n})=>{const r=t.map(n);return{evaluate:t=>e(r.map((e=>()=>e.evaluate(t))))}}}function d(e){return({definition:t,parse:n})=>{const r=n(t);return{evaluate:t=>e((()=>r.evaluate(t)))}}}function h(e){return({definition:t,parse:n})=>{const r=t.map(n);return{evaluate:t=>{let n=()=>r[0].evaluate(t);for(let i=0;i<r.length-1;++i){const o=e(n,(()=>r[i+1].evaluate(t)));n=()=>o}return n()}}}}const f=n(1171),p=n(1281);class g{constructor({definition:e,operations:t,reportLookup:n,baseContext:r={}}){t=Object.assign(Object.assign({},c),t||{}),this.rootNode=m(e,t,n||(()=>{})),this.baseContext=r}evaluate(e){return this.rootNode.evaluate(Object.assign(Object.assign({},this.baseContext),e))}}function m(e,t,n,r=null){const i=r||((e,{childParse:r=null}={})=>m(e,t,n,r));let o,s=e;if("string"==typeof e){const n=e.substr(0,1);if("$"===n)o=t.valueTemplate,s=e.substr(1);else if("`"===n){if("`"!==e.substr(-1))throw new Error("Template strings beginning with ` must end with a `: "+e);o=t.stringTemplate,s=e.slice(1,-1)}else o=t.literal}else if(p(e))o=t.array;else if(f(e)){const n=Object.keys(e)[0];if(o=t[n],!o)throw new Error("No such operation: "+n);s=e[n]}else o=t.literal;return o({definition:s,parse:i,reportLookup:n})}function y(e){return e.definition=e.definition.split(":")[0],l(e)}const v=n(212);function b(e,t,n){if(v(e)){const r={};for(const[i,o]of Object.entries(e)){const e=b(o,t,n);(null==n?void 0:n.removeUndefinedValues)&&void 0===e||(r[i]=e)}return r}if(e instanceof Array)return e.map((e=>b(e,t,n)));if("string"==typeof e){return new g({definition:e,operations:{valueTemplate:y}}).evaluate(t)}return e}class _{constructor({storageManager:e,operationExecuter:t}){this.debug=!1,this._operationExecuter=t||E(e)}_initConfig(){this._config||(this._config=this.getConfig(),function(e){for(const t of Object.values(e.operations))if("createObject"===t.operation){if(t.args)continue;let n=e.collections[t.collection];n instanceof Array&&(n=n.slice(-1)[0]);const r=t.args={};for(const[e,t]of Object.entries(n.fields))r[e]=`$${e}:${t.type}`;for(const e of n.relationships||[])if(Object(i.d)(e)){const t=e.alias||Object(i.c)(e);r[t]=`$${t}`}}}(this))}get collections(){return this._initConfig(),this._config.collections}get operations(){return this._initConfig(),this._config.operations}operation(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(this._operationExecuter)return this._operationExecuter({name:e,context:t,debug:this.debug,method:n,render:()=>{const n="createObject"===this.operations[e].operation;return function(e,t,n){const r=[e.operation];e.collection&&r.push(e.collection);const i=b(e.args,t,n);e.args instanceof Array?r.push(...i):r.push(i);return r}(this.operations[e],t,{removeUndefinedValues:n})}})}))}}function w(e,t,n={}){for(const r of Object.values(t))T(e,r,n)}function T(e,t,n={}){n.version=n.version||new Date;for(const[r,i]of Object.entries(t.getConfig().collections||{})){const t=[i,...i.history||[]];e.registerCollection(r,t.filter((e=>e.version.getTime()<=n.version.getTime())).map((e=>Object.assign({},e))))}}function E(e){return({name:t,render:n,debug:i})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const[r,...o]=n();i&&A("pre-op",t,r,o,null,i);const s=yield e.operation(r,...o);return i&&i.includeReturnValues&&A("post-op",t,r,o,s,i),s}))}function A(e,t,r,i,o,s){const a=(e,t,r)=>{s.printDeepObjects&&(r=n(1283).inspect(r,!1,null,!0)),console.debug(e,t,r)},c=()=>{"pre-op"===e?a('DEBUG - executing storage operation "%s" with args',r,i):a('DEBUG - storage backend operation "%s" returned',r,o)};if("boolean"==typeof s)return void c();const l=s.onlyModuleOperations;(!l||l.indexOf(t)>=0)&&c()}},,,,,,function(e,t,n){"use strict";n.d(t,"j",(function(){return s})),n.d(t,"d",(function(){return a})),n.d(t,"f",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return h})),n.d(t,"e",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return g})),n.d(t,"c",(function(){return m}));n(2);var r=n(11),i=n(16),o=n.n(i);n(29),n(235);function s(e){return e.public?e.protected?r.a.SHARED_PROTECTED:r.a.SHARED:e.protected?r.a.PROTECTED:r.a.PRIVATE}function a(e){return{protected:e===r.a.PROTECTED||e===r.a.SHARED_PROTECTED,public:e===r.a.SHARED||e===r.a.SHARED_PROTECTED}}function c(){let e="staging";return e="production",function(e){if("production"===e)return"https://memex.social";if("staging"===e)return"https://staging.memex.social";return"http://localhost:3000"}(e)}function l(e){const t=e.collaborationKey?`?key=${e.collaborationKey}`:"";return`${c()}/c/${e.remoteListId}${t}`}function u(e){return`${c()}/p/${e.remotePageInfoId}`}function d(e){const t=e.collaborationKey?`?key=${e.collaborationKey}`:"";return`/c/${e.remoteListId}/p/${e.remoteListEntryId}${t}`}function h(e){return`${c()}/a/${e.remoteAnnotationId}`}function f(){return`${c()}/feed`}const p=(e=new Date)=>o()(e).format("MMMM Do YYYY, h:mma"),g=(...e)=>e.filter((e=>null!=e)).map((e=>e.toString())).reduce(((e,t)=>`${e}${e.length?",":""}${t}`),""),m=(e,t)=>{if(!(null==e?void 0:e.length))return[];const n=e.split(",");return"string"===t?n:n.map((e=>Number(e)))}},function(e,t,n){var r=n(367),i=n(372);e.exports=function(e,t){var n=i(e,t);return r(n)?n:void 0}},function(e,t,n){var r=n(96),i=n(368),o=n(369),s=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":s&&s in Object(e)?i(e):o(e)}},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return a}));var r=n(2);function i(e){o(e)}function o({cb:e,root:t,getChildren:n,strategy:r="bfs"}){const i=[],o=[t];let s=0;for(;o.length;){const t="bfs"===r?o.shift():o.pop();i.push(e(t,s++));const a=n(t);o.push(...a)}return i}function s(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield function({cb:e,root:t,concurrent:n,getChildren:i,strategy:o="bfs"}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=[],s=[t];let a=0;for(;s.length;){const t="bfs"===o?s.shift():s.pop(),c=e(t,a++);r.push(n?c:yield c);const l=yield i(t);s.push(...l)}return Promise.all(r)}))}(e)}))}const a=20231213},,,function(e,t,n){var r=n(40).Symbol;e.exports=r},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return d}));var r=n(16),i=n.n(r);const o=6048e5;function s(e,t){return i()(e).format(t)}function a(e,t,n){return i()(e).diff(t,n)}function c(e){return i()(e).fromNow()}function l(e,t){return i()(e).calendar(null,t)}function u(e){return i()(e).startOf("day").valueOf()}function d(e){const t=e=>Math.floor(e/3600),n=e=>Math.floor((e-3600*t(e))/60),r=`${t(e)}:${o=e,n(o)<10?`0${n(o)}`:n(o)}`;var o;return"0:00"===r?r:i.a.duration(r).humanize()}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2);n(165);function i(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return new Promise((t=>setTimeout(t,e)))}))}},,function(e,t,n){"use strict";function r(e,t){let n="";if(t.includes("/k/")){const t=e.getElementsByClassName("peer-title");for(let e of Array.from(t)){e.parentElement.classList.contains("row-title")||(n=e.innerText)}}else if(t.includes("/a/")){const t=e.getElementsByClassName("fullName");for(let e of Array.from(t)){e.parentElement.parentElement.classList.contains("info-row")||(n=e.innerText)}}return n}function i(e){return e.replace("?user=","/#@")}function o(e){let t=e;if(e.includes("?")){const n=new URL(e),r=[];n.searchParams.forEach(((e,t)=>{"user"!==t&&r.push(t)}));for(let e of r)n.searchParams.delete(e);t=n.toString()}return e.includes("/#@")?t=t.replace("/#@","?user="):e.includes("/#-")&&!e.includes("@")?t=t.replace("/#-","?user="):e.includes("/#")&&!e.includes("@")?t=t.replace("/#","?user="):e.includes("#@")&&(t=t.replace("#@","?user=")),t}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return a}));var r=n(2),i=n(158);const o=(e,t)=>t.runtimeAPI.getURL(i.a)+"?file="+encodeURIComponent(e)+"#pagemode=none",s=(e,t)=>{const n=t.runtimeAPI.getURL(i.a);return e.includes(n)};function a(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=o(e,{runtimeAPI:t.runtimeAPI});yield t.tabsAPI.create({url:n})}))}},function(e,t,n){"use strict";n.d(t,"g",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"c",(function(){return g}));var r=n(243),i=n(29),o=n(71),s=n(187),a=n(163);const c=(e,t,n)=>{var r,i;return((e,t)=>[...new Set([...e,...t])])(null!==(r=null==t?void 0:t[e])&&void 0!==r?r:[],null!==(i=null==n?void 0:n[e])&&void 0!==i?i:[])};function l(e,t){return e.fingerprintScheme===t.fingerprintScheme&&e.fingerprint===t.fingerprint}function u(e){return e.url.startsWith(a.b)||e.url.startsWith("https://"+a.b)||e.url.startsWith("https://arxiv.org/pdf/")}function d(e){return e.startsWith(i.b.production+r.a)||e.startsWith(i.b.staging+r.a)}function h(e){return e.endsWith(".pdf")||d(e)}const f=(e,t)=>`https://memex.cloud/ct/${e}.${t}`;function p(e,t){if(!e.length)return null;const n=e.sort(((e,t)=>{var n,r;return(null!==(n=t.lastVisited)&&void 0!==n?n:0)-(null!==(r=e.lastVisited)&&void 0!==r?r:0)})),r=[],i=[];for(const e of n)e.locationType!==o.b.Remote||(null==t?void 0:t.ignoreUploadLocators)&&e.locationScheme===o.f.UploadStorage?e.locationType===o.b.Local&&i.push(e):r.push(e);const s=(null==t?void 0:t.priority)===o.b.Local?[i,r]:[r,i];for(const e of s)if(e.length)return e[0];return null}const g=(e,{separator:t=s.a})=>e.split(t).map((e=>e.toLowerCase())).filter((e=>e.length))},function(e,t,n){var r=n(48),i=n(576),o=n(289),s=Math.max,a=Math.min;e.exports=function(e,t,n){var c,l,u,d,h,f,p=0,g=!1,m=!1,y=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function v(t){var n=c,r=l;return c=l=void 0,p=t,d=e.apply(r,n)}function b(e){var n=e-f;return void 0===f||n>=t||n<0||m&&e-p>=u}function _(){var e=i();if(b(e))return w(e);h=setTimeout(_,function(e){var n=t-(e-f);return m?a(n,u-(e-p)):n}(e))}function w(e){return h=void 0,y&&c?v(e):(c=l=void 0,d)}function T(){var e=i(),n=b(e);if(c=arguments,l=this,f=e,n){if(void 0===h)return function(e){return p=e,h=setTimeout(_,t),g?v(e):d}(f);if(m)return clearTimeout(h),h=setTimeout(_,t),v(f)}return void 0===h&&(h=setTimeout(_,t)),d}return t=o(t)||0,r(n)&&(g=!!n.leading,u=(m="maxWait"in n)?s(o(n.maxWait)||0,t):u,y="trailing"in n?!!n.trailing:y),T.cancel=function(){void 0!==h&&clearTimeout(h),p=0,c=f=l=h=void 0},T.flush=function(){return void 0===h?d:w(i())},T}},,function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"f",(function(){return h})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return p}));var r=n(2),i=n(38),o=n(32),s=n(3),a=n.n(s);const c=e=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){return yield Object(o.a)(i.f.onboardingFlows[e],i.e.unvisited)})),l=(e,t)=>Object(o.b)(i.f.onboardingFlows[e],t),u=()=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){const e=i.f.onboardingFlows,t=yield a.a.storage.local.get(Object.values(e));return{annotationStage:t[e.annotation],powerSearchStage:t[e.powerSearch],taggingStage:t[e.tagging],backupStage:t[e.backup]}})),d=()=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){yield c(i.b.powerSearch)})),h=(e=window.location)=>e.href.includes(i.d.NEW_USER),f=()=>({x:window.innerWidth/2,y:window.innerHeight/2-200}),p=()=>window.location.href===i.a},,function(e,t,n){var r=n(115);e.exports=function(e){if("string"==typeof e||r(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},,function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){t.Refiner=function(){this.refine=function(e,t,n){return t}},t.Filter=function(){t.Refiner.call(this),this.isValid=function(e,t,n){return!0},this.refine=function(e,t,n){for(var r=[],i=0;i<t.length;i++){var o=t[i];this.isValid(e,o,n)&&r.push(o)}return r}},t.OverlapRemovalRefiner=n(850).Refiner,t.ExtractTimezoneOffsetRefiner=n(851).Refiner,t.ExtractTimezoneAbbrRefiner=n(852).Refiner,t.ForwardDateRefiner=n(853).Refiner,t.UnlikelyFormatFilter=n(854).Refiner,t.ENMergeDateTimeRefiner=n(296).Refiner,t.ENMergeDateRangeRefiner=n(520).Refiner,t.ENPrioritizeSpecificDateRefiner=n(855).Refiner,t.JPMergeDateRangeRefiner=n(856).Refiner,t.FRMergeDateRangeRefiner=n(857).Refiner,t.FRMergeDateTimeRefiner=n(858).Refiner,t.DEMergeDateRangeRefiner=n(859).Refiner,t.DEMergeDateTimeRefiner=n(860).Refiner},,,function(e,t,n){var r=n(88),i=n(50);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==r(e)}},function(e,t,n){var r=n(262),i=n(263),o=n(134);e.exports=function(e){return o(e)?r(e):i(e)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return a}));var r=n(2),i=n(352);function o(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t=(yield e.storageAPI.local.get("PKMSYNCpkmSyncKey")).PKMSYNCpkmSyncKey;return t||(t=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),yield e.storageAPI.local.set({PKMSYNCpkmSyncKey:t})),t}))}function s(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){try{const r=yield e.storageAPI.local.get("PKMSYNCpkmFolders");return!(!r.PKMSYNCpkmFolders||!((null===(t=r.PKMSYNCpkmFolders.obsidianFolder)||void 0===t?void 0:t.length)>0||(null===(n=r.PKMSYNCpkmFolders.logSeqFolder)||void 0===n?void 0:n.length)>0))}catch(e){return!1}}))}function a(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield o(t),s=i.b,a=yield(e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield fetch(`${s}/set-directory`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pkmSyncType:e,syncKey:n})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return yield t.text()})))(e);let c=yield t.storageAPI.local.get("PKMSYNCpkmFolders");return c=c.PKMSYNCpkmFolders||{},"logseq"===e?c.logSeqFolder=a:"obsidian"===e?c.obsidianFolder=a:"backup"===e&&(c.backupFolder=a),yield t.storageAPI.local.set({PKMSYNCpkmFolders:c}),c}))}},function(e,t,n){var r=n(219),i=n(139);e.exports=function(e,t,n,o){var s=!n;n||(n={});for(var a=-1,c=t.length;++a<c;){var l=t[a],u=o?o(n[l],e[l],l,n,e):void 0;void 0===u&&(u=e[l]),s?i(n,l,u):r(n,l,u)}return n}},function(e,t,n){var r=n(431),i=n(180),o=n(432),s=n(433),a=n(247),c=n(88),l=n(249),u="[object Map]",d="[object Promise]",h="[object Set]",f="[object WeakMap]",p="[object DataView]",g=l(r),m=l(i),y=l(o),v=l(s),b=l(a),_=c;(r&&_(new r(new ArrayBuffer(1)))!=p||i&&_(new i)!=u||o&&_(o.resolve())!=d||s&&_(new s)!=h||a&&_(new a)!=f)&&(_=function(e){var t=c(e),n="[object Object]"==t?e.constructor:void 0,r=n?l(n):"";if(r)switch(r){case g:return p;case m:return u;case y:return d;case v:return h;case b:return f}return t}),e.exports=_},,,,,function(e,t){e.exports=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,n){var r=n(262),i=n(426),o=n(134);e.exports=function(e){return o(e)?r(e,!0):i(e)}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r={r:198,g:240,b:212,a:1}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return a}));var r=n(3),i=n.n(r),o=n(103);const s=(e,t={runtimeAPI:i.a.runtime})=>Object(o.b)(e,t)?new URL(e).searchParams.get("file"):e,a=e=>(e&&(e.url=s(e.url)),e)},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,l=[],u=!1,d=-1;function h(){u&&c&&(u=!1,c.length?l=c.concat(l):d=-1,l.length&&f())}function f(){if(!u){var e=a(h);u=!0;for(var t=l.length;t;){for(c=l,l=[];++d<t;)c&&c[d].run();d=-1,t=l.length}c=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new p(e,t)),1!==l.length||u||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},,function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(51),i=n(102);const o=(e,t)=>t.some((t=>t instanceof RegExp?t.test(e):t===e));function s(e,t){if(t=Object.assign({defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0},t),Reflect.has(t,"normalizeHttps"))throw new Error("options.normalizeHttps is renamed to options.forceHttp");if(Reflect.has(t,"normalizeHttp"))throw new Error("options.normalizeHttp is renamed to options.forceHttps");if(Reflect.has(t,"stripFragment"))throw new Error("options.stripFragment is renamed to options.stripHash");const n=(e=e.trim()).startsWith("//");!n&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));const s=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");t.forceHttp&&"https:"===s.protocol&&(s.protocol="http:"),t.forceHttps&&"http:"===s.protocol&&(s.protocol="https:"),t.stripAuthentication&&(s.username="",s.password="");if(t.stripHash&&!["web.telegram.org","mail.google.com"].includes(s.hostname)&&(s.hash=""),s.pathname&&(s.pathname=s.pathname.replace(/((?!:).|^)\/{2,}/g,((e,t)=>/^(?!\/)/g.test(t)?`${t}/`:"/"))),s.pathname&&(s.pathname=decodeURI(s.pathname)),!0===t.removeDirectoryIndex&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let e=s.pathname.split("/");const n=e[e.length-1];o(n,t.removeDirectoryIndex)&&(e=e.slice(0,e.length-1),s.pathname=e.slice(1).join("/")+"/")}if(s.hostname&&(s.hostname=s.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.([a-z\-\d]{2,63})\.([a-z.]{2,5})$/.test(s.hostname)&&(s.hostname=s.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters)&&s.searchParams)for(const e of[...s.searchParams.keys()])o(e,t.removeQueryParameters)&&s.searchParams.delete(e);if(t.sortQueryParameters&&s.searchParams&&s.searchParams.sort(),t.removeTrailingSlash&&(s.pathname=s.pathname.replace(/\/$/,"")),e=s.toString(),!t.removeTrailingSlash&&"/"!==s.pathname||""!==s.hash||(e=e.replace(/\/$/,"")),n&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),Object(r.e)(e)){const t=new URL(e);let n;if(e.includes("/live/")){const e=t.pathname.split("/");n=e[e.length-1]}else if(n=t.searchParams.get("v"),!n){const e=t.pathname.split("/");n=e[e.length-1]}e=`https://youtube.com/watch?v=${n}`}return e.includes("web.telegram.org/")&&(e=Object(i.b)(e)),e.includes("mail.google.com/mail")&&(e=function(e){let t=e;if(e.includes("#search")||e.includes("#inbox")||e.includes("#sent")||e.includes("#snoozed")||e.includes("#drafts")||e.includes("#imp")||e.includes("#scheduled")){const n=e.split("/");t=`https://mail.google.com/mail/#inbox/${n[n.length-1]}`}return t}(e)),e.endsWith("/")&&(e=e.slice(0,-1)),e}function a(e){return/^(https?|file):\/\//i.test(e)}function c(e){return e.startsWith("file://")||e.startsWith("blob:")}},function(e,t,n){var r=n(148),i=n(177);e.exports=function(e){return null!=e&&i(e.length)&&!r(e)}},,,,function(e,t){var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&n.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,n){var r=n(259);e.exports=function(e,t,n){"__proto__"==t&&r?r(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},function(e,t){e.exports=function(e){return e}},function(e,t,n){var r=n(142),i=n(48);e.exports=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=r(e.prototype),o=e.apply(n,t);return i(o)?o:n}}},function(e,t,n){var r=n(48),i=Object.create,o=function(){function e(){}return function(t){if(!r(t))return{};if(i)return i(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();e.exports=o},function(e,t,n){var r=n(403),i=n(404),o=n(405),s=n(406),a=n(407);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=s,c.prototype.set=a,e.exports=c},function(e,t,n){var r=n(125);e.exports=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1}},function(e,t,n){var r=n(87)(Object,"create");e.exports=r},function(e,t,n){var r=n(421);e.exports=function(e,t){var n=e.__data__;return r(t)?n["string"==typeof t?"string":"hash"]:n.map}},,function(e,t,n){var r=n(88),i=n(48);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,n){var r=n(398),i=n(50),o=Object.prototype,s=o.hasOwnProperty,a=o.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(e){return i(e)&&s.call(e,"callee")&&!a.call(e,"callee")};e.exports=c},function(e,t,n){(function(e){var r=n(40),i=n(399),o=t&&!t.nodeType&&t,s=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=s&&s.exports===o?r.Buffer:void 0,c=(a?a.isBuffer:void 0)||i;e.exports=c}).call(this,n(111)(e))},function(e,t,n){var r=n(143),i=n(408),o=n(409),s=n(410),a=n(411),c=n(412);function l(e){var t=this.__data__=new r(e);this.size=t.size}l.prototype.clear=i,l.prototype.delete=o,l.prototype.get=s,l.prototype.has=a,l.prototype.set=c,e.exports=l},,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(76);const i=(e,t)=>{const n=s(e),i=s(t);return n||i?n?i?Object(r.b)(n,"TextPositionSelector").start-Object(r.b)(i,"TextPositionSelector").start:1e5:-1e5:0},o=(e,t)=>new Date(e.createdWhen).getTime()-new Date(t.createdWhen).getTime(),s=({selector:e})=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){return null}return e}},,function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.DomHandler=void 0;var o=n(598),s=n(599);i(n(599),t);var a={withStartIndices:!1,withEndIndices:!1,xmlMode:!1},c=function(){function e(e,t,n){this.dom=[],this.root=new s.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,"function"==typeof t&&(n=t,t=a),"object"==typeof e&&(t=e,e=void 0),this.callback=null!=e?e:null,this.options=null!=t?t:a,this.elementCB=null!=n?n:null}return e.prototype.onparserinit=function(e){this.parser=e},e.prototype.onreset=function(){this.dom=[],this.root=new s.Document(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null},e.prototype.onend=function(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))},e.prototype.onerror=function(e){this.handleCallback(e)},e.prototype.onclosetag=function(){this.lastNode=null;var e=this.tagStack.pop();this.options.withEndIndices&&(e.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(e)},e.prototype.onopentag=function(e,t){var n=this.options.xmlMode?o.ElementType.Tag:void 0,r=new s.Element(e,t,void 0,n);this.addNode(r),this.tagStack.push(r)},e.prototype.ontext=function(e){var t=this.lastNode;if(t&&t.type===o.ElementType.Text)t.data+=e,this.options.withEndIndices&&(t.endIndex=this.parser.endIndex);else{var n=new s.Text(e);this.addNode(n),this.lastNode=n}},e.prototype.oncomment=function(e){if(this.lastNode&&this.lastNode.type===o.ElementType.Comment)this.lastNode.data+=e;else{var t=new s.Comment(e);this.addNode(t),this.lastNode=t}},e.prototype.oncommentend=function(){this.lastNode=null},e.prototype.oncdatastart=function(){var e=new s.Text(""),t=new s.CDATA([e]);this.addNode(t),e.parent=t,this.lastNode=e},e.prototype.oncdataend=function(){this.lastNode=null},e.prototype.onprocessinginstruction=function(e,t){var n=new s.ProcessingInstruction(e,t);this.addNode(n)},e.prototype.handleCallback=function(e){if("function"==typeof this.callback)this.callback(e,this.dom);else if(e)throw e},e.prototype.addNode=function(e){var t=this.tagStack[this.tagStack.length-1],n=t.children[t.children.length-1];this.options.withStartIndices&&(e.startIndex=this.parser.startIndex),this.options.withEndIndices&&(e.endIndex=this.parser.endIndex),t.children.push(e),n&&(e.prev=n,n.next=e),e.parent=t,this.lastNode=null},e}();t.DomHandler=c,t.default=c},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=()=>{let e,t;const n=new Promise(((n,r)=>{e=n,t=r}));return n.resolve=e,n.reject=t,n};t.default=r,e.exports=r},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="pdfjs/viewer.html"},,,,function(e,t,n){"use strict";t.a=function(){var e;return navigator.userAgent.includes("Firefox")?"firefox":"function"==typeof(null===(e=navigator.brave)||void 0===e?void 0:e.isBrave)?"brave":"chrome"}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o}));const r="__FETCH_ME__",i=10485760,o="memex.cloud/ct/"},function(e,t){e.exports={}},function(e,t,n){"use strict";function r(){let e,t;const n=new Promise(((n,r)=>{e=n,t=r}));return n.resolve=e,n.reject=t,n}n.d(t,"a",(function(){return r}))},,function(e,t,n){"use strict";n.d(t,"f",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return h})),n.d(t,"c",(function(){return f}));var r=n(2),i=n(895),o=n.n(i),s=n(223),a=n.n(s);const c=(e,t,n=10)=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){return a()(yield Promise.all(o()(e,n).map(t)))})),l=(e,t,n=10)=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){for(const[r,i]of o()(e,n).entries())yield t(i,r)}));function u(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return a()(yield Promise.all(o()(e,10).map((e=>t(e)))))}))}function d(e){return e.field.endsWith("_terms")||e.field.endsWith("Terms")||"terms"===e.field}function h(e,t){return["pages","customLists"].includes(e)?"text"===t?"terms":"fullTitle"===t?"titleTerms":"fullUrl"===t?"urlTerms":"searchableName"===t?"nameTerms":null:null}function f(e){const t=e.registry.getSchemaHistory().map((({version:e})=>e.getTime())).sort();return new Date(t[t.length-1])}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return l}));const r={google:{regex:/(http[s]?:\/\/)?(www.)?google[.\w]+\/search\?.*/,container:{above:"center_col",side:"rhs",sideAlternative:"rcnt",featurePreview:"Odp5De",searchList:"search"},containerType:"id"},duckduckgo:{regex:/(http[s]?:\/\/)?(www.)?duckduckgo[.\w]+\/.*?[?&]q=.*/,container:{above:"js-react-sidebar",side:"js-react-sidebar"},containerType:"class"},brave:{regex:/(http[s]?:\/\/)?(www.)?brave[.\w]+\/search\?.*/,container:{above:"sidebar",side:"sidebar",sideAlternative:"sidebar"},containerType:"id"},bing:{regex:/(http[s]?:\/\/)?(www.)?bing[.\w]+\/search\?.*/,container:{above:"b_context",side:"b_context",sideAlternative:"b_context"},containerType:"id"}},i=["vid","nws","bks","fin","lcl","isch","pers"],o="HIDE_MEMEX_RESULTS",s="SEARCH_INJECTION",a="RESULTS_POSITION_",c={google:!0,duckduckgo:!0,brave:!0,bing:!0},l={youtubeInterface:"__MEMEX-YOUTUBE-INTERFACE-ROOT",searchEngineInjection:"__MEMEX-SEARCH-INJECTION-ROOT",pdfOpenButtons:"__PDF-OPEN-BUTTONS-INJECTION-ROOT",imgActionButtons:"__IMG-ACTION-BUTTONS-INJECTION-ROOT"}},function(e,t,n){var r=n(245),i=n(373),o=n(374),s=n(250),a=n(392),c=n(254),l=n(393),u=n(256),d=n(258),h=n(236),f=Math.max;e.exports=function(e,t,n,p,g,m,y,v){var b=2&t;if(!b&&"function"!=typeof e)throw new TypeError("Expected a function");var _=p?p.length:0;if(_||(t&=-97,p=g=void 0),y=void 0===y?y:f(h(y),0),v=void 0===v?v:h(v),_-=g?g.length:0,64&t){var w=p,T=g;p=g=void 0}var E=b?void 0:c(e),A=[e,t,n,p,g,w,T,m,y,v];if(E&&l(A,E),e=A[0],t=A[1],n=A[2],p=A[3],g=A[4],!(v=A[9]=void 0===A[9]?b?0:e.length:f(A[9]-_,0))&&24&t&&(t&=-25),t&&1!=t)S=8==t||16==t?o(e,t,v):32!=t&&33!=t||g.length?s.apply(void 0,A):a(e,t,n,p);else var S=i(e,t,n);return d((E?r:u)(S,A),e,t)}},function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},function(e,t,n){var r=n(142),i=n(173);function o(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}o.prototype=r(i.prototype),o.prototype.constructor=o,e.exports=o},function(e,t){e.exports=function(){}},function(e,t,n){var r=n(383),i=n(257)(r);e.exports=i},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}},function(e,t){var n="__lodash_placeholder__";e.exports=function(e,t){for(var r=-1,i=e.length,o=0,s=[];++r<i;){var a=e[r];a!==t&&a!==n||(e[r]=n,s[o++]=r)}return s}},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t,n){(function(e){var r=n(248),i=t&&!t.nodeType&&t,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===i&&r.process,a=function(){try{var e=o&&o.require&&o.require("util").types;return e||s&&s.binding&&s.binding("util")}catch(e){}}();e.exports=a}).call(this,n(111)(e))},function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},function(e,t,n){var r=n(87)(n(40),"Map");e.exports=r},function(e,t,n){var r=n(413),i=n(420),o=n(422),s=n(423),a=n(424);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=s,c.prototype.set=a,e.exports=c},function(e,t,n){var r=n(429),i=n(265),o=Object.prototype.propertyIsEnumerable,s=Object.getOwnPropertySymbols,a=s?function(e){return null==e?[]:(e=Object(e),r(s(e),(function(t){return o.call(e,t)})))}:i;e.exports=a},function(e,t){e.exports=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}},function(e,t,n){var r=n(264)(Object.getPrototypeOf,Object);e.exports=r},function(e,t,n){var r=n(269);e.exports=function(e){var t=new e.constructor(e.byteLength);return new r(t).set(new r(e)),t}},function(e,t,n){var r=n(41),i=n(115),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;e.exports=function(e,t){if(r(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!i(e))||(s.test(e)||!o.test(e)||null!=t&&e in Object(t))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=/[|/\u{A0}' .,|(\n)]+/gu},,,function(e,t,n){var r=n(400),i=n(168),o=n(178),s=o&&o.isTypedArray,a=s?i(s):r;e.exports=a},,,function(e,t,n){var r=n(447),i=n(458),o=n(140),s=n(41),a=n(465);e.exports=function(e){return"function"==typeof e?e:null==e?o:"object"==typeof e?s(e)?i(e[0],e[1]):r(e):a(e)}},,,,,function(e,t,n){var r=n(41),i=n(186),o=n(273),s=n(203);e.exports=function(e,t){return r(e)?e:i(e,t)?[e]:o(s(e))}},,,function(e,t,n){"use strict";n.r(t),n.d(t,"Component",(function(){return i})),n.d(t,"ComponentContainer",(function(){return a})),n.d(t,"Provider",(function(){return s}));var r=n(30);class i{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const o="[DEFAULT]";class s{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r.Deferred;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:o})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=o){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=o){return this.instances.has(e)}getOptions(e=o){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(e)&&t.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===o?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e=o){return this.component?this.component.multipleInstances?e:o:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new s(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},,function(e,t,n){var r=n(462);e.exports=function(e){return null==e?"":r(e)}},function(e,t){t.WEEKDAY_OFFSET={sunday:0,sun:0,monday:1,mon:1,tuesday:2,tue:2,wednesday:3,wed:3,thursday:4,thur:4,thu:4,friday:5,fri:5,saturday:6,sat:6},t.MONTH_OFFSET={january:1,jan:1,"jan.":1,february:2,feb:2,"feb.":2,march:3,mar:3,"mar.":3,april:4,apr:4,"apr.":4,may:5,june:6,jun:6,"jun.":6,july:7,jul:7,"jul.":7,august:8,aug:8,"aug.":8,september:9,sep:9,"sep.":9,sept:9,"sept.":9,october:10,oct:10,"oct.":10,november:11,nov:11,"nov.":11,december:12,dec:12,"dec.":12},t.INTEGER_WORDS={one:1,two:2,three:3,four:4,five:5,six:6,seven:7,eight:8,nine:9,ten:10,eleven:11,twelve:12},t.INTEGER_WORDS_PATTERN="(?:"+Object.keys(t.INTEGER_WORDS).join("|")+")",t.ORDINAL_WORDS={first:1,second:2,third:3,fourth:4,fifth:5,sixth:6,seventh:7,eighth:8,ninth:9,tenth:10,eleventh:11,twelfth:12,thirteenth:13,fourteenth:14,fifteenth:15,sixteenth:16,seventeenth:17,eighteenth:18,nineteenth:19,twentieth:20,"twenty first":21,"twenty second":22,"twenty third":23,"twenty fourth":24,"twenty fifth":25,"twenty sixth":26,"twenty seventh":27,"twenty eighth":28,"twenty ninth":29,thirtieth:30,"thirty first":31},t.ORDINAL_WORDS_PATTERN="(?:"+Object.keys(t.ORDINAL_WORDS).join("|").replace(/ /g,"[ -]")+")"},,,function(e,t,n){"use strict";var r=n(334),i=n(474);function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=b,t.resolve=function(e,t){return b(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?b(e,!1,!0).resolveObject(t):t},t.format=function(e){i.isString(e)&&(e=b(e));return e instanceof o?e.format():o.prototype.format.call(e)},t.Url=o;var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(l),d=["%","/","?",";","#"].concat(u),h=["/","?","#"],f=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,g={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},y={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},v=n(475);function b(e,t,n){if(e&&i.isObject(e)&&e instanceof o)return e;var r=new o;return r.parse(e,t,n),r}o.prototype.parse=function(e,t,n){if(!i.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var o=e.indexOf("?"),a=-1!==o&&o<e.indexOf("#")?"?":"#",l=e.split(a);l[0]=l[0].replace(/\\/g,"/");var b=e=l.join(a);if(b=b.trim(),!n&&1===e.split("#").length){var _=c.exec(b);if(_)return this.path=b,this.href=b,this.pathname=_[1],_[2]?(this.search=_[2],this.query=t?v.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var w=s.exec(b);if(w){var T=(w=w[0]).toLowerCase();this.protocol=T,b=b.substr(w.length)}if(n||w||b.match(/^\/\/[^@\/]+@[^@\/]+/)){var E="//"===b.substr(0,2);!E||w&&m[w]||(b=b.substr(2),this.slashes=!0)}if(!m[w]&&(E||w&&!y[w])){for(var A,S,O=-1,I=0;I<h.length;I++){-1!==(C=b.indexOf(h[I]))&&(-1===O||C<O)&&(O=C)}-1!==(S=-1===O?b.lastIndexOf("@"):b.lastIndexOf("@",O))&&(A=b.slice(0,S),b=b.slice(S+1),this.auth=decodeURIComponent(A)),O=-1;for(I=0;I<d.length;I++){var C;-1!==(C=b.indexOf(d[I]))&&(-1===O||C<O)&&(O=C)}-1===O&&(O=b.length),this.host=b.slice(0,O),b=b.slice(O),this.parseHost(),this.hostname=this.hostname||"";var k="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!k)for(var P=this.hostname.split(/\./),x=(I=0,P.length);I<x;I++){var R=P[I];if(R&&!R.match(f)){for(var L="",D=0,N=R.length;D<N;D++)R.charCodeAt(D)>127?L+="x":L+=R[D];if(!L.match(f)){var j=P.slice(0,I),M=P.slice(I+1),F=R.match(p);F&&(j.push(F[1]),M.unshift(F[2])),M.length&&(b="/"+M.join(".")+b),this.hostname=j.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),k||(this.hostname=r.toASCII(this.hostname));var U=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+U,this.href+=this.host,k&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==b[0]&&(b="/"+b))}if(!g[T])for(I=0,x=u.length;I<x;I++){var G=u[I];if(-1!==b.indexOf(G)){var q=encodeURIComponent(G);q===G&&(q=escape(G)),b=b.split(G).join(q)}}var H=b.indexOf("#");-1!==H&&(this.hash=b.substr(H),b=b.slice(0,H));var $=b.indexOf("?");if(-1!==$?(this.search=b.substr($),this.query=b.substr($+1),t&&(this.query=v.parse(this.query)),b=b.slice(0,$)):t&&(this.search="",this.query={}),b&&(this.pathname=b),y[T]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){U=this.pathname||"";var W=this.search||"";this.path=U+W}return this.href=this.format(),this},o.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,s="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(s=v.stringify(this.query));var a=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||y[t])&&!1!==o?(o="//"+(o||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):o||(o=""),r&&"#"!==r.charAt(0)&&(r="#"+r),a&&"?"!==a.charAt(0)&&(a="?"+a),t+o+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+r},o.prototype.resolve=function(e){return this.resolveObject(b(e,!1,!0)).format()},o.prototype.resolveObject=function(e){if(i.isString(e)){var t=new o;t.parse(e,!1,!0),e=t}for(var n=new o,r=Object.keys(this),s=0;s<r.length;s++){var a=r[s];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var c=Object.keys(e),l=0;l<c.length;l++){var u=c[l];"protocol"!==u&&(n[u]=e[u])}return y[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!y[e.protocol]){for(var d=Object.keys(e),h=0;h<d.length;h++){var f=d[h];n[f]=e[f]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||m[e.protocol])n.pathname=e.pathname;else{for(var p=(e.pathname||"").split("/");p.length&&!(e.host=p.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),n.pathname=p.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var g=n.pathname||"",v=n.search||"";n.path=g+v}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var b=n.pathname&&"/"===n.pathname.charAt(0),_=e.host||e.pathname&&"/"===e.pathname.charAt(0),w=_||b||n.host&&e.pathname,T=w,E=n.pathname&&n.pathname.split("/")||[],A=(p=e.pathname&&e.pathname.split("/")||[],n.protocol&&!y[n.protocol]);if(A&&(n.hostname="",n.port=null,n.host&&(""===E[0]?E[0]=n.host:E.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===p[0]?p[0]=e.host:p.unshift(e.host)),e.host=null),w=w&&(""===p[0]||""===E[0])),_)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,E=p;else if(p.length)E||(E=[]),E.pop(),E=E.concat(p),n.search=e.search,n.query=e.query;else if(!i.isNullOrUndefined(e.search)){if(A)n.hostname=n.host=E.shift(),(k=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=k.shift(),n.host=n.hostname=k.shift());return n.search=e.search,n.query=e.query,i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!E.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var S=E.slice(-1)[0],O=(n.host||e.host||E.length>1)&&("."===S||".."===S)||""===S,I=0,C=E.length;C>=0;C--)"."===(S=E[C])?E.splice(C,1):".."===S?(E.splice(C,1),I++):I&&(E.splice(C,1),I--);if(!w&&!T)for(;I--;I)E.unshift("..");!w||""===E[0]||E[0]&&"/"===E[0].charAt(0)||E.unshift(""),O&&"/"!==E.join("/").substr(-1)&&E.push("");var k,P=""===E[0]||E[0]&&"/"===E[0].charAt(0);A&&(n.hostname=n.host=P?"":E.length?E.shift():"",(k=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=k.shift(),n.host=n.hostname=k.shift()));return(w=w||n.host&&E.length)&&!P&&E.unshift(""),E.length?n.pathname=E.join("/"):(n.pathname=null,n.path=null),i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},o.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},,,,,function(e,t,n){var r=n(88),i=n(184),o=n(50),s=Function.prototype,a=Object.prototype,c=s.toString,l=a.hasOwnProperty,u=c.call(Object);e.exports=function(e){if(!o(e)||"[object Object]"!=r(e))return!1;var t=i(e);if(null===t)return!0;var n=l.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==u}},function(e,t,n){var r=n(198),i=n(109);e.exports=function(e,t){for(var n=0,o=(t=r(t,e)).length;null!=e&&n<o;)e=e[i(t[n++])];return n&&n==o?e:void 0}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}},,,function(e,t,n){var r=n(139),i=n(729),o=Object.prototype.hasOwnProperty,s=i((function(e,t,n){o.call(e,n)?e[n].push(t):r(e,n,[t])}));e.exports=s},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));const r="go-to-url",i="toggle-storage-option"},function(e,t,n){var r=n(139),i=n(125),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var s=e[t];o.call(e,t)&&i(s,n)&&(void 0!==n||t in e)||r(e,t,n)}},function(e,t,n){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,s,a=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var l in n=Object(arguments[c]))i.call(n,l)&&(a[l]=n[l]);if(r){s=r(n);for(var u=0;u<s.length;u++)o.call(n,s[u])&&(a[s[u]]=n[s[u]])}}return a}},,,function(e,t,n){var r=n(356);e.exports=function(e){return(null==e?0:e.length)?r(e,1):[]}},,,,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));const r="@UpdateNotif-has_been_read_1",i="@last_update_time_stamp",o="https://feedback.memex.garden/changelog"},,function(e,t,n){var r=n(363),i=n(365);e.exports=function(e,t,n){return r(i,e,t,n)}},function(e,t,n){var r=n(151),i=n(175),o=n(219),s=n(261),a=n(425),c=n(283),l=n(124),u=n(428),d=n(430),h=n(267),f=n(329),p=n(119),g=n(434),m=n(435),y=n(285),v=n(41),b=n(150),_=n(439),w=n(48),T=n(441),E=n(116),A=n(126),S="[object Arguments]",O="[object Function]",I="[object Object]",C={};C[S]=C["[object Array]"]=C["[object ArrayBuffer]"]=C["[object DataView]"]=C["[object Boolean]"]=C["[object Date]"]=C["[object Float32Array]"]=C["[object Float64Array]"]=C["[object Int8Array]"]=C["[object Int16Array]"]=C["[object Int32Array]"]=C["[object Map]"]=C["[object Number]"]=C[I]=C["[object RegExp]"]=C["[object Set]"]=C["[object String]"]=C["[object Symbol]"]=C["[object Uint8Array]"]=C["[object Uint8ClampedArray]"]=C["[object Uint16Array]"]=C["[object Uint32Array]"]=!0,C["[object Error]"]=C[O]=C["[object WeakMap]"]=!1,e.exports=function e(t,n,k,P,x,R){var L,D=1&n,N=2&n,j=4&n;if(k&&(L=x?k(t,P,x,R):k(t)),void 0!==L)return L;if(!w(t))return t;var M=v(t);if(M){if(L=g(t),!D)return l(t,L)}else{var F=p(t),U=F==O||"[object GeneratorFunction]"==F;if(b(t))return c(t,D);if(F==I||F==S||U&&!x){if(L=N||U?{}:y(t),!D)return N?d(t,a(L,t)):u(t,s(L,t))}else{if(!C[F])return x?t:{};L=m(t,F,D)}}R||(R=new r);var B=R.get(t);if(B)return B;R.set(t,L),T(t)?t.forEach((function(r){L.add(e(r,n,k,r,t,R))})):_(t)&&t.forEach((function(r,i){L.set(i,e(r,n,k,i,t,R))}));var G=M?void 0:(j?N?f:h:N?A:E)(t);return i(G||t,(function(r,i){G&&(r=t[i=r]),o(L,i,e(r,n,k,i,t,R))})),L}},function(e,t,n){var r=n(448),i=n(50);e.exports=function e(t,n,o,s,a){return t===n||(null==t||null==n||!i(t)&&!i(n)?t!=t&&n!=n:r(t,n,o,s,e,a))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));const r="/get_timestamps",i="/set_timestamps"},function(e,t,n){var r=n(394);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},function(e,t,n){(function(t){var r=n(333),i="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};function o(e){return void 0===e}function s(e){return"[object Object]"===Object.prototype.toString.call(e)}function a(e){return"[object String]"===Object.prototype.toString.call(e)}function c(e){return"[object Array]"===Object.prototype.toString.call(e)}function l(){if(!("fetch"in i))return!1;try{return new Headers,new Request(""),new Response,!0}catch(e){return!1}}function u(e,t){var n,r;if(o(e.length))for(n in e)h(e,n)&&t.call(null,n,e[n]);else if(r=e.length)for(n=0;n<r;n++)t.call(null,n,e[n])}function d(e,t){if("number"!=typeof t)throw new Error("2nd argument to `truncate` function should be a number");return"string"!=typeof e||0===t||e.length<=t?e:e.substr(0,t)+"\u2026"}function h(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function f(e){for(var t,n=[],r=0,i=e.length;r<i;r++)a(t=e[r])?n.push(t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")):t&&t.source&&n.push(t.source);return new RegExp(n.join("|"),"i")}function p(e){var t,n,r,i,o,s=[];if(!e||!e.tagName)return"";if(s.push(e.tagName.toLowerCase()),e.id&&s.push("#"+e.id),(t=e.className)&&a(t))for(n=t.split(/\s+/),o=0;o<n.length;o++)s.push("."+n[o]);var c=["type","name","title","alt"];for(o=0;o<c.length;o++)r=c[o],(i=e.getAttribute(r))&&s.push("["+r+'="'+i+'"]');return s.join("")}function g(e,t){return!!(!!e^!!t)}function m(e,t){if(g(e,t))return!1;var n,r,i=e.frames,o=t.frames;if(void 0===i||void 0===o)return!1;if(i.length!==o.length)return!1;for(var s=0;s<i.length;s++)if(n=i[s],r=o[s],n.filename!==r.filename||n.lineno!==r.lineno||n.colno!==r.colno||n.function!==r.function)return!1;return!0}function y(e){return function(e){return~-encodeURI(e).split(/%..|./).length}(JSON.stringify(e))}function v(e){if("string"==typeof e){return d(e,40)}if("number"==typeof e||"boolean"==typeof e||void 0===e)return e;var t=Object.prototype.toString.call(e);return"[object Object]"===t?"[Object]":"[object Array]"===t?"[Array]":"[object Function]"===t?e.name?"[Function: "+e.name+"]":"[Function]":e}function b(e,t){return 0===t?v(e):s(e)?Object.keys(e).reduce((function(n,r){return n[r]=b(e[r],t-1),n}),{}):Array.isArray(e)?e.map((function(e){return b(e,t-1)})):v(e)}e.exports={isObject:function(e){return"object"==typeof e&&null!==e},isError:function(e){switch(Object.prototype.toString.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return e instanceof Error}},isErrorEvent:function(e){return"[object ErrorEvent]"===Object.prototype.toString.call(e)},isDOMError:function(e){return"[object DOMError]"===Object.prototype.toString.call(e)},isDOMException:function(e){return"[object DOMException]"===Object.prototype.toString.call(e)},isUndefined:o,isFunction:function(e){return"function"==typeof e},isPlainObject:s,isString:a,isArray:c,isEmptyObject:function(e){if(!s(e))return!1;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},supportsErrorEvent:function(){try{return new ErrorEvent(""),!0}catch(e){return!1}},supportsDOMError:function(){try{return new DOMError(""),!0}catch(e){return!1}},supportsDOMException:function(){try{return new DOMException(""),!0}catch(e){return!1}},supportsFetch:l,supportsReferrerPolicy:function(){if(!l())return!1;try{return new Request("pickleRick",{referrerPolicy:"origin"}),!0}catch(e){return!1}},supportsPromiseRejectionEvent:function(){return"function"==typeof PromiseRejectionEvent},wrappedCallback:function(e){return function(t,n){var r=e(t)||t;return n&&n(r)||r}},each:u,objectMerge:function(e,t){return t?(u(t,(function(t,n){e[t]=n})),e):e},truncate:d,objectFrozen:function(e){return!!Object.isFrozen&&Object.isFrozen(e)},hasKey:h,joinRegExp:f,urlencode:function(e){var t=[];return u(e,(function(e,n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))})),t.join("&")},uuid4:function(){var e=i.crypto||i.msCrypto;if(!o(e)&&e.getRandomValues){var t=new Uint16Array(8);e.getRandomValues(t),t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;var n=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return n(t[0])+n(t[1])+n(t[2])+n(t[3])+n(t[4])+n(t[5])+n(t[6])+n(t[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},htmlTreeAsString:function(e){for(var t,n=[],r=0,i=0;e&&r++<5&&!("html"===(t=p(e))||r>1&&i+3*n.length+t.length>=80);)n.push(t),i+=t.length,e=e.parentNode;return n.reverse().join(" > ")},htmlElementAsString:p,isSameException:function(e,t){return!g(e,t)&&(e=e.values[0],t=t.values[0],e.type===t.type&&e.value===t.value&&(n=e.stacktrace,r=t.stacktrace,(!o(n)||!o(r))&&m(e.stacktrace,t.stacktrace)));var n,r},isSameStacktrace:m,parseUrl:function(e){if("string"!=typeof e)return{};var t=e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/),n=t[6]||"",r=t[8]||"";return{protocol:t[2],host:t[4],path:t[5],relative:t[5]+n+r}},fill:function(e,t,n,r){if(null!=e){var i=e[t];e[t]=n(i),e[t].__raven__=!0,e[t].__orig__=i,r&&r.push([e,t,i])}},safeJoin:function(e,t){if(!c(e))return"";for(var n=[],r=0;r<e.length;r++)try{n.push(String(e[r]))}catch(e){n.push("[value cannot be serialized]")}return n.join(t)},serializeException:function e(t,n,i){if(!s(t))return t;i="number"!=typeof(n="number"!=typeof n?3:n)?51200:i;var o=b(t,n);return y(r(o))>i?e(t,n-1):o},serializeKeysForMessage:function(e,t){if("number"==typeof e||"string"==typeof e)return e.toString();if(!Array.isArray(e))return"";if(0===(e=e.filter((function(e){return"string"==typeof e}))).length)return"[object has no keys]";if(t="number"!=typeof t?40:t,e[0].length>=t)return e[0];for(var n=e.length;n>0;n--){var r=e.slice(0,n).join(", ");if(!(r.length>t))return n===e.length?r:r+"\u2026"}return""},sanitize:function(e,t){if(!c(t)||c(t)&&0===t.length)return e;var n,i=f(t);try{n=JSON.parse(r(e))}catch(t){return e}return function e(t){return c(t)?t.map((function(t){return e(t)})):s(t)?Object.keys(t).reduce((function(n,r){return i.test(r)?n[r]="********":n[r]=e(t[r]),n}),{}):t}(n)}}}).call(this,n(61))},function(e,t,n){var r,i,o=n(357),s=n(358),a=0,c=0;e.exports=function(e,t,n){var l=t&&n||0,u=t||[],d=(e=e||{}).node||r,h=void 0!==e.clockseq?e.clockseq:i;if(null==d||null==h){var f=o();null==d&&(d=r=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==h&&(h=i=16383&(f[6]<<8|f[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),g=void 0!==e.nsecs?e.nsecs:c+1,m=p-a+(g-c)/1e4;if(m<0&&void 0===e.clockseq&&(h=h+1&16383),(m<0||p>a)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=p,c=g,i=h;var y=(1e4*(268435455&(p+=122192928e5))+g)%4294967296;u[l++]=y>>>24&255,u[l++]=y>>>16&255,u[l++]=y>>>8&255,u[l++]=255&y;var v=p/4294967296*1e4&268435455;u[l++]=v>>>8&255,u[l++]=255&v,u[l++]=v>>>24&15|16,u[l++]=v>>>16&255,u[l++]=h>>>8|128,u[l++]=255&h;for(var b=0;b<6;++b)u[l+b]=d[b];return t||s(u)}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return _})),n.d(t,"c",(function(){return w})),n.d(t,"b",(function(){return T}));var r=n(359),i=n.n(r);const o=[{base:"A",letters:"A\u24b6\uff21\xc0\xc1\xc2\u1ea6\u1ea4\u1eaa\u1ea8\xc3\u0100\u0102\u1eb0\u1eae\u1eb4\u1eb2\u0226\u01e0\xc4\u01de\u1ea2\xc5\u01fa\u01cd\u0200\u0202\u1ea0\u1eac\u1eb6\u1e00\u0104\u023a\u2c6f"},{base:"AA",letters:"\ua732"},{base:"AE",letters:"\xc6\u01fc\u01e2"},{base:"AO",letters:"\ua734"},{base:"AU",letters:"\ua736"},{base:"AV",letters:"\ua738\ua73a"},{base:"AY",letters:"\ua73c"},{base:"B",letters:"B\u24b7\uff22\u1e02\u1e04\u1e06\u0243\u0182\u0181"},{base:"C",letters:"C\u24b8\uff23\u0106\u0108\u010a\u010c\xc7\u1e08\u0187\u023b\ua73e"},{base:"D",letters:"D\u24b9\uff24\u1e0a\u010e\u1e0c\u1e10\u1e12\u1e0e\u0110\u018b\u018a\u0189\ua779\xd0"},{base:"DZ",letters:"\u01f1\u01c4"},{base:"Dz",letters:"\u01f2\u01c5"},{base:"E",letters:"E\u24ba\uff25\xc8\xc9\xca\u1ec0\u1ebe\u1ec4\u1ec2\u1ebc\u0112\u1e14\u1e16\u0114\u0116\xcb\u1eba\u011a\u0204\u0206\u1eb8\u1ec6\u0228\u1e1c\u0118\u1e18\u1e1a\u0190\u018e"},{base:"F",letters:"F\u24bb\uff26\u1e1e\u0191\ua77b"},{base:"G",letters:"G\u24bc\uff27\u01f4\u011c\u1e20\u011e\u0120\u01e6\u0122\u01e4\u0193\ua7a0\ua77d\ua77e"},{base:"H",letters:"H\u24bd\uff28\u0124\u1e22\u1e26\u021e\u1e24\u1e28\u1e2a\u0126\u2c67\u2c75\ua78d"},{base:"I",letters:"I\u24be\uff29\xcc\xcd\xce\u0128\u012a\u012c\u0130\xcf\u1e2e\u1ec8\u01cf\u0208\u020a\u1eca\u012e\u1e2c\u0197"},{base:"J",letters:"J\u24bf\uff2a\u0134\u0248"},{base:"K",letters:"K\u24c0\uff2b\u1e30\u01e8\u1e32\u0136\u1e34\u0198\u2c69\ua740\ua742\ua744\ua7a2"},{base:"L",letters:"L\u24c1\uff2c\u013f\u0139\u013d\u1e36\u1e38\u013b\u1e3c\u1e3a\u0141\u023d\u2c62\u2c60\ua748\ua746\ua780"},{base:"LJ",letters:"\u01c7"},{base:"Lj",letters:"\u01c8"},{base:"M",letters:"M\u24c2\uff2d\u1e3e\u1e40\u1e42\u2c6e\u019c"},{base:"N",letters:"N\u24c3\uff2e\u01f8\u0143\xd1\u1e44\u0147\u1e46\u0145\u1e4a\u1e48\u0220\u019d\ua790\ua7a4"},{base:"NJ",letters:"\u01ca"},{base:"Nj",letters:"\u01cb"},{base:"O",letters:"O\u24c4\uff2f\xd2\xd3\xd4\u1ed2\u1ed0\u1ed6\u1ed4\xd5\u1e4c\u022c\u1e4e\u014c\u1e50\u1e52\u014e\u022e\u0230\xd6\u022a\u1ece\u0150\u01d1\u020c\u020e\u01a0\u1edc\u1eda\u1ee0\u1ede\u1ee2\u1ecc\u1ed8\u01ea\u01ec\xd8\u01fe\u0186\u019f\ua74a\ua74c"},{base:"OI",letters:"\u01a2"},{base:"OO",letters:"\ua74e"},{base:"OU",letters:"\u0222"},{base:"OE",letters:"\x8c\u0152"},{base:"oe",letters:"\x9c\u0153"},{base:"P",letters:"P\u24c5\uff30\u1e54\u1e56\u01a4\u2c63\ua750\ua752\ua754"},{base:"Q",letters:"Q\u24c6\uff31\ua756\ua758\u024a"},{base:"R",letters:"R\u24c7\uff32\u0154\u1e58\u0158\u0210\u0212\u1e5a\u1e5c\u0156\u1e5e\u024c\u2c64\ua75a\ua7a6\ua782"},{base:"S",letters:"S\u24c8\uff33\u1e9e\u015a\u1e64\u015c\u1e60\u0160\u1e66\u1e62\u1e68\u0218\u015e\u2c7e\ua7a8\ua784"},{base:"T",letters:"T\u24c9\uff34\u1e6a\u0164\u1e6c\u021a\u0162\u1e70\u1e6e\u0166\u01ac\u01ae\u023e\ua786"},{base:"TZ",letters:"\ua728"},{base:"U",letters:"U\u24ca\uff35\xd9\xda\xdb\u0168\u1e78\u016a\u1e7a\u016c\xdc\u01db\u01d7\u01d5\u01d9\u1ee6\u016e\u0170\u01d3\u0214\u0216\u01af\u1eea\u1ee8\u1eee\u1eec\u1ef0\u1ee4\u1e72\u0172\u1e76\u1e74\u0244"},{base:"V",letters:"V\u24cb\uff36\u1e7c\u1e7e\u01b2\ua75e\u0245"},{base:"VY",letters:"\ua760"},{base:"W",letters:"W\u24cc\uff37\u1e80\u1e82\u0174\u1e86\u1e84\u1e88\u2c72"},{base:"X",letters:"X\u24cd\uff38\u1e8a\u1e8c"},{base:"Y",letters:"Y\u24ce\uff39\u1ef2\xdd\u0176\u1ef8\u0232\u1e8e\u0178\u1ef6\u1ef4\u01b3\u024e\u1efe"},{base:"Z",letters:"Z\u24cf\uff3a\u0179\u1e90\u017b\u017d\u1e92\u1e94\u01b5\u0224\u2c7f\u2c6b\ua762"},{base:"a",letters:"a\u24d0\uff41\u1e9a\xe0\xe1\xe2\u1ea7\u1ea5\u1eab\u1ea9\xe3\u0101\u0103\u1eb1\u1eaf\u1eb5\u1eb3\u0227\u01e1\xe4\u01df\u1ea3\xe5\u01fb\u01ce\u0201\u0203\u1ea1\u1ead\u1eb7\u1e01\u0105\u2c65\u0250"},{base:"aa",letters:"\ua733"},{base:"ae",letters:"\xe6\u01fd\u01e3"},{base:"ao",letters:"\ua735"},{base:"au",letters:"\ua737"},{base:"av",letters:"\ua739\ua73b"},{base:"ay",letters:"\ua73d"},{base:"b",letters:"b\u24d1\uff42\u1e03\u1e05\u1e07\u0180\u0183\u0253"},{base:"c",letters:"c\u24d2\uff43\u0107\u0109\u010b\u010d\xe7\u1e09\u0188\u023c\ua73f\u2184"},{base:"d",letters:"d\u24d3\uff44\u1e0b\u010f\u1e0d\u1e11\u1e13\u1e0f\u0111\u018c\u0256\u0257\ua77a"},{base:"dz",letters:"\u01f3\u01c6"},{base:"e",letters:"e\u24d4\uff45\xe8\xe9\xea\u1ec1\u1ebf\u1ec5\u1ec3\u1ebd\u0113\u1e15\u1e17\u0115\u0117\xeb\u1ebb\u011b\u0205\u0207\u1eb9\u1ec7\u0229\u1e1d\u0119\u1e19\u1e1b\u0247\u025b\u01dd"},{base:"f",letters:"f\u24d5\uff46\u1e1f\u0192\ua77c"},{base:"g",letters:"g\u24d6\uff47\u01f5\u011d\u1e21\u011f\u0121\u01e7\u0123\u01e5\u0260\ua7a1\u1d79\ua77f"},{base:"h",letters:"h\u24d7\uff48\u0125\u1e23\u1e27\u021f\u1e25\u1e29\u1e2b\u1e96\u0127\u2c68\u2c76\u0265"},{base:"hv",letters:"\u0195"},{base:"i",letters:"i\u24d8\uff49\xec\xed\xee\u0129\u012b\u012d\xef\u1e2f\u1ec9\u01d0\u0209\u020b\u1ecb\u012f\u1e2d\u0268\u0131"},{base:"j",letters:"j\u24d9\uff4a\u0135\u01f0\u0249"},{base:"k",letters:"k\u24da\uff4b\u1e31\u01e9\u1e33\u0137\u1e35\u0199\u2c6a\ua741\ua743\ua745\ua7a3"},{base:"l",letters:"l\u24db\uff4c\u0140\u013a\u013e\u1e37\u1e39\u013c\u1e3d\u1e3b\u017f\u0142\u019a\u026b\u2c61\ua749\ua781\ua747"},{base:"lj",letters:"\u01c9"},{base:"m",letters:"m\u24dc\uff4d\u1e3f\u1e41\u1e43\u0271\u026f"},{base:"n",letters:"n\u24dd\uff4e\u01f9\u0144\xf1\u1e45\u0148\u1e47\u0146\u1e4b\u1e49\u019e\u0272\u0149\ua791\ua7a5"},{base:"nj",letters:"\u01cc"},{base:"o",letters:"o\u24de\uff4f\xf2\xf3\xf4\u1ed3\u1ed1\u1ed7\u1ed5\xf5\u1e4d\u022d\u1e4f\u014d\u1e51\u1e53\u014f\u022f\u0231\xf6\u022b\u1ecf\u0151\u01d2\u020d\u020f\u01a1\u1edd\u1edb\u1ee1\u1edf\u1ee3\u1ecd\u1ed9\u01eb\u01ed\xf8\u01ff\u0254\ua74b\ua74d\u0275"},{base:"oi",letters:"\u01a3"},{base:"ou",letters:"\u0223"},{base:"oo",letters:"\ua74f"},{base:"p",letters:"p\u24df\uff50\u1e55\u1e57\u01a5\u1d7d\ua751\ua753\ua755"},{base:"q",letters:"q\u24e0\uff51\u024b\ua757\ua759"},{base:"r",letters:"r\u24e1\uff52\u0155\u1e59\u0159\u0211\u0213\u1e5b\u1e5d\u0157\u1e5f\u024d\u027d\ua75b\ua7a7\ua783"},{base:"s",letters:"s\u24e2\uff53\xdf\u015b\u1e65\u015d\u1e61\u0161\u1e67\u1e63\u1e69\u0219\u015f\u023f\ua7a9\ua785\u1e9b"},{base:"t",letters:"t\u24e3\uff54\u1e6b\u1e97\u0165\u1e6d\u021b\u0163\u1e71\u1e6f\u0167\u01ad\u0288\u2c66\ua787"},{base:"tz",letters:"\ua729"},{base:"u",letters:"u\u24e4\uff55\xf9\xfa\xfb\u0169\u1e79\u016b\u1e7b\u016d\xfc\u01dc\u01d8\u01d6\u01da\u1ee7\u016f\u0171\u01d4\u0215\u0217\u01b0\u1eeb\u1ee9\u1eef\u1eed\u1ef1\u1ee5\u1e73\u0173\u1e77\u1e75\u0289"},{base:"v",letters:"v\u24e5\uff56\u1e7d\u1e7f\u028b\ua75f\u028c"},{base:"vy",letters:"\ua761"},{base:"w",letters:"w\u24e6\uff57\u1e81\u1e83\u0175\u1e87\u1e85\u1e98\u1e89\u2c73"},{base:"x",letters:"x\u24e7\uff58\u1e8b\u1e8d"},{base:"y",letters:"y\u24e8\uff59\u1ef3\xfd\u0177\u1ef9\u0233\u1e8f\xff\u1ef7\u1e99\u1ef5\u01b4\u024f\u1eff"},{base:"z",letters:"z\u24e9\uff5a\u017a\u1e91\u017c\u017e\u1e93\u1e95\u01b6\u0225\u0240\u2c6c\ua763"}],s={};for(let e=0;e<o.length;e++){const t=o[e].letters;for(let n=0;n<t.length;n++)s[t[n]]=o[e].base}const a=n(187).a,c=/\s+/g,l=/[\u2000-\u206F\u2E00-\u2E7F\\!"#$%&()*+,./:;<=>?[\]^_`{|}~\xab\xbb\u3002\uff08\uff09\u3147\xa9\xba\xf8\xb0]/gi,u=/['\u2019]/g,d=/(\w+)-(\w+)/g,h=/\s+-\s+/g,f=/\b(\d{1,3}|\d{5,})\b/gi,p=i()(),g=(e="")=>e.replace(c," ").trim(),m=(e="")=>[...new Set(e.split(a))].join(" "),y=(e="")=>e.replace(u,""),v=(e="")=>{const t=e.match(d);if(null==t)return e.replace(h," ");return`${e} ${t.map((e=>e.split("-"))).reduce(((e,t)=>[...e,...t])).join(" ")}`.replace(h," ")},b=(e="")=>e.replace(/[^\u0000-\u007E]/g,(function(e){return s[e]||e}));function _(e){const t=e.match(/[\u4E00-\u9FFF\u3040-\u309F\u30A0-\u30FF\uAC00-\uD7AF\u3000-\u303F]+/g);if(!t)return e;let n="",r=0;return t.forEach(((t,i)=>{const o=e.indexOf(t,r);n+=e.substring(r,o),o>0&&" "!==e[o-1]&&(n+=" "),/[\u4E00-\u9FFF\u3040-\u309F\u30A0-\u30FF\uAC00-\uD7AF]+/.test(t)?n+=[...t].join(" "):n+=t;const s=e[o+t.length],a=/[\u4E00-\u9FFF\u3040-\u309F\u30A0-\u30FF\uAC00-\uD7AF\u3000-\u303F]/.test(s);s&&!a&&" "!==s&&(n+=" "),r=o+t.length})),n+=e.substring(r),n}const w=(e,{lang:t="en-US"}={})=>{if(!e.trim().length)return{text:e,lenAfter:0,lenBefore:0};let n=e.toLocaleLowerCase.call(e,t);return n=((e="")=>e.replace(p," "))(n),n=y(n),n=v(n),n=n.replace(h," "),n=b(n),n=((e="")=>e.replace(l," "))(n),n=m(n),n=((e="")=>e.replace(f," "))(n),n=((e="")=>e.split(" ").filter((e=>1!==e.length||/[\u4E00-\u9FFF\u3040-\u309F\u30A0-\u30FF\uAC00-\uD7AF\u3000-\u303F]+/g.test(e))).join(" "))(n),n=_(n),n=g(n),{text:n,lenBefore:e.length,lenAfter:n.length}},T=e=>{if(!e.trim().length)return{text:e,lenAfter:0,lenBefore:0};let t=e.toLocaleLowerCase();return t=y(t),t=v(t),t=b(t),t=m(t),t=g(t),{text:t,lenBefore:e.length,lenAfter:t.length}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));const r="/upload-pdf",i="/retrieve-pdf"},,function(e,t,n){var r=n(140),i=n(246),o=i?function(e,t){return i.set(e,t),e}:r;e.exports=o},function(e,t,n){var r=n(247),i=r&&new r;e.exports=i},function(e,t,n){var r=n(87)(n(40),"WeakMap");e.exports=r},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(61))},function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t,n){var r=n(251),i=n(252),o=n(375),s=n(141),a=n(253),c=n(260),l=n(391),u=n(176),d=n(40);e.exports=function e(t,n,h,f,p,g,m,y,v,b){var _=128&n,w=1&n,T=2&n,E=24&n,A=512&n,S=T?void 0:s(t);return function O(){for(var I=arguments.length,C=Array(I),k=I;k--;)C[k]=arguments[k];if(E)var P=c(O),x=o(C,P);if(f&&(C=r(C,f,p,E)),g&&(C=i(C,g,m,E)),I-=x,E&&I<b){var R=u(C,P);return a(t,n,e,O.placeholder,h,C,R,y,v,b-I)}var L=w?h:this,D=T?L[t]:t;return I=C.length,y?C=l(C,y):A&&I>1&&C.reverse(),_&&v<I&&(C.length=v),this&&this!==d&&this instanceof O&&(D=S||s(D)),D.apply(L,C)}}},function(e,t){var n=Math.max;e.exports=function(e,t,r,i){for(var o=-1,s=e.length,a=r.length,c=-1,l=t.length,u=n(s-a,0),d=Array(l+u),h=!i;++c<l;)d[c]=t[c];for(;++o<a;)(h||o<s)&&(d[r[o]]=e[o]);for(;u--;)d[c++]=e[o++];return d}},function(e,t){var n=Math.max;e.exports=function(e,t,r,i){for(var o=-1,s=e.length,a=-1,c=r.length,l=-1,u=t.length,d=n(s-c,0),h=Array(d+u),f=!i;++o<d;)h[o]=e[o];for(var p=o;++l<u;)h[p+l]=t[l];for(;++a<c;)(f||o<s)&&(h[p+r[a]]=e[o++]);return h}},function(e,t,n){var r=n(376),i=n(256),o=n(258);e.exports=function(e,t,n,s,a,c,l,u,d,h){var f=8&t;t|=f?32:64,4&(t&=~(f?64:32))||(t&=-4);var p=[e,t,a,f?c:void 0,f?l:void 0,f?void 0:c,f?void 0:l,u,d,h],g=n.apply(void 0,p);return r(e)&&i(g,p),g.placeholder=s,o(g,e,t)}},function(e,t,n){var r=n(246),i=n(345),o=r?function(e){return r.get(e)}:i;e.exports=o},function(e,t,n){var r=n(142),i=n(173);function o(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}o.prototype=r(i.prototype),o.prototype.constructor=o,e.exports=o},function(e,t,n){var r=n(245),i=n(257)(r);e.exports=i},function(e,t){var n=Date.now;e.exports=function(e){var t=0,r=0;return function(){var i=n(),o=16-(i-r);if(r=i,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,n){var r=n(381),i=n(382),o=n(174),s=n(385);e.exports=function(e,t,n){var a=t+"";return o(e,i(a,s(r(a),n)))}},function(e,t,n){var r=n(87),i=function(){try{var e=r(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},function(e,t){e.exports=function(e){return e.placeholder}},function(e,t,n){var r=n(118),i=n(116);e.exports=function(e,t){return e&&r(t,i(t),e)}},function(e,t,n){var r=n(397),i=n(149),o=n(41),s=n(150),a=n(138),c=n(190),l=Object.prototype.hasOwnProperty;e.exports=function(e,t){var n=o(e),u=!n&&i(e),d=!n&&!u&&s(e),h=!n&&!u&&!d&&c(e),f=n||u||d||h,p=f?r(e.length,String):[],g=p.length;for(var m in e)!t&&!l.call(e,m)||f&&("length"==m||d&&("offset"==m||"parent"==m)||h&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||a(m,g))||p.push(m);return p}},function(e,t,n){var r=n(179),i=n(401),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return i(e);var t=[];for(var n in Object(e))o.call(e,n)&&"constructor"!=n&&t.push(n);return t}},function(e,t){e.exports=function(e,t){return function(n){return e(t(n))}}},function(e,t){e.exports=function(){return[]}},function(e,t,n){var r=n(183),i=n(184),o=n(182),s=n(265),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)r(t,o(e)),e=i(e);return t}:s;e.exports=a},function(e,t,n){var r=n(268),i=n(182),o=n(116);e.exports=function(e){return r(e,o,i)}},function(e,t,n){var r=n(183),i=n(41);e.exports=function(e,t,n){var o=t(e);return i(e)?o:r(o,n(e))}},function(e,t,n){var r=n(40).Uint8Array;e.exports=r},function(e,t,n){var r=n(449),i=n(452),o=n(453);e.exports=function(e,t,n,s,a,c){var l=1&n,u=e.length,d=t.length;if(u!=d&&!(l&&d>u))return!1;var h=c.get(e),f=c.get(t);if(h&&f)return h==t&&f==e;var p=-1,g=!0,m=2&n?new r:void 0;for(c.set(e,t),c.set(t,e);++p<u;){var y=e[p],v=t[p];if(s)var b=l?s(v,y,p,t,e,c):s(y,v,p,e,t,c);if(void 0!==b){if(b)continue;g=!1;break}if(m){if(!i(t,(function(e,t){if(!o(m,t)&&(y===e||a(y,e,n,s,c)))return m.push(t)}))){g=!1;break}}else if(y!==v&&!a(y,v,n,s,c)){g=!1;break}}return c.delete(e),c.delete(t),g}},function(e,t,n){var r=n(48);e.exports=function(e){return e==e&&!r(e)}},function(e,t){e.exports=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}},function(e,t,n){var r=n(460),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,s=r((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(i,(function(e,n,r,i){t.push(r?i.replace(o,"$1"):n||e)})),t}));e.exports=s},function(e,t,n){var r=n(171),i=Math.max;e.exports=function(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var o=arguments,s=-1,a=i(o.length-t,0),c=Array(a);++s<a;)c[s]=o[t+s];s=-1;for(var l=Array(t+1);++s<t;)l[s]=o[s];return l[t]=n(c),r(e,this,l)}}},function(e,t,n){var r=n(139),i=n(332),o=n(193);e.exports=function(e,t){var n={};return t=o(t,3),i(e,(function(e,i,o){r(n,i,t(e,i,o))})),n}},,function(e,t,n){var r=n(232)("mapValues",n(275));r.placeholder=n(164),e.exports=r},,,,function(e,t,n){const{makeUrlAbsolute:r,parseUrl:i}=n(902);function o(e){return e.replace(/www[a-zA-Z0-9]*\./,"").replace(".co.",".").split(".").slice(0,-1).join(" ")}function s(e){return(t,n)=>{let r,i=0;for(let n=0;n<e.rules.length;n++){const[o,s]=e.rules[n],a=Array.from(t.querySelectorAll(o));if(a.length)for(const t of a){let o=e.rules.length-n;if(e.scorers)for(const n of e.scorers){const e=n(t,o);e&&(o=e)}o>i&&(i=o,r=s(t))}}if(!r&&e.defaultValue&&(r=e.defaultValue(n)),r){if(e.processors)for(const t of e.processors)r=t(r,n);return r.trim&&(r=r.trim()),r}}}const a={description:{rules:[['meta[property="og:description"]',e=>e.getAttribute("content")],['meta[name="description" i]',e=>e.getAttribute("content")]]},icon:{rules:[['link[rel="apple-touch-icon"]',e=>e.getAttribute("href")],['link[rel="apple-touch-icon-precomposed"]',e=>e.getAttribute("href")],['link[rel="icon" i]',e=>e.getAttribute("href")],['link[rel="fluid-icon"]',e=>e.getAttribute("href")],['link[rel="shortcut icon"]',e=>e.getAttribute("href")],['link[rel="Shortcut Icon"]',e=>e.getAttribute("href")],['link[rel="mask-icon"]',e=>e.getAttribute("href")]],scorers:[(e,t)=>{const n=e.getAttribute("sizes");if(n){const e=n.match(/\d+/g);if(e)return e[0]}}],defaultValue:e=>"favicon.ico",processors:[(e,t)=>r(t.url,e)]},image:{rules:[['meta[property="og:image:secure_url"]',e=>e.getAttribute("content")],['meta[property="og:image:url"]',e=>e.getAttribute("content")],['meta[property="og:image"]',e=>e.getAttribute("content")],['meta[name="twitter:image"]',e=>e.getAttribute("content")],['meta[property="twitter:image"]',e=>e.getAttribute("content")],['meta[name="thumbnail"]',e=>e.getAttribute("content")]],processors:[(e,t)=>r(t.url,e)]},keywords:{rules:[['meta[name="keywords" i]',e=>e.getAttribute("content")]],processors:[(e,t)=>e.split(",").map((e=>e.trim()))]},title:{rules:[['meta[property="og:title"]',e=>e.getAttribute("content")],['meta[name="twitter:title"]',e=>e.getAttribute("content")],['meta[property="twitter:title"]',e=>e.getAttribute("content")],['meta[name="hdl"]',e=>e.getAttribute("content")],["title",e=>e.text]]},language:{rules:[["html[lang]",e=>e.getAttribute("lang")],['meta[name="language" i]',e=>e.getAttribute("content")]],processors:[(e,t)=>e.split("-")[0]]},type:{rules:[['meta[property="og:type"]',e=>e.getAttribute("content")]]},url:{rules:[["a.amp-canurl",e=>e.getAttribute("href")],['link[rel="canonical"]',e=>e.getAttribute("href")],['meta[property="og:url"]',e=>e.getAttribute("content")]],defaultValue:e=>e.url,processors:[(e,t)=>r(t.url,e)]},provider:{rules:[['meta[property="og:site_name"]',e=>e.getAttribute("content")]],defaultValue:e=>o(i(e.url))}};e.exports={buildRuleSet:s,getMetadata:function(e,t,n){const r={},i={url:t},o=n||a;return Object.keys(o).map((t=>{const n=s(o[t]);r[t]=n(e,i)})),r},getProvider:o,metadataRuleSets:a}},function(e,t,n){"use strict";n.d(t,"a",(function(){return N})),n.d(t,"b",(function(){return G})),n.d(t,"c",(function(){return w})),n.d(t,"d",(function(){return pe})),n.d(t,"e",(function(){return ge})),n.d(t,"f",(function(){return Ee})),n.d(t,"g",(function(){return M})),n.d(t,"h",(function(){return Qe})),n.d(t,"i",(function(){return m})),n.d(t,"j",(function(){return v})),n.d(t,"k",(function(){return Je})),n.d(t,"l",(function(){return Ke})),n.d(t,"m",(function(){return Ve})),n.d(t,"n",(function(){return He})),n.d(t,"o",(function(){return Xe})),n.d(t,"p",(function(){return We})),n.d(t,"q",(function(){return ze})),n.d(t,"r",(function(){return Ye})),n.d(t,"s",(function(){return $e})),n.d(t,"t",(function(){return Be})),n.d(t,"u",(function(){return qe})),n.d(t,"v",(function(){return Ge}));var r=n(74),i=n(30),o=n(201);const s="firebasestorage.googleapis.com",a="storageBucket";class c extends i.FirebaseError{constructor(e,t,n=0){super(d(e),`Firebase Storage: ${t} (${d(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,c.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return d(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}var l,u;function d(e){return"storage/"+e}function h(){return new c(l.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function f(){return new c(l.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function p(){return new c(l.CANCELED,"User canceled the upload/download.")}function g(){return new c(l.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function m(e){return new c(l.INVALID_ARGUMENT,e)}function y(){return new c(l.APP_DELETED,"The Firebase app was deleted.")}function v(e){return new c(l.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function b(e,t){return new c(l.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function _(e){throw new c(l.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(l||(l={}));class w{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=w.makeFromUrl(e,t)}catch(t){return new w(e,"")}if(""===n.path)return n;throw r=e,new c(l.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const i=new RegExp("^gs://"+r+"(/(.*))?$","i");function o(e){e.path_=decodeURIComponent(e.path)}const a=t.replace(/[.]/g,"\\."),u=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${a}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:o},{regex:new RegExp(`^https?://${t===s?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:o}];for(let t=0;t<u.length;t++){const r=u[t],i=r.regex.exec(e);if(i){const e=i[r.indices.bucket];let t=i[r.indices.path];t||(t=""),n=new w(e,t),r.postModify(n);break}}if(null==n)throw function(e){return new c(l.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class T{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function E(e){return"string"==typeof e||e instanceof String}function A(e){return S()&&e instanceof Blob}function S(){return"undefined"!=typeof Blob}function O(e,t,n,r){if(r<t)throw m(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw m(`Invalid value for '${e}'. Expected ${n} or less.`)}function I(e,t,n){let r=t;return null==n&&(r=`https://${t}`),`${n}://${r}/v0${e}`}function C(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}function k(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||r||i}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(u||(u={}));class P{constructor(e,t,n,r,i,o,s,a,c,l,u,d=!0){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=s,this.errorCallback_=a,this.timeout_=c,this.progressCallback_=l,this.connectionFactory_=u,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=(e,t)=>{if(t)return void e(!1,new x(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===u.NO_ERROR,i=n.getStatus();if(!t||k(i,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===u.ABORT;return void e(!1,new x(!1,null,t))}const o=-1!==this.successCodes_.indexOf(i);e(!0,new x(o,n))}))},t=(e,t)=>{const n=this.resolve_,r=this.reject_,i=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(i,i.getResponse());void 0!==e?n(e):n()}catch(e){r(e)}else if(null!==i){const e=h();e.serverResponse=i.getErrorText(),this.errorCallback_?r(this.errorCallback_(i,e)):r(e)}else if(t.canceled){r(this.appDelete_?y():p())}else{r(f())}};this.canceled_?t(0,new x(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,i=null,o=null,s=!1,a=0;function c(){return 2===a}let l=!1;function u(...e){l||(l=!0,t.apply(null,e))}function d(t){i=setTimeout((()=>{i=null,e(f,c())}),t)}function h(){o&&clearTimeout(o)}function f(e,...t){if(l)return void h();if(e)return h(),void u.call(null,e,...t);if(c()||s)return h(),void u.call(null,e,...t);let n;r<64&&(r*=2),1===a?(a=2,n=0):n=1e3*(r+Math.random()),d(n)}let p=!1;function g(e){p||(p=!0,h(),l||(null!==i?(e||(a=2),clearTimeout(i),d(0)):e||(a=1)))}return d(0),o=setTimeout((()=>{s=!0,g(!0)}),n),g}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class x{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function R(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function L(...e){const t=R();if(void 0!==t){const n=new t;for(let t=0;t<e.length;t++)n.append(e[t]);return n.getBlob()}if(S())return new Blob(e);throw new c(l.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function D(e){if("undefined"==typeof atob)throw t="base-64",new c(l.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`);var t;return atob(e)}const N={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class j{constructor(e,t){this.data=e,this.contentType=t||null}}function M(e,t){switch(e){case N.RAW:return new j(F(t));case N.BASE64:case N.BASE64URL:return new j(U(e,t));case N.DATA_URL:return new j(function(e){const t=new B(e);return t.base64?U(N.BASE64,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(e){throw b(N.DATA_URL,"Malformed data URL.")}return F(t)}(t.rest)}(t),new B(t).contentType)}throw h()}function F(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296==(64512&r)){if(n<e.length-1&&56320==(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function U(e,t){switch(e){case N.BASE64:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw b(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case N.BASE64URL:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw b(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=D(t)}catch(t){if(t.message.includes("polyfill"))throw t;throw b(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);return r}class B{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw b(N.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}class G{constructor(e,t){let n=0,r="";A(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(A(this.data_)){const n=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,e,t);return null===n?null:new G(n)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new G(n,!0)}}static getBlob(...e){if(S()){const t=e.map((e=>e instanceof G?e.data_:e));return new G(L.apply(null,t))}{const t=e.map((e=>E(e)?M(N.RAW,e).data:e.data_));let n=0;t.forEach((e=>{n+=e.byteLength}));const r=new Uint8Array(n);let i=0;return t.forEach((e=>{for(let t=0;t<e.length;t++)r[i++]=e[t]})),new G(r,!0)}}uploadData(){return this.data_}}function q(e){let t;try{t=JSON.parse(e)}catch(e){return null}return"object"!=typeof(n=t)||Array.isArray(n)?null:t;var n}function H(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function $(e,t){return t}class W{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||$}}let z=null;function V(){if(z)return z;const e=[];e.push(new W("bucket")),e.push(new W("generation")),e.push(new W("metageneration")),e.push(new W("name","fullPath",!0));const t=new W("name");t.xform=function(e,t){return function(e){return!E(e)||e.length<2?e:H(e)}(t)},e.push(t);const n=new W("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new W("timeCreated")),e.push(new W("updated")),e.push(new W("md5Hash",null,!0)),e.push(new W("cacheControl",null,!0)),e.push(new W("contentDisposition",null,!0)),e.push(new W("contentEncoding",null,!0)),e.push(new W("contentLanguage",null,!0)),e.push(new W("contentType",null,!0)),e.push(new W("metadata","customMetadata",!0)),z=e,z}function K(e,t,n){const r={type:"file"},i=n.length;for(let e=0;e<i;e++){const i=n[e];r[i.local]=i.xform(r,t[i.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,i=new w(n,r);return t._makeStorageReference(i)}})}(r,e),r}function Y(e,t,n){const r=q(t);if(null===r)return null;return K(e,r,n)}function Q(e,t){const n={},r=t.length;for(let i=0;i<r;i++){const r=t[i];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}const X="prefixes",J="items";function Z(e,t,n){const r=q(n);if(null===r)return null;return function(e,t,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[X])for(const i of n[X]){const n=i.replace(/\/$/,""),o=e._makeStorageReference(new w(t,n));r.prefixes.push(o)}if(n[J])for(const i of n[J]){const n=e._makeStorageReference(new w(t,i.name));r.items.push(n)}return r}(e,t,r)}class ee{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function te(e){if(!e)throw h()}function ne(e,t){return function(n,r){const i=Y(e,r,t);return te(null!==i),i}}function re(e,t){return function(n,r){const i=Y(e,r,t);return te(null!==i),function(e,t,n,r){const i=q(t);if(null===i)return null;if(!E(i.downloadTokens))return null;const o=i.downloadTokens;if(0===o.length)return null;const s=encodeURIComponent;return o.split(",").map((t=>{const i=e.bucket,o=e.fullPath;return I("/b/"+s(i)+"/o/"+s(o),n,r)+C({alt:"media",token:t})}))[0]}(i,r,e.host,e._protocol)}}function ie(e){return function(t,n){let r;var i,o;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new c(l.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new c(l.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(o=e.bucket,r=new c(l.QUOTA_EXCEEDED,"Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(i=e.path,r=new c(l.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function oe(e){const t=ie(e);return function(n,r){let i=t(n,r);var o;return 404===n.getStatus()&&(o=e.path,i=new c(l.OBJECT_NOT_FOUND,"Object '"+o+"' does not exist.")),i.serverResponse=r.serverResponse,i}}function se(e,t,n){const r=I(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,o=new ee(r,"GET",ne(e,n),i);return o.errorHandler=oe(t),o}function ae(e,t,n,r,i){const o={};t.isRoot?o.prefix="":o.prefix=t.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),i&&(o.maxResults=i);const s=I(t.bucketOnlyServerUrl(),e.host,e._protocol),a=e.maxOperationRetryTime,c=new ee(s,"GET",function(e,t){return function(n,r){const i=Z(e,t,r);return te(null!==i),i}}(e,t.bucket),a);return c.urlParams=o,c.errorHandler=ie(t),c}function ce(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}function le(e,t,n,r,i){const o=t.bucketOnlyServerUrl(),s={"X-Goog-Upload-Protocol":"multipart"};const a=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();s["Content-Type"]="multipart/related; boundary="+a;const c=ce(t,r,i),l="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Q(c,n)+"\r\n--"+a+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",u="\r\n--"+a+"--",d=G.getBlob(l,r,u);if(null===d)throw g();const h={name:c.fullPath},f=I(o,e.host,e._protocol),p=e.maxUploadRetryTime,m=new ee(f,"POST",ne(e,n),p);return m.urlParams=h,m.headers=s,m.body=d.uploadData(),m.errorHandler=ie(t),m}class ue{constructor(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null}}function de(e,t){let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(e){te(!1)}return te(!!n&&-1!==(t||["active"]).indexOf(n)),n}const he=262144;function fe(e,t,n,r,i,o,s,a){const u=new ue(0,0);if(s?(u.current=s.current,u.total=s.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new c(l.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");const d=u.total-u.current;let h=d;i>0&&(h=Math.min(h,i));const f=u.current,p=f+h;let m="";m=0===h?"finalize":d===h?"upload, finalize":"upload";const y={"X-Goog-Upload-Command":m,"X-Goog-Upload-Offset":`${u.current}`},v=r.slice(f,p);if(null===v)throw g();const b=t.maxUploadRetryTime,_=new ee(n,"POST",(function(e,n){const i=de(e,["active","final"]),s=u.current+h,a=r.size();let c;return c="final"===i?ne(t,o)(e,n):null,new ue(s,a,"final"===i,c)}),b);return _.headers=y,_.body=v.uploadData(),_.progressCallback=a||null,_.errorHandler=ie(e),_}const pe={STATE_CHANGED:"state_changed"},ge={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function me(e){switch(e){case"running":case"pausing":case"canceling":return ge.RUNNING;case"paused":return ge.PAUSED;case"success":return ge.SUCCESS;case"canceled":return ge.CANCELED;default:return ge.ERROR}}class ye{constructor(e,t,n){if("function"==typeof e||null!=t||null!=n)this.next=e,this.error=null!=t?t:void 0,this.complete=null!=n?n:void 0;else{const t=e;this.next=t.next,this.error=t.error,this.complete=t.complete}}}function ve(e){return(...t)=>{Promise.resolve().then((()=>e(...t)))}}let be=null;class _e{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=u.NO_ERROR,this.sendPromise_=new Promise((e=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=u.ABORT,e()})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=u.NETWORK_ERROR,e()})),this.xhr_.addEventListener("load",(()=>{e()}))}))}send(e,t,n,r){if(this.sent_)throw _("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const e in r)r.hasOwnProperty(e)&&this.xhr_.setRequestHeader(e,r[e].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw _("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw _("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw _("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw _("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class we extends _e{initXhr(){this.xhr_.responseType="text"}}function Te(){return be?be():new we}class Ee{constructor(e,t,n=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=V(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=e=>{if(this._request=void 0,this._chunkMultiplier=1,e._codeEquals(l.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const t=this.isExponentialBackoffExpired();if(k(e.status,[])){if(!t)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();e=f()}this._error=e,this._transition("error")}},this._metadataErrorHandler=e=>{this._request=void 0,e._codeEquals(l.CANCELED)?this.completeTransitions_():(this._error=e,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t,this._start()})),this._promise.then(null,(()=>{}))}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout((()=>{this.pendingTimeout=void 0,this._continueUpload()}),this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((([t,n])=>{switch(this._state){case"running":e(t,n);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}}))}_createResumable(){this._resolveToken(((e,t)=>{const n=function(e,t,n,r,i){const o=t.bucketOnlyServerUrl(),s=ce(t,r,i),a={name:s.fullPath},c=I(o,e.host,e._protocol),l={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":s.contentType,"Content-Type":"application/json; charset=utf-8"},u=Q(s,n),d=e.maxUploadRetryTime,h=new ee(c,"POST",(function(e){let t;de(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(e){te(!1)}return te(E(t)),t}),d);return h.urlParams=a,h.headers=l,h.body=u,h.errorHandler=ie(t),h}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,Te,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._uploadUrl=e,this._needToFetchStatus=!1,this.completeTransitions_()}),this._errorHandler)}))}_fetchStatus(){const e=this._uploadUrl;this._resolveToken(((t,n)=>{const r=function(e,t,n,r){const i=e.maxUploadRetryTime,o=new ee(n,"POST",(function(e){const t=de(e,["active","final"]);let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){te(!1)}n||te(!1);const i=Number(n);return te(!isNaN(i)),new ue(i,r.size(),"final"===t)}),i);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=ie(t),o}(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(r,Te,t,n);this._request=i,i.getPromise().then((e=>{this._request=void 0,this._updateProgress(e.current),this._needToFetchStatus=!1,e.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()}),this._errorHandler)}))}_continueUpload(){const e=he*this._chunkMultiplier,t=new ue(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken(((r,i)=>{let o;try{o=fe(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(e){return this._error=e,void this._transition("error")}const s=this._ref.storage._makeRequest(o,Te,r,i,!1);this._request=s,s.getPromise().then((e=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(e.current),e.finalized?(this._metadata=e.metadata,this._transition("success")):this.completeTransitions_()}),this._errorHandler)}))}_increaseMultiplier(){2*(he*this._chunkMultiplier)<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken(((e,t)=>{const n=se(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(n,Te,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._transition("success")}),this._metadataErrorHandler)}))}_oneShotUpload(){this._resolveToken(((e,t)=>{const n=le(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,Te,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._updateProgress(this._blob.size()),this._transition("success")}),this._errorHandler)}))}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=p(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=me(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,n,r){const i=new ye(t||void 0,n||void 0,r||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise();this._observers.slice().forEach((e=>{this._notifyObserver(e)}))}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(me(this._state)){case ge.SUCCESS:ve(this._resolve.bind(null,this.snapshot))();break;case ge.CANCELED:case ge.ERROR:ve(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(me(this._state)){case ge.RUNNING:case ge.PAUSED:e.next&&ve(e.next.bind(e,this.snapshot))();break;case ge.SUCCESS:e.complete&&ve(e.complete.bind(e))();break;case ge.CANCELED:case ge.ERROR:default:e.error&&ve(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class Ae{constructor(e,t){this._service=e,this._location=t instanceof w?t:w.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Ae(e,t)}get root(){const e=new w(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return H(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new w(this._location.bucket,e);return new Ae(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw v(e)}}function Se(e,t,n){e._throwIfRoot("uploadBytes");const r=le(e.storage,e._location,V(),new G(t,!0),n);return e.storage.makeRequestWithTokens(r,Te).then((t=>({metadata:t,ref:e})))}function Oe(e){const t={prefixes:[],items:[]};return Ie(e,t).then((()=>t))}async function Ie(e,t,n){const r={pageToken:n},i=await Ce(e,r);t.prefixes.push(...i.prefixes),t.items.push(...i.items),null!=i.nextPageToken&&await Ie(e,t,i.nextPageToken)}function Ce(e,t){null!=t&&"number"==typeof t.maxResults&&O("options.maxResults",1,1e3,t.maxResults);const n=t||{},r=ae(e.storage,e._location,"/",n.pageToken,n.maxResults);return e.storage.makeRequestWithTokens(r,Te)}function ke(e,t){e._throwIfRoot("updateMetadata");const n=function(e,t,n,r){const i=I(t.fullServerUrl(),e.host,e._protocol),o=Q(n,r),s=e.maxOperationRetryTime,a=new ee(i,"PATCH",ne(e,r),s);return a.headers={"Content-Type":"application/json; charset=utf-8"},a.body=o,a.errorHandler=oe(t),a}(e.storage,e._location,t,V());return e.storage.makeRequestWithTokens(n,Te)}function Pe(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const r=I(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,o=new ee(r,"GET",re(e,n),i);return o.errorHandler=oe(t),o}(e.storage,e._location,V());return e.storage.makeRequestWithTokens(t,Te).then((e=>{if(null===e)throw new c(l.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e}))}function xe(e){e._throwIfRoot("deleteObject");const t=function(e,t){const n=I(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime,i=new ee(n,"DELETE",(function(e,t){}),r);return i.successCodes=[200,204],i.errorHandler=oe(t),i}(e.storage,e._location);return e.storage.makeRequestWithTokens(t,Te)}function Re(e,t){const n=function(e,t){const n=t.split("/").filter((e=>e.length>0)).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new w(e._location.bucket,n);return new Ae(e.storage,r)}function Le(e,t){if(e instanceof je){const n=e;if(null==n._bucket)throw new c(l.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+a+"' property when initializing the app?");const r=new Ae(n,n._bucket);return null!=t?Le(r,t):r}return void 0!==t?Re(e,t):e}function De(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof je)return new Ae(e,t);throw m("To use ref(service, url), the first argument must be a Storage instance.")}return Le(e,t)}function Ne(e,t){const n=null==t?void 0:t[a];return null==n?null:w.makeFromBucketSpec(n,e)}class je{constructor(e,t,n,r,i){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=s,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?w.makeFromBucketSpec(r,this._host):Ne(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=w.makeFromBucketSpec(this._url,e):this._bucket=Ne(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){O("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){O("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ae(this,e)}_makeRequest(e,t,n,r,i=!0){if(this._deleted)return new T(y());{const o=function(e,t,n,r,i,o,s=!0){const a=C(e.urlParams),c=e.url+a,l=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(l,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(l,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(l,o),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(l,r),new P(c,e.method,l,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,s)}(e,this._appId,n,r,t,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then((()=>this._requests.delete(o)),(()=>this._requests.delete(o))),o}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const Me="@firebase/storage",Fe="0.12.4",Ue="storage";function Be(e,t,n){return Se(e=Object(i.getModularInstance)(e),t,n)}function Ge(e,t,n,r){return function(e,t,n=N.RAW,r){e._throwIfRoot("uploadString");const i=M(n,t),o=Object.assign({},r);return null==o.contentType&&null!=i.contentType&&(o.contentType=i.contentType),Se(e,i.data,o)}(e=Object(i.getModularInstance)(e),t,n,r)}function qe(e,t,n){return function(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new Ee(e,new G(t),n)}(e=Object(i.getModularInstance)(e),t,n)}function He(e){return function(e){e._throwIfRoot("getMetadata");const t=se(e.storage,e._location,V());return e.storage.makeRequestWithTokens(t,Te)}(e=Object(i.getModularInstance)(e))}function $e(e,t){return ke(e=Object(i.getModularInstance)(e),t)}function We(e,t){return Ce(e=Object(i.getModularInstance)(e),t)}function ze(e){return Oe(e=Object(i.getModularInstance)(e))}function Ve(e){return Pe(e=Object(i.getModularInstance)(e))}function Ke(e){return xe(e=Object(i.getModularInstance)(e))}function Ye(e,t){return De(e=Object(i.getModularInstance)(e),t)}function Qe(e,t){return Re(e,t)}function Xe(e=Object(r.getApp)(),t){e=Object(i.getModularInstance)(e);const n=Object(r._getProvider)(e,Ue).getImmediate({identifier:t}),o=Object(i.getDefaultEmulatorHostnameAndPort)("storage");return o&&Je(n,...o),n}function Je(e,t,n,r={}){!function(e,t,n,r={}){e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:o}=r;o&&(e._overrideAuthToken="string"==typeof o?o:Object(i.createMockUserToken)(o,e.app.options.projectId))}(e,t,n,r)}function Ze(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return new je(n,i,o,t,r.SDK_VERSION)}Object(r._registerComponent)(new o.Component(Ue,Ze,"PUBLIC").setMultipleInstances(!0)),Object(r.registerVersion)(Me,Fe,""),Object(r.registerVersion)(Me,Fe,"esm2017")},function(e,t,n){(function(e){var r=n(40),i=t&&!t.nodeType&&t,o=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=o&&o.exports===i?r.Buffer:void 0,a=s?s.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=a?a(n):new e.constructor(n);return e.copy(r),r}}).call(this,n(111)(e))},function(e,t,n){var r=n(185);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},function(e,t,n){var r=n(142),i=n(184),o=n(179);e.exports=function(e){return"function"!=typeof e.constructor||o(e)?{}:r(i(e))}},function(e,t,n){var r=n(471)();e.exports=r},function(e,t,n){"use strict";(function(e){var r=n(782),i=n(783),o=n(784);function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return l(this,e,t,n)}function l(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=h(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n);e=a(e,r);var i=e.write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|f(t.length);return 0===(e=a(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?a(e,0):h(e,t);if("Buffer"===t.type&&o(t.data))return h(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(u(t),e=a(e,t<0?0:0|f(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|f(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function f(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return q(e).length;default:if(r)return G(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,n);case"utf8":case"utf-8":return O(this,t,n);case"ascii":return C(this,t,n);case"latin1":case"binary":return k(this,t,n);case"base64":return S(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function y(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:v(e,t,n,r,i);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,r,i){var o,s=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,n/=2}function l(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var u=-1;for(o=n;o<a;o++)if(l(e,o)===l(t,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===c)return u*s}else-1!==u&&(o-=o-u),u=-1}else for(n+c>a&&(n=a-c),o=n;o>=0;o--){for(var d=!0,h=0;h<c;h++)if(l(e,o+h)!==l(t,h)){d=!1;break}if(d)return o}return-1}function b(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function _(e,t,n,r){return H(G(t,e.length-n),e,n,r)}function w(e,t,n,r){return H(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function T(e,t,n,r){return w(e,t,n,r)}function E(e,t,n,r){return H(q(t),e,n,r)}function A(e,t,n,r){return H(function(e,t){for(var n,r,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)r=(n=e.charCodeAt(s))>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function S(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function O(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,s,a,c,l=e[i],u=null,d=l>239?4:l>223?3:l>191?2:1;if(i+d<=n)switch(d){case 1:l<128&&(u=l);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&l)<<6|63&o)>127&&(u=c);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(c=(15&l)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(c=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(u=c)}null===u?(u=65533,d=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=d}return function(e){var t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=I));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return l(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return u(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return d(null,e)},c.allocUnsafeSlow=function(e){return d(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?O(this,0,e):g.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,i){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(t>>>=0),a=Math.min(o,s),l=this.slice(r,i),u=e.slice(t,n),d=0;d<a;++d)if(l[d]!==u[d]){o=l[d],s=u[d];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return T(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function C(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function k(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function P(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=B(e[o]);return i}function x(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function R(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,n,r,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function D(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function N(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function j(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function M(e,t,n,r,o){return o||j(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function F(e,t,n,r,o){return o||j(e,0,n,8),i.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var i=t-e;n=new c(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},c.prototype.readUInt8=function(e,t){return t||R(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||R(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||R(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||R(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||R(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||L(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||L(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):N(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);L(this,e,t,n,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s|0)-a&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);L(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s|0)-a&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):N(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return M(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return M(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return F(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return F(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=c.isBuffer(e)?e:G(new c(e,r).toString()),a=s.length;for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function G(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function q(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(U,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function H(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(61))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>e[t].bind(e)},function(e,t,n){var r=n(395),i=n(48),o=n(115),s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=a.test(e);return n||c.test(e)?l(e.slice(2),n?2:8):s.test(e)?NaN:+e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(29),i=n(320);function o(e){return("production"===e.env?r.b.production:r.b.staging)+i.a+"?id="+e.id}},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return a})),n.d(t,"g",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return h})),n.d(t,"h",(function(){return f}));var r=n(2),i=n(569);const o=n(1067);n(1170);function s(e,t,n={}){const r={};n.generatePlaceholder=n.generatePlaceholder||(()=>{let e=0;return()=>++e})();const s=(e,a,c={},l=[])=>{const u=t.collections[e];if(!u)throw new Error(`Unknown collection: ${e}`);const d=o(((e,t)=>!u.reverseRelationshipsByAlias[t]),a),h=n.generatePlaceholder();r[h]=d;const f=[{placeholder:h,collection:e,path:l,object:d,relations:c}];for(const e in u.reverseRelationshipsByAlias){let t=a[e];if(!t)continue;const n=u.reverseRelationshipsByAlias[e];if(Object(i.c)(n)){n.single&&(t=[t]);let r=0;for(const i of t){const t=[e];n.single||(t.push(r),r+=1),f.push(...s(n.sourceCollection,i,{[n.alias]:h},[...l,...t]))}}else{if(!Object(i.d)(n))throw new Error("Sorry, but I have no idea what kind of relationship you're trying to create");if(a[e])throw new Error("Sorry, creating connects relationships through put is not supported yet  :(")}}return f};return{objects:s(e.collection,e.args)}}function a(e){const t=[];for(const n of e.objects)t.push({operation:"createObject",collection:n.collection,placeholder:n.placeholder.toString(),args:n.object,replace:Object.entries(n.relations).map((([e,t])=>({path:e,placeholder:t.toString()})))});return t}function c(e,t,n){for(const n of t.slice(0,-1))e=e[n];e[t.slice(-1)[0]]=n}function l(e,t,n){const r=n.collections[t].pkIndex;if("string"==typeof r)return e[r];if(Object(i.e)(r))throw new Error("Getting object PKs of objects with relationships as PKs is not supported yet");const o=[];for(const t of r){if("string"!=typeof t)throw new Error("getObject() called with relationship as pk, which is not supported yet.");o.push(e[t])}return o}function u(e,t,n){e=Object.assign({},e);const r=n.collections[t].pkIndex;if("string"==typeof r)return delete e[r],e;if(Object(i.e)(r))throw new Error("Getting objects without PKs of objects with relationships as PKs is not supported yet");for(const t of r){if("string"!=typeof t)throw new Error("getObject() called with relationship as pk, which is not supported yet.");delete e[t]}return e}function d(e,t,n){const r=e=>"object"==typeof e&&"relationship"in e?e.relationship:e,i=e.collections[t].pkIndex,o={};if(i instanceof Array)for(let e=0;e<i.length;e++){o[r(i[e])]=n[e]}else o[r(i)]=n;return o}function h(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=d(e.registry,t,n);return e.operation("findObject",t,r)}))}function f(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=null!==(t=e.executeOperation)&&void 0!==t?t:(...t)=>e.storageManager.operation(...t),i=e.where&&(yield e.executeOperation("findObject",e.collection,e.where));if(i){const t=l(i,e.collection,e.storageManager.registry),n=d(e.storageManager.registry,e.collection,t);return yield r("updateObject",e.collection,n,Object.assign(Object.assign({},e.where),e.updates)),{opPerformed:"update"}}return yield r("createObject",e.collection,Object.assign(Object.assign({},null!==(n=e.where)&&void 0!==n?n:{}),e.updates)),{opPerformed:"create"}}))}},function(e,t,n){n(23).ParsedComponents;var r=n(112).Refiner,i=new RegExp("^\\s*(T|at|after|before|on|of|,|-)?\\s*$"),o=t.isDateOnly=function(e){return!e.start.isCertain("hour")},s=t.isTimeOnly=function(e){return!e.start.isCertain("month")&&!e.start.isCertain("weekday")},a=t.isAbleToMerge=function(e,t,n){return e.substring(t.index+t.text.length,n.index).match(i)},c=t.mergeDateTimeComponent=function(e,t){var n=e.clone();return t.isCertain("hour")?(n.assign("hour",t.get("hour")),n.assign("minute",t.get("minute")),n.assign("second",t.get("second"))):(n.imply("hour",t.get("hour")),n.imply("minute",t.get("minute")),n.imply("second",t.get("second"))),t.isCertain("meridiem")?n.assign("meridiem",t.get("meridiem")):void 0!==t.get("meridiem")&&void 0===n.get("meridiem")&&n.imply("meridiem",t.get("meridiem")),1==n.get("meridiem")&&n.get("hour")<12&&(t.isCertain("hour")?n.assign("hour",n.get("hour")+12):n.imply("hour",n.get("hour")+12)),n};function l(e,t,n){var r=t.start,i=n.start,o=c(r,i);if(null!=t.end||null!=n.end){var s=null==t.end?t.start:t.end,a=null==n.end?n.start:n.end,l=c(s,a);null==t.end&&l.date().getTime()<o.date().getTime()&&(l.isCertain("day")?l.assign("day",l.get("day")+1):l.imply("day",l.get("day")+1)),t.end=l}t.start=o;var u=Math.min(t.index,n.index),d=Math.max(t.index+t.text.length,n.index+n.text.length);for(var h in t.index=u,t.text=e.substring(u,d),n.tags)t.tags[h]=!0;return t.tags.ENMergeDateAndTimeRefiner=!0,t}t.Refiner=function(){r.call(this),this.refine=function(e,t,n){if(t.length<2)return t;for(var r=[],i=null,c=null,u=1;u<t.length;u++)i=t[u],c=t[u-1],o(c)&&s(i)&&a(e,c,i)?(c=l(e,c,i),i=t[u+1],u+=1):o(i)&&s(c)&&a(e,c,i)&&(c=l(e,i,c),i=t[u+1],u+=1),r.push(c);return null!=i&&r.push(i),r}}},,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),i=n(242),o=n(163),s=n(510);const a=(e,t)=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){var n,r,a,c,l,u;const d=[];let h=!1,f=0,p=0;const g=yield e.getMetadata(),m=yield e.getDownloadInfo(),y=e.numPages;let v="";for(null==(null===(n=null==g?void 0:g.metadata)||void 0===n?void 0:n.getAll().Title)&&(v=yield Object(s.a)(e)),f=0;f<y;++f){const t=yield e.getPage(f+1),n=(yield t.getTextContent()).items.map((e=>e.str)).join(" ");if(p+=n.length,p>o.c){h=!0;break}d.push(n)}const{text:b}=Object(i.c)(d.join(" "),{});return{pdfMetadata:{memexTotalPages:e.numPages,memexIncludedPages:f,memexDocumentBytes:null!==(r=null==m?void 0:m.length)&&void 0!==r?r:null,memexOutline:null!==(a=yield e.getOutline())&&void 0!==a?a:null,documentInformationDict:null!==(c=null==g?void 0:g.info)&&void 0!==c?c:null,metadataMap:null!==(u=null===(l=null==g?void 0:g.metadata)||void 0===l?void 0:l.getAll())&&void 0!==u?u:null,fingerprints:e.fingerprints?e.fingerprints:[e.fingerprint]},pdfPageTexts:d,fullText:t?d.join(" "):b,author:g.info.Author,title:g.info.Title||v,keywords:g.info.Keywords}}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return s}));var r=n(710),i=n(62);n.d(t,"b",(function(){return i.a}));const o={0:{version:new Date("2021-06-24")}},s=[...r.a]},function(e,t,n){"use strict";var r=n(326);t.a=r.a},,function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.hasChildren=t.isDocument=t.isComment=t.isText=t.isCDATA=t.isTag=void 0,i(n(597),t),i(n(793),t),i(n(794),t),i(n(603),t),i(n(604),t),i(n(795),t),i(n(796),t);var o=n(155);Object.defineProperty(t,"isTag",{enumerable:!0,get:function(){return o.isTag}}),Object.defineProperty(t,"isCDATA",{enumerable:!0,get:function(){return o.isCDATA}}),Object.defineProperty(t,"isText",{enumerable:!0,get:function(){return o.isText}}),Object.defineProperty(t,"isComment",{enumerable:!0,get:function(){return o.isComment}}),Object.defineProperty(t,"isDocument",{enumerable:!0,get:function(){return o.isDocument}}),Object.defineProperty(t,"hasChildren",{enumerable:!0,get:function(){return o.hasChildren}})},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));const r="/images/upload",i="/images/get"},function(e,t,n){"use strict";n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return v.a})),n.d(t,"d",(function(){return v.c})),n.d(t,"c",(function(){return v.b})),n.d(t,"e",(function(){return v.d}));var r=n(2),i=n(53),o=n(708),s=n(1158),a=n.n(s);class c{prepareForStorage(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return e}))}prepareFromStorage(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return e}))}}const l=a.a||s;class u extends c{constructor(){super(...arguments),this.primitiveType="string",this.length=20}prepareForStorage(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return e||(yield this.generateCode())}))}generateCode(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield new Promise(((e,t)=>{l(this.length,((n,r)=>n?t(n):e(r)))}))).toString("hex")}))}}class d extends c{constructor(){super(...arguments),this.primitiveType="string"}}class h{constructor(){this.fieldTypes={}}registerType(e,t){return this.fieldTypes[e]=t,this}registerTypes(e){return Object.assign(this.fieldTypes,e),this}}const f=n(56),p=n(889),g=n(1170);class m extends i.EventEmitter{constructor({fieldTypes:e}={}){super(),this.collections={},this._collectionsByVersion={},this._collectionVersionMap={},this.fieldTypes=e||new h}registerCollection(e,t){t instanceof Array||(t=[t]),t.sort(((e,t)=>e.version.getTime()-t.version.getTime())).forEach((t=>{this.collections[e]=t,t.name=e,t.indices=t.indices||[],this._preprocessFieldTypes(t),this._preprocessCollectionRelationships(e,t),this._preprocessCollectionIndices(e,t),this._autoAssignCollectionPk(t);const n=t.version.getTime();this._collectionsByVersion[n]=this._collectionsByVersion[n]||[],this._collectionsByVersion[n].push(t),this._collectionVersionMap[n]=this._collectionVersionMap[n]||{},this._collectionVersionMap[n][e]=t})),this.emit("registered-collection",{collection:this.collections[e]})}registerCollections(e){for(const[t,n]of Object.entries(e))this.registerCollection(t,n)}finishInitialization(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this._connectReverseRelationships(),Promise.all(this.listeners("initialized").map((e=>e.call(this)))).then((()=>{}))}))}get collectionVersionMap(){return this._deprecationWarning("StorageRegistry.collectionVersionMap is deprecated, use StorageRegistry.getCollectionsByVersion() instead"),this._collectionVersionMap}getCollectionsByVersion(e){const t={};for(const n of Object.values(this.collectionVersionMap))for(const[r,i]of Object.entries(n)){const n=t[r];(!n||i.version.getTime()>n.version.getTime())&&i.version.getTime()<=e.getTime()&&(t[r]=i)}return t}get collectionsByVersion(){return this._deprecationWarning("StorageRegistry.collectionsByVersion is deprecated, use StorageRegistry.getSchemaHistory() instead"),this._collectionsByVersion}getSchemaHistory(){const e=Object.entries(this._collectionsByVersion);return p(e,(([e])=>parseInt(e))).map((([e,t])=>{const n=f(t.map((e=>[e.name,e])));return{version:new Date(parseInt(e)),collections:n}}))}_preprocessFieldTypes(e){e.fieldsWithCustomType=[];const t=e.fields;Object.entries(t).forEach((([t,n])=>{const r=this.fieldTypes.fieldTypes[n.type];r&&(n.fieldObject=new r,e.fieldsWithCustomType.push(t))}))}_preprocessCollectionIndices(e,t){const n=(n,r)=>{"string"==typeof n&&((n,r)=>{if(!t.fields[n]){if(t.relationshipsByAlias[n])return;throw new Error(`Flagging field ${n} of collection ${e} as index, but field does not exist`)}t.fields[n]._index=r})(n,r)};(t.indices||[]).forEach(((e,t)=>{const{field:r}=e;r instanceof Array?r.forEach((e=>{n(e,t)})):n(r,t)}))}_autoAssignCollectionPk(e){const t=e.indices||[];t.forEach((({field:t,pk:n},r)=>{n&&(e.pkIndex=t)})),e.pkIndex||(t.unshift({field:"id",pk:!0}),e.pkIndex="id"),"string"!=typeof e.pkIndex||e.fields[e.pkIndex]||e.relationshipsByAlias[e.pkIndex]||(e.fields[e.pkIndex]={type:"auto-pk"})}_preprocessCollectionRelationships(e,t){t.relationships=t.relationships||[],t.relationshipsByAlias={},t.reverseRelationshipsByAlias={};for(const n of t.relationships)if(Object(o.c)(n))n.aliases=n.aliases||n.connects,n.fieldNames=n.fieldNames||[`${n.aliases[0]}Rel`,`${n.aliases[1]}Rel`],n.reverseAliases=n.reverseAliases||[g(n.connects[1]),g(n.connects[0])];else{if(!Object(o.b)(n))throw new Error("Invalid relationship detected: "+JSON.stringify(n));n.sourceCollection=e,n.targetCollection=Object(o.a)(n),n.single=!!n.singleChildOf,n.alias=n.alias||n.targetCollection,t.relationshipsByAlias[n.alias]=n,n.reverseAlias||(n.reverseAlias=n.single?e:g(e)),n.fieldName=n.fieldName||`${n.alias}Rel`}}_connectReverseRelationships(){Object.values(this.collections).forEach((e=>{for(const t of e.relationships)if(Object(o.c)(t)){const n=[this.collections[t.connects[0]],this.collections[t.connects[1]]];for(let r=0;r<n.length;++r)if(!n[r])throw new Error(`Collection '${e.name}' defined a 'connects' relation involving non-existing collection '${t.connects[r]}`);n[0].reverseRelationshipsByAlias[t.reverseAliases[0]]=t,n[1].reverseRelationshipsByAlias[t.reverseAliases[1]]=t}else if(Object(o.b)(t)){const n=this.collections[t.targetCollection];if(!n){const n=t.single?"singleChildOf":"childOf";throw new Error(`Collection '${e.name}' defined a '${n}' relationship to non-existing collection '${t.targetCollection}`)}n.reverseRelationshipsByAlias[t.reverseAlias]=t}}))}_deprecationWarning(e){console.warn(`DEPRECATED: ${e}`)}}var y=n(767),v=n(569);const b=n(56),_={findOneObject:"findObject",findAllObjects:"findObjects",updateOneObject:"updateObject",updateAllObject:"updateObjects",deleteOneObject:"deleteObject",deleteAllObjects:"deleteObjects"};class w{constructor({backend:e,fieldTypes:t}){this._middleware=[],this.registry=new m({fieldTypes:t||(new h).registerTypes({"random-key":u,url:d})}),this.backend=e,this.backend.configure({registry:this.registry})}setMiddleware(e){this._middleware=e,this._middleware.reverse()}finishInitialization(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.registry.finishInitialization()}))}collection(e){const t=t=>(...n)=>this.operation(t,e,...n);return b([...Array.from(y.a).map((e=>[e,t(e)])),...Object.entries(_).map((([e,n])=>[e,t(n)]))])}operation(e,...t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let n={process:({operation:e})=>this.backend.operation(e[0],...e.slice(1))},i={};for(const e of this._middleware)n=((e,t)=>({process:n=>Object(r.__awaiter)(this,void 0,void 0,(function*(){i=Object.assign(Object.assign({},i),n.extraData||{});return yield t.process(Object.assign(Object.assign({},n),{extraData:i,next:e}))}))}))(n,e);return n.process({operation:[e,...t],extraData:i})}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i,o=n(2),s=[];t.LogLevel=void 0,(i=t.LogLevel||(t.LogLevel={}))[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT";var a={debug:t.LogLevel.DEBUG,verbose:t.LogLevel.VERBOSE,info:t.LogLevel.INFO,warn:t.LogLevel.WARN,error:t.LogLevel.ERROR,silent:t.LogLevel.SILENT},c=t.LogLevel.INFO,l=((r={})[t.LogLevel.DEBUG]="log",r[t.LogLevel.VERBOSE]="log",r[t.LogLevel.INFO]="info",r[t.LogLevel.WARN]="warn",r[t.LogLevel.ERROR]="error",r),u=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var i=(new Date).toISOString(),s=l[t];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));console[s].apply(console,o.__spreadArray(["[".concat(i,"]  ").concat(e.name,":")],n,!1))}},d=function(){function e(e){this.name=e,this._logLevel=c,this._logHandler=u,this._userLogHandler=null,s.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in t.LogLevel))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?a[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,o.__spreadArray([this,t.LogLevel.DEBUG],e,!1)),this._logHandler.apply(this,o.__spreadArray([this,t.LogLevel.DEBUG],e,!1))},e.prototype.log=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,o.__spreadArray([this,t.LogLevel.VERBOSE],e,!1)),this._logHandler.apply(this,o.__spreadArray([this,t.LogLevel.VERBOSE],e,!1))},e.prototype.info=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,o.__spreadArray([this,t.LogLevel.INFO],e,!1)),this._logHandler.apply(this,o.__spreadArray([this,t.LogLevel.INFO],e,!1))},e.prototype.warn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,o.__spreadArray([this,t.LogLevel.WARN],e,!1)),this._logHandler.apply(this,o.__spreadArray([this,t.LogLevel.WARN],e,!1))},e.prototype.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,o.__spreadArray([this,t.LogLevel.ERROR],e,!1)),this._logHandler.apply(this,o.__spreadArray([this,t.LogLevel.ERROR],e,!1))},e}();t.Logger=d,t.setLogLevel=function(e){s.forEach((function(t){t.setLogLevel(e)}))},t.setUserLogHandler=function(e,n){for(var r=function(r){var i=null;n&&n.level&&(i=a[n.level]),r.userLogHandler=null===e?null:function(n,r){for(var o=[],s=2;s<arguments.length;s++)o[s-2]=arguments[s];var a=o.map((function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((function(e){return e})).join(" ");r>=(null!=i?i:n.logLevel)&&e({level:t.LogLevel[r].toLowerCase(),message:a,args:o,type:n.name})}},i=0,o=s;i<o.length;i++){r(o[i])}}},function(e,t,n){(function(t){(function(){var n;function r(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}function i(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if("number"==typeof e.length)return{next:r(e)};throw Error(String(e)+" is not an iterable or ArrayLike")}var o="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t},s="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var a,c=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof t&&t];for(var n=0;n<e.length;++n){var r=e[n];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);function l(e,t){if(t)e:{var n=c;e=e.split(".");for(var r=0;r<e.length-1;r++){var i=e[r];if(!(i in n))break e;n=n[i]}(t=t(r=n[e=e[e.length-1]]))!=r&&null!=t&&s(n,e,{configurable:!0,writable:!0,value:t})}}if("function"==typeof Object.setPrototypeOf)a=Object.setPrototypeOf;else{var u;e:{var d={};try{d.__proto__={a:!0},u=d.a;break e}catch(G){}u=!1}a=u?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var h=a;function f(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function p(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}function g(e,t){return Object.prototype.hasOwnProperty.call(e,t)}l("Symbol",(function(e){function t(e,t){this.g=e,s(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var n="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",r=0;return function e(i){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(n+(i||"")+"_"+r++,i)}})),l("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var t="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),n=0;n<t.length;n++){var i=c[t[n]];"function"==typeof i&&"function"!=typeof i.prototype[e]&&s(i.prototype,e,{configurable:!0,writable:!0,value:function(){return f(r(this))}})}return e})),l("Promise",(function(e){function t(e){this.g=0,this.i=void 0,this.h=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.g=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var o=c.setTimeout;n.prototype.i=function(e){o(e,0)},n.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.j(e)}}}this.g=null},n.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.B),reject:e(this.l)}},t.prototype.B=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.D(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.A(e):this.m(e)}},t.prototype.A=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.G(t,e):this.m(e)},t.prototype.l=function(e){this.s(2,e)},t.prototype.m=function(e){this.s(1,e)},t.prototype.s=function(e,t){if(0!=this.g)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.g);this.g=e,this.i=t,2===this.g&&this.C(),this.u()},t.prototype.C=function(){var e=this;o((function(){if(e.v()){var t=c.console;void 0!==t&&t.error(e.i)}}),1)},t.prototype.v=function(){if(this.o)return!1;var e=c.CustomEvent,t=c.Event,n=c.dispatchEvent;return void 0===n||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=c.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,n(e))},t.prototype.u=function(){if(null!=this.h){for(var e=0;e<this.h.length;++e)s.h(this.h[e]);this.h=null}};var s=new n;return t.prototype.D=function(e){var t=this.j();e.la(t.resolve,t.reject)},t.prototype.G=function(e,t){var n=this.j();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){o(e)}}:t}var i,o,s=new t((function(e,t){i=e,o=t}));return this.la(r(e,i),r(n,o)),s},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.la=function(e,t){function n(){switch(r.g){case 1:e(r.i);break;case 2:t(r.i);break;default:throw Error("Unexpected state: "+r.g)}}var r=this;null==this.h?s.h(n):this.h.push(n),this.o=!0},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var o=i(e),s=o.next();!s.done;s=o.next())r(s.value).la(t,n)}))},t.all=function(e){var n=i(e),o=n.next();return o.done?r([]):new t((function(e,t){function i(t){return function(n){s[t]=n,0==--a&&e(s)}}var s=[],a=0;do{s.push(void 0),a++,r(o.value).la(i(s.length-1),t),o=n.next()}while(!o.done)}))},t})),l("Array.prototype.values",(function(e){return e||function(){return p(this,(function(e,t){return t}))}})),l("Array.prototype.keys",(function(e){return e||function(){return p(this,(function(e){return e}))}})),l("WeakMap",(function(e){function t(e){if(this.g=(l+=Math.random()+1).toString(),e){e=i(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}}function n(){}function r(e){var t=typeof e;return"object"===t&&null!==e||"function"===t}function o(e){if(!g(e,c)){var t=new n;s(e,c,{value:t})}}function a(e){var t=Object[e];t&&(Object[e]=function(e){return e instanceof n?e:(Object.isExtensible(e)&&o(e),t(e))})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),r=new e([[t,2],[n,3]]);return 2==r.get(t)&&3==r.get(n)&&(r.delete(t),r.set(n,4),!r.has(t)&&4==r.get(n))}catch(e){return!1}}())return e;var c="$jscomp_hidden_"+Math.random();a("freeze"),a("preventExtensions"),a("seal");var l=0;return t.prototype.set=function(e,t){if(!r(e))throw Error("Invalid WeakMap key");if(o(e),!g(e,c))throw Error("WeakMap key fail: "+e);return e[c][this.g]=t,this},t.prototype.get=function(e){return r(e)&&g(e,c)?e[c][this.g]:void 0},t.prototype.has=function(e){return r(e)&&g(e,c)&&g(e[c],this.g)},t.prototype.delete=function(e){return!!(r(e)&&g(e,c)&&g(e[c],this.g))&&delete e[c][this.g]},t})),l("Map",(function(e){function t(){var e={};return e.V=e.next=e.head=e}function n(e,t){var n=e.g;return f((function(){if(n){for(;n.head!=e.g;)n=n.V;for(;n.next!=n.head;)return n=n.next,{done:!1,value:t(n)};n=null}return{done:!0,value:void 0}}))}function r(e,t){var n=t&&typeof t;"object"==n||"function"==n?s.has(t)?n=s.get(t):(n=""+ ++a,s.set(t,n)):n="p_"+t;var r=e.h[n];if(r&&g(e.h,n))for(e=0;e<r.length;e++){var i=r[e];if(t!=t&&i.key!=i.key||t===i.key)return{id:n,list:r,index:e,K:i}}return{id:n,list:r,index:-1,K:void 0}}function o(e){if(this.h={},this.g=t(),this.size=0,e){e=i(e);for(var n;!(n=e.next()).done;)n=n.value,this.set(n[0],n[1])}}if(function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(i([[t,"s"]]));if("s"!=n.get(t)||1!=n.size||n.get({x:4})||n.set({x:4},"t")!=n||2!=n.size)return!1;var r=n.entries(),o=r.next();return!o.done&&o.value[0]==t&&"s"==o.value[1]&&!((o=r.next()).done||4!=o.value[0].x||"t"!=o.value[1]||!r.next().done)}catch(e){return!1}}())return e;var s=new WeakMap;o.prototype.set=function(e,t){var n=r(this,e=0===e?0:e);return n.list||(n.list=this.h[n.id]=[]),n.K?n.K.value=t:(n.K={next:this.g,V:this.g.V,head:this.g,key:e,value:t},n.list.push(n.K),this.g.V.next=n.K,this.g.V=n.K,this.size++),this},o.prototype.delete=function(e){return!(!(e=r(this,e)).K||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.h[e.id],e.K.V.next=e.K.next,e.K.next.V=e.K.V,e.K.head=null,this.size--,!0)},o.prototype.clear=function(){this.h={},this.g=this.g.V=t(),this.size=0},o.prototype.has=function(e){return!!r(this,e).K},o.prototype.get=function(e){return(e=r(this,e).K)&&e.value},o.prototype.entries=function(){return n(this,(function(e){return[e.key,e.value]}))},o.prototype.keys=function(){return n(this,(function(e){return e.key}))},o.prototype.values=function(){return n(this,(function(e){return e.value}))},o.prototype.forEach=function(e,t){for(var n,r=this.entries();!(n=r.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},o.prototype[Symbol.iterator]=o.prototype.entries;var a=0;return o})),l("Array.prototype.find",(function(e){return e||function(e,t){e:{var n=this;n instanceof String&&(n=String(n));for(var r=n.length,i=0;i<r;i++){var o=n[i];if(e.call(t,o,i,n)){e=o;break e}}e=void 0}return e}})),l("Array.prototype.entries",(function(e){return e||function(){return p(this,(function(e,t){return[e,t]}))}})),l("Array.from",(function(e){return e||function(e,t,n){t=null!=t?t:function(e){return e};var r=[],i="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if("function"==typeof i){e=i.call(e);for(var o=0;!(i=e.next()).done;)r.push(t.call(n,i.value,o++))}else for(i=e.length,o=0;o<i;o++)r.push(t.call(n,e[o],o));return r}})),l("Set",(function(e){function t(e){if(this.g=new Map,e){e=i(e);for(var t;!(t=e.next()).done;)this.add(t.value)}this.size=this.g.size}return function(){if(!e||"function"!=typeof e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),n=new e(i([t]));if(!n.has(t)||1!=n.size||n.add(t)!=n||1!=n.size||n.add({x:4})!=n||2!=n.size)return!1;var r=n.entries(),o=r.next();return!o.done&&o.value[0]==t&&o.value[1]==t&&(!(o=r.next()).done&&o.value[0]!=t&&4==o.value[0].x&&o.value[1]==o.value[0]&&r.next().done)}catch(e){return!1}}()?e:(t.prototype.add=function(e){return e=0===e?0:e,this.g.set(e,e),this.size=this.g.size,this},t.prototype.delete=function(e){return e=this.g.delete(e),this.size=this.g.size,e},t.prototype.clear=function(){this.g.clear(),this.size=0},t.prototype.has=function(e){return this.g.has(e)},t.prototype.entries=function(){return this.g.entries()},t.prototype.values=function(){return this.g.values()},t.prototype.keys=t.prototype.values,t.prototype[Symbol.iterator]=t.prototype.values,t.prototype.forEach=function(e,t){var n=this;this.g.forEach((function(r){return e.call(t,r,r,n)}))},t)}));var m=m||{},y=this||self;function v(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function b(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function _(e){return Object.prototype.hasOwnProperty.call(e,w)&&e[w]||(e[w]=++T)}var w="closure_uid_"+(1e9*Math.random()>>>0),T=0;function E(e,t,n){return e.call.apply(e.bind,arguments)}function A(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function S(e,t,n){return(S=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?E:A).apply(null,arguments)}function O(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function I(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.dc=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}function C(){0!=k&&(P[_(this)]=this),this.s=this.s,this.o=this.o}var k=0,P={};C.prototype.s=!1,C.prototype.va=function(){if(!this.s&&(this.s=!0,this.O(),0!=k)){var e=_(this);if(0!=k&&this.o&&0<this.o.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete P[e]}},C.prototype.O=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var x=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function R(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function L(e,t){for(var n=1;n<arguments.length;n++){var r=arguments[n];if(v(r)){var i=e.length||0,o=r.length||0;e.length=i+o;for(var s=0;s<o;s++)e[i+s]=r[s]}else e.push(r)}}function D(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var N=function(){if(!y.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{var n=function(){};y.addEventListener("test",n,t),y.removeEventListener("test",n,t)}catch(e){}return e}();function j(e){return/^[\s\xa0]*$/.test(e)}function M(){var e=y.navigator;return e&&(e=e.userAgent)?e:""}function F(e){return-1!=M().indexOf(e)}function U(e){return U[" "](e),e}U[" "]=function(){};var B,G,q,H=F("Opera"),$=F("Trident")||F("MSIE"),W=F("Edge"),z=W||$,V=F("Gecko")&&!(-1!=M().toLowerCase().indexOf("webkit")&&!F("Edge"))&&!(F("Trident")||F("MSIE"))&&!F("Edge"),K=-1!=M().toLowerCase().indexOf("webkit")&&!F("Edge");function Y(){var e=y.document;return e?e.documentMode:void 0}e:{var Q="",X=(G=M(),V?/rv:([^\);]+)(\)|;)/.exec(G):W?/Edge\/([\d\.]+)/.exec(G):$?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(G):K?/WebKit\/(\S+)/.exec(G):H?/(?:Version)[ \/]?(\S+)/.exec(G):void 0);if(X&&(Q=X?X[1]:""),$){var J=Y();if(null!=J&&J>parseFloat(Q)){B=String(J);break e}}B=Q}if(y.document&&$){var Z=Y();q=Z||(parseInt(B,10)||void 0)}else q=void 0;var ee=q;function te(e,t){if(D.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(V){e:{try{U(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:ne[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&te.Z.h.call(this)}}I(te,D);var ne={2:"touch",3:"pen",4:"mouse"};te.prototype.h=function(){te.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var re="closure_listenable_"+(1e6*Math.random()|0),ie=0;function oe(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.oa=i,this.key=++ie,this.ha=this.ka=!1}function se(e){e.ha=!0,e.listener=null,e.proxy=null,e.src=null,e.oa=null}function ae(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function ce(e){var t,n={};for(t in e)n[t]=e[t];return n}var le="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ue(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var o=0;o<le.length;o++)n=le[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function de(e){this.src=e,this.g={},this.h=0}function he(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],o=x(i,t);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(se(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function fe(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.ha&&o.listener==t&&o.capture==!!n&&o.oa==r)return i}return-1}de.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.g[o])||(e=this.g[o]=[],this.h++);var s=fe(e,t,r,i);return-1<s?(t=e[s],n||(t.ka=!1)):((t=new oe(t,this.src,o,!!r,i)).ka=n,e.push(t)),t};var pe="closure_lm_"+(1e6*Math.random()|0),ge={};function me(e,t,n,r,i){if(r&&r.once)return ve(e,t,n,r,i);if(Array.isArray(t)){for(var o=0;o<t.length;o++)me(e,t[o],n,r,i);return null}return n=Se(n),e&&e[re]?e.P(t,n,b(r)?!!r.capture:!!r,i):ye(e,t,n,!1,r,i)}function ye(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var s=b(i)?!!i.capture:!!i,a=Ee(e);if(a||(e[pe]=a=new de(e)),(n=a.add(t,n,r,s,o)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=Te;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)N||(i=s),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(we(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ve(e,t,n,r,i){if(Array.isArray(t)){for(var o=0;o<t.length;o++)ve(e,t[o],n,r,i);return null}return n=Se(n),e&&e[re]?e.R(t,n,b(r)?!!r.capture:!!r,i):ye(e,t,n,!0,r,i)}function be(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)be(e,t[o],n,r,i);else r=b(r)?!!r.capture:!!r,n=Se(n),e&&e[re]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=fe(o=e.g[t],n,r,i))&&(se(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.g[t],e.h--)))):e&&(e=Ee(e))&&(t=e.g[t.toString()],e=-1,t&&(e=fe(t,n,r,i)),(n=-1<e?t[e]:null)&&_e(n))}function _e(e){if("number"!=typeof e&&e&&!e.ha){var t=e.src;if(t&&t[re])he(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(we(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Ee(t))?(he(n,e),0==n.h&&(n.src=null,t[pe]=null)):se(e)}}}function we(e){return e in ge?ge[e]:ge[e]="on"+e}function Te(e,t){if(e.ha)e=!0;else{t=new te(t,this);var n=e.listener,r=e.oa||e.src;e.ka&&_e(e),e=n.call(r,t)}return e}function Ee(e){return(e=e[pe])instanceof de?e:null}var Ae="__closure_events_fn_"+(1e9*Math.random()>>>0);function Se(e){return"function"==typeof e?e:(e[Ae]||(e[Ae]=function(t){return e.handleEvent(t)}),e[Ae])}function Oe(){C.call(this),this.i=new de(this),this.T=this,this.J=null}function Ie(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.T,r=t.type||t,"string"==typeof t)t=new D(t,e);else if(t instanceof D)t.target=t.target||e;else{var i=t;ue(t=new D(r,e),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var s=t.g=n[o];i=Ce(s,r,!0,t)&&i}if(i=Ce(s=t.g=e,r,!0,t)&&i,i=Ce(s,r,!1,t)&&i,n)for(o=0;o<n.length;o++)i=Ce(s=t.g=n[o],r,!1,t)&&i}function Ce(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var s=t[o];if(s&&!s.ha&&s.capture==n){var a=s.listener,c=s.oa||s.src;s.ka&&he(e.i,s),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}I(Oe,C),Oe.prototype[re]=!0,Oe.prototype.removeEventListener=function(e,t,n,r){be(this,e,t,n,r)},Oe.prototype.O=function(){if(Oe.Z.O.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)se(n[r]);delete t.g[e],t.h--}}this.J=null},Oe.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Oe.prototype.R=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var ke=y.JSON.stringify;function Pe(e,t){this.i=e,this.j=t,this.h=0,this.g=null}function xe(){this.h=this.g=null}function Re(){var e=Ue,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}Pe.prototype.get=function(){if(0<this.h){this.h--;var e=this.g;this.g=e.next,e.next=null}else e=this.i();return e},xe.prototype.add=function(e,t){var n=Le.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n};var Le=new Pe((function(){return new De}),(function(e){return e.reset()}));function De(){this.next=this.g=this.h=null}function Ne(e){var t=1;e=e.split(":");for(var n=[];0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function je(e){y.setTimeout((function(){throw e}),0)}De.prototype.set=function(e,t){this.h=e,this.g=t,this.next=null},De.prototype.reset=function(){this.next=this.g=this.h=null};var Me,Fe=!1,Ue=new xe;function Be(e,t){Me||function(){var e=y.Promise.resolve(void 0);Me=function(){e.then(Ge)}}(),Fe||(Me(),Fe=!0),Ue.add(e,t)}function Ge(){for(var e;e=Re();){try{e.h.call(e.g)}catch(e){je(e)}var t=Le;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Fe=!1}function qe(e,t){Oe.call(this),this.h=e||1,this.g=t||y,this.j=S(this.tb,this),this.l=Date.now()}function He(e){e.ia=!1,e.U&&(e.g.clearTimeout(e.U),e.U=null)}function $e(e,t,n){if("function"==typeof e)n&&(e=S(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=S(e.handleEvent,e)}return 2147483647<Number(t)?-1:y.setTimeout(e,t||0)}function We(e,t,n){C.call(this),this.m=null!=n?e.bind(n):e,this.j=t,this.h=null,this.i=!1,this.g=null}if(I(qe,Oe),(n=qe.prototype).ia=!1,n.U=null,n.tb=function(){if(this.ia){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.U=this.g.setTimeout(this.j,this.h-e):(this.U&&(this.g.clearTimeout(this.U),this.U=null),Ie(this,"tick"),this.ia&&(He(this),this.start()))}},n.start=function(){this.ia=!0,this.U||(this.U=this.g.setTimeout(this.j,this.h),this.l=Date.now())},n.O=function(){qe.Z.O.call(this),He(this),delete this.g},We.prototype=o(C.prototype),We.prototype.constructor=We,h)h(We,C);else for(var ze in C)if("prototype"!=ze)if(Object.defineProperties){var Ve=Object.getOwnPropertyDescriptor(C,ze);Ve&&Object.defineProperty(We,ze,Ve)}else We[ze]=C[ze];function Ke(e){e.g=$e((function(){e.g=null,e.i&&(e.i=!1,Ke(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}function Ye(e){C.call(this),this.h=e,this.g={}}We.Z=C.prototype,We.prototype.l=function(e){this.h=arguments,this.g?this.i=!0:Ke(this)},We.prototype.O=function(){C.prototype.O.call(this),this.g&&(y.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},I(Ye,C);var Qe=[];function Xe(e,t,n,r){Array.isArray(n)||(n&&(Qe[0]=n.toString()),n=Qe);for(var i=0;i<n.length;i++){var o=me(t,n[i],r||e.handleEvent,!1,e.h||e);if(!o)break;e.g[o.key]=o}}function Je(e){ae(e.g,(function(e,t){this.g.hasOwnProperty(t)&&_e(e)}),e),e.g={}}function Ze(){this.g=!0}function et(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var s=1;s<i.length;s++)i[s]=""}}}return ke(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}Ye.prototype.O=function(){Ye.Z.O.call(this),Je(this)},Ye.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ze.prototype.Ha=function(){this.g=!1},Ze.prototype.info=function(){};var tt={},nt=null;function rt(){return nt=nt||new Oe}function it(e){D.call(this,tt.Wa,e)}function ot(e){var t=rt();Ie(t,new it(t,e))}function st(e,t){D.call(this,tt.STAT_EVENT,e),this.stat=t}function at(e){var t=rt();Ie(t,new st(t,e))}function ct(e,t){D.call(this,tt.Xa,e),this.size=t}function lt(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return y.setTimeout((function(){e()}),t)}tt.Wa="serverreachability",I(it,D),tt.STAT_EVENT="statevent",I(st,D),tt.Xa="timingevent",I(ct,D);var ut={NO_ERROR:0,ub:1,Hb:2,Gb:3,Bb:4,Fb:5,Ib:6,Ta:7,TIMEOUT:8,Lb:9},dt={zb:"complete",Vb:"success",Ua:"error",Ta:"abort",Nb:"ready",Ob:"readystatechange",TIMEOUT:"timeout",Jb:"incrementaldata",Mb:"progress",Cb:"downloadprogress",cc:"uploadprogress"};function ht(){}function ft(e){return e.h||(e.h=e.i())}function pt(){}ht.prototype.h=null;var gt,mt={OPEN:"a",yb:"b",Ua:"c",Kb:"d"};function yt(){D.call(this,"d")}function vt(){D.call(this,"c")}function bt(){}function _t(e,t,n,r){this.l=e,this.j=t,this.m=n,this.Y=r||1,this.W=new Ye(this),this.R=Tt,e=z?125:void 0,this.X=new qe(e),this.I=null,this.i=!1,this.u=this.B=this.A=this.M=this.G=this.aa=this.C=null,this.D=[],this.g=null,this.o=0,this.s=this.v=null,this.ea=-1,this.J=!1,this.P=0,this.N=null,this.da=this.L=this.ca=this.T=!1,this.h=new wt}function wt(){this.i=null,this.g="",this.h=!1}I(yt,D),I(vt,D),I(bt,ht),bt.prototype.g=function(){return new XMLHttpRequest},bt.prototype.i=function(){return{}},gt=new bt;var Tt=45e3,Et={},At={};function St(e,t,n){e.M=1,e.A=$t(Ut(t)),e.u=n,e.T=!0,Ot(e,null)}function Ot(e,t){e.G=Date.now(),Pt(e),e.B=Ut(e.A);var n=e.B,r=e.Y;Array.isArray(r)||(r=[String(r)]),rn(n.i,"t",r),e.o=0,n=e.l.J,e.h=new wt,e.g=or(e.l,n?t:null,!e.u),0<e.P&&(e.N=new We(S(e.Sa,e,e.g),e.P)),Xe(e.W,e.g,"readystatechange",e.qb),t=e.I?ce(e.I):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ja(e.B,e.v,e.u,t)):(e.v="GET",e.g.ja(e.B,e.v,null,t)),ot(1),function(e,t,n,r,i,o){e.info((function(){if(e.g)if(o)for(var s="",a=o.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var d=u.split("_");s=2<=d.length&&"type"==d[1]?s+(u+"=")+l+"&":s+(u+"=redacted&")}}else s=null;else s=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+s}))}(e.j,e.v,e.B,e.m,e.Y,e.u)}function It(e){return!!e.g&&("GET"==e.v&&2!=e.M&&e.l.Ka)}function Ct(e,t,n){for(var r,i=!0;!e.J&&e.o<n.length;){if((r=kt(e,n))==At){4==t&&(e.s=4,at(14),i=!1),et(e.j,e.m,null,"[Incomplete Response]");break}if(r==Et){e.s=4,at(15),et(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}et(e.j,e.m,r,null),Nt(e,r)}It(e)&&0!=e.o&&(e.h.g=e.h.g.slice(e.o),e.o=0),4!=t||0!=n.length||e.h.h||(e.s=1,at(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.da&&(e.da=!0,(t=e.l).g==e&&t.ea&&!t.N&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Xn(t),t.N=!0,at(11))):(et(e.j,e.m,n,"[Invalid Chunked Response]"),Dt(e),Lt(e))}function kt(e,t){var n=e.o,r=t.indexOf("\n",n);return-1==r?At:(n=Number(t.substring(n,r)),isNaN(n)?Et:(r+=1)+n>t.length?At:(t=t.slice(r,r+n),e.o=r+n,t))}function Pt(e){e.aa=Date.now()+e.R,xt(e,e.R)}function xt(e,t){if(null!=e.C)throw Error("WatchDog timer not null");e.C=lt(S(e.ob,e),t)}function Rt(e){e.C&&(y.clearTimeout(e.C),e.C=null)}function Lt(e){0==e.l.H||e.J||er(e.l,e)}function Dt(e){Rt(e);var t=e.N;t&&"function"==typeof t.va&&t.va(),e.N=null,He(e.X),Je(e.W),e.g&&(t=e.g,e.g=null,t.abort(),t.va())}function Nt(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||hn(n.i,e)))if(!e.L&&hn(n.i,e)&&3==n.H){try{var r=n.Ma.g.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Zn(n),Hn(n)}Qn(n),at(18)}}else n.Ia=i[1],0<n.Ia-n.X&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=lt(S(n.lb,n),6e3));if(1>=dn(n.i)&&n.ra){try{n.ra()}catch(e){}n.ra=void 0}}else nr(n,11)}else if((e.L||n.g==e)&&Zn(n),!j(t))for(i=n.Ma.g.parse(t),t=0;t<i.length;t++){var o=i[t];if(n.X=o[0],o=o[1],2==n.H)if("c"==o[0]){n.L=o[1],n.sa=o[2];var s=o[3];null!=s&&(n.ua=s,n.l.info("VER="+n.ua));var a=o[4];null!=a&&(n.Ja=a,n.l.info("SVER="+n.Ja));var c=o[5];null!=c&&"number"==typeof c&&0<c&&(r=1.5*c,n.M=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;var l=e.g;if(l){var u=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(u){var d=r.i;d.g||-1==u.indexOf("spdy")&&-1==u.indexOf("quic")&&-1==u.indexOf("h2")||(d.j=d.l,d.g=new Set,d.h&&(fn(d,d.h),d.h=null))}if(r.D){var h=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null;h&&(r.Ga=h,Ht(r.I,r.D,h))}}n.H=3,n.h&&n.h.Ea(),n.ea&&(n.T=Date.now()-e.G,n.l.info("Handshake RTT: "+n.T+"ms"));var f=e;if((r=n).za=ir(r,r.J?r.sa:null,r.aa),f.L){pn(r.i,f);var p=f,g=r.M;g&&p.setTimeout(g),p.C&&(Rt(p),Pt(p)),r.g=f}else Yn(r);0<n.j.length&&Wn(n)}else"stop"!=o[0]&&"close"!=o[0]||nr(n,7);else 3==n.H&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?nr(n,7):qn(n):"noop"!=o[0]&&n.h&&n.h.Da(o),n.A=0)}ot(4)}catch(e){}}function jt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(v(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.wa&&"function"==typeof e.wa)return e.wa();if(!e.ba||"function"!=typeof e.ba){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(v(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}}(e),r=function(e){if(e.ba&&"function"==typeof e.ba)return e.ba();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(v(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}(n=_t.prototype).setTimeout=function(e){this.R=e},n.qb=function(e){e=e.target;var t=this.N;t&&3==jn(e)?t.l():this.Sa(e)},n.Sa=function(e){try{if(e==this.g)e:{var t=jn(this.g),n=this.g.La(),r=this.g.fa();if(!(3>t)&&(3!=t||z||this.g&&(this.h.h||this.g.ma()||Mn(this.g)))){this.J||4!=t||7==n||ot(8==n||0>=r?3:2),Rt(this);var i=this.g.fa();this.ea=i;t:if(It(this)){var o=Mn(this.g);e="";var s=o.length,a=4==jn(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Dt(this),Lt(this);var c="";break t}this.h.i=new y.TextDecoder}for(n=0;n<s;n++)this.h.h=!0,e+=this.h.i.decode(o[n],{stream:a&&n==s-1});o.length=0,this.h.g+=e,this.o=0,c=this.h.g}else c=this.g.ma();if(this.i=200==i,function(e,t,n,r,i,o,s){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+o+" "+s}))}(this.j,this.v,this.B,this.m,this.Y,t,i),this.i){if(this.ca&&!this.L){t:{if(this.g){var l,u=this.g;if((l=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(l)){var d=l;break t}}d=null}if(!(i=d)){this.i=!1,this.s=3,at(12),Dt(this),Lt(this);break e}et(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Nt(this,i)}this.T?(Ct(this,t,c),z&&this.i&&3==t&&(Xe(this.W,this.X,"tick",this.pb),this.X.start())):(et(this.j,this.m,c,null),Nt(this,c)),4==t&&Dt(this),this.i&&!this.J&&(4==t?er(this.l,this):(this.i=!1,Pt(this)))}else(function(e){var t={};e=(e.g&&2<=jn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(var n=0;n<e.length;n++)if(!j(e[n])){var r=Ne(e[n]),i=r[0];if("string"==typeof(r=r[1])){r=r.trim();var o=t[i]||[];t[i]=o,o.push(r)}}!function(e,t){for(var n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==i&&0<c.indexOf("Unknown SID")?(this.s=3,at(12)):(this.s=0,at(13)),Dt(this),Lt(this)}}}catch(e){}},n.pb=function(){if(this.g){var e=jn(this.g),t=this.g.ma();this.o<t.length&&(Rt(this),Ct(this,e,t),this.i&&4!=e&&Pt(this))}},n.cancel=function(){this.J=!0,Dt(this)},n.ob=function(){this.C=null;var e=Date.now();0<=e-this.aa?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.B),2!=this.M&&(ot(3),at(17)),Dt(this),this.s=2,Lt(this)):xt(this,this.aa-e)};var Mt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ft(e){var t;this.g=this.s=this.j="",this.o=null,this.m=this.h="",this.l=!1,e instanceof Ft?(this.l=e.l,Bt(this,e.j),this.s=e.s,this.g=e.g,Gt(this,e.o),this.h=e.h,qt(this,on(e.i)),this.m=e.m):e&&(t=String(e).match(Mt))?(this.l=!1,Bt(this,t[1]||"",!0),this.s=Wt(t[2]||""),this.g=Wt(t[3]||"",!0),Gt(this,t[4]),this.h=Wt(t[5]||"",!0),qt(this,t[6]||"",!0),this.m=Wt(t[7]||"")):(this.l=!1,this.i=new Zt(null,this.l))}function Ut(e){return new Ft(e)}function Bt(e,t,n){e.j=n?Wt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Gt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.o=t}else e.o=null}function qt(e,t,n){t instanceof Zt?(e.i=t,function(e,t){t&&!e.j&&(en(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(tn(this,t),rn(this,n,e))}),e)),e.j=t}(e.i,e.l)):(n||(t=zt(t,Xt)),e.i=new Zt(t,e.l))}function Ht(e,t,n){e.i.set(t,n)}function $t(e){return Ht(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Wt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function zt(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Vt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Vt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ft.prototype.toString=function(){var e=[],t=this.j;t&&e.push(zt(t,Kt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(zt(t,Kt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.o)&&e.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(zt(n,"/"==n.charAt(0)?Qt:Yt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",zt(n,Jt)),e.join("")},Ft.prototype.resolve=function(e){var t=Ut(this),n=!!e.j;n?Bt(t,e.j):n=!!e.s,n?t.s=e.s:n=!!e.g,n?t.g=e.g:n=null!=e.o;var r=e.h;if(n)Gt(t,e.o);else if(n=!!e.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var i=t.h.lastIndexOf("/");-1!=i&&(r=t.h.slice(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],s=0;s<i.length;){var a=i[s++];"."==a?r&&s==i.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&s==i.length&&o.push("")):(o.push(a),r=!0)}r=o.join("/")}else r=i}return n?t.h=r:n=""!==e.i.toString(),n?qt(t,on(e.i)):n=!!e.m,n&&(t.m=e.m),t};var Kt=/[#\/\?@]/g,Yt=/[#\?:]/g,Qt=/[#\?]/g,Xt=/[#\?@]/g,Jt=/#/g;function Zt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function en(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function tn(e,t){en(e),t=sn(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function nn(e,t){return en(e),t=sn(e,t),e.g.has(t)}function rn(e,t,n){tn(e,t),0<n.length&&(e.i=null,e.g.set(sn(e,t),R(n)),e.h+=n.length)}function on(e){var t=new Zt;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function sn(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function an(e,t){this.g=e,this.map=t}function cn(e){this.l=e||ln,y.PerformanceNavigationTiming?e=0<(e=y.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(y.g&&y.g.Na&&y.g.Na()&&y.g.Na().hc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(n=Zt.prototype).add=function(e,t){en(this),this.i=null,e=sn(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},n.forEach=function(e,t){en(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},n.wa=function(){en(this);for(var e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},n.ba=function(e){en(this);var t=[];if("string"==typeof e)nn(this,e)&&(t=t.concat(this.g.get(sn(this,e))));else{e=Array.from(this.g.values());for(var n=0;n<e.length;n++)t=t.concat(e[n])}return t},n.set=function(e,t){return en(this),this.i=null,nn(this,e=sn(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},n.get=function(e,t){return e&&0<(e=this.ba(e)).length?String(e[0]):t},n.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=Array.from(this.g.keys()),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.ba(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),e.push(s)}}return this.i=e.join("&")};var ln=10;function un(e){return!!e.h||!!e.g&&e.g.size>=e.j}function dn(e){return e.h?1:e.g?e.g.size:0}function hn(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function fn(e,t){e.g?e.g.add(t):e.h=t}function pn(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function gn(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){for(var t=e.i,n=(e=i(e.g.values())).next();!n.done;n=e.next())t=t.concat(n.value.D);return t}return R(e.i)}function mn(){}function yn(){this.g=new mn}function vn(e,t,n){var r=n||"";try{jt(e,(function(e,n){var i=e;b(e)&&(i=ke(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function bn(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function _n(e){this.l=e.ic||null,this.j=e.rb||!1}function wn(e,t){Oe.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=Tn,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}cn.prototype.cancel=function(){if(this.i=gn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(var e=i(this.g.values()),t=e.next();!t.done;t=e.next())t.value.cancel();this.g.clear()}},mn.prototype.stringify=function(e){return y.JSON.stringify(e,void 0)},mn.prototype.parse=function(e){return y.JSON.parse(e,void 0)},I(_n,ht),_n.prototype.g=function(){return new wn(this.l,this.j)},_n.prototype.i=function(e){return function(){return e}}({}),I(wn,Oe);var Tn=0;function En(e){e.j.read().then(e.$a.bind(e)).catch(e.na.bind(e))}function An(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Sn(e)}function Sn(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(n=wn.prototype).open=function(e,t){if(this.readyState!=Tn)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Sn(this)},n.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||y).fetch(new Request(this.B,t)).then(this.cb.bind(this),this.na.bind(this))},n.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((function(){})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,An(this)),this.readyState=Tn},n.cb=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Sn(this)),this.g&&(this.readyState=3,Sn(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.ab.bind(this),this.na.bind(this));else if(void 0!==y.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;En(this)}else e.text().then(this.bb.bind(this),this.na.bind(this))},n.$a=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?An(this):Sn(this),3==this.readyState&&En(this)}},n.bb=function(e){this.g&&(this.response=this.responseText=e,An(this))},n.ab=function(e){this.g&&(this.response=e,An(this))},n.na=function(){this.g&&An(this)},n.setRequestHeader=function(e,t){this.v.append(e,t)},n.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(wn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var On=y.JSON.parse;function In(e){Oe.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.D=!1,this.B=0,this.A=null,this.L=Cn,this.M=this.N=!1}I(In,Oe);var Cn="",kn=/^https?$/i,Pn=["POST","PUT"];function xn(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Rn(e),Dn(e)}function Rn(e){e.D||(e.D=!0,Ie(e,"complete"),Ie(e,"error"))}function Ln(e){if(e.h&&void 0!==m&&(!e.C[1]||4!=jn(e)||2!=e.fa()))if(e.v&&4==jn(e))$e(e.Oa,0,e);else if(Ie(e,"readystatechange"),4==jn(e)){e.h=!1;try{var t,n=e.fa();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var o=String(e.I).match(Mt)[1]||null;!o&&y.self&&y.self.location&&(o=y.self.location.protocol.slice(0,-1)),i=!kn.test(o?o.toLowerCase():"")}t=i}if(t)Ie(e,"complete"),Ie(e,"success");else{e.m=6;try{var s=2<jn(e)?e.g.statusText:""}catch(e){s=""}e.j=s+" ["+e.fa()+"]",Rn(e)}}finally{Dn(e)}}}function Dn(e,t){if(e.g){Nn(e);var n=e.g,r=e.C[0]?function(){}:null;e.g=null,e.C=null,t||Ie(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function Nn(e){e.g&&e.M&&(e.g.ontimeout=null),e.A&&(y.clearTimeout(e.A),e.A=null)}function jn(e){return e.g?e.g.readyState:0}function Mn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.L){case Cn:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Fn(e){var t="";return ae(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Un(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Fn(n),"string"==typeof e?(encodeURIComponent(String(t)),null!=n&&encodeURIComponent(String(n))):Ht(e,t,n))}function Bn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Gn(e){this.Ja=0,this.j=[],this.l=new Ze,this.sa=this.za=this.I=this.aa=this.g=this.Ga=this.D=this.qa=this.o=this.W=this.s=null,this.ib=this.Y=0,this.gb=Bn("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.ca=!0,this.Ia=this.X=-1,this.da=this.A=this.C=0,this.eb=Bn("baseRetryDelayMs",5e3,e),this.kb=Bn("retryDelaySeedMs",1e4,e),this.hb=Bn("forwardChannelMaxRetries",2,e),this.Aa=Bn("forwardChannelRequestTimeoutMs",2e4,e),this.ya=e&&e.xmlHttpFactory||void 0,this.Ka=e&&e.useFetchStreams||!1,this.M=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.L="",this.i=new cn(e&&e.concurrentRequestLimit),this.Ma=new yn,this.R=e&&e.fastHandshake||!1,this.P=e&&e.encodeInitMessageHeaders||!1,this.R&&this.P&&(this.P=!1),this.fb=e&&e.ec||!1,e&&e.Ha&&this.l.Ha(),e&&e.forceLongPolling&&(this.ca=!1),this.ea=!this.R&&this.ca&&e&&e.detectBufferingProxy||!1,this.ta=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ta=e.longPollingTimeout),this.ra=void 0,this.T=0,this.N=!1,this.pa=this.B=null}function qn(e){if($n(e),3==e.H){var t=e.Y++,n=Ut(e.I);if(Ht(n,"SID",e.L),Ht(n,"RID",t),Ht(n,"TYPE","terminate"),Vn(e,n),(t=new _t(e,e.l,t)).M=2,t.A=$t(Ut(n)),n=!1,y.navigator&&y.navigator.sendBeacon)try{n=y.navigator.sendBeacon(t.A.toString(),"")}catch(e){}!n&&y.Image&&((new Image).src=t.A,n=!0),n||(t.g=or(t.l,null),t.g.ja(t.A)),t.G=Date.now(),Pt(t)}rr(e)}function Hn(e){e.g&&(Xn(e),e.g.cancel(),e.g=null)}function $n(e){Hn(e),e.u&&(y.clearTimeout(e.u),e.u=null),Zn(e),e.i.cancel(),e.m&&("number"==typeof e.m&&y.clearTimeout(e.m),e.m=null)}function Wn(e){un(e.i)||e.m||(e.m=!0,Be(e.Qa,e),e.C=0)}function zn(e,t){var n;n=t?t.m:e.Y++;var r=Ut(e.I);Ht(r,"SID",e.L),Ht(r,"RID",n),Ht(r,"AID",e.X),Vn(e,r),e.o&&e.s&&Un(r,e.o,e.s),n=new _t(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.D.concat(e.j)),t=Kn(e,n,1e3),n.setTimeout(Math.round(.5*e.Aa)+Math.round(.5*e.Aa*Math.random())),fn(e.i,n),St(n,r,t)}function Vn(e,t){e.qa&&ae(e.qa,(function(e,n){Ht(t,n,e)})),e.h&&jt({},(function(e,n){Ht(t,n,e)}))}function Kn(e,t,n){n=Math.min(e.j.length,n);var r=e.h?S(e.h.Ya,e.h,e):null;e:for(var i=e.j,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].g,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,c=0;c<n;c++){var l=i[c].g,u=i[c].map;if(0>(l-=o))o=Math.max(0,i[c].g-100),a=!1;else try{vn(u,s,"req"+l+"_")}catch(e){r&&r(u)}}if(a){r=s.join("&");break e}}return e=e.j.splice(0,n),t.D=e,r}function Yn(e){e.g||e.u||(e.da=1,Be(e.Pa,e),e.A=0)}function Qn(e){return!(e.g||e.u||3<=e.A)&&(e.da++,e.u=lt(S(e.Pa,e),tr(e,e.A)),e.A++,!0)}function Xn(e){null!=e.B&&(y.clearTimeout(e.B),e.B=null)}function Jn(e){e.g=new _t(e,e.l,"rpc",e.da),null===e.o&&(e.g.I=e.s),e.g.P=0;var t=Ut(e.za);Ht(t,"RID","rpc"),Ht(t,"SID",e.L),Ht(t,"AID",e.X),Ht(t,"CI",e.G?"0":"1"),!e.G&&e.ta&&Ht(t,"TO",e.ta),Ht(t,"TYPE","xmlhttp"),Vn(e,t),e.o&&e.s&&Un(t,e.o,e.s),e.M&&e.g.setTimeout(e.M);var n=e.g;e=e.sa,n.M=1,n.A=$t(Ut(t)),n.u=null,n.T=!0,Ot(n,e)}function Zn(e){null!=e.v&&(y.clearTimeout(e.v),e.v=null)}function er(e,t){var n=null;if(e.g==t){Zn(e),Xn(e),e.g=null;var r=2}else{if(!hn(e.i,t))return;n=t.D,pn(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.G;var i=e.C;Ie(r=rt(),new ct(r,n,t,i)),Wn(e)}else Yn(e);else if(3==(i=t.s)||0==i&&0<t.ea||!(1==r&&function(e,t){return!(dn(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.j=t.D.concat(e.j),0):1==e.H||2==e.H||e.C>=(e.gb?0:e.hb)||(e.m=lt(S(e.Qa,e,t),tr(e,e.C)),e.C++,0)))}(e,t)||2==r&&Qn(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:nr(e,5);break;case 4:nr(e,10);break;case 3:nr(e,6);break;default:nr(e,2)}}function tr(e,t){var n=e.eb+Math.floor(Math.random()*e.kb);return e.isActive()||(n*=2),n*t}function nr(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=S(e.sb,e);n||(n=new Ft("//www.google.com/images/cleardot.gif"),y.location&&"http"==y.location.protocol||Bt(n,"https"),$t(n)),function(e,t){var n=new Ze;if(y.Image){var r=new Image;r.onload=O(bn,n,r,"TestLoadImage: loaded",!0,t),r.onerror=O(bn,n,r,"TestLoadImage: error",!1,t),r.onabort=O(bn,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=O(bn,n,r,"TestLoadImage: timeout",!1,t),y.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else at(2);e.H=0,e.h&&e.h.Ca(t),rr(e),$n(e)}function rr(e){if(e.H=0,e.pa=[],e.h){var t=gn(e.i);0==t.length&&0==e.j.length||(L(e.pa,t),L(e.pa,e.j),e.i.i.length=0,R(e.j),e.j.length=0),e.h.Ba()}}function ir(e,t,n){var r=n instanceof Ft?Ut(n):new Ft(n);if(""!=r.g)t&&(r.g=t+"."+r.g),Gt(r,r.o);else{var i=y.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var o=new Ft(null);r&&Bt(o,r),t&&(o.g=t),i&&Gt(o,i),n&&(o.h=n),r=o}return n=e.D,t=e.Ga,n&&t&&Ht(r,n,t),Ht(r,"VER",e.ua),Vn(e,r),r}function or(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ka&&!e.ya?new In(new _n({rb:n})):new In(e.ya)).Ra(e.J),t}function sr(){}function ar(){if($&&!(10<=Number(ee)))throw Error("Environmental error: no available transport.")}function cr(e,t){Oe.call(this),this.g=new Gn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Fa&&(e?e["X-WebChannel-Client-Profile"]=t.Fa:e={"X-WebChannel-Client-Profile":t.Fa}),this.g.W=e,(e=t&&t.fc)&&!j(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!j(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new dr(this)}function lr(e){yt.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function ur(){vt.call(this),this.status=1}function dr(e){this.g=e}function hr(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function fr(e,t,n){n||(n=0);var r=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var o=e.g[3],s=t+(o^n&(i^o))+r[0]+3614090360&4294967295;s=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=(n=(i=(o=(t=n+(s<<7&4294967295|s>>>25))+((s=o+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^o&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(o^t))+r[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^n&(i^o))+r[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^o&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(o^t))+r[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^n&(i^o))+r[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^o&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(o^t))+r[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=t+(o^n&(i^o))+r[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=o+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^o&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(o^t))+r[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^o&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(o^t))+r[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(i^o))+r[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^o&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(o^t))+r[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(i^o))+r[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^o&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(o^t))+r[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(i^o))+r[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^o&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=o+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(o^t))+r[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=n+(o^t&(i^o))+r[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=t+(n^i^o)+r[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^o^t)+r[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^o)+r[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^o^t)+r[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^o)+r[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^o^t)+r[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^o)+r[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=o+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=i+(o^t^n)+r[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^o^t)+r[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=t+(i^(n|~o))+r[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(o|~n))+r[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=t+(i^(n|~o))+r[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(o|~n))+r[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=t+(i^(n|~o))+r[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(o|~n))+r[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=n+(o^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((o=(t=n+((s=t+(i^(n|~o))+r[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=o+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((i=o+((s=i+(t^(o|~n))+r[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+o&4294967295}function pr(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var o=0|e[i];r&&o==t||(n[i]=o,r=!1)}this.g=n}(n=In.prototype).Ra=function(e){this.N=e},n.ja=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():gt.g(),this.C=this.u?ft(this.u):ft(gt),this.g.onreadystatechange=S(this.Oa,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(e){return void xn(this,e)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var o in r)n.set(o,r[o]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(var s=(o=i(r.keys())).next();!s.done;s=o.next())s=s.value,n.set(s,r.get(s))}for(r=Array.from(n.keys()).find((function(e){return"content-type"==e.toLowerCase()})),o=y.FormData&&e instanceof y.FormData,!(0<=x(Pn,t))||r||o||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r=(t=i(n)).next();!r.done;r=t.next())r=(n=i(r.value)).next().value,n=n.next().value,this.g.setRequestHeader(r,n);this.L&&(this.g.responseType=this.L),"withCredentials"in this.g&&this.g.withCredentials!==this.N&&(this.g.withCredentials=this.N);try{Nn(this),0<this.B&&((this.M=function(e){return $&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=S(this.xa,this)):this.A=$e(this.xa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){xn(this,e)}},n.xa=function(){void 0!==m&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ie(this,"timeout"),this.abort(8))},n.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Ie(this,"complete"),Ie(this,"abort"),Dn(this))},n.O=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Dn(this,!0)),In.Z.O.call(this)},n.Oa=function(){this.s||(this.G||this.v||this.l?Ln(this):this.nb())},n.nb=function(){Ln(this)},n.isActive=function(){return!!this.g},n.fa=function(){try{return 2<jn(this)?this.g.status:-1}catch(e){return-1}},n.ma=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},n.Za=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),On(t)}},n.La=function(){return this.m},n.Va=function(){return"string"==typeof this.j?this.j:String(this.j)},(n=Gn.prototype).ua=8,n.H=1,n.Qa=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.Y=Math.floor(1e5*Math.random()),e=this.Y++;var t,n=new _t(this,this.l,e),r=this.s;if(this.W&&(r?ue(r=ce(r),this.W):r=this.W),null!==this.o||this.P||(n.I=r,r=null),this.R)e:{for(var i=t=0;i<this.j.length;i++){var o=this.j[i];if(void 0===(o="__data__"in o.map&&"string"==typeof(o=o.map.__data__)?o.length:void 0))break;if(4096<(t+=o)){t=i;break e}if(4096===t||i===this.j.length-1){t=i+1;break e}}t=1e3}else t=1e3;t=Kn(this,n,t),Ht(i=Ut(this.I),"RID",e),Ht(i,"CVER",22),this.D&&Ht(i,"X-HTTP-Session-Id",this.D),Vn(this,i),r&&(this.P?t="headers="+encodeURIComponent(String(Fn(r)))+"&"+t:this.o&&Un(i,this.o,r)),fn(this.i,n),this.fb&&Ht(i,"TYPE","init"),this.R?(Ht(i,"$req",t),Ht(i,"SID","null"),n.ca=!0,St(n,i,null)):St(n,i,t),this.H=2}}else 3==this.H&&(e?zn(this,e):0==this.j.length||un(this.i)||zn(this))},n.Pa=function(){if(this.u=null,Jn(this),this.ea&&!(this.N||null==this.g||0>=this.T)){var e=2*this.T;this.l.info("BP detection timer enabled: "+e),this.B=lt(S(this.mb,this),e)}},n.mb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.N=!0,at(10),Hn(this),Jn(this))},n.lb=function(){null!=this.v&&(this.v=null,Hn(this),Qn(this),at(19))},n.sb=function(e){e?(this.l.info("Successfully pinged google.com"),at(2)):(this.l.info("Failed to ping google.com"),at(1))},n.isActive=function(){return!!this.h&&this.h.isActive(this)},(n=sr.prototype).Ea=function(){},n.Da=function(){},n.Ca=function(){},n.Ba=function(){},n.isActive=function(){return!0},n.Ya=function(){},ar.prototype.g=function(e,t){return new cr(e,t)},I(cr,Oe),cr.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;at(0),e.aa=t,e.qa=n||{},e.G=e.ca,e.I=ir(e,null,e.aa),Wn(e)},cr.prototype.close=function(){qn(this.g)},cr.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=ke(e),e=n);t.j.push(new an(t.ib++,e)),3==t.H&&Wn(t)},cr.prototype.O=function(){this.g.h=null,delete this.j,qn(this.g),delete this.g,cr.Z.O.call(this)},I(lr,yt),I(ur,vt),I(dr,sr),dr.prototype.Ea=function(){Ie(this.g,"a")},dr.prototype.Da=function(e){Ie(this.g,new lr(e))},dr.prototype.Ca=function(e){Ie(this.g,new ur(e))},dr.prototype.Ba=function(){Ie(this.g,"b")},I(hr,(function(){this.blockSize=-1})),hr.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},hr.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,o=0;o<t;){if(0==i)for(;o<=n;)fr(this,e,o),o+=this.blockSize;if("string"==typeof e){for(;o<t;)if(r[i++]=e.charCodeAt(o++),i==this.blockSize){fr(this,r),i=0;break}}else for(;o<t;)if(r[i++]=e[o++],i==this.blockSize){fr(this,r),i=0;break}}this.h=i,this.i+=t},hr.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var gr={};function mr(e){return-128<=e&&128>e?function(e,t){var n=gr;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new pr([0|e],0>e?-1:0)})):new pr([0|e],0>e?-1:0)}function yr(e){if(isNaN(e)||!isFinite(e))return br;if(0>e)return Ar(yr(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=vr;return new pr(t,0)}var vr=4294967296,br=mr(0),_r=mr(1),wr=mr(16777216);function Tr(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function Er(e){return-1==e.h}function Ar(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new pr(n,~e.h).add(_r)}function Sr(e,t){return e.add(Ar(t))}function Or(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function Ir(e,t){this.g=e,this.h=t}function Cr(e,t){if(Tr(t))throw Error("division by zero");if(Tr(e))return new Ir(br,br);if(Er(e))return t=Cr(Ar(e),t),new Ir(Ar(t.g),Ar(t.h));if(Er(t))return t=Cr(e,Ar(t)),new Ir(Ar(t.g),t.h);if(30<e.g.length){if(Er(e)||Er(t))throw Error("slowDivide_ only works with positive integers.");for(var n=_r,r=t;0>=r.$(e);)n=kr(n),r=kr(r);var i=Pr(n,1),o=Pr(r,1);for(r=Pr(r,2),n=Pr(n,2);!Tr(r);){var s=o.add(r);0>=s.$(e)&&(i=i.add(n),o=s),r=Pr(r,1),n=Pr(n,1)}return t=Sr(e,i.S(t)),new Ir(i,t)}for(i=br;0<=e.$(t);){for(n=Math.max(1,Math.floor(e.ga()/t.ga())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),s=(o=yr(n)).S(t);Er(s)||0<s.$(e);)s=(o=yr(n-=r)).S(t);Tr(o)&&(o=_r),i=i.add(o),e=Sr(e,s)}return new Ir(i,e)}function kr(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.F(r)<<1|e.F(r-1)>>>31;return new pr(n,e.h)}function Pr(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],o=0;o<r;o++)i[o]=0<t?e.F(o+n)>>>t|e.F(o+n+1)<<32-t:e.F(o+n);return new pr(i,e.h)}(n=pr.prototype).ga=function(){if(Er(this))return-Ar(this).ga();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.F(n);e+=(0<=r?r:vr+r)*t,t*=vr}return e},n.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(Tr(this))return"0";if(Er(this))return"-"+Ar(this).toString(e);for(var t=yr(Math.pow(e,6)),n=this,r="";;){var i=Cr(n,t).g,o=((0<(n=Sr(n,i.S(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(Tr(n=i))return o+r;for(;6>o.length;)o="0"+o;r=o+r}},n.F=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},n.$=function(e){return Er(e=Sr(this,e))?-1:Tr(e)?0:1},n.abs=function(){return Er(this)?Ar(this):this},n.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var o=r+(65535&this.F(i))+(65535&e.F(i)),s=(o>>>16)+(this.F(i)>>>16)+(e.F(i)>>>16);r=s>>>16,o&=65535,s&=65535,n[i]=s<<16|o}return new pr(n,-2147483648&n[n.length-1]?-1:0)},n.S=function(e){if(Tr(this)||Tr(e))return br;if(Er(this))return Er(e)?Ar(this).S(Ar(e)):Ar(Ar(this).S(e));if(Er(e))return Ar(this.S(Ar(e)));if(0>this.$(wr)&&0>e.$(wr))return yr(this.ga()*e.ga());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var o=this.F(r)>>>16,s=65535&this.F(r),a=e.F(i)>>>16,c=65535&e.F(i);n[2*r+2*i]+=s*c,Or(n,2*r+2*i),n[2*r+2*i+1]+=o*c,Or(n,2*r+2*i+1),n[2*r+2*i+1]+=s*a,Or(n,2*r+2*i+1),n[2*r+2*i+2]+=o*a,Or(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new pr(n,0)},n.jb=function(e){return Cr(this,e).h},n.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.F(r)&e.F(r);return new pr(n,this.h&e.h)},n.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.F(r)|e.F(r);return new pr(n,this.h|e.h)},n.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.F(r)^e.F(r);return new pr(n,this.h^e.h)},ar.prototype.createWebChannel=ar.prototype.g,cr.prototype.send=cr.prototype.u,cr.prototype.open=cr.prototype.m,cr.prototype.close=cr.prototype.close,ut.NO_ERROR=0,ut.TIMEOUT=8,ut.HTTP_ERROR=6,dt.COMPLETE="complete",pt.EventType=mt,mt.OPEN="a",mt.CLOSE="b",mt.ERROR="c",mt.MESSAGE="d",Oe.prototype.listen=Oe.prototype.P,In.prototype.listenOnce=In.prototype.R,In.prototype.getLastError=In.prototype.Va,In.prototype.getLastErrorCode=In.prototype.La,In.prototype.getStatus=In.prototype.fa,In.prototype.getResponseJson=In.prototype.Za,In.prototype.getResponseText=In.prototype.ma,In.prototype.send=In.prototype.ja,In.prototype.setWithCredentials=In.prototype.Ra,hr.prototype.digest=hr.prototype.l,hr.prototype.reset=hr.prototype.reset,hr.prototype.update=hr.prototype.j,pr.prototype.add=pr.prototype.add,pr.prototype.multiply=pr.prototype.S,pr.prototype.modulo=pr.prototype.jb,pr.prototype.compare=pr.prototype.$,pr.prototype.toNumber=pr.prototype.ga,pr.prototype.toString=pr.prototype.toString,pr.prototype.getBits=pr.prototype.F,pr.fromNumber=yr,pr.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return Ar(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=yr(Math.pow(n,8)),i=br,o=0;o<t.length;o+=8){var s=Math.min(8,t.length-o),a=parseInt(t.substring(o,o+s),n);8>s?(s=yr(Math.pow(n,s)),i=i.S(s).add(yr(a))):i=(i=i.S(r)).add(yr(a))}return i},e.exports.createWebChannelTransport=function(){return new ar},e.exports.getStatEventTarget=function(){return rt()},e.exports.ErrorCode=ut,e.exports.EventType=dt,e.exports.Event=tt,e.exports.Stat={Ab:0,Db:1,Eb:2,Xb:3,bc:4,Zb:5,$b:6,Yb:7,Wb:8,ac:9,PROXY:10,NOPROXY:11,Ub:12,Qb:13,Rb:14,Pb:15,Sb:16,Tb:17,wb:18,vb:19,xb:20},e.exports.FetchXmlHttpFactory=_n,e.exports.WebChannel=pt,e.exports.XhrIo=In,e.exports.Md5=hr,e.exports.Integer=pr}).apply(void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}).call(this,n(61))},,,function(e,t,n){"use strict";function r(e){return new Promise((t=>setTimeout(t,e)))}n.d(t,"a",(function(){return r}))},,function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));n(1238),n(1053);function r(e,t){let n=e.id;return"number"===t.autoPkType&&"string"==typeof n&&(n=parseInt(n),isNaN(n)&&(n=e.id)),n}function i(e,t,n){let r=t;return"number"===n.autoPkType&&(r=parseInt(r),isNaN(r)&&(r=t)),{type:e,id:r}}function o(e,t,n){if(!e)return null;const r={};for(const[t,i]of Object.entries(n))r[t]={type:i,id:e[t]};const i=Object.assign(Object.assign({reference:{type:t,id:e.id}},e),r);return delete i.id,i}},function(e,t,n){var r=n(268),i=n(266),o=n(126);e.exports=function(e){return r(e,o,i)}},function(e,t,n){var r=n(151),i=n(234);e.exports=function(e,t,n,o){var s=n.length,a=s,c=!o;if(null==e)return!a;for(e=Object(e);s--;){var l=n[s];if(c&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++s<a;){var u=(l=n[s])[0],d=e[u],h=l[1];if(c&&l[2]){if(void 0===d&&!(u in e))return!1}else{var f=new r;if(o)var p=o(d,h,u,e,t,f);if(!(void 0===p?i(h,d,3,o,f):p))return!1}}return!0}},function(e,t,n){var r=n(271),i=n(116);e.exports=function(e){for(var t=i(e),n=t.length;n--;){var o=t[n],s=e[o];t[n]=[o,s,r(s)]}return t}},function(e,t,n){var r=n(286),i=n(116);e.exports=function(e,t){return e&&r(e,t,i)}},function(e,t){function n(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}function r(e,t){var r=[],i=[];return null==t&&(t=function(e,t){return r[0]===t?"[Circular ~]":"[Circular ~."+i.slice(0,n(r,t)).join(".")+"]"}),function(o,s){if(r.length>0){var a=n(r,this);~a?r.splice(a+1):r.push(this),~a?i.splice(a,1/0,o):i.push(o),~n(r,s)&&(s=t.call(this,o,s))}else r.push(s);return null==e?s instanceof Error?function(e){var t={stack:e.stack,message:e.message,name:e.name};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}(s):s:e.call(this,o,s)}}(e.exports=function(e,t,n,i){return JSON.stringify(e,r(t,i),n)}).getSerialize=r},function(e,t,n){(function(e,r){var i;!function(){t&&t.nodeType,e&&e.nodeType;var o="object"==typeof r&&r;o.global!==o&&o.window!==o&&o.self;var s,a=2147483647,c=36,l=/^xn--/,u=/[^\x20-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,h={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,p=String.fromCharCode;function g(e){throw new RangeError(h[e])}function m(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function y(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+m((e=e.replace(d,".")).split("."),t).join(".")}function v(e){for(var t,n,r=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function b(e){return m(e,(function(e){var t="";return e>65535&&(t+=p((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=p(e)})).join("")}function _(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function w(e,t,n){var r=0;for(e=n?f(e/700):e>>1,e+=f(e/t);e>455;r+=c)e=f(e/35);return f(r+36*e/(e+38))}function T(e){var t,n,r,i,o,s,l,u,d,h,p,m=[],y=e.length,v=0,_=128,T=72;for((n=e.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&g("not-basic"),m.push(e.charCodeAt(r));for(i=n>0?n+1:0;i<y;){for(o=v,s=1,l=c;i>=y&&g("invalid-input"),((u=(p=e.charCodeAt(i++))-48<10?p-22:p-65<26?p-65:p-97<26?p-97:c)>=c||u>f((a-v)/s))&&g("overflow"),v+=u*s,!(u<(d=l<=T?1:l>=T+26?26:l-T));l+=c)s>f(a/(h=c-d))&&g("overflow"),s*=h;T=w(v-o,t=m.length+1,0==o),f(v/t)>a-_&&g("overflow"),_+=f(v/t),v%=t,m.splice(v++,0,_)}return b(m)}function E(e){var t,n,r,i,o,s,l,u,d,h,m,y,b,T,E,A=[];for(y=(e=v(e)).length,t=128,n=0,o=72,s=0;s<y;++s)(m=e[s])<128&&A.push(p(m));for(r=i=A.length,i&&A.push("-");r<y;){for(l=a,s=0;s<y;++s)(m=e[s])>=t&&m<l&&(l=m);for(l-t>f((a-n)/(b=r+1))&&g("overflow"),n+=(l-t)*b,t=l,s=0;s<y;++s)if((m=e[s])<t&&++n>a&&g("overflow"),m==t){for(u=n,d=c;!(u<(h=d<=o?1:d>=o+26?26:d-o));d+=c)E=u-h,T=c-h,A.push(p(_(h+E%T,0))),u=f(E/T);A.push(p(_(u,0))),o=w(n,b,r==i),n=0,++r}++n,++t}return A.join("")}s={version:"1.4.1",ucs2:{decode:v,encode:b},decode:T,encode:E,toASCII:function(e){return y(e,(function(e){return u.test(e)?"xn--"+E(e):e}))},toUnicode:function(e){return y(e,(function(e){return l.test(e)?T(e.slice(4).toLowerCase()):e}))}},void 0===(i=function(){return s}.call(t,n,t,e))||(e.exports=i)}()}).call(this,n(111)(e),n(61))},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.decodeXML=t.decodeHTMLStrict=t.decodeHTMLAttribute=t.decodeHTML=t.determineBranch=t.EntityDecoder=t.DecodingMode=t.BinTrieFlags=t.fromCodePoint=t.replaceCodePoint=t.decodeCodePoint=t.xmlDecodeTree=t.htmlDecodeTree=void 0;var a=s(n(789));t.htmlDecodeTree=a.default;var c=s(n(790));t.xmlDecodeTree=c.default;var l=o(n(601));t.decodeCodePoint=l.default;var u,d=n(601);Object.defineProperty(t,"replaceCodePoint",{enumerable:!0,get:function(){return d.replaceCodePoint}}),Object.defineProperty(t,"fromCodePoint",{enumerable:!0,get:function(){return d.fromCodePoint}}),function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"}(u||(u={}));var h,f,p;function g(e){return e>=u.ZERO&&e<=u.NINE}function m(e){return e===u.EQUALS||function(e){return e>=u.UPPER_A&&e<=u.UPPER_Z||e>=u.LOWER_A&&e<=u.LOWER_Z||g(e)}(e)}!function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"}(h=t.BinTrieFlags||(t.BinTrieFlags={})),function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"}(f||(f={})),function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"}(p=t.DecodingMode||(t.DecodingMode={}));var y=function(){function e(e,t,n){this.decodeTree=e,this.emitCodePoint=t,this.errors=n,this.state=f.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=p.Strict}return e.prototype.startEntity=function(e){this.decodeMode=e,this.state=f.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1},e.prototype.write=function(e,t){switch(this.state){case f.EntityStart:return e.charCodeAt(t)===u.NUM?(this.state=f.NumericStart,this.consumed+=1,this.stateNumericStart(e,t+1)):(this.state=f.NamedEntity,this.stateNamedEntity(e,t));case f.NumericStart:return this.stateNumericStart(e,t);case f.NumericDecimal:return this.stateNumericDecimal(e,t);case f.NumericHex:return this.stateNumericHex(e,t);case f.NamedEntity:return this.stateNamedEntity(e,t)}},e.prototype.stateNumericStart=function(e,t){return t>=e.length?-1:(32|e.charCodeAt(t))===u.LOWER_X?(this.state=f.NumericHex,this.consumed+=1,this.stateNumericHex(e,t+1)):(this.state=f.NumericDecimal,this.stateNumericDecimal(e,t))},e.prototype.addToNumericResult=function(e,t,n,r){if(t!==n){var i=n-t;this.result=this.result*Math.pow(r,i)+parseInt(e.substr(t,i),r),this.consumed+=i}},e.prototype.stateNumericHex=function(e,t){for(var n,r=t;t<e.length;){var i=e.charCodeAt(t);if(!(g(i)||(n=i,n>=u.UPPER_A&&n<=u.UPPER_F||n>=u.LOWER_A&&n<=u.LOWER_F)))return this.addToNumericResult(e,r,t,16),this.emitNumericEntity(i,3);t+=1}return this.addToNumericResult(e,r,t,16),-1},e.prototype.stateNumericDecimal=function(e,t){for(var n=t;t<e.length;){var r=e.charCodeAt(t);if(!g(r))return this.addToNumericResult(e,n,t,10),this.emitNumericEntity(r,2);t+=1}return this.addToNumericResult(e,n,t,10),-1},e.prototype.emitNumericEntity=function(e,t){var n;if(this.consumed<=t)return null===(n=this.errors)||void 0===n||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===u.SEMI)this.consumed+=1;else if(this.decodeMode===p.Strict)return 0;return this.emitCodePoint((0,l.replaceCodePoint)(this.result),this.consumed),this.errors&&(e!==u.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed},e.prototype.stateNamedEntity=function(e,t){for(var n=this.decodeTree,r=n[this.treeIndex],i=(r&h.VALUE_LENGTH)>>14;t<e.length;t++,this.excess++){var o=e.charCodeAt(t);if(this.treeIndex=b(n,r,this.treeIndex+Math.max(1,i),o),this.treeIndex<0)return 0===this.result||this.decodeMode===p.Attribute&&(0===i||m(o))?0:this.emitNotTerminatedNamedEntity();if(0!==(i=((r=n[this.treeIndex])&h.VALUE_LENGTH)>>14)){if(o===u.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==p.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1},e.prototype.emitNotTerminatedNamedEntity=function(){var e,t=this.result,n=(this.decodeTree[t]&h.VALUE_LENGTH)>>14;return this.emitNamedEntityData(t,n,this.consumed),null===(e=this.errors)||void 0===e||e.missingSemicolonAfterCharacterReference(),this.consumed},e.prototype.emitNamedEntityData=function(e,t,n){var r=this.decodeTree;return this.emitCodePoint(1===t?r[e]&~h.VALUE_LENGTH:r[e+1],n),3===t&&this.emitCodePoint(r[e+2],n),n},e.prototype.end=function(){var e;switch(this.state){case f.NamedEntity:return 0===this.result||this.decodeMode===p.Attribute&&this.result!==this.treeIndex?0:this.emitNotTerminatedNamedEntity();case f.NumericDecimal:return this.emitNumericEntity(0,2);case f.NumericHex:return this.emitNumericEntity(0,3);case f.NumericStart:return null===(e=this.errors)||void 0===e||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case f.EntityStart:return 0}},e}();function v(e){var t="",n=new y(e,(function(e){return t+=(0,l.fromCodePoint)(e)}));return function(e,r){for(var i=0,o=0;(o=e.indexOf("&",o))>=0;){t+=e.slice(i,o),n.startEntity(r);var s=n.write(e,o+1);if(s<0){i=o+n.end();break}i=o+s,o=0===s?i+1:i}var a=t+e.slice(i);return t="",a}}function b(e,t,n,r){var i=(t&h.BRANCH_LENGTH)>>7,o=t&h.JUMP_TABLE;if(0===i)return 0!==o&&r===o?n:-1;if(o){var s=r-o;return s<0||s>=i?-1:e[n+s]-1}for(var a=n,c=a+i-1;a<=c;){var l=a+c>>>1,u=e[l];if(u<r)a=l+1;else{if(!(u>r))return e[l+i];c=l-1}}return-1}t.EntityDecoder=y,t.determineBranch=b;var _=v(a.default),w=v(c.default);t.decodeHTML=function(e,t){return void 0===t&&(t=p.Legacy),_(e,t)},t.decodeHTMLAttribute=function(e){return _(e,p.Attribute)},t.decodeHTMLStrict=function(e){return _(e,p.Strict)},t.decodeXML=function(e){return w(e,p.Strict)}},,function(e,t,n){(function(t){var r=n(571),i="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},o=i.Raven,s=new r;s.noConflict=function(){return i.Raven=o,s},s.afterLoad(),e.exports=s,e.exports.Client=r}).call(this,n(61))},function(e,t,n){"use strict";var r=function(e){return e},i=function(){},o=function(){return!0};e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.breadcrumbDataFromAction,s=void 0===n?i:n,a=t.actionTransformer,c=void 0===a?r:a,l=t.stateTransformer,u=void 0===l?r:l,d=t.breadcrumbCategory,h=void 0===d?"redux-action":d,f=t.filterBreadcrumbActions,p=void 0===f?o:f,g=t.getUserContext,m=t.getTags;return function(t){var n=void 0;return e.setDataCallback((function(e,r){var i=t.getState(),o={lastAction:c(n),state:u(i)};return e.extra=Object.assign(o,e.extra),g&&(e.user=g(i)),m&&(e.tags=m(i)),r?r(e):e})),function(t){return function(r){return p(r)&&e.captureBreadcrumb({category:h,message:r.type,data:s(r)}),n=r,t(r)}}}}},,,,,,function(e,t,n){"use strict";var r,i,o,s;n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),function(e){e.Delete="delete",e.Overwrite="overwrite",e.ListTreeMove="listTreeMove",e.ListTreeDelete="listTreeDelete"}(r||(r={})),function(e){e.UploadToStorage="upload-to-storage"}(i||(i={})),function(e){e.Normal="normal",e.Persistent="persistent"}(o||(o={})),function(e){e.PDF="application/x-memex-pdf-content",e.HTML="application/x-memex-html-body"}(s||(s={}))},function(e,t){e.exports=function(){}},function(e,t,n){var r=n(223),i=n(274),o=n(174);e.exports=function(e){return o(i(e,void 0,r),e+"")}},function(e,t,n){var r=n(125),i=n(134),o=n(138),s=n(48);e.exports=function(e,t,n){if(!s(n))return!1;var a=typeof t;return!!("number"==a?i(n)&&o(t,n.length):"string"==a&&t in n)&&r(n[t],e)}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s={sunday:0,sun:0,monday:1,mon:1,tuesday:2,tues:2,tue:2,wednesday:3,wed:3,thursday:4,thurs:4,thur:4,thu:4,friday:5,fri:5,saturday:6,sat:6},a=new RegExp("(\\W|^)(?:(?:\\,|\\(|\\\uff08)\\s*)?(?:on\\s*?)?(?:(this|last|past|next)\\s*)?("+Object.keys(s).join("|")+")(?:\\s*(?:\\,|\\)|\\\uff09))?(?:\\s*(this|last|past|next)\\s*week)?(?=\\W|$)","i");t.updateParsedComponent=function(e,t,n,i){var o=r(t),s=!1,a=o.day();return"last"==i||"past"==i?(o.day(n-7),s=!0):"next"==i?(o.day(n+7),s=!0):"this"==i?o.day(n):Math.abs(n-7-a)<Math.abs(n-a)?o.day(n-7):Math.abs(n+7-a)<Math.abs(n-a)?o.day(n+7):o.day(n),e.start.assign("weekday",n),s?(e.start.assign("day",o.date()),e.start.assign("month",o.month()+1),e.start.assign("year",o.year())):(e.start.imply("day",o.date()),e.start.imply("month",o.month()+1),e.start.imply("year",o.year())),e},t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,n,r,i){var a=r.index+r[1].length,c=(e=r[0].substr(r[1].length,r[0].length-r[1].length),new o({index:a,text:e,ref:n})),l=r[3].toLowerCase(),u=s[l];if(void 0===u)return null;var d=r[2],h=r[4],f=d||h;return f=(f=f||"").toLowerCase(),t.updateParsedComponent(c,n,u,f),c.tags.ENWeekdayParser=!0,c}}},function(e,t){var n={"\u96f6":0,"\u4e00":1,"\u4e8c":2,"\u5169":2,"\u4e09":3,"\u56db":4,"\u4e94":5,"\u516d":6,"\u4e03":7,"\u516b":8,"\u4e5d":9,"\u5341":10,"\u5eff":20,"\u5345":30};t.NUMBER=n,t.WEEKDAY_OFFSET={"\u5929":0,"\u65e5":0,"\u4e00":1,"\u4e8c":2,"\u4e09":3,"\u56db":4,"\u4e94":5,"\u516d":6},t.zhStringToNumber=function(e){for(var t=0,r=0;r<e.length;r++){var i=e[r];"\u5341"===i?t=0===t?n[i]:t*n[i]:t+=n[i]}return t},t.zhStringToYear=function(e){for(var t="",r=0;r<e.length;r++){var i=e[r];t+=n[i]}return parseInt(t)}},function(e,t){t.WEEKDAY_OFFSET={sonntag:0,so:0,montag:1,mo:1,dienstag:2,di:2,mittwoch:3,mi:3,donnerstag:4,do:4,freitag:5,fr:5,samstag:6,sa:6},t.MONTH_OFFSET={januar:1,jan:1,"jan.":1,februar:2,feb:2,"feb.":2,"m\xe4rz":3,maerz:3,"m\xe4r":3,"m\xe4r.":3,mrz:3,"mrz.":3,april:4,apr:4,"apr.":4,mai:5,juni:6,jun:6,"jun.":6,juli:7,jul:7,"jul.":7,august:8,aug:8,"aug.":8,september:9,sep:9,"sep.":9,sept:9,"sept.":9,oktober:10,okt:10,"okt.":10,november:11,nov:11,"nov.":11,dezember:12,dez:12,"dez.":12},t.INTEGER_WORDS_PATTERN="(?:eins|zwei|drei|vier|f\xfcnf|fuenf|sechs|sieben|acht|neun|zehn|elf|zw\xf6lf|zwoelf)",t.INTEGER_WORDS={eins:1,zwei:2,drei:3,vier:4,"f\xfcnf":5,fuenf:5,sechs:6,sieben:7,acht:8,neun:9,zehn:10,elf:11,"zw\xf6lf":12,zwoelf:12}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));const r="http://localhost:11922",i={STATUS:`${r}/status`,LOCATION:`${r}/backup/location`,CHANGE_LOCATION:`${r}/backup/start-change-location`}},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s.a})),n.d(t,"a",(function(){return a}));var r=n(2),i=n(321);class o extends i.a{constructor(){super(...arguments),this.getPks=({collection:e,fieldName:t,opName:n,opValue:r,filter:i,reverse:o})=>{const s=this.backend.dexieInstance.table(e);let a;switch(n){case"anyOf":a=s.where(t).anyOf(r);break;case"equals":a=s.where(t).equals(r);break;default:a=s.toCollection()}return i&&(a=a.filter(i)),o&&(a=a.reverse()),a.primaryKeys()},this.countByRegexp=e=>this.queryByRegexp(e).count(),this.recreateDatabase=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.backend.dexieInstance.delete(),yield this.backend.dexieInstance.open()})),this.findByPk=({collection:e,pk:t})=>this.backend.dexieInstance.table(e).get(t)}install(e){super.install(e),e.registerOperation(o.FIND_BY_PK_OP,this.findByPk.bind(this)),e.registerOperation(o.GET_PKS_OP,this.getPks.bind(this)),e.registerOperation(o.REGEXP_DELETE_OP,this.deleteByRegexp.bind(this)),e.registerOperation(o.REGEXP_COUNT_OP,this.countByRegexp.bind(this)),e.registerOperation(o.NUKE_DB_OP,this.recreateDatabase.bind(this))}queryByRegexp({collection:e,fieldName:t,pattern:n}){const r="string"==typeof n?new RegExp(n,"i"):n;return this.backend.dexieInstance.table(e).filter((e=>r.test(e[t])))}deleteByRegexp(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.queryByRegexp(e).primaryKeys();yield this.backend.executeBatch([{collection:"visits",operation:"deleteObjects",where:{url:{$in:t}}},{collection:"bookmarks",operation:"deleteObjects",where:{url:{$in:t}}},{collection:"tags",operation:"deleteObjects",where:{url:{$in:t}}},{collection:"pageListEntries",operation:"deleteObjects",where:{pageUrl:{$in:t}}},{collection:"locators",operation:"deleteObjects",where:{normalizedUrl:{$in:t}}},{collection:"annotations",operation:"deleteObjects",where:{pageUrl:{$in:t}}},{collection:"pages",operation:"deleteObjects",where:{url:{$in:t}}}])}))}}o.FIND_BY_PK_OP="memex:dexie.findByPk",o.GET_PKS_OP="memex:dexie.getPks",o.NUKE_DB_OP="memex:dexie.recreateDatabase",o.REGEXP_COUNT_OP="memex:dexie.countByRegexp",o.REGEXP_DELETE_OP="memex:dexie.deleteByRegexp";var s=n(728);class a extends i.a{install(e){super.install(e),e.registerOperation(a.QUEUE_CHANGES,this.queueCollectionChanges.bind(this))}queueCollectionChanges({collections:e,chunkSize:t=1e3}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=this.backend.dexieInstance;let r=0;for(const i of e){let e,o=0;do{e=yield n.table(i).toCollection().offset(o*t).limit(t).primaryKeys();const s=e.map((e=>({timestamp:r++,operation:"create",collection:i,objectPk:e})));yield n.table("backupChanges").bulkPut(s),o++}while(e.length===t)}}))}}a.QUEUE_CHANGES="memex:dexie.queueCollectionChanges"},,function(e,t,n){var r=n(463),i=n(464);e.exports=function(e,t){return null!=e&&i(e,t,r)}},function(e,t,n){var r=n(183),i=n(469);e.exports=function e(t,n,o,s,a){var c=-1,l=t.length;for(o||(o=i),a||(a=[]);++c<l;){var u=t[c];n>0&&o(u)?n>1?e(u,n-1,o,s,a):r(a,u):s||(a[a.length]=u)}return a}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)3&t||(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,i=n;return[i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],"-",i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]],i[e[r++]]].join("")}},function(e,t,n){"use strict";const r=n(718),i=n(719);e.exports=e=>{const t=`(?:${"(?:(?:[a-z]+:)?//)"+((e=Object.assign({strict:!0},e)).strict?"":"?")}|www\\.)(?:\\S+(?::\\S*)?@)?(?:localhost|${r.v4().source}|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*${`(?:\\.${e.strict?"(?:[a-z\\u00a1-\\uffff]{2,})":`(?:${i.sort(((e,t)=>t.length-e.length)).join("|")})`})\\.?`})(?::\\d{2,5})?(?:[/?#][^\\s"]*)?`;return e.exact?new RegExp(`(?:^${t}$)`,"i"):new RegExp(t,"ig")}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return y})),n.d(t,"a",(function(){return v}));var r=n(2),i=n(11),o=n(700),s=n(702),a=n(51),c=n(104),l=n(56),u=n.n(l),d=n(699),h=n.n(d),f=n(217),p=n.n(f);const g=e=>e.filterByDomains.length>0||e.filterByPDFs||e.filterByVideos||e.filterByTweets||e.filterByEvents||e.omitPagesWithoutAnnotations,m=e=>[...e].sort((([,e],[,t])=>{var n,r,i,o;return Math.max(t.latestPageTimestamp,null!==(r=null===(n=t.annotations[0])||void 0===n?void 0:n.lastEdited.valueOf())&&void 0!==r?r:0)-Math.max(e.latestPageTimestamp,null!==(o=null===(i=e.annotations[0])||void 0===i?void 0:i.lastEdited.valueOf())&&void 0!==o?o:0)})),y=(e,{limit:t,skip:n})=>new Map(e.slice(n,n+t));function v(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=g(n);if(!r&&!t.size&&!n.filterByListIds.length)return;const l=new Set;if(r&&t.forEach((({annotations:e},t)=>{(n.omitPagesWithoutAnnotations&&!e.length||n.filterByEvents&&!Object(o.a)(t)||n.filterByTweets&&!Object(s.a)(t)||n.filterByVideos&&!Object(a.d)(t)||n.filterByPDFs&&!Object(c.e)({url:t})||n.filterByDomains.length&&!n.filterByDomains.reduce(((e,n)=>{const r=new RegExp(`^(\\w+\\.)?${n}`);return e||r.test(t)}),!1))&&l.add(t)})),l.forEach((e=>t.delete(e))),!t.size||!n.filterByListIds.length)return;const d=[],f=new Map;t.forEach((({annotations:e},t)=>e.forEach((e=>{d.push(e.url),f.set(e.url,t)}))));const m=yield e.collection("annotationPrivacyLevels").findObjects({annotation:{$in:d}}),y=u()(m.map((e=>[e.annotation,e.privacyLevel])));let[v,b]=h()(d,(e=>[i.a.PROTECTED,i.a.PRIVATE].includes(y[e])));const _=(e=[])=>{const t=e.map((e=>e.listId));return n.filterByListIds.reduce(((e,n)=>e&&t.includes(n)),!0)},w=yield e.collection("annotListEntries").findObjects({listId:{$in:n.filterByListIds},url:{$in:v}}),T=p()(w,(e=>e.url));v=v.filter((e=>_(T[e])));const E=yield e.collection("pageListEntries").findObjects({listId:{$in:n.filterByListIds},pageUrl:{$in:[...t.keys()]}}),A=p()(E,(e=>e.pageUrl));b=b.filter((e=>_(A[f.get(e)]))),t.forEach(((e,t)=>{e.annotations=e.annotations.filter((e=>v.includes(e.url)||b.includes(e.url))),e.annotations.length||_(A[t])||l.add(t)})),l.forEach((e=>t.delete(e)))}))}},function(e,t,n){(function(e){("undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{}).SENTRY_RELEASE={id:"3.20.14"}}).call(this,n(61))},function(e,t,n){var r=n(364),i=n(164),o=Array.prototype.push;function s(e,t){return 2==t?function(t,n){return e(t,n)}:function(t){return e(t)}}function a(e){for(var t=e?e.length:0,n=Array(t);t--;)n[t]=e[t];return n}function c(e,t){return function(){var n=arguments.length;if(n){for(var r=Array(n);n--;)r[n]=arguments[n];var i=r[0]=t.apply(void 0,r);return e.apply(void 0,r),i}}}e.exports=function e(t,n,l,u){var d="function"==typeof n,h=n===Object(n);if(h&&(u=l,l=n,n=void 0),null==l)throw new TypeError;u||(u={});var f=!("cap"in u)||u.cap,p=!("curry"in u)||u.curry,g=!("fixed"in u)||u.fixed,m=!("immutable"in u)||u.immutable,y=!("rearg"in u)||u.rearg,v=d?l:i,b="curry"in u&&u.curry,_="fixed"in u&&u.fixed,w="rearg"in u&&u.rearg,T=d?l.runInContext():void 0,E=d?l:{ary:t.ary,assign:t.assign,clone:t.clone,curry:t.curry,forEach:t.forEach,isArray:t.isArray,isError:t.isError,isFunction:t.isFunction,isWeakMap:t.isWeakMap,iteratee:t.iteratee,keys:t.keys,rearg:t.rearg,toInteger:t.toInteger,toPath:t.toPath},A=E.ary,S=E.assign,O=E.clone,I=E.curry,C=E.forEach,k=E.isArray,P=E.isError,x=E.isFunction,R=E.isWeakMap,L=E.keys,D=E.rearg,N=E.toInteger,j=E.toPath,M=L(r.aryMethod),F={castArray:function(e){return function(){var t=arguments[0];return k(t)?e(a(t)):e.apply(void 0,arguments)}},iteratee:function(e){return function(){var t=arguments[1],n=e(arguments[0],t),r=n.length;return f&&"number"==typeof t?(t=t>2?t-2:1,r&&r<=t?n:s(n,t)):n}},mixin:function(e){return function(t){var n=this;if(!x(n))return e(n,Object(t));var r=[];return C(L(t),(function(e){x(t[e])&&r.push([e,n.prototype[e]])})),e(n,Object(t)),C(r,(function(e){var t=e[1];x(t)?n.prototype[e[0]]=t:delete n.prototype[e[0]]})),n}},nthArg:function(e){return function(t){var n=t<0?1:N(t)+1;return I(e(t),n)}},rearg:function(e){return function(t,n){var r=n?n.length:0;return I(e(t,n),r)}},runInContext:function(n){return function(r){return e(t,n(r),u)}}};function U(e,t){if(f){var n=r.iterateeRearg[e];if(n)return function(e,t){return $(e,(function(e){var n=t.length;return function(e,t){return 2==t?function(t,n){return e.apply(void 0,arguments)}:function(t){return e.apply(void 0,arguments)}}(D(s(e,n),t),n)}))}(t,n);var i=!d&&r.iterateeAry[e];if(i)return function(e,t){return $(e,(function(e){return"function"==typeof e?s(e,t):e}))}(t,i)}return t}function B(e,t,n){if(g&&(_||!r.skipFixed[e])){var i=r.methodSpread[e],s=i&&i.start;return void 0===s?A(t,n):function(e,t){return function(){for(var n=arguments.length,r=n-1,i=Array(n);n--;)i[n]=arguments[n];var s=i[t],a=i.slice(0,t);return s&&o.apply(a,s),t!=r&&o.apply(a,i.slice(t+1)),e.apply(this,a)}}(t,s)}return t}function G(e,t,n){return y&&n>1&&(w||!r.skipRearg[e])?D(t,r.methodRearg[e]||r.aryRearg[n]):t}function q(e,t){for(var n=-1,r=(t=j(t)).length,i=r-1,o=O(Object(e)),s=o;null!=s&&++n<r;){var a=t[n],c=s[a];null==c||x(c)||P(c)||R(c)||(s[a]=O(n==i?c:Object(c))),s=s[a]}return o}function H(t,n){var i=r.aliasToReal[t]||t,o=r.remap[i]||i,s=u;return function(t){var r=d?T:E,a=d?T[o]:n,c=S(S({},s),t);return e(r,i,a,c)}}function $(e,t){return function(){var n=arguments.length;if(!n)return e();for(var r=Array(n);n--;)r[n]=arguments[n];var i=y?0:n-1;return r[i]=t(r[i]),e.apply(void 0,r)}}function W(e,t,n){var i,o=r.aliasToReal[e]||e,s=t,l=F[o];return l?s=l(t):m&&(r.mutate.array[o]?s=c(t,a):r.mutate.object[o]?s=c(t,function(e){return function(t){return e({},t)}}(t)):r.mutate.set[o]&&(s=c(t,q))),C(M,(function(e){return C(r.aryMethod[e],(function(t){if(o==t){var n=r.methodSpread[o],a=n&&n.afterRearg;return i=a?B(o,G(o,s,e),e):G(o,B(o,s,e),e),i=function(e,t,n){return b||p&&n>1?I(t,n):t}(0,i=U(o,i),e),!1}})),!i})),i||(i=s),i==t&&(i=b?I(i,1):function(){return t.apply(this,arguments)}),i.convert=H(o,t),i.placeholder=t.placeholder=n,i}if(!h)return W(n,l,v);var z=l,V=[];return C(M,(function(e){C(r.aryMethod[e],(function(e){var t=z[r.remap[e]||e];t&&V.push([e,W(e,t,z)])}))})),C(L(z),(function(e){var t=z[e];if("function"==typeof t){for(var n=V.length;n--;)if(V[n][0]==e)return;t.convert=H(e,t),V.push([e,t])}})),C(V,(function(e){z[e[0]]=e[1]})),z.convert=function(e){return z.runInContext.convert(e)(void 0)},z.placeholder=z,C(L(z),(function(e){C(r.realToAlias[e]||[],(function(t){z[t]=z[e]}))})),z}},function(e,t){t.aliasToReal={each:"forEach",eachRight:"forEachRight",entries:"toPairs",entriesIn:"toPairsIn",extend:"assignIn",extendAll:"assignInAll",extendAllWith:"assignInAllWith",extendWith:"assignInWith",first:"head",conforms:"conformsTo",matches:"isMatch",property:"get",__:"placeholder",F:"stubFalse",T:"stubTrue",all:"every",allPass:"overEvery",always:"constant",any:"some",anyPass:"overSome",apply:"spread",assoc:"set",assocPath:"set",complement:"negate",compose:"flowRight",contains:"includes",dissoc:"unset",dissocPath:"unset",dropLast:"dropRight",dropLastWhile:"dropRightWhile",equals:"isEqual",identical:"eq",indexBy:"keyBy",init:"initial",invertObj:"invert",juxt:"over",omitAll:"omit",nAry:"ary",path:"get",pathEq:"matchesProperty",pathOr:"getOr",paths:"at",pickAll:"pick",pipe:"flow",pluck:"map",prop:"get",propEq:"matchesProperty",propOr:"getOr",props:"at",symmetricDifference:"xor",symmetricDifferenceBy:"xorBy",symmetricDifferenceWith:"xorWith",takeLast:"takeRight",takeLastWhile:"takeRightWhile",unapply:"rest",unnest:"flatten",useWith:"overArgs",where:"conformsTo",whereEq:"isMatch",zipObj:"zipObject"},t.aryMethod={1:["assignAll","assignInAll","attempt","castArray","ceil","create","curry","curryRight","defaultsAll","defaultsDeepAll","floor","flow","flowRight","fromPairs","invert","iteratee","memoize","method","mergeAll","methodOf","mixin","nthArg","over","overEvery","overSome","rest","reverse","round","runInContext","spread","template","trim","trimEnd","trimStart","uniqueId","words","zipAll"],2:["add","after","ary","assign","assignAllWith","assignIn","assignInAllWith","at","before","bind","bindAll","bindKey","chunk","cloneDeepWith","cloneWith","concat","conformsTo","countBy","curryN","curryRightN","debounce","defaults","defaultsDeep","defaultTo","delay","difference","divide","drop","dropRight","dropRightWhile","dropWhile","endsWith","eq","every","filter","find","findIndex","findKey","findLast","findLastIndex","findLastKey","flatMap","flatMapDeep","flattenDepth","forEach","forEachRight","forIn","forInRight","forOwn","forOwnRight","get","groupBy","gt","gte","has","hasIn","includes","indexOf","intersection","invertBy","invoke","invokeMap","isEqual","isMatch","join","keyBy","lastIndexOf","lt","lte","map","mapKeys","mapValues","matchesProperty","maxBy","meanBy","merge","mergeAllWith","minBy","multiply","nth","omit","omitBy","overArgs","pad","padEnd","padStart","parseInt","partial","partialRight","partition","pick","pickBy","propertyOf","pull","pullAll","pullAt","random","range","rangeRight","rearg","reject","remove","repeat","restFrom","result","sampleSize","some","sortBy","sortedIndex","sortedIndexOf","sortedLastIndex","sortedLastIndexOf","sortedUniqBy","split","spreadFrom","startsWith","subtract","sumBy","take","takeRight","takeRightWhile","takeWhile","tap","throttle","thru","times","trimChars","trimCharsEnd","trimCharsStart","truncate","union","uniqBy","uniqWith","unset","unzipWith","without","wrap","xor","zip","zipObject","zipObjectDeep"],3:["assignInWith","assignWith","clamp","differenceBy","differenceWith","findFrom","findIndexFrom","findLastFrom","findLastIndexFrom","getOr","includesFrom","indexOfFrom","inRange","intersectionBy","intersectionWith","invokeArgs","invokeArgsMap","isEqualWith","isMatchWith","flatMapDepth","lastIndexOfFrom","mergeWith","orderBy","padChars","padCharsEnd","padCharsStart","pullAllBy","pullAllWith","rangeStep","rangeStepRight","reduce","reduceRight","replace","set","slice","sortedIndexBy","sortedLastIndexBy","transform","unionBy","unionWith","update","xorBy","xorWith","zipWith"],4:["fill","setWith","updateWith"]},t.aryRearg={2:[1,0],3:[2,0,1],4:[3,2,0,1]},t.iterateeAry={dropRightWhile:1,dropWhile:1,every:1,filter:1,find:1,findFrom:1,findIndex:1,findIndexFrom:1,findKey:1,findLast:1,findLastFrom:1,findLastIndex:1,findLastIndexFrom:1,findLastKey:1,flatMap:1,flatMapDeep:1,flatMapDepth:1,forEach:1,forEachRight:1,forIn:1,forInRight:1,forOwn:1,forOwnRight:1,map:1,mapKeys:1,mapValues:1,partition:1,reduce:2,reduceRight:2,reject:1,remove:1,some:1,takeRightWhile:1,takeWhile:1,times:1,transform:2},t.iterateeRearg={mapKeys:[1],reduceRight:[1,0]},t.methodRearg={assignInAllWith:[1,0],assignInWith:[1,2,0],assignAllWith:[1,0],assignWith:[1,2,0],differenceBy:[1,2,0],differenceWith:[1,2,0],getOr:[2,1,0],intersectionBy:[1,2,0],intersectionWith:[1,2,0],isEqualWith:[1,2,0],isMatchWith:[2,1,0],mergeAllWith:[1,0],mergeWith:[1,2,0],padChars:[2,1,0],padCharsEnd:[2,1,0],padCharsStart:[2,1,0],pullAllBy:[2,1,0],pullAllWith:[2,1,0],rangeStep:[1,2,0],rangeStepRight:[1,2,0],setWith:[3,1,2,0],sortedIndexBy:[2,1,0],sortedLastIndexBy:[2,1,0],unionBy:[1,2,0],unionWith:[1,2,0],updateWith:[3,1,2,0],xorBy:[1,2,0],xorWith:[1,2,0],zipWith:[1,2,0]},t.methodSpread={assignAll:{start:0},assignAllWith:{start:0},assignInAll:{start:0},assignInAllWith:{start:0},defaultsAll:{start:0},defaultsDeepAll:{start:0},invokeArgs:{start:2},invokeArgsMap:{start:2},mergeAll:{start:0},mergeAllWith:{start:0},partial:{start:1},partialRight:{start:1},without:{start:1},zipAll:{start:0}},t.mutate={array:{fill:!0,pull:!0,pullAll:!0,pullAllBy:!0,pullAllWith:!0,pullAt:!0,remove:!0,reverse:!0},object:{assign:!0,assignAll:!0,assignAllWith:!0,assignIn:!0,assignInAll:!0,assignInAllWith:!0,assignInWith:!0,assignWith:!0,defaults:!0,defaultsAll:!0,defaultsDeep:!0,defaultsDeepAll:!0,merge:!0,mergeAll:!0,mergeAllWith:!0,mergeWith:!0},set:{set:!0,setWith:!0,unset:!0,update:!0,updateWith:!0}},t.realToAlias=function(){var e=Object.prototype.hasOwnProperty,n=t.aliasToReal,r={};for(var i in n){var o=n[i];e.call(r,o)?r[o].push(i):r[o]=[i]}return r}(),t.remap={assignAll:"assign",assignAllWith:"assignWith",assignInAll:"assignIn",assignInAllWith:"assignInWith",curryN:"curry",curryRightN:"curryRight",defaultsAll:"defaults",defaultsDeepAll:"defaultsDeep",findFrom:"find",findIndexFrom:"findIndex",findLastFrom:"findLast",findLastIndexFrom:"findLastIndex",getOr:"get",includesFrom:"includes",indexOfFrom:"indexOf",invokeArgs:"invoke",invokeArgsMap:"invokeMap",lastIndexOfFrom:"lastIndexOf",mergeAll:"merge",mergeAllWith:"mergeWith",padChars:"pad",padCharsEnd:"padEnd",padCharsStart:"padStart",propertyOf:"get",rangeStep:"range",rangeStepRight:"rangeRight",restFrom:"rest",spreadFrom:"spread",trimChars:"trim",trimCharsEnd:"trimEnd",trimCharsStart:"trimStart",zipAll:"zip"},t.skipFixed={castArray:!0,flow:!0,flowRight:!0,iteratee:!0,mixin:!0,rearg:!0,runInContext:!0},t.skipRearg={add:!0,assign:!0,assignIn:!0,bind:!0,bindKey:!0,concat:!0,difference:!0,divide:!0,eq:!0,gt:!0,gte:!0,isEqual:!0,lt:!0,lte:!0,matchesProperty:!0,merge:!0,multiply:!0,overArgs:!0,partial:!0,partialRight:!0,propertyOf:!0,random:!0,range:!0,rangeRight:!0,subtract:!0,zip:!0,zipObject:!0,zipObjectDeep:!0}},function(e,t,n){e.exports={ary:n(366),assign:n(261),clone:n(402),curry:n(443),forEach:n(175),isArray:n(41),isError:n(444),isFunction:n(148),isWeakMap:n(445),iteratee:n(446),keys:n(263),rearg:n(468),toInteger:n(236),toPath:n(470)}},function(e,t,n){var r=n(170);e.exports=function(e,t,n){return t=n?void 0:t,t=e&&null==t?e.length:t,r(e,128,void 0,void 0,void 0,void 0,t)}},function(e,t,n){var r=n(148),i=n(370),o=n(48),s=n(249),a=/^\[object .+?Constructor\]$/,c=Function.prototype,l=Object.prototype,u=c.toString,d=l.hasOwnProperty,h=RegExp("^"+u.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!o(e)||i(e))&&(r(e)?h:a).test(s(e))}},function(e,t,n){var r=n(96),i=Object.prototype,o=i.hasOwnProperty,s=i.toString,a=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,a),n=e[a];try{e[a]=void 0;var r=!0}catch(e){}var i=s.call(e);return r&&(t?e[a]=n:delete e[a]),i}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t,n){var r,i=n(371),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";e.exports=function(e){return!!o&&o in e}},function(e,t,n){var r=n(40)["__core-js_shared__"];e.exports=r},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,n){var r=n(141),i=n(40);e.exports=function(e,t,n){var o=1&t,s=r(e);return function t(){return(this&&this!==i&&this instanceof t?s:e).apply(o?n:this,arguments)}}},function(e,t,n){var r=n(171),i=n(141),o=n(250),s=n(253),a=n(260),c=n(176),l=n(40);e.exports=function(e,t,n){var u=i(e);return function i(){for(var d=arguments.length,h=Array(d),f=d,p=a(i);f--;)h[f]=arguments[f];var g=d<3&&h[0]!==p&&h[d-1]!==p?[]:c(h,p);return(d-=g.length)<n?s(e,t,o,i.placeholder,void 0,h,g,void 0,void 0,n-d):r(this&&this!==l&&this instanceof i?u:e,this,h)}}},function(e,t){e.exports=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}},function(e,t,n){var r=n(172),i=n(254),o=n(377),s=n(379);e.exports=function(e){var t=o(e),n=s[t];if("function"!=typeof n||!(t in r.prototype))return!1;if(e===n)return!0;var a=i(n);return!!a&&e===a[0]}},function(e,t,n){var r=n(378),i=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",n=r[t],o=i.call(r,t)?n.length:0;o--;){var s=n[o],a=s.func;if(null==a||a==e)return s.name}return t}},function(e,t){e.exports={}},function(e,t,n){var r=n(172),i=n(255),o=n(173),s=n(41),a=n(50),c=n(380),l=Object.prototype.hasOwnProperty;function u(e){if(a(e)&&!s(e)&&!(e instanceof r)){if(e instanceof i)return e;if(l.call(e,"__wrapped__"))return c(e)}return new i(e)}u.prototype=o.prototype,u.prototype.constructor=u,e.exports=u},function(e,t,n){var r=n(172),i=n(255),o=n(124);e.exports=function(e){if(e instanceof r)return e.clone();var t=new i(e.__wrapped__,e.__chain__);return t.__actions__=o(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},function(e,t){var n=/\{\n\/\* \[wrapped with (.+)\] \*/,r=/,? & /;e.exports=function(e){var t=e.match(n);return t?t[1].split(r):[]}},function(e,t){var n=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;e.exports=function(e,t){var r=t.length;if(!r)return e;var i=r-1;return t[i]=(r>1?"& ":"")+t[i],t=t.join(r>2?", ":" "),e.replace(n,"{\n/* [wrapped with "+t+"] */\n")}},function(e,t,n){var r=n(384),i=n(259),o=n(140),s=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:o;e.exports=s},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t,n){var r=n(175),i=n(386),o=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];e.exports=function(e,t){return r(o,(function(n){var r="_."+n[0];t&n[1]&&!i(e,r)&&e.push(r)})),e.sort()}},function(e,t,n){var r=n(387);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},function(e,t,n){var r=n(388),i=n(389),o=n(390);e.exports=function(e,t,n){return t==t?o(e,t,n):r(e,i,n)}},function(e,t){e.exports=function(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}},function(e,t,n){var r=n(124),i=n(138),o=Math.min;e.exports=function(e,t){for(var n=e.length,s=o(t.length,n),a=r(e);s--;){var c=t[s];e[s]=i(c,n)?a[c]:void 0}return e}},function(e,t,n){var r=n(171),i=n(141),o=n(40);e.exports=function(e,t,n,s){var a=1&t,c=i(e);return function t(){for(var i=-1,l=arguments.length,u=-1,d=s.length,h=Array(d+l),f=this&&this!==o&&this instanceof t?c:e;++u<d;)h[u]=s[u];for(;l--;)h[u++]=arguments[++i];return r(f,a?n:this,h)}}},function(e,t,n){var r=n(251),i=n(252),o=n(176),s="__lodash_placeholder__",a=128,c=Math.min;e.exports=function(e,t){var n=e[1],l=t[1],u=n|l,d=u<131,h=l==a&&8==n||l==a&&256==n&&e[7].length<=t[8]||384==l&&t[7].length<=t[8]&&8==n;if(!d&&!h)return e;1&l&&(e[2]=t[2],u|=1&n?0:4);var f=t[3];if(f){var p=e[3];e[3]=p?r(p,f,t[4]):f,e[4]=p?o(e[3],s):t[4]}return(f=t[5])&&(p=e[5],e[5]=p?i(p,f,t[6]):f,e[6]=p?o(e[5],s):t[6]),(f=t[7])&&(e[7]=f),l&a&&(e[8]=null==e[8]?t[8]:c(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=u,e}},function(e,t,n){var r=n(289),i=1/0;e.exports=function(e){return e?(e=r(e))===i||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},function(e,t,n){var r=n(396),i=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(i,""):e}},function(e,t){var n=/\s/;e.exports=function(e){for(var t=e.length;t--&&n.test(e.charAt(t)););return t}},function(e,t){e.exports=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},function(e,t,n){var r=n(88),i=n(50);e.exports=function(e){return i(e)&&"[object Arguments]"==r(e)}},function(e,t){e.exports=function(){return!1}},function(e,t,n){var r=n(88),i=n(177),o=n(50),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return o(e)&&i(e.length)&&!!s[r(e)]}},function(e,t,n){var r=n(264)(Object.keys,Object);e.exports=r},function(e,t,n){var r=n(233);e.exports=function(e){return r(e,4)}},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,n){var r=n(144),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=r(t,e);return!(n<0)&&(n==t.length-1?t.pop():i.call(t,n,1),--this.size,!0)}},function(e,t,n){var r=n(144);e.exports=function(e){var t=this.__data__,n=r(t,e);return n<0?void 0:t[n][1]}},function(e,t,n){var r=n(144);e.exports=function(e){return r(this.__data__,e)>-1}},function(e,t,n){var r=n(144);e.exports=function(e,t){var n=this.__data__,i=r(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}},function(e,t,n){var r=n(143);e.exports=function(){this.__data__=new r,this.size=0}},function(e,t){e.exports=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},function(e,t){e.exports=function(e){return this.__data__.get(e)}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,n){var r=n(143),i=n(180),o=n(181);e.exports=function(e,t){var n=this.__data__;if(n instanceof r){var s=n.__data__;if(!i||s.length<199)return s.push([e,t]),this.size=++n.size,this;n=this.__data__=new o(s)}return n.set(e,t),this.size=n.size,this}},function(e,t,n){var r=n(414),i=n(143),o=n(180);e.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},function(e,t,n){var r=n(415),i=n(416),o=n(417),s=n(418),a=n(419);function c(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=i,c.prototype.get=o,c.prototype.has=s,c.prototype.set=a,e.exports=c},function(e,t,n){var r=n(145);e.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,n){var r=n(145),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(r){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0}},function(e,t,n){var r=n(145),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return r?void 0!==t[e]:i.call(t,e)}},function(e,t,n){var r=n(145);e.exports=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=r&&void 0===t?"__lodash_hash_undefined__":t,this}},function(e,t,n){var r=n(146);e.exports=function(e){var t=r(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,n){var r=n(146);e.exports=function(e){return r(this,e).get(e)}},function(e,t,n){var r=n(146);e.exports=function(e){return r(this,e).has(e)}},function(e,t,n){var r=n(146);e.exports=function(e,t){var n=r(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}},function(e,t,n){var r=n(118),i=n(126);e.exports=function(e,t){return e&&r(t,i(t),e)}},function(e,t,n){var r=n(48),i=n(179),o=n(427),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!r(e))return o(e);var t=i(e),n=[];for(var a in e)("constructor"!=a||!t&&s.call(e,a))&&n.push(a);return n}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},function(e,t,n){var r=n(118),i=n(182);e.exports=function(e,t){return r(e,i(e),t)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}},function(e,t,n){var r=n(118),i=n(266);e.exports=function(e,t){return r(e,i(e),t)}},function(e,t,n){var r=n(87)(n(40),"DataView");e.exports=r},function(e,t,n){var r=n(87)(n(40),"Promise");e.exports=r},function(e,t,n){var r=n(87)(n(40),"Set");e.exports=r},function(e,t){var n=Object.prototype.hasOwnProperty;e.exports=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&n.call(e,"index")&&(r.index=e.index,r.input=e.input),r}},function(e,t,n){var r=n(185),i=n(436),o=n(437),s=n(438),a=n(284);e.exports=function(e,t,n){var c=e.constructor;switch(t){case"[object ArrayBuffer]":return r(e);case"[object Boolean]":case"[object Date]":return new c(+e);case"[object DataView]":return i(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a(e,n);case"[object Map]":case"[object Set]":return new c;case"[object Number]":case"[object String]":return new c(e);case"[object RegExp]":return o(e);case"[object Symbol]":return s(e)}}},function(e,t,n){var r=n(185);e.exports=function(e,t){var n=t?r(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}},function(e,t){var n=/\w*$/;e.exports=function(e){var t=new e.constructor(e.source,n.exec(e));return t.lastIndex=e.lastIndex,t}},function(e,t,n){var r=n(96),i=r?r.prototype:void 0,o=i?i.valueOf:void 0;e.exports=function(e){return o?Object(o.call(e)):{}}},function(e,t,n){var r=n(440),i=n(168),o=n(178),s=o&&o.isMap,a=s?i(s):r;e.exports=a},function(e,t,n){var r=n(119),i=n(50);e.exports=function(e){return i(e)&&"[object Map]"==r(e)}},function(e,t,n){var r=n(442),i=n(168),o=n(178),s=o&&o.isSet,a=s?i(s):r;e.exports=a},function(e,t,n){var r=n(119),i=n(50);e.exports=function(e){return i(e)&&"[object Set]"==r(e)}},function(e,t,n){var r=n(170);function i(e,t,n){var o=r(e,8,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return o.placeholder=i.placeholder,o}i.placeholder={},e.exports=i},function(e,t,n){var r=n(88),i=n(50),o=n(212);e.exports=function(e){if(!i(e))return!1;var t=r(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!o(e)}},function(e,t,n){var r=n(119),i=n(50);e.exports=function(e){return i(e)&&"[object WeakMap]"==r(e)}},function(e,t,n){var r=n(233),i=n(193);e.exports=function(e){return i("function"==typeof e?e:r(e,1))}},function(e,t,n){var r=n(330),i=n(331),o=n(272);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?o(t[0][0],t[0][1]):function(n){return n===e||r(n,e,t)}}},function(e,t,n){var r=n(151),i=n(270),o=n(454),s=n(457),a=n(119),c=n(41),l=n(150),u=n(190),d="[object Arguments]",h="[object Array]",f="[object Object]",p=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,g,m,y){var v=c(e),b=c(t),_=v?h:a(e),w=b?h:a(t),T=(_=_==d?f:_)==f,E=(w=w==d?f:w)==f,A=_==w;if(A&&l(e)){if(!l(t))return!1;v=!0,T=!1}if(A&&!T)return y||(y=new r),v||u(e)?i(e,t,n,g,m,y):o(e,t,_,n,g,m,y);if(!(1&n)){var S=T&&p.call(e,"__wrapped__"),O=E&&p.call(t,"__wrapped__");if(S||O){var I=S?e.value():e,C=O?t.value():t;return y||(y=new r),m(I,C,n,g,y)}}return!!A&&(y||(y=new r),s(e,t,n,g,m,y))}},function(e,t,n){var r=n(181),i=n(450),o=n(451);function s(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new r;++t<n;)this.add(e[t])}s.prototype.add=s.prototype.push=i,s.prototype.has=o,e.exports=s},function(e,t){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}},function(e,t){e.exports=function(e,t){return e.has(t)}},function(e,t,n){var r=n(96),i=n(269),o=n(125),s=n(270),a=n(455),c=n(456),l=r?r.prototype:void 0,u=l?l.valueOf:void 0;e.exports=function(e,t,n,r,l,d,h){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!d(new i(e),new i(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var f=a;case"[object Set]":var p=1&r;if(f||(f=c),e.size!=t.size&&!p)return!1;var g=h.get(e);if(g)return g==t;r|=2,h.set(e,t);var m=s(f(e),f(t),r,l,d,h);return h.delete(e),m;case"[object Symbol]":if(u)return u.call(e)==u.call(t)}return!1}},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}},function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}},function(e,t,n){var r=n(267),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,o,s,a){var c=1&n,l=r(e),u=l.length;if(u!=r(t).length&&!c)return!1;for(var d=u;d--;){var h=l[d];if(!(c?h in t:i.call(t,h)))return!1}var f=a.get(e),p=a.get(t);if(f&&p)return f==t&&p==e;var g=!0;a.set(e,t),a.set(t,e);for(var m=c;++d<u;){var y=e[h=l[d]],v=t[h];if(o)var b=c?o(v,y,h,t,e,a):o(y,v,h,e,t,a);if(!(void 0===b?y===v||s(y,v,n,o,a):b)){g=!1;break}m||(m="constructor"==h)}if(g&&!m){var _=e.constructor,w=t.constructor;_==w||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof w&&w instanceof w||(g=!1)}return a.delete(e),a.delete(t),g}},function(e,t,n){var r=n(234),i=n(459),o=n(355),s=n(186),a=n(271),c=n(272),l=n(109);e.exports=function(e,t){return s(e)&&a(t)?c(l(e),t):function(n){var s=i(n,e);return void 0===s&&s===t?o(n,e):r(t,s,3)}}},function(e,t,n){var r=n(213);e.exports=function(e,t,n){var i=null==e?void 0:r(e,t);return void 0===i?n:i}},function(e,t,n){var r=n(461);e.exports=function(e){var t=r(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}},function(e,t,n){var r=n(181);function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(i.Cache||r),n}i.Cache=r,e.exports=i},function(e,t,n){var r=n(96),i=n(214),o=n(41),s=n(115),a=r?r.prototype:void 0,c=a?a.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(o(t))return i(t,e)+"";if(s(t))return c?c.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,n){var r=n(198),i=n(149),o=n(41),s=n(138),a=n(177),c=n(109);e.exports=function(e,t,n){for(var l=-1,u=(t=r(t,e)).length,d=!1;++l<u;){var h=c(t[l]);if(!(d=null!=e&&n(e,h)))break;e=e[h]}return d||++l!=u?d:!!(u=null==e?0:e.length)&&a(u)&&s(h,u)&&(o(e)||i(e))}},function(e,t,n){var r=n(466),i=n(467),o=n(186),s=n(109);e.exports=function(e){return o(e)?r(s(e)):i(e)}},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,n){var r=n(213);e.exports=function(e){return function(t){return r(t,e)}}},function(e,t,n){var r=n(170),i=n(346),o=i((function(e,t){return r(e,256,void 0,void 0,void 0,t)}));e.exports=o},function(e,t,n){var r=n(96),i=n(149),o=n(41),s=r?r.isConcatSpreadable:void 0;e.exports=function(e){return o(e)||i(e)||!!(s&&e&&e[s])}},function(e,t,n){var r=n(214),i=n(124),o=n(41),s=n(115),a=n(273),c=n(109),l=n(203);e.exports=function(e){return o(e)?r(e,c):s(e)?[e]:i(a(l(e)))}},function(e,t){e.exports=function(e){return function(t,n,r){for(var i=-1,o=Object(t),s=r(t),a=s.length;a--;){var c=s[e?a:++i];if(!1===n(o[c],c,o))break}return t}}},function(e,t,n){var r=n(140),i=n(274),o=n(174);e.exports=function(e,t){return o(i(e,t,r),e+"")}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){"use strict";t.decode=t.parse=n(476),t.encode=t.stringify=n(477)},function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,o){t=t||"&",n=n||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t);var c=1e3;o&&"number"==typeof o.maxKeys&&(c=o.maxKeys);var l=e.length;c>0&&l>c&&(l=c);for(var u=0;u<l;++u){var d,h,f,p,g=e[u].replace(a,"%20"),m=g.indexOf(n);m>=0?(d=g.substr(0,m),h=g.substr(m+1)):(d=g,h=""),f=decodeURIComponent(d),p=decodeURIComponent(h),r(s,f)?i(s[f])?s[f].push(p):s[f]=[s[f],p]:s[f]=p}return s};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?o(s(e),(function(s){var a=encodeURIComponent(r(s))+n;return i(e[s])?o(e[s],(function(e){return a+encodeURIComponent(r(e))})).join(t):a+encodeURIComponent(r(e[s]))})).join(t):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function o(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var s=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(62);const i={page:"pages",visit:"visits",favIcon:"favIcons",bookmark:"bookmarks",locator:"locators",pageEntity:"pageEntities",pageMetadata:"pageMetadata"},o={[i.page]:{version:r.a[0].version,fields:{url:{type:"string"},fullUrl:{type:"text"},domain:{type:"string"},hostname:{type:"string"},fullTitle:{type:"text",optional:!0},text:{type:"text",optional:!0},screenshot:{type:"blob",optional:!0},lang:{type:"string",optional:!0},canonicalUrl:{type:"string",optional:!0},description:{type:"text",optional:!0}},indices:[{field:"url",pk:!0},{field:"text",fullTextIndexName:"terms"},{field:"fullTitle",fullTextIndexName:"titleTerms"},{field:"fullUrl",fullTextIndexName:"urlTerms"},{field:"domain"},{field:"hostname"}]},[i.pageMetadata]:{version:r.a[38].version,fields:{doi:{type:"string",optional:!0},annotation:{type:"string",optional:!0},title:{type:"string",optional:!0},sourceName:{type:"string",optional:!0},journalName:{type:"string",optional:!0},journalPage:{type:"string",optional:!0},journalIssue:{type:"string",optional:!0},journalVolume:{type:"string",optional:!0},previewImageUrl:{type:"string",optional:!0},releaseDate:{type:"timestamp",optional:!0},description:{type:"string",optional:!0},accessDate:{type:"timestamp"}},indices:[{field:{relationship:"normalizedPageUrl"}}],relationships:[{singleChildOf:i.page,fieldName:"normalizedPageUrl",alias:"normalizedPageUrl"}]},[i.pageEntity]:{version:r.a[38].version,fields:{order:{type:"int"},name:{type:"string"},isPrimary:{type:"boolean"},additionalName:{type:"string",optional:!0}},indices:[{field:"name"},{field:"order"},{field:{relationship:"normalizedPageUrl"}}],relationships:[{childOf:i.page,alias:"normalizedPageUrl",fieldName:"normalizedPageUrl"}]},[i.visit]:{version:r.a[0].version,fields:{url:{type:"string"},time:{type:"timestamp"},duration:{type:"int",optional:!0},scrollMaxPerc:{type:"float",optional:!0},scrollMaxPx:{type:"float",optional:!0},scrollPerc:{type:"float",optional:!0},scrollPx:{type:"float",optional:!0}},indices:[{field:["time","url"],pk:!0},{field:"url"}]},[i.bookmark]:{version:r.a[0].version,fields:{url:{type:"string"},time:{type:"timestamp"}},indices:[{field:"url",pk:!0},{field:"time"}]},[i.favIcon]:{version:r.a[0].version,fields:{hostname:{type:"string"},favIcon:{type:"blob"}},indices:[{field:"hostname",pk:!0}]},[i.locator]:{version:r.a[34].version,fields:{normalizedUrl:{type:"string"},locationType:{type:"string"},location:{type:"string"},format:{type:"string"},originalLocation:{type:"string"},locationScheme:{type:"string"},primary:{type:"boolean"},valid:{type:"boolean"},version:{type:"timestamp"},status:{type:"string",optional:!0},deviceId:{type:"string",optional:!0},fingerprintScheme:{type:"string",optional:!0},fingerprint:{type:"string",optional:!0},lastVisited:{type:"timestamp",optional:!0},contentSize:{type:"int",optional:!0}},indices:[{field:"normalizedUrl"},{field:"fingerprint"}],history:[{version:r.a[26].version,fields:{normalizedUrl:{type:"string"},locationType:{type:"string"},location:{type:"string"},format:{type:"string"},originalLocation:{type:"string"},locationScheme:{type:"string"},primary:{type:"boolean"},valid:{type:"boolean"},version:{type:"timestamp"},deviceId:{type:"string",optional:!0},fingerprintScheme:{type:"string",optional:!0},fingerprint:{type:"string",optional:!0},lastVisited:{type:"timestamp",optional:!0},contentSize:{type:"int",optional:!0}},indices:[{field:"normalizedUrl"},{field:"fingerprint"}]}]}}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.escapeText=t.escapeAttribute=t.escapeUTF8=t.escape=t.encodeXML=t.getCodePoint=t.xmlReplacer=void 0,t.xmlReplacer=/["&'<>$\x80-\uFFFF]/g;var r=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]);function i(e){for(var n,i="",o=0;null!==(n=t.xmlReplacer.exec(e));){var s=n.index,a=e.charCodeAt(s),c=r.get(a);void 0!==c?(i+=e.substring(o,s)+c,o=s+1):(i+="".concat(e.substring(o,s),"&#x").concat((0,t.getCodePoint)(e,s).toString(16),";"),o=t.xmlReplacer.lastIndex+=Number(55296==(64512&a)))}return i+e.substr(o)}function o(e,t){return function(n){for(var r,i=0,o="";r=e.exec(n);)i!==r.index&&(o+=n.substring(i,r.index)),o+=t.get(r[0].charCodeAt(0)),i=r.index+1;return o+n.substring(i)}}t.getCodePoint=null!=String.prototype.codePointAt?function(e,t){return e.codePointAt(t)}:function(e,t){return 55296==(64512&e.charCodeAt(t))?1024*(e.charCodeAt(t)-55296)+e.charCodeAt(t+1)-56320+65536:e.charCodeAt(t)},t.encodeXML=i,t.escape=i,t.escapeUTF8=o(/[&<>'"]/g,r),t.escapeAttribute=o(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),t.escapeText=o(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]]))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2);function i(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield e.getPage(1),n=yield(yield t.getTextContent()).items;let r=0,i="";for(const e of n)e.transform.some((e=>e<0))||e.height>r&&(r=e.height);for(const e of n)if(!e.transform.some((e=>e<0)))if(i.length>0&&e.height===r)i=i+" "+e.str;else if(0===i.length&&e.height===r)i=e.str;else if(i.length>0&&e.height<r)break;return i}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(2);const i=e=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){return new Promise(((t,n)=>{const r=new FileReader;r.onload=()=>t(r.result.toString()),r.onerror=()=>n(r.error),r.readAsDataURL(e)}))}));function o(e){const t=e.split(","),n=atob(t[1]),r=t[0].split(":")[1].split(";")[0],i=new Uint8Array(n.length);for(let e=0;e<n.length;e++)i[e]=n.charCodeAt(e);return new Blob([i],{type:r})}function s(e){return new Promise(((t,n)=>{const r=new Image;r.onload=()=>{const e=window.devicePixelRatio||1,i=document.createElement("canvas"),o=i.getContext("2d");o?(r.width=r.width/e,r.height=r.height/e,i.width=r.width,i.height=r.height,o.drawImage(r,0,0,r.width,r.height),t(i)):n(new Error("Canvas 2d context is not supported."))},r.onerror=()=>{n(new Error("Failed to load the image."))},r.src=e}))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="@Highlights-color"},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(778),i=n.n(r);const o=(e=null)=>t=>{if("Data fetch failed"===t.message||t.name===i.a.errnames.OpenFailed&&t.message.includes("createObjectStore"))return e;throw t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));const r={BOOKMARKS:"should-index-bookmarks",LINKS:"should-index-links",STUBS:"should-index-stubs",VISITS:"should-index-visits",VISIT_DELAY:"visit-indexing-delay",SCREENSHOTS:"should-capture-screenshots"},i={MIN:0,MAX:600,DEF:20}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return Le})),n.d(t,"b",(function(){return Ne})),n.d(t,"c",(function(){return ze})),n.d(t,"e",(function(){return We})),n.d(t,"f",(function(){return qe})),n.d(t,"g",(function(){return Ve})),n.d(t,"h",(function(){return Ke})),n.d(t,"d",(function(){return gt}));var r=n(74),i=n(30),o=n(2),s=n(201),a=n(322);function c(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const l=c,u=new i.ErrorFactory("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),d=new a.Logger("@firebase/auth");function h(e,...t){d.logLevel<=a.LogLevel.ERROR&&d.error(`Auth (${r.SDK_VERSION}): ${e}`,...t)}function f(e,...t){throw y(e,...t)}function p(e,...t){return y(e,...t)}function g(e,t,n){const r=Object.assign(Object.assign({},l()),{[t]:n});return new i.ErrorFactory("auth","Firebase",r).create(t,{appName:e.name})}function m(e){return g(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function y(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return u.create(e,...t)}function v(e,t,...n){if(!e)throw y(t,...n)}function b(e){const t="INTERNAL ASSERTION FAILED: "+e;throw h(t),new Error(t)}function _(e,t){e||b(t)}function w(){return"http:"===T()||"https:"===T()}function T(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class E{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void b("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void b("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void b("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const A={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},S=new class{constructor(e,t){this.shortDelay=e,this.longDelay=t,_(t>e,"Short delay should be less than long delay!"),this.isMobile=Object(i.isMobileCordova)()||Object(i.isReactNative)()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(w()||Object(i.isBrowserExtension)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}(3e4,6e4);function O(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function I(e,t,n,r,o={}){return C(e,o,(async()=>{let o={},s={};r&&("GET"===t?s=r:o={body:JSON.stringify(r)});const a=Object(i.querystring)(Object.assign({key:e.config.apiKey},s)).slice(1),c=await e._getAdditionalHeaders();return c["Content-Type"]="application/json",e.languageCode&&(c["X-Firebase-Locale"]=e.languageCode),E.fetch()(P(e,e.config.apiHost,n,a),Object.assign({method:t,headers:c,referrerPolicy:"no-referrer"},o))}))}async function C(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},A),t);try{const t=new R(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw L(e,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const t=i.ok?o.errorMessage:o.error.message,[n,s]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw L(e,"credential-already-in-use",o);if("EMAIL_EXISTS"===n)throw L(e,"email-already-in-use",o);if("USER_DISABLED"===n)throw L(e,"user-disabled",o);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw g(e,a,s);f(e,a)}}catch(t){if(t instanceof i.FirebaseError)throw t;f(e,"network-request-failed",{message:String(t)})}}async function k(e,t,n,r,i={}){const o=await I(e,t,n,r,i);return"mfaPendingCredential"in o&&f(e,"multi-factor-auth-required",{_serverResponse:o}),o}function P(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?function(e,t){_(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}(e.config,i):`${e.config.apiScheme}://${i}`}function x(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class R{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(p(this.auth,"network-request-failed"))),S.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function L(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=p(e,t,r);return i.customData._tokenResponse=n,i}function D(e){return void 0!==e&&void 0!==e.enterprise}class N{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return x(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function j(e,t){return I(e,"GET","/v2/recaptchaConfig",O(e,t))}async function M(e,t){return I(e,"POST","/v1/accounts:lookup",t)}function F(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function U(e){return 1e3*Number(e)}function B(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return h("JWT malformed, contained fewer than 3 sections"),null;try{const e=Object(i.base64Decode)(n);return e?JSON.parse(e):(h("Failed to decode base64 JWT payload"),null)}catch(e){return h("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}function G(e){const t=B(e);return v(t,"internal-error"),v(void 0!==t.exp,"internal-error"),v(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function q(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof i.FirebaseError&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class H{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class ${constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=F(this.lastLoginAt),this.creationTime=F(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function W(e){var t;const n=e.auth,r=await e.getIdToken(),i=await q(e,M(n,{idToken:r}));v(null==i?void 0:i.users.length,n,"internal-error");const o=i.users[0];e._notifyReloadListener(o);const s=(null===(t=o.providerUserInfo)||void 0===t?void 0:t.length)?z(o.providerUserInfo):[],a=(c=e.providerData,l=s,[...c.filter((e=>!l.some((t=>t.providerId===e.providerId)))),...l]);var c,l;const u=e.isAnonymous,d=!(e.email&&o.passwordHash||(null==a?void 0:a.length)),h=!!u&&d,f={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new $(o.createdAt,o.lastLoginAt),isAnonymous:h};Object.assign(e,f)}function z(e){return e.map((e=>{var{providerId:t}=e,n=Object(o.__rest)(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class V{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){v(e.idToken,"internal-error"),v(void 0!==e.idToken,"internal-error"),v(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):G(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){v(0!==e.length,"internal-error");const t=G(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(v(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:o}=await async function(e,t){const n=await C(e,{},(async()=>{const n=Object(i.querystring)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:o}=e.config,s=P(e,r,"/v1/token",`key=${o}`),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",E.fetch()(s,{method:"POST",headers:a,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(o))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,o=new V;return n&&(v("string"==typeof n,"internal-error",{appName:e}),o.refreshToken=n),r&&(v("string"==typeof r,"internal-error",{appName:e}),o.accessToken=r),i&&(v("number"==typeof i,"internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new V,this.toJSON())}_performRefresh(){return b("not implemented")}}function K(e,t){v("string"==typeof e||void 0===e,"internal-error",{appName:t})}class Y{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=Object(o.__rest)(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new H(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new $(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await q(this,this.stsTokenManager.getToken(this.auth,e));return v(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=Object(i.getModularInstance)(e),r=await n.getIdToken(t),o=B(r);v(o&&o.exp&&o.auth_time&&o.iat,n.auth,"internal-error");const s="object"==typeof o.firebase?o.firebase:void 0,a=null==s?void 0:s.sign_in_provider;return{claims:o,token:r,authTime:F(U(o.auth_time)),issuedAtTime:F(U(o.iat)),expirationTime:F(U(o.exp)),signInProvider:a||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Object(i.getModularInstance)(e);await W(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(v(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Y(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){v(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await W(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Object(r._isFirebaseServerApp)(this.auth.app))return Promise.reject(m(this.auth));const e=await this.getIdToken();return await q(this,async function(e,t){return I(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,o,s,a,c,l;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(o=t.photoURL)&&void 0!==o?o:void 0,p=null!==(s=t.tenantId)&&void 0!==s?s:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(l=t.lastLoginAt)&&void 0!==l?l:void 0,{uid:b,emailVerified:_,isAnonymous:w,providerData:T,stsTokenManager:E}=t;v(b&&E,e,"internal-error");const A=V.fromJSON(this.name,E);v("string"==typeof b,e,"internal-error"),K(u,e.name),K(d,e.name),v("boolean"==typeof _,e,"internal-error"),v("boolean"==typeof w,e,"internal-error"),K(h,e.name),K(f,e.name),K(p,e.name),K(g,e.name),K(m,e.name),K(y,e.name);const S=new Y({uid:b,auth:e,email:d,emailVerified:_,displayName:u,isAnonymous:w,photoURL:f,phoneNumber:h,tenantId:p,stsTokenManager:A,createdAt:m,lastLoginAt:y});return T&&Array.isArray(T)&&(S.providerData=T.map((e=>Object.assign({},e)))),g&&(S._redirectEventId=g),S}static async _fromIdTokenResponse(e,t,n=!1){const r=new V;r.updateFromServerResponse(t);const i=new Y({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await W(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];v(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?z(r.providerUserInfo):[],o=!(r.email&&r.passwordHash||(null==i?void 0:i.length)),s=new V;s.updateFromIdToken(n);const a=new Y({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:o}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new $(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash||(null==i?void 0:i.length))};return Object.assign(a,c),a}}const Q=new Map;function X(e){_(e instanceof Function,"Expected a class definition");let t=Q.get(e);return t?(_(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Q.set(e,t),t)}class J{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}J.type="NONE";const Z=J;function ee(e,t,n){return`firebase:${e}:${t}:${n}`}class te{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=ee(this.userKey,r.apiKey,i),this.fullPersistenceKey=ee("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Y._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new te(X(Z),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||X(Z);const o=ee(n,e.config.apiKey,e.name);let s=null;for(const n of t)try{const t=await n._get(o);if(t){const r=Y._fromJSON(e,t);n!==i&&(s=r),i=n;break}}catch(e){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],s&&await i._set(o,s.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(o)}catch(e){}}))),new te(i,e,n)):new te(i,e,n)}}function ne(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(re(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(function(e=Object(i.getUA)()){return/firefox\//i.test(e)}(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(oe(t))return"Blackberry";if(se(t))return"Webos";if(function(e=Object(i.getUA)()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}(t))return"Safari";if((t.includes("chrome/")||function(e=Object(i.getUA)()){return/crios\//i.test(e)}(t))&&!t.includes("edge/"))return"Chrome";if(ie(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function re(e=Object(i.getUA)()){return/iemobile/i.test(e)}function ie(e=Object(i.getUA)()){return/android/i.test(e)}function oe(e=Object(i.getUA)()){return/blackberry/i.test(e)}function se(e=Object(i.getUA)()){return/webos/i.test(e)}function ae(e,t=[]){let n;switch(e){case"Browser":n=ne(Object(i.getUA)());break;case"Worker":n=`${ne(Object(i.getUA)())}-${e}`;break;default:n=e}const o=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${r.SDK_VERSION}/${o}`}class ce{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(e){r(e)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}class le{constructor(e){var t,n,r,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=o.minPasswordLength)&&void 0!==t?t:6,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),void 0!==o.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),void 0!==o.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),void 0!==o.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),void 0!==o.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,o,s;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(o=a.containsNumericCharacter)||void 0===o||o),a.isValid&&(a.isValid=null===(s=a.containsNonAlphanumericCharacter)||void 0===s||s),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class ue{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new he(this),this.idTokenSubscription=new he(this),this.beforeStateQueue=new ce(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=u,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=X(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await te.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await M(this,{idToken:e}),n=await Y._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Object(r._isFirebaseServerApp)(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,r=null==i?void 0:i._redirectEventId,s=await this.tryRedirectSignIn(e);n&&n!==r||!(null==s?void 0:s.user)||(i=s.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(e){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return v(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await W(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Object(r._isFirebaseServerApp)(this.app))return Promise.reject(m(this));const t=e?Object(i.getModularInstance)(e):null;return t&&v(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&v(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return Object(r._isFirebaseServerApp)(this.app)?Promise.reject(m(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Object(r._isFirebaseServerApp)(this.app)?Promise.reject(m(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(X(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return I(e,"GET","/v2/passwordPolicy",O(e,t))}(this),t=new le(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new i.ErrorFactory("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return I(e,"POST","/v2/accounts:revokeToken",O(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&X(e)||this._popupRedirectResolver;v(t,this,"argument-error"),this.redirectPersistenceManager=await te.create(this,[X(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t);let o=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(v(s,this,"internal-error"),s.then((()=>{o||i(this.currentUser)})),"function"==typeof t){const i=e.addObserver(t,n,r);return()=>{o=!0,i()}}{const n=e.addObserver(t);return()=>{o=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return v(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ae(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){d.logLevel<=a.LogLevel.WARN&&d.warn(`Auth (${r.SDK_VERSION}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function de(e){return Object(i.getModularInstance)(e)}class he{constructor(e){this.auth=e,this.observer=null,this.addObserver=Object(i.createSubscribe)((e=>this.observer=e))}get next(){return v(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let fe={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};class pe{constructor(e){this.type="recaptcha-enterprise",this.auth=de(e)}async verify(e="verify",t=!1){function n(t,n,r){const i=window.grecaptcha;D(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{j(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new N(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&D(window.grecaptcha))n(i,e,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=fe.recaptchaEnterpriseScript;0!==t.length&&(t+=i),function(e){return fe.loadJS(e)}(t).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function ge(e,t,n,r=!1){const i=new pe(e);let o;try{o=await i.verify(n)}catch(e){o=await i.verify(n,!0)}const s=Object.assign({},t);return r?Object.assign(s,{captchaResp:o}):Object.assign(s,{captchaResponse:o}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function me(e,t,n,r){var i;if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await ge(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch((async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await ge(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)}))}function ye(e,t,n){const r=de(e);v(r._canInitEmulator,r,"emulator-config-failed"),v(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null==n?void 0:n.disableWarnings),o=ve(t),{host:s,port:a}=function(e){const t=ve(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:be(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:be(t)}}}(t),c=null===a?"":`:${a}`;r.config.emulator={url:`${o}//${s}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function ve(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function be(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class _e{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return b("not implemented")}_getIdTokenResponse(e){return b("not implemented")}_linkToIdToken(e,t){return b("not implemented")}_getReauthenticationResolver(e){return b("not implemented")}}async function we(e,t){return I(e,"POST","/v1/accounts:signUp",t)}async function Te(e,t){return k(e,"POST","/v1/accounts:signInWithPassword",O(e,t))}async function Ee(e,t){return I(e,"POST","/v1/accounts:sendOobCode",O(e,t))}async function Ae(e,t){return Ee(e,t)}class Se extends _e{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Se(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Se(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return me(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Te);case"emailLink":return async function(e,t){return k(e,"POST","/v1/accounts:signInWithEmailLink",O(e,t))}(e,{email:this._email,oobCode:this._password});default:f(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return me(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",we);case"emailLink":return async function(e,t){return k(e,"POST","/v1/accounts:signInWithEmailLink",O(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:f(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Oe(e,t){return k(e,"POST","/v1/accounts:signInWithIdp",O(e,t))}class Ie extends _e{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ie(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):f("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=Object(o.__rest)(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new Ie(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Oe(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Oe(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Oe(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Object(i.querystring)(t)}return e}}class Ce{constructor(e){var t,n,r,o,s,a;const c=Object(i.querystringDecode)(Object(i.extractQuerystring)(e)),l=null!==(t=c.apiKey)&&void 0!==t?t:null,u=null!==(n=c.oobCode)&&void 0!==n?n:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=c.mode)&&void 0!==r?r:null);v(l&&u&&d,"argument-error"),this.apiKey=l,this.operation=d,this.code=u,this.continueUrl=null!==(o=c.continueUrl)&&void 0!==o?o:null,this.languageCode=null!==(s=c.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function(e){const t=Object(i.querystringDecode)(Object(i.extractQuerystring)(e)).link,n=t?Object(i.querystringDecode)(Object(i.extractQuerystring)(t)).deep_link_id:null,r=Object(i.querystringDecode)(Object(i.extractQuerystring)(e)).deep_link_id;return(r?Object(i.querystringDecode)(Object(i.extractQuerystring)(r)).link:null)||r||n||t||e}(e);try{return new Ce(t)}catch(e){return null}}}class ke{constructor(){this.providerId=ke.PROVIDER_ID}static credential(e,t){return Se._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Ce.parseLink(t);return v(n,"argument-error"),Se._fromEmailAndCode(e,n.code,n.tenantId)}}ke.PROVIDER_ID="password",ke.EMAIL_PASSWORD_SIGN_IN_METHOD="password",ke.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Pe{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class xe extends Pe{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Re extends xe{constructor(){super("facebook.com")}static credential(e){return Ie._fromParams({providerId:Re.PROVIDER_ID,signInMethod:Re.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Re.credentialFromTaggedObject(e)}static credentialFromError(e){return Re.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Re.credential(e.oauthAccessToken)}catch(e){return null}}}Re.FACEBOOK_SIGN_IN_METHOD="facebook.com",Re.PROVIDER_ID="facebook.com";class Le extends xe{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ie._fromParams({providerId:Le.PROVIDER_ID,signInMethod:Le.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Le.credentialFromTaggedObject(e)}static credentialFromError(e){return Le.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Le.credential(t,n)}catch(e){return null}}}Le.GOOGLE_SIGN_IN_METHOD="google.com",Le.PROVIDER_ID="google.com";class De extends xe{constructor(){super("github.com")}static credential(e){return Ie._fromParams({providerId:De.PROVIDER_ID,signInMethod:De.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return De.credentialFromTaggedObject(e)}static credentialFromError(e){return De.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return De.credential(e.oauthAccessToken)}catch(e){return null}}}De.GITHUB_SIGN_IN_METHOD="github.com",De.PROVIDER_ID="github.com";class Ne extends xe{constructor(){super("twitter.com")}static credential(e,t){return Ie._fromParams({providerId:Ne.PROVIDER_ID,signInMethod:Ne.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ne.credentialFromTaggedObject(e)}static credentialFromError(e){return Ne.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Ne.credential(t,n)}catch(e){return null}}}async function je(e,t){return k(e,"POST","/v1/accounts:signUp",O(e,t))}Ne.TWITTER_SIGN_IN_METHOD="twitter.com",Ne.PROVIDER_ID="twitter.com";class Me{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await Y._fromIdTokenResponse(e,n,r),o=Fe(n);return new Me({user:i,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Fe(n);return new Me({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Fe(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Ue extends i.FirebaseError{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Ue.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Ue(e,t,n,r)}}function Be(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Ue._fromErrorAndOperation(e,n,t,r);throw n}))}async function Ge(e,t){return async function(e,t,n=!1){if(Object(r._isFirebaseServerApp)(e.app))return Promise.reject(m(e));const i="signIn",o=await Be(e,i,t),s=await Me._fromIdTokenResponse(e,i,o);return n||await e._updateCurrentUser(s.user),s}(de(e),t)}async function qe(e,t){if(Object(r._isFirebaseServerApp)(e.app))return Promise.reject(m(e));const n=de(e),i=await async function(e,t){return k(e,"POST","/v1/accounts:signInWithCustomToken",O(e,t))}(n,{token:t,returnSecureToken:!0}),o=await Me._fromIdTokenResponse(n,"signIn",i);return await n._updateCurrentUser(o.user),o}function He(e,t,n){var r;v((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),v(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(v(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(v(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function $e(e){const t=de(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function We(e,t,n){const r=de(e),i={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&He(r,i,n),await me(r,i,"getOobCode",Ae)}async function ze(e,t,n){if(Object(r._isFirebaseServerApp)(e.app))return Promise.reject(m(e));const i=de(e),o=me(i,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",je),s=await o.catch((t=>{throw"auth/password-does-not-meet-requirements"===t.code&&$e(e),t})),a=await Me._fromIdTokenResponse(i,"signIn",s);return await i._updateCurrentUser(a.user),a}function Ve(e,t,n){return Object(r._isFirebaseServerApp)(e.app)?Promise.reject(m(e)):Ge(Object(i.getModularInstance)(e),ke.credential(t,n)).catch((async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&$e(e),t}))}function Ke(e,t){const n=Object(i.getModularInstance)(e);return Object(r._isFirebaseServerApp)(n.auth.app)?Promise.reject(m(n.auth)):Ye(n,t,null)}async function Ye(e,t,n){const{auth:r}=e,i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),n&&(i.password=n);const o=await q(e,async function(e,t){return I(e,"POST","/v1/accounts:update",t)}(r,i));await e._updateTokensIfNecessary(o,!0)}new WeakMap;const Qe="__sak";class Xe{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Xe(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,o=this.handlersMap[r];if(!(null==o?void 0:o.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const s=Array.from(o).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(s);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Xe.receivers=[];class Je{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise(((s,a)=>{const c=function(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}("",20);r.port1.start();const l=setTimeout((()=>{a(new Error("unsupported_event"))}),n);o={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),s(t.data.response);break;default:clearTimeout(l),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{o&&this.removeMessageHandler(o)}))}}function Ze(){return window}function et(){return void 0!==Ze().WorkerGlobalScope&&"function"==typeof Ze().importScripts}const tt="firebaseLocalStorageDb",nt="firebaseLocalStorage",rt="fbase_key";class it{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function ot(e,t){return e.transaction([nt],t?"readwrite":"readonly").objectStore(nt)}function st(){const e=indexedDB.open(tt,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(nt,{keyPath:rt})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(nt)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(tt);return new it(e).toPromise()}(),t(await st()))}))}))}async function at(e,t,n){const r=ot(e,!0).put({[rt]:t,value:n});return new it(r).toPromise()}function ct(e,t){const n=ot(e,!0).delete(t);return new it(n).toPromise()}class lt{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await st()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return et()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Xe._getInstance(et()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Je(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await st();return await at(e,Qe,"1"),await ct(e,Qe),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>at(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=ot(e,!1).get(t),r=await new it(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>ct(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=ot(e,!1).getAll();return new it(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}lt.type="LOCAL";const ut=lt;var dt,ht="@firebase/auth",ft="1.7.1";class pt{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){v(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function gt(e=Object(r.getApp)()){const t=Object(r._getProvider)(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Object(r._getProvider)(e,"auth");if(n.isInitialized()){const e=n.getImmediate(),r=n.getOptions();if(Object(i.deepEqual)(r,null!=t?t:{}))return e;f(e,"already-initialized")}return n.initialize({options:t})}(e,{persistence:[ut]}),o=Object(i.getDefaultEmulatorHost)("auth");return o&&ye(n,`http://${o}`),n}dt="WebExtension",Object(r._registerComponent)(new s.Component("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:s}=n.options;v(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:o,authDomain:s,clientPlatform:dt,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ae(dt)},c=new ue(n,r,i,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(X);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(c,t),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),Object(r._registerComponent)(new s.Component("auth-internal",(e=>(e=>new pt(e))(de(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Object(r.registerVersion)(ht,ft,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(dt)),Object(r.registerVersion)(ht,ft,"esm2017")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeAction=t.IgnoreCaseMode=t.SelectorType=void 0,function(e){e.Attribute="attribute",e.Pseudo="pseudo",e.PseudoElement="pseudo-element",e.Tag="tag",e.Universal="universal",e.Adjacent="adjacent",e.Child="child",e.Descendant="descendant",e.Parent="parent",e.Sibling="sibling",e.ColumnCombinator="column-combinator"}(t.SelectorType||(t.SelectorType={})),t.IgnoreCaseMode={Unknown:null,QuirksMode:"quirks",IgnoreCase:!0,CaseSensitive:!1},function(e){e.Any="any",e.Element="element",e.End="end",e.Equals="equals",e.Exists="exists",e.Hyphen="hyphen",e.Not="not",e.Start="start"}(t.AttributeAction||(t.AttributeAction={}))},function(e,t){t.WEEKDAY_OFFSET={dimanche:0,dim:0,lundi:1,lun:1,mardi:2,mar:2,mercredi:3,mer:3,jeudi:4,jeu:4,vendredi:5,ven:5,samedi:6,sam:6},t.MONTH_OFFSET={janvier:1,jan:1,"jan.":1,"f\xe9vrier":2,"f\xe9v":2,"f\xe9v.":2,fevrier:2,fev:2,"fev.":2,mars:3,mar:3,"mar.":3,avril:4,avr:4,"avr.":4,mai:5,juin:6,jun:6,juillet:7,jul:7,"jul.":7,"ao\xfbt":8,aout:8,septembre:9,sep:9,"sep.":9,sept:9,"sept.":9,octobre:10,oct:10,"oct.":10,novembre:11,nov:11,"nov.":11,"d\xe9cembre":12,decembre:12,dec:12,"dec.":12},t.INTEGER_WORDS_PATTERN="(?:un|deux|trois|quatre|cinq|six|sept|huit|neuf|dix|onze|douze|treize)",t.INTEGER_WORDS={un:1,deux:2,trois:3,quatre:4,cinq:5,six:6,sept:7,huit:8,neuf:9,dix:10,onze:11,douze:12,treize:13}},function(e,t,n){var r=n(112).Refiner;t.Refiner=function(){r.call(this),this.pattern=function(){return/^\s*(to|\-)\s*$/i},this.refine=function(e,t,n){if(t.length<2)return t;for(var r=[],i=null,o=null,s=1;s<t.length;s++)i=t[s],(o=t[s-1]).end||i.end||!this.isAbleToMerge(e,o,i)||(o=this.mergeResult(e,o,i),i=null,s+=1),r.push(o);return null!=i&&r.push(i),r},this.isAbleToMerge=function(e,t,n){var r=t.index+t.text.length,i=n.index;return e.substring(r,i).match(this.pattern())},this.isWeekdayResult=function(e){return e.start.isCertain("weekday")&&!e.start.isCertain("day")},this.mergeResult=function(e,t,n){if(!this.isWeekdayResult(t)&&!this.isWeekdayResult(n)){for(var r in n.start.knownValues)t.start.isCertain(r)||t.start.assign(r,n.start.get(r));for(var r in t.start.knownValues)n.start.isCertain(r)||n.start.assign(r,t.start.get(r))}if(t.start.date().getTime()>n.start.date().getTime()){var i=t.start.moment(),o=n.start.moment();if(this.isWeekdayResult(t)&&i.clone().add(-7,"days").isBefore(o))i=i.add(-7,"days"),t.start.imply("day",i.date()),t.start.imply("month",i.month()+1),t.start.imply("year",i.year());else if(this.isWeekdayResult(n)&&o.clone().add(7,"days").isAfter(i))o=o.add(7,"days"),n.start.imply("day",o.date()),n.start.imply("month",o.month()+1),n.start.imply("year",o.year());else{var s=n;n=t,t=s}}for(var a in t.end=n.start,n.tags)t.tags[a]=!0;var c=Math.min(t.index,n.index),l=Math.max(t.index+t.text.length,n.index+n.text.length);return t.index=c,t.text=e.substring(c,l),t.tags[this.constructor.name]=!0,t}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(2),i=n(780);function o(e,t,n){var o,s,a;return Object(r.__awaiter)(this,void 0,void 0,(function*(){let r={type:"annotation",data:e};if(r.data.pageUrl.includes("twitter.com")||r.data.pageUrl.includes("x.com")){if(0===r.data.pageTitle.length)return;let c=null===(o=r.data.pageTitle)||void 0===o?void 0:o.replace(/[^a-zA-Z0-9]/g," ");c=null===(s=r.data.pageTitle)||void 0===s?void 0:s.substring(0,100).trim(),c=null===(a=r.data.pageTitle)||void 0===a?void 0:a.substring(0,100).trim().replace(/\n/g," "),e.comment&&(e=Object(i.a)(e.comment,"production"));r={type:"annotation",data:{annotationId:e.annotationId,pageTitle:c,body:e.body,comment:e.comment,createdWhen:e.createdWhen,color:e.color,pageCreatedWhen:e.pageCreatedWhen,pageUrl:e.pageUrl}},yield t.pushPKMSyncUpdate(r,n)}else yield t.pushPKMSyncUpdate(r,n)}))}function s(e,t,n){var i,o,s;return Object(r.__awaiter)(this,void 0,void 0,(function*(){let r={type:"page",data:e};if(r.data.pageUrl.includes("twitter.com")||r.data.pageUrl.includes("x.com")){if(0===r.data.pageTitle.length)return;let e=null===(i=r.data.pageTitle)||void 0===i?void 0:i.replace(/[^a-zA-Z0-9]/g," ");e=null===(o=r.data.pageTitle)||void 0===o?void 0:o.substring(0,100).trim(),e=null===(s=r.data.pageTitle)||void 0===s?void 0:s.substring(0,100).trim().replace(/\n/g," ");const a="<div>"+r.data.pageTitle.replace(/\n/g,"<br/>")+"</div>";r={type:"annotation",data:{annotationId:r.data.pageUrl,pageTitle:e,pageUrl:r.data.pageUrl,pageCreatedWhen:r.data.createdWhen,comment:a,createdWhen:r.data.createdWhen}},yield t.pushPKMSyncUpdate(r,n)}else yield t.pushPKMSyncUpdate(r,n)}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2);var i=n(117);class o{constructor(e){this.deps=e}isConnected(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield Object(i.b)(this.deps),t=JSON.stringify({syncKey:e});try{const e=yield fetch(`${this.deps.url}/status`,{method:"POST",headers:{"Content-Type":"application/json"},body:t});return 200===e.status||(e.status,!1)}catch(e){return!1}}))}isReadyToSync(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield Object(i.b)(this.deps),t=JSON.stringify({syncKey:e});try{const e=yield fetch(`${this.deps.url}/status`,{method:"POST",headers:{"Content-Type":"application/json"},body:t});return 200===e.status||500===e.status&&"not-available"}catch(e){return console.error("Error in isReadyToSync:",e),!1}}))}isReachable(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.isConnected()}))}bufferPKMSyncItems(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=(yield this.deps.storageAPI.local.get("PKMSYNCbufferedItems")).PKMSYNCbufferedItems||[];t.length>2e3?yield this.deps.storageAPI.local.set({PKMSYNCbufferMaxReached:!0}):(t.push(e),yield this.deps.storageAPI.local.set({PKMSYNCbufferedItems:t}))}))}getBufferedItems(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=(yield this.deps.storageAPI.local.get("PKMSYNCbufferedItems")).PKMSYNCbufferedItems||[];return yield this.deps.storageAPI.local.remove("PKMSYNCbufferedItems"),e}))}storeObject(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield Object(i.b)(this.deps),o=JSON.stringify({pageTitle:e,fileContent:t,pkmSyncType:n,syncKey:r});console.log("body",o);const s=yield fetch(`${this.deps.url}/update-file`,{method:"PUT",headers:{"Content-Type":"application/json"},body:o});if(s.ok&&(yield this.deps.storageAPI.local.set({PKMSYNCsyncWasSetupBefore:!0})),!s.ok){const e=yield s.json();throw new Error(`HTTP error! status: ${s.status}, message: ${e.error}`)}}))}vectorIndexDocument(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield Object(i.b)(this.deps);let n;if("annotation"===e.contentType){n={sourceApplication:"Memex",createdWhen:e.createdWhen,pageTitle:e.pageTitle,creatorId:e.creatorId,fullUrl:e.fullUrl,contentType:e.contentType,fullHTML:e.fullHTML,syncKey:t};const r=yield fetch(`${this.deps.url}/add_annotation`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(r.ok,!r.ok||200!==r.status)throw new Error(`HTTP error! status: ${r.status}`)}else{n={sourceApplication:"Memex",createdWhen:e.createdWhen,pageTitle:e.pageTitle,creatorId:e.creatorId,fullUrl:e.fullUrl,contentType:e.contentType,fullHTML:e.fullHTML,syncKey:t};const r=yield fetch(`${this.deps.url}/add_page`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(r.ok,!r.ok||200!==r.status)throw new Error(`HTTP error! status: ${r.status}`)}}))}findSimilar(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield Object(i.b)(this.deps),r={contentText:e,fullUrl:t,syncKey:n};try{const e=yield fetch(`${this.deps.url}/get_similar`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(e.ok){return yield e.json()}if(403===e.status)return"not-allowed";if(!e.ok||200!==e.status)throw new Error(`HTTP error! status: ${e.status}`)}catch(e){return"not-connected"}}))}addFeedSources(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield Object(i.b)(this.deps),n=JSON.stringify({feedSources:e,syncKey:t}),r=yield fetch(`${this.deps.url}/add_feed_source`,{method:"POST",headers:{"Content-Type":"application/json"},body:n});if(r.ok){return yield r.json()}if(!r.ok||200!==r.status)throw new Error(`Error getting all RSS feeds: ${r.status}`)}))}loadFeedSources(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield Object(i.b)(this.deps),t=JSON.stringify({syncKey:e}),n=yield fetch(`${this.deps.url}/load_feed_sources`,{method:"POST",headers:{"Content-Type":"application/json"},body:t});if(n.ok){return yield n.json()}if(!n.ok||200!==n.status)throw new Error(`Error getting all RSS feeds: ${n.status}`)}))}listObjects(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield fetch(`${this.deps.url}/backup/change-sets`);if(404===e.status)return[];if(!e.ok)throw new Error(yield e.text());const t=yield e.text();if(t.length>0){const e=t.split(",");return e.length>0?e:[]}return[]}))}retrievePage(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield Object(i.b)(this.deps);let r={pageTitle:e,pkmSyncType:t,syncKey:n};const o=yield fetch(`${this.deps.url}/get-file-content`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);if(o.ok&&200===o.status){return yield o.text()}}))}retrieveIndexFile(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield fetch(`${this.deps.url}/Memex Sync/Memex Sync History.md`)).json()}))}addLocalFolder(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield Object(i.b)(this.deps),t=JSON.stringify({syncKey:e}),n=yield fetch(`${this.deps.url}/watch_new_folder`,{method:"POST",headers:{"Content-Type":"application/json"},body:t});if(n.ok){return yield n.json()}if(!n.ok||200!==n.status)throw new Error(`Error adding new local folder to watchlist: ${n.status}`)}))}getLocalFolders(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield Object(i.b)(this.deps),t=JSON.stringify({syncKey:e}),n=yield fetch(`${this.deps.url}/fetch_all_folders`,{method:"POST",headers:{"Content-Type":"application/json"},body:t});if(n.ok){return yield n.json()}if(!n.ok||200!==n.status)throw new Error(`Error adding new local folder to watchlist: ${n.status}`)}))}openLocalFile(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield Object(i.b)(this.deps),n=JSON.stringify({syncKey:t,path:e}),r=yield fetch(`${this.deps.url}/open_file`,{method:"POST",headers:{"Content-Type":"application/json"},body:n});if(r.ok){return yield r.json()}if(!r.ok||200!==r.status)throw new Error(`Error opening local file: ${r.status}`)}))}removeFeedSource(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield Object(i.b)(this.deps),n=JSON.stringify({syncKey:t,feedUrl:e}),r=yield fetch(`${this.deps.url}/remove_feed_source`,{method:"POST",headers:{"Content-Type":"application/json"},body:n});if(r.ok){return yield r.json()}if(!r.ok||200!==r.status)throw new Error(`Error removing feed source: ${r.status}`)}))}removeLocalFolder(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield Object(i.b)(this.deps),n=JSON.stringify({syncKey:t,id:e}),r=yield fetch(`${this.deps.url}/remove_folder_to_watch`,{method:"POST",headers:{"Content-Type":"application/json"},body:n});if(r.ok){return yield r.json()}if(!r.ok||200!==r.status)throw new Error(`Error removing local folder: ${r.status}`)}))}}},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(2);function i(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return s((t=>t.readAsDataURL(e)))}))}function o(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return s((t=>t.readAsText(e)))}))}function s(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=new FileReader,n=new Promise(((e,n)=>{t.onload=()=>{const n=t.result;e(n)},t.onerror=e=>{n(e)}}));return e(t),n}))}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r.c})),n.d(t,"c",(function(){return i.b})),n.d(t,"b",(function(){return i.a})),n.d(t,"d",(function(){return i.c})),n.d(t,"e",(function(){return i.d}));var r=n(767),i=n(708);n(1040)},,function(e,t,n){(function(t){var r=n(572),i=n(333),o=n(573),s=n(574),a=n(237),c=a.isErrorEvent,l=a.isDOMError,u=a.isDOMException,d=a.isError,h=a.isObject,f=a.isPlainObject,p=a.isUndefined,g=a.isFunction,m=a.isString,y=a.isArray,v=a.isEmptyObject,b=a.each,_=a.objectMerge,w=a.truncate,T=a.objectFrozen,E=a.hasKey,A=a.joinRegExp,S=a.urlencode,O=a.uuid4,I=a.htmlTreeAsString,C=a.isSameException,k=a.isSameStacktrace,P=a.parseUrl,x=a.fill,R=a.supportsFetch,L=a.supportsReferrerPolicy,D=a.serializeKeysForMessage,N=a.serializeException,j=a.sanitize,M=n(575).wrapMethod,F="source protocol user pass host port path".split(" "),U=/^(?:(\w+):)?\/\/(?:(\w+)(:\w+)?@)?([\w\.-]+)(?::(\d+))?(\/.*)/;function B(){return+new Date}var G="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},q=G.document,H=G.navigator;function $(e,t){return g(t)?function(n){return t(n,e)}:t}function W(){for(var e in this._hasJSON=!("object"!=typeof JSON||!JSON.stringify),this._hasDocument=!p(q),this._hasNavigator=!p(H),this._lastCapturedException=null,this._lastData=null,this._lastEventId=null,this._globalServer=null,this._globalKey=null,this._globalProject=null,this._globalContext={},this._globalOptions={release:G.SENTRY_RELEASE&&G.SENTRY_RELEASE.id,logger:"javascript",ignoreErrors:[],ignoreUrls:[],whitelistUrls:[],includePaths:[],headers:null,collectWindowErrors:!0,captureUnhandledRejections:!0,maxMessageLength:0,maxUrlLength:250,stackTraceLimit:50,autoBreadcrumbs:!0,instrument:!0,sampleRate:1,sanitizeKeys:[]},this._fetchDefaults={method:"POST",keepalive:!0,referrerPolicy:L()?"origin":""},this._ignoreOnError=0,this._isRavenInstalled=!1,this._originalErrorStackTraceLimit=Error.stackTraceLimit,this._originalConsole=G.console||{},this._originalConsoleMethods={},this._plugins=[],this._startTime=B(),this._wrappedBuiltIns=[],this._breadcrumbs=[],this._lastCapturedEvent=null,this._keypressTimeout,this._location=G.location,this._lastHref=this._location&&this._location.href,this._resetBackoff(),this._originalConsole)this._originalConsoleMethods[e]=this._originalConsole[e]}W.prototype={VERSION:"3.26.3",debug:!1,TraceKit:r,config:function(e,t){var n=this;if(n._globalServer)return this._logDebug("error","Error: Raven has already been configured"),n;if(!e)return n;var i=n._globalOptions;t&&b(t,(function(e,t){"tags"===e||"extra"===e||"user"===e?n._globalContext[e]=t:i[e]=t})),n.setDSN(e),i.ignoreErrors.push(/^Script error\.?$/),i.ignoreErrors.push(/^Javascript error: Script error\.? on line 0$/),i.ignoreErrors=A(i.ignoreErrors),i.ignoreUrls=!!i.ignoreUrls.length&&A(i.ignoreUrls),i.whitelistUrls=!!i.whitelistUrls.length&&A(i.whitelistUrls),i.includePaths=A(i.includePaths),i.maxBreadcrumbs=Math.max(0,Math.min(i.maxBreadcrumbs||100,100));var o={xhr:!0,console:!0,dom:!0,location:!0,sentry:!0},s=i.autoBreadcrumbs;"[object Object]"==={}.toString.call(s)?s=_(o,s):!1!==s&&(s=o),i.autoBreadcrumbs=s;var a={tryCatch:!0},c=i.instrument;return"[object Object]"==={}.toString.call(c)?c=_(a,c):!1!==c&&(c=a),i.instrument=c,r.collectWindowErrors=!!i.collectWindowErrors,n},install:function(){var e=this;return e.isSetup()&&!e._isRavenInstalled&&(r.report.subscribe((function(){e._handleOnErrorStackInfo.apply(e,arguments)})),e._globalOptions.captureUnhandledRejections&&e._attachPromiseRejectionHandler(),e._patchFunctionToString(),e._globalOptions.instrument&&e._globalOptions.instrument.tryCatch&&e._instrumentTryCatch(),e._globalOptions.autoBreadcrumbs&&e._instrumentBreadcrumbs(),e._drainPlugins(),e._isRavenInstalled=!0),Error.stackTraceLimit=e._globalOptions.stackTraceLimit,this},setDSN:function(e){var t=this,n=t._parseDSN(e),r=n.path.lastIndexOf("/"),i=n.path.substr(1,r);t._dsn=e,t._globalKey=n.user,t._globalSecret=n.pass&&n.pass.substr(1),t._globalProject=n.path.substr(r+1),t._globalServer=t._getGlobalServer(n),t._globalEndpoint=t._globalServer+"/"+i+"api/"+t._globalProject+"/store/",this._resetBackoff()},context:function(e,t,n){return g(e)&&(n=t||[],t=e,e={}),this.wrap(e,t).apply(this,n)},wrap:function(e,t,n){var r=this;if(p(t)&&!g(e))return e;if(g(e)&&(t=e,e=void 0),!g(t))return t;try{if(t.__raven__)return t;if(t.__raven_wrapper__)return t.__raven_wrapper__}catch(e){return t}function i(){var i=[],o=arguments.length,s=!e||e&&!1!==e.deep;for(n&&g(n)&&n.apply(this,arguments);o--;)i[o]=s?r.wrap(e,arguments[o]):arguments[o];try{return t.apply(this,i)}catch(t){throw r._ignoreNextOnError(),r.captureException(t,e),t}}for(var o in t)E(t,o)&&(i[o]=t[o]);return i.prototype=t.prototype,t.__raven_wrapper__=i,i.__raven__=!0,i.__orig__=t,i},uninstall:function(){return r.report.uninstall(),this._detachPromiseRejectionHandler(),this._unpatchFunctionToString(),this._restoreBuiltIns(),this._restoreConsole(),Error.stackTraceLimit=this._originalErrorStackTraceLimit,this._isRavenInstalled=!1,this},_promiseRejectionHandler:function(e){this._logDebug("debug","Raven caught unhandled promise rejection:",e),this.captureException(e.reason,{mechanism:{type:"onunhandledrejection",handled:!1}})},_attachPromiseRejectionHandler:function(){return this._promiseRejectionHandler=this._promiseRejectionHandler.bind(this),G.addEventListener&&G.addEventListener("unhandledrejection",this._promiseRejectionHandler),this},_detachPromiseRejectionHandler:function(){return G.removeEventListener&&G.removeEventListener("unhandledrejection",this._promiseRejectionHandler),this},captureException:function(e,t){if(t=_({trimHeadFrames:0},t||{}),c(e)&&e.error)e=e.error;else{if(l(e)||u(e)){var n=e.name||(l(e)?"DOMError":"DOMException"),i=e.message?n+": "+e.message:n;return this.captureMessage(i,_(t,{stacktrace:!0,trimHeadFrames:t.trimHeadFrames+1}))}if(d(e));else{if(!f(e))return this.captureMessage(e,_(t,{stacktrace:!0,trimHeadFrames:t.trimHeadFrames+1}));t=this._getCaptureExceptionOptionsFromPlainObject(t,e),e=new Error(t.message)}}this._lastCapturedException=e;try{var o=r.computeStackTrace(e);this._handleStackInfo(o,t)}catch(t){if(e!==t)throw t}return this},_getCaptureExceptionOptionsFromPlainObject:function(e,t){var n=Object.keys(t).sort(),r=_(e,{message:"Non-Error exception captured with keys: "+D(n),fingerprint:[o(n)],extra:e.extra||{}});return r.extra.__serialized__=N(t),r},captureMessage:function(e,t){if(!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(e)){var n,i=_({message:e+=""},t=t||{});try{throw new Error(e)}catch(e){n=e}n.name=null;var o=r.computeStackTrace(n),s=y(o.stack)&&o.stack[1];s&&"Raven.captureException"===s.func&&(s=o.stack[2]);var a=s&&s.url||"";if((!this._globalOptions.ignoreUrls.test||!this._globalOptions.ignoreUrls.test(a))&&(!this._globalOptions.whitelistUrls.test||this._globalOptions.whitelistUrls.test(a))){if(this._globalOptions.stacktrace||t.stacktrace||""===i.message){i.fingerprint=null==i.fingerprint?e:i.fingerprint,(t=_({trimHeadFrames:0},t)).trimHeadFrames+=1;var c=this._prepareFrames(o,t);i.stacktrace={frames:c.reverse()}}return i.fingerprint&&(i.fingerprint=y(i.fingerprint)?i.fingerprint:[i.fingerprint]),this._send(i),this}}},captureBreadcrumb:function(e){var t=_({timestamp:B()/1e3},e);if(g(this._globalOptions.breadcrumbCallback)){var n=this._globalOptions.breadcrumbCallback(t);if(h(n)&&!v(n))t=n;else if(!1===n)return this}return this._breadcrumbs.push(t),this._breadcrumbs.length>this._globalOptions.maxBreadcrumbs&&this._breadcrumbs.shift(),this},addPlugin:function(e){var t=[].slice.call(arguments,1);return this._plugins.push([e,t]),this._isRavenInstalled&&this._drainPlugins(),this},setUserContext:function(e){return this._globalContext.user=e,this},setExtraContext:function(e){return this._mergeContext("extra",e),this},setTagsContext:function(e){return this._mergeContext("tags",e),this},clearContext:function(){return this._globalContext={},this},getContext:function(){return JSON.parse(i(this._globalContext))},setEnvironment:function(e){return this._globalOptions.environment=e,this},setRelease:function(e){return this._globalOptions.release=e,this},setDataCallback:function(e){var t=this._globalOptions.dataCallback;return this._globalOptions.dataCallback=$(t,e),this},setBreadcrumbCallback:function(e){var t=this._globalOptions.breadcrumbCallback;return this._globalOptions.breadcrumbCallback=$(t,e),this},setShouldSendCallback:function(e){var t=this._globalOptions.shouldSendCallback;return this._globalOptions.shouldSendCallback=$(t,e),this},setTransport:function(e){return this._globalOptions.transport=e,this},lastException:function(){return this._lastCapturedException},lastEventId:function(){return this._lastEventId},isSetup:function(){return!!this._hasJSON&&(!!this._globalServer||(this.ravenNotConfiguredError||(this.ravenNotConfiguredError=!0,this._logDebug("error","Error: Raven has not been configured.")),!1))},afterLoad:function(){var e=G.RavenConfig;e&&this.config(e.dsn,e.config).install()},showReportDialog:function(e){if(q){var t=(e=e||{}).eventId||this.lastEventId();if(!t)throw new s("Missing eventId");var n=e.dsn||this._dsn;if(!n)throw new s("Missing DSN");var r=encodeURIComponent,i="";i+="?eventId="+r(t),i+="&dsn="+r(n);var o=e.user||this._globalContext.user;o&&(o.name&&(i+="&name="+r(o.name)),o.email&&(i+="&email="+r(o.email)));var a=this._getGlobalServer(this._parseDSN(n)),c=q.createElement("script");c.async=!0,c.src=a+"/api/embed/error-page/"+i,(q.head||q.body).appendChild(c)}},_ignoreNextOnError:function(){var e=this;this._ignoreOnError+=1,setTimeout((function(){e._ignoreOnError-=1}))},_triggerEvent:function(e,t){var n,r;if(this._hasDocument){for(r in t=t||{},e="raven"+e.substr(0,1).toUpperCase()+e.substr(1),q.createEvent?(n=q.createEvent("HTMLEvents")).initEvent(e,!0,!0):(n=q.createEventObject()).eventType=e,t)E(t,r)&&(n[r]=t[r]);if(q.createEvent)q.dispatchEvent(n);else try{q.fireEvent("on"+n.eventType.toLowerCase(),n)}catch(e){}}},_breadcrumbEventHandler:function(e){var t=this;return function(n){if(t._keypressTimeout=null,t._lastCapturedEvent!==n){var r;t._lastCapturedEvent=n;try{r=I(n.target)}catch(e){r="<unknown>"}t.captureBreadcrumb({category:"ui."+e,message:r})}}},_keypressEventHandler:function(){var e=this;return function(t){var n;try{n=t.target}catch(e){return}var r=n&&n.tagName;if(r&&("INPUT"===r||"TEXTAREA"===r||n.isContentEditable)){var i=e._keypressTimeout;i||e._breadcrumbEventHandler("input")(t),clearTimeout(i),e._keypressTimeout=setTimeout((function(){e._keypressTimeout=null}),1e3)}}},_captureUrlChange:function(e,t){var n=P(this._location.href),r=P(t),i=P(e);this._lastHref=t,n.protocol===r.protocol&&n.host===r.host&&(t=r.relative),n.protocol===i.protocol&&n.host===i.host&&(e=i.relative),this.captureBreadcrumb({category:"navigation",data:{to:t,from:e}})},_patchFunctionToString:function(){var e=this;e._originalFunctionToString=Function.prototype.toString,Function.prototype.toString=function(){return"function"==typeof this&&this.__raven__?e._originalFunctionToString.apply(this.__orig__,arguments):e._originalFunctionToString.apply(this,arguments)}},_unpatchFunctionToString:function(){this._originalFunctionToString&&(Function.prototype.toString=this._originalFunctionToString)},_instrumentTryCatch:function(){var e=this,t=e._wrappedBuiltIns;function n(t){return function(n,r){for(var i=new Array(arguments.length),o=0;o<i.length;++o)i[o]=arguments[o];var s=i[0];return g(s)&&(i[0]=e.wrap({mechanism:{type:"instrument",data:{function:t.name||"<anonymous>"}}},s)),t.apply?t.apply(this,i):t(i[0],i[1])}}var r=this._globalOptions.autoBreadcrumbs;function i(n){var i=G[n]&&G[n].prototype;i&&i.hasOwnProperty&&i.hasOwnProperty("addEventListener")&&(x(i,"addEventListener",(function(t){return function(i,o,s,a){try{o&&o.handleEvent&&(o.handleEvent=e.wrap({mechanism:{type:"instrument",data:{target:n,function:"handleEvent",handler:o&&o.name||"<anonymous>"}}},o.handleEvent))}catch(e){}var c,l,u;return r&&r.dom&&("EventTarget"===n||"Node"===n)&&(l=e._breadcrumbEventHandler("click"),u=e._keypressEventHandler(),c=function(e){if(e){var t;try{t=e.type}catch(e){return}return"click"===t?l(e):"keypress"===t?u(e):void 0}}),t.call(this,i,e.wrap({mechanism:{type:"instrument",data:{target:n,function:"addEventListener",handler:o&&o.name||"<anonymous>"}}},o,c),s,a)}}),t),x(i,"removeEventListener",(function(e){return function(t,n,r,i){try{n=n&&(n.__raven_wrapper__?n.__raven_wrapper__:n)}catch(e){}return e.call(this,t,n,r,i)}}),t))}x(G,"setTimeout",n,t),x(G,"setInterval",n,t),G.requestAnimationFrame&&x(G,"requestAnimationFrame",(function(t){return function(n){return t(e.wrap({mechanism:{type:"instrument",data:{function:"requestAnimationFrame",handler:t&&t.name||"<anonymous>"}}},n))}}),t);for(var o=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],s=0;s<o.length;s++)i(o[s])},_instrumentBreadcrumbs:function(){var e=this,t=this._globalOptions.autoBreadcrumbs,n=e._wrappedBuiltIns;function r(t,n){t in n&&g(n[t])&&x(n,t,(function(n){return e.wrap({mechanism:{type:"instrument",data:{function:t,handler:n&&n.name||"<anonymous>"}}},n)}))}if(t.xhr&&"XMLHttpRequest"in G){var i=G.XMLHttpRequest&&G.XMLHttpRequest.prototype;x(i,"open",(function(t){return function(n,r){return m(r)&&-1===r.indexOf(e._globalKey)&&(this.__raven_xhr={method:n,url:r,status_code:null}),t.apply(this,arguments)}}),n),x(i,"send",(function(t){return function(){var n=this;function i(){if(n.__raven_xhr&&4===n.readyState){try{n.__raven_xhr.status_code=n.status}catch(e){}e.captureBreadcrumb({type:"http",category:"xhr",data:n.__raven_xhr})}}for(var o=["onload","onerror","onprogress"],s=0;s<o.length;s++)r(o[s],n);return"onreadystatechange"in n&&g(n.onreadystatechange)?x(n,"onreadystatechange",(function(t){return e.wrap({mechanism:{type:"instrument",data:{function:"onreadystatechange",handler:t&&t.name||"<anonymous>"}}},t,i)})):n.onreadystatechange=i,t.apply(this,arguments)}}),n)}t.xhr&&R()&&x(G,"fetch",(function(t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;++r)n[r]=arguments[r];var i,o=n[0],s="GET";if("string"==typeof o?i=o:"Request"in G&&o instanceof G.Request?(i=o.url,o.method&&(s=o.method)):i=""+o,-1!==i.indexOf(e._globalKey))return t.apply(this,n);n[1]&&n[1].method&&(s=n[1].method);var a={method:s,url:i,status_code:null};return t.apply(this,n).then((function(t){return a.status_code=t.status,e.captureBreadcrumb({type:"http",category:"fetch",data:a}),t})).catch((function(t){throw e.captureBreadcrumb({type:"http",category:"fetch",data:a,level:"error"}),t}))}}),n),t.dom&&this._hasDocument&&(q.addEventListener?(q.addEventListener("click",e._breadcrumbEventHandler("click"),!1),q.addEventListener("keypress",e._keypressEventHandler(),!1)):q.attachEvent&&(q.attachEvent("onclick",e._breadcrumbEventHandler("click")),q.attachEvent("onkeypress",e._keypressEventHandler())));var o=G.chrome,s=!(o&&o.app&&o.app.runtime)&&G.history&&G.history.pushState&&G.history.replaceState;if(t.location&&s){var a=G.onpopstate;G.onpopstate=function(){var t=e._location.href;if(e._captureUrlChange(e._lastHref,t),a)return a.apply(this,arguments)};var c=function(t){return function(){var n=arguments.length>2?arguments[2]:void 0;return n&&e._captureUrlChange(e._lastHref,n+""),t.apply(this,arguments)}};x(G.history,"pushState",c,n),x(G.history,"replaceState",c,n)}if(t.console&&"console"in G&&console.log){var l=function(t,n){e.captureBreadcrumb({message:t,level:n.level,category:"console"})};b(["debug","info","warn","error","log"],(function(e,t){M(console,t,l)}))}},_restoreBuiltIns:function(){for(var e;this._wrappedBuiltIns.length;){var t=(e=this._wrappedBuiltIns.shift())[0],n=e[1],r=e[2];t[n]=r}},_restoreConsole:function(){for(var e in this._originalConsoleMethods)this._originalConsole[e]=this._originalConsoleMethods[e]},_drainPlugins:function(){var e=this;b(this._plugins,(function(t,n){var r=n[0],i=n[1];r.apply(e,[e].concat(i))}))},_parseDSN:function(e){var t=U.exec(e),n={},r=7;try{for(;r--;)n[F[r]]=t[r]||""}catch(t){throw new s("Invalid DSN: "+e)}if(n.pass&&!this._globalOptions.allowSecretKey)throw new s("Do not specify your secret key in the DSN. See: http://bit.ly/raven-secret-key");return n},_getGlobalServer:function(e){var t="//"+e.host+(e.port?":"+e.port:"");return e.protocol&&(t=e.protocol+":"+t),t},_handleOnErrorStackInfo:function(e,t){(t=t||{}).mechanism=t.mechanism||{type:"onerror",handled:!1},this._ignoreOnError||this._handleStackInfo(e,t)},_handleStackInfo:function(e,t){var n=this._prepareFrames(e,t);this._triggerEvent("handle",{stackInfo:e,options:t}),this._processException(e.name,e.message,e.url,e.lineno,n,t)},_prepareFrames:function(e,t){var n=this,r=[];if(e.stack&&e.stack.length&&(b(e.stack,(function(t,i){var o=n._normalizeFrame(i,e.url);o&&r.push(o)})),t&&t.trimHeadFrames))for(var i=0;i<t.trimHeadFrames&&i<r.length;i++)r[i].in_app=!1;return r=r.slice(0,this._globalOptions.stackTraceLimit)},_normalizeFrame:function(e,t){var n={filename:e.url,lineno:e.line,colno:e.column,function:e.func||"?"};return e.url||(n.filename=t),n.in_app=!(this._globalOptions.includePaths.test&&!this._globalOptions.includePaths.test(n.filename)||/(Raven|TraceKit)\./.test(n.function)||/raven\.(min\.)?js$/.test(n.filename)),n},_processException:function(e,t,n,r,i,o){var s,a=(e?e+": ":"")+(t||"");if((!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(t)&&!this._globalOptions.ignoreErrors.test(a))&&(i&&i.length?(n=i[0].filename||n,i.reverse(),s={frames:i}):n&&(s={frames:[{filename:n,lineno:r,in_app:!0}]}),(!this._globalOptions.ignoreUrls.test||!this._globalOptions.ignoreUrls.test(n))&&(!this._globalOptions.whitelistUrls.test||this._globalOptions.whitelistUrls.test(n)))){var c=_({exception:{values:[{type:e,value:t,stacktrace:s}]},transaction:n},o),l=c.exception.values[0];null==l.type&&""===l.value&&(l.value="Unrecoverable error caught"),!c.exception.mechanism&&c.mechanism&&(c.exception.mechanism=c.mechanism,delete c.mechanism),c.exception.mechanism=_({type:"generic",handled:!0},c.exception.mechanism||{}),this._send(c)}},_trimPacket:function(e){var t=this._globalOptions.maxMessageLength;if(e.message&&(e.message=w(e.message,t)),e.exception){var n=e.exception.values[0];n.value=w(n.value,t)}var r=e.request;return r&&(r.url&&(r.url=w(r.url,this._globalOptions.maxUrlLength)),r.Referer&&(r.Referer=w(r.Referer,this._globalOptions.maxUrlLength))),e.breadcrumbs&&e.breadcrumbs.values&&this._trimBreadcrumbs(e.breadcrumbs),e},_trimBreadcrumbs:function(e){for(var t,n,r,i=["to","from","url"],o=0;o<e.values.length;++o)if((n=e.values[o]).hasOwnProperty("data")&&h(n.data)&&!T(n.data)){r=_({},n.data);for(var s=0;s<i.length;++s)t=i[s],r.hasOwnProperty(t)&&r[t]&&(r[t]=w(r[t],this._globalOptions.maxUrlLength));e.values[o].data=r}},_getHttpData:function(){if(this._hasNavigator||this._hasDocument){var e={};return this._hasNavigator&&H.userAgent&&(e.headers={"User-Agent":H.userAgent}),G.location&&G.location.href&&(e.url=G.location.href),this._hasDocument&&q.referrer&&(e.headers||(e.headers={}),e.headers.Referer=q.referrer),e}},_resetBackoff:function(){this._backoffDuration=0,this._backoffStart=null},_shouldBackoff:function(){return this._backoffDuration&&B()-this._backoffStart<this._backoffDuration},_isRepeatData:function(e){var t=this._lastData;return!(!t||e.message!==t.message||e.transaction!==t.transaction)&&(e.stacktrace||t.stacktrace?k(e.stacktrace,t.stacktrace):!e.exception&&!t.exception||C(e.exception,t.exception))},_setBackoffState:function(e){if(!this._shouldBackoff()){var t=e.status;if(400===t||401===t||429===t){var n;try{n=R()?e.headers.get("Retry-After"):e.getResponseHeader("Retry-After"),n=1e3*parseInt(n,10)}catch(e){}this._backoffDuration=n||(2*this._backoffDuration||1e3),this._backoffStart=B()}}},_send:function(e){var t=this._globalOptions,n={project:this._globalProject,logger:t.logger,platform:"javascript"},r=this._getHttpData();r&&(n.request=r),e.trimHeadFrames&&delete e.trimHeadFrames,(e=_(n,e)).tags=_(_({},this._globalContext.tags),e.tags),e.extra=_(_({},this._globalContext.extra),e.extra),e.extra["session:duration"]=B()-this._startTime,this._breadcrumbs&&this._breadcrumbs.length>0&&(e.breadcrumbs={values:[].slice.call(this._breadcrumbs,0)}),this._globalContext.user&&(e.user=this._globalContext.user),t.environment&&(e.environment=t.environment),t.release&&(e.release=t.release),t.serverName&&(e.server_name=t.serverName),e=this._sanitizeData(e),Object.keys(e).forEach((function(t){(null==e[t]||""===e[t]||v(e[t]))&&delete e[t]})),g(t.dataCallback)&&(e=t.dataCallback(e)||e),e&&!v(e)&&(g(t.shouldSendCallback)&&!t.shouldSendCallback(e)||(this._shouldBackoff()?this._logDebug("warn","Raven dropped error due to backoff: ",e):"number"==typeof t.sampleRate?Math.random()<t.sampleRate&&this._sendProcessedPayload(e):this._sendProcessedPayload(e)))},_sanitizeData:function(e){return j(e,this._globalOptions.sanitizeKeys)},_getUuid:function(){return O()},_sendProcessedPayload:function(e,t){var n=this,r=this._globalOptions;if(this.isSetup())if(e=this._trimPacket(e),this._globalOptions.allowDuplicates||!this._isRepeatData(e)){this._lastEventId=e.event_id||(e.event_id=this._getUuid()),this._lastData=e,this._logDebug("debug","Raven about to send:",e);var i={sentry_version:"7",sentry_client:"raven-js/"+this.VERSION,sentry_key:this._globalKey};this._globalSecret&&(i.sentry_secret=this._globalSecret);var o=e.exception&&e.exception.values[0];this._globalOptions.autoBreadcrumbs&&this._globalOptions.autoBreadcrumbs.sentry&&this.captureBreadcrumb({category:"sentry",message:o?(o.type?o.type+": ":"")+o.value:e.message,event_id:e.event_id,level:e.level||"error"});var s=this._globalEndpoint;(r.transport||this._makeRequest).call(this,{url:s,auth:i,data:e,options:r,onSuccess:function(){n._resetBackoff(),n._triggerEvent("success",{data:e,src:s}),t&&t()},onError:function(r){n._logDebug("error","Raven transport failed to send: ",r),r.request&&n._setBackoffState(r.request),n._triggerEvent("failure",{data:e,src:s}),r=r||new Error("Raven send failed (no additional details provided)"),t&&t(r)}})}else this._logDebug("warn","Raven dropped repeat event: ",e)},_makeRequest:function(e){var t=e.url+"?"+S(e.auth),n=null,r={};if(e.options.headers&&(n=this._evaluateHash(e.options.headers)),e.options.fetchParameters&&(r=this._evaluateHash(e.options.fetchParameters)),R()){r.body=i(e.data);var o=_({},this._fetchDefaults),s=_(o,r);return n&&(s.headers=n),G.fetch(t,s).then((function(t){if(t.ok)e.onSuccess&&e.onSuccess();else{var n=new Error("Sentry error code: "+t.status);n.request=t,e.onError&&e.onError(n)}})).catch((function(){e.onError&&e.onError(new Error("Sentry error code: network unavailable"))}))}var a=G.XMLHttpRequest&&new G.XMLHttpRequest;a&&(("withCredentials"in a||"undefined"!=typeof XDomainRequest)&&("withCredentials"in a?a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status)e.onSuccess&&e.onSuccess();else if(e.onError){var t=new Error("Sentry error code: "+a.status);t.request=a,e.onError(t)}}:(a=new XDomainRequest,t=t.replace(/^https?:/,""),e.onSuccess&&(a.onload=e.onSuccess),e.onError&&(a.onerror=function(){var t=new Error("Sentry error code: XDomainRequest");t.request=a,e.onError(t)})),a.open("POST",t),n&&b(n,(function(e,t){a.setRequestHeader(e,t)})),a.send(i(e.data))))},_evaluateHash:function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];t[n]="function"==typeof r?r():r}return t},_logDebug:function(e){this._originalConsoleMethods[e]&&(this.debug||this._globalOptions.debug)&&Function.prototype.apply.call(this._originalConsoleMethods[e],this._originalConsole,[].slice.call(arguments,1))},_mergeContext:function(e,t){p(t)?delete this._globalContext[e]:this._globalContext[e]=_(this._globalContext[e]||{},t)}},W.prototype.setUser=W.prototype.setUserContext,W.prototype.setReleaseContext=W.prototype.setRelease,e.exports=W}).call(this,n(61))},function(e,t,n){(function(t){var r=n(237),i={collectWindowErrors:!0,debug:!1},o="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},s=[].slice,a="?",c=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/;function l(){return"undefined"==typeof document||null==document.location?"":document.location.href}i.report=function(){var e,t,n=[],u=null,d=null,h=null;function f(e,t){var r=null;if(!t||i.collectWindowErrors){for(var o in n)if(n.hasOwnProperty(o))try{n[o].apply(null,[e].concat(s.call(arguments,2)))}catch(e){r=e}if(r)throw r}}function p(t,n,o,s,u){var d=r.isErrorEvent(u)?u.error:u,p=r.isErrorEvent(t)?t.message:t;if(h)i.computeStackTrace.augmentStackTraceWithInitialElement(h,n,o,p),g();else if(d&&r.isError(d))f(i.computeStackTrace(d),!0);else{var m,y={url:n,line:o,column:s},v=void 0;if("[object String]"==={}.toString.call(p))(m=p.match(c))&&(v=m[1],p=m[2]);y.func=a,f({name:v,message:p,url:l(),stack:[y]},!0)}return!!e&&e.apply(this,arguments)}function g(){var e=h,t=u;u=null,h=null,d=null,f.apply(null,[e,!1].concat(t))}function m(e,t){var n=s.call(arguments,1);if(h){if(d===e)return;g()}var r=i.computeStackTrace(e);if(h=r,d=e,u=n,setTimeout((function(){d===e&&g()}),r.incomplete?2e3:0),!1!==t)throw e}return m.subscribe=function(r){!function(){if(t)return;e=o.onerror,o.onerror=p,t=!0}(),n.push(r)},m.unsubscribe=function(e){for(var t=n.length-1;t>=0;--t)n[t]===e&&n.splice(t,1)},m.uninstall=function(){!function(){if(!t)return;o.onerror=e,t=!1,e=void 0}(),n=[]},m}(),i.computeStackTrace=function(){function e(e){if(void 0!==e.stack&&e.stack){for(var t,n,r,i=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|[a-z]:|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,o=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx(?:-web)|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,s=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|moz-extension).*?:\/.*?|\[native code\]|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i,c=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,u=/\((\S*)(?::(\d+))(?::(\d+))\)/,d=e.stack.split("\n"),h=[],f=(/^(.*) is undefined$/.exec(e.message),0),p=d.length;f<p;++f){if(n=i.exec(d[f])){var g=n[2]&&0===n[2].indexOf("native");n[2]&&0===n[2].indexOf("eval")&&(t=u.exec(n[2]))&&(n[2]=t[1],n[3]=t[2],n[4]=t[3]),r={url:g?null:n[2],func:n[1]||a,args:g?[n[2]]:[],line:n[3]?+n[3]:null,column:n[4]?+n[4]:null}}else if(n=o.exec(d[f]))r={url:n[2],func:n[1]||a,args:[],line:+n[3],column:n[4]?+n[4]:null};else{if(!(n=s.exec(d[f])))continue;n[3]&&n[3].indexOf(" > eval")>-1&&(t=c.exec(n[3]))?(n[3]=t[1],n[4]=t[2],n[5]=null):0!==f||n[5]||void 0===e.columnNumber||(h[0].column=e.columnNumber+1),r={url:n[3],func:n[1]||a,args:n[2]?n[2].split(","):[],line:n[4]?+n[4]:null,column:n[5]?+n[5]:null}}if(!r.func&&r.line&&(r.func=a),r.url&&"blob:"===r.url.substr(0,5)){var m=new XMLHttpRequest;if(m.open("GET",r.url,!1),m.send(null),200===m.status){var y=m.responseText||"",v=(y=y.slice(-300)).match(/\/\/# sourceMappingURL=(.*)$/);if(v){var b=v[1];"~"===b.charAt(0)&&(b=("undefined"==typeof document||null==document.location?"":document.location.origin?document.location.origin:document.location.protocol+"//"+document.location.hostname+(document.location.port?":"+document.location.port:""))+b.slice(1)),r.url=b.slice(0,-4)}}}h.push(r)}return h.length?{name:e.name,message:e.message,url:l(),stack:h}:null}}function t(e,t,n,r){var i={url:t,line:n};if(i.url&&i.line){if(e.incomplete=!1,i.func||(i.func=a),e.stack.length>0&&e.stack[0].url===i.url){if(e.stack[0].line===i.line)return!1;if(!e.stack[0].line&&e.stack[0].func===i.func)return e.stack[0].line=i.line,!1}return e.stack.unshift(i),e.partial=!0,!0}return e.incomplete=!0,!1}function n(e,o){for(var s,c,u=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,d=[],h={},f=!1,p=n.caller;p&&!f;p=p.caller)if(p!==r&&p!==i.report){if(c={url:null,func:a,line:null,column:null},p.name?c.func=p.name:(s=u.exec(p.toString()))&&(c.func=s[1]),void 0===c.func)try{c.func=s.input.substring(0,s.input.indexOf("{"))}catch(e){}h[""+p]?f=!0:h[""+p]=!0,d.push(c)}o&&d.splice(0,o);var g={name:e.name,message:e.message,url:l(),stack:d};return t(g,e.sourceURL||e.fileName,e.line||e.lineNumber,e.message||e.description),g}function r(t,r){var o=null;r=null==r?0:+r;try{if(o=e(t))return o}catch(e){if(i.debug)throw e}try{if(o=n(t,r+1))return o}catch(e){if(i.debug)throw e}return{name:t.name,message:t.message,url:l()}}return r.augmentStackTraceWithInitialElement=t,r.computeStackTraceFromStackProp=e,r}(),e.exports=i}).call(this,n(61))},function(e,t){function n(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function r(e,t,r,i,o,s){return n((a=n(n(t,e),n(i,s)))<<(c=o)|a>>>32-c,r);var a,c}function i(e,t,n,i,o,s,a){return r(t&n|~t&i,e,t,o,s,a)}function o(e,t,n,i,o,s,a){return r(t&i|n&~i,e,t,o,s,a)}function s(e,t,n,i,o,s,a){return r(t^n^i,e,t,o,s,a)}function a(e,t,n,i,o,s,a){return r(n^(t|~i),e,t,o,s,a)}function c(e,t){var r,c,l,u,d;e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var h=1732584193,f=-271733879,p=-1732584194,g=271733878;for(r=0;r<e.length;r+=16)c=h,l=f,u=p,d=g,h=i(h,f,p,g,e[r],7,-680876936),g=i(g,h,f,p,e[r+1],12,-389564586),p=i(p,g,h,f,e[r+2],17,606105819),f=i(f,p,g,h,e[r+3],22,-1044525330),h=i(h,f,p,g,e[r+4],7,-176418897),g=i(g,h,f,p,e[r+5],12,1200080426),p=i(p,g,h,f,e[r+6],17,-1473231341),f=i(f,p,g,h,e[r+7],22,-45705983),h=i(h,f,p,g,e[r+8],7,1770035416),g=i(g,h,f,p,e[r+9],12,-1958414417),p=i(p,g,h,f,e[r+10],17,-42063),f=i(f,p,g,h,e[r+11],22,-1990404162),h=i(h,f,p,g,e[r+12],7,1804603682),g=i(g,h,f,p,e[r+13],12,-40341101),p=i(p,g,h,f,e[r+14],17,-1502002290),h=o(h,f=i(f,p,g,h,e[r+15],22,1236535329),p,g,e[r+1],5,-165796510),g=o(g,h,f,p,e[r+6],9,-1069501632),p=o(p,g,h,f,e[r+11],14,643717713),f=o(f,p,g,h,e[r],20,-373897302),h=o(h,f,p,g,e[r+5],5,-701558691),g=o(g,h,f,p,e[r+10],9,38016083),p=o(p,g,h,f,e[r+15],14,-660478335),f=o(f,p,g,h,e[r+4],20,-405537848),h=o(h,f,p,g,e[r+9],5,568446438),g=o(g,h,f,p,e[r+14],9,-1019803690),p=o(p,g,h,f,e[r+3],14,-187363961),f=o(f,p,g,h,e[r+8],20,1163531501),h=o(h,f,p,g,e[r+13],5,-1444681467),g=o(g,h,f,p,e[r+2],9,-51403784),p=o(p,g,h,f,e[r+7],14,1735328473),h=s(h,f=o(f,p,g,h,e[r+12],20,-1926607734),p,g,e[r+5],4,-378558),g=s(g,h,f,p,e[r+8],11,-2022574463),p=s(p,g,h,f,e[r+11],16,1839030562),f=s(f,p,g,h,e[r+14],23,-35309556),h=s(h,f,p,g,e[r+1],4,-1530992060),g=s(g,h,f,p,e[r+4],11,1272893353),p=s(p,g,h,f,e[r+7],16,-155497632),f=s(f,p,g,h,e[r+10],23,-1094730640),h=s(h,f,p,g,e[r+13],4,681279174),g=s(g,h,f,p,e[r],11,-358537222),p=s(p,g,h,f,e[r+3],16,-722521979),f=s(f,p,g,h,e[r+6],23,76029189),h=s(h,f,p,g,e[r+9],4,-640364487),g=s(g,h,f,p,e[r+12],11,-421815835),p=s(p,g,h,f,e[r+15],16,530742520),h=a(h,f=s(f,p,g,h,e[r+2],23,-995338651),p,g,e[r],6,-198630844),g=a(g,h,f,p,e[r+7],10,1126891415),p=a(p,g,h,f,e[r+14],15,-1416354905),f=a(f,p,g,h,e[r+5],21,-57434055),h=a(h,f,p,g,e[r+12],6,1700485571),g=a(g,h,f,p,e[r+3],10,-1894986606),p=a(p,g,h,f,e[r+10],15,-1051523),f=a(f,p,g,h,e[r+1],21,-2054922799),h=a(h,f,p,g,e[r+8],6,1873313359),g=a(g,h,f,p,e[r+15],10,-30611744),p=a(p,g,h,f,e[r+6],15,-1560198380),f=a(f,p,g,h,e[r+13],21,1309151649),h=a(h,f,p,g,e[r+4],6,-145523070),g=a(g,h,f,p,e[r+11],10,-1120210379),p=a(p,g,h,f,e[r+2],15,718787259),f=a(f,p,g,h,e[r+9],21,-343485551),h=n(h,c),f=n(f,l),p=n(p,u),g=n(g,d);return[h,f,p,g]}function l(e){var t,n="",r=32*e.length;for(t=0;t<r;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function u(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;var r=8*e.length;for(t=0;t<r;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function d(e){var t,n,r="0123456789abcdef",i="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),i+=r.charAt(t>>>4&15)+r.charAt(15&t);return i}function h(e){return unescape(encodeURIComponent(e))}function f(e){return function(e){return l(c(u(e),8*e.length))}(h(e))}function p(e,t){return function(e,t){var n,r,i=u(e),o=[],s=[];for(o[15]=s[15]=void 0,i.length>16&&(i=c(i,8*e.length)),n=0;n<16;n+=1)o[n]=909522486^i[n],s[n]=1549556828^i[n];return r=c(o.concat(u(t)),512+8*t.length),l(c(s.concat(r),640))}(h(e),h(t))}e.exports=function(e,t,n){return t?n?p(t,e):d(p(t,e)):n?f(e):d(f(e))}},function(e,t){function n(e){this.name="RavenConfigError",this.message=e}n.prototype=new Error,n.prototype.constructor=n,e.exports=n},function(e,t,n){var r=n(237);e.exports={wrapMethod:function(e,t,n){var i=e[t],o=e;if(t in e){var s="warn"===t?"warning":t;e[t]=function(){var e=[].slice.call(arguments),a=r.safeJoin(e," "),c={level:s,logger:"console",extra:{arguments:e}};"assert"===t?!1===e[0]&&(a="Assertion failed: "+(r.safeJoin(e.slice(1)," ")||"console.assert"),c.extra.arguments=e.slice(1),n&&n(a,c)):n&&n(a,c),i&&Function.prototype.apply.call(i,o,e)}}}}},function(e,t,n){var r=n(40);e.exports=function(){return r.Date.now()}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n(2),i=n(49),o=n(130),s=n(104);const a=e=>{const t=["blob:","about:","chrome://","moz-extension://","chrome-extension://","chrome://extensions/"],n=Object(o.a)(e.fullUrl);if(e.fullUrl.startsWith("file://")&&!e.allowFileUrls)return!1;if(e.fullUrl.includes(".pdf")){if(!e.fullUrl.includes("pdfjs/viewer.html?file"))return!1;if(e.fullUrl.includes("pdfjs/viewer.html?file"))return!0}if(Object(s.f)(e.fullUrl))return!1;for(const e of t)if(n.startsWith(e))return!1;return!0};function c(e,t){var n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const s=[],c=yield Promise.all(e.filter((e=>a({fullUrl:e.url}))).map((e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const{fullUrl:n}=yield t.waitForContentIdentifier({tabId:e.id,fullUrl:Object(o.a)(e.url)});return[n,e.id]})))));for(const[e,r]of c){let o=!1;try{yield t.createPage({tabId:r,fullUrl:e,allowScreenshot:!1,visitTime:t.time,metaData:{pageTitle:null!==(n=t.pageTitle)&&void 0!==n?n:null}},{addInboxEntryOnCreate:!0})}catch(e){o=!0,i.b(e),console.error(e)}o||s.push({fullUrl:e})}return s}))}},function(e,t,n){var r=t.options=n(802);t.parser=n(26),t.refiner=n(112),t.Parser=t.parser.Parser,t.Refiner=t.refiner.Refiner,t.Filter=t.refiner.Filter,t.ParsedResult=n(23).ParsedResult,t.ParsedComponents=n(23).ParsedComponents;var i=function(e){e=e||t.options.casualOption(),this.option=e,this.parsers=new Object(e.parsers),this.refiners=new Object(e.refiners)};i.prototype.parse=function(e,t,n){t=t||new Date,n=n||{};var r=[];return this.parsers.forEach((function(i){var o=i.execute(e,t,n);r=r.concat(o)})),r.sort((function(e,t){return e.index-t.index})),this.refiners.forEach((function(t){r=t.refine(e,r,n)})),r},i.prototype.parseDate=function(e,t,n){var r=this.parse(e,t,n);return r.length>0?r[0].start.date():null},t.Chrono=i,t.strict=new i(r.strictOption()),t.casual=new i(r.casualOption()),t.en=new i(r.mergeOptions([r.en.casual,r.commonPostProcessing])),t.en_GB=new i(r.mergeOptions([r.en_GB.casual,r.commonPostProcessing])),t.de=new i(r.mergeOptions([r.de.casual,r.en,r.commonPostProcessing])),t.es=new i(r.mergeOptions([r.es.casual,r.en,r.commonPostProcessing])),t.fr=new i(r.mergeOptions([r.fr.casual,r.en,r.commonPostProcessing])),t.ja=new i(r.mergeOptions([r.ja.casual,r.en,r.commonPostProcessing])),t.parse=function(){return t.casual.parse.apply(t.casual,arguments)},t.parseDate=function(){return t.casual.parseDate.apply(t.casual,arguments)}},,function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var r=n(2),i=n(6),o=n(352),s=n(117);function a(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){window.location.href=yield Object(i.h)("getBackupProviderLoginLink")({returnUrl:"http://memex.cloud/backup/auth-redirect/google-drive",provider:"googledrive"})}))}const c=({storageAPI:e})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){try{const t=yield Object(s.b)({storageAPI:e}),n=JSON.stringify({syncKey:t});try{const e=yield fetch(o.a.STATUS,{method:"POST",headers:{"Content-Type":"application/json"},body:n});return 200===e.status||(e.status,!1)}catch(e){return!1}}catch(e){return!1}})),l=()=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){try{const e=(yield browser.storage.local.get("PKMSYNCpkmFolders")).PKMSYNCpkmFolders.backupFolder;if(e&&e.length)return e}catch(e){return null}return null}))},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(207),i=n(19);class o extends Error{}function s(e,t){var n;const s=!(null===(n=null==t?void 0:t.suppressParseErrors)||void 0===n||n);let c;try{c=Object(i.c)(e,{skipProtocolTrim:!0,suppressParseError:null==t?void 0:t.suppressParseErrors})}catch(t){if(s)throw t;c=e}try{const e=Object(r.parse)(c);if(null==e.href)throw new o("Cannot parse URL");return{hostname:e.hostname,pathname:e.pathname,domain:a(e.hostname)}}catch(e){if(s)throw e;return console.error(`cannot parse URL: ${c}`),{hostname:c,pathname:c,domain:c}}}function a(e){const t=e.split("."),n=t.length;return n>2&&(e=`${t[n-2]}.${t[n-1]}`,2===t[n-1].length&&[2,3].includes(t[n-2].length)&&(e=`${t[n-3]}.${e}`)),e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(2),i=n(80),o=n(781),s=n(507),a=n(875),c=n(34),l=n(1072),u=n(316),d=n(19),h=n(553),f=n(117);class p extends i.a{constructor(e){super({storageManager:e.storageManager}),this.options=e,this.getConfig=()=>({collections:Object.assign(Object.assign({},o.a),{directLinks:{version:u.b[4].version,fields:{pageTitle:{type:"text"},pageUrl:{type:"url"},body:{type:"text"},comment:{type:"text"},selector:{type:"json"},createdWhen:{type:"datetime"},lastEdited:{type:"datetime"},url:{type:"string"}},indices:[{field:"url",pk:!0},{field:"pageTitle"},{field:"pageUrl"},{field:"body"},{field:"createdWhen"},{field:"comment"}],history:[{version:u.b[1].version,fields:{pageTitle:{type:"text"},pageUrl:{type:"url"},body:{type:"text"},selector:{type:"json"},createdWhen:{type:"datetime"},url:{type:"string"}},indices:[{field:"url",pk:!0},{field:"pageTitle"},{field:"body"},{field:"createdWhen"}]}]}}),operations:{findBookmarkByUrl:{collection:p.BMS_COLL,operation:"findObject",args:{url:"$url:pk"}},findAnnotationByUrl:{collection:p.ANNOTS_COLL,operation:"findObject",args:{url:"$url:pk"}},findAnnotationsByUrls:{collection:p.ANNOTS_COLL,operation:"findObjects",args:{url:{$in:"$urls:array:pk"}}},findListEntry:{collection:p.LIST_ENTRIES_COLL,operation:"findObject",args:{url:"$url:pk",listId:"$listId:pk"}},findListEntriesByUrl:{collection:p.LIST_ENTRIES_COLL,operation:"findObjects",args:{url:"$url:pk"}},findListEntriesByUrls:{collection:p.LIST_ENTRIES_COLL,operation:"findObjects",args:{url:{$in:"$urls:pk"}}},findListEntriesByList:{collection:p.LIST_ENTRIES_COLL,operation:"findObjects",args:{listId:"$listId:pk"}},createAnnotationForList:{collection:p.LIST_ENTRIES_COLL,operation:"createObject"},createBookmark:{collection:p.BMS_COLL,operation:"createObject"},createAnnotation:{collection:p.ANNOTS_COLL,operation:"createObject"},editAnnotation:{collection:p.ANNOTS_COLL,operation:"updateObject",args:[{url:"$url:pk"},{comment:"$comment:string",color:"$color:string",body:"$body:string",lastEdited:"$lastEdited:any"}]},deleteAnnotation:{collection:p.ANNOTS_COLL,operation:"deleteObject",args:{url:"$url:pk"}},deleteAnnotationFromList:{collection:p.LIST_ENTRIES_COLL,operation:"deleteObjects",args:{listId:"$listId:int",url:"$url:string"}},deleteAnnotationEntriesByList:{collection:p.LIST_ENTRIES_COLL,operation:"deleteObjects",args:{listId:"$listId:int"}},deleteListEntriesByUrl:{collection:p.LIST_ENTRIES_COLL,operation:"deleteObjects",args:{url:"$url:string"}},deleteBookmarkByUrl:{collection:p.BMS_COLL,operation:"deleteObject",args:{url:"$url:pk"}},deleteTagsByUrl:{collection:p.TAGS_COLL,operation:"deleteObjects",args:{url:"$url:pk"}},listAnnotsByPage:{operation:l.a.LIST_BY_PAGE_OP_ID,args:["$params:any"]},listAnnotationsByPageUrl:{collection:p.ANNOTS_COLL,operation:"findObjects",args:{pageUrl:"$pageUrl:string"}},listAnnotationIdsByColor:{collection:p.ANNOTS_COLL,operation:"findObjects",args:{color:"$color:string"}},listAnnotationsByPageUrls:{collection:p.ANNOTS_COLL,operation:"findObjects",args:{pageUrl:{$in:"$pageUrls:array:string"}}},listAnnotationTagsForAnnotations:{collection:p.TAGS_COLL,operation:"findObjects",args:{url:{$in:"$annotationUrls:string[]"}}},listAnnotationListsForAnnotations:{collection:p.LIST_ENTRIES_COLL,operation:"findObjects",args:{url:{$in:"$annotationUrls:string[]"}}},listAnnotationBookmarksForAnnotations:{collection:p.BMS_COLL,operation:"findObjects",args:{url:{$in:"$annotationUrls:string[]"}}},findListById:{collection:p.LISTS_COLL,operation:"findObject",args:{id:"$id:pk"}}}}),this.deleteTags=e=>this.options.storageManager.collection(p.TAGS_COLL).deleteObjects(e),this.createTag=e=>this.options.storageManager.collection(p.TAGS_COLL).createObject(e),this.editAnnotationTags=(e,t,n)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield Promise.all(t.map((e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.deleteTags({name:e,url:n})}))))),Promise.all(e.map((e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.createTag({name:e,url:n})})))))})),this.modifyTags=e=>(t,n)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return e?this.createTag({name:t,url:n}):this.deleteTags({name:t,url:n})}))}getAnnotations(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findAnnotationsByUrls",{urls:e})}))}listAnnotationsByPageUrl({pageUrl:e,withTags:t,withLists:n,withBookmarks:i}){var o,s;return Object(r.__awaiter)(this,void 0,void 0,(function*(){e=Object(d.c)(e);const r=yield this.operation("listAnnotationsByPageUrl",{pageUrl:e}),a=r.map((e=>e.url));let c=new Map,l=new Map,u=new Map;if(!1!==i&&(c=new Map((yield this.operation("listAnnotationBookmarksForAnnotations",{annotationUrls:a})).map((e=>[e.url,e])))),!1!==t){const e=yield this.operation("listAnnotationTagsForAnnotations",{annotationUrls:a});l=new Map;for(const t of e){const e=null!==(o=l.get(t.url))&&void 0!==o?o:[];l.set(t.url,[...e,t.name])}}if(!1!==n){const e=yield this.operation("listAnnotationListsForAnnotations",{annotationUrls:a});u=new Map;for(const t of e){const e=null!==(s=u.get(t.url))&&void 0!==s?s:[];u.set(t.url,[...e,t.listId])}}return r.forEach((e=>{var t,n,r;e.tags=null!==(t=l.get(e.url))&&void 0!==t?t:[],e.isBookmarked=null!==(n=c.get(e.url))&&void 0!==n&&n,e.lists=null!==(r=u.get(e.url))&&void 0!==r?r:[]})),r}))}listAnnotationsByPageUrls({pageUrls:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){e=e.map((e=>Object(d.c)(e)));return yield this.operation("listAnnotationsByPageUrls",{pageUrls:e})}))}listAnnotationIdsByColor(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.operation("listAnnotationIdsByColor",{color:e})}))}getListById({listId:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.options.storageManager.collection(p.LISTS_COLL).findOneObject({id:e});if(null==t)throw new Error(`No list exists for ID: ${e}`);return t.id}))}insertAnnotToList({listId:e,url:t},n){var i,o,s,a;return Object(r.__awaiter)(this,void 0,void 0,(function*(){(null==n?void 0:n.skipListExistenceCheck)||(yield this.getListById({listId:e})),yield this.operation("createAnnotationForList",{listId:e,url:t,createdAt:new Date});try{if(yield Object(f.c)({storageAPI:this.options.___storageAPI})){const n=yield this.getAnnotations([t]),c=n[0],l=(yield this.options.storageManager.collection(p.LISTS_COLL).findOneObject({id:e})).name,u=(yield this.options.storageManager.collection("visits").findOneObject({url:Object(d.c)(c.pageUrl)})).time,f=yield this.options.storageManager.collection("pages").findOneObject({url:Object(d.c)(c.pageUrl)}),g={annotationId:c.url,pageTitle:c.pageTitle,pageUrl:null!==(i=f.fullUrl)&&void 0!==i?i:"https://"+c.pageUrl,annotationSpaces:l,pageCreatedWhen:u,body:null===(o=n[0])||void 0===o?void 0:o.body,comment:null===(s=n[0])||void 0===s?void 0:s.comment,createdWhen:null===(a=n[0])||void 0===a?void 0:a.createdWhen};Object(h.a)(g,this.options.pkmSyncBG,((e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.checkIfAnnotationInfilteredList({url:e,listNames:t})}))))}}catch(e){}}))}ensureAnnotInList({listId:e,url:t},n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){(yield this.operation("findListEntry",{listId:e,url:t}))||(yield this.insertAnnotToList({listId:e,url:t},n))}))}removeAnnotsFromList(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteAnnotationEntriesByList",{listId:e.listId})}))}removeAnnotFromList({listId:e,url:t}){var n,i,o;return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.getListById({listId:e}),yield this.operation("deleteAnnotationFromList",{listId:e,url:t});try{if(yield Object(f.c)({storageAPI:this.options.___storageAPI})){const r=yield this.getAnnotations([t]),s=r[0],a=(yield this.options.storageManager.collection(p.LISTS_COLL).findOneObject({id:e})).name,c=(yield this.options.storageManager.collection("visits").findOneObject({url:Object(d.c)(s.pageUrl)})).time,l={annotationId:s.url,pageTitle:s.pageTitle,pageUrl:s.pageUrl,annotationSpaces:a,pageCreatedWhen:c,body:null===(n=r[0])||void 0===n?void 0:n.body,comment:null===(i=r[0])||void 0===i?void 0:i.comment,createdWhen:null===(o=r[0])||void 0===o?void 0:o.createdWhen};Object(h.a)(l,this.options.pkmSyncBG)}}catch(e){}}))}toggleAnnotBookmark({url:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return null==(yield this.operation("findBookmarkByUrl",{url:e}))?(yield this.operation("createBookmark",{url:e,createdAt:new Date}),!0):(yield this.operation("deleteBookmarkByUrl",{url:e}),!1)}))}deleteBookmarkByUrl({url:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("deleteBookmarkByUrl",{url:e})}))}annotHasBookmark({url:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return null!=(yield this.operation("findBookmarkByUrl",{url:e}))}))}updateAnnotationBookmark({url:e,isBookmarked:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!!(yield this.operation("findBookmarkByUrl",{url:e}))!==t)return t?this.operation("createBookmark",{url:e,createdAt:new Date}):this.operation("deleteBookmarkByUrl",{url:e})}))}getAnnotationByPk({url:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(e.length>0){return this.operation("findAnnotationByUrl",{url:e})}}))}getAllAnnotationsByUrl(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.operation("listAnnotsByPage",{params:e})}))}createAnnotation({pageTitle:e,pageUrl:t,body:n,url:i,comment:o,selector:s,color:a,userId:c,createdWhen:l=new Date}){var u,p;return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!(null==n?void 0:n.length)&&!(null==o?void 0:o.length))throw new Error("Failed create annotation attempt - no highlight or comment supplied");try{if(yield Object(f.c)({storageAPI:this.options.___storageAPI})){const r=yield this.options.storageManager.collection("visits").findOneObject({url:Object(d.c)(i)}),s=null!==(u=null==r?void 0:r.time)&&void 0!==u?u:l,c=yield this.options.storageManager.collection("pages").findOneObject({url:Object(d.c)(i)}),f={annotationId:i,pageTitle:e,body:null!=n?n:"",comment:null!=o?o:"",createdWhen:l.getTime(),color:null!=a?a:null,pageCreatedWhen:s,pageUrl:null!==(p=null==c?void 0:c.fullUrl)&&void 0!==p?p:t};Object(h.a)(f,this.options.pkmSyncBG)}}catch(e){}return this.operation("createAnnotation",{pageTitle:e,pageUrl:t,comment:o,body:n,selector:s,color:a,createdWhen:l,lastEdited:l,url:i})}))}checkIfAnnotationInfilteredList({url:e,listNames:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.operation("findListEntriesByUrl",{url:e});if(0===n.length)return!1;for(const e of n){const n=(yield this.operation("findListById",{id:e.listId})).name;if(t.includes(n))return!0}}))}editAnnotation(e,t,n,i,o=new Date,s){var a;return Object(r.__awaiter)(this,void 0,void 0,(function*(){try{if(yield Object(f.c)({storageAPI:this.options.___storageAPI})){const n=(yield this.getAnnotations([e]))[0],o=(yield this.options.storageManager.collection("visits").findOneObject({url:Object(d.c)(n.pageUrl)})).time,s=yield this.options.storageManager.collection("pages").findOneObject({url:Object(d.c)(n.pageUrl)}),c={annotationId:n.url,pageTitle:n.pageTitle,body:null!=i?i:n.body,createdWhen:n.createdWhen,comment:t,pageCreatedWhen:o,pageUrl:null!==(a=s.fullUrl)&&void 0!==a?a:"https://"+n.pageUrl};Object(h.a)(c,this.options.pkmSyncBG,((e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.checkIfAnnotationInfilteredList({url:e,listNames:t})}))))}}catch(e){}return this.operation("editAnnotation",{url:e,comment:t,color:n,body:i,lastEdited:o})}))}deleteAnnotation(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("deleteAnnotation",{url:e})}))}getTagsByAnnotationUrl(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.options.storageManager.collection(p.TAGS_COLL).findAllObjects({url:e})}))}deleteTagsByUrl({url:e}){return this.operation("deleteTagsByUrl",{url:e})}deleteListEntriesByUrl({url:e}){return this.operation("deleteListEntriesByUrl",{url:e})}findListEntriesByUrl({url:e}){return this.operation("findListEntriesByUrl",{url:e})}findListEntriesByList(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.operation("findListEntriesByList",{listId:e.listId})}))}findListEntriesByUrls({annotationUrls:e}){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.operation("findListEntriesByUrls",{urls:e}),r={};for(const e of n){const n=null!==(t=r[e.url])&&void 0!==t?t:[];r[e.url]=[...n,e]}return r}))}}p.PAGES_COLL=s.b.page,p.ANNOTS_COLL=o.b.annotation,p.TAGS_COLL=a.b.tag,p.BMS_COLL=o.b.bookmark,p.LISTS_COLL=c.b.list,p.LIST_ENTRIES_COLL=o.b.listEntry},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.innerText=t.textContent=t.getText=t.getInnerHTML=t.getOuterHTML=void 0;var i=n(155),o=r(n(788)),s=n(600);function a(e,t){return(0,o.default)(e,t)}t.getOuterHTML=a,t.getInnerHTML=function(e,t){return(0,i.hasChildren)(e)?e.children.map((function(e){return a(e,t)})).join(""):""},t.getText=function e(t){return Array.isArray(t)?t.map(e).join(""):(0,i.isTag)(t)?"br"===t.name?"\n":e(t.children):(0,i.isCDATA)(t)?e(t.children):(0,i.isText)(t)?t.data:""},t.textContent=function e(t){return Array.isArray(t)?t.map(e).join(""):(0,i.hasChildren)(t)&&!(0,i.isComment)(t)?e(t.children):(0,i.isText)(t)?t.data:""},t.innerText=function e(t){return Array.isArray(t)?t.map(e).join(""):(0,i.hasChildren)(t)&&(t.type===s.ElementType.Tag||(0,i.isCDATA)(t))?e(t.children):(0,i.isText)(t)?t.data:""}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Doctype=t.CDATA=t.Tag=t.Style=t.Script=t.Comment=t.Directive=t.Text=t.Root=t.isTag=t.ElementType=void 0,function(e){e.Root="root",e.Text="text",e.Directive="directive",e.Comment="comment",e.Script="script",e.Style="style",e.Tag="tag",e.CDATA="cdata",e.Doctype="doctype"}(r=t.ElementType||(t.ElementType={})),t.isTag=function(e){return e.type===r.Tag||e.type===r.Script||e.type===r.Style},t.Root=r.Root,t.Text=r.Text,t.Directive=r.Directive,t.Comment=r.Comment,t.Script=r.Script,t.Style=r.Style,t.Tag=r.Tag,t.CDATA=r.CDATA,t.Doctype=r.Doctype},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.cloneNode=t.hasChildren=t.isDocument=t.isDirective=t.isComment=t.isText=t.isCDATA=t.isTag=t.Element=t.Document=t.CDATA=t.NodeWithChildren=t.ProcessingInstruction=t.Comment=t.Text=t.DataNode=t.Node=void 0;var s=n(598),a=function(){function e(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}return Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.parent},set:function(e){this.parent=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){return this.prev},set:function(e){this.prev=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){return this.next},set:function(e){this.next=e},enumerable:!1,configurable:!0}),e.prototype.cloneNode=function(e){return void 0===e&&(e=!1),T(this,e)},e}();t.Node=a;var c=function(e){function t(t){var n=e.call(this)||this;return n.data=t,n}return i(t,e),Object.defineProperty(t.prototype,"nodeValue",{get:function(){return this.data},set:function(e){this.data=e},enumerable:!1,configurable:!0}),t}(a);t.DataNode=c;var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=s.ElementType.Text,t}return i(t,e),Object.defineProperty(t.prototype,"nodeType",{get:function(){return 3},enumerable:!1,configurable:!0}),t}(c);t.Text=l;var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=s.ElementType.Comment,t}return i(t,e),Object.defineProperty(t.prototype,"nodeType",{get:function(){return 8},enumerable:!1,configurable:!0}),t}(c);t.Comment=u;var d=function(e){function t(t,n){var r=e.call(this,n)||this;return r.name=t,r.type=s.ElementType.Directive,r}return i(t,e),Object.defineProperty(t.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),t}(c);t.ProcessingInstruction=d;var h=function(e){function t(t){var n=e.call(this)||this;return n.children=t,n}return i(t,e),Object.defineProperty(t.prototype,"firstChild",{get:function(){var e;return null!==(e=this.children[0])&&void 0!==e?e:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.children.length>0?this.children[this.children.length-1]:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"childNodes",{get:function(){return this.children},set:function(e){this.children=e},enumerable:!1,configurable:!0}),t}(a);t.NodeWithChildren=h;var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=s.ElementType.CDATA,t}return i(t,e),Object.defineProperty(t.prototype,"nodeType",{get:function(){return 4},enumerable:!1,configurable:!0}),t}(h);t.CDATA=f;var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=s.ElementType.Root,t}return i(t,e),Object.defineProperty(t.prototype,"nodeType",{get:function(){return 9},enumerable:!1,configurable:!0}),t}(h);t.Document=p;var g=function(e){function t(t,n,r,i){void 0===r&&(r=[]),void 0===i&&(i="script"===t?s.ElementType.Script:"style"===t?s.ElementType.Style:s.ElementType.Tag);var o=e.call(this,r)||this;return o.name=t,o.attribs=n,o.type=i,o}return i(t,e),Object.defineProperty(t.prototype,"nodeType",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tagName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"attributes",{get:function(){var e=this;return Object.keys(this.attribs).map((function(t){var n,r;return{name:t,value:e.attribs[t],namespace:null===(n=e["x-attribsNamespace"])||void 0===n?void 0:n[t],prefix:null===(r=e["x-attribsPrefix"])||void 0===r?void 0:r[t]}}))},enumerable:!1,configurable:!0}),t}(h);function m(e){return(0,s.isTag)(e)}function y(e){return e.type===s.ElementType.CDATA}function v(e){return e.type===s.ElementType.Text}function b(e){return e.type===s.ElementType.Comment}function _(e){return e.type===s.ElementType.Directive}function w(e){return e.type===s.ElementType.Root}function T(e,t){var n;if(void 0===t&&(t=!1),v(e))n=new l(e.data);else if(b(e))n=new u(e.data);else if(m(e)){var r=t?E(e.children):[],i=new g(e.name,o({},e.attribs),r);r.forEach((function(e){return e.parent=i})),null!=e.namespace&&(i.namespace=e.namespace),e["x-attribsNamespace"]&&(i["x-attribsNamespace"]=o({},e["x-attribsNamespace"])),e["x-attribsPrefix"]&&(i["x-attribsPrefix"]=o({},e["x-attribsPrefix"])),n=i}else if(y(e)){r=t?E(e.children):[];var s=new f(r);r.forEach((function(e){return e.parent=s})),n=s}else if(w(e)){r=t?E(e.children):[];var a=new p(r);r.forEach((function(e){return e.parent=a})),e["x-mode"]&&(a["x-mode"]=e["x-mode"]),n=a}else{if(!_(e))throw new Error("Not implemented yet: ".concat(e.type));var c=new d(e.name,e.data);null!=e["x-name"]&&(c["x-name"]=e["x-name"],c["x-publicId"]=e["x-publicId"],c["x-systemId"]=e["x-systemId"]),n=c}return n.startIndex=e.startIndex,n.endIndex=e.endIndex,null!=e.sourceCodeLocation&&(n.sourceCodeLocation=e.sourceCodeLocation),n}function E(e){for(var t=e.map((function(e){return T(e,!0)})),n=1;n<t.length;n++)t[n].prev=t[n-1],t[n-1].next=t[n];return t}t.Element=g,t.isTag=m,t.isCDATA=y,t.isText=v,t.isComment=b,t.isDirective=_,t.isDocument=w,t.hasChildren=function(e){return Object.prototype.hasOwnProperty.call(e,"children")},t.cloneNode=T},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Doctype=t.CDATA=t.Tag=t.Style=t.Script=t.Comment=t.Directive=t.Text=t.Root=t.isTag=t.ElementType=void 0,function(e){e.Root="root",e.Text="text",e.Directive="directive",e.Comment="comment",e.Script="script",e.Style="style",e.Tag="tag",e.CDATA="cdata",e.Doctype="doctype"}(r=t.ElementType||(t.ElementType={})),t.isTag=function(e){return e.type===r.Tag||e.type===r.Script||e.type===r.Style},t.Root=r.Root,t.Text=r.Text,t.Directive=r.Directive,t.Comment=r.Comment,t.Script=r.Script,t.Style=r.Style,t.Tag=r.Tag,t.CDATA=r.CDATA,t.Doctype=r.Doctype},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.replaceCodePoint=t.fromCodePoint=void 0;var i=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);function o(e){var t;return e>=55296&&e<=57343||e>1114111?65533:null!==(t=i.get(e))&&void 0!==t?t:e}t.fromCodePoint=null!==(r=String.fromCodePoint)&&void 0!==r?r:function(e){var t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|1023&e),t+=String.fromCharCode(e)},t.replaceCodePoint=o,t.default=function(e){return(0,t.fromCodePoint)(o(e))}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.encodeNonAsciiHTML=t.encodeHTML=void 0;var i=r(n(791)),o=n(509),s=/[\t\n!-,./:-@[-`\f{-}$\x80-\uFFFF]/g;function a(e,t){for(var n,r="",s=0;null!==(n=e.exec(t));){var a=n.index;r+=t.substring(s,a);var c=t.charCodeAt(a),l=i.default.get(c);if("object"==typeof l){if(a+1<t.length){var u=t.charCodeAt(a+1),d="number"==typeof l.n?l.n===u?l.o:void 0:l.n.get(u);if(void 0!==d){r+=d,s=e.lastIndex+=1;continue}}l=l.v}if(void 0!==l)r+=l,s=a+1;else{var h=(0,o.getCodePoint)(t,a);r+="&#x".concat(h.toString(16),";"),s=e.lastIndex+=Number(h!==c)}}return r+t.substr(s)}t.encodeHTML=function(e){return a(s,e)},t.encodeNonAsciiHTML=function(e){return a(o.xmlReplacer,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findAll=t.existsOne=t.findOne=t.findOneChild=t.find=t.filter=void 0;var r=n(155);function i(e,t,n,i){for(var o=[],s=[t],a=[0];;)if(a[0]>=s[0].length){if(1===a.length)return o;s.shift(),a.shift()}else{var c=s[0][a[0]++];if(e(c)&&(o.push(c),--i<=0))return o;n&&(0,r.hasChildren)(c)&&c.children.length>0&&(a.unshift(0),s.unshift(c.children))}}t.filter=function(e,t,n,r){return void 0===n&&(n=!0),void 0===r&&(r=1/0),i(e,Array.isArray(t)?t:[t],n,r)},t.find=i,t.findOneChild=function(e,t){return t.find(e)},t.findOne=function e(t,n,i){void 0===i&&(i=!0);for(var o=null,s=0;s<n.length&&!o;s++){var a=n[s];(0,r.isTag)(a)&&(t(a)?o=a:i&&a.children.length>0&&(o=e(t,a.children,!0)))}return o},t.existsOne=function e(t,n){return n.some((function(n){return(0,r.isTag)(n)&&(t(n)||e(t,n.children))}))},t.findAll=function(e,t){for(var n=[],i=[t],o=[0];;)if(o[0]>=i[0].length){if(1===i.length)return n;i.shift(),o.shift()}else{var s=i[0][o[0]++];(0,r.isTag)(s)&&(e(s)&&n.push(s),s.children.length>0&&(o.unshift(0),i.unshift(s.children)))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getElementsByTagType=t.getElementsByTagName=t.getElementById=t.getElements=t.testElement=void 0;var r=n(155),i=n(603),o={tag_name:function(e){return"function"==typeof e?function(t){return(0,r.isTag)(t)&&e(t.name)}:"*"===e?r.isTag:function(t){return(0,r.isTag)(t)&&t.name===e}},tag_type:function(e){return"function"==typeof e?function(t){return e(t.type)}:function(t){return t.type===e}},tag_contains:function(e){return"function"==typeof e?function(t){return(0,r.isText)(t)&&e(t.data)}:function(t){return(0,r.isText)(t)&&t.data===e}}};function s(e,t){return"function"==typeof t?function(n){return(0,r.isTag)(n)&&t(n.attribs[e])}:function(n){return(0,r.isTag)(n)&&n.attribs[e]===t}}function a(e,t){return function(n){return e(n)||t(n)}}function c(e){var t=Object.keys(e).map((function(t){var n=e[t];return Object.prototype.hasOwnProperty.call(o,t)?o[t](n):s(t,n)}));return 0===t.length?null:t.reduce(a)}t.testElement=function(e,t){var n=c(e);return!n||n(t)},t.getElements=function(e,t,n,r){void 0===r&&(r=1/0);var o=c(e);return o?(0,i.filter)(o,t,n,r):[]},t.getElementById=function(e,t,n){return void 0===n&&(n=!0),Array.isArray(t)||(t=[t]),(0,i.findOne)(s("id",e),t,n)},t.getElementsByTagName=function(e,t,n,r){return void 0===n&&(n=!0),void 0===r&&(r=1/0),(0,i.filter)(o.tag_name(e),t,n,r)},t.getElementsByTagType=function(e,t,n,r){return void 0===n&&(n=!0),void 0===r&&(r=1/0),(0,i.filter)(o.tag_type(e),t,n,r)}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.stringify=t.parse=t.isTraversal=void 0,i(n(518),t);var o=n(797);Object.defineProperty(t,"isTraversal",{enumerable:!0,get:function(){return o.isTraversal}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return o.parse}});var s=n(798);Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return s.stringify}})},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=void 0;var s=o(n(607)),a=n(335),c=new Set(["input","option","optgroup","select","button","datalist","textarea"]),l=new Set(["p"]),u=new Set(["thead","tbody"]),d=new Set(["dd","dt"]),h=new Set(["rt","rp"]),f=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",l],["h1",l],["h2",l],["h3",l],["h4",l],["h5",l],["h6",l],["select",c],["input",c],["output",c],["button",c],["datalist",c],["textarea",c],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",d],["dt",d],["address",l],["article",l],["aside",l],["blockquote",l],["details",l],["div",l],["dl",l],["fieldset",l],["figcaption",l],["figure",l],["footer",l],["form",l],["header",l],["hr",l],["main",l],["nav",l],["ol",l],["pre",l],["section",l],["table",l],["ul",l],["rt",h],["rp",h],["tbody",u],["tfoot",u]]),p=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),g=new Set(["math","svg"]),m=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),y=/\s|\//,v=function(){function e(e,t){var n,r,i,o,a;void 0===t&&(t={}),this.options=t,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.foreignContext=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=null!=e?e:{},this.lowerCaseTagNames=null!==(n=t.lowerCaseTags)&&void 0!==n?n:!t.xmlMode,this.lowerCaseAttributeNames=null!==(r=t.lowerCaseAttributeNames)&&void 0!==r?r:!t.xmlMode,this.tokenizer=new(null!==(i=t.Tokenizer)&&void 0!==i?i:s.default)(this.options,this),null===(a=(o=this.cbs).onparserinit)||void 0===a||a.call(o,this)}return e.prototype.ontext=function(e,t){var n,r,i=this.getSlice(e,t);this.endIndex=t-1,null===(r=(n=this.cbs).ontext)||void 0===r||r.call(n,i),this.startIndex=t},e.prototype.ontextentity=function(e){var t,n,r=this.tokenizer.getSectionStart();this.endIndex=r-1,null===(n=(t=this.cbs).ontext)||void 0===n||n.call(t,(0,a.fromCodePoint)(e)),this.startIndex=r},e.prototype.isVoidElement=function(e){return!this.options.xmlMode&&p.has(e)},e.prototype.onopentagname=function(e,t){this.endIndex=t;var n=this.getSlice(e,t);this.lowerCaseTagNames&&(n=n.toLowerCase()),this.emitOpenTag(n)},e.prototype.emitOpenTag=function(e){var t,n,r,i;this.openTagStart=this.startIndex,this.tagname=e;var o=!this.options.xmlMode&&f.get(e);if(o)for(;this.stack.length>0&&o.has(this.stack[this.stack.length-1]);){var s=this.stack.pop();null===(n=(t=this.cbs).onclosetag)||void 0===n||n.call(t,s,!0)}this.isVoidElement(e)||(this.stack.push(e),g.has(e)?this.foreignContext.push(!0):m.has(e)&&this.foreignContext.push(!1)),null===(i=(r=this.cbs).onopentagname)||void 0===i||i.call(r,e),this.cbs.onopentag&&(this.attribs={})},e.prototype.endOpenTag=function(e){var t,n;this.startIndex=this.openTagStart,this.attribs&&(null===(n=(t=this.cbs).onopentag)||void 0===n||n.call(t,this.tagname,this.attribs,e),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""},e.prototype.onopentagend=function(e){this.endIndex=e,this.endOpenTag(!1),this.startIndex=e+1},e.prototype.onclosetag=function(e,t){var n,r,i,o,s,a;this.endIndex=t;var c=this.getSlice(e,t);if(this.lowerCaseTagNames&&(c=c.toLowerCase()),(g.has(c)||m.has(c))&&this.foreignContext.pop(),this.isVoidElement(c))this.options.xmlMode||"br"!==c||(null===(r=(n=this.cbs).onopentagname)||void 0===r||r.call(n,"br"),null===(o=(i=this.cbs).onopentag)||void 0===o||o.call(i,"br",{},!0),null===(a=(s=this.cbs).onclosetag)||void 0===a||a.call(s,"br",!1));else{var l=this.stack.lastIndexOf(c);if(-1!==l)if(this.cbs.onclosetag)for(var u=this.stack.length-l;u--;)this.cbs.onclosetag(this.stack.pop(),0!==u);else this.stack.length=l;else this.options.xmlMode||"p"!==c||(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=t+1},e.prototype.onselfclosingtag=function(e){this.endIndex=e,this.options.xmlMode||this.options.recognizeSelfClosing||this.foreignContext[this.foreignContext.length-1]?(this.closeCurrentTag(!1),this.startIndex=e+1):this.onopentagend(e)},e.prototype.closeCurrentTag=function(e){var t,n,r=this.tagname;this.endOpenTag(e),this.stack[this.stack.length-1]===r&&(null===(n=(t=this.cbs).onclosetag)||void 0===n||n.call(t,r,!e),this.stack.pop())},e.prototype.onattribname=function(e,t){this.startIndex=e;var n=this.getSlice(e,t);this.attribname=this.lowerCaseAttributeNames?n.toLowerCase():n},e.prototype.onattribdata=function(e,t){this.attribvalue+=this.getSlice(e,t)},e.prototype.onattribentity=function(e){this.attribvalue+=(0,a.fromCodePoint)(e)},e.prototype.onattribend=function(e,t){var n,r;this.endIndex=t,null===(r=(n=this.cbs).onattribute)||void 0===r||r.call(n,this.attribname,this.attribvalue,e===s.QuoteType.Double?'"':e===s.QuoteType.Single?"'":e===s.QuoteType.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""},e.prototype.getInstructionName=function(e){var t=e.search(y),n=t<0?e:e.substr(0,t);return this.lowerCaseTagNames&&(n=n.toLowerCase()),n},e.prototype.ondeclaration=function(e,t){this.endIndex=t;var n=this.getSlice(e,t);if(this.cbs.onprocessinginstruction){var r=this.getInstructionName(n);this.cbs.onprocessinginstruction("!".concat(r),"!".concat(n))}this.startIndex=t+1},e.prototype.onprocessinginstruction=function(e,t){this.endIndex=t;var n=this.getSlice(e,t);if(this.cbs.onprocessinginstruction){var r=this.getInstructionName(n);this.cbs.onprocessinginstruction("?".concat(r),"?".concat(n))}this.startIndex=t+1},e.prototype.oncomment=function(e,t,n){var r,i,o,s;this.endIndex=t,null===(i=(r=this.cbs).oncomment)||void 0===i||i.call(r,this.getSlice(e,t-n)),null===(s=(o=this.cbs).oncommentend)||void 0===s||s.call(o),this.startIndex=t+1},e.prototype.oncdata=function(e,t,n){var r,i,o,s,a,c,l,u,d,h;this.endIndex=t;var f=this.getSlice(e,t-n);this.options.xmlMode||this.options.recognizeCDATA?(null===(i=(r=this.cbs).oncdatastart)||void 0===i||i.call(r),null===(s=(o=this.cbs).ontext)||void 0===s||s.call(o,f),null===(c=(a=this.cbs).oncdataend)||void 0===c||c.call(a)):(null===(u=(l=this.cbs).oncomment)||void 0===u||u.call(l,"[CDATA[".concat(f,"]]")),null===(h=(d=this.cbs).oncommentend)||void 0===h||h.call(d)),this.startIndex=t+1},e.prototype.onend=function(){var e,t;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(var n=this.stack.length;n>0;this.cbs.onclosetag(this.stack[--n],!0));}null===(t=(e=this.cbs).onend)||void 0===t||t.call(e)},e.prototype.reset=function(){var e,t,n,r;null===(t=(e=this.cbs).onreset)||void 0===t||t.call(e),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,null===(r=(n=this.cbs).onparserinit)||void 0===r||r.call(n,this),this.buffers.length=0,this.bufferOffset=0,this.writeIndex=0,this.ended=!1},e.prototype.parseComplete=function(e){this.reset(),this.end(e)},e.prototype.getSlice=function(e,t){for(;e-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();for(var n=this.buffers[0].slice(e-this.bufferOffset,t-this.bufferOffset);t-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),n+=this.buffers[0].slice(0,t-this.bufferOffset);return n},e.prototype.shiftBuffer=function(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()},e.prototype.write=function(e){var t,n;this.ended?null===(n=(t=this.cbs).onerror)||void 0===n||n.call(t,new Error(".write() after done!")):(this.buffers.push(e),this.tokenizer.running&&(this.tokenizer.write(e),this.writeIndex++))},e.prototype.end=function(e){var t,n;this.ended?null===(n=(t=this.cbs).onerror)||void 0===n||n.call(t,new Error(".end() after done!")):(e&&this.write(e),this.ended=!0,this.tokenizer.end())},e.prototype.pause=function(){this.tokenizer.pause()},e.prototype.resume=function(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()},e.prototype.parseChunk=function(e){this.write(e)},e.prototype.done=function(e){this.end(e)},e}();t.Parser=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuoteType=void 0;var r,i,o,s=n(335);function a(e){return e===r.Space||e===r.NewLine||e===r.Tab||e===r.FormFeed||e===r.CarriageReturn}function c(e){return e===r.Slash||e===r.Gt||a(e)}function l(e){return e>=r.Zero&&e<=r.Nine}!function(e){e[e.Tab=9]="Tab",e[e.NewLine=10]="NewLine",e[e.FormFeed=12]="FormFeed",e[e.CarriageReturn=13]="CarriageReturn",e[e.Space=32]="Space",e[e.ExclamationMark=33]="ExclamationMark",e[e.Number=35]="Number",e[e.Amp=38]="Amp",e[e.SingleQuote=39]="SingleQuote",e[e.DoubleQuote=34]="DoubleQuote",e[e.Dash=45]="Dash",e[e.Slash=47]="Slash",e[e.Zero=48]="Zero",e[e.Nine=57]="Nine",e[e.Semi=59]="Semi",e[e.Lt=60]="Lt",e[e.Eq=61]="Eq",e[e.Gt=62]="Gt",e[e.Questionmark=63]="Questionmark",e[e.UpperA=65]="UpperA",e[e.LowerA=97]="LowerA",e[e.UpperF=70]="UpperF",e[e.LowerF=102]="LowerF",e[e.UpperZ=90]="UpperZ",e[e.LowerZ=122]="LowerZ",e[e.LowerX=120]="LowerX",e[e.OpeningSquareBracket=91]="OpeningSquareBracket"}(r||(r={})),function(e){e[e.Text=1]="Text",e[e.BeforeTagName=2]="BeforeTagName",e[e.InTagName=3]="InTagName",e[e.InSelfClosingTag=4]="InSelfClosingTag",e[e.BeforeClosingTagName=5]="BeforeClosingTagName",e[e.InClosingTagName=6]="InClosingTagName",e[e.AfterClosingTagName=7]="AfterClosingTagName",e[e.BeforeAttributeName=8]="BeforeAttributeName",e[e.InAttributeName=9]="InAttributeName",e[e.AfterAttributeName=10]="AfterAttributeName",e[e.BeforeAttributeValue=11]="BeforeAttributeValue",e[e.InAttributeValueDq=12]="InAttributeValueDq",e[e.InAttributeValueSq=13]="InAttributeValueSq",e[e.InAttributeValueNq=14]="InAttributeValueNq",e[e.BeforeDeclaration=15]="BeforeDeclaration",e[e.InDeclaration=16]="InDeclaration",e[e.InProcessingInstruction=17]="InProcessingInstruction",e[e.BeforeComment=18]="BeforeComment",e[e.CDATASequence=19]="CDATASequence",e[e.InSpecialComment=20]="InSpecialComment",e[e.InCommentLike=21]="InCommentLike",e[e.BeforeSpecialS=22]="BeforeSpecialS",e[e.SpecialStartSequence=23]="SpecialStartSequence",e[e.InSpecialTag=24]="InSpecialTag",e[e.BeforeEntity=25]="BeforeEntity",e[e.BeforeNumericEntity=26]="BeforeNumericEntity",e[e.InNamedEntity=27]="InNamedEntity",e[e.InNumericEntity=28]="InNumericEntity",e[e.InHexEntity=29]="InHexEntity"}(i||(i={})),function(e){e[e.NoValue=0]="NoValue",e[e.Unquoted=1]="Unquoted",e[e.Single=2]="Single",e[e.Double=3]="Double"}(o=t.QuoteType||(t.QuoteType={}));var u={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101])},d=function(){function e(e,t){var n=e.xmlMode,r=void 0!==n&&n,o=e.decodeEntities,a=void 0===o||o;this.cbs=t,this.state=i.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=i.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.currentSequence=void 0,this.sequenceIndex=0,this.trieIndex=0,this.trieCurrent=0,this.entityResult=0,this.entityExcess=0,this.xmlMode=r,this.decodeEntities=a,this.entityTrie=r?s.xmlDecodeTree:s.htmlDecodeTree}return e.prototype.reset=function(){this.state=i.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=i.Text,this.currentSequence=void 0,this.running=!0,this.offset=0},e.prototype.write=function(e){this.offset+=this.buffer.length,this.buffer=e,this.parse()},e.prototype.end=function(){this.running&&this.finish()},e.prototype.pause=function(){this.running=!1},e.prototype.resume=function(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()},e.prototype.getIndex=function(){return this.index},e.prototype.getSectionStart=function(){return this.sectionStart},e.prototype.stateText=function(e){e===r.Lt||!this.decodeEntities&&this.fastForwardTo(r.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=i.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&e===r.Amp&&(this.state=i.BeforeEntity)},e.prototype.stateSpecialStartSequence=function(e){var t=this.sequenceIndex===this.currentSequence.length;if(t?c(e):(32|e)===this.currentSequence[this.sequenceIndex]){if(!t)return void this.sequenceIndex++}else this.isSpecial=!1;this.sequenceIndex=0,this.state=i.InTagName,this.stateInTagName(e)},e.prototype.stateInSpecialTag=function(e){if(this.sequenceIndex===this.currentSequence.length){if(e===r.Gt||a(e)){var t=this.index-this.currentSequence.length;if(this.sectionStart<t){var n=this.index;this.index=t,this.cbs.ontext(this.sectionStart,t),this.index=n}return this.isSpecial=!1,this.sectionStart=t+2,void this.stateInClosingTagName(e)}this.sequenceIndex=0}(32|e)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:0===this.sequenceIndex?this.currentSequence===u.TitleEnd?this.decodeEntities&&e===r.Amp&&(this.state=i.BeforeEntity):this.fastForwardTo(r.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=Number(e===r.Lt)},e.prototype.stateCDATASequence=function(e){e===u.Cdata[this.sequenceIndex]?++this.sequenceIndex===u.Cdata.length&&(this.state=i.InCommentLike,this.currentSequence=u.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=i.InDeclaration,this.stateInDeclaration(e))},e.prototype.fastForwardTo=function(e){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===e)return!0;return this.index=this.buffer.length+this.offset-1,!1},e.prototype.stateInCommentLike=function(e){e===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===u.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=i.Text):0===this.sequenceIndex?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):e!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)},e.prototype.isTagStartChar=function(e){return this.xmlMode?!c(e):function(e){return e>=r.LowerA&&e<=r.LowerZ||e>=r.UpperA&&e<=r.UpperZ}(e)},e.prototype.startSpecial=function(e,t){this.isSpecial=!0,this.currentSequence=e,this.sequenceIndex=t,this.state=i.SpecialStartSequence},e.prototype.stateBeforeTagName=function(e){if(e===r.ExclamationMark)this.state=i.BeforeDeclaration,this.sectionStart=this.index+1;else if(e===r.Questionmark)this.state=i.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(e)){var t=32|e;this.sectionStart=this.index,this.xmlMode||t!==u.TitleEnd[2]?this.state=this.xmlMode||t!==u.ScriptEnd[2]?i.InTagName:i.BeforeSpecialS:this.startSpecial(u.TitleEnd,3)}else e===r.Slash?this.state=i.BeforeClosingTagName:(this.state=i.Text,this.stateText(e))},e.prototype.stateInTagName=function(e){c(e)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=i.BeforeAttributeName,this.stateBeforeAttributeName(e))},e.prototype.stateBeforeClosingTagName=function(e){a(e)||(e===r.Gt?this.state=i.Text:(this.state=this.isTagStartChar(e)?i.InClosingTagName:i.InSpecialComment,this.sectionStart=this.index))},e.prototype.stateInClosingTagName=function(e){(e===r.Gt||a(e))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=i.AfterClosingTagName,this.stateAfterClosingTagName(e))},e.prototype.stateAfterClosingTagName=function(e){(e===r.Gt||this.fastForwardTo(r.Gt))&&(this.state=i.Text,this.baseState=i.Text,this.sectionStart=this.index+1)},e.prototype.stateBeforeAttributeName=function(e){e===r.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=i.InSpecialTag,this.sequenceIndex=0):this.state=i.Text,this.baseState=this.state,this.sectionStart=this.index+1):e===r.Slash?this.state=i.InSelfClosingTag:a(e)||(this.state=i.InAttributeName,this.sectionStart=this.index)},e.prototype.stateInSelfClosingTag=function(e){e===r.Gt?(this.cbs.onselfclosingtag(this.index),this.state=i.Text,this.baseState=i.Text,this.sectionStart=this.index+1,this.isSpecial=!1):a(e)||(this.state=i.BeforeAttributeName,this.stateBeforeAttributeName(e))},e.prototype.stateInAttributeName=function(e){(e===r.Eq||c(e))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=-1,this.state=i.AfterAttributeName,this.stateAfterAttributeName(e))},e.prototype.stateAfterAttributeName=function(e){e===r.Eq?this.state=i.BeforeAttributeValue:e===r.Slash||e===r.Gt?(this.cbs.onattribend(o.NoValue,this.index),this.state=i.BeforeAttributeName,this.stateBeforeAttributeName(e)):a(e)||(this.cbs.onattribend(o.NoValue,this.index),this.state=i.InAttributeName,this.sectionStart=this.index)},e.prototype.stateBeforeAttributeValue=function(e){e===r.DoubleQuote?(this.state=i.InAttributeValueDq,this.sectionStart=this.index+1):e===r.SingleQuote?(this.state=i.InAttributeValueSq,this.sectionStart=this.index+1):a(e)||(this.sectionStart=this.index,this.state=i.InAttributeValueNq,this.stateInAttributeValueNoQuotes(e))},e.prototype.handleInAttributeValue=function(e,t){e===t||!this.decodeEntities&&this.fastForwardTo(t)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(t===r.DoubleQuote?o.Double:o.Single,this.index),this.state=i.BeforeAttributeName):this.decodeEntities&&e===r.Amp&&(this.baseState=this.state,this.state=i.BeforeEntity)},e.prototype.stateInAttributeValueDoubleQuotes=function(e){this.handleInAttributeValue(e,r.DoubleQuote)},e.prototype.stateInAttributeValueSingleQuotes=function(e){this.handleInAttributeValue(e,r.SingleQuote)},e.prototype.stateInAttributeValueNoQuotes=function(e){a(e)||e===r.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(o.Unquoted,this.index),this.state=i.BeforeAttributeName,this.stateBeforeAttributeName(e)):this.decodeEntities&&e===r.Amp&&(this.baseState=this.state,this.state=i.BeforeEntity)},e.prototype.stateBeforeDeclaration=function(e){e===r.OpeningSquareBracket?(this.state=i.CDATASequence,this.sequenceIndex=0):this.state=e===r.Dash?i.BeforeComment:i.InDeclaration},e.prototype.stateInDeclaration=function(e){(e===r.Gt||this.fastForwardTo(r.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=i.Text,this.sectionStart=this.index+1)},e.prototype.stateInProcessingInstruction=function(e){(e===r.Gt||this.fastForwardTo(r.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=i.Text,this.sectionStart=this.index+1)},e.prototype.stateBeforeComment=function(e){e===r.Dash?(this.state=i.InCommentLike,this.currentSequence=u.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=i.InDeclaration},e.prototype.stateInSpecialComment=function(e){(e===r.Gt||this.fastForwardTo(r.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=i.Text,this.sectionStart=this.index+1)},e.prototype.stateBeforeSpecialS=function(e){var t=32|e;t===u.ScriptEnd[3]?this.startSpecial(u.ScriptEnd,4):t===u.StyleEnd[3]?this.startSpecial(u.StyleEnd,4):(this.state=i.InTagName,this.stateInTagName(e))},e.prototype.stateBeforeEntity=function(e){this.entityExcess=1,this.entityResult=0,e===r.Number?this.state=i.BeforeNumericEntity:e===r.Amp||(this.trieIndex=0,this.trieCurrent=this.entityTrie[0],this.state=i.InNamedEntity,this.stateInNamedEntity(e))},e.prototype.stateInNamedEntity=function(e){if(this.entityExcess+=1,this.trieIndex=(0,s.determineBranch)(this.entityTrie,this.trieCurrent,this.trieIndex+1,e),this.trieIndex<0)return this.emitNamedEntity(),void this.index--;this.trieCurrent=this.entityTrie[this.trieIndex];var t=this.trieCurrent&s.BinTrieFlags.VALUE_LENGTH;if(t){var n=(t>>14)-1;if(this.allowLegacyEntity()||e===r.Semi){var i=this.index-this.entityExcess+1;i>this.sectionStart&&this.emitPartial(this.sectionStart,i),this.entityResult=this.trieIndex,this.trieIndex+=n,this.entityExcess=0,this.sectionStart=this.index+1,0===n&&this.emitNamedEntity()}else this.trieIndex+=n}},e.prototype.emitNamedEntity=function(){if(this.state=this.baseState,0!==this.entityResult)switch((this.entityTrie[this.entityResult]&s.BinTrieFlags.VALUE_LENGTH)>>14){case 1:this.emitCodePoint(this.entityTrie[this.entityResult]&~s.BinTrieFlags.VALUE_LENGTH);break;case 2:this.emitCodePoint(this.entityTrie[this.entityResult+1]);break;case 3:this.emitCodePoint(this.entityTrie[this.entityResult+1]),this.emitCodePoint(this.entityTrie[this.entityResult+2])}},e.prototype.stateBeforeNumericEntity=function(e){(32|e)===r.LowerX?(this.entityExcess++,this.state=i.InHexEntity):(this.state=i.InNumericEntity,this.stateInNumericEntity(e))},e.prototype.emitNumericEntity=function(e){var t=this.index-this.entityExcess-1;t+2+Number(this.state===i.InHexEntity)!==this.index&&(t>this.sectionStart&&this.emitPartial(this.sectionStart,t),this.sectionStart=this.index+Number(e),this.emitCodePoint((0,s.replaceCodePoint)(this.entityResult))),this.state=this.baseState},e.prototype.stateInNumericEntity=function(e){e===r.Semi?this.emitNumericEntity(!0):l(e)?(this.entityResult=10*this.entityResult+(e-r.Zero),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)},e.prototype.stateInHexEntity=function(e){e===r.Semi?this.emitNumericEntity(!0):l(e)?(this.entityResult=16*this.entityResult+(e-r.Zero),this.entityExcess++):!function(e){return e>=r.UpperA&&e<=r.UpperF||e>=r.LowerA&&e<=r.LowerF}(e)?(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--):(this.entityResult=16*this.entityResult+((32|e)-r.LowerA+10),this.entityExcess++)},e.prototype.allowLegacyEntity=function(){return!this.xmlMode&&(this.baseState===i.Text||this.baseState===i.InSpecialTag)},e.prototype.cleanup=function(){this.running&&this.sectionStart!==this.index&&(this.state===i.Text||this.state===i.InSpecialTag&&0===this.sequenceIndex?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):this.state!==i.InAttributeValueDq&&this.state!==i.InAttributeValueSq&&this.state!==i.InAttributeValueNq||(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))},e.prototype.shouldContinue=function(){return this.index<this.buffer.length+this.offset&&this.running},e.prototype.parse=function(){for(;this.shouldContinue();){var e=this.buffer.charCodeAt(this.index-this.offset);switch(this.state){case i.Text:this.stateText(e);break;case i.SpecialStartSequence:this.stateSpecialStartSequence(e);break;case i.InSpecialTag:this.stateInSpecialTag(e);break;case i.CDATASequence:this.stateCDATASequence(e);break;case i.InAttributeValueDq:this.stateInAttributeValueDoubleQuotes(e);break;case i.InAttributeName:this.stateInAttributeName(e);break;case i.InCommentLike:this.stateInCommentLike(e);break;case i.InSpecialComment:this.stateInSpecialComment(e);break;case i.BeforeAttributeName:this.stateBeforeAttributeName(e);break;case i.InTagName:this.stateInTagName(e);break;case i.InClosingTagName:this.stateInClosingTagName(e);break;case i.BeforeTagName:this.stateBeforeTagName(e);break;case i.AfterAttributeName:this.stateAfterAttributeName(e);break;case i.InAttributeValueSq:this.stateInAttributeValueSingleQuotes(e);break;case i.BeforeAttributeValue:this.stateBeforeAttributeValue(e);break;case i.BeforeClosingTagName:this.stateBeforeClosingTagName(e);break;case i.AfterClosingTagName:this.stateAfterClosingTagName(e);break;case i.BeforeSpecialS:this.stateBeforeSpecialS(e);break;case i.InAttributeValueNq:this.stateInAttributeValueNoQuotes(e);break;case i.InSelfClosingTag:this.stateInSelfClosingTag(e);break;case i.InDeclaration:this.stateInDeclaration(e);break;case i.BeforeDeclaration:this.stateBeforeDeclaration(e);break;case i.BeforeComment:this.stateBeforeComment(e);break;case i.InProcessingInstruction:this.stateInProcessingInstruction(e);break;case i.InNamedEntity:this.stateInNamedEntity(e);break;case i.BeforeEntity:this.stateBeforeEntity(e);break;case i.InHexEntity:this.stateInHexEntity(e);break;case i.InNumericEntity:this.stateInNumericEntity(e);break;default:this.stateBeforeNumericEntity(e)}this.index++}this.cleanup()},e.prototype.finish=function(){this.state===i.InNamedEntity&&this.emitNamedEntity(),this.sectionStart<this.index&&this.handleTrailingData(),this.cbs.onend()},e.prototype.handleTrailingData=function(){var e=this.buffer.length+this.offset;this.state===i.InCommentLike?this.currentSequence===u.CdataEnd?this.cbs.oncdata(this.sectionStart,e,0):this.cbs.oncomment(this.sectionStart,e,0):this.state===i.InNumericEntity&&this.allowLegacyEntity()||this.state===i.InHexEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===i.InTagName||this.state===i.BeforeAttributeName||this.state===i.BeforeAttributeValue||this.state===i.AfterAttributeName||this.state===i.InAttributeName||this.state===i.InAttributeValueSq||this.state===i.InAttributeValueDq||this.state===i.InAttributeValueNq||this.state===i.InClosingTagName||this.cbs.ontext(this.sectionStart,e)},e.prototype.emitPartial=function(e,t){this.baseState!==i.Text&&this.baseState!==i.InSpecialTag?this.cbs.onattribdata(e,t):this.cbs.ontext(e,t)},e.prototype.emitCodePoint=function(e){this.baseState!==i.Text&&this.baseState!==i.InSpecialTag?this.cbs.onattribentity(e):this.cbs.ontextentity(e)},e}();t.default=d},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return y}));var r=n(2),i=n(20);const o="@TextExport-default_templates_inserted_1",s={id:1,title:"Page URL",isFavourite:!1,order:i.a+1*i.b,outputFormat:"markdown",code:"{{{PageUrl}}}"},a={id:2,title:"Page URL & Title",isFavourite:!1,order:2*i.b,outputFormat:"markdown",code:"{{{PageTitle}}}\n{{{PageUrl}}}"},c={id:3,title:"Roam Template",isFavourite:!1,order:i.a+3*i.b,outputFormat:"rich-text",code:'[[{{{PageTitle}}}]]\n - url:: {{{PageUrl}}}\n{{#PageSpaces}}\n - Spaces:: {{{PageSpaces}}}\n{{/PageSpaces}}\n{{#HasNotes}}\n  - Annotations::\n{{#Notes}}\n{{#NoteHighlight}}\n    - "{{{NoteHighlight}}}"\n{{/NoteHighlight}}\n{{#NoteText}}\n      - {{{NoteText}}}\n{{/NoteText}}\n{{#NoteSpaces}}\n      - Spaces: {{{NoteSpaces}}}\n{{/NoteSpaces}}\n{{/Notes}}\n{{/HasNotes}}\n'},l={id:4,title:"Tana Paste Template",isFavourite:!1,order:i.a+4*i.b,outputFormat:"markdown",code:'%%tana%%\n- {{{PageTitle}}}\n{{#PageSpaces}}\n    - Spaces: {{{PageSpaces}}}\n{{/PageSpaces}}\n    - url: {{{PageUrl}}}  -\n{{#HasNotes}}\n    - Annotations:\n{{#Notes}}\n        - Note {{#NoteSpaces}}for {{{NoteSpaces}}}{{/NoteSpaces}}\n{{#NoteHighlight}}\n            - "{{{NoteHighlight}}}"\n    {{/NoteHighlight}}\n{{#NoteText}}\n            - {{{NoteText}}}\n    {{/NoteText}}\n{{/Notes}}\n{{/HasNotes}}\n'},u={id:5,title:"Notion Template",isFavourite:!1,order:i.a+5*i.b,outputFormat:"markdown",code:'\n[{{{PageTitle}}}]({{{PageUrl}}})\n{{#PageSpaces}}\n  - Spaces: {{{PageSpaces}}}\n{{/PageSpaces}}\n{{#HasNotes}}\n  - Annotations:\n{{#Notes}}\n{{#NoteHighlight}}\n    - "{{{NoteHighlight}}}"\n{{/NoteHighlight}}\n{{#NoteText}}\n      - {{{NoteText}}}\n    {{/NoteText}}\n{{#NoteSpaces}}\n      - Spaces: {{{NoteSpaces}}}\n{{/NoteSpaces}}\n{{/Notes}}\n{{/HasNotes}}\n'},d={id:6,title:"Obsidian Template",isFavourite:!1,order:i.a+6*i.b,outputFormat:"rich-text",code:'\n- [[{{{PageTitle}}}]]\n    - url: {{{PageUrl}}}\n{{#PageSpaces}}\n    - Spaces: {{{PageSpaces}}}\n{{/PageSpaces}}\n{{#HasNotes}}\n    - Annotations:\n{{#Notes}}\n{{#NoteHighlight}}\n        - "{{{NoteHighlight}}}"\n{{/NoteHighlight}}\n{{#NoteText}}\n            - {{{NoteText}}}\n{{/NoteText}}\n{{#NoteSpaces}}\n            - Spaces: {{{NoteSpaces}}}\n{{/NoteSpaces}}\n{{/Notes}}\n{{/HasNotes}}\n'},h={id:7,title:"Logseq Template",isFavourite:!1,order:i.a+7*i.b,outputFormat:"markdown",code:'[[{{{PageTitle}}}]]\n - url:: {{{PageUrl}}}\n{{#PageSpaces}}\n - Spaces:: {{{PageSpaces}}}\n{{/PageSpaces}}\n{{#HasNotes}}\n  - Annotations::\n{{#Notes}}\n{{#NoteHighlight}}\n    - "{{{NoteHighlight}}}"\n{{/NoteHighlight}}\n{{#NoteText}}\n      - {{{NoteText}}}\n{{/NoteText}}\n{{#NoteSpaces}}\n      - Spaces: {{{NoteSpaces}}}\n{{/NoteSpaces}}\n{{/Notes}}\n{{/HasNotes}}\n'},f={id:8,title:"HTML",isFavourite:!1,order:i.a+8*i.b,outputFormat:"markdown",code:'<a target="_blank"  href="{{{PageUrl}}}">{{{PageTitle}}}</a>\n<ul>\n{{#Notes}}\n<li>\n<p style="font-style: italic">\n"{{{NoteHighlight}}}"\n</p>\n<p>\n{{{NoteText}}}\n</p>\n</li>\n{{/Notes}}\n</ul>\n'},p={id:9,title:"MLA 9th Edition",isFavourite:!1,order:i.a+9*i.b,outputFormat:"rich-text",code:'{{#PageEntities}}{{#isPrimary}}{{{EntityName}}}, {{{EntityAdditionalName}}}{{/isPrimary}}{{#showEtAl}}, et al. {{/showEtAl}} {{/PageEntities}} "{{{PageTitle}}}." _{{{PageJournalName}}}_, vol. {{{PageJournalVolume}}}, no. {{{PageJournalIssue}}}, {{#PageReleaseDate}}MMM. YYYY{{/PageReleaseDate}}, {{#PageJournalPage}} pp. {{{PageJournalPage}}}.{{/PageJournalPage}} https://doi.org/{{{PageDOI}}}.'},g={id:10,title:"Harvard 12th Edition",isFavourite:!1,order:i.a+10*i.b,outputFormat:"rich-text",code:"{{#PageEntities}}{{#isPrimary}}{{{EntityName}}}, {{{EntityAdditionalName}}}{{/isPrimary}}{{#showEtAl}} _et al._ {{/showEtAl}} {{/PageEntities}} ({{#PageReleaseDate}}YYYY{{/PageReleaseDate}}), '{{{PageTitle}}},' _{{{PageJournalName}}}_, {{{PageJournalVolume}}}({{{PageJournalIssue}}}). {{#PageJournalPage}} pp. {{{PageJournalPage}}}.{{/PageJournalPage}} https://doi.org/{{{PageDOI}}}."},m=[s,a,f,p,{id:11,title:"IEEE",isFavourite:!1,order:i.a+10*i.b,outputFormat:"rich-text",code:'{{#PageEntities}}{{{EntityAdditionalNameShort}}} {{{EntityName}}},  {{#secondLast}} and {{/secondLast}}{{/PageEntities}}"{{{PageTitle}}}." _{{{PageJournalName}}}_, vol. {{{PageJournalVolume}}}, no. {{{PageJournalIssue}}}, {{#PageReleaseDate}}MMM. YYYY{{/PageReleaseDate}}{{#PageJournalPage}}, pp. {{{PageJournalPage}}}{{/PageJournalPage}} https://doi.org/{{{PageDOI}}}.'},g,c,h,u,d,l];function y({copyPaster:e,localStorage:t,templates:n=m}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!(yield t.get(o))[o]){for(const t of n)yield e.storage.__createTemplateWithId(t);yield t.set({[o]:!0})}}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(30),i=n(201),o=n(74),s=n(322);class a{constructor(e,t){this._delegate=e,this.firebase=t,Object(o._addComponent)(e,new i.Component("app-compat",(()=>this),"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise((e=>{this._delegate.checkDestroyed(),e()})).then((()=>(this.firebase.INTERNAL.removeApp(this.name),Object(o.deleteApp)(this._delegate))))}_getService(e,t=o._DEFAULT_ENTRY_NAME){var n;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=o._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Object(o._addComponent)(this._delegate,e)}_addOrOverwriteComponent(e){Object(o._addOrOverwriteComponent)(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const c={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},l=new r.ErrorFactory("app-compat","Firebase",c);const u=function e(){const t=function(e){const t={},n={__esModule:!0,initializeApp:function(i,s={}){const a=o.initializeApp(i,s);if(Object(r.contains)(t,a.name))return t[a.name];const c=new e(a,n);return t[a.name]=c,c},app:i,registerVersion:o.registerVersion,setLogLevel:o.setLogLevel,onLog:o.onLog,apps:null,SDK_VERSION:o.SDK_VERSION,INTERNAL:{registerComponent:function(t){const s=t.name,a=s.replace("-compat","");if(o._registerComponent(t)&&"PUBLIC"===t.type){const o=(e=i())=>{if("function"!=typeof e[a])throw l.create("invalid-app-argument",{appName:s});return e[a]()};void 0!==t.serviceProps&&Object(r.deepExtend)(o,t.serviceProps),n[a]=o,e.prototype[a]=function(...e){return this._getService.bind(this,s).apply(this,t.multipleInstances?e:[])}}return"PUBLIC"===t.type?n[a]:null},removeApp:function(e){delete t[e]},useAsService:function(e,t){if("serverAuth"===t)return null;return t},modularAPIs:o}};function i(e){if(e=e||o._DEFAULT_ENTRY_NAME,!Object(r.contains)(t,e))throw l.create("no-app",{appName:e});return t[e]}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(t).map((e=>t[e]))}}),i.App=e,n}(a);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){Object(r.deepExtend)(t,e)},createSubscribe:r.createSubscribe,ErrorFactory:r.ErrorFactory,deepExtend:r.deepExtend}),t}(),d=new s.Logger("@firebase/app-compat");if(Object(r.isBrowser)()&&void 0!==self.firebase){d.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const e=self.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&d.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const h=u;var f;Object(o.registerVersion)("@firebase/app-compat","0.2.31",f)},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1276);const i=["get","getKey","getAll","getAllKeys","count"],o=["put","add","delete","clear"],s=new Map;function a(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(s.get(t))return s.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,a=o.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!a&&!i.includes(n))return;const c=async function(e,...t){const i=this.transaction(e,a?"readwrite":"readonly");let o=i.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),a&&i.done]))[0]};return s.set(t,c),c}r.replaceTraps((e=>({...e,get:(t,n,r)=>a(t,n)||e.get(t,n,r),has:(t,n)=>!!a(t,n)||e.has(t,n)}))),t.unwrap=r.unwrap,t.wrap=r.wrap,t.deleteDB=function(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(e=>t(e.oldVersion,e))),r.wrap(n).then((()=>{}))},t.openDB=function(e,t,{blocked:n,upgrade:i,blocking:o,terminated:s}={}){const a=indexedDB.open(e,t),c=r.wrap(a);return i&&a.addEventListener("upgradeneeded",(e=>{i(r.wrap(a.result),e.oldVersion,e.newVersion,r.wrap(a.transaction),e)})),n&&a.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),c.then((e=>{s&&e.addEventListener("close",(()=>s())),o&&e.addEventListener("versionchange",(e=>o(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),c}},,function(e,t,n){var r=n(729)((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));e.exports=r},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(701);const i=e=>{for(const t of r.a){if(new RegExp(t).test(e))return!0}return!1}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=["eventbrite.com","eventbrite.co.uk","eventbrite.de","eventbrite.pt","eventbrite.fr","eventbrite.es","eventbrite.ca","eventbrite.ie","eventbrite.co.nz","ra.co","ticketmaster.","meetup.com","zoom.us","lu.ma","facebook.com/events","zoom.us/meetings/register","zoom.us/webinar"]},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(703);const i=e=>r.a.test(e)},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));const r=["x.com/","twitter.com/"],i=/(x|twitter)\.com\/.+\/status\/(\d+)$/},,function(e,t,n){"use strict";n.d(t,"a",(function(){return sa}));const r=Symbol("changed"),i=Symbol("classList"),o=Symbol("CustomElements"),s=Symbol("content"),a=Symbol("dataset"),c=Symbol("doctype"),l=Symbol("DOMParser"),u=Symbol("end"),d=Symbol("EventTarget"),h=Symbol("globals"),f=Symbol("image"),p=Symbol("mime"),g=Symbol("MutationObserver"),m=Symbol("next"),y=Symbol("ownerElement"),v=Symbol("prev"),b=Symbol("private"),_=Symbol("sheet"),w=Symbol("start"),T=Symbol("style"),E=Symbol("upgrade"),A=Symbol("value");var S,O=new Uint16Array('\u1d41<\xd5\u0131\u028a\u049d\u057b\u05d0\u0675\u06de\u07a2\u07d6\u080f\u0a4a\u0a91\u0da1\u0e6d\u0f09\u0f26\u10ca\u1228\u12e1\u1415\u149d\u14c3\u14df\u1525\0\0\0\0\0\0\u156b\u16cd\u198d\u1c12\u1ddd\u1f7e\u2060\u21b0\u228d\u23c0\u23fb\u2442\u2824\u2912\u2d08\u2e48\u2fce\u3016\u32ba\u3639\u37ac\u38fe\u3a28\u3a71\u3ae0\u3b2e\u0800EMabcfglmnoprstu\\bfms\x7f\x84\x8b\x90\x95\x98\xa6\xb3\xb9\xc8\xcflig\u803b\xc6\u40c6P\u803b&\u4026cute\u803b\xc1\u40c1reve;\u4102\u0100iyx}rc\u803b\xc2\u40c2;\u4410r;\uc000\ud835\udd04rave\u803b\xc0\u40c0pha;\u4391acr;\u4100d;\u6a53\u0100gp\x9d\xa1on;\u4104f;\uc000\ud835\udd38plyFunction;\u6061ing\u803b\xc5\u40c5\u0100cs\xbe\xc3r;\uc000\ud835\udc9cign;\u6254ilde\u803b\xc3\u40c3ml\u803b\xc4\u40c4\u0400aceforsu\xe5\xfb\xfe\u0117\u011c\u0122\u0127\u012a\u0100cr\xea\xf2kslash;\u6216\u0176\xf6\xf8;\u6ae7ed;\u6306y;\u4411\u0180crt\u0105\u010b\u0114ause;\u6235noullis;\u612ca;\u4392r;\uc000\ud835\udd05pf;\uc000\ud835\udd39eve;\u42d8c\xf2\u0113mpeq;\u624e\u0700HOacdefhilorsu\u014d\u0151\u0156\u0180\u019e\u01a2\u01b5\u01b7\u01ba\u01dc\u0215\u0273\u0278\u027ecy;\u4427PY\u803b\xa9\u40a9\u0180cpy\u015d\u0162\u017aute;\u4106\u0100;i\u0167\u0168\u62d2talDifferentialD;\u6145leys;\u612d\u0200aeio\u0189\u018e\u0194\u0198ron;\u410cdil\u803b\xc7\u40c7rc;\u4108nint;\u6230ot;\u410a\u0100dn\u01a7\u01adilla;\u40b8terDot;\u40b7\xf2\u017fi;\u43a7rcle\u0200DMPT\u01c7\u01cb\u01d1\u01d6ot;\u6299inus;\u6296lus;\u6295imes;\u6297o\u0100cs\u01e2\u01f8kwiseContourIntegral;\u6232eCurly\u0100DQ\u0203\u020foubleQuote;\u601duote;\u6019\u0200lnpu\u021e\u0228\u0247\u0255on\u0100;e\u0225\u0226\u6237;\u6a74\u0180git\u022f\u0236\u023aruent;\u6261nt;\u622fourIntegral;\u622e\u0100fr\u024c\u024e;\u6102oduct;\u6210nterClockwiseContourIntegral;\u6233oss;\u6a2fcr;\uc000\ud835\udc9ep\u0100;C\u0284\u0285\u62d3ap;\u624d\u0580DJSZacefios\u02a0\u02ac\u02b0\u02b4\u02b8\u02cb\u02d7\u02e1\u02e6\u0333\u048d\u0100;o\u0179\u02a5trahd;\u6911cy;\u4402cy;\u4405cy;\u440f\u0180grs\u02bf\u02c4\u02c7ger;\u6021r;\u61a1hv;\u6ae4\u0100ay\u02d0\u02d5ron;\u410e;\u4414l\u0100;t\u02dd\u02de\u6207a;\u4394r;\uc000\ud835\udd07\u0100af\u02eb\u0327\u0100cm\u02f0\u0322ritical\u0200ADGT\u0300\u0306\u0316\u031ccute;\u40b4o\u0174\u030b\u030d;\u42d9bleAcute;\u42ddrave;\u4060ilde;\u42dcond;\u62c4ferentialD;\u6146\u0470\u033d\0\0\0\u0342\u0354\0\u0405f;\uc000\ud835\udd3b\u0180;DE\u0348\u0349\u034d\u40a8ot;\u60dcqual;\u6250ble\u0300CDLRUV\u0363\u0372\u0382\u03cf\u03e2\u03f8ontourIntegra\xec\u0239o\u0274\u0379\0\0\u037b\xbb\u0349nArrow;\u61d3\u0100eo\u0387\u03a4ft\u0180ART\u0390\u0396\u03a1rrow;\u61d0ightArrow;\u61d4e\xe5\u02cang\u0100LR\u03ab\u03c4eft\u0100AR\u03b3\u03b9rrow;\u67f8ightArrow;\u67faightArrow;\u67f9ight\u0100AT\u03d8\u03derrow;\u61d2ee;\u62a8p\u0241\u03e9\0\0\u03efrrow;\u61d1ownArrow;\u61d5erticalBar;\u6225n\u0300ABLRTa\u0412\u042a\u0430\u045e\u047f\u037crrow\u0180;BU\u041d\u041e\u0422\u6193ar;\u6913pArrow;\u61f5reve;\u4311eft\u02d2\u043a\0\u0446\0\u0450ightVector;\u6950eeVector;\u695eector\u0100;B\u0459\u045a\u61bdar;\u6956ight\u01d4\u0467\0\u0471eeVector;\u695fector\u0100;B\u047a\u047b\u61c1ar;\u6957ee\u0100;A\u0486\u0487\u62a4rrow;\u61a7\u0100ct\u0492\u0497r;\uc000\ud835\udc9frok;\u4110\u0800NTacdfglmopqstux\u04bd\u04c0\u04c4\u04cb\u04de\u04e2\u04e7\u04ee\u04f5\u0521\u052f\u0536\u0552\u055d\u0560\u0565G;\u414aH\u803b\xd0\u40d0cute\u803b\xc9\u40c9\u0180aiy\u04d2\u04d7\u04dcron;\u411arc\u803b\xca\u40ca;\u442dot;\u4116r;\uc000\ud835\udd08rave\u803b\xc8\u40c8ement;\u6208\u0100ap\u04fa\u04fecr;\u4112ty\u0253\u0506\0\0\u0512mallSquare;\u65fberySmallSquare;\u65ab\u0100gp\u0526\u052aon;\u4118f;\uc000\ud835\udd3csilon;\u4395u\u0100ai\u053c\u0549l\u0100;T\u0542\u0543\u6a75ilde;\u6242librium;\u61cc\u0100ci\u0557\u055ar;\u6130m;\u6a73a;\u4397ml\u803b\xcb\u40cb\u0100ip\u056a\u056fsts;\u6203onentialE;\u6147\u0280cfios\u0585\u0588\u058d\u05b2\u05ccy;\u4424r;\uc000\ud835\udd09lled\u0253\u0597\0\0\u05a3mallSquare;\u65fcerySmallSquare;\u65aa\u0370\u05ba\0\u05bf\0\0\u05c4f;\uc000\ud835\udd3dAll;\u6200riertrf;\u6131c\xf2\u05cb\u0600JTabcdfgorst\u05e8\u05ec\u05ef\u05fa\u0600\u0612\u0616\u061b\u061d\u0623\u066c\u0672cy;\u4403\u803b>\u403emma\u0100;d\u05f7\u05f8\u4393;\u43dcreve;\u411e\u0180eiy\u0607\u060c\u0610dil;\u4122rc;\u411c;\u4413ot;\u4120r;\uc000\ud835\udd0a;\u62d9pf;\uc000\ud835\udd3eeater\u0300EFGLST\u0635\u0644\u064e\u0656\u065b\u0666qual\u0100;L\u063e\u063f\u6265ess;\u62dbullEqual;\u6267reater;\u6aa2ess;\u6277lantEqual;\u6a7eilde;\u6273cr;\uc000\ud835\udca2;\u626b\u0400Aacfiosu\u0685\u068b\u0696\u069b\u069e\u06aa\u06be\u06caRDcy;\u442a\u0100ct\u0690\u0694ek;\u42c7;\u405eirc;\u4124r;\u610clbertSpace;\u610b\u01f0\u06af\0\u06b2f;\u610dizontalLine;\u6500\u0100ct\u06c3\u06c5\xf2\u06a9rok;\u4126mp\u0144\u06d0\u06d8ownHum\xf0\u012fqual;\u624f\u0700EJOacdfgmnostu\u06fa\u06fe\u0703\u0707\u070e\u071a\u071e\u0721\u0728\u0744\u0778\u078b\u078f\u0795cy;\u4415lig;\u4132cy;\u4401cute\u803b\xcd\u40cd\u0100iy\u0713\u0718rc\u803b\xce\u40ce;\u4418ot;\u4130r;\u6111rave\u803b\xcc\u40cc\u0180;ap\u0720\u072f\u073f\u0100cg\u0734\u0737r;\u412ainaryI;\u6148lie\xf3\u03dd\u01f4\u0749\0\u0762\u0100;e\u074d\u074e\u622c\u0100gr\u0753\u0758ral;\u622bsection;\u62c2isible\u0100CT\u076c\u0772omma;\u6063imes;\u6062\u0180gpt\u077f\u0783\u0788on;\u412ef;\uc000\ud835\udd40a;\u4399cr;\u6110ilde;\u4128\u01eb\u079a\0\u079ecy;\u4406l\u803b\xcf\u40cf\u0280cfosu\u07ac\u07b7\u07bc\u07c2\u07d0\u0100iy\u07b1\u07b5rc;\u4134;\u4419r;\uc000\ud835\udd0dpf;\uc000\ud835\udd41\u01e3\u07c7\0\u07ccr;\uc000\ud835\udca5rcy;\u4408kcy;\u4404\u0380HJacfos\u07e4\u07e8\u07ec\u07f1\u07fd\u0802\u0808cy;\u4425cy;\u440cppa;\u439a\u0100ey\u07f6\u07fbdil;\u4136;\u441ar;\uc000\ud835\udd0epf;\uc000\ud835\udd42cr;\uc000\ud835\udca6\u0580JTaceflmost\u0825\u0829\u082c\u0850\u0863\u09b3\u09b8\u09c7\u09cd\u0a37\u0a47cy;\u4409\u803b<\u403c\u0280cmnpr\u0837\u083c\u0841\u0844\u084dute;\u4139bda;\u439bg;\u67ealacetrf;\u6112r;\u619e\u0180aey\u0857\u085c\u0861ron;\u413ddil;\u413b;\u441b\u0100fs\u0868\u0970t\u0500ACDFRTUVar\u087e\u08a9\u08b1\u08e0\u08e6\u08fc\u092f\u095b\u0390\u096a\u0100nr\u0883\u088fgleBracket;\u67e8row\u0180;BR\u0899\u089a\u089e\u6190ar;\u61e4ightArrow;\u61c6eiling;\u6308o\u01f5\u08b7\0\u08c3bleBracket;\u67e6n\u01d4\u08c8\0\u08d2eeVector;\u6961ector\u0100;B\u08db\u08dc\u61c3ar;\u6959loor;\u630aight\u0100AV\u08ef\u08f5rrow;\u6194ector;\u694e\u0100er\u0901\u0917e\u0180;AV\u0909\u090a\u0910\u62a3rrow;\u61a4ector;\u695aiangle\u0180;BE\u0924\u0925\u0929\u62b2ar;\u69cfqual;\u62b4p\u0180DTV\u0937\u0942\u094cownVector;\u6951eeVector;\u6960ector\u0100;B\u0956\u0957\u61bfar;\u6958ector\u0100;B\u0965\u0966\u61bcar;\u6952ight\xe1\u039cs\u0300EFGLST\u097e\u098b\u0995\u099d\u09a2\u09adqualGreater;\u62daullEqual;\u6266reater;\u6276ess;\u6aa1lantEqual;\u6a7dilde;\u6272r;\uc000\ud835\udd0f\u0100;e\u09bd\u09be\u62d8ftarrow;\u61daidot;\u413f\u0180npw\u09d4\u0a16\u0a1bg\u0200LRlr\u09de\u09f7\u0a02\u0a10eft\u0100AR\u09e6\u09ecrrow;\u67f5ightArrow;\u67f7ightArrow;\u67f6eft\u0100ar\u03b3\u0a0aight\xe1\u03bfight\xe1\u03caf;\uc000\ud835\udd43er\u0100LR\u0a22\u0a2ceftArrow;\u6199ightArrow;\u6198\u0180cht\u0a3e\u0a40\u0a42\xf2\u084c;\u61b0rok;\u4141;\u626a\u0400acefiosu\u0a5a\u0a5d\u0a60\u0a77\u0a7c\u0a85\u0a8b\u0a8ep;\u6905y;\u441c\u0100dl\u0a65\u0a6fiumSpace;\u605flintrf;\u6133r;\uc000\ud835\udd10nusPlus;\u6213pf;\uc000\ud835\udd44c\xf2\u0a76;\u439c\u0480Jacefostu\u0aa3\u0aa7\u0aad\u0ac0\u0b14\u0b19\u0d91\u0d97\u0d9ecy;\u440acute;\u4143\u0180aey\u0ab4\u0ab9\u0aberon;\u4147dil;\u4145;\u441d\u0180gsw\u0ac7\u0af0\u0b0eative\u0180MTV\u0ad3\u0adf\u0ae8ediumSpace;\u600bhi\u0100cn\u0ae6\u0ad8\xeb\u0ad9eryThi\xee\u0ad9ted\u0100GL\u0af8\u0b06reaterGreate\xf2\u0673essLes\xf3\u0a48Line;\u400ar;\uc000\ud835\udd11\u0200Bnpt\u0b22\u0b28\u0b37\u0b3areak;\u6060BreakingSpace;\u40a0f;\u6115\u0680;CDEGHLNPRSTV\u0b55\u0b56\u0b6a\u0b7c\u0ba1\u0beb\u0c04\u0c5e\u0c84\u0ca6\u0cd8\u0d61\u0d85\u6aec\u0100ou\u0b5b\u0b64ngruent;\u6262pCap;\u626doubleVerticalBar;\u6226\u0180lqx\u0b83\u0b8a\u0b9bement;\u6209ual\u0100;T\u0b92\u0b93\u6260ilde;\uc000\u2242\u0338ists;\u6204reater\u0380;EFGLST\u0bb6\u0bb7\u0bbd\u0bc9\u0bd3\u0bd8\u0be5\u626fqual;\u6271ullEqual;\uc000\u2267\u0338reater;\uc000\u226b\u0338ess;\u6279lantEqual;\uc000\u2a7e\u0338ilde;\u6275ump\u0144\u0bf2\u0bfdownHump;\uc000\u224e\u0338qual;\uc000\u224f\u0338e\u0100fs\u0c0a\u0c27tTriangle\u0180;BE\u0c1a\u0c1b\u0c21\u62eaar;\uc000\u29cf\u0338qual;\u62ecs\u0300;EGLST\u0c35\u0c36\u0c3c\u0c44\u0c4b\u0c58\u626equal;\u6270reater;\u6278ess;\uc000\u226a\u0338lantEqual;\uc000\u2a7d\u0338ilde;\u6274ested\u0100GL\u0c68\u0c79reaterGreater;\uc000\u2aa2\u0338essLess;\uc000\u2aa1\u0338recedes\u0180;ES\u0c92\u0c93\u0c9b\u6280qual;\uc000\u2aaf\u0338lantEqual;\u62e0\u0100ei\u0cab\u0cb9verseElement;\u620cghtTriangle\u0180;BE\u0ccb\u0ccc\u0cd2\u62ebar;\uc000\u29d0\u0338qual;\u62ed\u0100qu\u0cdd\u0d0cuareSu\u0100bp\u0ce8\u0cf9set\u0100;E\u0cf0\u0cf3\uc000\u228f\u0338qual;\u62e2erset\u0100;E\u0d03\u0d06\uc000\u2290\u0338qual;\u62e3\u0180bcp\u0d13\u0d24\u0d4eset\u0100;E\u0d1b\u0d1e\uc000\u2282\u20d2qual;\u6288ceeds\u0200;EST\u0d32\u0d33\u0d3b\u0d46\u6281qual;\uc000\u2ab0\u0338lantEqual;\u62e1ilde;\uc000\u227f\u0338erset\u0100;E\u0d58\u0d5b\uc000\u2283\u20d2qual;\u6289ilde\u0200;EFT\u0d6e\u0d6f\u0d75\u0d7f\u6241qual;\u6244ullEqual;\u6247ilde;\u6249erticalBar;\u6224cr;\uc000\ud835\udca9ilde\u803b\xd1\u40d1;\u439d\u0700Eacdfgmoprstuv\u0dbd\u0dc2\u0dc9\u0dd5\u0ddb\u0de0\u0de7\u0dfc\u0e02\u0e20\u0e22\u0e32\u0e3f\u0e44lig;\u4152cute\u803b\xd3\u40d3\u0100iy\u0dce\u0dd3rc\u803b\xd4\u40d4;\u441eblac;\u4150r;\uc000\ud835\udd12rave\u803b\xd2\u40d2\u0180aei\u0dee\u0df2\u0df6cr;\u414cga;\u43a9cron;\u439fpf;\uc000\ud835\udd46enCurly\u0100DQ\u0e0e\u0e1aoubleQuote;\u601cuote;\u6018;\u6a54\u0100cl\u0e27\u0e2cr;\uc000\ud835\udcaaash\u803b\xd8\u40d8i\u016c\u0e37\u0e3cde\u803b\xd5\u40d5es;\u6a37ml\u803b\xd6\u40d6er\u0100BP\u0e4b\u0e60\u0100ar\u0e50\u0e53r;\u603eac\u0100ek\u0e5a\u0e5c;\u63deet;\u63b4arenthesis;\u63dc\u0480acfhilors\u0e7f\u0e87\u0e8a\u0e8f\u0e92\u0e94\u0e9d\u0eb0\u0efcrtialD;\u6202y;\u441fr;\uc000\ud835\udd13i;\u43a6;\u43a0usMinus;\u40b1\u0100ip\u0ea2\u0eadncareplan\xe5\u069df;\u6119\u0200;eio\u0eb9\u0eba\u0ee0\u0ee4\u6abbcedes\u0200;EST\u0ec8\u0ec9\u0ecf\u0eda\u627aqual;\u6aaflantEqual;\u627cilde;\u627eme;\u6033\u0100dp\u0ee9\u0eeeuct;\u620fortion\u0100;a\u0225\u0ef9l;\u621d\u0100ci\u0f01\u0f06r;\uc000\ud835\udcab;\u43a8\u0200Ufos\u0f11\u0f16\u0f1b\u0f1fOT\u803b"\u4022r;\uc000\ud835\udd14pf;\u611acr;\uc000\ud835\udcac\u0600BEacefhiorsu\u0f3e\u0f43\u0f47\u0f60\u0f73\u0fa7\u0faa\u0fad\u1096\u10a9\u10b4\u10bearr;\u6910G\u803b\xae\u40ae\u0180cnr\u0f4e\u0f53\u0f56ute;\u4154g;\u67ebr\u0100;t\u0f5c\u0f5d\u61a0l;\u6916\u0180aey\u0f67\u0f6c\u0f71ron;\u4158dil;\u4156;\u4420\u0100;v\u0f78\u0f79\u611cerse\u0100EU\u0f82\u0f99\u0100lq\u0f87\u0f8eement;\u620builibrium;\u61cbpEquilibrium;\u696fr\xbb\u0f79o;\u43a1ght\u0400ACDFTUVa\u0fc1\u0feb\u0ff3\u1022\u1028\u105b\u1087\u03d8\u0100nr\u0fc6\u0fd2gleBracket;\u67e9row\u0180;BL\u0fdc\u0fdd\u0fe1\u6192ar;\u61e5eftArrow;\u61c4eiling;\u6309o\u01f5\u0ff9\0\u1005bleBracket;\u67e7n\u01d4\u100a\0\u1014eeVector;\u695dector\u0100;B\u101d\u101e\u61c2ar;\u6955loor;\u630b\u0100er\u102d\u1043e\u0180;AV\u1035\u1036\u103c\u62a2rrow;\u61a6ector;\u695biangle\u0180;BE\u1050\u1051\u1055\u62b3ar;\u69d0qual;\u62b5p\u0180DTV\u1063\u106e\u1078ownVector;\u694feeVector;\u695cector\u0100;B\u1082\u1083\u61bear;\u6954ector\u0100;B\u1091\u1092\u61c0ar;\u6953\u0100pu\u109b\u109ef;\u611dndImplies;\u6970ightarrow;\u61db\u0100ch\u10b9\u10bcr;\u611b;\u61b1leDelayed;\u69f4\u0680HOacfhimoqstu\u10e4\u10f1\u10f7\u10fd\u1119\u111e\u1151\u1156\u1161\u1167\u11b5\u11bb\u11bf\u0100Cc\u10e9\u10eeHcy;\u4429y;\u4428FTcy;\u442ccute;\u415a\u0280;aeiy\u1108\u1109\u110e\u1113\u1117\u6abcron;\u4160dil;\u415erc;\u415c;\u4421r;\uc000\ud835\udd16ort\u0200DLRU\u112a\u1134\u113e\u1149ownArrow\xbb\u041eeftArrow\xbb\u089aightArrow\xbb\u0fddpArrow;\u6191gma;\u43a3allCircle;\u6218pf;\uc000\ud835\udd4a\u0272\u116d\0\0\u1170t;\u621aare\u0200;ISU\u117b\u117c\u1189\u11af\u65a1ntersection;\u6293u\u0100bp\u118f\u119eset\u0100;E\u1197\u1198\u628fqual;\u6291erset\u0100;E\u11a8\u11a9\u6290qual;\u6292nion;\u6294cr;\uc000\ud835\udcaear;\u62c6\u0200bcmp\u11c8\u11db\u1209\u120b\u0100;s\u11cd\u11ce\u62d0et\u0100;E\u11cd\u11d5qual;\u6286\u0100ch\u11e0\u1205eeds\u0200;EST\u11ed\u11ee\u11f4\u11ff\u627bqual;\u6ab0lantEqual;\u627dilde;\u627fTh\xe1\u0f8c;\u6211\u0180;es\u1212\u1213\u1223\u62d1rset\u0100;E\u121c\u121d\u6283qual;\u6287et\xbb\u1213\u0580HRSacfhiors\u123e\u1244\u1249\u1255\u125e\u1271\u1276\u129f\u12c2\u12c8\u12d1ORN\u803b\xde\u40deADE;\u6122\u0100Hc\u124e\u1252cy;\u440by;\u4426\u0100bu\u125a\u125c;\u4009;\u43a4\u0180aey\u1265\u126a\u126fron;\u4164dil;\u4162;\u4422r;\uc000\ud835\udd17\u0100ei\u127b\u1289\u01f2\u1280\0\u1287efore;\u6234a;\u4398\u0100cn\u128e\u1298kSpace;\uc000\u205f\u200aSpace;\u6009lde\u0200;EFT\u12ab\u12ac\u12b2\u12bc\u623cqual;\u6243ullEqual;\u6245ilde;\u6248pf;\uc000\ud835\udd4bipleDot;\u60db\u0100ct\u12d6\u12dbr;\uc000\ud835\udcafrok;\u4166\u0ae1\u12f7\u130e\u131a\u1326\0\u132c\u1331\0\0\0\0\0\u1338\u133d\u1377\u1385\0\u13ff\u1404\u140a\u1410\u0100cr\u12fb\u1301ute\u803b\xda\u40dar\u0100;o\u1307\u1308\u619fcir;\u6949r\u01e3\u1313\0\u1316y;\u440eve;\u416c\u0100iy\u131e\u1323rc\u803b\xdb\u40db;\u4423blac;\u4170r;\uc000\ud835\udd18rave\u803b\xd9\u40d9acr;\u416a\u0100di\u1341\u1369er\u0100BP\u1348\u135d\u0100ar\u134d\u1350r;\u405fac\u0100ek\u1357\u1359;\u63dfet;\u63b5arenthesis;\u63ddon\u0100;P\u1370\u1371\u62c3lus;\u628e\u0100gp\u137b\u137fon;\u4172f;\uc000\ud835\udd4c\u0400ADETadps\u1395\u13ae\u13b8\u13c4\u03e8\u13d2\u13d7\u13f3rrow\u0180;BD\u1150\u13a0\u13a4ar;\u6912ownArrow;\u61c5ownArrow;\u6195quilibrium;\u696eee\u0100;A\u13cb\u13cc\u62a5rrow;\u61a5own\xe1\u03f3er\u0100LR\u13de\u13e8eftArrow;\u6196ightArrow;\u6197i\u0100;l\u13f9\u13fa\u43d2on;\u43a5ing;\u416ecr;\uc000\ud835\udcb0ilde;\u4168ml\u803b\xdc\u40dc\u0480Dbcdefosv\u1427\u142c\u1430\u1433\u143e\u1485\u148a\u1490\u1496ash;\u62abar;\u6aeby;\u4412ash\u0100;l\u143b\u143c\u62a9;\u6ae6\u0100er\u1443\u1445;\u62c1\u0180bty\u144c\u1450\u147aar;\u6016\u0100;i\u144f\u1455cal\u0200BLST\u1461\u1465\u146a\u1474ar;\u6223ine;\u407ceparator;\u6758ilde;\u6240ThinSpace;\u600ar;\uc000\ud835\udd19pf;\uc000\ud835\udd4dcr;\uc000\ud835\udcb1dash;\u62aa\u0280cefos\u14a7\u14ac\u14b1\u14b6\u14bcirc;\u4174dge;\u62c0r;\uc000\ud835\udd1apf;\uc000\ud835\udd4ecr;\uc000\ud835\udcb2\u0200fios\u14cb\u14d0\u14d2\u14d8r;\uc000\ud835\udd1b;\u439epf;\uc000\ud835\udd4fcr;\uc000\ud835\udcb3\u0480AIUacfosu\u14f1\u14f5\u14f9\u14fd\u1504\u150f\u1514\u151a\u1520cy;\u442fcy;\u4407cy;\u442ecute\u803b\xdd\u40dd\u0100iy\u1509\u150drc;\u4176;\u442br;\uc000\ud835\udd1cpf;\uc000\ud835\udd50cr;\uc000\ud835\udcb4ml;\u4178\u0400Hacdefos\u1535\u1539\u153f\u154b\u154f\u155d\u1560\u1564cy;\u4416cute;\u4179\u0100ay\u1544\u1549ron;\u417d;\u4417ot;\u417b\u01f2\u1554\0\u155boWidt\xe8\u0ad9a;\u4396r;\u6128pf;\u6124cr;\uc000\ud835\udcb5\u0be1\u1583\u158a\u1590\0\u15b0\u15b6\u15bf\0\0\0\0\u15c6\u15db\u15eb\u165f\u166d\0\u1695\u169b\u16b2\u16b9\0\u16becute\u803b\xe1\u40e1reve;\u4103\u0300;Ediuy\u159c\u159d\u15a1\u15a3\u15a8\u15ad\u623e;\uc000\u223e\u0333;\u623frc\u803b\xe2\u40e2te\u80bb\xb4\u0306;\u4430lig\u803b\xe6\u40e6\u0100;r\xb2\u15ba;\uc000\ud835\udd1erave\u803b\xe0\u40e0\u0100ep\u15ca\u15d6\u0100fp\u15cf\u15d4sym;\u6135\xe8\u15d3ha;\u43b1\u0100ap\u15dfc\u0100cl\u15e4\u15e7r;\u4101g;\u6a3f\u0264\u15f0\0\0\u160a\u0280;adsv\u15fa\u15fb\u15ff\u1601\u1607\u6227nd;\u6a55;\u6a5clope;\u6a58;\u6a5a\u0380;elmrsz\u1618\u1619\u161b\u161e\u163f\u164f\u1659\u6220;\u69a4e\xbb\u1619sd\u0100;a\u1625\u1626\u6221\u0461\u1630\u1632\u1634\u1636\u1638\u163a\u163c\u163e;\u69a8;\u69a9;\u69aa;\u69ab;\u69ac;\u69ad;\u69ae;\u69aft\u0100;v\u1645\u1646\u621fb\u0100;d\u164c\u164d\u62be;\u699d\u0100pt\u1654\u1657h;\u6222\xbb\xb9arr;\u637c\u0100gp\u1663\u1667on;\u4105f;\uc000\ud835\udd52\u0380;Eaeiop\u12c1\u167b\u167d\u1682\u1684\u1687\u168a;\u6a70cir;\u6a6f;\u624ad;\u624bs;\u4027rox\u0100;e\u12c1\u1692\xf1\u1683ing\u803b\xe5\u40e5\u0180cty\u16a1\u16a6\u16a8r;\uc000\ud835\udcb6;\u402amp\u0100;e\u12c1\u16af\xf1\u0288ilde\u803b\xe3\u40e3ml\u803b\xe4\u40e4\u0100ci\u16c2\u16c8onin\xf4\u0272nt;\u6a11\u0800Nabcdefiklnoprsu\u16ed\u16f1\u1730\u173c\u1743\u1748\u1778\u177d\u17e0\u17e6\u1839\u1850\u170d\u193d\u1948\u1970ot;\u6aed\u0100cr\u16f6\u171ek\u0200ceps\u1700\u1705\u170d\u1713ong;\u624cpsilon;\u43f6rime;\u6035im\u0100;e\u171a\u171b\u623dq;\u62cd\u0176\u1722\u1726ee;\u62bded\u0100;g\u172c\u172d\u6305e\xbb\u172drk\u0100;t\u135c\u1737brk;\u63b6\u0100oy\u1701\u1741;\u4431quo;\u601e\u0280cmprt\u1753\u175b\u1761\u1764\u1768aus\u0100;e\u010a\u0109ptyv;\u69b0s\xe9\u170cno\xf5\u0113\u0180ahw\u176f\u1771\u1773;\u43b2;\u6136een;\u626cr;\uc000\ud835\udd1fg\u0380costuvw\u178d\u179d\u17b3\u17c1\u17d5\u17db\u17de\u0180aiu\u1794\u1796\u179a\xf0\u0760rc;\u65efp\xbb\u1371\u0180dpt\u17a4\u17a8\u17adot;\u6a00lus;\u6a01imes;\u6a02\u0271\u17b9\0\0\u17becup;\u6a06ar;\u6605riangle\u0100du\u17cd\u17d2own;\u65bdp;\u65b3plus;\u6a04e\xe5\u1444\xe5\u14adarow;\u690d\u0180ako\u17ed\u1826\u1835\u0100cn\u17f2\u1823k\u0180lst\u17fa\u05ab\u1802ozenge;\u69ebriangle\u0200;dlr\u1812\u1813\u1818\u181d\u65b4own;\u65beeft;\u65c2ight;\u65b8k;\u6423\u01b1\u182b\0\u1833\u01b2\u182f\0\u1831;\u6592;\u65914;\u6593ck;\u6588\u0100eo\u183e\u184d\u0100;q\u1843\u1846\uc000=\u20e5uiv;\uc000\u2261\u20e5t;\u6310\u0200ptwx\u1859\u185e\u1867\u186cf;\uc000\ud835\udd53\u0100;t\u13cb\u1863om\xbb\u13cctie;\u62c8\u0600DHUVbdhmptuv\u1885\u1896\u18aa\u18bb\u18d7\u18db\u18ec\u18ff\u1905\u190a\u1910\u1921\u0200LRlr\u188e\u1890\u1892\u1894;\u6557;\u6554;\u6556;\u6553\u0280;DUdu\u18a1\u18a2\u18a4\u18a6\u18a8\u6550;\u6566;\u6569;\u6564;\u6567\u0200LRlr\u18b3\u18b5\u18b7\u18b9;\u655d;\u655a;\u655c;\u6559\u0380;HLRhlr\u18ca\u18cb\u18cd\u18cf\u18d1\u18d3\u18d5\u6551;\u656c;\u6563;\u6560;\u656b;\u6562;\u655fox;\u69c9\u0200LRlr\u18e4\u18e6\u18e8\u18ea;\u6555;\u6552;\u6510;\u650c\u0280;DUdu\u06bd\u18f7\u18f9\u18fb\u18fd;\u6565;\u6568;\u652c;\u6534inus;\u629flus;\u629eimes;\u62a0\u0200LRlr\u1919\u191b\u191d\u191f;\u655b;\u6558;\u6518;\u6514\u0380;HLRhlr\u1930\u1931\u1933\u1935\u1937\u1939\u193b\u6502;\u656a;\u6561;\u655e;\u653c;\u6524;\u651c\u0100ev\u0123\u1942bar\u803b\xa6\u40a6\u0200ceio\u1951\u1956\u195a\u1960r;\uc000\ud835\udcb7mi;\u604fm\u0100;e\u171a\u171cl\u0180;bh\u1968\u1969\u196b\u405c;\u69c5sub;\u67c8\u016c\u1974\u197el\u0100;e\u1979\u197a\u6022t\xbb\u197ap\u0180;Ee\u012f\u1985\u1987;\u6aae\u0100;q\u06dc\u06db\u0ce1\u19a7\0\u19e8\u1a11\u1a15\u1a32\0\u1a37\u1a50\0\0\u1ab4\0\0\u1ac1\0\0\u1b21\u1b2e\u1b4d\u1b52\0\u1bfd\0\u1c0c\u0180cpr\u19ad\u19b2\u19ddute;\u4107\u0300;abcds\u19bf\u19c0\u19c4\u19ca\u19d5\u19d9\u6229nd;\u6a44rcup;\u6a49\u0100au\u19cf\u19d2p;\u6a4bp;\u6a47ot;\u6a40;\uc000\u2229\ufe00\u0100eo\u19e2\u19e5t;\u6041\xee\u0693\u0200aeiu\u19f0\u19fb\u1a01\u1a05\u01f0\u19f5\0\u19f8s;\u6a4don;\u410ddil\u803b\xe7\u40e7rc;\u4109ps\u0100;s\u1a0c\u1a0d\u6a4cm;\u6a50ot;\u410b\u0180dmn\u1a1b\u1a20\u1a26il\u80bb\xb8\u01adptyv;\u69b2t\u8100\xa2;e\u1a2d\u1a2e\u40a2r\xe4\u01b2r;\uc000\ud835\udd20\u0180cei\u1a3d\u1a40\u1a4dy;\u4447ck\u0100;m\u1a47\u1a48\u6713ark\xbb\u1a48;\u43c7r\u0380;Ecefms\u1a5f\u1a60\u1a62\u1a6b\u1aa4\u1aaa\u1aae\u65cb;\u69c3\u0180;el\u1a69\u1a6a\u1a6d\u42c6q;\u6257e\u0261\u1a74\0\0\u1a88rrow\u0100lr\u1a7c\u1a81eft;\u61baight;\u61bb\u0280RSacd\u1a92\u1a94\u1a96\u1a9a\u1a9f\xbb\u0f47;\u64c8st;\u629birc;\u629aash;\u629dnint;\u6a10id;\u6aefcir;\u69c2ubs\u0100;u\u1abb\u1abc\u6663it\xbb\u1abc\u02ec\u1ac7\u1ad4\u1afa\0\u1b0aon\u0100;e\u1acd\u1ace\u403a\u0100;q\xc7\xc6\u026d\u1ad9\0\0\u1ae2a\u0100;t\u1ade\u1adf\u402c;\u4040\u0180;fl\u1ae8\u1ae9\u1aeb\u6201\xee\u1160e\u0100mx\u1af1\u1af6ent\xbb\u1ae9e\xf3\u024d\u01e7\u1afe\0\u1b07\u0100;d\u12bb\u1b02ot;\u6a6dn\xf4\u0246\u0180fry\u1b10\u1b14\u1b17;\uc000\ud835\udd54o\xe4\u0254\u8100\xa9;s\u0155\u1b1dr;\u6117\u0100ao\u1b25\u1b29rr;\u61b5ss;\u6717\u0100cu\u1b32\u1b37r;\uc000\ud835\udcb8\u0100bp\u1b3c\u1b44\u0100;e\u1b41\u1b42\u6acf;\u6ad1\u0100;e\u1b49\u1b4a\u6ad0;\u6ad2dot;\u62ef\u0380delprvw\u1b60\u1b6c\u1b77\u1b82\u1bac\u1bd4\u1bf9arr\u0100lr\u1b68\u1b6a;\u6938;\u6935\u0270\u1b72\0\0\u1b75r;\u62dec;\u62dfarr\u0100;p\u1b7f\u1b80\u61b6;\u693d\u0300;bcdos\u1b8f\u1b90\u1b96\u1ba1\u1ba5\u1ba8\u622arcap;\u6a48\u0100au\u1b9b\u1b9ep;\u6a46p;\u6a4aot;\u628dr;\u6a45;\uc000\u222a\ufe00\u0200alrv\u1bb5\u1bbf\u1bde\u1be3rr\u0100;m\u1bbc\u1bbd\u61b7;\u693cy\u0180evw\u1bc7\u1bd4\u1bd8q\u0270\u1bce\0\0\u1bd2re\xe3\u1b73u\xe3\u1b75ee;\u62ceedge;\u62cfen\u803b\xa4\u40a4earrow\u0100lr\u1bee\u1bf3eft\xbb\u1b80ight\xbb\u1bbde\xe4\u1bdd\u0100ci\u1c01\u1c07onin\xf4\u01f7nt;\u6231lcty;\u632d\u0980AHabcdefhijlorstuwz\u1c38\u1c3b\u1c3f\u1c5d\u1c69\u1c75\u1c8a\u1c9e\u1cac\u1cb7\u1cfb\u1cff\u1d0d\u1d7b\u1d91\u1dab\u1dbb\u1dc6\u1dcdr\xf2\u0381ar;\u6965\u0200glrs\u1c48\u1c4d\u1c52\u1c54ger;\u6020eth;\u6138\xf2\u1133h\u0100;v\u1c5a\u1c5b\u6010\xbb\u090a\u016b\u1c61\u1c67arow;\u690fa\xe3\u0315\u0100ay\u1c6e\u1c73ron;\u410f;\u4434\u0180;ao\u0332\u1c7c\u1c84\u0100gr\u02bf\u1c81r;\u61catseq;\u6a77\u0180glm\u1c91\u1c94\u1c98\u803b\xb0\u40b0ta;\u43b4ptyv;\u69b1\u0100ir\u1ca3\u1ca8sht;\u697f;\uc000\ud835\udd21ar\u0100lr\u1cb3\u1cb5\xbb\u08dc\xbb\u101e\u0280aegsv\u1cc2\u0378\u1cd6\u1cdc\u1ce0m\u0180;os\u0326\u1cca\u1cd4nd\u0100;s\u0326\u1cd1uit;\u6666amma;\u43ddin;\u62f2\u0180;io\u1ce7\u1ce8\u1cf8\u40f7de\u8100\xf7;o\u1ce7\u1cf0ntimes;\u62c7n\xf8\u1cf7cy;\u4452c\u026f\u1d06\0\0\u1d0arn;\u631eop;\u630d\u0280lptuw\u1d18\u1d1d\u1d22\u1d49\u1d55lar;\u4024f;\uc000\ud835\udd55\u0280;emps\u030b\u1d2d\u1d37\u1d3d\u1d42q\u0100;d\u0352\u1d33ot;\u6251inus;\u6238lus;\u6214quare;\u62a1blebarwedg\xe5\xfan\u0180adh\u112e\u1d5d\u1d67ownarrow\xf3\u1c83arpoon\u0100lr\u1d72\u1d76ef\xf4\u1cb4igh\xf4\u1cb6\u0162\u1d7f\u1d85karo\xf7\u0f42\u026f\u1d8a\0\0\u1d8ern;\u631fop;\u630c\u0180cot\u1d98\u1da3\u1da6\u0100ry\u1d9d\u1da1;\uc000\ud835\udcb9;\u4455l;\u69f6rok;\u4111\u0100dr\u1db0\u1db4ot;\u62f1i\u0100;f\u1dba\u1816\u65bf\u0100ah\u1dc0\u1dc3r\xf2\u0429a\xf2\u0fa6angle;\u69a6\u0100ci\u1dd2\u1dd5y;\u445fgrarr;\u67ff\u0900Dacdefglmnopqrstux\u1e01\u1e09\u1e19\u1e38\u0578\u1e3c\u1e49\u1e61\u1e7e\u1ea5\u1eaf\u1ebd\u1ee1\u1f2a\u1f37\u1f44\u1f4e\u1f5a\u0100Do\u1e06\u1d34o\xf4\u1c89\u0100cs\u1e0e\u1e14ute\u803b\xe9\u40e9ter;\u6a6e\u0200aioy\u1e22\u1e27\u1e31\u1e36ron;\u411br\u0100;c\u1e2d\u1e2e\u6256\u803b\xea\u40ealon;\u6255;\u444dot;\u4117\u0100Dr\u1e41\u1e45ot;\u6252;\uc000\ud835\udd22\u0180;rs\u1e50\u1e51\u1e57\u6a9aave\u803b\xe8\u40e8\u0100;d\u1e5c\u1e5d\u6a96ot;\u6a98\u0200;ils\u1e6a\u1e6b\u1e72\u1e74\u6a99nters;\u63e7;\u6113\u0100;d\u1e79\u1e7a\u6a95ot;\u6a97\u0180aps\u1e85\u1e89\u1e97cr;\u4113ty\u0180;sv\u1e92\u1e93\u1e95\u6205et\xbb\u1e93p\u01001;\u1e9d\u1ea4\u0133\u1ea1\u1ea3;\u6004;\u6005\u6003\u0100gs\u1eaa\u1eac;\u414bp;\u6002\u0100gp\u1eb4\u1eb8on;\u4119f;\uc000\ud835\udd56\u0180als\u1ec4\u1ece\u1ed2r\u0100;s\u1eca\u1ecb\u62d5l;\u69e3us;\u6a71i\u0180;lv\u1eda\u1edb\u1edf\u43b5on\xbb\u1edb;\u43f5\u0200csuv\u1eea\u1ef3\u1f0b\u1f23\u0100io\u1eef\u1e31rc\xbb\u1e2e\u0269\u1ef9\0\0\u1efb\xed\u0548ant\u0100gl\u1f02\u1f06tr\xbb\u1e5dess\xbb\u1e7a\u0180aei\u1f12\u1f16\u1f1als;\u403dst;\u625fv\u0100;D\u0235\u1f20D;\u6a78parsl;\u69e5\u0100Da\u1f2f\u1f33ot;\u6253rr;\u6971\u0180cdi\u1f3e\u1f41\u1ef8r;\u612fo\xf4\u0352\u0100ah\u1f49\u1f4b;\u43b7\u803b\xf0\u40f0\u0100mr\u1f53\u1f57l\u803b\xeb\u40ebo;\u60ac\u0180cip\u1f61\u1f64\u1f67l;\u4021s\xf4\u056e\u0100eo\u1f6c\u1f74ctatio\xee\u0559nential\xe5\u0579\u09e1\u1f92\0\u1f9e\0\u1fa1\u1fa7\0\0\u1fc6\u1fcc\0\u1fd3\0\u1fe6\u1fea\u2000\0\u2008\u205allingdotse\xf1\u1e44y;\u4444male;\u6640\u0180ilr\u1fad\u1fb3\u1fc1lig;\u8000\ufb03\u0269\u1fb9\0\0\u1fbdg;\u8000\ufb00ig;\u8000\ufb04;\uc000\ud835\udd23lig;\u8000\ufb01lig;\uc000fj\u0180alt\u1fd9\u1fdc\u1fe1t;\u666dig;\u8000\ufb02ns;\u65b1of;\u4192\u01f0\u1fee\0\u1ff3f;\uc000\ud835\udd57\u0100ak\u05bf\u1ff7\u0100;v\u1ffc\u1ffd\u62d4;\u6ad9artint;\u6a0d\u0100ao\u200c\u2055\u0100cs\u2011\u2052\u03b1\u201a\u2030\u2038\u2045\u2048\0\u2050\u03b2\u2022\u2025\u2027\u202a\u202c\0\u202e\u803b\xbd\u40bd;\u6153\u803b\xbc\u40bc;\u6155;\u6159;\u615b\u01b3\u2034\0\u2036;\u6154;\u6156\u02b4\u203e\u2041\0\0\u2043\u803b\xbe\u40be;\u6157;\u615c5;\u6158\u01b6\u204c\0\u204e;\u615a;\u615d8;\u615el;\u6044wn;\u6322cr;\uc000\ud835\udcbb\u0880Eabcdefgijlnorstv\u2082\u2089\u209f\u20a5\u20b0\u20b4\u20f0\u20f5\u20fa\u20ff\u2103\u2112\u2138\u0317\u213e\u2152\u219e\u0100;l\u064d\u2087;\u6a8c\u0180cmp\u2090\u2095\u209dute;\u41f5ma\u0100;d\u209c\u1cda\u43b3;\u6a86reve;\u411f\u0100iy\u20aa\u20aerc;\u411d;\u4433ot;\u4121\u0200;lqs\u063e\u0642\u20bd\u20c9\u0180;qs\u063e\u064c\u20c4lan\xf4\u0665\u0200;cdl\u0665\u20d2\u20d5\u20e5c;\u6aa9ot\u0100;o\u20dc\u20dd\u6a80\u0100;l\u20e2\u20e3\u6a82;\u6a84\u0100;e\u20ea\u20ed\uc000\u22db\ufe00s;\u6a94r;\uc000\ud835\udd24\u0100;g\u0673\u061bmel;\u6137cy;\u4453\u0200;Eaj\u065a\u210c\u210e\u2110;\u6a92;\u6aa5;\u6aa4\u0200Eaes\u211b\u211d\u2129\u2134;\u6269p\u0100;p\u2123\u2124\u6a8arox\xbb\u2124\u0100;q\u212e\u212f\u6a88\u0100;q\u212e\u211bim;\u62e7pf;\uc000\ud835\udd58\u0100ci\u2143\u2146r;\u610am\u0180;el\u066b\u214e\u2150;\u6a8e;\u6a90\u8300>;cdlqr\u05ee\u2160\u216a\u216e\u2173\u2179\u0100ci\u2165\u2167;\u6aa7r;\u6a7aot;\u62d7Par;\u6995uest;\u6a7c\u0280adels\u2184\u216a\u2190\u0656\u219b\u01f0\u2189\0\u218epro\xf8\u209er;\u6978q\u0100lq\u063f\u2196les\xf3\u2088i\xed\u066b\u0100en\u21a3\u21adrtneqq;\uc000\u2269\ufe00\xc5\u21aa\u0500Aabcefkosy\u21c4\u21c7\u21f1\u21f5\u21fa\u2218\u221d\u222f\u2268\u227dr\xf2\u03a0\u0200ilmr\u21d0\u21d4\u21d7\u21dbrs\xf0\u1484f\xbb\u2024il\xf4\u06a9\u0100dr\u21e0\u21e4cy;\u444a\u0180;cw\u08f4\u21eb\u21efir;\u6948;\u61adar;\u610firc;\u4125\u0180alr\u2201\u220e\u2213rts\u0100;u\u2209\u220a\u6665it\xbb\u220alip;\u6026con;\u62b9r;\uc000\ud835\udd25s\u0100ew\u2223\u2229arow;\u6925arow;\u6926\u0280amopr\u223a\u223e\u2243\u225e\u2263rr;\u61fftht;\u623bk\u0100lr\u2249\u2253eftarrow;\u61a9ightarrow;\u61aaf;\uc000\ud835\udd59bar;\u6015\u0180clt\u226f\u2274\u2278r;\uc000\ud835\udcbdas\xe8\u21f4rok;\u4127\u0100bp\u2282\u2287ull;\u6043hen\xbb\u1c5b\u0ae1\u22a3\0\u22aa\0\u22b8\u22c5\u22ce\0\u22d5\u22f3\0\0\u22f8\u2322\u2367\u2362\u237f\0\u2386\u23aa\u23b4cute\u803b\xed\u40ed\u0180;iy\u0771\u22b0\u22b5rc\u803b\xee\u40ee;\u4438\u0100cx\u22bc\u22bfy;\u4435cl\u803b\xa1\u40a1\u0100fr\u039f\u22c9;\uc000\ud835\udd26rave\u803b\xec\u40ec\u0200;ino\u073e\u22dd\u22e9\u22ee\u0100in\u22e2\u22e6nt;\u6a0ct;\u622dfin;\u69dcta;\u6129lig;\u4133\u0180aop\u22fe\u231a\u231d\u0180cgt\u2305\u2308\u2317r;\u412b\u0180elp\u071f\u230f\u2313in\xe5\u078ear\xf4\u0720h;\u4131f;\u62b7ed;\u41b5\u0280;cfot\u04f4\u232c\u2331\u233d\u2341are;\u6105in\u0100;t\u2338\u2339\u621eie;\u69dddo\xf4\u2319\u0280;celp\u0757\u234c\u2350\u235b\u2361al;\u62ba\u0100gr\u2355\u2359er\xf3\u1563\xe3\u234darhk;\u6a17rod;\u6a3c\u0200cgpt\u236f\u2372\u2376\u237by;\u4451on;\u412ff;\uc000\ud835\udd5aa;\u43b9uest\u803b\xbf\u40bf\u0100ci\u238a\u238fr;\uc000\ud835\udcben\u0280;Edsv\u04f4\u239b\u239d\u23a1\u04f3;\u62f9ot;\u62f5\u0100;v\u23a6\u23a7\u62f4;\u62f3\u0100;i\u0777\u23aelde;\u4129\u01eb\u23b8\0\u23bccy;\u4456l\u803b\xef\u40ef\u0300cfmosu\u23cc\u23d7\u23dc\u23e1\u23e7\u23f5\u0100iy\u23d1\u23d5rc;\u4135;\u4439r;\uc000\ud835\udd27ath;\u4237pf;\uc000\ud835\udd5b\u01e3\u23ec\0\u23f1r;\uc000\ud835\udcbfrcy;\u4458kcy;\u4454\u0400acfghjos\u240b\u2416\u2422\u2427\u242d\u2431\u2435\u243bppa\u0100;v\u2413\u2414\u43ba;\u43f0\u0100ey\u241b\u2420dil;\u4137;\u443ar;\uc000\ud835\udd28reen;\u4138cy;\u4445cy;\u445cpf;\uc000\ud835\udd5ccr;\uc000\ud835\udcc0\u0b80ABEHabcdefghjlmnoprstuv\u2470\u2481\u2486\u248d\u2491\u250e\u253d\u255a\u2580\u264e\u265e\u2665\u2679\u267d\u269a\u26b2\u26d8\u275d\u2768\u278b\u27c0\u2801\u2812\u0180art\u2477\u247a\u247cr\xf2\u09c6\xf2\u0395ail;\u691barr;\u690e\u0100;g\u0994\u248b;\u6a8bar;\u6962\u0963\u24a5\0\u24aa\0\u24b1\0\0\0\0\0\u24b5\u24ba\0\u24c6\u24c8\u24cd\0\u24f9ute;\u413amptyv;\u69b4ra\xee\u084cbda;\u43bbg\u0180;dl\u088e\u24c1\u24c3;\u6991\xe5\u088e;\u6a85uo\u803b\xab\u40abr\u0400;bfhlpst\u0899\u24de\u24e6\u24e9\u24eb\u24ee\u24f1\u24f5\u0100;f\u089d\u24e3s;\u691fs;\u691d\xeb\u2252p;\u61abl;\u6939im;\u6973l;\u61a2\u0180;ae\u24ff\u2500\u2504\u6aabil;\u6919\u0100;s\u2509\u250a\u6aad;\uc000\u2aad\ufe00\u0180abr\u2515\u2519\u251drr;\u690crk;\u6772\u0100ak\u2522\u252cc\u0100ek\u2528\u252a;\u407b;\u405b\u0100es\u2531\u2533;\u698bl\u0100du\u2539\u253b;\u698f;\u698d\u0200aeuy\u2546\u254b\u2556\u2558ron;\u413e\u0100di\u2550\u2554il;\u413c\xec\u08b0\xe2\u2529;\u443b\u0200cqrs\u2563\u2566\u256d\u257da;\u6936uo\u0100;r\u0e19\u1746\u0100du\u2572\u2577har;\u6967shar;\u694bh;\u61b2\u0280;fgqs\u258b\u258c\u0989\u25f3\u25ff\u6264t\u0280ahlrt\u2598\u25a4\u25b7\u25c2\u25e8rrow\u0100;t\u0899\u25a1a\xe9\u24f6arpoon\u0100du\u25af\u25b4own\xbb\u045ap\xbb\u0966eftarrows;\u61c7ight\u0180ahs\u25cd\u25d6\u25derrow\u0100;s\u08f4\u08a7arpoon\xf3\u0f98quigarro\xf7\u21f0hreetimes;\u62cb\u0180;qs\u258b\u0993\u25falan\xf4\u09ac\u0280;cdgs\u09ac\u260a\u260d\u261d\u2628c;\u6aa8ot\u0100;o\u2614\u2615\u6a7f\u0100;r\u261a\u261b\u6a81;\u6a83\u0100;e\u2622\u2625\uc000\u22da\ufe00s;\u6a93\u0280adegs\u2633\u2639\u263d\u2649\u264bppro\xf8\u24c6ot;\u62d6q\u0100gq\u2643\u2645\xf4\u0989gt\xf2\u248c\xf4\u099bi\xed\u09b2\u0180ilr\u2655\u08e1\u265asht;\u697c;\uc000\ud835\udd29\u0100;E\u099c\u2663;\u6a91\u0161\u2669\u2676r\u0100du\u25b2\u266e\u0100;l\u0965\u2673;\u696alk;\u6584cy;\u4459\u0280;acht\u0a48\u2688\u268b\u2691\u2696r\xf2\u25c1orne\xf2\u1d08ard;\u696bri;\u65fa\u0100io\u269f\u26a4dot;\u4140ust\u0100;a\u26ac\u26ad\u63b0che\xbb\u26ad\u0200Eaes\u26bb\u26bd\u26c9\u26d4;\u6268p\u0100;p\u26c3\u26c4\u6a89rox\xbb\u26c4\u0100;q\u26ce\u26cf\u6a87\u0100;q\u26ce\u26bbim;\u62e6\u0400abnoptwz\u26e9\u26f4\u26f7\u271a\u272f\u2741\u2747\u2750\u0100nr\u26ee\u26f1g;\u67ecr;\u61fdr\xeb\u08c1g\u0180lmr\u26ff\u270d\u2714eft\u0100ar\u09e6\u2707ight\xe1\u09f2apsto;\u67fcight\xe1\u09fdparrow\u0100lr\u2725\u2729ef\xf4\u24edight;\u61ac\u0180afl\u2736\u2739\u273dr;\u6985;\uc000\ud835\udd5dus;\u6a2dimes;\u6a34\u0161\u274b\u274fst;\u6217\xe1\u134e\u0180;ef\u2757\u2758\u1800\u65cange\xbb\u2758ar\u0100;l\u2764\u2765\u4028t;\u6993\u0280achmt\u2773\u2776\u277c\u2785\u2787r\xf2\u08a8orne\xf2\u1d8car\u0100;d\u0f98\u2783;\u696d;\u600eri;\u62bf\u0300achiqt\u2798\u279d\u0a40\u27a2\u27ae\u27bbquo;\u6039r;\uc000\ud835\udcc1m\u0180;eg\u09b2\u27aa\u27ac;\u6a8d;\u6a8f\u0100bu\u252a\u27b3o\u0100;r\u0e1f\u27b9;\u601arok;\u4142\u8400<;cdhilqr\u082b\u27d2\u2639\u27dc\u27e0\u27e5\u27ea\u27f0\u0100ci\u27d7\u27d9;\u6aa6r;\u6a79re\xe5\u25f2mes;\u62c9arr;\u6976uest;\u6a7b\u0100Pi\u27f5\u27f9ar;\u6996\u0180;ef\u2800\u092d\u181b\u65c3r\u0100du\u2807\u280dshar;\u694ahar;\u6966\u0100en\u2817\u2821rtneqq;\uc000\u2268\ufe00\xc5\u281e\u0700Dacdefhilnopsu\u2840\u2845\u2882\u288e\u2893\u28a0\u28a5\u28a8\u28da\u28e2\u28e4\u0a83\u28f3\u2902Dot;\u623a\u0200clpr\u284e\u2852\u2863\u287dr\u803b\xaf\u40af\u0100et\u2857\u2859;\u6642\u0100;e\u285e\u285f\u6720se\xbb\u285f\u0100;s\u103b\u2868to\u0200;dlu\u103b\u2873\u2877\u287bow\xee\u048cef\xf4\u090f\xf0\u13d1ker;\u65ae\u0100oy\u2887\u288cmma;\u6a29;\u443cash;\u6014asuredangle\xbb\u1626r;\uc000\ud835\udd2ao;\u6127\u0180cdn\u28af\u28b4\u28c9ro\u803b\xb5\u40b5\u0200;acd\u1464\u28bd\u28c0\u28c4s\xf4\u16a7ir;\u6af0ot\u80bb\xb7\u01b5us\u0180;bd\u28d2\u1903\u28d3\u6212\u0100;u\u1d3c\u28d8;\u6a2a\u0163\u28de\u28e1p;\u6adb\xf2\u2212\xf0\u0a81\u0100dp\u28e9\u28eeels;\u62a7f;\uc000\ud835\udd5e\u0100ct\u28f8\u28fdr;\uc000\ud835\udcc2pos\xbb\u159d\u0180;lm\u2909\u290a\u290d\u43bctimap;\u62b8\u0c00GLRVabcdefghijlmoprstuvw\u2942\u2953\u297e\u2989\u2998\u29da\u29e9\u2a15\u2a1a\u2a58\u2a5d\u2a83\u2a95\u2aa4\u2aa8\u2b04\u2b07\u2b44\u2b7f\u2bae\u2c34\u2c67\u2c7c\u2ce9\u0100gt\u2947\u294b;\uc000\u22d9\u0338\u0100;v\u2950\u0bcf\uc000\u226b\u20d2\u0180elt\u295a\u2972\u2976ft\u0100ar\u2961\u2967rrow;\u61cdightarrow;\u61ce;\uc000\u22d8\u0338\u0100;v\u297b\u0c47\uc000\u226a\u20d2ightarrow;\u61cf\u0100Dd\u298e\u2993ash;\u62afash;\u62ae\u0280bcnpt\u29a3\u29a7\u29ac\u29b1\u29ccla\xbb\u02deute;\u4144g;\uc000\u2220\u20d2\u0280;Eiop\u0d84\u29bc\u29c0\u29c5\u29c8;\uc000\u2a70\u0338d;\uc000\u224b\u0338s;\u4149ro\xf8\u0d84ur\u0100;a\u29d3\u29d4\u666el\u0100;s\u29d3\u0b38\u01f3\u29df\0\u29e3p\u80bb\xa0\u0b37mp\u0100;e\u0bf9\u0c00\u0280aeouy\u29f4\u29fe\u2a03\u2a10\u2a13\u01f0\u29f9\0\u29fb;\u6a43on;\u4148dil;\u4146ng\u0100;d\u0d7e\u2a0aot;\uc000\u2a6d\u0338p;\u6a42;\u443dash;\u6013\u0380;Aadqsx\u0b92\u2a29\u2a2d\u2a3b\u2a41\u2a45\u2a50rr;\u61d7r\u0100hr\u2a33\u2a36k;\u6924\u0100;o\u13f2\u13f0ot;\uc000\u2250\u0338ui\xf6\u0b63\u0100ei\u2a4a\u2a4ear;\u6928\xed\u0b98ist\u0100;s\u0ba0\u0b9fr;\uc000\ud835\udd2b\u0200Eest\u0bc5\u2a66\u2a79\u2a7c\u0180;qs\u0bbc\u2a6d\u0be1\u0180;qs\u0bbc\u0bc5\u2a74lan\xf4\u0be2i\xed\u0bea\u0100;r\u0bb6\u2a81\xbb\u0bb7\u0180Aap\u2a8a\u2a8d\u2a91r\xf2\u2971rr;\u61aear;\u6af2\u0180;sv\u0f8d\u2a9c\u0f8c\u0100;d\u2aa1\u2aa2\u62fc;\u62facy;\u445a\u0380AEadest\u2ab7\u2aba\u2abe\u2ac2\u2ac5\u2af6\u2af9r\xf2\u2966;\uc000\u2266\u0338rr;\u619ar;\u6025\u0200;fqs\u0c3b\u2ace\u2ae3\u2aeft\u0100ar\u2ad4\u2ad9rro\xf7\u2ac1ightarro\xf7\u2a90\u0180;qs\u0c3b\u2aba\u2aealan\xf4\u0c55\u0100;s\u0c55\u2af4\xbb\u0c36i\xed\u0c5d\u0100;r\u0c35\u2afei\u0100;e\u0c1a\u0c25i\xe4\u0d90\u0100pt\u2b0c\u2b11f;\uc000\ud835\udd5f\u8180\xac;in\u2b19\u2b1a\u2b36\u40acn\u0200;Edv\u0b89\u2b24\u2b28\u2b2e;\uc000\u22f9\u0338ot;\uc000\u22f5\u0338\u01e1\u0b89\u2b33\u2b35;\u62f7;\u62f6i\u0100;v\u0cb8\u2b3c\u01e1\u0cb8\u2b41\u2b43;\u62fe;\u62fd\u0180aor\u2b4b\u2b63\u2b69r\u0200;ast\u0b7b\u2b55\u2b5a\u2b5flle\xec\u0b7bl;\uc000\u2afd\u20e5;\uc000\u2202\u0338lint;\u6a14\u0180;ce\u0c92\u2b70\u2b73u\xe5\u0ca5\u0100;c\u0c98\u2b78\u0100;e\u0c92\u2b7d\xf1\u0c98\u0200Aait\u2b88\u2b8b\u2b9d\u2ba7r\xf2\u2988rr\u0180;cw\u2b94\u2b95\u2b99\u619b;\uc000\u2933\u0338;\uc000\u219d\u0338ghtarrow\xbb\u2b95ri\u0100;e\u0ccb\u0cd6\u0380chimpqu\u2bbd\u2bcd\u2bd9\u2b04\u0b78\u2be4\u2bef\u0200;cer\u0d32\u2bc6\u0d37\u2bc9u\xe5\u0d45;\uc000\ud835\udcc3ort\u026d\u2b05\0\0\u2bd6ar\xe1\u2b56m\u0100;e\u0d6e\u2bdf\u0100;q\u0d74\u0d73su\u0100bp\u2beb\u2bed\xe5\u0cf8\xe5\u0d0b\u0180bcp\u2bf6\u2c11\u2c19\u0200;Ees\u2bff\u2c00\u0d22\u2c04\u6284;\uc000\u2ac5\u0338et\u0100;e\u0d1b\u2c0bq\u0100;q\u0d23\u2c00c\u0100;e\u0d32\u2c17\xf1\u0d38\u0200;Ees\u2c22\u2c23\u0d5f\u2c27\u6285;\uc000\u2ac6\u0338et\u0100;e\u0d58\u2c2eq\u0100;q\u0d60\u2c23\u0200gilr\u2c3d\u2c3f\u2c45\u2c47\xec\u0bd7lde\u803b\xf1\u40f1\xe7\u0c43iangle\u0100lr\u2c52\u2c5ceft\u0100;e\u0c1a\u2c5a\xf1\u0c26ight\u0100;e\u0ccb\u2c65\xf1\u0cd7\u0100;m\u2c6c\u2c6d\u43bd\u0180;es\u2c74\u2c75\u2c79\u4023ro;\u6116p;\u6007\u0480DHadgilrs\u2c8f\u2c94\u2c99\u2c9e\u2ca3\u2cb0\u2cb6\u2cd3\u2ce3ash;\u62adarr;\u6904p;\uc000\u224d\u20d2ash;\u62ac\u0100et\u2ca8\u2cac;\uc000\u2265\u20d2;\uc000>\u20d2nfin;\u69de\u0180Aet\u2cbd\u2cc1\u2cc5rr;\u6902;\uc000\u2264\u20d2\u0100;r\u2cca\u2ccd\uc000<\u20d2ie;\uc000\u22b4\u20d2\u0100At\u2cd8\u2cdcrr;\u6903rie;\uc000\u22b5\u20d2im;\uc000\u223c\u20d2\u0180Aan\u2cf0\u2cf4\u2d02rr;\u61d6r\u0100hr\u2cfa\u2cfdk;\u6923\u0100;o\u13e7\u13e5ear;\u6927\u1253\u1a95\0\0\0\0\0\0\0\0\0\0\0\0\0\u2d2d\0\u2d38\u2d48\u2d60\u2d65\u2d72\u2d84\u1b07\0\0\u2d8d\u2dab\0\u2dc8\u2dce\0\u2ddc\u2e19\u2e2b\u2e3e\u2e43\u0100cs\u2d31\u1a97ute\u803b\xf3\u40f3\u0100iy\u2d3c\u2d45r\u0100;c\u1a9e\u2d42\u803b\xf4\u40f4;\u443e\u0280abios\u1aa0\u2d52\u2d57\u01c8\u2d5alac;\u4151v;\u6a38old;\u69bclig;\u4153\u0100cr\u2d69\u2d6dir;\u69bf;\uc000\ud835\udd2c\u036f\u2d79\0\0\u2d7c\0\u2d82n;\u42dbave\u803b\xf2\u40f2;\u69c1\u0100bm\u2d88\u0df4ar;\u69b5\u0200acit\u2d95\u2d98\u2da5\u2da8r\xf2\u1a80\u0100ir\u2d9d\u2da0r;\u69beoss;\u69bbn\xe5\u0e52;\u69c0\u0180aei\u2db1\u2db5\u2db9cr;\u414dga;\u43c9\u0180cdn\u2dc0\u2dc5\u01cdron;\u43bf;\u69b6pf;\uc000\ud835\udd60\u0180ael\u2dd4\u2dd7\u01d2r;\u69b7rp;\u69b9\u0380;adiosv\u2dea\u2deb\u2dee\u2e08\u2e0d\u2e10\u2e16\u6228r\xf2\u1a86\u0200;efm\u2df7\u2df8\u2e02\u2e05\u6a5dr\u0100;o\u2dfe\u2dff\u6134f\xbb\u2dff\u803b\xaa\u40aa\u803b\xba\u40bagof;\u62b6r;\u6a56lope;\u6a57;\u6a5b\u0180clo\u2e1f\u2e21\u2e27\xf2\u2e01ash\u803b\xf8\u40f8l;\u6298i\u016c\u2e2f\u2e34de\u803b\xf5\u40f5es\u0100;a\u01db\u2e3as;\u6a36ml\u803b\xf6\u40f6bar;\u633d\u0ae1\u2e5e\0\u2e7d\0\u2e80\u2e9d\0\u2ea2\u2eb9\0\0\u2ecb\u0e9c\0\u2f13\0\0\u2f2b\u2fbc\0\u2fc8r\u0200;ast\u0403\u2e67\u2e72\u0e85\u8100\xb6;l\u2e6d\u2e6e\u40b6le\xec\u0403\u0269\u2e78\0\0\u2e7bm;\u6af3;\u6afdy;\u443fr\u0280cimpt\u2e8b\u2e8f\u2e93\u1865\u2e97nt;\u4025od;\u402eil;\u6030enk;\u6031r;\uc000\ud835\udd2d\u0180imo\u2ea8\u2eb0\u2eb4\u0100;v\u2ead\u2eae\u43c6;\u43d5ma\xf4\u0a76ne;\u660e\u0180;tv\u2ebf\u2ec0\u2ec8\u43c0chfork\xbb\u1ffd;\u43d6\u0100au\u2ecf\u2edfn\u0100ck\u2ed5\u2eddk\u0100;h\u21f4\u2edb;\u610e\xf6\u21f4s\u0480;abcdemst\u2ef3\u2ef4\u1908\u2ef9\u2efd\u2f04\u2f06\u2f0a\u2f0e\u402bcir;\u6a23ir;\u6a22\u0100ou\u1d40\u2f02;\u6a25;\u6a72n\u80bb\xb1\u0e9dim;\u6a26wo;\u6a27\u0180ipu\u2f19\u2f20\u2f25ntint;\u6a15f;\uc000\ud835\udd61nd\u803b\xa3\u40a3\u0500;Eaceinosu\u0ec8\u2f3f\u2f41\u2f44\u2f47\u2f81\u2f89\u2f92\u2f7e\u2fb6;\u6ab3p;\u6ab7u\xe5\u0ed9\u0100;c\u0ece\u2f4c\u0300;acens\u0ec8\u2f59\u2f5f\u2f66\u2f68\u2f7eppro\xf8\u2f43urlye\xf1\u0ed9\xf1\u0ece\u0180aes\u2f6f\u2f76\u2f7approx;\u6ab9qq;\u6ab5im;\u62e8i\xed\u0edfme\u0100;s\u2f88\u0eae\u6032\u0180Eas\u2f78\u2f90\u2f7a\xf0\u2f75\u0180dfp\u0eec\u2f99\u2faf\u0180als\u2fa0\u2fa5\u2faalar;\u632eine;\u6312urf;\u6313\u0100;t\u0efb\u2fb4\xef\u0efbrel;\u62b0\u0100ci\u2fc0\u2fc5r;\uc000\ud835\udcc5;\u43c8ncsp;\u6008\u0300fiopsu\u2fda\u22e2\u2fdf\u2fe5\u2feb\u2ff1r;\uc000\ud835\udd2epf;\uc000\ud835\udd62rime;\u6057cr;\uc000\ud835\udcc6\u0180aeo\u2ff8\u3009\u3013t\u0100ei\u2ffe\u3005rnion\xf3\u06b0nt;\u6a16st\u0100;e\u3010\u3011\u403f\xf1\u1f19\xf4\u0f14\u0a80ABHabcdefhilmnoprstux\u3040\u3051\u3055\u3059\u30e0\u310e\u312b\u3147\u3162\u3172\u318e\u3206\u3215\u3224\u3229\u3258\u326e\u3272\u3290\u32b0\u32b7\u0180art\u3047\u304a\u304cr\xf2\u10b3\xf2\u03ddail;\u691car\xf2\u1c65ar;\u6964\u0380cdenqrt\u3068\u3075\u3078\u307f\u308f\u3094\u30cc\u0100eu\u306d\u3071;\uc000\u223d\u0331te;\u4155i\xe3\u116emptyv;\u69b3g\u0200;del\u0fd1\u3089\u308b\u308d;\u6992;\u69a5\xe5\u0fd1uo\u803b\xbb\u40bbr\u0580;abcfhlpstw\u0fdc\u30ac\u30af\u30b7\u30b9\u30bc\u30be\u30c0\u30c3\u30c7\u30cap;\u6975\u0100;f\u0fe0\u30b4s;\u6920;\u6933s;\u691e\xeb\u225d\xf0\u272el;\u6945im;\u6974l;\u61a3;\u619d\u0100ai\u30d1\u30d5il;\u691ao\u0100;n\u30db\u30dc\u6236al\xf3\u0f1e\u0180abr\u30e7\u30ea\u30eer\xf2\u17e5rk;\u6773\u0100ak\u30f3\u30fdc\u0100ek\u30f9\u30fb;\u407d;\u405d\u0100es\u3102\u3104;\u698cl\u0100du\u310a\u310c;\u698e;\u6990\u0200aeuy\u3117\u311c\u3127\u3129ron;\u4159\u0100di\u3121\u3125il;\u4157\xec\u0ff2\xe2\u30fa;\u4440\u0200clqs\u3134\u3137\u313d\u3144a;\u6937dhar;\u6969uo\u0100;r\u020e\u020dh;\u61b3\u0180acg\u314e\u315f\u0f44l\u0200;ips\u0f78\u3158\u315b\u109cn\xe5\u10bbar\xf4\u0fa9t;\u65ad\u0180ilr\u3169\u1023\u316esht;\u697d;\uc000\ud835\udd2f\u0100ao\u3177\u3186r\u0100du\u317d\u317f\xbb\u047b\u0100;l\u1091\u3184;\u696c\u0100;v\u318b\u318c\u43c1;\u43f1\u0180gns\u3195\u31f9\u31fcht\u0300ahlrst\u31a4\u31b0\u31c2\u31d8\u31e4\u31eerrow\u0100;t\u0fdc\u31ada\xe9\u30c8arpoon\u0100du\u31bb\u31bfow\xee\u317ep\xbb\u1092eft\u0100ah\u31ca\u31d0rrow\xf3\u0feaarpoon\xf3\u0551ightarrows;\u61c9quigarro\xf7\u30cbhreetimes;\u62ccg;\u42daingdotse\xf1\u1f32\u0180ahm\u320d\u3210\u3213r\xf2\u0feaa\xf2\u0551;\u600foust\u0100;a\u321e\u321f\u63b1che\xbb\u321fmid;\u6aee\u0200abpt\u3232\u323d\u3240\u3252\u0100nr\u3237\u323ag;\u67edr;\u61fer\xeb\u1003\u0180afl\u3247\u324a\u324er;\u6986;\uc000\ud835\udd63us;\u6a2eimes;\u6a35\u0100ap\u325d\u3267r\u0100;g\u3263\u3264\u4029t;\u6994olint;\u6a12ar\xf2\u31e3\u0200achq\u327b\u3280\u10bc\u3285quo;\u603ar;\uc000\ud835\udcc7\u0100bu\u30fb\u328ao\u0100;r\u0214\u0213\u0180hir\u3297\u329b\u32a0re\xe5\u31f8mes;\u62cai\u0200;efl\u32aa\u1059\u1821\u32ab\u65b9tri;\u69celuhar;\u6968;\u611e\u0d61\u32d5\u32db\u32df\u332c\u3338\u3371\0\u337a\u33a4\0\0\u33ec\u33f0\0\u3428\u3448\u345a\u34ad\u34b1\u34ca\u34f1\0\u3616\0\0\u3633cute;\u415bqu\xef\u27ba\u0500;Eaceinpsy\u11ed\u32f3\u32f5\u32ff\u3302\u330b\u330f\u331f\u3326\u3329;\u6ab4\u01f0\u32fa\0\u32fc;\u6ab8on;\u4161u\xe5\u11fe\u0100;d\u11f3\u3307il;\u415frc;\u415d\u0180Eas\u3316\u3318\u331b;\u6ab6p;\u6abaim;\u62e9olint;\u6a13i\xed\u1204;\u4441ot\u0180;be\u3334\u1d47\u3335\u62c5;\u6a66\u0380Aacmstx\u3346\u334a\u3357\u335b\u335e\u3363\u336drr;\u61d8r\u0100hr\u3350\u3352\xeb\u2228\u0100;o\u0a36\u0a34t\u803b\xa7\u40a7i;\u403bwar;\u6929m\u0100in\u3369\xf0nu\xf3\xf1t;\u6736r\u0100;o\u3376\u2055\uc000\ud835\udd30\u0200acoy\u3382\u3386\u3391\u33a0rp;\u666f\u0100hy\u338b\u338fcy;\u4449;\u4448rt\u026d\u3399\0\0\u339ci\xe4\u1464ara\xec\u2e6f\u803b\xad\u40ad\u0100gm\u33a8\u33b4ma\u0180;fv\u33b1\u33b2\u33b2\u43c3;\u43c2\u0400;deglnpr\u12ab\u33c5\u33c9\u33ce\u33d6\u33de\u33e1\u33e6ot;\u6a6a\u0100;q\u12b1\u12b0\u0100;E\u33d3\u33d4\u6a9e;\u6aa0\u0100;E\u33db\u33dc\u6a9d;\u6a9fe;\u6246lus;\u6a24arr;\u6972ar\xf2\u113d\u0200aeit\u33f8\u3408\u340f\u3417\u0100ls\u33fd\u3404lsetm\xe9\u336ahp;\u6a33parsl;\u69e4\u0100dl\u1463\u3414e;\u6323\u0100;e\u341c\u341d\u6aaa\u0100;s\u3422\u3423\u6aac;\uc000\u2aac\ufe00\u0180flp\u342e\u3433\u3442tcy;\u444c\u0100;b\u3438\u3439\u402f\u0100;a\u343e\u343f\u69c4r;\u633ff;\uc000\ud835\udd64a\u0100dr\u344d\u0402es\u0100;u\u3454\u3455\u6660it\xbb\u3455\u0180csu\u3460\u3479\u349f\u0100au\u3465\u346fp\u0100;s\u1188\u346b;\uc000\u2293\ufe00p\u0100;s\u11b4\u3475;\uc000\u2294\ufe00u\u0100bp\u347f\u348f\u0180;es\u1197\u119c\u3486et\u0100;e\u1197\u348d\xf1\u119d\u0180;es\u11a8\u11ad\u3496et\u0100;e\u11a8\u349d\xf1\u11ae\u0180;af\u117b\u34a6\u05b0r\u0165\u34ab\u05b1\xbb\u117car\xf2\u1148\u0200cemt\u34b9\u34be\u34c2\u34c5r;\uc000\ud835\udcc8tm\xee\xf1i\xec\u3415ar\xe6\u11be\u0100ar\u34ce\u34d5r\u0100;f\u34d4\u17bf\u6606\u0100an\u34da\u34edight\u0100ep\u34e3\u34eapsilo\xee\u1ee0h\xe9\u2eafs\xbb\u2852\u0280bcmnp\u34fb\u355e\u1209\u358b\u358e\u0480;Edemnprs\u350e\u350f\u3511\u3515\u351e\u3523\u352c\u3531\u3536\u6282;\u6ac5ot;\u6abd\u0100;d\u11da\u351aot;\u6ac3ult;\u6ac1\u0100Ee\u3528\u352a;\u6acb;\u628alus;\u6abfarr;\u6979\u0180eiu\u353d\u3552\u3555t\u0180;en\u350e\u3545\u354bq\u0100;q\u11da\u350feq\u0100;q\u352b\u3528m;\u6ac7\u0100bp\u355a\u355c;\u6ad5;\u6ad3c\u0300;acens\u11ed\u356c\u3572\u3579\u357b\u3326ppro\xf8\u32faurlye\xf1\u11fe\xf1\u11f3\u0180aes\u3582\u3588\u331bppro\xf8\u331aq\xf1\u3317g;\u666a\u0680123;Edehlmnps\u35a9\u35ac\u35af\u121c\u35b2\u35b4\u35c0\u35c9\u35d5\u35da\u35df\u35e8\u35ed\u803b\xb9\u40b9\u803b\xb2\u40b2\u803b\xb3\u40b3;\u6ac6\u0100os\u35b9\u35bct;\u6abeub;\u6ad8\u0100;d\u1222\u35c5ot;\u6ac4s\u0100ou\u35cf\u35d2l;\u67c9b;\u6ad7arr;\u697bult;\u6ac2\u0100Ee\u35e4\u35e6;\u6acc;\u628blus;\u6ac0\u0180eiu\u35f4\u3609\u360ct\u0180;en\u121c\u35fc\u3602q\u0100;q\u1222\u35b2eq\u0100;q\u35e7\u35e4m;\u6ac8\u0100bp\u3611\u3613;\u6ad4;\u6ad6\u0180Aan\u361c\u3620\u362drr;\u61d9r\u0100hr\u3626\u3628\xeb\u222e\u0100;o\u0a2b\u0a29war;\u692alig\u803b\xdf\u40df\u0be1\u3651\u365d\u3660\u12ce\u3673\u3679\0\u367e\u36c2\0\0\0\0\0\u36db\u3703\0\u3709\u376c\0\0\0\u3787\u0272\u3656\0\0\u365bget;\u6316;\u43c4r\xeb\u0e5f\u0180aey\u3666\u366b\u3670ron;\u4165dil;\u4163;\u4442lrec;\u6315r;\uc000\ud835\udd31\u0200eiko\u3686\u369d\u36b5\u36bc\u01f2\u368b\0\u3691e\u01004f\u1284\u1281a\u0180;sv\u3698\u3699\u369b\u43b8ym;\u43d1\u0100cn\u36a2\u36b2k\u0100as\u36a8\u36aeppro\xf8\u12c1im\xbb\u12acs\xf0\u129e\u0100as\u36ba\u36ae\xf0\u12c1rn\u803b\xfe\u40fe\u01ec\u031f\u36c6\u22e7es\u8180\xd7;bd\u36cf\u36d0\u36d8\u40d7\u0100;a\u190f\u36d5r;\u6a31;\u6a30\u0180eps\u36e1\u36e3\u3700\xe1\u2a4d\u0200;bcf\u0486\u36ec\u36f0\u36f4ot;\u6336ir;\u6af1\u0100;o\u36f9\u36fc\uc000\ud835\udd65rk;\u6ada\xe1\u3362rime;\u6034\u0180aip\u370f\u3712\u3764d\xe5\u1248\u0380adempst\u3721\u374d\u3740\u3751\u3757\u375c\u375fngle\u0280;dlqr\u3730\u3731\u3736\u3740\u3742\u65b5own\xbb\u1dbbeft\u0100;e\u2800\u373e\xf1\u092e;\u625cight\u0100;e\u32aa\u374b\xf1\u105aot;\u65ecinus;\u6a3alus;\u6a39b;\u69cdime;\u6a3bezium;\u63e2\u0180cht\u3772\u377d\u3781\u0100ry\u3777\u377b;\uc000\ud835\udcc9;\u4446cy;\u445brok;\u4167\u0100io\u378b\u378ex\xf4\u1777head\u0100lr\u3797\u37a0eftarro\xf7\u084fightarrow\xbb\u0f5d\u0900AHabcdfghlmoprstuw\u37d0\u37d3\u37d7\u37e4\u37f0\u37fc\u380e\u381c\u3823\u3834\u3851\u385d\u386b\u38a9\u38cc\u38d2\u38ea\u38f6r\xf2\u03edar;\u6963\u0100cr\u37dc\u37e2ute\u803b\xfa\u40fa\xf2\u1150r\u01e3\u37ea\0\u37edy;\u445eve;\u416d\u0100iy\u37f5\u37farc\u803b\xfb\u40fb;\u4443\u0180abh\u3803\u3806\u380br\xf2\u13adlac;\u4171a\xf2\u13c3\u0100ir\u3813\u3818sht;\u697e;\uc000\ud835\udd32rave\u803b\xf9\u40f9\u0161\u3827\u3831r\u0100lr\u382c\u382e\xbb\u0957\xbb\u1083lk;\u6580\u0100ct\u3839\u384d\u026f\u383f\0\0\u384arn\u0100;e\u3845\u3846\u631cr\xbb\u3846op;\u630fri;\u65f8\u0100al\u3856\u385acr;\u416b\u80bb\xa8\u0349\u0100gp\u3862\u3866on;\u4173f;\uc000\ud835\udd66\u0300adhlsu\u114b\u3878\u387d\u1372\u3891\u38a0own\xe1\u13b3arpoon\u0100lr\u3888\u388cef\xf4\u382digh\xf4\u382fi\u0180;hl\u3899\u389a\u389c\u43c5\xbb\u13faon\xbb\u389aparrows;\u61c8\u0180cit\u38b0\u38c4\u38c8\u026f\u38b6\0\0\u38c1rn\u0100;e\u38bc\u38bd\u631dr\xbb\u38bdop;\u630eng;\u416fri;\u65f9cr;\uc000\ud835\udcca\u0180dir\u38d9\u38dd\u38e2ot;\u62f0lde;\u4169i\u0100;f\u3730\u38e8\xbb\u1813\u0100am\u38ef\u38f2r\xf2\u38a8l\u803b\xfc\u40fcangle;\u69a7\u0780ABDacdeflnoprsz\u391c\u391f\u3929\u392d\u39b5\u39b8\u39bd\u39df\u39e4\u39e8\u39f3\u39f9\u39fd\u3a01\u3a20r\xf2\u03f7ar\u0100;v\u3926\u3927\u6ae8;\u6ae9as\xe8\u03e1\u0100nr\u3932\u3937grt;\u699c\u0380eknprst\u34e3\u3946\u394b\u3952\u395d\u3964\u3996app\xe1\u2415othin\xe7\u1e96\u0180hir\u34eb\u2ec8\u3959op\xf4\u2fb5\u0100;h\u13b7\u3962\xef\u318d\u0100iu\u3969\u396dgm\xe1\u33b3\u0100bp\u3972\u3984setneq\u0100;q\u397d\u3980\uc000\u228a\ufe00;\uc000\u2acb\ufe00setneq\u0100;q\u398f\u3992\uc000\u228b\ufe00;\uc000\u2acc\ufe00\u0100hr\u399b\u399fet\xe1\u369ciangle\u0100lr\u39aa\u39afeft\xbb\u0925ight\xbb\u1051y;\u4432ash\xbb\u1036\u0180elr\u39c4\u39d2\u39d7\u0180;be\u2dea\u39cb\u39cfar;\u62bbq;\u625alip;\u62ee\u0100bt\u39dc\u1468a\xf2\u1469r;\uc000\ud835\udd33tr\xe9\u39aesu\u0100bp\u39ef\u39f1\xbb\u0d1c\xbb\u0d59pf;\uc000\ud835\udd67ro\xf0\u0efbtr\xe9\u39b4\u0100cu\u3a06\u3a0br;\uc000\ud835\udccb\u0100bp\u3a10\u3a18n\u0100Ee\u3980\u3a16\xbb\u397en\u0100Ee\u3992\u3a1e\xbb\u3990igzag;\u699a\u0380cefoprs\u3a36\u3a3b\u3a56\u3a5b\u3a54\u3a61\u3a6airc;\u4175\u0100di\u3a40\u3a51\u0100bg\u3a45\u3a49ar;\u6a5fe\u0100;q\u15fa\u3a4f;\u6259erp;\u6118r;\uc000\ud835\udd34pf;\uc000\ud835\udd68\u0100;e\u1479\u3a66at\xe8\u1479cr;\uc000\ud835\udccc\u0ae3\u178e\u3a87\0\u3a8b\0\u3a90\u3a9b\0\0\u3a9d\u3aa8\u3aab\u3aaf\0\0\u3ac3\u3ace\0\u3ad8\u17dc\u17dftr\xe9\u17d1r;\uc000\ud835\udd35\u0100Aa\u3a94\u3a97r\xf2\u03c3r\xf2\u09f6;\u43be\u0100Aa\u3aa1\u3aa4r\xf2\u03b8r\xf2\u09eba\xf0\u2713is;\u62fb\u0180dpt\u17a4\u3ab5\u3abe\u0100fl\u3aba\u17a9;\uc000\ud835\udd69im\xe5\u17b2\u0100Aa\u3ac7\u3acar\xf2\u03cer\xf2\u0a01\u0100cq\u3ad2\u17b8r;\uc000\ud835\udccd\u0100pt\u17d6\u3adcr\xe9\u17d4\u0400acefiosu\u3af0\u3afd\u3b08\u3b0c\u3b11\u3b15\u3b1b\u3b21c\u0100uy\u3af6\u3afbte\u803b\xfd\u40fd;\u444f\u0100iy\u3b02\u3b06rc;\u4177;\u444bn\u803b\xa5\u40a5r;\uc000\ud835\udd36cy;\u4457pf;\uc000\ud835\udd6acr;\uc000\ud835\udcce\u0100cm\u3b26\u3b29y;\u444el\u803b\xff\u40ff\u0500acdefhiosw\u3b42\u3b48\u3b54\u3b58\u3b64\u3b69\u3b6d\u3b74\u3b7a\u3b80cute;\u417a\u0100ay\u3b4d\u3b52ron;\u417e;\u4437ot;\u417c\u0100et\u3b5d\u3b61tr\xe6\u155fa;\u43b6r;\uc000\ud835\udd37cy;\u4436grarr;\u61ddpf;\uc000\ud835\udd6bcr;\uc000\ud835\udccf\u0100jn\u3b85\u3b87;\u600dj;\u600c'.split("").map((e=>e.charCodeAt(0)))),I=new Uint16Array("\u0200aglq\t\x15\x18\x1b\u026d\x0f\0\0\x12p;\u4026os;\u4027t;\u403et;\u403cuot;\u4022".split("").map((e=>e.charCodeAt(0))));const C=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),k=null!==(S=String.fromCodePoint)&&void 0!==S?S:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|1023&e),t+=String.fromCharCode(e),t};var P;!function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"}(P||(P={}));var x,R,L,D,N,j;function M(e){return e>=P.ZERO&&e<=P.NINE}function F(e){return e===P.EQUALS||function(e){return e>=P.UPPER_A&&e<=P.UPPER_Z||e>=P.LOWER_A&&e<=P.LOWER_Z||M(e)}(e)}!function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"}(x||(x={})),function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"}(R||(R={})),function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"}(L||(L={}));class U{constructor(e,t,n){this.decodeTree=e,this.emitCodePoint=t,this.errors=n,this.state=R.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=L.Strict}startEntity(e){this.decodeMode=e,this.state=R.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,t){switch(this.state){case R.EntityStart:return e.charCodeAt(t)===P.NUM?(this.state=R.NumericStart,this.consumed+=1,this.stateNumericStart(e,t+1)):(this.state=R.NamedEntity,this.stateNamedEntity(e,t));case R.NumericStart:return this.stateNumericStart(e,t);case R.NumericDecimal:return this.stateNumericDecimal(e,t);case R.NumericHex:return this.stateNumericHex(e,t);case R.NamedEntity:return this.stateNamedEntity(e,t)}}stateNumericStart(e,t){return t>=e.length?-1:(32|e.charCodeAt(t))===P.LOWER_X?(this.state=R.NumericHex,this.consumed+=1,this.stateNumericHex(e,t+1)):(this.state=R.NumericDecimal,this.stateNumericDecimal(e,t))}addToNumericResult(e,t,n,r){if(t!==n){const i=n-t;this.result=this.result*Math.pow(r,i)+parseInt(e.substr(t,i),r),this.consumed+=i}}stateNumericHex(e,t){const n=t;for(;t<e.length;){const i=e.charCodeAt(t);if(!(M(i)||(r=i,r>=P.UPPER_A&&r<=P.UPPER_F||r>=P.LOWER_A&&r<=P.LOWER_F)))return this.addToNumericResult(e,n,t,16),this.emitNumericEntity(i,3);t+=1}var r;return this.addToNumericResult(e,n,t,16),-1}stateNumericDecimal(e,t){const n=t;for(;t<e.length;){const r=e.charCodeAt(t);if(!M(r))return this.addToNumericResult(e,n,t,10),this.emitNumericEntity(r,2);t+=1}return this.addToNumericResult(e,n,t,10),-1}emitNumericEntity(e,t){var n;if(this.consumed<=t)return null===(n=this.errors)||void 0===n||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===P.SEMI)this.consumed+=1;else if(this.decodeMode===L.Strict)return 0;return this.emitCodePoint(function(e){var t;return e>=55296&&e<=57343||e>1114111?65533:null!==(t=C.get(e))&&void 0!==t?t:e}(this.result),this.consumed),this.errors&&(e!==P.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,t){const{decodeTree:n}=this;let r=n[this.treeIndex],i=(r&x.VALUE_LENGTH)>>14;for(;t<e.length;t++,this.excess++){const o=e.charCodeAt(t);if(this.treeIndex=G(n,r,this.treeIndex+Math.max(1,i),o),this.treeIndex<0)return 0===this.result||this.decodeMode===L.Attribute&&(0===i||F(o))?0:this.emitNotTerminatedNamedEntity();if(r=n[this.treeIndex],i=(r&x.VALUE_LENGTH)>>14,0!==i){if(o===P.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==L.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:t,decodeTree:n}=this,r=(n[t]&x.VALUE_LENGTH)>>14;return this.emitNamedEntityData(t,r,this.consumed),null===(e=this.errors)||void 0===e||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,t,n){const{decodeTree:r}=this;return this.emitCodePoint(1===t?r[e]&~x.VALUE_LENGTH:r[e+1],n),3===t&&this.emitCodePoint(r[e+2],n),n}end(){var e;switch(this.state){case R.NamedEntity:return 0===this.result||this.decodeMode===L.Attribute&&this.result!==this.treeIndex?0:this.emitNotTerminatedNamedEntity();case R.NumericDecimal:return this.emitNumericEntity(0,2);case R.NumericHex:return this.emitNumericEntity(0,3);case R.NumericStart:return null===(e=this.errors)||void 0===e||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case R.EntityStart:return 0}}}function B(e){let t="";const n=new U(e,(e=>t+=k(e)));return function(e,r){let i=0,o=0;for(;(o=e.indexOf("&",o))>=0;){t+=e.slice(i,o),n.startEntity(r);const s=n.write(e,o+1);if(s<0){i=o+n.end();break}i=o+s,o=0===s?i+1:i}const s=t+e.slice(i);return t="",s}}function G(e,t,n,r){const i=(t&x.BRANCH_LENGTH)>>7,o=t&x.JUMP_TABLE;if(0===i)return 0!==o&&r===o?n:-1;if(o){const t=r-o;return t<0||t>=i?-1:e[n+t]-1}let s=n,a=s+i-1;for(;s<=a;){const t=s+a>>>1,n=e[t];if(n<r)s=t+1;else{if(!(n>r))return e[t+i];a=t-1}}return-1}function q(e){return e===D.Space||e===D.NewLine||e===D.Tab||e===D.FormFeed||e===D.CarriageReturn}function H(e){return e===D.Slash||e===D.Gt||q(e)}B(O),B(I),function(e){e[e.Tab=9]="Tab",e[e.NewLine=10]="NewLine",e[e.FormFeed=12]="FormFeed",e[e.CarriageReturn=13]="CarriageReturn",e[e.Space=32]="Space",e[e.ExclamationMark=33]="ExclamationMark",e[e.Number=35]="Number",e[e.Amp=38]="Amp",e[e.SingleQuote=39]="SingleQuote",e[e.DoubleQuote=34]="DoubleQuote",e[e.Dash=45]="Dash",e[e.Slash=47]="Slash",e[e.Zero=48]="Zero",e[e.Nine=57]="Nine",e[e.Semi=59]="Semi",e[e.Lt=60]="Lt",e[e.Eq=61]="Eq",e[e.Gt=62]="Gt",e[e.Questionmark=63]="Questionmark",e[e.UpperA=65]="UpperA",e[e.LowerA=97]="LowerA",e[e.UpperF=70]="UpperF",e[e.LowerF=102]="LowerF",e[e.UpperZ=90]="UpperZ",e[e.LowerZ=122]="LowerZ",e[e.LowerX=120]="LowerX",e[e.OpeningSquareBracket=91]="OpeningSquareBracket"}(D||(D={})),function(e){e[e.Text=1]="Text",e[e.BeforeTagName=2]="BeforeTagName",e[e.InTagName=3]="InTagName",e[e.InSelfClosingTag=4]="InSelfClosingTag",e[e.BeforeClosingTagName=5]="BeforeClosingTagName",e[e.InClosingTagName=6]="InClosingTagName",e[e.AfterClosingTagName=7]="AfterClosingTagName",e[e.BeforeAttributeName=8]="BeforeAttributeName",e[e.InAttributeName=9]="InAttributeName",e[e.AfterAttributeName=10]="AfterAttributeName",e[e.BeforeAttributeValue=11]="BeforeAttributeValue",e[e.InAttributeValueDq=12]="InAttributeValueDq",e[e.InAttributeValueSq=13]="InAttributeValueSq",e[e.InAttributeValueNq=14]="InAttributeValueNq",e[e.BeforeDeclaration=15]="BeforeDeclaration",e[e.InDeclaration=16]="InDeclaration",e[e.InProcessingInstruction=17]="InProcessingInstruction",e[e.BeforeComment=18]="BeforeComment",e[e.CDATASequence=19]="CDATASequence",e[e.InSpecialComment=20]="InSpecialComment",e[e.InCommentLike=21]="InCommentLike",e[e.BeforeSpecialS=22]="BeforeSpecialS",e[e.BeforeSpecialT=23]="BeforeSpecialT",e[e.SpecialStartSequence=24]="SpecialStartSequence",e[e.InSpecialTag=25]="InSpecialTag",e[e.InEntity=26]="InEntity"}(N||(N={})),function(e){e[e.NoValue=0]="NoValue",e[e.Unquoted=1]="Unquoted",e[e.Single=2]="Single",e[e.Double=3]="Double"}(j||(j={}));const $={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101]),TextareaEnd:new Uint8Array([60,47,116,101,120,116,97,114,101,97])};class W{constructor({xmlMode:e=!1,decodeEntities:t=!0},n){this.cbs=n,this.state=N.Text,this.buffer="",this.sectionStart=0,this.index=0,this.entityStart=0,this.baseState=N.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.currentSequence=void 0,this.sequenceIndex=0,this.xmlMode=e,this.decodeEntities=t,this.entityDecoder=new U(e?I:O,((e,t)=>this.emitCodePoint(e,t)))}reset(){this.state=N.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=N.Text,this.currentSequence=void 0,this.running=!0,this.offset=0}write(e){this.offset+=this.buffer.length,this.buffer=e,this.parse()}end(){this.running&&this.finish()}pause(){this.running=!1}resume(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()}stateText(e){e===D.Lt||!this.decodeEntities&&this.fastForwardTo(D.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=N.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&e===D.Amp&&this.startEntity()}stateSpecialStartSequence(e){const t=this.sequenceIndex===this.currentSequence.length;if(t?H(e):(32|e)===this.currentSequence[this.sequenceIndex]){if(!t)return void this.sequenceIndex++}else this.isSpecial=!1;this.sequenceIndex=0,this.state=N.InTagName,this.stateInTagName(e)}stateInSpecialTag(e){if(this.sequenceIndex===this.currentSequence.length){if(e===D.Gt||q(e)){const t=this.index-this.currentSequence.length;if(this.sectionStart<t){const e=this.index;this.index=t,this.cbs.ontext(this.sectionStart,t),this.index=e}return this.isSpecial=!1,this.sectionStart=t+2,void this.stateInClosingTagName(e)}this.sequenceIndex=0}(32|e)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:0===this.sequenceIndex?this.currentSequence===$.TitleEnd?this.decodeEntities&&e===D.Amp&&this.startEntity():this.fastForwardTo(D.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=Number(e===D.Lt)}stateCDATASequence(e){e===$.Cdata[this.sequenceIndex]?++this.sequenceIndex===$.Cdata.length&&(this.state=N.InCommentLike,this.currentSequence=$.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=N.InDeclaration,this.stateInDeclaration(e))}fastForwardTo(e){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===e)return!0;return this.index=this.buffer.length+this.offset-1,!1}stateInCommentLike(e){e===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===$.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=N.Text):0===this.sequenceIndex?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):e!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)}isTagStartChar(e){return this.xmlMode?!H(e):function(e){return e>=D.LowerA&&e<=D.LowerZ||e>=D.UpperA&&e<=D.UpperZ}(e)}startSpecial(e,t){this.isSpecial=!0,this.currentSequence=e,this.sequenceIndex=t,this.state=N.SpecialStartSequence}stateBeforeTagName(e){if(e===D.ExclamationMark)this.state=N.BeforeDeclaration,this.sectionStart=this.index+1;else if(e===D.Questionmark)this.state=N.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(e)){const t=32|e;this.sectionStart=this.index,this.xmlMode?this.state=N.InTagName:t===$.ScriptEnd[2]?this.state=N.BeforeSpecialS:t===$.TitleEnd[2]?this.state=N.BeforeSpecialT:this.state=N.InTagName}else e===D.Slash?this.state=N.BeforeClosingTagName:(this.state=N.Text,this.stateText(e))}stateInTagName(e){H(e)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=N.BeforeAttributeName,this.stateBeforeAttributeName(e))}stateBeforeClosingTagName(e){q(e)||(e===D.Gt?this.state=N.Text:(this.state=this.isTagStartChar(e)?N.InClosingTagName:N.InSpecialComment,this.sectionStart=this.index))}stateInClosingTagName(e){(e===D.Gt||q(e))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=N.AfterClosingTagName,this.stateAfterClosingTagName(e))}stateAfterClosingTagName(e){(e===D.Gt||this.fastForwardTo(D.Gt))&&(this.state=N.Text,this.sectionStart=this.index+1)}stateBeforeAttributeName(e){e===D.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=N.InSpecialTag,this.sequenceIndex=0):this.state=N.Text,this.sectionStart=this.index+1):e===D.Slash?this.state=N.InSelfClosingTag:q(e)||(this.state=N.InAttributeName,this.sectionStart=this.index)}stateInSelfClosingTag(e){e===D.Gt?(this.cbs.onselfclosingtag(this.index),this.state=N.Text,this.sectionStart=this.index+1,this.isSpecial=!1):q(e)||(this.state=N.BeforeAttributeName,this.stateBeforeAttributeName(e))}stateInAttributeName(e){(e===D.Eq||H(e))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=this.index,this.state=N.AfterAttributeName,this.stateAfterAttributeName(e))}stateAfterAttributeName(e){e===D.Eq?this.state=N.BeforeAttributeValue:e===D.Slash||e===D.Gt?(this.cbs.onattribend(j.NoValue,this.sectionStart),this.sectionStart=-1,this.state=N.BeforeAttributeName,this.stateBeforeAttributeName(e)):q(e)||(this.cbs.onattribend(j.NoValue,this.sectionStart),this.state=N.InAttributeName,this.sectionStart=this.index)}stateBeforeAttributeValue(e){e===D.DoubleQuote?(this.state=N.InAttributeValueDq,this.sectionStart=this.index+1):e===D.SingleQuote?(this.state=N.InAttributeValueSq,this.sectionStart=this.index+1):q(e)||(this.sectionStart=this.index,this.state=N.InAttributeValueNq,this.stateInAttributeValueNoQuotes(e))}handleInAttributeValue(e,t){e===t||!this.decodeEntities&&this.fastForwardTo(t)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(t===D.DoubleQuote?j.Double:j.Single,this.index+1),this.state=N.BeforeAttributeName):this.decodeEntities&&e===D.Amp&&this.startEntity()}stateInAttributeValueDoubleQuotes(e){this.handleInAttributeValue(e,D.DoubleQuote)}stateInAttributeValueSingleQuotes(e){this.handleInAttributeValue(e,D.SingleQuote)}stateInAttributeValueNoQuotes(e){q(e)||e===D.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(j.Unquoted,this.index),this.state=N.BeforeAttributeName,this.stateBeforeAttributeName(e)):this.decodeEntities&&e===D.Amp&&this.startEntity()}stateBeforeDeclaration(e){e===D.OpeningSquareBracket?(this.state=N.CDATASequence,this.sequenceIndex=0):this.state=e===D.Dash?N.BeforeComment:N.InDeclaration}stateInDeclaration(e){(e===D.Gt||this.fastForwardTo(D.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=N.Text,this.sectionStart=this.index+1)}stateInProcessingInstruction(e){(e===D.Gt||this.fastForwardTo(D.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=N.Text,this.sectionStart=this.index+1)}stateBeforeComment(e){e===D.Dash?(this.state=N.InCommentLike,this.currentSequence=$.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=N.InDeclaration}stateInSpecialComment(e){(e===D.Gt||this.fastForwardTo(D.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=N.Text,this.sectionStart=this.index+1)}stateBeforeSpecialS(e){const t=32|e;t===$.ScriptEnd[3]?this.startSpecial($.ScriptEnd,4):t===$.StyleEnd[3]?this.startSpecial($.StyleEnd,4):(this.state=N.InTagName,this.stateInTagName(e))}stateBeforeSpecialT(e){const t=32|e;t===$.TitleEnd[3]?this.startSpecial($.TitleEnd,4):t===$.TextareaEnd[3]?this.startSpecial($.TextareaEnd,4):(this.state=N.InTagName,this.stateInTagName(e))}startEntity(){this.baseState=this.state,this.state=N.InEntity,this.entityStart=this.index,this.entityDecoder.startEntity(this.xmlMode?L.Strict:this.baseState===N.Text||this.baseState===N.InSpecialTag?L.Legacy:L.Attribute)}stateInEntity(){const e=this.entityDecoder.write(this.buffer,this.index-this.offset);e>=0?(this.state=this.baseState,0===e&&(this.index=this.entityStart)):this.index=this.offset+this.buffer.length-1}cleanup(){this.running&&this.sectionStart!==this.index&&(this.state===N.Text||this.state===N.InSpecialTag&&0===this.sequenceIndex?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):this.state!==N.InAttributeValueDq&&this.state!==N.InAttributeValueSq&&this.state!==N.InAttributeValueNq||(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))}shouldContinue(){return this.index<this.buffer.length+this.offset&&this.running}parse(){for(;this.shouldContinue();){const e=this.buffer.charCodeAt(this.index-this.offset);switch(this.state){case N.Text:this.stateText(e);break;case N.SpecialStartSequence:this.stateSpecialStartSequence(e);break;case N.InSpecialTag:this.stateInSpecialTag(e);break;case N.CDATASequence:this.stateCDATASequence(e);break;case N.InAttributeValueDq:this.stateInAttributeValueDoubleQuotes(e);break;case N.InAttributeName:this.stateInAttributeName(e);break;case N.InCommentLike:this.stateInCommentLike(e);break;case N.InSpecialComment:this.stateInSpecialComment(e);break;case N.BeforeAttributeName:this.stateBeforeAttributeName(e);break;case N.InTagName:this.stateInTagName(e);break;case N.InClosingTagName:this.stateInClosingTagName(e);break;case N.BeforeTagName:this.stateBeforeTagName(e);break;case N.AfterAttributeName:this.stateAfterAttributeName(e);break;case N.InAttributeValueSq:this.stateInAttributeValueSingleQuotes(e);break;case N.BeforeAttributeValue:this.stateBeforeAttributeValue(e);break;case N.BeforeClosingTagName:this.stateBeforeClosingTagName(e);break;case N.AfterClosingTagName:this.stateAfterClosingTagName(e);break;case N.BeforeSpecialS:this.stateBeforeSpecialS(e);break;case N.BeforeSpecialT:this.stateBeforeSpecialT(e);break;case N.InAttributeValueNq:this.stateInAttributeValueNoQuotes(e);break;case N.InSelfClosingTag:this.stateInSelfClosingTag(e);break;case N.InDeclaration:this.stateInDeclaration(e);break;case N.BeforeDeclaration:this.stateBeforeDeclaration(e);break;case N.BeforeComment:this.stateBeforeComment(e);break;case N.InProcessingInstruction:this.stateInProcessingInstruction(e);break;case N.InEntity:this.stateInEntity()}this.index++}this.cleanup()}finish(){this.state===N.InEntity&&(this.entityDecoder.end(),this.state=this.baseState),this.handleTrailingData(),this.cbs.onend()}handleTrailingData(){const e=this.buffer.length+this.offset;this.sectionStart>=e||(this.state===N.InCommentLike?this.currentSequence===$.CdataEnd?this.cbs.oncdata(this.sectionStart,e,0):this.cbs.oncomment(this.sectionStart,e,0):this.state===N.InTagName||this.state===N.BeforeAttributeName||this.state===N.BeforeAttributeValue||this.state===N.AfterAttributeName||this.state===N.InAttributeName||this.state===N.InAttributeValueSq||this.state===N.InAttributeValueDq||this.state===N.InAttributeValueNq||this.state===N.InClosingTagName||this.cbs.ontext(this.sectionStart,e))}emitCodePoint(e,t){this.baseState!==N.Text&&this.baseState!==N.InSpecialTag?(this.sectionStart<this.entityStart&&this.cbs.onattribdata(this.sectionStart,this.entityStart),this.sectionStart=this.entityStart+t,this.index=this.sectionStart-1,this.cbs.onattribentity(e)):(this.sectionStart<this.entityStart&&this.cbs.ontext(this.sectionStart,this.entityStart),this.sectionStart=this.entityStart+t,this.index=this.sectionStart-1,this.cbs.ontextentity(e,this.sectionStart))}}const z=new Set(["input","option","optgroup","select","button","datalist","textarea"]),V=new Set(["p"]),K=new Set(["thead","tbody"]),Y=new Set(["dd","dt"]),Q=new Set(["rt","rp"]),X=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",V],["h1",V],["h2",V],["h3",V],["h4",V],["h5",V],["h6",V],["select",z],["input",z],["output",z],["button",z],["datalist",z],["textarea",z],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",Y],["dt",Y],["address",V],["article",V],["aside",V],["blockquote",V],["details",V],["div",V],["dl",V],["fieldset",V],["figcaption",V],["figure",V],["footer",V],["form",V],["header",V],["hr",V],["main",V],["nav",V],["ol",V],["pre",V],["section",V],["table",V],["ul",V],["rt",Q],["rp",Q],["tbody",K],["tfoot",K]]),J=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),Z=new Set(["math","svg"]),ee=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),te=/\s|\//;let ne=class{constructor(e,t={}){var n,r,i,o,s,a;this.options=t,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=null!=e?e:{},this.htmlMode=!this.options.xmlMode,this.lowerCaseTagNames=null!==(n=t.lowerCaseTags)&&void 0!==n?n:this.htmlMode,this.lowerCaseAttributeNames=null!==(r=t.lowerCaseAttributeNames)&&void 0!==r?r:this.htmlMode,this.recognizeSelfClosing=null!==(i=t.recognizeSelfClosing)&&void 0!==i?i:!this.htmlMode,this.tokenizer=new(null!==(o=t.Tokenizer)&&void 0!==o?o:W)(this.options,this),this.foreignContext=[!this.htmlMode],null===(a=(s=this.cbs).onparserinit)||void 0===a||a.call(s,this)}ontext(e,t){var n,r;const i=this.getSlice(e,t);this.endIndex=t-1,null===(r=(n=this.cbs).ontext)||void 0===r||r.call(n,i),this.startIndex=t}ontextentity(e,t){var n,r;this.endIndex=t-1,null===(r=(n=this.cbs).ontext)||void 0===r||r.call(n,k(e)),this.startIndex=t}isVoidElement(e){return this.htmlMode&&J.has(e)}onopentagname(e,t){this.endIndex=t;let n=this.getSlice(e,t);this.lowerCaseTagNames&&(n=n.toLowerCase()),this.emitOpenTag(n)}emitOpenTag(e){var t,n,r,i;this.openTagStart=this.startIndex,this.tagname=e;const o=this.htmlMode&&X.get(e);if(o)for(;this.stack.length>0&&o.has(this.stack[0]);){const e=this.stack.shift();null===(n=(t=this.cbs).onclosetag)||void 0===n||n.call(t,e,!0)}this.isVoidElement(e)||(this.stack.unshift(e),this.htmlMode&&(Z.has(e)?this.foreignContext.unshift(!0):ee.has(e)&&this.foreignContext.unshift(!1))),null===(i=(r=this.cbs).onopentagname)||void 0===i||i.call(r,e),this.cbs.onopentag&&(this.attribs={})}endOpenTag(e){var t,n;this.startIndex=this.openTagStart,this.attribs&&(null===(n=(t=this.cbs).onopentag)||void 0===n||n.call(t,this.tagname,this.attribs,e),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""}onopentagend(e){this.endIndex=e,this.endOpenTag(!1),this.startIndex=e+1}onclosetag(e,t){var n,r,i,o,s,a,c,l;this.endIndex=t;let u=this.getSlice(e,t);if(this.lowerCaseTagNames&&(u=u.toLowerCase()),this.htmlMode&&(Z.has(u)||ee.has(u))&&this.foreignContext.shift(),this.isVoidElement(u))this.htmlMode&&"br"===u&&(null===(o=(i=this.cbs).onopentagname)||void 0===o||o.call(i,"br"),null===(a=(s=this.cbs).onopentag)||void 0===a||a.call(s,"br",{},!0),null===(l=(c=this.cbs).onclosetag)||void 0===l||l.call(c,"br",!1));else{const e=this.stack.indexOf(u);if(-1!==e)for(let t=0;t<=e;t++){const i=this.stack.shift();null===(r=(n=this.cbs).onclosetag)||void 0===r||r.call(n,i,t!==e)}else this.htmlMode&&"p"===u&&(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=t+1}onselfclosingtag(e){this.endIndex=e,this.recognizeSelfClosing||this.foreignContext[0]?(this.closeCurrentTag(!1),this.startIndex=e+1):this.onopentagend(e)}closeCurrentTag(e){var t,n;const r=this.tagname;this.endOpenTag(e),this.stack[0]===r&&(null===(n=(t=this.cbs).onclosetag)||void 0===n||n.call(t,r,!e),this.stack.shift())}onattribname(e,t){this.startIndex=e;const n=this.getSlice(e,t);this.attribname=this.lowerCaseAttributeNames?n.toLowerCase():n}onattribdata(e,t){this.attribvalue+=this.getSlice(e,t)}onattribentity(e){this.attribvalue+=k(e)}onattribend(e,t){var n,r;this.endIndex=t,null===(r=(n=this.cbs).onattribute)||void 0===r||r.call(n,this.attribname,this.attribvalue,e===j.Double?'"':e===j.Single?"'":e===j.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""}getInstructionName(e){const t=e.search(te);let n=t<0?e:e.substr(0,t);return this.lowerCaseTagNames&&(n=n.toLowerCase()),n}ondeclaration(e,t){this.endIndex=t;const n=this.getSlice(e,t);if(this.cbs.onprocessinginstruction){const e=this.getInstructionName(n);this.cbs.onprocessinginstruction(`!${e}`,`!${n}`)}this.startIndex=t+1}onprocessinginstruction(e,t){this.endIndex=t;const n=this.getSlice(e,t);if(this.cbs.onprocessinginstruction){const e=this.getInstructionName(n);this.cbs.onprocessinginstruction(`?${e}`,`?${n}`)}this.startIndex=t+1}oncomment(e,t,n){var r,i,o,s;this.endIndex=t,null===(i=(r=this.cbs).oncomment)||void 0===i||i.call(r,this.getSlice(e,t-n)),null===(s=(o=this.cbs).oncommentend)||void 0===s||s.call(o),this.startIndex=t+1}oncdata(e,t,n){var r,i,o,s,a,c,l,u,d,h;this.endIndex=t;const f=this.getSlice(e,t-n);!this.htmlMode||this.options.recognizeCDATA?(null===(i=(r=this.cbs).oncdatastart)||void 0===i||i.call(r),null===(s=(o=this.cbs).ontext)||void 0===s||s.call(o,f),null===(c=(a=this.cbs).oncdataend)||void 0===c||c.call(a)):(null===(u=(l=this.cbs).oncomment)||void 0===u||u.call(l,`[CDATA[${f}]]`),null===(h=(d=this.cbs).oncommentend)||void 0===h||h.call(d)),this.startIndex=t+1}onend(){var e,t;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(let e=0;e<this.stack.length;e++)this.cbs.onclosetag(this.stack[e],!0)}null===(t=(e=this.cbs).onend)||void 0===t||t.call(e)}reset(){var e,t,n,r;null===(t=(e=this.cbs).onreset)||void 0===t||t.call(e),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,null===(r=(n=this.cbs).onparserinit)||void 0===r||r.call(n,this),this.buffers.length=0,this.foreignContext.length=0,this.foreignContext.unshift(!this.htmlMode),this.bufferOffset=0,this.writeIndex=0,this.ended=!1}parseComplete(e){this.reset(),this.end(e)}getSlice(e,t){for(;e-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();let n=this.buffers[0].slice(e-this.bufferOffset,t-this.bufferOffset);for(;t-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),n+=this.buffers[0].slice(0,t-this.bufferOffset);return n}shiftBuffer(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()}write(e){var t,n;this.ended?null===(n=(t=this.cbs).onerror)||void 0===n||n.call(t,new Error(".write() after done!")):(this.buffers.push(e),this.tokenizer.running&&(this.tokenizer.write(e),this.writeIndex++))}end(e){var t,n;this.ended?null===(n=(t=this.cbs).onerror)||void 0===n||n.call(t,new Error(".end() after done!")):(e&&this.write(e),this.ended=!0,this.tokenizer.end())}pause(){this.tokenizer.pause()}resume(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()}parseChunk(e){this.write(e)}done(e){this.end(e)}};var re;function ie(e){return e.type===re.Tag||e.type===re.Script||e.type===re.Style}!function(e){e.Root="root",e.Text="text",e.Directive="directive",e.Comment="comment",e.Script="script",e.Style="style",e.Tag="tag",e.CDATA="cdata",e.Doctype="doctype"}(re||(re={}));const oe=re.Root,se=re.Text,ae=re.Directive,ce=re.Comment,le=re.Script,ue=re.Style,de=re.Tag,he=re.CDATA,fe=re.Doctype;var pe=Object.freeze({__proto__:null,CDATA:he,Comment:ce,Directive:ae,Doctype:fe,get ElementType(){return re},Root:oe,Script:le,Style:ue,Tag:de,Text:se,isTag:ie});let ge=class{constructor(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}get parentNode(){return this.parent}set parentNode(e){this.parent=e}get previousSibling(){return this.prev}set previousSibling(e){this.prev=e}get nextSibling(){return this.next}set nextSibling(e){this.next=e}cloneNode(e=!1){return Pe(this,e)}};class me extends ge{constructor(e){super(),this.data=e}get nodeValue(){return this.data}set nodeValue(e){this.data=e}}let ye=class extends me{constructor(){super(...arguments),this.type=re.Text}get nodeType(){return 3}},ve=class extends me{constructor(){super(...arguments),this.type=re.Comment}get nodeType(){return 8}};class be extends me{constructor(e,t){super(t),this.name=e,this.type=re.Directive}get nodeType(){return 1}}class _e extends ge{constructor(e){super(),this.children=e}get firstChild(){var e;return null!==(e=this.children[0])&&void 0!==e?e:null}get lastChild(){return this.children.length>0?this.children[this.children.length-1]:null}get childNodes(){return this.children}set childNodes(e){this.children=e}}class we extends _e{constructor(){super(...arguments),this.type=re.CDATA}get nodeType(){return 4}}let Te=class extends _e{constructor(){super(...arguments),this.type=re.Root}get nodeType(){return 9}},Ee=class extends _e{constructor(e,t,n=[],r=("script"===e?re.Script:"style"===e?re.Style:re.Tag)){super(n),this.name=e,this.attribs=t,this.type=r}get nodeType(){return 1}get tagName(){return this.name}set tagName(e){this.name=e}get attributes(){return Object.keys(this.attribs).map((e=>{var t,n;return{name:e,value:this.attribs[e],namespace:null===(t=this["x-attribsNamespace"])||void 0===t?void 0:t[e],prefix:null===(n=this["x-attribsPrefix"])||void 0===n?void 0:n[e]}}))}};function Ae(e){return ie(e)}function Se(e){return e.type===re.CDATA}function Oe(e){return e.type===re.Text}function Ie(e){return e.type===re.Comment}function Ce(e){return e.type===re.Root}function ke(e){return Object.prototype.hasOwnProperty.call(e,"children")}function Pe(e,t=!1){let n;if(Oe(e))n=new ye(e.data);else if(Ie(e))n=new ve(e.data);else if(Ae(e)){const r=t?xe(e.children):[],i=new Ee(e.name,Object.assign({},e.attribs),r);r.forEach((e=>e.parent=i)),null!=e.namespace&&(i.namespace=e.namespace),e["x-attribsNamespace"]&&(i["x-attribsNamespace"]=Object.assign({},e["x-attribsNamespace"])),e["x-attribsPrefix"]&&(i["x-attribsPrefix"]=Object.assign({},e["x-attribsPrefix"])),n=i}else if(Se(e)){const r=t?xe(e.children):[],i=new we(r);r.forEach((e=>e.parent=i)),n=i}else if(Ce(e)){const r=t?xe(e.children):[],i=new Te(r);r.forEach((e=>e.parent=i)),e["x-mode"]&&(i["x-mode"]=e["x-mode"]),n=i}else{if(!function(e){return e.type===re.Directive}(e))throw new Error(`Not implemented yet: ${e.type}`);{const t=new be(e.name,e.data);null!=e["x-name"]&&(t["x-name"]=e["x-name"],t["x-publicId"]=e["x-publicId"],t["x-systemId"]=e["x-systemId"]),n=t}}return n.startIndex=e.startIndex,n.endIndex=e.endIndex,null!=e.sourceCodeLocation&&(n.sourceCodeLocation=e.sourceCodeLocation),n}function xe(e){const t=e.map((e=>Pe(e,!0)));for(let e=1;e<t.length;e++)t[e].prev=t[e-1],t[e-1].next=t[e];return t}const Re={withStartIndices:!1,withEndIndices:!1,xmlMode:!1};class Le{constructor(e,t,n){this.dom=[],this.root=new Te(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,"function"==typeof t&&(n=t,t=Re),"object"==typeof e&&(t=e,e=void 0),this.callback=null!=e?e:null,this.options=null!=t?t:Re,this.elementCB=null!=n?n:null}onparserinit(e){this.parser=e}onreset(){this.dom=[],this.root=new Te(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null}onend(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))}onerror(e){this.handleCallback(e)}onclosetag(){this.lastNode=null;const e=this.tagStack.pop();this.options.withEndIndices&&(e.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(e)}onopentag(e,t){const n=this.options.xmlMode?re.Tag:void 0,r=new Ee(e,t,void 0,n);this.addNode(r),this.tagStack.push(r)}ontext(e){const{lastNode:t}=this;if(t&&t.type===re.Text)t.data+=e,this.options.withEndIndices&&(t.endIndex=this.parser.endIndex);else{const t=new ye(e);this.addNode(t),this.lastNode=t}}oncomment(e){if(this.lastNode&&this.lastNode.type===re.Comment)return void(this.lastNode.data+=e);const t=new ve(e);this.addNode(t),this.lastNode=t}oncommentend(){this.lastNode=null}oncdatastart(){const e=new ye(""),t=new we([e]);this.addNode(t),e.parent=t,this.lastNode=e}oncdataend(){this.lastNode=null}onprocessinginstruction(e,t){const n=new be(e,t);this.addNode(n)}handleCallback(e){if("function"==typeof this.callback)this.callback(e,this.dom);else if(e)throw e}addNode(e){const t=this.tagStack[this.tagStack.length-1],n=t.children[t.children.length-1];this.options.withStartIndices&&(e.startIndex=this.parser.startIndex),this.options.withEndIndices&&(e.endIndex=this.parser.endIndex),t.children.push(e),n&&(e.prev=n,n.next=e),e.parent=t,this.lastNode=null}}const De=/["&'<>$\x80-\uFFFF]/g,Ne=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]),je=null!=String.prototype.codePointAt?(e,t)=>e.codePointAt(t):(e,t)=>55296==(64512&e.charCodeAt(t))?1024*(e.charCodeAt(t)-55296)+e.charCodeAt(t+1)-56320+65536:e.charCodeAt(t);function Me(e){let t,n="",r=0;for(;null!==(t=De.exec(e));){const i=t.index,o=e.charCodeAt(i),s=Ne.get(o);void 0!==s?(n+=e.substring(r,i)+s,r=i+1):(n+=`${e.substring(r,i)}&#x${je(e,i).toString(16)};`,r=De.lastIndex+=Number(55296==(64512&o)))}return n+e.substr(r)}function Fe(e,t){return function(n){let r,i=0,o="";for(;r=e.exec(n);)i!==r.index&&(o+=n.substring(i,r.index)),o+=t.get(r[0].charCodeAt(0)),i=r.index+1;return o+n.substring(i)}}const Ue=Fe(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),Be=Fe(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]])),Ge=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map((e=>[e.toLowerCase(),e]))),qe=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map((e=>[e.toLowerCase(),e]))),He=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function $e(e){return e.replace(/"/g,"&quot;")}const We=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function ze(e,t={}){const n="length"in e?e:[e];let r="";for(let e=0;e<n.length;e++)r+=Ve(n[e],t);return r}function Ve(e,t){switch(e.type){case oe:return ze(e.children,t);case fe:case ae:return`<${e.data}>`;case ce:return function(e){return`\x3c!--${e.data}--\x3e`}(e);case he:return function(e){return`<![CDATA[${e.children[0].data}]]>`}(e);case le:case ue:case de:return function(e,t){var n;"foreign"===t.xmlMode&&(e.name=null!==(n=Ge.get(e.name))&&void 0!==n?n:e.name,e.parent&&Ke.has(e.parent.name)&&(t=Object.assign(Object.assign({},t),{xmlMode:!1})));!t.xmlMode&&Ye.has(e.name)&&(t=Object.assign(Object.assign({},t),{xmlMode:"foreign"}));let r=`<${e.name}`;const i=function(e,t){var n;if(!e)return;const r=!1===(null!==(n=t.encodeEntities)&&void 0!==n?n:t.decodeEntities)?$e:t.xmlMode||"utf8"!==t.encodeEntities?Me:Ue;return Object.keys(e).map((n=>{var i,o;const s=null!==(i=e[n])&&void 0!==i?i:"";return"foreign"===t.xmlMode&&(n=null!==(o=qe.get(n))&&void 0!==o?o:n),t.emptyAttrs||t.xmlMode||""!==s?`${n}="${r(s)}"`:n})).join(" ")}(e.attribs,t);i&&(r+=` ${i}`);0===e.children.length&&(t.xmlMode?!1!==t.selfClosingTags:t.selfClosingTags&&We.has(e.name))?(t.xmlMode||(r+=" "),r+="/>"):(r+=">",e.children.length>0&&(r+=ze(e.children,t)),!t.xmlMode&&We.has(e.name)||(r+=`</${e.name}>`));return r}(e,t);case se:return function(e,t){var n;let r=e.data||"";!1===(null!==(n=t.encodeEntities)&&void 0!==n?n:t.decodeEntities)||!t.xmlMode&&e.parent&&He.has(e.parent.name)||(r=t.xmlMode||"utf8"!==t.encodeEntities?Me(r):Be(r));return r}(e,t)}}const Ke=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),Ye=new Set(["svg","math"]);function Qe(e,t){return ze(e,t)}function Xe(e){return Array.isArray(e)?e.map(Xe).join(""):ke(e)&&!Ie(e)?Xe(e.children):Oe(e)?e.data:""}function Je(e){return ke(e)?e.children:[]}function Ze(e){return e.parent||null}function et(e){if(e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.parent){const t=e.parent.children,n=t.lastIndexOf(e);n>=0&&t.splice(n,1)}e.next=null,e.prev=null,e.parent=null}function tt(e,t,n=!0,r=1/0){return nt(e,Array.isArray(t)?t:[t],n,r)}function nt(e,t,n,r){const i=[],o=[t],s=[0];for(;;){if(s[0]>=o[0].length){if(1===s.length)return i;o.shift(),s.shift();continue}const t=o[0][s[0]++];if(e(t)&&(i.push(t),--r<=0))return i;n&&ke(t)&&t.children.length>0&&(s.unshift(0),o.unshift(t.children))}}function rt(e,t,n=!0){let r=null;for(let i=0;i<t.length&&!r;i++){const o=t[i];Ae(o)&&(e(o)?r=o:n&&o.children.length>0&&(r=rt(e,o.children,!0)))}return r}const it={tag_name:e=>"function"==typeof e?t=>Ae(t)&&e(t.name):"*"===e?Ae:t=>Ae(t)&&t.name===e,tag_type:e=>"function"==typeof e?t=>e(t.type):t=>t.type===e,tag_contains:e=>"function"==typeof e?t=>Oe(t)&&e(t.data):t=>Oe(t)&&t.data===e};function ot(e,t){return"function"==typeof t?n=>Ae(n)&&t(n.attribs[e]):n=>Ae(n)&&n.attribs[e]===t}function st(e,t){return n=>e(n)||t(n)}function at(e){const t=Object.keys(e).map((t=>{const n=e[t];return Object.prototype.hasOwnProperty.call(it,t)?it[t](n):ot(t,n)}));return 0===t.length?null:t.reduce(st)}function ct(e,t,n=!0,r=1/0){return tt(it.tag_name(e),t,n,r)}var lt;function ut(e,t){const n=[],r=[];if(e===t)return 0;let i=ke(e)?e:e.parent;for(;i;)n.unshift(i),i=i.parent;for(i=ke(t)?t:t.parent;i;)r.unshift(i),i=i.parent;const o=Math.min(n.length,r.length);let s=0;for(;s<o&&n[s]===r[s];)s++;if(0===s)return lt.DISCONNECTED;const a=n[s-1],c=a.children,l=n[s],u=r[s];return c.indexOf(l)>c.indexOf(u)?a===t?lt.FOLLOWING|lt.CONTAINED_BY:lt.FOLLOWING:a===e?lt.PRECEDING|lt.CONTAINS:lt.PRECEDING}function dt(e){const t=gt(vt,e);return t?"feed"===t.name?function(e){var t;const n=e.children,r={type:"atom",items:ct("entry",n).map((e=>{var t;const{children:n}=e,r={media:pt(n)};yt(r,"id","id",n),yt(r,"title","title",n);const i=null===(t=gt("link",n))||void 0===t?void 0:t.attribs.href;i&&(r.link=i);const o=mt("summary",n)||mt("content",n);o&&(r.description=o);const s=mt("updated",n);return s&&(r.pubDate=new Date(s)),r}))};yt(r,"id","id",n),yt(r,"title","title",n);const i=null===(t=gt("link",n))||void 0===t?void 0:t.attribs.href;i&&(r.link=i);yt(r,"description","subtitle",n);const o=mt("updated",n);o&&(r.updated=new Date(o));return yt(r,"author","email",n,!0),r}(t):function(e){var t,n;const r=null!==(n=null===(t=gt("channel",e.children))||void 0===t?void 0:t.children)&&void 0!==n?n:[],i={type:e.name.substr(0,3),id:"",items:ct("item",e.children).map((e=>{const{children:t}=e,n={media:pt(t)};yt(n,"id","guid",t),yt(n,"title","title",t),yt(n,"link","link",t),yt(n,"description","description",t);const r=mt("pubDate",t)||mt("dc:date",t);return r&&(n.pubDate=new Date(r)),n}))};yt(i,"title","title",r),yt(i,"link","link",r),yt(i,"description","description",r);const o=mt("lastBuildDate",r);o&&(i.updated=new Date(o));return yt(i,"author","managingEditor",r,!0),i}(t):null}!function(e){e[e.DISCONNECTED=1]="DISCONNECTED",e[e.PRECEDING=2]="PRECEDING",e[e.FOLLOWING=4]="FOLLOWING",e[e.CONTAINS=8]="CONTAINS",e[e.CONTAINED_BY=16]="CONTAINED_BY"}(lt||(lt={}));const ht=["url","type","lang"],ft=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function pt(e){return ct("media:content",e).map((e=>{const{attribs:t}=e,n={medium:t.medium,isDefault:!!t.isDefault};for(const e of ht)t[e]&&(n[e]=t[e]);for(const e of ft)t[e]&&(n[e]=parseInt(t[e],10));return t.expression&&(n.expression=t.expression),n}))}function gt(e,t){return ct(e,t,!0,1)[0]}function mt(e,t,n=!1){return Xe(ct(e,t,n,1)).trim()}function yt(e,t,n,r,i=!1){const o=mt(n,r,i);o&&(e[t]=o)}function vt(e){return"rss"===e||"feed"===e||"rdf:RDF"===e}var bt=Object.freeze({__proto__:null,get DocumentPosition(){return lt},append:function(e,t){et(t);const{parent:n}=e,r=e.next;if(t.next=r,t.prev=e,e.next=t,t.parent=n,r){if(r.prev=t,n){const e=n.children;e.splice(e.lastIndexOf(r),0,t)}}else n&&n.children.push(t)},appendChild:function(e,t){if(et(t),t.next=null,t.parent=e,e.children.push(t)>1){const n=e.children[e.children.length-2];n.next=t,t.prev=n}else t.prev=null},compareDocumentPosition:ut,existsOne:function e(t,n){return n.some((n=>Ae(n)&&(t(n)||e(t,n.children))))},filter:tt,find:nt,findAll:function(e,t){const n=[],r=[t],i=[0];for(;;){if(i[0]>=r[0].length){if(1===r.length)return n;r.shift(),i.shift();continue}const t=r[0][i[0]++];Ae(t)&&(e(t)&&n.push(t),t.children.length>0&&(i.unshift(0),r.unshift(t.children)))}},findOne:rt,findOneChild:function(e,t){return t.find(e)},getAttributeValue:function(e,t){var n;return null===(n=e.attribs)||void 0===n?void 0:n[t]},getChildren:Je,getElementById:function(e,t,n=!0){return Array.isArray(t)||(t=[t]),rt(ot("id",e),t,n)},getElements:function(e,t,n,r=1/0){const i=at(e);return i?tt(i,t,n,r):[]},getElementsByTagName:ct,getElementsByTagType:function(e,t,n=!0,r=1/0){return tt(it.tag_type(e),t,n,r)},getFeed:dt,getInnerHTML:function(e,t){return ke(e)?e.children.map((e=>Qe(e,t))).join(""):""},getName:function(e){return e.name},getOuterHTML:Qe,getParent:Ze,getSiblings:function(e){const t=Ze(e);if(null!=t)return Je(t);const n=[e];let{prev:r,next:i}=e;for(;null!=r;)n.unshift(r),({prev:r}=r);for(;null!=i;)n.push(i),({next:i}=i);return n},getText:function e(t){return Array.isArray(t)?t.map(e).join(""):Ae(t)?"br"===t.name?"\n":e(t.children):Se(t)?e(t.children):Oe(t)?t.data:""},hasAttrib:function(e,t){return null!=e.attribs&&Object.prototype.hasOwnProperty.call(e.attribs,t)&&null!=e.attribs[t]},hasChildren:ke,innerText:function e(t){return Array.isArray(t)?t.map(e).join(""):ke(t)&&(t.type===re.Tag||Se(t))?e(t.children):Oe(t)?t.data:""},isCDATA:Se,isComment:Ie,isDocument:Ce,isTag:Ae,isText:Oe,nextElementSibling:function(e){let{next:t}=e;for(;null!==t&&!Ae(t);)({next:t}=t);return t},prepend:function(e,t){et(t);const{parent:n}=e;if(n){const r=n.children;r.splice(r.indexOf(e),0,t)}e.prev&&(e.prev.next=t),t.parent=n,t.prev=e.prev,t.next=e,e.prev=t},prependChild:function(e,t){if(et(t),t.parent=e,t.prev=null,1!==e.children.unshift(t)){const n=e.children[1];n.prev=t,t.next=n}else t.next=null},prevElementSibling:function(e){let{prev:t}=e;for(;null!==t&&!Ae(t);)({prev:t}=t);return t},removeElement:et,removeSubsets:function(e){let t=e.length;for(;--t>=0;){const n=e[t];if(t>0&&e.lastIndexOf(n,t-1)>=0)e.splice(t,1);else for(let r=n.parent;r;r=r.parent)if(e.includes(r)){e.splice(t,1);break}}return e},replaceElement:function(e,t){const n=t.prev=e.prev;n&&(n.next=t);const r=t.next=e.next;r&&(r.prev=t);const i=t.parent=e.parent;if(i){const n=i.children;n[n.lastIndexOf(e)]=t,e.parent=null}},testElement:function(e,t){const n=at(e);return!n||n(t)},textContent:Xe,uniqueSort:function(e){return(e=e.filter(((e,t,n)=>!n.includes(e,t+1)))).sort(((e,t)=>{const n=ut(e,t);return n&lt.PRECEDING?-1:n&lt.FOLLOWING?1:0})),e}});function _t(e,t){const n=new Le(void 0,t);return new ne(n,t).end(e),n.root}function wt(e,t){return _t(e,t).children}const Tt={xmlMode:!0};var Et=Object.freeze({__proto__:null,DefaultHandler:Le,DomHandler:Le,DomUtils:bt,ElementType:pe,Parser:ne,get QuoteType(){return j},Tokenizer:W,createDocumentStream:function(e,t,n){const r=new Le((t=>e(t,r.root)),t,n);return new ne(r,t)},createDomStream:function(e,t,n){const r=new Le(e,t,n);return new ne(r,t)},getFeed:dt,parseDOM:wt,parseDocument:_t,parseFeed:function(e,t=Tt){return dt(wt(e,t))}});const At=-1,St=10,Ot=11,It=new Set(["ARTICLE","ASIDE","BLOCKQUOTE","BODY","BR","BUTTON","CANVAS","CAPTION","COL","COLGROUP","DD","DIV","DL","DT","EMBED","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","LI","UL","OL","P"]),Ct="http://www.w3.org/2000/svg",{assign:kt,create:Pt,defineProperties:xt,entries:Rt,getOwnPropertyDescriptors:Lt,keys:Dt,setPrototypeOf:Nt}=Object,jt=String,Mt=e=>1===e.nodeType?e[u]:e,Ft=({ownerDocument:e})=>e[p].ignoreCase,Ut=(e,t)=>{e[m]=t,t[v]=e},Bt=(e,t,n)=>{Ut(e,t),Ut(Mt(t),n)},Gt=(e,t,n)=>{Ut(e,t),Ut(t,n)},qt=({localName:e,ownerDocument:t})=>t[p].ignoreCase?e.toUpperCase():e,Ht=(e,t)=>{e&&(e[m]=t),t&&(t[v]=e)},$t=new WeakMap;let Wt=!1;const zt=new WeakMap,Vt=new WeakMap,Kt=(e,t,n,r)=>{Wt&&Vt.has(e)&&e.attributeChangedCallback&&e.constructor.observedAttributes.includes(t)&&e.attributeChangedCallback(t,n,r)},Yt=(e,t)=>n=>{if(Vt.has(n)){const r=Vt.get(n);r.connected!==t&&n.isConnected===t&&(r.connected=t,e in n&&n[e]())}},Qt=Yt("connectedCallback",!0),Xt=e=>{if(Wt){Qt(e),$t.has(e)&&(e=$t.get(e).shadowRoot);let{[m]:t,[u]:n}=e;for(;t!==n;)1===t.nodeType&&Qt(t),t=t[m]}},Jt=Yt("disconnectedCallback",!1);class Zt{constructor(e){this.ownerDocument=e,this.registry=new Map,this.waiting=new Map,this.active=!1}define(e,t,n={}){const{ownerDocument:r,registry:i,waiting:o}=this;if(i.has(e))throw new Error("unable to redefine "+e);if(zt.has(t))throw new Error("unable to redefine the same class: "+t);this.active=Wt=!0;const{extends:s}=n;zt.set(t,{ownerDocument:r,options:{is:s?e:""},localName:s||e});const a=s?t=>t.localName===s&&t.getAttribute("is")===e:t=>t.localName===e;if(i.set(e,{Class:t,check:a}),o.has(e)){for(const n of o.get(e))n(t);o.delete(e)}r.querySelectorAll(s?`${s}[is="${e}"]`:e).forEach(this.upgrade,this)}upgrade(e){if(Vt.has(e))return;const{ownerDocument:t,registry:n}=this,r=e.getAttribute("is")||e.localName;if(n.has(r)){const{Class:i,check:o}=n.get(r);if(o(e)){const{attributes:n,isConnected:o}=e;for(const t of n)e.removeAttributeNode(t);const s=Rt(e);for(const[t]of s)delete e[t];Nt(e,i.prototype),t[E]={element:e,values:s},new i(t,r),Vt.set(e,{connected:o});for(const t of n)e.setAttributeNode(t);o&&e.connectedCallback&&e.connectedCallback()}}}whenDefined(e){const{registry:t,waiting:n}=this;return new Promise((r=>{t.has(e)?r(t.get(e).Class):(n.has(e)||n.set(e,[]),n.get(e).push(r))}))}get(e){const t=this.registry.get(e);return t&&t.Class}getName(e){if(zt.has(e)){const{localName:t}=zt.get(e);return t}return null}}const{Parser:en}=Et,tn=(e,t,n)=>{const r=e[u];return t.parentNode=e,Bt(r[v],t,r),n&&1===t.nodeType&&Xt(t),t},nn=(e,t,n,r,i)=>{n[A]=r,n.ownerElement=e,Gt(t[v],n,t),"class"===n.name&&(e.className=r),i&&Kt(e,n.name,null,r)},rn=(e,t,n)=>{const{active:r,registry:i}=e[o];let s=e,a=null,c=!1;const l=new en({onprocessinginstruction(t,n){"!doctype"===t.toLowerCase()&&(e.doctype=n.slice(t.length).trim())},onopentag(n,o){let c=!0;if(t)if(a)s=tn(s,e.createElementNS(Ct,n),r),s.ownerSVGElement=a,c=!1;else if("svg"===n||"SVG"===n)a=e.createElementNS(Ct,n),s=tn(s,a,r),c=!1;else if(r){const e=n.includes("-")?n:o.is||"";if(e&&i.has(e)){const{Class:t}=i.get(e);s=tn(s,new t,r),delete o.is,c=!1}}c&&(s=tn(s,e.createElement(n),!1));let l=s[u];for(const t of Dt(o))nn(s,l,e.createAttribute(t),o[t],r)},oncomment(t){tn(s,e.createComment(t),r)},ontext(t){tn(s,c?e.createCDATASection(t):e.createTextNode(t),r)},oncdatastart(){c=!0},oncdataend(){c=!1},onclosetag(){t&&s===a&&(a=null),s=s.parentNode}},{lowerCaseAttributeNames:!1,decodeEntities:!0,xmlMode:!t});return l.write(n),l.end(),e},on=new Map,sn=(e,t)=>{for(const n of[].concat(e))on.set(n,t),on.set(n.toUpperCase(),t)},an=globalThis.performance,cn=({[m]:e,[u]:t},n)=>{for(;e!==t;){switch(e.nodeType){case 2:ln(e,n);break;case 3:case 8:case 4:un(e,n);break;case 1:hn(e,n),e=Mt(e);break;case St:dn(e,n)}e=e[m]}const r=n.length-1,i=n[r];"number"==typeof i&&i<0?n[r]+=At:n.push(At)},ln=(e,t)=>{t.push(2,e.name);const n=e[A].trim();n&&t.push(n)},un=(e,t)=>{const n=e[A];n.trim()&&t.push(e.nodeType,n)},dn=({name:e,publicId:t,systemId:n},r)=>{r.push(St,e),t&&r.push(t),n&&r.push(n)},hn=(e,t)=>{t.push(1,e.localName),cn(e,t)},fn=(e,t,n,r,i,o)=>({type:e,target:t,addedNodes:n,removedNodes:r,attributeName:i,oldValue:o}),pn=(e,t,n,r,i,o)=>{if(!r||r.includes(n)){const{callback:r,records:s,scheduled:a}=e;s.push(fn("attributes",t,[],[],n,i?o:void 0)),a||(e.scheduled=!0,Promise.resolve().then((()=>{e.scheduled=!1,r(s.splice(0),e)})))}},gn=(e,t,n)=>{const{ownerDocument:r}=e,{active:i,observers:o}=r[g];if(i)for(const i of o)for(const[o,{childList:s,subtree:a,attributes:c,attributeFilter:l,attributeOldValue:u}]of i.nodes)if(s){if(a&&(o===r||o.contains(e))||!a&&o.children.includes(e)){pn(i,e,t,l,u,n);break}}else if(c&&o===e){pn(i,e,t,l,u,n);break}},mn=(e,t)=>{const{ownerDocument:n}=e,{active:r,observers:i}=n[g];if(r)for(const r of i)for(const[i,{subtree:o,childList:s,characterData:a}]of r.nodes)if(s&&(t&&(i===t||o&&i.contains(t))||!t&&(o&&(i===n||i.contains(e))||!o&&i[a?"childNodes":"children"].includes(e)))){const{callback:n,records:o,scheduled:s}=r;o.push(fn("childList",i,t?[]:[e],t?[e]:[])),s||(r.scheduled=!0,Promise.resolve().then((()=>{r.scheduled=!1,n(o.splice(0),r)})));break}};class yn{constructor(e){const t=new Set;this.observers=t,this.active=!1,this.class=class{constructor(e){this.callback=e,this.nodes=new Map,this.records=[],this.scheduled=!1}disconnect(){this.records.splice(0),this.nodes.clear(),t.delete(this),e[g].active=!!t.size}observe(n,r={subtree:!1,childList:!1,attributes:!1,attributeFilter:null,attributeOldValue:!1,characterData:!1}){("attributeOldValue"in r||"attributeFilter"in r)&&(r.attributes=!0),r.childList=!!r.childList,r.subtree=!!r.subtree,this.nodes.set(n,r),t.add(this),e[g].active=!0}takeRecords(){return this.records.splice(0)}}}}const vn=new Set(["allowfullscreen","allowpaymentrequest","async","autofocus","autoplay","checked","class","contenteditable","controls","default","defer","disabled","draggable","formnovalidate","hidden","id","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected","style","truespeed"]),bn=(e,t)=>{const{[A]:n,name:r}=t;t.ownerElement=e,Gt(e,t,e[m]),"class"===r&&(e.className=n),gn(e,r,null),Kt(e,r,null,n)},_n=(e,t)=>{const{[A]:n,name:r}=t;Ut(t[v],t[m]),t.ownerElement=t[v]=t[m]=null,"class"===r&&(e[i]=null),gn(e,r,n),Kt(e,r,n,null)},wn={get:(e,t)=>e.hasAttribute(t),set(e,t,n){n?e.setAttribute(t,""):e.removeAttribute(t)}},Tn={get:(e,t)=>parseFloat(e.getAttribute(t)||0),set(e,t,n){e.setAttribute(t,n)}},En={get:(e,t)=>e.getAttribute(t)||"",set(e,t,n){e.setAttribute(t,n)}},An=new WeakMap;function Sn(e,t){return"function"==typeof t?t.call(e.target,e):t.handleEvent(e),e._stopImmediatePropagationFlag}function On({currentTarget:e,target:t}){const n=An.get(e);if(n&&n.has(this.type)){const r=n.get(this.type);this.eventPhase=e===t?this.AT_TARGET:this.BUBBLING_PHASE,this.currentTarget=e,this.target=t;for(const[e,t]of r)if(t&&t.once&&r.delete(e),Sn(this,e))break;return delete this.currentTarget,delete this.target,this.cancelBubble}}class In{constructor(){An.set(this,new Map)}_getParent(){return null}addEventListener(e,t,n){const r=An.get(this);r.has(e)||r.set(e,new Map),r.get(e).set(t,n)}removeEventListener(e,t){const n=An.get(this);if(n.has(e)){const r=n.get(e);r.delete(t)&&!r.size&&n.delete(e)}}dispatchEvent(e){let t=this;for(e.eventPhase=e.CAPTURING_PHASE;t;)t.dispatchEvent&&e._path.push({currentTarget:t,target:this}),t=e.bubbles&&t._getParent&&t._getParent();return e._path.some(On,e),e._path=[],e.eventPhase=e.NONE,!e.defaultPrevented}}class Cn extends Array{item(e){return e<this.length?this[e]:null}}const kn=({parentNode:e})=>{let t=0;for(;e;)t++,e=e.parentNode;return t};let Pn=class extends In{static get ELEMENT_NODE(){return 1}static get ATTRIBUTE_NODE(){return 2}static get TEXT_NODE(){return 3}static get CDATA_SECTION_NODE(){return 4}static get COMMENT_NODE(){return 8}static get DOCUMENT_NODE(){return 9}static get DOCUMENT_FRAGMENT_NODE(){return Ot}static get DOCUMENT_TYPE_NODE(){return St}constructor(e,t,n){super(),this.ownerDocument=e,this.localName=t,this.nodeType=n,this.parentNode=null,this[m]=null,this[v]=null}get ELEMENT_NODE(){return 1}get ATTRIBUTE_NODE(){return 2}get TEXT_NODE(){return 3}get CDATA_SECTION_NODE(){return 4}get COMMENT_NODE(){return 8}get DOCUMENT_NODE(){return 9}get DOCUMENT_FRAGMENT_NODE(){return Ot}get DOCUMENT_TYPE_NODE(){return St}get baseURI(){const e=9===this.nodeType?this:this.ownerDocument;if(e){const t=e.querySelector("base");if(t)return t.getAttribute("href");const{location:n}=e.defaultView;if(n)return n.href}return null}get isConnected(){return!1}get nodeName(){return this.localName}get parentElement(){return null}get previousSibling(){return null}get previousElementSibling(){return null}get nextSibling(){return null}get nextElementSibling(){return null}get childNodes(){return new Cn}get firstChild(){return null}get lastChild(){return null}get nodeValue(){return null}set nodeValue(e){}get textContent(){return null}set textContent(e){}normalize(){}cloneNode(){return null}contains(){return!1}insertBefore(e,t){return e}appendChild(e){return e}replaceChild(e,t){return t}removeChild(e){return e}toString(){return""}hasChildNodes(){return!!this.lastChild}isSameNode(e){return this===e}compareDocumentPosition(e){let t=0;if(this!==e){let n=kn(this),r=kn(e);if(n<r)t+=4,this.contains(e)&&(t+=16);else if(r<n)t+=2,e.contains(this)&&(t+=8);else if(n&&r){const{childNodes:n}=this.parentNode;n.indexOf(this)<n.indexOf(e)?t+=4:t+=2}n&&r||(t+=32,t+=1)}return t}isEqualNode(e){if(this===e)return!0;if(this.nodeType===e.nodeType){switch(this.nodeType){case 9:case Ot:{const t=this.childNodes,n=e.childNodes;return t.length===n.length&&t.every(((e,t)=>e.isEqualNode(n[t])))}}return this.toString()===e.toString()}return!1}_getParent(){return this.parentNode}getRootNode(){let e=this;for(;e.parentNode;)e=e.parentNode;return e}};const{replace:xn}="",Rn=/[<>&\xA0]/g,Ln={"\xa0":"&#160;","&":"&amp;","<":"&lt;",">":"&gt;"},Dn=e=>Ln[e],Nn=e=>xn.call(e,Rn,Dn),jn=/"/g;let Mn=class e extends Pn{constructor(e,t,n=""){super(e,t,2),this.ownerElement=null,this.name=jt(t),this[A]=jt(n),this[r]=!1}get value(){return this[A]}set value(e){const{[A]:t,name:n,ownerElement:i}=this;this[A]=jt(e),this[r]=!0,i&&(gn(i,n,t),Kt(i,n,t,this[A]))}cloneNode(){const{ownerDocument:t,name:n,[A]:r}=this;return new e(t,n,r)}toString(){const{name:e,[A]:t}=this;if(vn.has(e)&&!t)return Ft(this)?e:`${e}=""`;return`${e}="${Ft(this)?t.replace(jn,"&quot;"):Nn(t)}"`}toJSON(){const e=[];return ln(this,e),e}};const Fn=({ownerDocument:e,parentNode:t})=>{for(;t;){if(t===e)return!0;t=t.parentNode||t.host}return!1},Un=({parentNode:e})=>{if(e)switch(e.nodeType){case 9:case Ot:return null}return e},Bn=({[v]:e})=>{switch(e?e.nodeType:0){case At:return e[w];case 3:case 8:case 4:return e}return null},Gn=e=>{const t=Mt(e)[m];return t&&(t.nodeType===At?null:t)},qn=e=>{let t=Gn(e);for(;t&&1!==t.nodeType;)t=Gn(t);return t},Hn=e=>{let t=Bn(e);for(;t&&1!==t.nodeType;)t=Bn(t);return t},$n=(e,t)=>{const n=e.createDocumentFragment();return n.append(...t),n},Wn=(e,t)=>{const{ownerDocument:n,parentNode:r}=e;r&&r.insertBefore($n(n,t),e)},zn=(e,t)=>{const{ownerDocument:n,parentNode:r}=e;r&&r.insertBefore($n(n,t),Mt(e)[m])},Vn=(e,t)=>{const{ownerDocument:n,parentNode:r}=e;r&&(t.includes(e)&&Vn(e,[e=e.cloneNode()]),r.insertBefore($n(n,t),e),e.remove())},Kn=(e,t,n)=>{const{parentNode:r,nodeType:i}=t;(e||n)&&(Ht(e,n),t[v]=null,Mt(t)[m]=null),r&&(t.parentNode=null,mn(t,r),1===i&&(e=>{if(Wt){Jt(e),$t.has(e)&&(e=$t.get(e).shadowRoot);let{[m]:t,[u]:n}=e;for(;t!==n;)1===t.nodeType&&Jt(t),t=t[m]}})(t))};let Yn=class extends Pn{constructor(e,t,n,r){super(e,t,n),this[A]=jt(r)}get isConnected(){return Fn(this)}get parentElement(){return Un(this)}get previousSibling(){return Bn(this)}get nextSibling(){return Gn(this)}get previousElementSibling(){return Hn(this)}get nextElementSibling(){return qn(this)}before(...e){Wn(this,e)}after(...e){zn(this,e)}replaceWith(...e){Vn(this,e)}remove(){Kn(this[v],this,this[m])}get data(){return this[A]}set data(e){this[A]=jt(e),mn(this,this.parentNode)}get nodeValue(){return this.data}set nodeValue(e){this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}get length(){return this.data.length}substringData(e,t){return this.data.substr(e,t)}appendData(e){this.data+=e}insertData(e,t){const{data:n}=this;this.data=n.slice(0,e)+t+n.slice(e)}deleteData(e,t){const{data:n}=this;this.data=n.slice(0,e)+n.slice(e+t)}replaceData(e,t,n){const{data:r}=this;this.data=r.slice(0,e)+n+r.slice(e+t)}toJSON(){const e=[];return un(this,e),e}},Qn=class e extends Yn{constructor(e,t=""){super(e,"#cdatasection",4,t)}cloneNode(){const{ownerDocument:t,[A]:n}=this;return new e(t,n)}toString(){return`<![CDATA[${this[A]}]]>`}},Xn=class e extends Yn{constructor(e,t=""){super(e,"#comment",8,t)}cloneNode(){const{ownerDocument:t,[A]:n}=this;return new e(t,n)}toString(){return`\x3c!--${this[A]}--\x3e`}};function Jn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Zn,er,tr=Jn({trueFunc:function(){return!0},falseFunc:function(){return!1}});!function(e){e.Attribute="attribute",e.Pseudo="pseudo",e.PseudoElement="pseudo-element",e.Tag="tag",e.Universal="universal",e.Adjacent="adjacent",e.Child="child",e.Descendant="descendant",e.Parent="parent",e.Sibling="sibling",e.ColumnCombinator="column-combinator"}(Zn||(Zn={})),function(e){e.Any="any",e.Element="element",e.End="end",e.Equals="equals",e.Exists="exists",e.Hyphen="hyphen",e.Not="not",e.Start="start"}(er||(er={}));const nr=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,rr=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,ir=new Map([[126,er.Element],[94,er.Start],[36,er.End],[42,er.Any],[33,er.Not],[124,er.Hyphen]]),or=new Set(["has","not","matches","is","where","host","host-context"]);const sr=new Set(["contains","icontains"]);function ar(e,t,n){const r=parseInt(t,16)-65536;return r!=r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)}function cr(e){return e.replace(rr,ar)}function lr(e){return 39===e||34===e}function ur(e){return 32===e||9===e||10===e||12===e||13===e}function dr(e){const t=[],n=hr(t,`${e}`,0);if(n<e.length)throw new Error(`Unmatched selector: ${e.slice(n)}`);return t}function hr(e,t,n){let r=[];function i(e){const r=t.slice(n+e).match(nr);if(!r)throw new Error(`Expected name, found ${t.slice(n)}`);const[i]=r;return n+=e+i.length,cr(i)}function o(e){for(n+=e;n<t.length&&ur(t.charCodeAt(n));)n++}function s(){const e=n+=1;let r=1;for(;r>0&&n<t.length;n++)40!==t.charCodeAt(n)||a(n)?41!==t.charCodeAt(n)||a(n)||r--:r++;if(r)throw new Error("Parenthesis not matched");return cr(t.slice(e,n-1))}function a(e){let n=0;for(;92===t.charCodeAt(--e);)n++;return!(1&~n)}function c(){if(r.length>0&&function(e){switch(e.type){case Zn.Adjacent:case Zn.Child:case Zn.Descendant:case Zn.Parent:case Zn.Sibling:case Zn.ColumnCombinator:return!0;default:return!1}}(r[r.length-1]))throw new Error("Did not expect successive traversals.")}function l(e){r.length>0&&r[r.length-1].type===Zn.Descendant?r[r.length-1].type=e:(c(),r.push({type:e}))}function u(e,t){r.push({type:Zn.Attribute,name:e,action:t,value:i(1),namespace:null,ignoreCase:"quirks"})}function d(){if(r.length&&r[r.length-1].type===Zn.Descendant&&r.pop(),0===r.length)throw new Error("Empty sub-selector");e.push(r)}if(o(0),t.length===n)return n;e:for(;n<t.length;){const e=t.charCodeAt(n);switch(e){case 32:case 9:case 10:case 12:case 13:0!==r.length&&r[0].type===Zn.Descendant||(c(),r.push({type:Zn.Descendant})),o(1);break;case 62:l(Zn.Child),o(1);break;case 60:l(Zn.Parent),o(1);break;case 126:l(Zn.Sibling),o(1);break;case 43:l(Zn.Adjacent),o(1);break;case 46:u("class",er.Element);break;case 35:u("id",er.Equals);break;case 91:{let e;o(1);let s=null;124===t.charCodeAt(n)?e=i(1):t.startsWith("*|",n)?(s="*",e=i(2)):(e=i(0),124===t.charCodeAt(n)&&61!==t.charCodeAt(n+1)&&(s=e,e=i(1))),o(0);let c=er.Exists;const l=ir.get(t.charCodeAt(n));if(l){if(c=l,61!==t.charCodeAt(n+1))throw new Error("Expected `=`");o(2)}else 61===t.charCodeAt(n)&&(c=er.Equals,o(1));let u="",d=null;if("exists"!==c){if(lr(t.charCodeAt(n))){const e=t.charCodeAt(n);let r=n+1;for(;r<t.length&&(t.charCodeAt(r)!==e||a(r));)r+=1;if(t.charCodeAt(r)!==e)throw new Error("Attribute value didn't end");u=cr(t.slice(n+1,r)),n=r+1}else{const e=n;for(;n<t.length&&(!ur(t.charCodeAt(n))&&93!==t.charCodeAt(n)||a(n));)n+=1;u=cr(t.slice(e,n))}o(0);const e=32|t.charCodeAt(n);115===e?(d=!1,o(1)):105===e&&(d=!0,o(1))}if(93!==t.charCodeAt(n))throw new Error("Attribute selector didn't terminate");n+=1;const h={type:Zn.Attribute,name:e,action:c,value:u,namespace:s,ignoreCase:d};r.push(h);break}case 58:{if(58===t.charCodeAt(n+1)){r.push({type:Zn.PseudoElement,name:i(2).toLowerCase(),data:40===t.charCodeAt(n)?s():null});continue}const e=i(1).toLowerCase();let o=null;if(40===t.charCodeAt(n))if(or.has(e)){if(lr(t.charCodeAt(n+1)))throw new Error(`Pseudo-selector ${e} cannot be quoted`);if(o=[],n=hr(o,t,n+1),41!==t.charCodeAt(n))throw new Error(`Missing closing parenthesis in :${e} (${t})`);n+=1}else{if(o=s(),sr.has(e)){const e=o.charCodeAt(0);e===o.charCodeAt(o.length-1)&&lr(e)&&(o=o.slice(1,-1))}o=cr(o)}r.push({type:Zn.Pseudo,name:e,data:o});break}case 44:d(),r=[],o(1);break;default:{if(t.startsWith("/*",n)){const e=t.indexOf("*/",n+2);if(e<0)throw new Error("Comment was not terminated");n=e+2,0===r.length&&o(0);break}let s,a=null;if(42===e)n+=1,s="*";else if(124===e){if(s="",124===t.charCodeAt(n+1)){l(Zn.ColumnCombinator),o(2);break}}else{if(!nr.test(t.slice(n)))break e;s=i(0)}124===t.charCodeAt(n)&&124!==t.charCodeAt(n+1)&&(a=s,42===t.charCodeAt(n+1)?(s="*",n+=2):s=i(1)),r.push("*"===s?{type:Zn.Universal,namespace:a}:{type:Zn.Tag,name:s,namespace:a})}}}return d(),n}const fr=new Map([[Zn.Universal,50],[Zn.Tag,30],[Zn.Attribute,1],[Zn.Pseudo,0]]);function pr(e){return!fr.has(e.type)}const gr=new Map([[er.Exists,10],[er.Equals,8],[er.Not,7],[er.Start,6],[er.End,6],[er.Any,5]]);function mr(e){const t=e.map(yr);for(let n=1;n<e.length;n++){const r=t[n];if(!(r<0))for(let i=n-1;i>=0&&r<t[i];i--){const n=e[i+1];e[i+1]=e[i],e[i]=n,t[i+1]=t[i],t[i]=r}}}function yr(e){var t,n;let r=null!==(t=fr.get(e.type))&&void 0!==t?t:-1;return e.type===Zn.Attribute?(r=null!==(n=gr.get(e.action))&&void 0!==n?n:4,e.action===er.Equals&&"id"===e.name&&(r=9),e.ignoreCase&&(r>>=1)):e.type===Zn.Pseudo&&(e.data?"has"===e.name||"contains"===e.name?r=0:Array.isArray(e.data)?(r=Math.min(...e.data.map((e=>Math.min(...e.map(yr))))),r<0&&(r=0)):r=2:r=3),r}const vr=/[-[\]{}()*+?.,\\^$|#\s]/g;function br(e){return e.replace(vr,"\\$&")}const _r=new Set(["accept","accept-charset","align","alink","axis","bgcolor","charset","checked","clear","codetype","color","compact","declare","defer","dir","direction","disabled","enctype","face","frame","hreflang","http-equiv","lang","language","link","media","method","multiple","nohref","noresize","noshade","nowrap","readonly","rel","rev","rules","scope","scrolling","selected","shape","target","text","type","valign","valuetype","vlink"]);function wr(e,t){return"boolean"==typeof e.ignoreCase?e.ignoreCase:"quirks"===e.ignoreCase?!!t.quirksMode:!t.xmlMode&&_r.has(e.name)}const Tr={equals(e,t,n){const{adapter:r}=n,{name:i}=t;let{value:o}=t;return wr(t,n)?(o=o.toLowerCase(),t=>{const n=r.getAttributeValue(t,i);return null!=n&&n.length===o.length&&n.toLowerCase()===o&&e(t)}):t=>r.getAttributeValue(t,i)===o&&e(t)},hyphen(e,t,n){const{adapter:r}=n,{name:i}=t;let{value:o}=t;const s=o.length;return wr(t,n)?(o=o.toLowerCase(),function(t){const n=r.getAttributeValue(t,i);return null!=n&&(n.length===s||"-"===n.charAt(s))&&n.substr(0,s).toLowerCase()===o&&e(t)}):function(t){const n=r.getAttributeValue(t,i);return null!=n&&(n.length===s||"-"===n.charAt(s))&&n.substr(0,s)===o&&e(t)}},element(e,t,n){const{adapter:r}=n,{name:i,value:o}=t;if(/\s/.test(o))return tr.falseFunc;const s=new RegExp(`(?:^|\\s)${br(o)}(?:$|\\s)`,wr(t,n)?"i":"");return function(t){const n=r.getAttributeValue(t,i);return null!=n&&n.length>=o.length&&s.test(n)&&e(t)}},exists:(e,{name:t},{adapter:n})=>r=>n.hasAttrib(r,t)&&e(r),start(e,t,n){const{adapter:r}=n,{name:i}=t;let{value:o}=t;const s=o.length;return 0===s?tr.falseFunc:wr(t,n)?(o=o.toLowerCase(),t=>{const n=r.getAttributeValue(t,i);return null!=n&&n.length>=s&&n.substr(0,s).toLowerCase()===o&&e(t)}):t=>{var n;return!!(null===(n=r.getAttributeValue(t,i))||void 0===n?void 0:n.startsWith(o))&&e(t)}},end(e,t,n){const{adapter:r}=n,{name:i}=t;let{value:o}=t;const s=-o.length;return 0===s?tr.falseFunc:wr(t,n)?(o=o.toLowerCase(),t=>{var n;return(null===(n=r.getAttributeValue(t,i))||void 0===n?void 0:n.substr(s).toLowerCase())===o&&e(t)}):t=>{var n;return!!(null===(n=r.getAttributeValue(t,i))||void 0===n?void 0:n.endsWith(o))&&e(t)}},any(e,t,n){const{adapter:r}=n,{name:i,value:o}=t;if(""===o)return tr.falseFunc;if(wr(t,n)){const t=new RegExp(br(o),"i");return function(n){const s=r.getAttributeValue(n,i);return null!=s&&s.length>=o.length&&t.test(s)&&e(n)}}return t=>{var n;return!!(null===(n=r.getAttributeValue(t,i))||void 0===n?void 0:n.includes(o))&&e(t)}},not(e,t,n){const{adapter:r}=n,{name:i}=t;let{value:o}=t;return""===o?t=>!!r.getAttributeValue(t,i)&&e(t):wr(t,n)?(o=o.toLowerCase(),t=>{const n=r.getAttributeValue(t,i);return(null==n||n.length!==o.length||n.toLowerCase()!==o)&&e(t)}):t=>r.getAttributeValue(t,i)!==o&&e(t)}},Er=new Set([9,10,12,13,32]),Ar="0".charCodeAt(0),Sr="9".charCodeAt(0);function Or(e){return function(e){const t=e[0],n=e[1]-1;if(n<0&&t<=0)return tr.falseFunc;if(-1===t)return e=>e<=n;if(0===t)return e=>e===n;if(1===t)return n<0?tr.trueFunc:e=>e>=n;const r=Math.abs(t),i=(n%r+r)%r;return t>1?e=>e>=n&&e%r===i:e=>e<=n&&e%r===i}(function(e){if("even"===(e=e.trim().toLowerCase()))return[2,0];if("odd"===e)return[2,1];let t=0,n=0,r=o(),i=s();if(t<e.length&&"n"===e.charAt(t)&&(t++,n=r*(null!=i?i:1),a(),t<e.length?(r=o(),a(),i=s()):r=i=0),null===i||t<e.length)throw new Error(`n-th rule couldn't be parsed ('${e}')`);return[n,r*i];function o(){return"-"===e.charAt(t)?(t++,-1):("+"===e.charAt(t)&&t++,1)}function s(){const n=t;let r=0;for(;t<e.length&&e.charCodeAt(t)>=Ar&&e.charCodeAt(t)<=Sr;)r=10*r+(e.charCodeAt(t)-Ar),t++;return t===n?null:r}function a(){for(;t<e.length&&Er.has(e.charCodeAt(t));)t++}}(e))}function Ir(e,t){return n=>{const r=t.getParent(n);return null!=r&&t.isTag(r)&&e(n)}}const Cr={contains:(e,t,{adapter:n})=>function(r){return e(r)&&n.getText(r).includes(t)},icontains(e,t,{adapter:n}){const r=t.toLowerCase();return function(t){return e(t)&&n.getText(t).toLowerCase().includes(r)}},"nth-child"(e,t,{adapter:n,equals:r}){const i=Or(t);return i===tr.falseFunc?tr.falseFunc:i===tr.trueFunc?Ir(e,n):function(t){const o=n.getSiblings(t);let s=0;for(let e=0;e<o.length&&!r(t,o[e]);e++)n.isTag(o[e])&&s++;return i(s)&&e(t)}},"nth-last-child"(e,t,{adapter:n,equals:r}){const i=Or(t);return i===tr.falseFunc?tr.falseFunc:i===tr.trueFunc?Ir(e,n):function(t){const o=n.getSiblings(t);let s=0;for(let e=o.length-1;e>=0&&!r(t,o[e]);e--)n.isTag(o[e])&&s++;return i(s)&&e(t)}},"nth-of-type"(e,t,{adapter:n,equals:r}){const i=Or(t);return i===tr.falseFunc?tr.falseFunc:i===tr.trueFunc?Ir(e,n):function(t){const o=n.getSiblings(t);let s=0;for(let e=0;e<o.length;e++){const i=o[e];if(r(t,i))break;n.isTag(i)&&n.getName(i)===n.getName(t)&&s++}return i(s)&&e(t)}},"nth-last-of-type"(e,t,{adapter:n,equals:r}){const i=Or(t);return i===tr.falseFunc?tr.falseFunc:i===tr.trueFunc?Ir(e,n):function(t){const o=n.getSiblings(t);let s=0;for(let e=o.length-1;e>=0;e--){const i=o[e];if(r(t,i))break;n.isTag(i)&&n.getName(i)===n.getName(t)&&s++}return i(s)&&e(t)}},root:(e,t,{adapter:n})=>t=>{const r=n.getParent(t);return(null==r||!n.isTag(r))&&e(t)},scope(e,t,n,r){const{equals:i}=n;return r&&0!==r.length?1===r.length?t=>i(r[0],t)&&e(t):t=>r.includes(t)&&e(t):Cr.root(e,t,n)},hover:kr("isHovered"),visited:kr("isVisited"),active:kr("isActive")};function kr(e){return function(t,n,{adapter:r}){const i=r[e];return"function"!=typeof i?tr.falseFunc:function(e){return i(e)&&t(e)}}}const Pr={empty:(e,{adapter:t})=>!t.getChildren(e).some((e=>t.isTag(e)||""!==t.getText(e))),"first-child"(e,{adapter:t,equals:n}){if(t.prevElementSibling)return null==t.prevElementSibling(e);const r=t.getSiblings(e).find((e=>t.isTag(e)));return null!=r&&n(e,r)},"last-child"(e,{adapter:t,equals:n}){const r=t.getSiblings(e);for(let i=r.length-1;i>=0;i--){if(n(e,r[i]))return!0;if(t.isTag(r[i]))break}return!1},"first-of-type"(e,{adapter:t,equals:n}){const r=t.getSiblings(e),i=t.getName(e);for(let o=0;o<r.length;o++){const s=r[o];if(n(e,s))return!0;if(t.isTag(s)&&t.getName(s)===i)break}return!1},"last-of-type"(e,{adapter:t,equals:n}){const r=t.getSiblings(e),i=t.getName(e);for(let o=r.length-1;o>=0;o--){const s=r[o];if(n(e,s))return!0;if(t.isTag(s)&&t.getName(s)===i)break}return!1},"only-of-type"(e,{adapter:t,equals:n}){const r=t.getName(e);return t.getSiblings(e).every((i=>n(e,i)||!t.isTag(i)||t.getName(i)!==r))},"only-child":(e,{adapter:t,equals:n})=>t.getSiblings(e).every((r=>n(e,r)||!t.isTag(r)))};function xr(e,t,n,r){if(null===n){if(e.length>r)throw new Error(`Pseudo-class :${t} requires an argument`)}else if(e.length===r)throw new Error(`Pseudo-class :${t} doesn't have any arguments`)}const Rr={"any-link":":is(a, area, link)[href]",link:":any-link:not(:visited)",disabled:":is(\n        :is(button, input, select, textarea, optgroup, option)[disabled],\n        optgroup[disabled] > option,\n        fieldset[disabled]:not(fieldset[disabled] legend:first-of-type *)\n    )",enabled:":not(:disabled)",checked:":is(:is(input[type=radio], input[type=checkbox])[checked], option:selected)",required:":is(input, select, textarea)[required]",optional:":is(input, select, textarea):not([required])",selected:"option:is([selected], select:not([multiple]):not(:has(> option[selected])) > :first-of-type)",checkbox:"[type=checkbox]",file:"[type=file]",password:"[type=password]",radio:"[type=radio]",reset:"[type=reset]",image:"[type=image]",submit:"[type=submit]",parent:":not(:empty)",header:":is(h1, h2, h3, h4, h5, h6)",button:":is(button, input[type=button])",input:":is(input, textarea, select, button)",text:"input:is(:not([type!='']), [type=text])"},Lr={};function Dr(e,t){return e===tr.falseFunc?tr.falseFunc:n=>t.isTag(n)&&e(n)}function Nr(e,t){const n=t.getSiblings(e);if(n.length<=1)return[];const r=n.indexOf(e);return r<0||r===n.length-1?[]:n.slice(r+1).filter(t.isTag)}function jr(e){return{xmlMode:!!e.xmlMode,lowerCaseAttributeNames:!!e.lowerCaseAttributeNames,lowerCaseTags:!!e.lowerCaseTags,quirksMode:!!e.quirksMode,cacheResults:!!e.cacheResults,pseudos:e.pseudos,adapter:e.adapter,equals:e.equals}}const Mr=(e,t,n,r,i)=>{const o=i(t,jr(n),r);return o===tr.trueFunc?e:o===tr.falseFunc?tr.falseFunc:t=>o(t)&&e(t)},Fr={is:Mr,matches:Mr,where:Mr,not(e,t,n,r,i){const o=i(t,jr(n),r);return o===tr.falseFunc?e:o===tr.trueFunc?tr.falseFunc:t=>!o(t)&&e(t)},has(e,t,n,r,i){const{adapter:o}=n,s=jr(n);s.relativeSelector=!0;const a=t.some((e=>e.some(pr)))?[Lr]:void 0,c=i(t,s,a);if(c===tr.falseFunc)return tr.falseFunc;const l=Dr(c,o);if(a&&c!==tr.trueFunc){const{shouldTestNextSiblings:t=!1}=c;return n=>{if(!e(n))return!1;a[0]=n;const r=o.getChildren(n),i=t?[...r,...Nr(n,o)]:r;return o.existsOne(l,i)}}return t=>e(t)&&o.existsOne(l,o.getChildren(t))}};function Ur(e,t){const n=t.getParent(e);return n&&t.isTag(n)?n:null}function Br(e,t,n,r,i){const{adapter:o,equals:s}=n;switch(t.type){case Zn.PseudoElement:throw new Error("Pseudo-elements are not supported by css-select");case Zn.ColumnCombinator:throw new Error("Column combinators are not yet supported by css-select");case Zn.Attribute:if(null!=t.namespace)throw new Error("Namespaced attributes are not yet supported by css-select");return n.xmlMode&&!n.lowerCaseAttributeNames||(t.name=t.name.toLowerCase()),Tr[t.action](e,t,n);case Zn.Pseudo:return function(e,t,n,r,i){var o;const{name:s,data:a}=t;if(Array.isArray(a)){if(!(s in Fr))throw new Error(`Unknown pseudo-class :${s}(${a})`);return Fr[s](e,a,n,r,i)}const c=null===(o=n.pseudos)||void 0===o?void 0:o[s],l="string"==typeof c?c:Rr[s];if("string"==typeof l){if(null!=a)throw new Error(`Pseudo ${s} doesn't have any arguments`);const t=dr(l);return Fr.is(e,t,n,r,i)}if("function"==typeof c)return xr(c,s,a,1),t=>c(t,a)&&e(t);if(s in Cr)return Cr[s](e,a,n,r);if(s in Pr){const t=Pr[s];return xr(t,s,a,2),r=>t(r,n,a)&&e(r)}throw new Error(`Unknown pseudo-class :${s}`)}(e,t,n,r,i);case Zn.Tag:{if(null!=t.namespace)throw new Error("Namespaced tag names are not yet supported by css-select");let{name:r}=t;return n.xmlMode&&!n.lowerCaseTags||(r=r.toLowerCase()),function(t){return o.getName(t)===r&&e(t)}}case Zn.Descendant:{if(!1===n.cacheResults||"undefined"==typeof WeakSet)return function(t){let n=t;for(;n=Ur(n,o);)if(e(n))return!0;return!1};const t=new WeakSet;return function(n){let r=n;for(;r=Ur(r,o);)if(!t.has(r)){if(o.isTag(r)&&e(r))return!0;t.add(r)}return!1}}case"_flexibleDescendant":return function(t){let n=t;do{if(e(n))return!0}while(n=Ur(n,o));return!1};case Zn.Parent:return function(t){return o.getChildren(t).some((t=>o.isTag(t)&&e(t)))};case Zn.Child:return function(t){const n=o.getParent(t);return null!=n&&o.isTag(n)&&e(n)};case Zn.Sibling:return function(t){const n=o.getSiblings(t);for(let r=0;r<n.length;r++){const i=n[r];if(s(t,i))break;if(o.isTag(i)&&e(i))return!0}return!1};case Zn.Adjacent:return o.prevElementSibling?function(t){const n=o.prevElementSibling(t);return null!=n&&e(n)}:function(t){const n=o.getSiblings(t);let r;for(let e=0;e<n.length;e++){const i=n[e];if(s(t,i))break;o.isTag(i)&&(r=i)}return!!r&&e(r)};case Zn.Universal:if(null!=t.namespace&&"*"!==t.namespace)throw new Error("Namespaced universal selectors are not yet supported by css-select");return e}}function Gr(e,t,n){const r=function(e,t,n){const r="string"==typeof e?dr(e):e;return zr(r,t,n)}(e,t,n);return Dr(r,t.adapter)}function qr(e){return e.type===Zn.Pseudo&&("scope"===e.name||Array.isArray(e.data)&&e.data.some((e=>e.some(qr))))}const Hr={type:Zn.Descendant},$r={type:"_flexibleDescendant"},Wr={type:Zn.Pseudo,name:"scope",data:null};function zr(e,t,n){var r;e.forEach(mr),n=null!==(r=t.context)&&void 0!==r?r:n;const i=Array.isArray(n),o=n&&(Array.isArray(n)?n:[n]);if(!1!==t.relativeSelector)!function(e,{adapter:t},n){const r=!!(null==n?void 0:n.every((e=>{const n=t.isTag(e)&&t.getParent(e);return e===Lr||n&&t.isTag(n)})));for(const t of e){if(t.length>0&&pr(t[0])&&t[0].type!==Zn.Descendant);else{if(!r||t.some(qr))continue;t.unshift(Hr)}t.unshift(Wr)}}(e,t,o);else if(e.some((e=>e.length>0&&pr(e[0]))))throw new Error("Relative selectors are not allowed when the `relativeSelector` option is disabled");let s=!1;const a=e.map((e=>{if(e.length>=2){const[t,n]=e;t.type!==Zn.Pseudo||"scope"!==t.name||(i&&n.type===Zn.Descendant?e[1]=$r:n.type!==Zn.Adjacent&&n.type!==Zn.Sibling||(s=!0))}return function(e,t,n){var r;return e.reduce(((e,r)=>e===tr.falseFunc?tr.falseFunc:Br(e,r,t,n,zr)),null!==(r=t.rootFunc)&&void 0!==r?r:tr.trueFunc)}(e,t,o)})).reduce(Vr,tr.falseFunc);return a.shouldTestNextSiblings=s,a}function Vr(e,t){return t===tr.falseFunc||e===tr.trueFunc?e:e===tr.falseFunc||t===tr.trueFunc?t:function(n){return e(n)||t(n)}}const Kr=(e,t)=>e===t,Yr={adapter:bt,equals:Kr};function Qr(e){var t,n,r,i;const o=null!=e?e:Yr;return null!==(t=o.adapter)&&void 0!==t||(o.adapter=bt),null!==(n=o.equals)&&void 0!==n||(o.equals=null!==(i=null===(r=o.adapter)||void 0===r?void 0:r.equals)&&void 0!==i?i:Kr),o}const Xr=(Jr=Gr,function(e,t,n){const r=Qr(t);return Jr(e,r,n)});var Jr;const{isArray:Zr}=Array,ei=({nodeType:e})=>1===e,ti=(e,t)=>t.some((t=>ei(t)&&(e(t)||ti(e,ni(t))))),ni=({childNodes:e})=>e,ri=e=>Zr(e)?e.map(ri).join(""):ei(e)?ri(ni(e)):3===e.nodeType?e.data:"",ii=(e,t)=>{const n=[];for(const r of t)ei(r)&&(e(r)&&n.push(r),n.push(...ii(e,ni(r))));return n},oi=(e,t)=>{for(let n of t)if(e(n)||(n=oi(e,ni(n))))return n;return null},si={isTag:ei,existsOne:ti,getAttributeValue:(e,t)=>"class"===t?e.classList.value:e.getAttribute(t),getChildren:ni,getName:e=>{const{localName:t}=e;return Ft(e)?t.toLowerCase():t},getParent:({parentNode:e})=>e,getSiblings:e=>{const{parentNode:t}=e;return t?ni(t):e},getText:ri,hasAttrib:(e,t)=>e.hasAttribute(t),removeSubsets:e=>{let{length:t}=e;for(;t--;){const n=e[t];if(t&&-1<e.lastIndexOf(n,t-1))e.splice(t,1);else for(let{parentNode:r}=n;r;r=r.parentNode)if(e.includes(r)){e.splice(t,1);break}}return e},findAll:ii,findOne:oi},ai=(e,t)=>Xr(t,{context:t.includes(":scope")?e:void 0,xmlMode:!Ft(e),adapter:si}),ci=(e,t)=>function(e,t,n){const r=Qr(n);return("function"==typeof t?t:Gr(t,r))(e)}(e,t,{strict:!0,context:t.includes(":scope")?e:void 0,xmlMode:!Ft(e),adapter:si});let li=class e extends Yn{constructor(e,t=""){super(e,"#text",3,t)}get wholeText(){const e=[];let{previousSibling:t,nextSibling:n}=this;for(;t&&3===t.nodeType;)e.unshift(t[A]),t=t.previousSibling;for(e.push(this[A]);n&&3===n.nodeType;)e.push(n[A]),n=n.nextSibling;return e.join("")}cloneNode(){const{ownerDocument:t,[A]:n}=this;return new e(t,n)}toString(){return Nn(this[A])}};const ui=e=>e instanceof Pn,di=(e,t,n)=>{const{ownerDocument:r}=e;for(const i of n)e.insertBefore(ui(i)?i:new li(r,i),t)};class hi extends Pn{constructor(e,t,n){super(e,t,n),this[b]=null,this[m]=this[u]={[m]:null,[v]:this,[w]:this,nodeType:At,ownerDocument:this.ownerDocument,parentNode:null}}get childNodes(){const e=new Cn;let{firstChild:t}=this;for(;t;)e.push(t),t=Gn(t);return e}get children(){const e=new Cn;let{firstElementChild:t}=this;for(;t;)e.push(t),t=qn(t);return e}get firstChild(){let{[m]:e,[u]:t}=this;for(;2===e.nodeType;)e=e[m];return e===t?null:e}get firstElementChild(){let{firstChild:e}=this;for(;e;){if(1===e.nodeType)return e;e=Gn(e)}return null}get lastChild(){const e=this[u][v];switch(e.nodeType){case At:return e[w];case 2:return null}return e===this?null:e}get lastElementChild(){let{lastChild:e}=this;for(;e;){if(1===e.nodeType)return e;e=Bn(e)}return null}get childElementCount(){return this.children.length}prepend(...e){di(this,this.firstChild,e)}append(...e){di(this,this[u],e)}replaceChildren(...e){let{[m]:t,[u]:n}=this;for(;t!==n&&2===t.nodeType;)t=t[m];for(;t!==n;){const e=Mt(t)[m];t.remove(),t=e}e.length&&di(this,n,e)}getElementsByClassName(e){const t=new Cn;let{[m]:n,[u]:r}=this;for(;n!==r;)1===n.nodeType&&n.hasAttribute("class")&&n.classList.has(e)&&t.push(n),n=n[m];return t}getElementsByTagName(e){const t=new Cn;let{[m]:n,[u]:r}=this;for(;n!==r;)1!==n.nodeType||n.localName!==e&&qt(n)!==e||t.push(n),n=n[m];return t}querySelector(e){const t=ai(this,e);let{[m]:n,[u]:r}=this;for(;n!==r;){if(1===n.nodeType&&t(n))return n;n=1===n.nodeType&&"template"===n.localName?n[u]:n[m]}return null}querySelectorAll(e){const t=ai(this,e),n=new Cn;let{[m]:r,[u]:i}=this;for(;r!==i;)1===r.nodeType&&t(r)&&n.push(r),r=1===r.nodeType&&"template"===r.localName?r[u]:r[m];return n}appendChild(e){return this.insertBefore(e,this[u])}contains(e){let t=e;for(;t&&t!==this;)t=t.parentNode;return t===this}insertBefore(e,t=null){if(e===t)return e;if(e===this)throw new Error("unable to append a node to itself");const n=t||this[u];switch(e.nodeType){case 1:e.remove(),e.parentNode=this,Bt(n[v],e,n),mn(e,null),Xt(e);break;case Ot:{let{[b]:t,firstChild:r,lastChild:i}=e;if(r){((e,t,n,r)=>{Ut(e,t),Ut(Mt(n),r)})(n[v],r,i,n),Ut(e,e[u]),t&&t.replaceChildren();do{r.parentNode=this,mn(r,null),1===r.nodeType&&Xt(r)}while(r!==i&&(r=Gn(r)))}break}case 3:case 8:case 4:e.remove();default:e.parentNode=this,Gt(n[v],e,n),mn(e,null)}return e}normalize(){let{[m]:e,[u]:t}=this;for(;e!==t;){const{[m]:t,[v]:n,nodeType:r}=e;3===r&&(e[A]?n&&3===n.nodeType&&(n.textContent+=e.textContent,e.remove()):e.remove()),e=t}}removeChild(e){if(e.parentNode!==this)throw new Error("node is not a child");return e.remove(),e}replaceChild(e,t){const n=Mt(t)[m];return t.remove(),this.insertBefore(e,n),t}}class fi extends hi{getElementById(e){let{[m]:t,[u]:n}=this;for(;t!==n;){if(1===t.nodeType&&t.id===e)return t;t=t[m]}return null}cloneNode(e){const{ownerDocument:t,constructor:n}=this,r=new n(t);if(e){const{[u]:t}=r;for(const n of this.childNodes)r.insertBefore(n.cloneNode(e),t)}return r}toString(){const{childNodes:e,localName:t}=this;return`<${t}>${e.join("")}</${t}>`}toJSON(){const e=[];return((e,t)=>{t.push(e.nodeType),cn(e,t)})(this,e),e}}let pi=class extends fi{constructor(e){super(e,"#document-fragment",Ot)}},gi=class e extends Pn{constructor(e,t,n="",r=""){super(e,"#document-type",St),this.name=t,this.publicId=n,this.systemId=r}cloneNode(){const{ownerDocument:t,name:n,publicId:r,systemId:i}=this;return new e(t,n,r,i)}toString(){const{name:e,publicId:t,systemId:n}=this,r=0<t.length,i=[e];return r&&i.push("PUBLIC",`"${t}"`),n.length&&(r||i.push("SYSTEM"),i.push(`"${n}"`)),`<!DOCTYPE ${i.join(" ")}>`}toJSON(){const e=[];return dn(this,e),e}};const mi=e=>e.childNodes.join(""),yi=(e,t)=>{const{ownerDocument:n}=e,{constructor:r}=n,i=new r;i[o]=n[o];const{childNodes:s}=rn(i,Ft(e),t);e.replaceChildren(...s.map(vi,n))};function vi(e){switch(e.ownerDocument=this,e.nodeType){case 1:case Ot:e.childNodes.forEach(vi,this)}return e}var bi=e=>e.replace(/(([A-Z0-9])([A-Z0-9][a-z]))|(([a-z0-9]+)([A-Z]))/g,"$2$5-$3$6").toLowerCase();const _i=new WeakMap,wi=e=>`data-${bi(e)}`,Ti=e=>e.slice(5).replace(/-([a-z])/g,((e,t)=>t.toUpperCase())),Ei={get(e,t){if(t in e)return _i.get(e).getAttribute(wi(t))},set:(e,t,n)=>(e[t]=n,_i.get(e).setAttribute(wi(t),n),!0),deleteProperty:(e,t)=>(t in e&&_i.get(e).removeAttribute(wi(t)),delete e[t])};class Ai{constructor(e){for(const{name:t,value:n}of e.attributes)/^data-/.test(t)&&(this[Ti(t)]=n);return _i.set(this,e),new Proxy(this,Ei)}}Nt(Ai.prototype,null);const{add:Si}=Set.prototype,Oi=(e,t)=>{for(const n of t)n&&Si.call(e,n)},Ii=({[y]:e,value:t})=>{const n=e.getAttributeNode("class");n?n.value=t:bn(e,new Mn(e.ownerDocument,"class",t))};class Ci extends Set{constructor(e){super(),this[y]=e;const t=e.getAttributeNode("class");t&&Oi(this,t.value.split(/\s+/))}get length(){return this.size}get value(){return[...this].join(" ")}add(...e){Oi(this,e),Ii(this)}contains(e){return this.has(e)}remove(...e){for(const t of e)this.delete(t);Ii(this)}toggle(e,t){if(this.has(e)){if(t)return!0;this.delete(e),Ii(this)}else if(t||1===arguments.length)return super.add(e),Ii(this),!0;return!1}replace(e,t){return!!this.has(e)&&(this.delete(e),super.add(t),Ii(this),!0)}supports(){return!0}}const ki=new WeakMap,Pi=e=>[...e.keys()].filter((e=>e!==b)),xi=e=>{const t=ki.get(e).getAttributeNode("style");if((!t||t[r]||e.get(b)!==t)&&(e.clear(),t)){e.set(b,t);for(const n of t[A].split(/\s*;\s*/)){let[t,...r]=n.split(":");if(r.length>0){t=t.trim();const n=r.join(":").trim();t&&n&&e.set(t,n)}}}return t},Ri={get:(e,t)=>t in Di?e[t]:(xi(e),"length"===t?Pi(e).length:/^\d+$/.test(t)?Pi(e)[t]:e.get(bi(t))),set(e,t,n){if("cssText"===t)e[t]=n;else{let i=xi(e);if(null==n?e.delete(bi(t)):e.set(bi(t),n),!i){const t=ki.get(e);i=t.ownerDocument.createAttribute("style"),t.setAttributeNode(i),e.set(b,i)}i[r]=!1,i[A]=e.toString()}return!0}};let Li=class extends Map{constructor(e){return super(),ki.set(this,e),new Proxy(this,Ri)}get cssText(){return this.toString()}set cssText(e){ki.get(this).setAttribute("style",e)}getPropertyValue(e){const t=this[b];return Ri.get(t,e)}setProperty(e,t){const n=this[b];Ri.set(n,e,t)}removeProperty(e){const t=this[b];Ri.set(t,e,null)}[Symbol.iterator](){const e=this[b];xi(e);const t=Pi(e),{length:n}=t;let r=0;return{next(){const e=r===n;return{done:e,value:e?null:t[r++]}}}}get[b](){return this}toString(){const e=this[b];xi(e);const t=[];return e.forEach(Ni,t),t.join(";")}};const{prototype:Di}=Li;function Ni(e,t){t!==b&&this.push(`${t}:${e}`)}function ji(e){return e.currentTarget}class Mi{static get BUBBLING_PHASE(){return 3}static get AT_TARGET(){return 2}static get CAPTURING_PHASE(){return 1}static get NONE(){return 0}constructor(e,t={}){this.type=e,this.bubbles=!!t.bubbles,this.cancelBubble=!1,this._stopImmediatePropagationFlag=!1,this.cancelable=!!t.cancelable,this.eventPhase=this.NONE,this.timeStamp=Date.now(),this.defaultPrevented=!1,this.originalTarget=null,this.returnValue=null,this.srcElement=null,this.target=null,this._path=[]}get BUBBLING_PHASE(){return 3}get AT_TARGET(){return 2}get CAPTURING_PHASE(){return 1}get NONE(){return 0}preventDefault(){this.defaultPrevented=!0}composedPath(){return this._path.map(ji)}stopPropagation(){this.cancelBubble=!0}stopImmediatePropagation(){this.stopPropagation(),this._stopImmediatePropagationFlag=!0}}class Fi extends Array{constructor(e){super(),this.ownerElement=e}getNamedItem(e){return this.ownerElement.getAttributeNode(e)}setNamedItem(e){this.ownerElement.setAttributeNode(e),this.unshift(e)}removeNamedItem(e){const t=this.getNamedItem(e);this.ownerElement.removeAttribute(e),this.splice(this.indexOf(t),1)}item(e){return e<this.length?this[e]:null}getNamedItemNS(e,t){return this.getNamedItem(t)}setNamedItemNS(e,t){return this.setNamedItem(t)}removeNamedItemNS(e,t){return this.removeNamedItem(t)}}let Ui=class extends fi{constructor(e){super(e.ownerDocument,"#shadow-root",Ot),this.host=e}get innerHTML(){return mi(this)}set innerHTML(e){yi(this,e)}};const Bi={get:(e,t)=>t in e?e[t]:e.find((({name:e})=>e===t))},Gi=(e,t,n)=>{if("ownerSVGElement"in t){const r=e.createElementNS(Ct,n);return r.ownerSVGElement=t.ownerSVGElement,r}return e.createElement(n)},qi=({localName:e,ownerDocument:t})=>t[p].voidElements.test(e);let Hi=class extends hi{constructor(e,t){super(e,t,1),this[i]=null,this[a]=null,this[T]=null}get isConnected(){return Fn(this)}get parentElement(){return Un(this)}get previousSibling(){return Bn(this)}get nextSibling(){return Gn(this)}get namespaceURI(){return"http://www.w3.org/1999/xhtml"}get previousElementSibling(){return Hn(this)}get nextElementSibling(){return qn(this)}before(...e){Wn(this,e)}after(...e){zn(this,e)}replaceWith(...e){Vn(this,e)}remove(){Kn(this[v],this,this[u][m])}get id(){return En.get(this,"id")}set id(e){En.set(this,"id",e)}get className(){return this.classList.value}set className(e){const{classList:t}=this;t.clear(),t.add(...jt(e).split(/\s+/))}get nodeName(){return qt(this)}get tagName(){return qt(this)}get classList(){return this[i]||(this[i]=new Ci(this))}get dataset(){return this[a]||(this[a]=new Ai(this))}getBoundingClientRect(){return{x:0,y:0,bottom:0,height:0,left:0,right:0,top:0,width:0}}get nonce(){return En.get(this,"nonce")}set nonce(e){En.set(this,"nonce",e)}get style(){return this[T]||(this[T]=new Li(this))}get tabIndex(){return Tn.get(this,"tabindex")||-1}set tabIndex(e){Tn.set(this,"tabindex",e)}get slot(){return En.get(this,"slot")}set slot(e){En.set(this,"slot",e)}get innerText(){const e=[];let{[m]:t,[u]:n}=this;for(;t!==n;)3===t.nodeType?e.push(t.textContent.replace(/\s+/g," ")):e.length&&t[m]!=n&&It.has(t.tagName)&&e.push("\n"),t=t[m];return e.join("")}get textContent(){const e=[];let{[m]:t,[u]:n}=this;for(;t!==n;)3===t.nodeType&&e.push(t.textContent),t=t[m];return e.join("")}set textContent(e){this.replaceChildren(),null!=e&&""!==e&&this.appendChild(new li(this.ownerDocument,e))}get innerHTML(){return mi(this)}set innerHTML(e){yi(this,e)}get outerHTML(){return this.toString()}set outerHTML(e){const t=this.ownerDocument.createElement("");t.innerHTML=e,this.replaceWith(...t.childNodes)}get attributes(){const e=new Fi(this);let t=this[m];for(;2===t.nodeType;)e.push(t),t=t[m];return new Proxy(e,Bi)}focus(){this.dispatchEvent(new Mi("focus"))}getAttribute(e){if("class"===e)return this.className;const t=this.getAttributeNode(e);return t&&(Ft(this)?t.value:Nn(t.value))}getAttributeNode(e){let t=this[m];for(;2===t.nodeType;){if(t.name===e)return t;t=t[m]}return null}getAttributeNames(){const e=new Cn;let t=this[m];for(;2===t.nodeType;)e.push(t.name),t=t[m];return e}hasAttribute(e){return!!this.getAttributeNode(e)}hasAttributes(){return 2===this[m].nodeType}removeAttribute(e){"class"===e&&this[i]&&this[i].clear();let t=this[m];for(;2===t.nodeType;){if(t.name===e)return void _n(this,t);t=t[m]}}removeAttributeNode(e){let t=this[m];for(;2===t.nodeType;){if(t===e)return void _n(this,t);t=t[m]}}setAttribute(e,t){if("class"===e)this.className=t;else{const n=this.getAttributeNode(e);n?n.value=t:bn(this,new Mn(this.ownerDocument,e,t))}}setAttributeNode(e){const{name:t}=e,n=this.getAttributeNode(t);if(n!==e){n&&this.removeAttributeNode(n);const{ownerElement:t}=e;t&&t.removeAttributeNode(e),bn(this,e)}return n}toggleAttribute(e,t){return this.hasAttribute(e)?!!t||(this.removeAttribute(e),!1):!(!t&&1!==arguments.length)&&(this.setAttribute(e,""),!0)}get shadowRoot(){if($t.has(this)){const{mode:e,shadowRoot:t}=$t.get(this);if("open"===e)return t}return null}attachShadow(e){if($t.has(this))throw new Error("operation not supported");const t=new Ui(this);return $t.set(this,{mode:e.mode,shadowRoot:t}),t}matches(e){return ci(this,e)}closest(e){let t=this;const n=ai(t,e);for(;t&&!n(t);)t=t.parentElement;return t}insertAdjacentElement(e,t){const{parentElement:n}=this;switch(e){case"beforebegin":if(n){n.insertBefore(t,this);break}return null;case"afterbegin":this.insertBefore(t,this.firstChild);break;case"beforeend":this.insertBefore(t,null);break;case"afterend":if(n){n.insertBefore(t,this.nextSibling);break}return null}return t}insertAdjacentHTML(e,t){const n=this.ownerDocument.createElement("template");n.innerHTML=t,this.insertAdjacentElement(e,n.content)}insertAdjacentText(e,t){const n=this.ownerDocument.createTextNode(t);this.insertAdjacentElement(e,n)}cloneNode(e=!1){const{ownerDocument:t,localName:n}=this,r=e=>{e.parentNode=o,Ut(s,e),s=e},i=Gi(t,this,n);let o=i,s=i,{[m]:a,[u]:c}=this;for(;a!==c&&(e||2===a.nodeType);){switch(a.nodeType){case At:Ut(s,o[u]),s=o[u],o=o.parentNode;break;case 1:{const e=Gi(t,a,a.localName);r(e),o=e;break}case 2:{const t=a.cloneNode(e);t.ownerElement=o,r(t);break}case 3:case 8:case 4:r(a.cloneNode(e))}a=a[m]}return Ut(s,i[u]),i}toString(){const e=[],{[u]:t}=this;let n={[m]:this},r=!1;do{switch(n=n[m],n.nodeType){case 2:{const t=" "+n;switch(t){case" id":case" class":case" style":break;default:e.push(t)}break}case At:{const t=n[w];r?("ownerSVGElement"in t?e.push(" />"):qi(t)?e.push(Ft(t)?">":" />"):e.push(`></${t.localName}>`),r=!1):e.push(`</${t.localName}>`);break}case 1:r&&e.push(">"),n.toString!==this.toString?(e.push(n.toString()),n=n[u],r=!1):(e.push(`<${n.localName}`),r=!0);break;case 3:case 8:case 4:e.push((r?">":"")+n),r=!1}}while(n!==t);return e.join("")}toJSON(){const e=[];return hn(this,e),e}getAttributeNS(e,t){return this.getAttribute(t)}getElementsByTagNameNS(e,t){return this.getElementsByTagName(t)}hasAttributeNS(e,t){return this.hasAttribute(t)}removeAttributeNS(e,t){this.removeAttribute(t)}setAttributeNS(e,t,n){this.setAttribute(t,n)}setAttributeNodeNS(e){return this.setAttributeNode(e)}};const $i=new WeakMap,Wi={get:(e,t)=>e[t],set:(e,t,n)=>(e[t]=n,!0)};let zi=class extends Hi{constructor(e,t,n=null){super(e,t),this.ownerSVGElement=n}get className(){return $i.has(this)||$i.set(this,new Proxy({baseVal:"",animVal:""},Wi)),$i.get(this)}set className(e){const{classList:t}=this;t.clear(),t.add(...jt(e).split(/\s+/))}get namespaceURI(){return"http://www.w3.org/2000/svg"}getAttribute(e){return"class"===e?[...this.classList].join(" "):super.getAttribute(e)}setAttribute(e,t){if("class"===e)this.className=t;else if("style"===e){const{className:e}=this;e.baseVal=e.animVal=t}super.setAttribute(e,t)}};const Vi=()=>{throw new TypeError("Illegal constructor")};function Ki(){Vi()}function Yi(){Vi()}function Qi(){Vi()}function Xi(){Vi()}function Ji(){Vi()}function Zi(){Vi()}function eo(){Vi()}function to(){Vi()}function no(){Vi()}function ro(){Vi()}function io(){Vi()}Nt(Ki,Mn),Ki.prototype=Mn.prototype,Nt(Yi,Qn),Yi.prototype=Qn.prototype,Nt(Qi,Yn),Qi.prototype=Yn.prototype,Nt(Xi,Xn),Xi.prototype=Xn.prototype,Nt(Ji,pi),Ji.prototype=pi.prototype,Nt(Zi,gi),Zi.prototype=gi.prototype,Nt(eo,Hi),eo.prototype=Hi.prototype,Nt(to,Pn),to.prototype=Pn.prototype,Nt(no,Ui),no.prototype=Ui.prototype,Nt(ro,li),ro.prototype=li.prototype,Nt(io,zi),io.prototype=zi.prototype;const oo={Attr:Ki,CDATASection:Yi,CharacterData:Qi,Comment:Xi,DocumentFragment:Ji,DocumentType:Zi,Element:eo,Node:to,ShadowRoot:no,Text:ro,SVGElement:io},so=new WeakMap,ao={get:(e,t)=>so.has(e)&&so.get(e)[t]||null,set(e,t,n){so.has(e)||so.set(e,{});const r=so.get(e),i=t.slice(2);r[t]&&e.removeEventListener(i,r[t],!1),(r[t]=n)&&e.addEventListener(i,n,!1)}};class co extends Hi{static get observedAttributes(){return[]}constructor(e=null,t=""){super(e,t);const n=!e;let r;if(n){const{constructor:n}=this;if(!zt.has(n))throw new Error("unable to initialize this Custom Element");({ownerDocument:e,localName:t,options:r}=zt.get(n))}if(e[E]){const{element:t,values:n}=e[E];e[E]=null;for(const[e,r]of n)t[e]=r;return t}n&&(this.ownerDocument=this[u].ownerDocument=e,this.localName=t,Vt.set(this,{connected:!1}),r.is&&this.setAttribute("is",r.is))}blur(){this.dispatchEvent(new Mi("blur"))}click(){const e=new Mi("click",{bubbles:!0,cancelable:!0});e.button=0,this.dispatchEvent(e)}get accessKeyLabel(){const{accessKey:e}=this;return e&&`Alt+Shift+${e}`}get isContentEditable(){return this.hasAttribute("contenteditable")}get contentEditable(){return wn.get(this,"contenteditable")}set contentEditable(e){wn.set(this,"contenteditable",e)}get draggable(){return wn.get(this,"draggable")}set draggable(e){wn.set(this,"draggable",e)}get hidden(){return wn.get(this,"hidden")}set hidden(e){wn.set(this,"hidden",e)}get spellcheck(){return wn.get(this,"spellcheck")}set spellcheck(e){wn.set(this,"spellcheck",e)}get accessKey(){return En.get(this,"accesskey")}set accessKey(e){En.set(this,"accesskey",e)}get dir(){return En.get(this,"dir")}set dir(e){En.set(this,"dir",e)}get lang(){return En.get(this,"lang")}set lang(e){En.set(this,"lang",e)}get title(){return En.get(this,"title")}set title(e){En.set(this,"title",e)}get onabort(){return ao.get(this,"onabort")}set onabort(e){ao.set(this,"onabort",e)}get onblur(){return ao.get(this,"onblur")}set onblur(e){ao.set(this,"onblur",e)}get oncancel(){return ao.get(this,"oncancel")}set oncancel(e){ao.set(this,"oncancel",e)}get oncanplay(){return ao.get(this,"oncanplay")}set oncanplay(e){ao.set(this,"oncanplay",e)}get oncanplaythrough(){return ao.get(this,"oncanplaythrough")}set oncanplaythrough(e){ao.set(this,"oncanplaythrough",e)}get onchange(){return ao.get(this,"onchange")}set onchange(e){ao.set(this,"onchange",e)}get onclick(){return ao.get(this,"onclick")}set onclick(e){ao.set(this,"onclick",e)}get onclose(){return ao.get(this,"onclose")}set onclose(e){ao.set(this,"onclose",e)}get oncontextmenu(){return ao.get(this,"oncontextmenu")}set oncontextmenu(e){ao.set(this,"oncontextmenu",e)}get oncuechange(){return ao.get(this,"oncuechange")}set oncuechange(e){ao.set(this,"oncuechange",e)}get ondblclick(){return ao.get(this,"ondblclick")}set ondblclick(e){ao.set(this,"ondblclick",e)}get ondrag(){return ao.get(this,"ondrag")}set ondrag(e){ao.set(this,"ondrag",e)}get ondragend(){return ao.get(this,"ondragend")}set ondragend(e){ao.set(this,"ondragend",e)}get ondragenter(){return ao.get(this,"ondragenter")}set ondragenter(e){ao.set(this,"ondragenter",e)}get ondragleave(){return ao.get(this,"ondragleave")}set ondragleave(e){ao.set(this,"ondragleave",e)}get ondragover(){return ao.get(this,"ondragover")}set ondragover(e){ao.set(this,"ondragover",e)}get ondragstart(){return ao.get(this,"ondragstart")}set ondragstart(e){ao.set(this,"ondragstart",e)}get ondrop(){return ao.get(this,"ondrop")}set ondrop(e){ao.set(this,"ondrop",e)}get ondurationchange(){return ao.get(this,"ondurationchange")}set ondurationchange(e){ao.set(this,"ondurationchange",e)}get onemptied(){return ao.get(this,"onemptied")}set onemptied(e){ao.set(this,"onemptied",e)}get onended(){return ao.get(this,"onended")}set onended(e){ao.set(this,"onended",e)}get onerror(){return ao.get(this,"onerror")}set onerror(e){ao.set(this,"onerror",e)}get onfocus(){return ao.get(this,"onfocus")}set onfocus(e){ao.set(this,"onfocus",e)}get oninput(){return ao.get(this,"oninput")}set oninput(e){ao.set(this,"oninput",e)}get oninvalid(){return ao.get(this,"oninvalid")}set oninvalid(e){ao.set(this,"oninvalid",e)}get onkeydown(){return ao.get(this,"onkeydown")}set onkeydown(e){ao.set(this,"onkeydown",e)}get onkeypress(){return ao.get(this,"onkeypress")}set onkeypress(e){ao.set(this,"onkeypress",e)}get onkeyup(){return ao.get(this,"onkeyup")}set onkeyup(e){ao.set(this,"onkeyup",e)}get onload(){return ao.get(this,"onload")}set onload(e){ao.set(this,"onload",e)}get onloadeddata(){return ao.get(this,"onloadeddata")}set onloadeddata(e){ao.set(this,"onloadeddata",e)}get onloadedmetadata(){return ao.get(this,"onloadedmetadata")}set onloadedmetadata(e){ao.set(this,"onloadedmetadata",e)}get onloadstart(){return ao.get(this,"onloadstart")}set onloadstart(e){ao.set(this,"onloadstart",e)}get onmousedown(){return ao.get(this,"onmousedown")}set onmousedown(e){ao.set(this,"onmousedown",e)}get onmouseenter(){return ao.get(this,"onmouseenter")}set onmouseenter(e){ao.set(this,"onmouseenter",e)}get onmouseleave(){return ao.get(this,"onmouseleave")}set onmouseleave(e){ao.set(this,"onmouseleave",e)}get onmousemove(){return ao.get(this,"onmousemove")}set onmousemove(e){ao.set(this,"onmousemove",e)}get onmouseout(){return ao.get(this,"onmouseout")}set onmouseout(e){ao.set(this,"onmouseout",e)}get onmouseover(){return ao.get(this,"onmouseover")}set onmouseover(e){ao.set(this,"onmouseover",e)}get onmouseup(){return ao.get(this,"onmouseup")}set onmouseup(e){ao.set(this,"onmouseup",e)}get onmousewheel(){return ao.get(this,"onmousewheel")}set onmousewheel(e){ao.set(this,"onmousewheel",e)}get onpause(){return ao.get(this,"onpause")}set onpause(e){ao.set(this,"onpause",e)}get onplay(){return ao.get(this,"onplay")}set onplay(e){ao.set(this,"onplay",e)}get onplaying(){return ao.get(this,"onplaying")}set onplaying(e){ao.set(this,"onplaying",e)}get onprogress(){return ao.get(this,"onprogress")}set onprogress(e){ao.set(this,"onprogress",e)}get onratechange(){return ao.get(this,"onratechange")}set onratechange(e){ao.set(this,"onratechange",e)}get onreset(){return ao.get(this,"onreset")}set onreset(e){ao.set(this,"onreset",e)}get onresize(){return ao.get(this,"onresize")}set onresize(e){ao.set(this,"onresize",e)}get onscroll(){return ao.get(this,"onscroll")}set onscroll(e){ao.set(this,"onscroll",e)}get onseeked(){return ao.get(this,"onseeked")}set onseeked(e){ao.set(this,"onseeked",e)}get onseeking(){return ao.get(this,"onseeking")}set onseeking(e){ao.set(this,"onseeking",e)}get onselect(){return ao.get(this,"onselect")}set onselect(e){ao.set(this,"onselect",e)}get onshow(){return ao.get(this,"onshow")}set onshow(e){ao.set(this,"onshow",e)}get onstalled(){return ao.get(this,"onstalled")}set onstalled(e){ao.set(this,"onstalled",e)}get onsubmit(){return ao.get(this,"onsubmit")}set onsubmit(e){ao.set(this,"onsubmit",e)}get onsuspend(){return ao.get(this,"onsuspend")}set onsuspend(e){ao.set(this,"onsuspend",e)}get ontimeupdate(){return ao.get(this,"ontimeupdate")}set ontimeupdate(e){ao.set(this,"ontimeupdate",e)}get ontoggle(){return ao.get(this,"ontoggle")}set ontoggle(e){ao.set(this,"ontoggle",e)}get onvolumechange(){return ao.get(this,"onvolumechange")}set onvolumechange(e){ao.set(this,"onvolumechange",e)}get onwaiting(){return ao.get(this,"onwaiting")}set onwaiting(e){ao.set(this,"onwaiting",e)}get onauxclick(){return ao.get(this,"onauxclick")}set onauxclick(e){ao.set(this,"onauxclick",e)}get ongotpointercapture(){return ao.get(this,"ongotpointercapture")}set ongotpointercapture(e){ao.set(this,"ongotpointercapture",e)}get onlostpointercapture(){return ao.get(this,"onlostpointercapture")}set onlostpointercapture(e){ao.set(this,"onlostpointercapture",e)}get onpointercancel(){return ao.get(this,"onpointercancel")}set onpointercancel(e){ao.set(this,"onpointercancel",e)}get onpointerdown(){return ao.get(this,"onpointerdown")}set onpointerdown(e){ao.set(this,"onpointerdown",e)}get onpointerenter(){return ao.get(this,"onpointerenter")}set onpointerenter(e){ao.set(this,"onpointerenter",e)}get onpointerleave(){return ao.get(this,"onpointerleave")}set onpointerleave(e){ao.set(this,"onpointerleave",e)}get onpointermove(){return ao.get(this,"onpointermove")}set onpointermove(e){ao.set(this,"onpointermove",e)}get onpointerout(){return ao.get(this,"onpointerout")}set onpointerout(e){ao.set(this,"onpointerout",e)}get onpointerover(){return ao.get(this,"onpointerover")}set onpointerover(e){ao.set(this,"onpointerover",e)}get onpointerup(){return ao.get(this,"onpointerup")}set onpointerup(e){ao.set(this,"onpointerup",e)}}const lo="template";class uo extends co{constructor(e){super(e,lo);const t=this.ownerDocument.createDocumentFragment();(this[s]=t)[b]=this}get content(){if(this.hasChildNodes()&&!this[s].hasChildNodes())for(const e of this.childNodes)this[s].appendChild(e.cloneNode(!0));return this[s]}}sn(lo,uo);const{toString:ho}=co.prototype;class fo extends co{get innerHTML(){return this.textContent}set innerHTML(e){this.textContent=e}toString(){return ho.call(this.cloneNode()).replace(/></,`>${this.textContent}<`)}}const po="script";class go extends fo{constructor(e,t=po){super(e,t)}get type(){return En.get(this,"type")}set type(e){En.set(this,"type",e)}get src(){return En.get(this,"src")}set src(e){En.set(this,"src",e)}get defer(){return wn.get(this,"defer")}set defer(e){wn.set(this,"defer",e)}get crossOrigin(){return En.get(this,"crossorigin")}set crossOrigin(e){En.set(this,"crossorigin",e)}get nomodule(){return wn.get(this,"nomodule")}set nomodule(e){wn.set(this,"nomodule",e)}get referrerPolicy(){return En.get(this,"referrerpolicy")}set referrerPolicy(e){En.set(this,"referrerpolicy",e)}get nonce(){return En.get(this,"nonce")}set nonce(e){En.set(this,"nonce",e)}get async(){return wn.get(this,"async")}set async(e){wn.set(this,"async",e)}get text(){return this.textContent}set text(e){this.textContent=e}}sn(po,go);const mo="iframe";class yo extends co{constructor(e,t=mo){super(e,t)}get src(){return En.get(this,"src")}set src(e){En.set(this,"src",e)}get srcdoc(){return En.get(this,"srcdoc")}set srcdoc(e){En.set(this,"srcdoc",e)}get name(){return En.get(this,"name")}set name(e){En.set(this,"name",e)}get allow(){return En.get(this,"allow")}set allow(e){En.set(this,"allow",e)}get allowFullscreen(){return wn.get(this,"allowfullscreen")}set allowFullscreen(e){wn.set(this,"allowfullscreen",e)}get referrerPolicy(){return En.get(this,"referrerpolicy")}set referrerPolicy(e){En.set(this,"referrerpolicy",e)}get loading(){return En.get(this,"loading")}set loading(e){En.set(this,"loading",e)}}sn(mo,yo);var vo={},bo={},_o={},wo={},To={StyleSheet:function(){this.parentStyleSheet=null}};wo.StyleSheet=To.StyleSheet;var Eo,Ao,So={},Oo={},Io={};function Co(){if(Eo)return So;Eo=1;var e={CSSStyleDeclaration:us().CSSStyleDeclaration,CSSRule:Oo.CSSRule,CSSStyleRule:function(){e.CSSRule.call(this),this.selectorText="",this.style=new e.CSSStyleDeclaration,this.style.parentRule=this}};return e.CSSStyleRule.prototype=new e.CSSRule,e.CSSStyleRule.prototype.constructor=e.CSSStyleRule,e.CSSStyleRule.prototype.type=1,Object.defineProperty(e.CSSStyleRule.prototype,"cssText",{get:function(){return this.selectorText?this.selectorText+" {"+this.style.cssText+"}":""},set:function(t){var n=e.CSSStyleRule.parse(t);this.style=n.style,this.selectorText=n.selectorText}}),e.CSSStyleRule.parse=function(t){for(var n,r,i,o=0,s="selector",a=o,c="",l={selector:!0,value:!0},u=new e.CSSStyleRule,d="";i=t.charAt(o);o++)switch(i){case" ":case"\t":case"\r":case"\n":case"\f":if(l[s])switch(t.charAt(o-1)){case" ":case"\t":case"\r":case"\n":case"\f":break;default:c+=" "}break;case'"':if(a=o+1,!(n=t.indexOf('"',a)+1))throw'" is missing';c+=t.slice(o,n),o=n-1;break;case"'":if(a=o+1,!(n=t.indexOf("'",a)+1))throw"' is missing";c+=t.slice(o,n),o=n-1;break;case"/":if("*"===t.charAt(o+1)){if(o+=2,-1===(n=t.indexOf("*/",o)))throw new SyntaxError("Missing */");o=n+1}else c+=i;break;case"{":"selector"===s&&(u.selectorText=c.trim(),c="",s="name");break;case":":"name"===s?(r=c.trim(),c="",s="value"):c+=i;break;case"!":"value"===s&&t.indexOf("!important",o)===o?(d="important",o+=9):c+=i;break;case";":"value"===s?(u.style.setProperty(r,c.trim(),d),d="",c="",s="name"):c+=i;break;case"}":if("value"===s)u.style.setProperty(r,c.trim(),d),d="",c="";else{if("name"===s)break;c+=i}s="selector";break;default:c+=i}return u},So.CSSStyleRule=e.CSSStyleRule,So}function ko(){if(Ao)return _o;Ao=1;var e={StyleSheet:wo.StyleSheet,CSSStyleRule:Co().CSSStyleRule,CSSStyleSheet:function(){e.StyleSheet.call(this),this.cssRules=[]}};return e.CSSStyleSheet.prototype=new e.StyleSheet,e.CSSStyleSheet.prototype.constructor=e.CSSStyleSheet,e.CSSStyleSheet.prototype.insertRule=function(t,n){if(n<0||n>this.cssRules.length)throw new RangeError("INDEX_SIZE_ERR");var r=e.parse(t).cssRules[0];return r.parentStyleSheet=this,this.cssRules.splice(n,0,r),n},e.CSSStyleSheet.prototype.deleteRule=function(e){if(e<0||e>=this.cssRules.length)throw new RangeError("INDEX_SIZE_ERR");this.cssRules.splice(e,1)},e.CSSStyleSheet.prototype.toString=function(){for(var e="",t=this.cssRules,n=0;n<t.length;n++)e+=t[n].cssText+"\n";return e},_o.CSSStyleSheet=e.CSSStyleSheet,e.parse=ls().parse,_o}Io.CSSRule=function(){this.parentRule=null,this.parentStyleSheet=null},Io.CSSRule.UNKNOWN_RULE=0,Io.CSSRule.STYLE_RULE=1,Io.CSSRule.CHARSET_RULE=2,Io.CSSRule.IMPORT_RULE=3,Io.CSSRule.MEDIA_RULE=4,Io.CSSRule.FONT_FACE_RULE=5,Io.CSSRule.PAGE_RULE=6,Io.CSSRule.KEYFRAMES_RULE=7,Io.CSSRule.KEYFRAME_RULE=8,Io.CSSRule.MARGIN_RULE=9,Io.CSSRule.NAMESPACE_RULE=10,Io.CSSRule.COUNTER_STYLE_RULE=11,Io.CSSRule.SUPPORTS_RULE=12,Io.CSSRule.DOCUMENT_RULE=13,Io.CSSRule.FONT_FEATURE_VALUES_RULE=14,Io.CSSRule.VIEWPORT_RULE=15,Io.CSSRule.REGION_STYLE_RULE=16,Io.CSSRule.prototype={constructor:Io.CSSRule},Oo.CSSRule=Io.CSSRule;var Po,xo={},Ro={},Lo={};function Do(){if(Po)return xo;Po=1;var e={CSSRule:Oo.CSSRule,CSSStyleSheet:ko().CSSStyleSheet,MediaList:Ro.MediaList,CSSImportRule:function(){e.CSSRule.call(this),this.href="",this.media=new e.MediaList,this.styleSheet=new e.CSSStyleSheet}};return e.CSSImportRule.prototype=new e.CSSRule,e.CSSImportRule.prototype.constructor=e.CSSImportRule,e.CSSImportRule.prototype.type=3,Object.defineProperty(e.CSSImportRule.prototype,"cssText",{get:function(){var e=this.media.mediaText;return"@import url("+this.href+")"+(e?" "+e:"")+";"},set:function(e){for(var t,n,r=0,i="",o="";n=e.charAt(r);r++)switch(n){case" ":case"\t":case"\r":case"\n":case"\f":"after-import"===i?i="url":o+=n;break;case"@":i||e.indexOf("@import",r)!==r||(i="after-import",r+=6,o="");break;case"u":if("url"===i&&e.indexOf("url(",r)===r){if(-1===(t=e.indexOf(")",r+1)))throw r+': ")" not found';r+=4;var s=e.slice(r,t);s[0]===s[s.length-1]&&('"'!==s[0]&&"'"!==s[0]||(s=s.slice(1,-1))),this.href=s,r=t,i="media"}break;case'"':if("url"===i){if(!(t=e.indexOf('"',r+1)))throw r+": '\"' not found";this.href=e.slice(r+1,t),r=t,i="media"}break;case"'":if("url"===i){if(!(t=e.indexOf("'",r+1)))throw r+': "\'" not found';this.href=e.slice(r+1,t),r=t,i="media"}break;case";":"media"===i&&o&&(this.media.mediaText=o.trim());break;default:"media"===i&&(o+=n)}}}),xo.CSSImportRule=e.CSSImportRule,xo}Lo.MediaList=function(){this.length=0},Lo.MediaList.prototype={constructor:Lo.MediaList,get mediaText(){return Array.prototype.join.call(this,", ")},set mediaText(e){for(var t=e.split(","),n=this.length=t.length,r=0;r<n;r++)this[r]=t[r].trim()},appendMedium:function(e){-1===Array.prototype.indexOf.call(this,e)&&(this[this.length]=e,this.length++)},deleteMedium:function(e){var t=Array.prototype.indexOf.call(this,e);-1!==t&&Array.prototype.splice.call(this,t,1)}},Ro.MediaList=Lo.MediaList;var No={},jo={CSSRule:Oo.CSSRule,CSSGroupingRule:function(){jo.CSSRule.call(this),this.cssRules=[]}};jo.CSSGroupingRule.prototype=new jo.CSSRule,jo.CSSGroupingRule.prototype.constructor=jo.CSSGroupingRule,jo.CSSGroupingRule.prototype.insertRule=function(e,t){if(t<0||t>this.cssRules.length)throw new RangeError("INDEX_SIZE_ERR");var n=jo.parse(e).cssRules[0];return n.parentRule=this,this.cssRules.splice(t,0,n),t},jo.CSSGroupingRule.prototype.deleteRule=function(e){if(e<0||e>=this.cssRules.length)throw new RangeError("INDEX_SIZE_ERR");this.cssRules.splice(e,1)[0].parentRule=null},No.CSSGroupingRule=jo.CSSGroupingRule;var Mo={},Fo={},Uo={CSSRule:Oo.CSSRule,CSSGroupingRule:No.CSSGroupingRule,CSSConditionRule:function(){Uo.CSSGroupingRule.call(this),this.cssRules=[]}};Uo.CSSConditionRule.prototype=new Uo.CSSGroupingRule,Uo.CSSConditionRule.prototype.constructor=Uo.CSSConditionRule,Uo.CSSConditionRule.prototype.conditionText="",Uo.CSSConditionRule.prototype.cssText="",Fo.CSSConditionRule=Uo.CSSConditionRule;var Bo={CSSRule:Oo.CSSRule,CSSGroupingRule:No.CSSGroupingRule,CSSConditionRule:Fo.CSSConditionRule,MediaList:Ro.MediaList,CSSMediaRule:function(){Bo.CSSConditionRule.call(this),this.media=new Bo.MediaList}};Bo.CSSMediaRule.prototype=new Bo.CSSConditionRule,Bo.CSSMediaRule.prototype.constructor=Bo.CSSMediaRule,Bo.CSSMediaRule.prototype.type=4,Object.defineProperties(Bo.CSSMediaRule.prototype,{conditionText:{get:function(){return this.media.mediaText},set:function(e){this.media.mediaText=e},configurable:!0,enumerable:!0},cssText:{get:function(){for(var e=[],t=0,n=this.cssRules.length;t<n;t++)e.push(this.cssRules[t].cssText);return"@media "+this.media.mediaText+" {"+e.join("")+"}"},configurable:!0,enumerable:!0}}),Mo.CSSMediaRule=Bo.CSSMediaRule;var Go={},qo={CSSRule:Oo.CSSRule,CSSGroupingRule:No.CSSGroupingRule,CSSConditionRule:Fo.CSSConditionRule,CSSSupportsRule:function(){qo.CSSConditionRule.call(this)}};qo.CSSSupportsRule.prototype=new qo.CSSConditionRule,qo.CSSSupportsRule.prototype.constructor=qo.CSSSupportsRule,qo.CSSSupportsRule.prototype.type=12,Object.defineProperty(qo.CSSSupportsRule.prototype,"cssText",{get:function(){for(var e=[],t=0,n=this.cssRules.length;t<n;t++)e.push(this.cssRules[t].cssText);return"@supports "+this.conditionText+" {"+e.join("")+"}"}}),Go.CSSSupportsRule=qo.CSSSupportsRule;var Ho,$o={};function Wo(){if(Ho)return $o;Ho=1;var e={CSSStyleDeclaration:us().CSSStyleDeclaration,CSSRule:Oo.CSSRule,CSSFontFaceRule:function(){e.CSSRule.call(this),this.style=new e.CSSStyleDeclaration,this.style.parentRule=this}};return e.CSSFontFaceRule.prototype=new e.CSSRule,e.CSSFontFaceRule.prototype.constructor=e.CSSFontFaceRule,e.CSSFontFaceRule.prototype.type=5,Object.defineProperty(e.CSSFontFaceRule.prototype,"cssText",{get:function(){return"@font-face {"+this.style.cssText+"}"}}),$o.CSSFontFaceRule=e.CSSFontFaceRule,$o}var zo={},Vo={CSSRule:Oo.CSSRule,CSSHostRule:function(){Vo.CSSRule.call(this),this.cssRules=[]}};Vo.CSSHostRule.prototype=new Vo.CSSRule,Vo.CSSHostRule.prototype.constructor=Vo.CSSHostRule,Vo.CSSHostRule.prototype.type=1001,Object.defineProperty(Vo.CSSHostRule.prototype,"cssText",{get:function(){for(var e=[],t=0,n=this.cssRules.length;t<n;t++)e.push(this.cssRules[t].cssText);return"@host {"+e.join("")+"}"}}),zo.CSSHostRule=Vo.CSSHostRule;var Ko,Yo={};function Qo(){if(Ko)return Yo;Ko=1;var e={CSSRule:Oo.CSSRule,CSSStyleDeclaration:us().CSSStyleDeclaration,CSSKeyframeRule:function(){e.CSSRule.call(this),this.keyText="",this.style=new e.CSSStyleDeclaration,this.style.parentRule=this}};return e.CSSKeyframeRule.prototype=new e.CSSRule,e.CSSKeyframeRule.prototype.constructor=e.CSSKeyframeRule,e.CSSKeyframeRule.prototype.type=8,Object.defineProperty(e.CSSKeyframeRule.prototype,"cssText",{get:function(){return this.keyText+" {"+this.style.cssText+"} "}}),Yo.CSSKeyframeRule=e.CSSKeyframeRule,Yo}var Xo={},Jo={CSSRule:Oo.CSSRule,CSSKeyframesRule:function(){Jo.CSSRule.call(this),this.name="",this.cssRules=[]}};Jo.CSSKeyframesRule.prototype=new Jo.CSSRule,Jo.CSSKeyframesRule.prototype.constructor=Jo.CSSKeyframesRule,Jo.CSSKeyframesRule.prototype.type=7,Object.defineProperty(Jo.CSSKeyframesRule.prototype,"cssText",{get:function(){for(var e=[],t=0,n=this.cssRules.length;t<n;t++)e.push("  "+this.cssRules[t].cssText);return"@"+(this._vendorPrefix||"")+"keyframes "+this.name+" { \n"+e.join("\n")+"\n}"}}),Xo.CSSKeyframesRule=Jo.CSSKeyframesRule;var Zo={},es={},ts={CSSValue:function(){}};ts.CSSValue.prototype={constructor:ts.CSSValue,set cssText(e){var t=this._getConstructorName();throw new Error('DOMException: property "cssText" of "'+t+'" is readonly and can not be replaced with "'+e+'"!')},get cssText(){var e=this._getConstructorName();throw new Error('getter "cssText" of "'+e+'" is not implemented!')},_getConstructorName:function(){return this.constructor.toString().match(/function\s([^\(]+)/)[1]}},es.CSSValue=ts.CSSValue;var ns={CSSValue:es.CSSValue,CSSValueExpression:function(e,t){this._token=e,this._idx=t}};ns.CSSValueExpression.prototype=new ns.CSSValue,ns.CSSValueExpression.prototype.constructor=ns.CSSValueExpression,ns.CSSValueExpression.prototype.parse=function(){for(var e,t=this._token,n=this._idx,r="",i="",o="",s=[];;++n){if(""===(r=t.charAt(n))){o="css expression error: unfinished expression!";break}switch(r){case"(":s.push(r),i+=r;break;case")":s.pop(r),i+=r;break;case"/":(e=this._parseJSComment(t,n))?e.error?o="css expression error: unfinished comment in expression!":n=e.idx:(e=this._parseJSRexExp(t,n))?(n=e.idx,i+=e.text):i+=r;break;case"'":case'"':(e=this._parseJSString(t,n,r))?(n=e.idx,i+=e.text):i+=r;break;default:i+=r}if(o)break;if(0===s.length)break}return o?{error:o}:{idx:n,expression:i}},ns.CSSValueExpression.prototype._parseJSComment=function(e,t){var n=e.charAt(t+1);if("/"===n||"*"===n){var r,i,o=t;if("/"===n?i="\n":"*"===n&&(i="*/"),-1!==(r=e.indexOf(i,o+1+1)))return{idx:r=r+i.length-1,text:e.substring(t,r+1)};return{error:"css expression error: unfinished comment in expression!"}}return!1},ns.CSSValueExpression.prototype._parseJSString=function(e,t,n){var r=this._findMatchedIdx(e,t,n);return-1!==r&&{idx:r,text:e.substring(t,r+n.length)}},ns.CSSValueExpression.prototype._parseJSRexExp=function(e,t){var n=e.substring(0,t).replace(/\s+$/,"");if([/^$/,/\($/,/\[$/,/\!$/,/\+$/,/\-$/,/\*$/,/\/\s+/,/\%$/,/\=$/,/\>$/,/<$/,/\&$/,/\|$/,/\^$/,/\~$/,/\?$/,/\,$/,/delete$/,/in$/,/instanceof$/,/new$/,/typeof$/,/void$/].some((function(e){return e.test(n)}))){return this._parseJSString(e,t,"/")}return!1},ns.CSSValueExpression.prototype._findMatchedIdx=function(e,t,n){for(var r,i=t;;){if(-1===(r=e.indexOf(n,i+1))){r=-1;break}var o=e.substring(t+1,r).match(/\\+$/);if(!o||o[0]%2==0)break;i=r}return e.indexOf("\n",t+1)<r&&(r=-1),r},Zo.CSSValueExpression=ns.CSSValueExpression;var rs={},is={},os={MatcherList:function(){this.length=0}};os.MatcherList.prototype={constructor:os.MatcherList,get matcherText(){return Array.prototype.join.call(this,", ")},set matcherText(e){for(var t=e.split(","),n=this.length=t.length,r=0;r<n;r++)this[r]=t[r].trim()},appendMatcher:function(e){-1===Array.prototype.indexOf.call(this,e)&&(this[this.length]=e,this.length++)},deleteMatcher:function(e){var t=Array.prototype.indexOf.call(this,e);-1!==t&&Array.prototype.splice.call(this,t,1)}},is.MatcherList=os.MatcherList;var ss,as,cs={CSSRule:Oo.CSSRule,MatcherList:is.MatcherList};function ls(){if(ss)return bo;ss=1;var e={parse:function(t){for(var n,r,i,o,s,a,c,l,u,d,h,f,p,g=0,m="before-selector",y="",v=0,b={selector:!0,value:!0,"value-parenthesis":!0,atRule:!0,"importRule-begin":!0,importRule:!0,atBlock:!0,conditionBlock:!0,"documentRule-begin":!0},_=new e.CSSStyleSheet,w=_,T=[],E=!1,A="",S=/@(-(?:\w+-)+)?keyframes/g,O=function(e){var n=t.substring(0,g).split("\n"),r=n.length,i=n.pop().length+1,o=new Error(e+" (line "+r+", char "+i+")");throw o.line=r,o.char=i,o.styleSheet=_,o};p=t.charAt(g);g++)switch(p){case" ":case"\t":case"\r":case"\n":case"\f":b[m]&&(y+=p);break;case'"':n=g+1;do{(n=t.indexOf('"',n)+1)||O('Unmatched "')}while("\\"===t[n-2]);switch(y+=t.slice(g,n),g=n-1,m){case"before-value":m="value";break;case"importRule-begin":m="importRule"}break;case"'":n=g+1;do{(n=t.indexOf("'",n)+1)||O("Unmatched '")}while("\\"===t[n-2]);switch(y+=t.slice(g,n),g=n-1,m){case"before-value":m="value";break;case"importRule-begin":m="importRule"}break;case"/":"*"===t.charAt(g+1)?(g+=2,-1===(n=t.indexOf("*/",g))?O("Missing */"):g=n+1):y+=p,"importRule-begin"===m&&(y+=" ",m="importRule");break;case"@":if(t.indexOf("@-moz-document",g)===g){m="documentRule-begin",(h=new e.CSSDocumentRule).__starts=g,g+=13,y="";break}if(t.indexOf("@media",g)===g){m="atBlock",(a=new e.CSSMediaRule).__starts=g,g+=5,y="";break}if(t.indexOf("@supports",g)===g){m="conditionBlock",(c=new e.CSSSupportsRule).__starts=g,g+=8,y="";break}if(t.indexOf("@host",g)===g){m="hostRule-begin",g+=4,(f=new e.CSSHostRule).__starts=g,y="";break}if(t.indexOf("@import",g)===g){m="importRule-begin",g+=6,y+="@import";break}if(t.indexOf("@font-face",g)===g){m="fontFaceRule-begin",g+=9,(u=new e.CSSFontFaceRule).__starts=g,y="";break}S.lastIndex=g;var I=S.exec(t);if(I&&I.index===g){m="keyframesRule-begin",(d=new e.CSSKeyframesRule).__starts=g,d._vendorPrefix=I[1],g+=I[0].length-1,y="";break}"selector"===m&&(m="atRule"),y+=p;break;case"{":"selector"===m||"atRule"===m?(s.selectorText=y.trim(),s.style.__starts=g,y="",m="before-name"):"atBlock"===m?(a.media.mediaText=y.trim(),r&&T.push(r),w=r=a,a.parentStyleSheet=_,y="",m="before-selector"):"conditionBlock"===m?(c.conditionText=y.trim(),r&&T.push(r),w=r=c,c.parentStyleSheet=_,y="",m="before-selector"):"hostRule-begin"===m?(r&&T.push(r),w=r=f,f.parentStyleSheet=_,y="",m="before-selector"):"fontFaceRule-begin"===m?(r&&(u.parentRule=r),u.parentStyleSheet=_,s=u,y="",m="before-name"):"keyframesRule-begin"===m?(d.name=y.trim(),r&&(T.push(r),d.parentRule=r),d.parentStyleSheet=_,w=r=d,y="",m="keyframeRule-begin"):"keyframeRule-begin"===m?((s=new e.CSSKeyframeRule).keyText=y.trim(),s.__starts=g,y="",m="before-name"):"documentRule-begin"===m&&(h.matcher.matcherText=y.trim(),r&&(T.push(r),h.parentRule=r),w=r=h,h.parentStyleSheet=_,y="",m="before-selector");break;case":":"name"===m?(o=y.trim(),y="",m="before-value"):y+=p;break;case"(":if("value"===m)if("expression"===y.trim()){var C=new e.CSSValueExpression(t,g).parse();C.error?O(C.error):(y+=C.expression,g=C.idx)}else m="value-parenthesis",v=1,y+=p;else"value-parenthesis"===m?(v++,y+=p):y+=p;break;case")":"value-parenthesis"===m&&0===--v&&(m="value"),y+=p;break;case"!":"value"===m&&t.indexOf("!important",g)===g?(A="important",g+=9):y+=p;break;case";":switch(m){case"value":s.style.setProperty(o,y.trim(),A),A="",y="",m="before-name";break;case"atRule":y="",m="before-selector";break;case"importRule":(l=new e.CSSImportRule).parentStyleSheet=l.styleSheet.parentStyleSheet=_,l.cssText=y+p,_.cssRules.push(l),y="",m="before-selector";break;default:y+=p}break;case"}":switch(m){case"value":s.style.setProperty(o,y.trim(),A),A="";case"before-name":case"name":s.__ends=g+1,r&&(s.parentRule=r),s.parentStyleSheet=_,w.cssRules.push(s),y="",m=w.constructor===e.CSSKeyframesRule?"keyframeRule-begin":"before-selector";break;case"keyframeRule-begin":case"before-selector":case"selector":for(r||O("Unexpected }"),E=T.length>0;T.length>0;){if("CSSMediaRule"===(r=T.pop()).constructor.name||"CSSSupportsRule"===r.constructor.name){i=w,(w=r).cssRules.push(i);break}0===T.length&&(E=!1)}E||(w.__ends=g+1,_.cssRules.push(w),w=_,r=null),y="",m="before-selector"}break;default:switch(m){case"before-selector":m="selector",(s=new e.CSSStyleRule).__starts=g;break;case"before-name":m="name";break;case"before-value":m="value";break;case"importRule-begin":m="importRule"}y+=p}return _}};return bo.parse=e.parse,e.CSSStyleSheet=ko().CSSStyleSheet,e.CSSStyleRule=Co().CSSStyleRule,e.CSSImportRule=Do().CSSImportRule,e.CSSGroupingRule=No.CSSGroupingRule,e.CSSMediaRule=Mo.CSSMediaRule,e.CSSConditionRule=Fo.CSSConditionRule,e.CSSSupportsRule=Go.CSSSupportsRule,e.CSSFontFaceRule=Wo().CSSFontFaceRule,e.CSSHostRule=zo.CSSHostRule,e.CSSStyleDeclaration=us().CSSStyleDeclaration,e.CSSKeyframeRule=Qo().CSSKeyframeRule,e.CSSKeyframesRule=Xo.CSSKeyframesRule,e.CSSValueExpression=Zo.CSSValueExpression,e.CSSDocumentRule=rs.CSSDocumentRule,bo}function us(){if(as)return vo;as=1;var e={CSSStyleDeclaration:function(){this.length=0,this.parentRule=null,this._importants={}}};return e.CSSStyleDeclaration.prototype={constructor:e.CSSStyleDeclaration,getPropertyValue:function(e){return this[e]||""},setProperty:function(e,t,n){this[e]?Array.prototype.indexOf.call(this,e)<0&&(this[this.length]=e,this.length++):(this[this.length]=e,this.length++);this[e]=t+"",this._importants[e]=n},removeProperty:function(e){if(!(e in this))return"";var t=Array.prototype.indexOf.call(this,e);if(t<0)return"";var n=this[e];return this[e]="",Array.prototype.splice.call(this,t,1),n},getPropertyCSSValue:function(){},getPropertyPriority:function(e){return this._importants[e]||""},getPropertyShorthand:function(){},isPropertyImplicit:function(){},get cssText(){for(var e=[],t=0,n=this.length;t<n;++t){var r=this[t],i=this.getPropertyValue(r),o=this.getPropertyPriority(r);o&&(o=" !"+o),e[t]=r+": "+i+o+";"}return e.join(" ")},set cssText(t){var n,r;for(n=this.length;n--;)this[r=this[n]]="";Array.prototype.splice.call(this,0,this.length),this._importants={};var i=e.parse("#bogus{"+t+"}").cssRules[0].style,o=i.length;for(n=0;n<o;++n)r=i[n],this.setProperty(i[n],i.getPropertyValue(r),i.getPropertyPriority(r))}},vo.CSSStyleDeclaration=e.CSSStyleDeclaration,e.parse=ls().parse,vo}cs.CSSDocumentRule=function(){cs.CSSRule.call(this),this.matcher=new cs.MatcherList,this.cssRules=[]},cs.CSSDocumentRule.prototype=new cs.CSSRule,cs.CSSDocumentRule.prototype.constructor=cs.CSSDocumentRule,cs.CSSDocumentRule.prototype.type=10,Object.defineProperty(cs.CSSDocumentRule.prototype,"cssText",{get:function(){for(var e=[],t=0,n=this.cssRules.length;t<n;t++)e.push(this.cssRules[t].cssText);return"@-moz-document "+this.matcher.matcherText+" {"+e.join("")+"}"}}),rs.CSSDocumentRule=cs.CSSDocumentRule,ko().CSSStyleSheet,Oo.CSSRule,Co().CSSStyleRule,No.CSSGroupingRule,Fo.CSSConditionRule,Mo.CSSMediaRule,Go.CSSSupportsRule,us().CSSStyleDeclaration,Qo().CSSKeyframeRule,Xo.CSSKeyframesRule,us().CSSStyleDeclaration,Co().CSSStyleRule,Do().CSSImportRule,Wo().CSSFontFaceRule,ko().CSSStyleSheet,Qo().CSSKeyframeRule;var ds=ls().parse;const hs="style";class fs extends fo{constructor(e,t=hs){super(e,t),this[_]=null}get sheet(){const e=this[_];return null!==e?e:this[_]=ds(this.textContent)}get innerHTML(){return super.innerHTML||""}set innerHTML(e){super.textContent=e,this[_]=null}get innerText(){return super.innerText||""}set innerText(e){super.textContent=e,this[_]=null}get textContent(){return super.textContent||""}set textContent(e){super.textContent=e,this[_]=null}}sn(hs,fs);const ps="input";class gs extends co{constructor(e,t=ps){super(e,t)}get autofocus(){return wn.get(this,"autofocus")||-1}set autofocus(e){wn.set(this,"autofocus",e)}get disabled(){return wn.get(this,"disabled")}set disabled(e){wn.set(this,"disabled",e)}get name(){return this.getAttribute("name")}set name(e){this.setAttribute("name",e)}get placeholder(){return this.getAttribute("placeholder")}set placeholder(e){this.setAttribute("placeholder",e)}get type(){return this.getAttribute("type")}set type(e){this.setAttribute("type",e)}get value(){return En.get(this,"value")}set value(e){En.set(this,"value",e)}}sn(ps,gs);class ms extends co{constructor(e,t="h1"){super(e,t)}}sn(["h1","h2","h3","h4","h5","h6"],ms);class ys{constructor(e,t){this.width=e,this.height=t}getContext(){return null}toDataURL(){return""}}var vs={createCanvas:(e,t)=>new ys(e,t)};const{createCanvas:bs}=vs,_s="canvas";class ws extends co{constructor(e,t=_s){super(e,t),this[f]=bs(300,150)}get width(){return this[f].width}set width(e){Tn.set(this,"width",e),this[f].width=e}get height(){return this[f].height}set height(e){Tn.set(this,"height",e),this[f].height=e}getContext(e){return this[f].getContext(e)}toDataURL(...e){return this[f].toDataURL(...e)}}sn(_s,ws);const Ts="option";class Es extends co{constructor(e,t=Ts){super(e,t)}get value(){return En.get(this,"value")}set value(e){En.set(this,"value",e)}get selected(){return wn.get(this,"selected")}set selected(e){var t;const n=null===(t=this.parentElement)||void 0===t?void 0:t.querySelector("option[selected]");n&&n!==this&&(n.selected=!1),wn.set(this,"selected",e)}}sn(Ts,Es);const As="title";class Ss extends fo{constructor(e,t=As){super(e,t)}}sn(As,Ss);const Os="select";class Is extends co{constructor(e,t=Os){super(e,t)}get options(){let e=new Cn,{firstElementChild:t}=this;for(;t;)"OPTGROUP"===t.tagName?e.push(...t.children):e.push(t),t=t.nextElementSibling;return e}get disabled(){return wn.get(this,"disabled")}set disabled(e){wn.set(this,"disabled",e)}get name(){return this.getAttribute("name")}set name(e){this.setAttribute("name",e)}get value(){var e;return null===(e=this.querySelector("option[selected]"))||void 0===e?void 0:e.value}}sn(Os,Is);const Cs="button";class ks extends co{constructor(e,t=Cs){super(e,t)}get disabled(){return wn.get(this,"disabled")}set disabled(e){wn.set(this,"disabled",e)}get name(){return this.getAttribute("name")}set name(e){this.setAttribute("name",e)}get type(){return this.getAttribute("type")}set type(e){this.setAttribute("type",e)}}sn(Cs,ks);const Ps="textarea";class xs extends fo{constructor(e,t=Ps){super(e,t)}get disabled(){return wn.get(this,"disabled")}set disabled(e){wn.set(this,"disabled",e)}get name(){return this.getAttribute("name")}set name(e){this.setAttribute("name",e)}get placeholder(){return this.getAttribute("placeholder")}set placeholder(e){this.setAttribute("placeholder",e)}get type(){return this.getAttribute("type")}set type(e){this.setAttribute("type",e)}get value(){return this.textContent}set value(e){this.textContent=e}}sn(Ps,xs);const Rs="link";class Ls extends co{constructor(e,t=Rs){super(e,t)}get disabled(){return wn.get(this,"disabled")}set disabled(e){wn.set(this,"disabled",e)}get href(){return En.get(this,"href")}set href(e){En.set(this,"href",e)}get hreflang(){return En.get(this,"hreflang")}set hreflang(e){En.set(this,"hreflang",e)}get media(){return En.get(this,"media")}set media(e){En.set(this,"media",e)}get rel(){return En.get(this,"rel")}set rel(e){En.set(this,"rel",e)}get type(){return En.get(this,"type")}set type(e){En.set(this,"type",e)}}sn(Rs,Ls);const Ds="slot";class Ns extends co{constructor(e,t=Ds){super(e,t)}get name(){return this.getAttribute("name")}set name(e){this.setAttribute("name",e)}assign(){}assignedNodes(e){var t,n;const r=!!this.name,i=null!==(n=null===(t=this.getRootNode().host)||void 0===t?void 0:t.childNodes)&&void 0!==n?n:[];let o;if(o=r?[...i].filter((e=>e.slot===this.name)):[...i].filter((e=>!e.slot)),null==e?void 0:e.flatten){const e=[];for(let t of o)"slot"===t.localName?e.push(...t.assignedNodes({flatten:!0})):e.push(t);o=e}return o.length?o:[...this.childNodes]}assignedElements(e){const t=this.assignedNodes(e).filter((e=>1===e.nodeType));return t.length?t:[...this.children]}}sn(Ds,Ns);class js extends co{constructor(e,t="img"){super(e,t)}get alt(){return En.get(this,"alt")}set alt(e){En.set(this,"alt",e)}get sizes(){return En.get(this,"sizes")}set sizes(e){En.set(this,"sizes",e)}get src(){return En.get(this,"src")}set src(e){En.set(this,"src",e)}get srcset(){return En.get(this,"srcset")}set srcset(e){En.set(this,"srcset",e)}get title(){return En.get(this,"title")}set title(e){En.set(this,"title",e)}get width(){return Tn.get(this,"width")}set width(e){Tn.set(this,"width",e)}get height(){return Tn.get(this,"height")}set height(e){Tn.set(this,"height",e)}}sn("img",js);const Ms="meta";class Fs extends co{constructor(e,t=Ms){super(e,t)}get name(){return En.get(this,"name")}set name(e){En.set(this,"name",e)}get httpEquiv(){return En.get(this,"http-equiv")}set httpEquiv(e){En.set(this,"http-equiv",e)}get content(){return En.get(this,"content")}set content(e){En.set(this,"content",e)}get charset(){return En.get(this,"charset")}set charset(e){En.set(this,"charset",e)}get media(){return En.get(this,"media")}set media(e){En.set(this,"media",e)}}sn(Ms,Fs);class Us extends co{constructor(e,t="a"){super(e,t)}get href(){return encodeURI(decodeURI(En.get(this,"href")))}set href(e){En.set(this,"href",decodeURI(e))}get download(){return encodeURI(decodeURI(En.get(this,"download")))}set download(e){En.set(this,"download",decodeURI(e))}get target(){return En.get(this,"target")}set target(e){En.set(this,"target",e)}get type(){return En.get(this,"type")}set type(e){En.set(this,"type",e)}}sn("a",Us);const Bs="source";class Gs extends co{constructor(e,t=Bs){super(e,t)}get src(){return En.get(this,"src")}set src(e){En.set(this,"src",e)}get srcset(){return En.get(this,"srcset")}set srcset(e){En.set(this,"srcset",e)}get sizes(){return En.get(this,"sizes")}set sizes(e){En.set(this,"sizes",e)}get type(){return En.get(this,"type")}set type(e){En.set(this,"type",e)}}sn(Bs,Gs);const qs={HTMLElement:co,HTMLTemplateElement:uo,HTMLHtmlElement:class extends co{constructor(e,t="html"){super(e,t)}},HTMLScriptElement:go,HTMLFrameElement:class extends co{constructor(e,t="frame"){super(e,t)}},HTMLIFrameElement:yo,HTMLObjectElement:class extends co{constructor(e,t="object"){super(e,t)}},HTMLHeadElement:class extends co{constructor(e,t="head"){super(e,t)}},HTMLBodyElement:class extends co{constructor(e,t="body"){super(e,t)}},HTMLStyleElement:fs,HTMLTimeElement:class extends co{constructor(e,t="time"){super(e,t)}},HTMLFieldSetElement:class extends co{constructor(e,t="fieldset"){super(e,t)}},HTMLEmbedElement:class extends co{constructor(e,t="embed"){super(e,t)}},HTMLHRElement:class extends co{constructor(e,t="hr"){super(e,t)}},HTMLProgressElement:class extends co{constructor(e,t="progress"){super(e,t)}},HTMLParagraphElement:class extends co{constructor(e,t="p"){super(e,t)}},HTMLTableElement:class extends co{constructor(e,t="table"){super(e,t)}},HTMLFrameSetElement:class extends co{constructor(e,t="frameset"){super(e,t)}},HTMLLIElement:class extends co{constructor(e,t="li"){super(e,t)}},HTMLBaseElement:class extends co{constructor(e,t="base"){super(e,t)}},HTMLDataListElement:class extends co{constructor(e,t="datalist"){super(e,t)}},HTMLInputElement:gs,HTMLParamElement:class extends co{constructor(e,t="param"){super(e,t)}},HTMLMediaElement:class extends co{constructor(e,t="media"){super(e,t)}},HTMLAudioElement:class extends co{constructor(e,t="audio"){super(e,t)}},HTMLHeadingElement:ms,HTMLDirectoryElement:class extends co{constructor(e,t="dir"){super(e,t)}},HTMLQuoteElement:class extends co{constructor(e,t="quote"){super(e,t)}},HTMLCanvasElement:ws,HTMLLegendElement:class extends co{constructor(e,t="legend"){super(e,t)}},HTMLOptionElement:Es,HTMLSpanElement:class extends co{constructor(e,t="span"){super(e,t)}},HTMLMeterElement:class extends co{constructor(e,t="meter"){super(e,t)}},HTMLVideoElement:class extends co{constructor(e,t="video"){super(e,t)}},HTMLTableCellElement:class extends co{constructor(e,t="td"){super(e,t)}},HTMLTitleElement:Ss,HTMLOutputElement:class extends co{constructor(e,t="output"){super(e,t)}},HTMLTableRowElement:class extends co{constructor(e,t="tr"){super(e,t)}},HTMLDataElement:class extends co{constructor(e,t="data"){super(e,t)}},HTMLMenuElement:class extends co{constructor(e,t="menu"){super(e,t)}},HTMLSelectElement:Is,HTMLBRElement:class extends co{constructor(e,t="br"){super(e,t)}},HTMLButtonElement:ks,HTMLMapElement:class extends co{constructor(e,t="map"){super(e,t)}},HTMLOptGroupElement:class extends co{constructor(e,t="optgroup"){super(e,t)}},HTMLDListElement:class extends co{constructor(e,t="dl"){super(e,t)}},HTMLTextAreaElement:xs,HTMLFontElement:class extends co{constructor(e,t="font"){super(e,t)}},HTMLDivElement:class extends co{constructor(e,t="div"){super(e,t)}},HTMLLinkElement:Ls,HTMLSlotElement:Ns,HTMLFormElement:class extends co{constructor(e,t="form"){super(e,t)}},HTMLImageElement:js,HTMLPreElement:class extends co{constructor(e,t="pre"){super(e,t)}},HTMLUListElement:class extends co{constructor(e,t="ul"){super(e,t)}},HTMLMetaElement:Fs,HTMLPictureElement:class extends co{constructor(e,t="picture"){super(e,t)}},HTMLAreaElement:class extends co{constructor(e,t="area"){super(e,t)}},HTMLOListElement:class extends co{constructor(e,t="ol"){super(e,t)}},HTMLTableCaptionElement:class extends co{constructor(e,t="caption"){super(e,t)}},HTMLAnchorElement:Us,HTMLLabelElement:class extends co{constructor(e,t="label"){super(e,t)}},HTMLUnknownElement:class extends co{constructor(e,t="unknown"){super(e,t)}},HTMLModElement:class extends co{constructor(e,t="mod"){super(e,t)}},HTMLDetailsElement:class extends co{constructor(e,t="details"){super(e,t)}},HTMLSourceElement:Gs,HTMLTrackElement:class extends co{constructor(e,t="track"){super(e,t)}},HTMLMarqueeElement:class extends co{constructor(e,t="marquee"){super(e,t)}}},Hs={test:()=>!0},$s={"text/html":{docType:"<!DOCTYPE html>",ignoreCase:!0,voidElements:/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i},"image/svg+xml":{docType:'<?xml version="1.0" encoding="utf-8"?>',ignoreCase:!1,voidElements:Hs},"text/xml":{docType:'<?xml version="1.0" encoding="utf-8"?>',ignoreCase:!1,voidElements:Hs},"application/xml":{docType:'<?xml version="1.0" encoding="utf-8"?>',ignoreCase:!1,voidElements:Hs},"application/xhtml+xml":{docType:'<?xml version="1.0" encoding="utf-8"?>',ignoreCase:!1,voidElements:Hs}};class Ws extends Mi{constructor(e,t={}){super(e,t),this.detail=t.detail}}const zs=e=>class extends js{constructor(t,n){switch(super(e),arguments.length){case 1:this.height=t,this.width=t;break;case 2:this.height=n,this.width=t}}},Vs=({[w]:e,[u]:t},n=null)=>{Ht(e[v],t[m]);do{const r=Mt(e),i=r===t?r:r[m];n?n.insertBefore(e,n[u]):e.remove(),e=i}while(e!==t)};class Ks{constructor(){this[w]=null,this[u]=null,this.commonAncestorContainer=null}insertNode(e){this[u].parentNode.insertBefore(e,this[w])}selectNode(e){this[w]=e,this[u]=Mt(e)}selectNodeContents(e){this.selectNode(e),this.commonAncestorContainer=e}surroundContents(e){e.replaceChildren(this.extractContents())}setStartBefore(e){this[w]=e}setStartAfter(e){this[w]=e.nextSibling}setEndBefore(e){this[u]=Mt(e.previousSibling)}setEndAfter(e){this[u]=Mt(e)}cloneContents(){let{[w]:e,[u]:t}=this;const n=e.ownerDocument.createDocumentFragment();for(;e!==t;)n.insertBefore(e.cloneNode(!0),n[u]),e=Mt(e),e!==t&&(e=e[m]);return n}deleteContents(){Vs(this)}extractContents(){const e=this[w].ownerDocument.createDocumentFragment();return Vs(this,e),e}createContextualFragment(e){const{commonAncestorContainer:t}=this,n="ownerSVGElement"in t,r=n?t.ownerDocument:t,i=r.createElement("template");i.innerHTML=e;let{content:o}=i;if(n){const e=[...o.childNodes];o=r.createDocumentFragment(),Object.setPrototypeOf(o,zi.prototype),o.ownerSVGElement=r;for(const t of e)Object.setPrototypeOf(t,zi.prototype),t.ownerSVGElement=r,o.appendChild(t)}else this.selectNode(o);return o}cloneRange(){const e=new Ks;return e[w]=this[w],e[u]=this[u],e}}const Ys=({nodeType:e},t)=>{switch(e){case 1:return 1&t;case 3:return 4&t;case 8:return 128&t;case 4:return 8&t}return 0};class Qs{constructor(e,t=-1){this.root=e,this.currentNode=e,this.whatToShow=t;let{[m]:n,[u]:r}=e;if(9===e.nodeType){const{documentElement:t}=e;n=t,r=t[u]}const i=[];for(;n!==r;)Ys(n,t)&&i.push(n),n=n[m];this[b]={i:0,nodes:i}}nextNode(){const e=this[b];return this.currentNode=e.i<e.nodes.length?e.nodes[e.i++]:null,this.currentNode}}const Xs=(e,t,n)=>{let{[m]:r,[u]:i}=t;return e.call({ownerDocument:t,[m]:r,[u]:i},n)},Js=kt({},oo,qs,{CustomEvent:Ws,Event:Mi,EventTarget:In,InputEvent:class extends Mi{constructor(e,t={}){super(e,t),this.inputType=t.inputType,this.data=t.data,this.dataTransfer=t.dataTransfer,this.isComposing=t.isComposing||!1,this.ranges=t.ranges}},NamedNodeMap:Fi,NodeList:Cn}),Zs=new WeakMap;let ea=class extends fi{constructor(e){super(null,"#document",9),this[o]={active:!1,registry:null},this[g]={active:!1,class:null},this[p]=$s[e],this[c]=null,this[l]=null,this[h]=null,this[f]=null,this[E]=null}get defaultView(){return Zs.has(this)||Zs.set(this,new Proxy(globalThis,{set:(e,t,n)=>{switch(t){case"addEventListener":case"removeEventListener":case"dispatchEvent":this[d][t]=n;break;default:e[t]=n}return!0},get:(e,t)=>{switch(t){case"addEventListener":case"removeEventListener":case"dispatchEvent":if(!this[d]){const e=this[d]=new In;e.dispatchEvent=e.dispatchEvent.bind(e),e.addEventListener=e.addEventListener.bind(e),e.removeEventListener=e.removeEventListener.bind(e)}return this[d][t];case"document":return this;case"navigator":return{userAgent:"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36"};case"window":return Zs.get(this);case"customElements":return this[o].registry||(this[o]=new Zt(this)),this[o];case"performance":return an;case"DOMParser":return this[l];case"Image":return this[f]||(this[f]=zs(this)),this[f];case"MutationObserver":return this[g].class||(this[g]=new yn(this)),this[g].class}return this[h]&&this[h][t]||Js[t]||e[t]}})),Zs.get(this)}get doctype(){const e=this[c];if(e)return e;const{firstChild:t}=this;return t&&t.nodeType===St?this[c]=t:null}set doctype(e){if(/^([a-z:]+)(\s+system|\s+public(\s+"([^"]+)")?)?(\s+"([^"]+)")?/i.test(e)){const{$1:e,$4:t,$6:n}=RegExp;this[c]=new gi(this,e,t,n),Gt(this,this[c],this[m])}}get documentElement(){return this.firstElementChild}get isConnected(){return!0}_getParent(){return this[d]}createAttribute(e){return new Mn(this,e)}createCDATASection(e){return new Qn(this,e)}createComment(e){return new Xn(this,e)}createDocumentFragment(){return new pi(this)}createDocumentType(e,t,n){return new gi(this,e,t,n)}createElement(e){return new Hi(this,e)}createRange(){const e=new Ks;return e.commonAncestorContainer=this,e}createTextNode(e){return new li(this,e)}createTreeWalker(e,t=-1){return new Qs(e,t)}createNodeIterator(e,t=-1){return this.createTreeWalker(e,t)}createEvent(e){const t=Pt("Event"===e?new Mi(""):new Ws(""));return t.initEvent=t.initCustomEvent=(e,n=!1,r=!1,i)=>{t.bubbles=!!n,xt(t,{type:{value:e},canBubble:{value:n},cancelable:{value:r},detail:{value:i}})},t}cloneNode(e=!1){const{constructor:t,[o]:n,[c]:r}=this,i=new t;if(i[o]=n,e){const e=i[u],{childNodes:t}=this;for(let{length:n}=t,r=0;r<n;r++)i.insertBefore(t[r].cloneNode(!0),e);r&&(i[c]=t[0])}return i}importNode(e){const t=1<arguments.length&&!!arguments[1],n=e.cloneNode(t),{[o]:r}=this,{active:i}=r,s=e=>{const{ownerDocument:t,nodeType:n}=e;e.ownerDocument=this,i&&t!==this&&1===n&&r.upgrade(e)};if(s(n),t)switch(n.nodeType){case 1:case Ot:{let{[m]:e,[u]:t}=n;for(;e!==t;)1===e.nodeType&&s(e),e=e[m];break}}return n}toString(){return this.childNodes.join("")}querySelector(e){return Xs(super.querySelector,this,e)}querySelectorAll(e){return Xs(super.querySelectorAll,this,e)}getElementsByTagNameNS(e,t){return this.getElementsByTagName(t)}createAttributeNS(e,t){return this.createAttribute(t)}createElementNS(e,t,n){return e===Ct?new zi(this,t,null):this.createElement(t,n)}};Nt(Js.Document=function(){Vi()},ea).prototype=ea.prototype;class ta extends ea{constructor(){super("text/html")}get all(){const e=new Cn;let{[m]:t,[u]:n}=this;for(;t!==n;){if(1===t.nodeType)e.push(t);t=t[m]}return e}get head(){const{documentElement:e}=this;let{firstElementChild:t}=e;return t&&"HEAD"===t.tagName||(t=this.createElement("head"),e.prepend(t)),t}get body(){const{head:e}=this;let{nextElementSibling:t}=e;return t&&"BODY"===t.tagName||(t=this.createElement("body"),e.after(t)),t}get title(){const{head:e}=this;let t=e.getElementsByTagName("title").shift();return t?t.textContent:""}set title(e){const{head:t}=this;let n=t.getElementsByTagName("title").shift();n?n.textContent=e:t.insertBefore(this.createElement("title"),t.firstChild).textContent=e}createElement(e,t){const n=!(!t||!t.is),r=((e,t,n,r)=>{if(!t&&on.has(n))return new(on.get(n))(e,n);const{[o]:{active:i,registry:s}}=e;if(i){const i=t?r.is:n;if(s.has(i)){const{Class:t}=s.get(i),r=new t(e,n);return Vt.set(r,{connected:!1}),r}}return new co(e,n)})(this,n,e,t);return n&&r.setAttribute("is",t.is),r}}class na extends ea{constructor(){super("image/svg+xml")}toString(){return this[p].docType+super.toString()}}class ra extends ea{constructor(){super("text/xml")}toString(){return this[p].docType+super.toString()}}class ia{parseFromString(e,t,n=null){let r,i=!1;return"text/html"===t?(i=!0,r=new ta):r="image/svg+xml"===t?new na:new ra,r[l]=ia,n&&(r[h]=n),i&&"..."===e&&(e="<!doctype html><html><head></head><body></body></html>"),e?rn(r,i,e):r}}const{parse:oa}=JSON;const sa=(e,t=null)=>(new ia).parseFromString(e,"text/html",t).defaultView;Nt((function(){Vi()}),ea).prototype=ea.prototype},function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n(2),i=n(29);function o(t,n,o){var s;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=(null===(s=e.env.REACT_APP_FIREBASE_PROJECT_ID)||void 0===s?void 0:s.includes("staging"))||!1?i.b.staging:i.b.production,a="https://www.youtube.com/watch?v="+t,c=yield fetch(r+"/youtube-transcripts",{method:"POST",body:JSON.stringify({originalUrl:a,getRawTranscript:null!=o&&o,language:null!=n?n:"en"}),headers:{"Content-Type":"application/json"}});let l=null;return l=o?yield c.json():yield c.text(),l}))}function s(t){var n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=(null===(n=e.env.REACT_APP_FIREBASE_PROJECT_ID)||void 0===n?void 0:n.includes("staging"))||!1?i.b.staging:i.b.production,o="https://www.youtube.com/watch?v="+t,s=yield fetch(r+"/youtube-transcripts-languages",{method:"POST",body:JSON.stringify({url:o}),headers:{"Content-Type":"application/json"}});let a=null;return a=yield s.json(),a}))}}).call(this,n(131))},,function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s}));const r=e=>!!e.childOf||!!e.singleChildOf,i=e=>e.singleChildOf||e.childOf,o=e=>!!e.connects,s=e=>!!e.relationship},function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(187),i=n(242);const o=(e,t)=>n=>{if(!(null==n?void 0:n.length))return new Set;const{text:i}=e(n,{});return(null==i?void 0:i.length)?new Set(a(i,{separator:null!=t?t:r.a})):new Set};t.a=o(i.c);const s=o(i.b),a=(e,{separator:t=r.a})=>e.split(t).map((e=>e.toLowerCase())).filter((e=>e.length))},function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return h})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return g}));var r=n(507),i=n(875),o=n(34),s=n(1054),a=n(781),c=n(715),l=n(890),u=n(43);const d=new Date("2019-09-09"),h=3e5,f=[r.b.bookmark,r.b.visit,r.b.page,r.b.pageMetadata,r.b.pageEntity,r.b.locator,i.b.tag,o.b.list,o.b.listTrees,o.b.listEntry,o.b.listTrees,o.b.listDescription,u.a.settings,c.b.templates,a.b.annotation,a.b.listEntry,l.a.annotationPrivacy,l.a.listMetadata,l.a.annotationMetadata,s.b.followedList,s.b.followedListEntry],p="personal-cloud-periodic-sync-download",g="personal-cloud-action-queue-retry"},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return c}));var r=n(2),i=n(34),o=n(344);const s={moveTree:"moveListTree",deleteTree:"deleteListTree"};class a{constructor(e){this.options=e,this.process=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t,n,r,o,a;if(e.operation[0]!==s.deleteTree||e.operation[1]!==i.b.listTrees){if(e.operation[0]!==s.moveTree||e.operation[1]!==i.b.listTrees)return e.next.process(e);{const t=null===(r=e.operation[2])||void 0===r?void 0:r.localListId,n=null===(o=e.operation[2])||void 0===o?void 0:o.newParentListId,i=null===(a=e.operation[2])||void 0===a?void 0:a.now;null!=t&&(yield this.options.moveTree({localListId:t,newParentListId:n,now:i}))}}else{const r=null===(t=e.operation[2])||void 0===t?void 0:t.localListId,i=null===(n=e.operation[2])||void 0===n?void 0:n.now;null!=r&&(yield this.options.deleteTree({localListId:r,now:i}))}}))}}const c=e=>({[s.moveTree]:([t,n,i,{skipSync:s}={skipSync:!1}])=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){return s||(yield e.handleListTreeStorageChange({type:o.c.ListTreeMove,parentLocalListId:i.newParentListId,rootNodeLocalListId:i.localListId})),{}})),[s.deleteTree]:([t,n,i,{skipSync:s}={skipSync:!1}])=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){return s||(yield e.handleListTreeStorageChange({type:o.c.ListTreeDelete,rootNodeLocalListId:i.localListId})),{}}))})},function(e,t,n){var r=n(232)("noop",n(345),n(787));r.placeholder=n(164),e.exports=r},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r=/^\d+$/;function i(e){const t=e.toString();return r.test(t)?parseInt(t):e}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(62);const i={templates:"templates"},o={[i.templates]:{version:r.a[37].version,fields:{id:{type:"int"},title:{type:"string"},code:{type:"string"},order:{type:"int",optional:!0},isFavourite:{type:"boolean"},outputFormat:{type:"string",optional:!0}},indices:[{field:"id",pk:!0},{field:"title"},{field:"code"},{field:"isFavourite"}],history:[{version:r.a[29].version,fields:{id:{type:"int"},title:{type:"string"},code:{type:"string"},isFavourite:{type:"boolean"},outputFormat:{type:"string",optional:!0}},indices:[{field:"id",pk:!0},{field:"title"},{field:"code"},{field:"isFavourite"}]},{version:r.a[19].version,fields:{id:{type:"int"},title:{type:"string"},code:{type:"string"},isFavourite:{type:"boolean"}},indices:[{field:"id",pk:!0},{field:"title"},{field:"code"},{field:"isFavourite"}]}]}}},,,function(e,t,n){"use strict";var r="(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])(?:\\.(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])){3}",i="(?:(?:[0-9a-fA-F:]){1,4}(?:(?::(?:[0-9a-fA-F]){1,4}|:)){2,7})+",o=e.exports=function(e){return(e=e||{}).exact?new RegExp("(?:^"+r+"$)|(?:^"+i+"$)"):new RegExp("(?:"+r+")|(?:"+i+")","g")};o.v4=function(e){return(e=e||{}).exact?new RegExp("^"+r+"$"):new RegExp(r,"g")},o.v6=function(e){return(e=e||{}).exact?new RegExp("^"+i+"$"):new RegExp(i,"g")}},function(e,t){e.exports=["aaa","aarp","abarth","abb","abbott","abbvie","abc","able","abogado","abudhabi","ac","academy","accenture","accountant","accountants","aco","active","actor","ad","adac","ads","adult","ae","aeg","aero","aetna","af","afamilycompany","afl","africa","ag","agakhan","agency","ai","aig","aigo","airbus","airforce","airtel","akdn","al","alfaromeo","alibaba","alipay","allfinanz","allstate","ally","alsace","alstom","am","americanexpress","americanfamily","amex","amfam","amica","amsterdam","analytics","android","anquan","anz","ao","aol","apartments","app","apple","aq","aquarelle","ar","arab","aramco","archi","army","arpa","art","arte","as","asda","asia","associates","at","athleta","attorney","au","auction","audi","audible","audio","auspost","author","auto","autos","avianca","aw","aws","ax","axa","az","azure","ba","baby","baidu","banamex","bananarepublic","band","bank","bar","barcelona","barclaycard","barclays","barefoot","bargains","baseball","basketball","bauhaus","bayern","bb","bbc","bbt","bbva","bcg","bcn","bd","be","beats","beauty","beer","bentley","berlin","best","bestbuy","bet","bf","bg","bh","bharti","bi","bible","bid","bike","bing","bingo","bio","biz","bj","black","blackfriday","blanco","blockbuster","blog","bloomberg","blue","bm","bms","bmw","bn","bnl","bnpparibas","bo","boats","boehringer","bofa","bom","bond","boo","book","booking","bosch","bostik","boston","bot","boutique","box","br","bradesco","bridgestone","broadway","broker","brother","brussels","bs","bt","budapest","bugatti","build","builders","business","buy","buzz","bv","bw","by","bz","bzh","ca","cab","cafe","cal","call","calvinklein","cam","camera","camp","cancerresearch","canon","capetown","capital","capitalone","car","caravan","cards","care","career","careers","cars","cartier","casa","case","caseih","cash","casino","cat","catering","catholic","cba","cbn","cbre","cbs","cc","cd","ceb","center","ceo","cern","cf","cfa","cfd","cg","ch","chanel","channel","chase","chat","cheap","chintai","christmas","chrome","chrysler","church","ci","cipriani","circle","cisco","citadel","citi","citic","city","cityeats","ck","cl","claims","cleaning","click","clinic","clinique","clothing","cloud","club","clubmed","cm","cn","co","coach","codes","coffee","college","cologne","com","comcast","commbank","community","company","compare","computer","comsec","condos","construction","consulting","contact","contractors","cooking","cookingchannel","cool","coop","corsica","country","coupon","coupons","courses","cr","credit","creditcard","creditunion","cricket","crown","crs","cruise","cruises","csc","cu","cuisinella","cv","cw","cx","cy","cymru","cyou","cz","dabur","dad","dance","data","date","dating","datsun","day","dclk","dds","de","deal","dealer","deals","degree","delivery","dell","deloitte","delta","democrat","dental","dentist","desi","design","dev","dhl","diamonds","diet","digital","direct","directory","discount","discover","dish","diy","dj","dk","dm","dnp","do","docs","doctor","dodge","dog","doha","domains","dot","download","drive","dtv","dubai","duck","dunlop","duns","dupont","durban","dvag","dvr","dz","earth","eat","ec","eco","edeka","edu","education","ee","eg","email","emerck","energy","engineer","engineering","enterprises","epost","epson","equipment","er","ericsson","erni","es","esq","estate","esurance","et","etisalat","eu","eurovision","eus","events","everbank","exchange","expert","exposed","express","extraspace","fage","fail","fairwinds","faith","family","fan","fans","farm","farmers","fashion","fast","fedex","feedback","ferrari","ferrero","fi","fiat","fidelity","fido","film","final","finance","financial","fire","firestone","firmdale","fish","fishing","fit","fitness","fj","fk","flickr","flights","flir","florist","flowers","fly","fm","fo","foo","food","foodnetwork","football","ford","forex","forsale","forum","foundation","fox","fr","free","fresenius","frl","frogans","frontdoor","frontier","ftr","fujitsu","fujixerox","fun","fund","furniture","futbol","fyi","ga","gal","gallery","gallo","gallup","game","games","gap","garden","gb","gbiz","gd","gdn","ge","gea","gent","genting","george","gf","gg","ggee","gh","gi","gift","gifts","gives","giving","gl","glade","glass","gle","global","globo","gm","gmail","gmbh","gmo","gmx","gn","godaddy","gold","goldpoint","golf","goo","goodhands","goodyear","goog","google","gop","got","gov","gp","gq","gr","grainger","graphics","gratis","green","gripe","grocery","group","gs","gt","gu","guardian","gucci","guge","guide","guitars","guru","gw","gy","hair","hamburg","hangout","haus","hbo","hdfc","hdfcbank","health","healthcare","help","helsinki","here","hermes","hgtv","hiphop","hisamitsu","hitachi","hiv","hk","hkt","hm","hn","hockey","holdings","holiday","homedepot","homegoods","homes","homesense","honda","honeywell","horse","hospital","host","hosting","hot","hoteles","hotels","hotmail","house","how","hr","hsbc","ht","hu","hughes","hyatt","hyundai","ibm","icbc","ice","icu","id","ie","ieee","ifm","ikano","il","im","imamat","imdb","immo","immobilien","in","industries","infiniti","info","ing","ink","institute","insurance","insure","int","intel","international","intuit","investments","io","ipiranga","iq","ir","irish","is","iselect","ismaili","ist","istanbul","it","itau","itv","iveco","iwc","jaguar","java","jcb","jcp","je","jeep","jetzt","jewelry","jio","jlc","jll","jm","jmp","jnj","jo","jobs","joburg","jot","joy","jp","jpmorgan","jprs","juegos","juniper","kaufen","kddi","ke","kerryhotels","kerrylogistics","kerryproperties","kfh","kg","kh","ki","kia","kim","kinder","kindle","kitchen","kiwi","km","kn","koeln","komatsu","kosher","kp","kpmg","kpn","kr","krd","kred","kuokgroup","kw","ky","kyoto","kz","la","lacaixa","ladbrokes","lamborghini","lamer","lancaster","lancia","lancome","land","landrover","lanxess","lasalle","lat","latino","latrobe","law","lawyer","lb","lc","lds","lease","leclerc","lefrak","legal","lego","lexus","lgbt","li","liaison","lidl","life","lifeinsurance","lifestyle","lighting","like","lilly","limited","limo","lincoln","linde","link","lipsy","live","living","lixil","lk","llc","loan","loans","locker","locus","loft","lol","london","lotte","lotto","love","lpl","lplfinancial","lr","ls","lt","ltd","ltda","lu","lundbeck","lupin","luxe","luxury","lv","ly","ma","macys","madrid","maif","maison","makeup","man","management","mango","map","market","marketing","markets","marriott","marshalls","maserati","mattel","mba","mc","mckinsey","md","me","med","media","meet","melbourne","meme","memorial","men","menu","meo","merckmsd","metlife","mg","mh","miami","microsoft","mil","mini","mint","mit","mitsubishi","mk","ml","mlb","mls","mm","mma","mn","mo","mobi","mobile","mobily","moda","moe","moi","mom","monash","money","monster","mopar","mormon","mortgage","moscow","moto","motorcycles","mov","movie","movistar","mp","mq","mr","ms","msd","mt","mtn","mtr","mu","museum","mutual","mv","mw","mx","my","mz","na","nab","nadex","nagoya","name","nationwide","natura","navy","nba","nc","ne","nec","net","netbank","netflix","network","neustar","new","newholland","news","next","nextdirect","nexus","nf","nfl","ng","ngo","nhk","ni","nico","nike","nikon","ninja","nissan","nissay","nl","no","nokia","northwesternmutual","norton","now","nowruz","nowtv","np","nr","nra","nrw","ntt","nu","nyc","nz","obi","observer","off","office","okinawa","olayan","olayangroup","oldnavy","ollo","om","omega","one","ong","onl","online","onyourside","ooo","open","oracle","orange","org","organic","origins","osaka","otsuka","ott","ovh","pa","page","panasonic","panerai","paris","pars","partners","parts","party","passagens","pay","pccw","pe","pet","pf","pfizer","pg","ph","pharmacy","phd","philips","phone","photo","photography","photos","physio","piaget","pics","pictet","pictures","pid","pin","ping","pink","pioneer","pizza","pk","pl","place","play","playstation","plumbing","plus","pm","pn","pnc","pohl","poker","politie","porn","post","pr","pramerica","praxi","press","prime","pro","prod","productions","prof","progressive","promo","properties","property","protection","pru","prudential","ps","pt","pub","pw","pwc","py","qa","qpon","quebec","quest","qvc","racing","radio","raid","re","read","realestate","realtor","realty","recipes","red","redstone","redumbrella","rehab","reise","reisen","reit","reliance","ren","rent","rentals","repair","report","republican","rest","restaurant","review","reviews","rexroth","rich","richardli","ricoh","rightathome","ril","rio","rip","rmit","ro","rocher","rocks","rodeo","rogers","room","rs","rsvp","ru","rugby","ruhr","run","rw","rwe","ryukyu","sa","saarland","safe","safety","sakura","sale","salon","samsclub","samsung","sandvik","sandvikcoromant","sanofi","sap","sapo","sarl","sas","save","saxo","sb","sbi","sbs","sc","sca","scb","schaeffler","schmidt","scholarships","school","schule","schwarz","science","scjohnson","scor","scot","sd","se","search","seat","secure","security","seek","select","sener","services","ses","seven","sew","sex","sexy","sfr","sg","sh","shangrila","sharp","shaw","shell","shia","shiksha","shoes","shop","shopping","shouji","show","showtime","shriram","si","silk","sina","singles","site","sj","sk","ski","skin","sky","skype","sl","sling","sm","smart","smile","sn","sncf","so","soccer","social","softbank","software","sohu","solar","solutions","song","sony","soy","space","spiegel","sport","spot","spreadbetting","sr","srl","srt","st","stada","staples","star","starhub","statebank","statefarm","statoil","stc","stcgroup","stockholm","storage","store","stream","studio","study","style","su","sucks","supplies","supply","support","surf","surgery","suzuki","sv","swatch","swiftcover","swiss","sx","sy","sydney","symantec","systems","sz","tab","taipei","talk","taobao","target","tatamotors","tatar","tattoo","tax","taxi","tc","tci","td","tdk","team","tech","technology","tel","telecity","telefonica","temasek","tennis","teva","tf","tg","th","thd","theater","theatre","tiaa","tickets","tienda","tiffany","tips","tires","tirol","tj","tjmaxx","tjx","tk","tkmaxx","tl","tm","tmall","tn","to","today","tokyo","tools","top","toray","toshiba","total","tours","town","toyota","toys","tr","trade","trading","training","travel","travelchannel","travelers","travelersinsurance","trust","trv","tt","tube","tui","tunes","tushu","tv","tvs","tw","tz","ua","ubank","ubs","uconnect","ug","uk","unicom","university","uno","uol","ups","us","uy","uz","va","vacations","vana","vanguard","vc","ve","vegas","ventures","verisign","versicherung","vet","vg","vi","viajes","video","vig","viking","villas","vin","vip","virgin","visa","vision","vista","vistaprint","viva","vivo","vlaanderen","vn","vodka","volkswagen","volvo","vote","voting","voto","voyage","vu","vuelos","wales","walmart","walter","wang","wanggou","warman","watch","watches","weather","weatherchannel","webcam","weber","website","wed","wedding","weibo","weir","wf","whoswho","wien","wiki","williamhill","win","windows","wine","winners","wme","wolterskluwer","woodside","work","works","world","wow","ws","wtc","wtf","xbox","xerox","xfinity","xihuan","xin","\u0915\u0949\u092e","\u30bb\u30fc\u30eb","\u4f5b\u5c71","\u0cad\u0cbe\u0cb0\u0ca4","\u6148\u5584","\u96c6\u56e2","\u5728\u7ebf","\ud55c\uad6d","\u0b2d\u0b3e\u0b30\u0b24","\u5927\u4f17\u6c7d\u8f66","\u70b9\u770b","\u0e04\u0e2d\u0e21","\u09ad\u09be\u09f0\u09a4","\u09ad\u09be\u09b0\u09a4","\u516b\u5366","\u0645\u0648\u0642\u0639","\u09ac\u09be\u0982\u09b2\u09be","\u516c\u76ca","\u516c\u53f8","\u9999\u683c\u91cc\u62c9","\u7f51\u7ad9","\u79fb\u52a8","\u6211\u7231\u4f60","\u043c\u043e\u0441\u043a\u0432\u0430","\u049b\u0430\u0437","\u043a\u0430\u0442\u043e\u043b\u0438\u043a","\u043e\u043d\u043b\u0430\u0439\u043d","\u0441\u0430\u0439\u0442","\u8054\u901a","\u0441\u0440\u0431","\u0431\u0433","\u0431\u0435\u043b","\u05e7\u05d5\u05dd","\u65f6\u5c1a","\u5fae\u535a","\u6de1\u9a6c\u9521","\u30d5\u30a1\u30c3\u30b7\u30e7\u30f3","\u043e\u0440\u0433","\u0928\u0947\u091f","\u30b9\u30c8\u30a2","\uc0bc\uc131","\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd","\u5546\u6807","\u5546\u5e97","\u5546\u57ce","\u0434\u0435\u0442\u0438","\u043c\u043a\u0434","\u0435\u044e","\u30dd\u30a4\u30f3\u30c8","\u65b0\u95fb","\u5de5\u884c","\u5bb6\u96fb","\u0643\u0648\u0645","\u4e2d\u6587\u7f51","\u4e2d\u4fe1","\u4e2d\u56fd","\u4e2d\u570b","\u5a31\u4e50","\u8c37\u6b4c","\u0c2d\u0c3e\u0c30\u0c24\u0c4d","\u0dbd\u0d82\u0d9a\u0dcf","\u96fb\u8a0a\u76c8\u79d1","\u8d2d\u7269","\u30af\u30e9\u30a6\u30c9","\u0aad\u0abe\u0ab0\u0aa4","\u901a\u8ca9","\u092d\u093e\u0930\u0924\u092e\u094d","\u092d\u093e\u0930\u0924","\u092d\u093e\u0930\u094b\u0924","\u7f51\u5e97","\u0938\u0902\u0917\u0920\u0928","\u9910\u5385","\u7f51\u7edc","\u043a\u043e\u043c","\u0443\u043a\u0440","\u9999\u6e2f","\u8bfa\u57fa\u4e9a","\u98df\u54c1","\u98de\u5229\u6d66","\u53f0\u6e7e","\u53f0\u7063","\u624b\u8868","\u624b\u673a","\u043c\u043e\u043d","\u0627\u0644\u062c\u0632\u0627\u0626\u0631","\u0639\u0645\u0627\u0646","\u0627\u0631\u0627\u0645\u0643\u0648","\u0627\u06cc\u0631\u0627\u0646","\u0627\u0644\u0639\u0644\u064a\u0627\u0646","\u0627\u062a\u0635\u0627\u0644\u0627\u062a","\u0627\u0645\u0627\u0631\u0627\u062a","\u0628\u0627\u0632\u0627\u0631","\u067e\u0627\u06a9\u0633\u062a\u0627\u0646","\u0627\u0644\u0627\u0631\u062f\u0646","\u0645\u0648\u0628\u0627\u064a\u0644\u064a","\u0628\u0627\u0631\u062a","\u0628\u06be\u0627\u0631\u062a","\u0627\u0644\u0645\u063a\u0631\u0628","\u0627\u0628\u0648\u0638\u0628\u064a","\u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629","\u0680\u0627\u0631\u062a","\u0643\u0627\u062b\u0648\u0644\u064a\u0643","\u0633\u0648\u062f\u0627\u0646","\u0647\u0645\u0631\u0627\u0647","\u0639\u0631\u0627\u0642","\u0645\u0644\u064a\u0633\u064a\u0627","\u6fb3\u9580","\ub2f7\ucef4","\u653f\u5e9c","\u0634\u0628\u0643\u0629","\u0628\u064a\u062a\u0643","\u0639\u0631\u0628","\u10d2\u10d4","\u673a\u6784","\u7ec4\u7ec7\u673a\u6784","\u5065\u5eb7","\u0e44\u0e17\u0e22","\u0633\u0648\u0631\u064a\u0629","\u62db\u8058","\u0440\u0443\u0441","\u0440\u0444","\u73e0\u5b9d","\u062a\u0648\u0646\u0633","\u5927\u62ff","\u307f\u3093\u306a","\u30b0\u30fc\u30b0\u30eb","\u03b5\u03bb","\u4e16\u754c","\u66f8\u7c4d","\u0d2d\u0d3e\u0d30\u0d24\u0d02","\u0a2d\u0a3e\u0a30\u0a24","\u7f51\u5740","\ub2f7\ub137","\u30b3\u30e0","\u5929\u4e3b\u6559","\u6e38\u620f","verm\xf6gensberater","verm\xf6gensberatung","\u4f01\u4e1a","\u4fe1\u606f","\u5609\u91cc\u5927\u9152\u5e97","\u5609\u91cc","\u0645\u0635\u0631","\u0642\u0637\u0631","\u5e7f\u4e1c","\u0b87\u0bb2\u0b99\u0bcd\u0b95\u0bc8","\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe","\u0570\u0561\u0575","\u65b0\u52a0\u5761","\u0641\u0644\u0633\u0637\u064a\u0646","\u653f\u52a1","xperia","xxx","xyz","yachts","yahoo","yamaxun","yandex","ye","yodobashi","yoga","yokohama","you","youtube","yt","yun","za","zappos","zara","zero","zip","zippo","zm","zone","zuerich","zw"]},,function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));var r=n(2),i=n(361),o=n(217),s=n.n(o),a=n(242);function c(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=new Map,[o,a]=yield Promise.all([e.queryPages(e.terms,e.phrases),e.queryAnnotations(e.terms,e.phrases)]),c=s()(a,(e=>e.pageUrl));for(const[e,t]of Object.entries(c)){const n=t.sort(((e,t)=>t.lastEdited.valueOf()-e.lastEdited.valueOf()));r.set(e,{annotations:n,latestPageTimestamp:n[0].lastEdited.valueOf(),oldestTimestamp:0})}for(const{id:e,latestTimestamp:i}of o){const o=null!==(n=null===(t=r.get(e))||void 0===t?void 0:t.annotations)&&void 0!==n?n:[];r.set(e,{annotations:o,latestPageTimestamp:i,oldestTimestamp:0})}yield Object(i.a)(e.storageManager,r,e);const l=Object(i.d)(r),u=Object(i.c)(l,e);return{oldestResultTimestamp:null,resultDataByPage:u,resultsExhausted:u.size<e.limit}}))}const l=e=>{let t=new Set,n=new Set,r=e.trim().toLocaleLowerCase(),i=!0,o=!0,s=!0,c=!0,l=!1;r.includes("*")&&(l=!0,r=r.replace(/\*/g,""));let u=e.match(/"[^"]+"/g);null==u||u.forEach((e=>{n.add(e.slice(1,-1)),r=r.replace(e," ")})),r=r.replace(/\s+/g," ").trim(),r=Object(a.a)(r);let d=r.split(" ").filter(Boolean);for(let e of d){e.split(/\s+/).filter(Boolean).forEach((e=>{switch(e){case"intitle":i=!0,o=!1,s=!1,c=!1;break;case"incontent":i=!1,o=!0,s=!1,c=!1;break;case"inhighlight":i=!1,o=!1,s=!0,c=!1;break;case"incomment":i=!1,o=!1,s=!1,c=!0;break;default:t.add(e)}}))}return{terms:[...t],phrases:[...n],inTitle:i,inContent:o,inHighlight:s,inComment:c,matchTermsFuzzyStartsWith:l}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n(2);const i="is-logging-paused";function o({url:e}){const t=[/^https?:\/\/.+$/,/file=.+(\.pdf)$/],n=[".svg",".jpg",".png",".jpeg",".gif"];for(const t of n)if(e.endsWith(t))return!1;for(const n of t)if(n.test(e))return!0;return!1}const s=()=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){switch((yield browser.storage.local.get(i))[i]){case 0:case 1:return!0;default:return!1}}))},,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var r=n(1079);n(1526),n(1235),n(1527);const i={apiKey:"AIzaSyDZhd-4XonvNk5jpg2a5F2_XmKb3G2jI9U",authDomain:"worldbrain-1057.firebaseapp.com",projectId:"worldbrain-1057",messagingSenderId:"455172385517",appId:"1:455172385517:web:ad25d7f0325f2ddc0c3ae4",measurementId:e.env.FIREBASE_MEMEX_MEASUREMENT_ID,storageBucket:"worldbrain-1057.appspot.com"},o=()=>(r.a.apps.length||r.a.initializeApp(i),r.a)}).call(this,n(131))},,function(e,t,n){"use strict";n.d(t,"b",(function(){return l}));var r=n(2),i=n(3),o=n.n(i),s=n(162);const a={type:"basic",iconUrl:"/img/worldbrain-logo-narrow.png",requireInteraction:!0};const c=new class{constructor(e){this.props=e,this.onClickListeners=new Map,this.create=(e,t=e=>e)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.props.notificationsAPI.create(this.filterOpts(Object.assign(Object.assign({},a),e)));this.onClickListeners.set(n,t)})),this.setupListeners=()=>this.props.notificationsAPI.onClicked.addListener((e=>{this.props.notificationsAPI.clear(e),this.onClickListeners.get(e)(e),this.onClickListeners.delete(e)}))}filterOpts(e){var{type:t,iconUrl:n,title:i,message:o}=e,s=Object(r.__rest)(e,["type","iconUrl","title","message"]);const a={type:t,iconUrl:n,title:i,message:o};return"firefox"===this.props.browser?a:Object.assign(Object.assign({},a),s)}}({notificationsAPI:o.a.notifications,browser:Object(s.a)()}),l=c.setupListeners;t.a=c.create},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s}));var r=n(2);function i(e){const t=[];return null==e||null==e.features||Object.keys(e.features).forEach((n=>{c(e.features[n])&&t.push(n)})),t}function o(e){const t=[];if(null==e||null==e.subscriptions)return t;for(const[n,r]of Object.entries(e.subscriptions))c(r)&&t.push(n);return t}function s(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!e.claims)return!1;if("beta"===e.feature&&(yield e.settings.get("beta")))return!0;if(!e.claims.features)return!1;const t=e.claims.features[e.feature];return!!t&&c(t)}))}const a=()=>Math.round((new Date).getTime()/1e3);function c(e){return null!=e.expiry&&e.expiry>a()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(2),i=n(321);class o extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class s extends o{}class a extends o{}var c=n(514);class l extends i.a{install(e){super.install(e),e.registerOperation(l.SUGGEST_OP_ID,this.suggest.bind(this)),e.registerOperation(l.SUGGEST_OBJS_OP_ID,this.suggestObjects.bind(this)),e.registerOperation(l.SUGGEST_EXT_OP_ID,this.suggestExtended.bind(this))}suggest({query:e="",type:t,limit:n=10}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=this.backend.dexieInstance,i=t=>t.startsWithIgnoreCase(e).limit(n).uniqueKeys().catch(Object(c.a)([]));if("domain"===t){const e=yield i(r.table("pages").where("domain")),t=yield i(r.table("pages").where("hostname"));return[...new Set([...e,...t])]}return i(r.table("tags").where("name"))}))}suggestObjects({collection:e,query:t,options:n={}}){var i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=this.backend.dexieInstance,[[o,c],...l]=Object.entries(t);if(l.length>1)throw new s("`suggestObjects` only supports querying a single field.");const u=c.split(/\s+/).filter(Boolean),d=r.table(e).where(o),h=n.ignoreCase&&n.ignoreCase.length&&n.ignoreCase[0]===o;let f=h?d.startsWithAnyOfIgnoreCase(u):d.startsWithAnyOf(u);if(n.ignoreCase&&n.ignoreCase[0]!==o)throw new a(`Specified ignoreCase field '${n.ignoreCase[0]}' is not in filter query`);f=f.limit(n.limit||10),n.reverse&&(f=f.reverse());let p=[];const g=[],m=null!==(i=n.multiEntryAssocField)&&void 0!==i?i:o,y=e=>h?e.toLocaleLowerCase():e;return(yield f.distinct().and((e=>u.reduce(((t,n)=>{const r=e[m];return!(!r||"string"!=typeof r)&&(t&&y(r).includes(y(n)))}),!0))).toArray()).forEach((e=>{g.push(e.id),p.push(e[m])})),p.map(((t,n)=>({suggestion:t,collection:e,pk:g[n]})))}))}suggestExtended({notInclude:e=[],type:t,limit:n=20}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=this.backend.dexieInstance,i=t=>t.noneOf(e).limit(n).uniqueKeys().catch(Object(c.a)([]));if("domain"===t){const e=yield i(r.table("pages").where("domain")),t=yield i(r.table("pages").where("hostname"));return[...new Set([...e,...t])]}return i(r.table("tags").where("name"))}))}}l.SUGGEST_OP_ID="memex:dexie.suggest",l.SUGGEST_OBJS_OP_ID="memex:dexie.suggestObjects",l.SUGGEST_EXT_OP_ID="memex:dexie.extendedSuggest"},function(e,t,n){var r=n(898),i=n(899),o=n(193),s=n(41);e.exports=function(e,t){return function(n,a){var c=s(n)?r:i,l=t?t():{};return c(n,e,o(a,2),l)}}},function(e,t,n){(function(r){t.log=function(...e){return"object"==typeof console&&console.log&&console.log(...e)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n(1321)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n(131))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.decodeXMLStrict=t.decodeHTML5Strict=t.decodeHTML4Strict=t.decodeHTML5=t.decodeHTML4=t.decodeHTMLAttribute=t.decodeHTMLStrict=t.decodeHTML=t.decodeXML=t.DecodingMode=t.EntityDecoder=t.encodeHTML5=t.encodeHTML4=t.encodeNonAsciiHTML=t.encodeHTML=t.escapeText=t.escapeAttribute=t.escapeUTF8=t.escape=t.encodeXML=t.encode=t.decodeStrict=t.decode=t.EncodingMode=t.EntityLevel=void 0;var r,i,o=n(335),s=n(602),a=n(509);function c(e,t){if(void 0===t&&(t=r.XML),("number"==typeof t?t:t.level)===r.HTML){var n="object"==typeof t?t.mode:void 0;return(0,o.decodeHTML)(e,n)}return(0,o.decodeXML)(e)}!function(e){e[e.XML=0]="XML",e[e.HTML=1]="HTML"}(r=t.EntityLevel||(t.EntityLevel={})),function(e){e[e.UTF8=0]="UTF8",e[e.ASCII=1]="ASCII",e[e.Extensive=2]="Extensive",e[e.Attribute=3]="Attribute",e[e.Text=4]="Text"}(i=t.EncodingMode||(t.EncodingMode={})),t.decode=c,t.decodeStrict=function(e,t){var n;void 0===t&&(t=r.XML);var i="number"==typeof t?{level:t}:t;return null!==(n=i.mode)&&void 0!==n||(i.mode=o.DecodingMode.Strict),c(e,i)},t.encode=function(e,t){void 0===t&&(t=r.XML);var n="number"==typeof t?{level:t}:t;return n.mode===i.UTF8?(0,a.escapeUTF8)(e):n.mode===i.Attribute?(0,a.escapeAttribute)(e):n.mode===i.Text?(0,a.escapeText)(e):n.level===r.HTML?n.mode===i.ASCII?(0,s.encodeNonAsciiHTML)(e):(0,s.encodeHTML)(e):(0,a.encodeXML)(e)};var l=n(509);Object.defineProperty(t,"encodeXML",{enumerable:!0,get:function(){return l.encodeXML}}),Object.defineProperty(t,"escape",{enumerable:!0,get:function(){return l.escape}}),Object.defineProperty(t,"escapeUTF8",{enumerable:!0,get:function(){return l.escapeUTF8}}),Object.defineProperty(t,"escapeAttribute",{enumerable:!0,get:function(){return l.escapeAttribute}}),Object.defineProperty(t,"escapeText",{enumerable:!0,get:function(){return l.escapeText}});var u=n(602);Object.defineProperty(t,"encodeHTML",{enumerable:!0,get:function(){return u.encodeHTML}}),Object.defineProperty(t,"encodeNonAsciiHTML",{enumerable:!0,get:function(){return u.encodeNonAsciiHTML}}),Object.defineProperty(t,"encodeHTML4",{enumerable:!0,get:function(){return u.encodeHTML}}),Object.defineProperty(t,"encodeHTML5",{enumerable:!0,get:function(){return u.encodeHTML}});var d=n(335);Object.defineProperty(t,"EntityDecoder",{enumerable:!0,get:function(){return d.EntityDecoder}}),Object.defineProperty(t,"DecodingMode",{enumerable:!0,get:function(){return d.DecodingMode}}),Object.defineProperty(t,"decodeXML",{enumerable:!0,get:function(){return d.decodeXML}}),Object.defineProperty(t,"decodeHTML",{enumerable:!0,get:function(){return d.decodeHTML}}),Object.defineProperty(t,"decodeHTMLStrict",{enumerable:!0,get:function(){return d.decodeHTMLStrict}}),Object.defineProperty(t,"decodeHTMLAttribute",{enumerable:!0,get:function(){return d.decodeHTMLAttribute}}),Object.defineProperty(t,"decodeHTML4",{enumerable:!0,get:function(){return d.decodeHTML}}),Object.defineProperty(t,"decodeHTML5",{enumerable:!0,get:function(){return d.decodeHTML}}),Object.defineProperty(t,"decodeHTML4Strict",{enumerable:!0,get:function(){return d.decodeHTMLStrict}}),Object.defineProperty(t,"decodeHTML5Strict",{enumerable:!0,get:function(){return d.decodeHTMLStrict}}),Object.defineProperty(t,"decodeXMLStrict",{enumerable:!0,get:function(){return d.decodeXML}})},function(e,t,n){"use strict";var r,i,o;Object.defineProperty(t,"__esModule",{value:!0}),t.hasUnescapedText=t.isNumberedHeader=t.SPECIAL_ELEMENTS=t.getTagID=t.TAG_ID=t.TAG_NAMES=t.DOCUMENT_MODE=t.ATTRS=t.NS=void 0,function(e){e.HTML="http://www.w3.org/1999/xhtml",e.MATHML="http://www.w3.org/1998/Math/MathML",e.SVG="http://www.w3.org/2000/svg",e.XLINK="http://www.w3.org/1999/xlink",e.XML="http://www.w3.org/XML/1998/namespace",e.XMLNS="http://www.w3.org/2000/xmlns/"}(r=t.NS||(t.NS={})),function(e){e.TYPE="type",e.ACTION="action",e.ENCODING="encoding",e.PROMPT="prompt",e.NAME="name",e.COLOR="color",e.FACE="face",e.SIZE="size"}(t.ATTRS||(t.ATTRS={})),function(e){e.NO_QUIRKS="no-quirks",e.QUIRKS="quirks",e.LIMITED_QUIRKS="limited-quirks"}(t.DOCUMENT_MODE||(t.DOCUMENT_MODE={})),function(e){e.A="a",e.ADDRESS="address",e.ANNOTATION_XML="annotation-xml",e.APPLET="applet",e.AREA="area",e.ARTICLE="article",e.ASIDE="aside",e.B="b",e.BASE="base",e.BASEFONT="basefont",e.BGSOUND="bgsound",e.BIG="big",e.BLOCKQUOTE="blockquote",e.BODY="body",e.BR="br",e.BUTTON="button",e.CAPTION="caption",e.CENTER="center",e.CODE="code",e.COL="col",e.COLGROUP="colgroup",e.DD="dd",e.DESC="desc",e.DETAILS="details",e.DIALOG="dialog",e.DIR="dir",e.DIV="div",e.DL="dl",e.DT="dt",e.EM="em",e.EMBED="embed",e.FIELDSET="fieldset",e.FIGCAPTION="figcaption",e.FIGURE="figure",e.FONT="font",e.FOOTER="footer",e.FOREIGN_OBJECT="foreignObject",e.FORM="form",e.FRAME="frame",e.FRAMESET="frameset",e.H1="h1",e.H2="h2",e.H3="h3",e.H4="h4",e.H5="h5",e.H6="h6",e.HEAD="head",e.HEADER="header",e.HGROUP="hgroup",e.HR="hr",e.HTML="html",e.I="i",e.IMG="img",e.IMAGE="image",e.INPUT="input",e.IFRAME="iframe",e.KEYGEN="keygen",e.LABEL="label",e.LI="li",e.LINK="link",e.LISTING="listing",e.MAIN="main",e.MALIGNMARK="malignmark",e.MARQUEE="marquee",e.MATH="math",e.MENU="menu",e.META="meta",e.MGLYPH="mglyph",e.MI="mi",e.MO="mo",e.MN="mn",e.MS="ms",e.MTEXT="mtext",e.NAV="nav",e.NOBR="nobr",e.NOFRAMES="noframes",e.NOEMBED="noembed",e.NOSCRIPT="noscript",e.OBJECT="object",e.OL="ol",e.OPTGROUP="optgroup",e.OPTION="option",e.P="p",e.PARAM="param",e.PLAINTEXT="plaintext",e.PRE="pre",e.RB="rb",e.RP="rp",e.RT="rt",e.RTC="rtc",e.RUBY="ruby",e.S="s",e.SCRIPT="script",e.SECTION="section",e.SELECT="select",e.SOURCE="source",e.SMALL="small",e.SPAN="span",e.STRIKE="strike",e.STRONG="strong",e.STYLE="style",e.SUB="sub",e.SUMMARY="summary",e.SUP="sup",e.TABLE="table",e.TBODY="tbody",e.TEMPLATE="template",e.TEXTAREA="textarea",e.TFOOT="tfoot",e.TD="td",e.TH="th",e.THEAD="thead",e.TITLE="title",e.TR="tr",e.TRACK="track",e.TT="tt",e.U="u",e.UL="ul",e.SVG="svg",e.VAR="var",e.WBR="wbr",e.XMP="xmp"}(i=t.TAG_NAMES||(t.TAG_NAMES={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.A=1]="A",e[e.ADDRESS=2]="ADDRESS",e[e.ANNOTATION_XML=3]="ANNOTATION_XML",e[e.APPLET=4]="APPLET",e[e.AREA=5]="AREA",e[e.ARTICLE=6]="ARTICLE",e[e.ASIDE=7]="ASIDE",e[e.B=8]="B",e[e.BASE=9]="BASE",e[e.BASEFONT=10]="BASEFONT",e[e.BGSOUND=11]="BGSOUND",e[e.BIG=12]="BIG",e[e.BLOCKQUOTE=13]="BLOCKQUOTE",e[e.BODY=14]="BODY",e[e.BR=15]="BR",e[e.BUTTON=16]="BUTTON",e[e.CAPTION=17]="CAPTION",e[e.CENTER=18]="CENTER",e[e.CODE=19]="CODE",e[e.COL=20]="COL",e[e.COLGROUP=21]="COLGROUP",e[e.DD=22]="DD",e[e.DESC=23]="DESC",e[e.DETAILS=24]="DETAILS",e[e.DIALOG=25]="DIALOG",e[e.DIR=26]="DIR",e[e.DIV=27]="DIV",e[e.DL=28]="DL",e[e.DT=29]="DT",e[e.EM=30]="EM",e[e.EMBED=31]="EMBED",e[e.FIELDSET=32]="FIELDSET",e[e.FIGCAPTION=33]="FIGCAPTION",e[e.FIGURE=34]="FIGURE",e[e.FONT=35]="FONT",e[e.FOOTER=36]="FOOTER",e[e.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",e[e.FORM=38]="FORM",e[e.FRAME=39]="FRAME",e[e.FRAMESET=40]="FRAMESET",e[e.H1=41]="H1",e[e.H2=42]="H2",e[e.H3=43]="H3",e[e.H4=44]="H4",e[e.H5=45]="H5",e[e.H6=46]="H6",e[e.HEAD=47]="HEAD",e[e.HEADER=48]="HEADER",e[e.HGROUP=49]="HGROUP",e[e.HR=50]="HR",e[e.HTML=51]="HTML",e[e.I=52]="I",e[e.IMG=53]="IMG",e[e.IMAGE=54]="IMAGE",e[e.INPUT=55]="INPUT",e[e.IFRAME=56]="IFRAME",e[e.KEYGEN=57]="KEYGEN",e[e.LABEL=58]="LABEL",e[e.LI=59]="LI",e[e.LINK=60]="LINK",e[e.LISTING=61]="LISTING",e[e.MAIN=62]="MAIN",e[e.MALIGNMARK=63]="MALIGNMARK",e[e.MARQUEE=64]="MARQUEE",e[e.MATH=65]="MATH",e[e.MENU=66]="MENU",e[e.META=67]="META",e[e.MGLYPH=68]="MGLYPH",e[e.MI=69]="MI",e[e.MO=70]="MO",e[e.MN=71]="MN",e[e.MS=72]="MS",e[e.MTEXT=73]="MTEXT",e[e.NAV=74]="NAV",e[e.NOBR=75]="NOBR",e[e.NOFRAMES=76]="NOFRAMES",e[e.NOEMBED=77]="NOEMBED",e[e.NOSCRIPT=78]="NOSCRIPT",e[e.OBJECT=79]="OBJECT",e[e.OL=80]="OL",e[e.OPTGROUP=81]="OPTGROUP",e[e.OPTION=82]="OPTION",e[e.P=83]="P",e[e.PARAM=84]="PARAM",e[e.PLAINTEXT=85]="PLAINTEXT",e[e.PRE=86]="PRE",e[e.RB=87]="RB",e[e.RP=88]="RP",e[e.RT=89]="RT",e[e.RTC=90]="RTC",e[e.RUBY=91]="RUBY",e[e.S=92]="S",e[e.SCRIPT=93]="SCRIPT",e[e.SECTION=94]="SECTION",e[e.SELECT=95]="SELECT",e[e.SOURCE=96]="SOURCE",e[e.SMALL=97]="SMALL",e[e.SPAN=98]="SPAN",e[e.STRIKE=99]="STRIKE",e[e.STRONG=100]="STRONG",e[e.STYLE=101]="STYLE",e[e.SUB=102]="SUB",e[e.SUMMARY=103]="SUMMARY",e[e.SUP=104]="SUP",e[e.TABLE=105]="TABLE",e[e.TBODY=106]="TBODY",e[e.TEMPLATE=107]="TEMPLATE",e[e.TEXTAREA=108]="TEXTAREA",e[e.TFOOT=109]="TFOOT",e[e.TD=110]="TD",e[e.TH=111]="TH",e[e.THEAD=112]="THEAD",e[e.TITLE=113]="TITLE",e[e.TR=114]="TR",e[e.TRACK=115]="TRACK",e[e.TT=116]="TT",e[e.U=117]="U",e[e.UL=118]="UL",e[e.SVG=119]="SVG",e[e.VAR=120]="VAR",e[e.WBR=121]="WBR",e[e.XMP=122]="XMP"}(o=t.TAG_ID||(t.TAG_ID={}));const s=new Map([[i.A,o.A],[i.ADDRESS,o.ADDRESS],[i.ANNOTATION_XML,o.ANNOTATION_XML],[i.APPLET,o.APPLET],[i.AREA,o.AREA],[i.ARTICLE,o.ARTICLE],[i.ASIDE,o.ASIDE],[i.B,o.B],[i.BASE,o.BASE],[i.BASEFONT,o.BASEFONT],[i.BGSOUND,o.BGSOUND],[i.BIG,o.BIG],[i.BLOCKQUOTE,o.BLOCKQUOTE],[i.BODY,o.BODY],[i.BR,o.BR],[i.BUTTON,o.BUTTON],[i.CAPTION,o.CAPTION],[i.CENTER,o.CENTER],[i.CODE,o.CODE],[i.COL,o.COL],[i.COLGROUP,o.COLGROUP],[i.DD,o.DD],[i.DESC,o.DESC],[i.DETAILS,o.DETAILS],[i.DIALOG,o.DIALOG],[i.DIR,o.DIR],[i.DIV,o.DIV],[i.DL,o.DL],[i.DT,o.DT],[i.EM,o.EM],[i.EMBED,o.EMBED],[i.FIELDSET,o.FIELDSET],[i.FIGCAPTION,o.FIGCAPTION],[i.FIGURE,o.FIGURE],[i.FONT,o.FONT],[i.FOOTER,o.FOOTER],[i.FOREIGN_OBJECT,o.FOREIGN_OBJECT],[i.FORM,o.FORM],[i.FRAME,o.FRAME],[i.FRAMESET,o.FRAMESET],[i.H1,o.H1],[i.H2,o.H2],[i.H3,o.H3],[i.H4,o.H4],[i.H5,o.H5],[i.H6,o.H6],[i.HEAD,o.HEAD],[i.HEADER,o.HEADER],[i.HGROUP,o.HGROUP],[i.HR,o.HR],[i.HTML,o.HTML],[i.I,o.I],[i.IMG,o.IMG],[i.IMAGE,o.IMAGE],[i.INPUT,o.INPUT],[i.IFRAME,o.IFRAME],[i.KEYGEN,o.KEYGEN],[i.LABEL,o.LABEL],[i.LI,o.LI],[i.LINK,o.LINK],[i.LISTING,o.LISTING],[i.MAIN,o.MAIN],[i.MALIGNMARK,o.MALIGNMARK],[i.MARQUEE,o.MARQUEE],[i.MATH,o.MATH],[i.MENU,o.MENU],[i.META,o.META],[i.MGLYPH,o.MGLYPH],[i.MI,o.MI],[i.MO,o.MO],[i.MN,o.MN],[i.MS,o.MS],[i.MTEXT,o.MTEXT],[i.NAV,o.NAV],[i.NOBR,o.NOBR],[i.NOFRAMES,o.NOFRAMES],[i.NOEMBED,o.NOEMBED],[i.NOSCRIPT,o.NOSCRIPT],[i.OBJECT,o.OBJECT],[i.OL,o.OL],[i.OPTGROUP,o.OPTGROUP],[i.OPTION,o.OPTION],[i.P,o.P],[i.PARAM,o.PARAM],[i.PLAINTEXT,o.PLAINTEXT],[i.PRE,o.PRE],[i.RB,o.RB],[i.RP,o.RP],[i.RT,o.RT],[i.RTC,o.RTC],[i.RUBY,o.RUBY],[i.S,o.S],[i.SCRIPT,o.SCRIPT],[i.SECTION,o.SECTION],[i.SELECT,o.SELECT],[i.SOURCE,o.SOURCE],[i.SMALL,o.SMALL],[i.SPAN,o.SPAN],[i.STRIKE,o.STRIKE],[i.STRONG,o.STRONG],[i.STYLE,o.STYLE],[i.SUB,o.SUB],[i.SUMMARY,o.SUMMARY],[i.SUP,o.SUP],[i.TABLE,o.TABLE],[i.TBODY,o.TBODY],[i.TEMPLATE,o.TEMPLATE],[i.TEXTAREA,o.TEXTAREA],[i.TFOOT,o.TFOOT],[i.TD,o.TD],[i.TH,o.TH],[i.THEAD,o.THEAD],[i.TITLE,o.TITLE],[i.TR,o.TR],[i.TRACK,o.TRACK],[i.TT,o.TT],[i.U,o.U],[i.UL,o.UL],[i.SVG,o.SVG],[i.VAR,o.VAR],[i.WBR,o.WBR],[i.XMP,o.XMP]]);t.getTagID=function(e){var t;return null!==(t=s.get(e))&&void 0!==t?t:o.UNKNOWN};const a=o;t.SPECIAL_ELEMENTS={[r.HTML]:new Set([a.ADDRESS,a.APPLET,a.AREA,a.ARTICLE,a.ASIDE,a.BASE,a.BASEFONT,a.BGSOUND,a.BLOCKQUOTE,a.BODY,a.BR,a.BUTTON,a.CAPTION,a.CENTER,a.COL,a.COLGROUP,a.DD,a.DETAILS,a.DIR,a.DIV,a.DL,a.DT,a.EMBED,a.FIELDSET,a.FIGCAPTION,a.FIGURE,a.FOOTER,a.FORM,a.FRAME,a.FRAMESET,a.H1,a.H2,a.H3,a.H4,a.H5,a.H6,a.HEAD,a.HEADER,a.HGROUP,a.HR,a.HTML,a.IFRAME,a.IMG,a.INPUT,a.LI,a.LINK,a.LISTING,a.MAIN,a.MARQUEE,a.MENU,a.META,a.NAV,a.NOEMBED,a.NOFRAMES,a.NOSCRIPT,a.OBJECT,a.OL,a.P,a.PARAM,a.PLAINTEXT,a.PRE,a.SCRIPT,a.SECTION,a.SELECT,a.SOURCE,a.STYLE,a.SUMMARY,a.TABLE,a.TBODY,a.TD,a.TEMPLATE,a.TEXTAREA,a.TFOOT,a.TH,a.THEAD,a.TITLE,a.TR,a.TRACK,a.UL,a.WBR,a.XMP]),[r.MATHML]:new Set([a.MI,a.MO,a.MN,a.MS,a.MTEXT,a.ANNOTATION_XML]),[r.SVG]:new Set([a.TITLE,a.FOREIGN_OBJECT,a.DESC]),[r.XLINK]:new Set,[r.XML]:new Set,[r.XMLNS]:new Set},t.isNumberedHeader=function(e){return e===a.H1||e===a.H2||e===a.H3||e===a.H4||e===a.H5||e===a.H6};const c=new Set([i.STYLE,i.SCRIPT,i.XMP,i.IFRAME,i.NOEMBED,i.NOFRAMES,i.PLAINTEXT]);t.hasUnescapedText=function(e,t){return c.has(e)||t&&e===i.NOSCRIPT}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d}));var r=n(2),i=n(708);const o=new Set(["createObject","findObject","findObjects","countObjects","updateObject","updateObjects","deleteObject","deleteObjects"]),s=o,a=new Set(["alterSchema"]),c=/(?:([a-zA-Z]+)(\:))?(?:([a-zA-Z]+)(\.))?([a-zA-Z]+)/;function l(e){const t=c.exec(e);return{project:t[1]||null,backend:t[3]||null,operation:t[5]}}class u{constructor(){this.type=null,this.pluggableOperations=new Set,this.features={},this.customFeatures={},this.operations={}}configure({registry:e}){this.registry=e;for(const e of Object.keys(this.customFeatures))if(-1===e.indexOf("."))throw new Error("Custom storage backend features must be namespaced with a '.', e.g. 'dexie.getVersionHistory'")}use(e){e.install(this)}cleanup(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){}))}migrate({database:e}={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){}))}findObject(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.findObjects(e,t,Object.assign(Object.assign({},n),{limit:1}));return r.length?r[0]:null}))}countObjects(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.findObjects(e,t)).length}))}updateObject(e,t,n,o){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=this.registry.collections[e];if("string"==typeof r.pkIndex)return yield this.updateObjects(e,{[r.pkIndex]:t[r.pkIndex]},n,o);if(r.pkIndex instanceof Array){const s={};for(let e of r.pkIndex){if(Object(i.d)(e))throw new Error("Updating single objects with relation pks is not supported yet");s[e]=t[e]}return yield this.updateObjects(e,s,n,o)}throw new Error("Updating single objects with relation pks is not supported yet")}))}deleteObject(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=this.registry.collections[e];if("string"!=typeof r.pkIndex)throw new Error("Updating single objects with compound pks is not supported yet");yield this.deleteObjects(e,{[r.pkIndex]:t[r.pkIndex]},Object.assign(Object.assign({},n||{}),{limit:1}))}))}executeBatch(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){throw new Error("Not implemented")}))}supports(e){return s.has(e)||!!this.features[e]||!!this.customFeatures[e]||!!this.operations[e]}operation(e,...t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=t=>{throw new Error(`Unsupported storage backend operation: ${e} (${t})`)};this.supports(e)||n("no-support-detected");const r=l(e);if(!r.project&&!r.backend){const e=this[r.operation];return e||n("no-method-found"),e.apply(this,t)}const i=this.operations[e];return i||n("no-registration-found"),i(...t)}))}registerOperation(e,t){!function(e,t){const n=l(e);if(!n.project){if(!n.backend&&!a.has(e))throw new Error(`Cannot register non-standard top-level operation '${e}'`);if(n.backend&&!t.pluggableOperations.has(n.operation))throw new Error(`Cannot register non-standard backend-specific operation '${e}'`)}}(e,this),this.operations[e]=t}}class d{install(e){this.backend=e}}},function(e,t,n){"use strict";var r=n(901),i=n(220);function o(e,t){return t.encode?t.strict?r(e):encodeURIComponent(e):e}function s(e){return Array.isArray(e)?e.sort():"object"==typeof e?s(Object.keys(e)).sort((function(e,t){return Number(e)-Number(t)})).map((function(t){return e[t]})):e}t.extract=function(e){return e.split("?")[1]||""},t.parse=function(e,t){var n=function(e){var t;switch(e.arrayFormat){case"index":return function(e,n,r){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return function(e,n,r){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};default:return function(e,t,n){void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t=i({arrayFormat:"none"},t)),r=Object.create(null);return"string"!=typeof e?r:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach((function(e){var t=e.replace(/\+/g," ").split("="),i=t.shift(),o=t.length>0?t.join("="):void 0;o=void 0===o?null:decodeURIComponent(o),n(decodeURIComponent(i),o,r)})),Object.keys(r).sort().reduce((function(e,t){var n=r[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=s(n):e[t]=n,e}),Object.create(null))):r},t.stringify=function(e,t){var n=function(e){switch(e.arrayFormat){case"index":return function(t,n,r){return null===n?[o(t,e),"[",r,"]"].join(""):[o(t,e),"[",o(r,e),"]=",o(n,e)].join("")};case"bracket":return function(t,n){return null===n?o(t,e):[o(t,e),"[]=",o(n,e)].join("")};default:return function(t,n){return null===n?o(t,e):[o(t,e),"=",o(n,e)].join("")}}}(t=i({encode:!0,strict:!0,arrayFormat:"none"},t));return e?Object.keys(e).sort().map((function(r){var i=e[r];if(void 0===i)return"";if(null===i)return o(r,t);if(Array.isArray(i)){var s=[];return i.slice().forEach((function(e){void 0!==e&&s.push(n(r,e,s.length))})),s.join("&")}return o(r,t)+"="+o(i,t)})).filter((function(e){return e.length>0})).join("&"):""}},,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(281);var i={title:{rules:[["title",e=>e.text],['meta[property="og:title"]',e=>e.getAttribute("content")]]},canonicalUrl:Object.assign(Object.assign({},r.metadataRuleSets.url),{defaultValue:void 0,rules:[['link[rel="canonical"]',e=>e.getAttribute("href")],['meta[property="og:url"]',e=>e.getAttribute("content")]]}),publishedTime:{rules:[['meta[property="article:published_time"]',e=>e.getAttribute("content")]]},image:r.metadataRuleSets.image,provider:r.metadataRuleSets.provider,keywords:r.metadataRuleSets.keywords,description:r.metadataRuleSets.description};const o=(e,t)=>{var n;const o=Object.assign(Object.assign({},Object(r.getMetadata)(e,t,i)),{authors:[]}),s=e=>"string"==typeof e?o.authors.push(e):o.authors.push(e.name),a=Array.from(e.querySelectorAll("script[type='application/ld+json']")).map((e=>e.innerHTML)).filter((e=>e.includes("https://schema.org")||e.includes("http://schema.org"))).map((e=>{try{return JSON.parse(e)}catch(e){return null}})).filter((e=>null!=e));for(const e of a)e.author&&(Array.isArray(e.author)?e.author.forEach(s):s(e.author));return{url:t,type:"html",body:e.body.innerHTML,lang:null!==(n=e.documentElement.lang)&&void 0!==n?n:"en",metadata:o}}},function(e,t,n){(function(t,n){var r;r=function(){"use strict";var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)},r=function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};function i(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:t,s=Object.keys,a=Array.isArray;function c(e,t){return"object"!=typeof t||s(t).forEach((function(n){e[n]=t[n]})),e}"undefined"==typeof Promise||o.Promise||(o.Promise=Promise);var l=Object.getPrototypeOf,u={}.hasOwnProperty;function d(e,t){return u.call(e,t)}function h(e,t){"function"==typeof t&&(t=t(l(e))),("undefined"==typeof Reflect?s:Reflect.ownKeys)(t).forEach((function(n){p(e,n,t[n])}))}var f=Object.defineProperty;function p(e,t,n,r){f(e,t,c(n&&d(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function g(e){return{from:function(t){return e.prototype=Object.create(t.prototype),p(e.prototype,"constructor",e),{extend:h.bind(null,e.prototype)}}}}var m=Object.getOwnPropertyDescriptor;function y(e,t){var n;return m(e,t)||(n=l(e))&&y(n,t)}var v=[].slice;function b(e,t,n){return v.call(e,t,n)}function _(e,t){return t(e)}function w(e){if(!e)throw new Error("Assertion Failed")}function T(e){o.setImmediate?n(e):setTimeout(e,0)}function E(e,t){if("string"==typeof t&&d(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,i=t.length;r<i;++r){var o=E(e,t[r]);n.push(o)}return n}var s=t.indexOf(".");if(-1!==s){var a=e[t.substr(0,s)];return null==a?void 0:E(a,t.substr(s+1))}}function A(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){w("string"!=typeof n&&"length"in n);for(var r=0,i=t.length;r<i;++r)A(e,t[r],n[r])}else{var o=t.indexOf(".");if(-1!==o){var s=t.substr(0,o),c=t.substr(o+1);if(""===c)void 0===n?a(e)&&!isNaN(parseInt(s))?e.splice(s,1):delete e[s]:e[s]=n;else{var l=e[s];l&&d(e,s)||(l=e[s]={}),A(l,c,n)}}else void 0===n?a(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function S(e){var t={};for(var n in e)d(e,n)&&(t[n]=e[n]);return t}var O=[].concat;function I(e){return O.apply([],e)}var C="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(I([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return o[e]})),k=new Set(C.map((function(e){return o[e]})));function P(e){var t={};for(var n in e)if(d(e,n)){var r=e[n];t[n]=!r||"object"!=typeof r||k.has(r.constructor)?r:P(r)}return t}var x=null;function R(e){x=new WeakMap;var t=L(e);return x=null,t}function L(e){if(!e||"object"!=typeof e)return e;var t=x.get(e);if(t)return t;if(a(e)){t=[],x.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(L(e[n]))}else if(k.has(e.constructor))t=e;else{var i=l(e);for(var o in t=i===Object.prototype?{}:Object.create(i),x.set(e,t),e)d(e,o)&&(t[o]=L(e[o]))}return t}var D={}.toString;function N(e){return D.call(e).slice(8,-1)}var j="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",M="symbol"==typeof j?function(e){var t;return null!=e&&(t=e[j])&&t.apply(e)}:function(){return null};function F(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),n>=0}var U={};function B(e){var t,n,r,i;if(1===arguments.length){if(a(e))return e.slice();if(this===U&&"string"==typeof e)return[e];if(i=M(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var G="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},q=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],H=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(q),$={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function W(e,t){this.name=e,this.message=t}function z(e,t){return e+". Errors: "+Object.keys(t).map((function(e){return t[e].toString()})).filter((function(e,t,n){return n.indexOf(e)===t})).join("\n")}function V(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=z(e,t)}function K(e,t){this.name="BulkError",this.failures=Object.keys(t).map((function(e){return t[e]})),this.failuresByPos=t,this.message=z(e,this.failures)}g(W).from(Error).extend({toString:function(){return this.name+": "+this.message}}),g(V).from(W),g(K).from(W);var Y=H.reduce((function(e,t){return e[t]=t+"Error",e}),{}),Q=W,X=H.reduce((function(e,t){var n=t+"Error";function r(e,r){this.name=n,e?"string"==typeof e?(this.message="".concat(e).concat(r?"\n "+r:""),this.inner=r||null):"object"==typeof e&&(this.message="".concat(e.name," ").concat(e.message),this.inner=e):(this.message=$[t]||n,this.inner=null)}return g(r).from(Q),e[t]=r,e}),{});X.Syntax=SyntaxError,X.Type=TypeError,X.Range=RangeError;var J=q.reduce((function(e,t){return e[t+"Error"]=X[t],e}),{}),Z=H.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=X[t]),e}),{});function ee(){}function te(e){return e}function ne(e,t){return null==e||e===te?t:function(n){return t(e(n))}}function re(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ie(e,t){return e===ee?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?re(r,this.onsuccess):r),i&&(this.onerror=this.onerror?re(i,this.onerror):i),void 0!==o?o:n}}function oe(e,t){return e===ee?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?re(n,this.onsuccess):n),r&&(this.onerror=this.onerror?re(r,this.onerror):r)}}function se(e,t){return e===ee?t:function(n){var r=e.apply(this,arguments);c(n,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?re(i,this.onsuccess):i),o&&(this.onerror=this.onerror?re(o,this.onerror):o),void 0===r?void 0===s?void 0:s:c(r,s)}}function ae(e,t){return e===ee?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function ce(e,t){return e===ee?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then((function(){return t.apply(r,o)}))}return t.apply(this,arguments)}}Z.ModifyError=V,Z.DexieError=W,Z.BulkError=K;var le="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ue(e,t){le=e}var de={},he="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,l(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,l(t),e]}(),fe=he[0],pe=he[1],ge=he[2],me=pe&&pe.then,ye=fe&&fe.constructor,ve=!!ge,be=function(e,t){Ie.push([e,t]),we&&(queueMicrotask(Fe),we=!1)},_e=!0,we=!0,Te=[],Ee=[],Ae=te,Se={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ee,pgp:!1,env:{},finalize:ee},Oe=Se,Ie=[],Ce=0,ke=[];function Pe(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=Oe;if("function"!=typeof e){if(e!==de)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&De(this,this._value))}this._state=null,this._value=null,++t.ref,Le(this,e)}var xe={get:function(){var e=Oe,t=Ke;function n(n,r){var i=this,o=!e.global&&(e!==Oe||t!==Ke),s=o&&!Je(),a=new Pe((function(t,a){je(i,new Re(ot(n,e,o,s),ot(r,e,o,s),t,a,e))}));return this._consoleTask&&(a._consoleTask=this._consoleTask),a}return n.prototype=de,n},set:function(e){p(this,"then",e&&e.prototype===de?xe:{get:function(){return e},set:xe.set})}};function Re(e,t,n,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function Le(e,t){try{t((function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Ue();t&&"function"==typeof t.then?Le(e,(function(e,n){t instanceof Pe?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,Ne(e)),n&&Be()}}),De.bind(null,e))}catch(t){De(e,t)}}function De(e,t){if(Ee.push(t),null===e._state){var n=e._lib&&Ue();t=Ae(t),e._state=!1,e._value=t,function(e){Te.some((function(t){return t._value===e._value}))||Te.push(e)}(e),Ne(e),n&&Be()}}function Ne(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)je(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===Ce&&(++Ce,be((function(){0==--Ce&&Ge()}),[]))}function je(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Ce,be(Me,[n,e,t])}else e._listeners.push(t)}function Me(e,t,n){try{var r,i=t._value;!t._state&&Ee.length&&(Ee=[]),r=le&&t._consoleTask?t._consoleTask.run((function(){return e(i)})):e(i),t._state||-1!==Ee.indexOf(i)||function(e){for(var t=Te.length;t;)if(Te[--t]._value===e._value)return void Te.splice(t,1)}(t),n.resolve(r)}catch(e){n.reject(e)}finally{0==--Ce&&Ge(),--n.psd.ref||n.psd.finalize()}}function Fe(){it(Se,(function(){Ue()&&Be()}))}function Ue(){var e=_e;return _e=!1,we=!1,e}function Be(){var e,t,n;do{for(;Ie.length>0;)for(e=Ie,Ie=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(Ie.length>0);_e=!0,we=!0}function Ge(){var e=Te;Te=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=ke.slice(0),n=t.length;n;)t[--n]()}function qe(e){return new Pe(de,!1,e)}function He(e,t){var n=Oe;return function(){var r=Ue(),i=Oe;try{return nt(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{nt(i,!1),r&&Be()}}}h(Pe.prototype,{then:xe,_then:function(e,t){je(this,new Re(null,null,e,t,Oe))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,(function(e){return e instanceof t?n(e):qe(e)})):this.then(null,(function(e){return e&&e.name===t?n(e):qe(e)}))},finally:function(e){return this.then((function(t){return Pe.resolve(e()).then((function(){return t}))}),(function(t){return Pe.resolve(e()).then((function(){return qe(t)}))}))},timeout:function(e,t){var n=this;return e<1/0?new Pe((function(r,i){var o=setTimeout((function(){return i(new X.Timeout(t))}),e);n.then(r,i).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&p(Pe.prototype,Symbol.toStringTag,"Dexie.Promise"),Se.env=rt(),h(Pe,{all:function(){var e=B.apply(null,arguments).map(Ze);return new Pe((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach((function(i,o){return Pe.resolve(i).then((function(n){e[o]=n,--r||t(e)}),n)}))}))},resolve:function(e){return e instanceof Pe?e:e&&"function"==typeof e.then?new Pe((function(t,n){e.then(t,n)})):new Pe(de,!0,e)},reject:qe,race:function(){var e=B.apply(null,arguments).map(Ze);return new Pe((function(t,n){e.map((function(e){return Pe.resolve(e).then(t,n)}))}))},PSD:{get:function(){return Oe},set:function(e){return Oe=e}},totalEchoes:{get:function(){return Ke}},newPSD:Qe,usePSD:it,scheduler:{get:function(){return be},set:function(e){be=e}},rejectionMapper:{get:function(){return Ae},set:function(e){Ae=e}},follow:function(e,t){return new Pe((function(n,r){return Qe((function(t,n){var r=Oe;r.unhandleds=[],r.onunhandled=n,r.finalize=re((function(){var e=this;!function(e){function t(){e(),ke.splice(ke.indexOf(t),1)}ke.push(t),++Ce,be((function(){0==--Ce&&Ge()}),[])}((function(){0===e.unhandleds.length?t():n(e.unhandleds[0])}))}),r.finalize),e()}),t,n,r)}))}}),ye&&(ye.allSettled&&p(Pe,"allSettled",(function(){var e=B.apply(null,arguments).map(Ze);return new Pe((function(t){0===e.length&&t([]);var n=e.length,r=new Array(n);e.forEach((function(e,i){return Pe.resolve(e).then((function(e){return r[i]={status:"fulfilled",value:e}}),(function(e){return r[i]={status:"rejected",reason:e}})).then((function(){return--n||t(r)}))}))}))})),ye.any&&"undefined"!=typeof AggregateError&&p(Pe,"any",(function(){var e=B.apply(null,arguments).map(Ze);return new Pe((function(t,n){0===e.length&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach((function(e,o){return Pe.resolve(e).then((function(e){return t(e)}),(function(e){i[o]=e,--r||n(new AggregateError(i))}))}))}))})));var $e={awaits:0,echoes:0,id:0},We=0,ze=[],Ve=0,Ke=0,Ye=0;function Qe(e,t,n,r){var i=Oe,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++Ye,Se.env,o.env=ve?{Promise:Pe,PromiseProp:{value:Pe,configurable:!0,writable:!0},all:Pe.all,race:Pe.race,allSettled:Pe.allSettled,any:Pe.any,resolve:Pe.resolve,reject:Pe.reject}:{},t&&c(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var s=it(o,e,n,r);return 0===o.ref&&o.finalize(),s}function Xe(){return $e.id||($e.id=++We),++$e.awaits,$e.echoes+=100,$e.id}function Je(){return!!$e.awaits&&(0==--$e.awaits&&($e.id=0),$e.echoes=100*$e.awaits,!0)}function Ze(e){return $e.echoes&&e&&e.constructor===ye?(Xe(),e.then((function(e){return Je(),e}),(function(e){return Je(),at(e)}))):e}function et(e){++Ke,$e.echoes&&0!=--$e.echoes||($e.echoes=$e.awaits=$e.id=0),ze.push(Oe),nt(e,!0)}function tt(){var e=ze[ze.length-1];ze.pop(),nt(e,!1)}function nt(e,t){var n=Oe;if((t?!$e.echoes||Ve++&&e===Oe:!Ve||--Ve&&e===Oe)||queueMicrotask(t?et.bind(null,e):tt),e!==Oe&&(Oe=e,n===Se&&(Se.env=rt()),ve)){var r=Se.env.Promise,i=e.env;(n.global||e.global)&&(Object.defineProperty(o,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function rt(){var e=o.Promise;return ve?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function it(e,t,n,r,i){var o=Oe;try{return nt(e,!0),t(n,r,i)}finally{nt(o,!1)}}function ot(e,t,n,r){return"function"!=typeof e?e:function(){var i=Oe;n&&Xe(),nt(t,!0);try{return e.apply(this,arguments)}finally{nt(i,!1),r&&queueMicrotask(Je)}}}function st(e){Promise===ye&&0===$e.echoes?0===Ve?e():enqueueNativeMicroTask(e):setTimeout(e,0)}-1===(""+me).indexOf("[native code]")&&(Xe=Je=ee);var at=Pe.reject;function ct(e,t,n,r){if(e.idbdb&&(e._state.openComplete||Oe.letThrough||e._vip)){var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(i){return i.name===Y.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then((function(){return ct(e,t,n,r)}))):at(i)}return i._promise(t,(function(e,t){return Qe((function(){return Oe.trans=i,r(e,t,i)}))})).then((function(e){if("readwrite"===t)try{i.idbtrans.commit()}catch(e){}return"readonly"===t?e:i._completion.then((function(){return e}))}))}if(e._state.openComplete)return at(new X.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return at(new X.DatabaseClosed);e.open().catch(ee)}return e._state.dbReadyPromise.then((function(){return ct(e,t,n,r)}))}var lt="4.0.7",ut=String.fromCharCode(65535),dt=-1/0,ht="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",ft="String expected.",pt=[],gt="__dbnames",mt="readonly",yt="readwrite";function vt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var bt={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function _t(e){return"string"!=typeof e||/\./.test(e)?function(e){return e}:function(t){return void 0===t[e]&&e in t&&delete(t=R(t))[e],t}}function wt(){throw X.Type()}function Tt(e,t){try{var n=Et(e),r=Et(t);if(n!==r)return"Array"===n?1:"Array"===r?-1:"binary"===n?1:"binary"===r?-1:"string"===n?1:"string"===r?-1:"Date"===n?1:"Date"!==r?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o)if(e[o]!==t[o])return e[o]<t[o]?-1:1;return n===r?0:n<r?-1:1}(At(e),At(t));case"Array":return function(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o){var s=Tt(e[o],t[o]);if(0!==s)return s}return n===r?0:n<r?-1:1}(e,t)}}catch(e){}return NaN}function Et(e){var t=typeof e;if("object"!==t)return t;if(ArrayBuffer.isView(e))return"binary";var n=N(e);return"ArrayBuffer"===n?"binary":n}function At(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var St=function(){function t(){}return t.prototype._trans=function(e,t,n){var r=this._tx||Oe.trans,i=this.name,o=le&&"undefined"!=typeof console&&console.createTask&&console.createTask("Dexie: ".concat("readonly"===e?"read":"write"," ").concat(this.name));function s(e,n,r){if(!r.schema[i])throw new X.NotFound("Table "+i+" not part of transaction");return t(r.idbtrans,r)}var a=Ue();try{var c=r&&r.db._novip===this.db._novip?r===Oe.trans?r._promise(e,s,n):Qe((function(){return r._promise(e,s,n)}),{trans:r,transless:Oe.transless||Oe}):ct(this.db,e,[this.name],s);return o&&(c._consoleTask=o,c=c.catch((function(e){return console.trace(e),at(e)}))),c}finally{a&&Be()}},t.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):null==e?at(new X.Type("Invalid argument to Table.get()")):this._trans("readonly",(function(t){return n.core.get({trans:t,key:e}).then((function(e){return n.hook.reading.fire(e)}))})).then(t)},t.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(a(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=s(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter((function(e){if(e.compound&&t.every((function(t){return e.keyPath.indexOf(t)>=0}))){for(var n=0;n<t.length;++n)if(-1===t.indexOf(e.keyPath[n]))return!1;return!0}return!1})).sort((function(e,t){return e.keyPath.length-t.keyPath.length}))[0];if(n&&this.db._maxKey!==ut){var r=n.keyPath.slice(0,t.length);return this.where(r).equals(r.map((function(t){return e[t]})))}!n&&le&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var i=this.schema.idxByName,o=this.db._deps.indexedDB;function c(e,t){return 0===o.cmp(e,t)}var l=t.reduce((function(t,n){var r=t[0],o=t[1],s=i[n],l=e[n];return[r||s,r||!s?vt(o,s&&s.multi?function(e){var t=E(e,n);return a(t)&&t.some((function(e){return c(l,e)}))}:function(e){return c(l,E(e,n))}):o]}),[null,null]),u=l[0],d=l[1];return u?this.where(u.name).equals(e[u.keyPath]).filter(d):n?this.filter(d):this.where(t).equals("")},t.prototype.filter=function(e){return this.toCollection().and(e)},t.prototype.count=function(e){return this.toCollection().count(e)},t.prototype.offset=function(e){return this.toCollection().offset(e)},t.prototype.limit=function(e){return this.toCollection().limit(e)},t.prototype.each=function(e){return this.toCollection().each(e)},t.prototype.toArray=function(e){return this.toCollection().toArray(e)},t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},t.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,a(e)?"[".concat(e.join("+"),"]"):e))},t.prototype.reverse=function(){return this.toCollection().reverse()},t.prototype.mapToClass=function(t){var n=this.db,r=this.name;this.schema.mappedClass=t,t.prototype instanceof wt&&(t=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}(i,t),Object.defineProperty(i.prototype,"db",{get:function(){return n},enumerable:!1,configurable:!0}),i.prototype.table=function(){return r},i}(t));for(var i=new Set,o=t.prototype;o;o=l(o))Object.getOwnPropertyNames(o).forEach((function(e){return i.add(e)}));var s=function(e){if(!e)return e;var n=Object.create(t.prototype);for(var r in e)if(!i.has(r))try{n[r]=e[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=s,this.hook("reading",s),t},t.prototype.defineClass=function(){return this.mapToClass((function(e){c(this,e)}))},t.prototype.add=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,s=e;return o&&i&&(s=_t(o)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[s]})})).then((function(e){return e.numFailures?Pe.reject(e.failures[0]):e.lastResult})).then((function(t){if(o)try{A(e,o,t)}catch(e){}return t}))},t.prototype.update=function(e,t){if("object"!=typeof e||a(e))return this.where(":id").equals(e).modify(t);var n=E(e,this.schema.primKey.keyPath);return void 0===n?at(new X.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(t)},t.prototype.put=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,s=e;return o&&i&&(s=_t(o)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"put",values:[s],keys:null!=t?[t]:null})})).then((function(e){return e.numFailures?Pe.reject(e.failures[0]):e.lastResult})).then((function(t){if(o)try{A(e,o,t)}catch(e){}return t}))},t.prototype.delete=function(e){var t=this;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?Pe.reject(e.failures[0]):void 0}))},t.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(t){return e.core.mutate({trans:t,type:"deleteRange",range:bt})})).then((function(e){return e.numFailures?Pe.reject(e.failures[0]):void 0}))},t.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",(function(n){return t.core.getMany({keys:e,trans:n}).then((function(e){return e.map((function(e){return t.hook.reading.fire(e)}))}))}))},t.prototype.bulkAdd=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=r.schema.primKey,s=n.auto,a=n.keyPath;if(a&&i)throw new X.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new X.InvalidArgument("Arguments objects and keys must have the same length");var c=e.length,l=a&&s?e.map(_t(a)):e;return r.core.mutate({trans:t,type:"add",keys:i,values:l,wantResults:o}).then((function(e){var t=e.numFailures,n=e.results,i=e.lastResult,s=e.failures;if(0===t)return o?n:i;throw new K("".concat(r.name,".bulkAdd(): ").concat(t," of ").concat(c," operations failed"),s)}))}))},t.prototype.bulkPut=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=r.schema.primKey,s=n.auto,a=n.keyPath;if(a&&i)throw new X.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new X.InvalidArgument("Arguments objects and keys must have the same length");var c=e.length,l=a&&s?e.map(_t(a)):e;return r.core.mutate({trans:t,type:"put",keys:i,values:l,wantResults:o}).then((function(e){var t=e.numFailures,n=e.results,i=e.lastResult,s=e.failures;if(0===t)return o?n:i;throw new K("".concat(r.name,".bulkPut(): ").concat(t," of ").concat(c," operations failed"),s)}))}))},t.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map((function(e){return e.key})),i=e.map((function(e){return e.changes})),o=[];return this._trans("readwrite",(function(s){return n.getMany({trans:s,keys:r,cache:"clone"}).then((function(a){var c=[],l=[];e.forEach((function(e,n){var r=e.key,i=e.changes,s=a[n];if(s){for(var u=0,d=Object.keys(i);u<d.length;u++){var h=d[u],f=i[h];if(h===t.schema.primKey.keyPath){if(0!==Tt(f,r))throw new X.Constraint("Cannot update primary key in bulkUpdate()")}else A(s,h,f)}o.push(n),c.push(r),l.push(s)}}));var u=c.length;return n.mutate({trans:s,type:"put",keys:c,values:l,updates:{keys:r,changeSpecs:i}}).then((function(e){var n=e.numFailures,r=e.failures;if(0===n)return u;for(var i=0,s=Object.keys(r);i<s.length;i++){var a=s[i],c=o[Number(a)];if(null!=c){var l=r[a];delete r[a],r[c]=l}}throw new K("".concat(t.name,".bulkUpdate(): ").concat(n," of ").concat(u," operations failed"),r)}))}))}))},t.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:e})})).then((function(e){var r=e.numFailures,i=e.lastResult,o=e.failures;if(0===r)return i;throw new K("".concat(t.name,".bulkDelete(): ").concat(r," of ").concat(n," operations failed"),o)}))},t}();function Ot(e){var t={},n=function(n,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return t[n].subscribe.apply(null,o),e}if("string"==typeof n)return t[n]};n.addEventType=o;for(var r=1,i=arguments.length;r<i;++r)o(arguments[r]);return n;function o(e,r,i){if("object"!=typeof e){var c;r||(r=ae),i||(i=ee);var l={subscribers:[],fire:i,subscribe:function(e){-1===l.subscribers.indexOf(e)&&(l.subscribers.push(e),l.fire=r(l.fire,e))},unsubscribe:function(e){l.subscribers=l.subscribers.filter((function(t){return t!==e})),l.fire=l.subscribers.reduce(r,i)}};return t[e]=n[e]=l,l}s(c=e).forEach((function(e){var t=c[e];if(a(t))o(e,c[e][0],c[e][1]);else{if("asap"!==t)throw new X.InvalidArgument("Invalid event config");var n=o(e,te,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];n.subscribers.forEach((function(e){T((function(){e.apply(null,t)}))}))}))}}))}}function It(e,t){return g(t).from({prototype:e}),t}function Ct(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function kt(e,t){e.filter=vt(e.filter,t)}function Pt(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return vt(r(),t())}:t,e.justLimit=n&&!r}function xt(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new X.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Rt(e,t,n){var r=xt(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function Lt(e,t,n,r){var i=e.replayFilter?vt(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},s=function(e,n,r){if(!i||i(n,r,(function(e){return n.stop(e)}),(function(e){return n.fail(e)}))){var s=n.primaryKey,a=""+s;"[object ArrayBuffer]"===a&&(a=""+new Uint8Array(s)),d(o,a)||(o[a]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(s,n),Dt(Rt(e,r,n),e.algorithm,s,!e.keysOnly&&e.valueMapper)])}return Dt(Rt(e,r,n),vt(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Dt(e,t,n,r){var i=He(r?function(e,t,i){return n(r(e),t,i)}:n);return e.then((function(e){if(e)return e.start((function(){var n=function(){return e.continue()};t&&!t(e,(function(e){return n=e}),(function(t){e.stop(t),n=ee}),(function(t){e.fail(t),n=ee}))||i(e.value,e,(function(e){return n=e})),n()}))}))}var Nt=Symbol(),jt=function(){function e(e){Object.assign(this,e)}return e.prototype.execute=function(e){var t;if(void 0!==this.add){var n=this.add;if(a(n))return i(i([],a(e)?e:[],!0),n,!0).sort();if("number"==typeof n)return(Number(e)||0)+n;if("bigint"==typeof n)try{return BigInt(e)+n}catch(e){return BigInt(0)+n}throw new TypeError("Invalid term ".concat(n))}if(void 0!==this.remove){var r=this.remove;if(a(r))return a(e)?e.filter((function(e){return!r.includes(e)})).sort():[];if("number"==typeof r)return Number(e)-r;if("bigint"==typeof r)try{return BigInt(e)-r}catch(e){return BigInt(0)-r}throw new TypeError("Invalid subtrahend ".concat(r))}var o=null===(t=this.replacePrefix)||void 0===t?void 0:t[0];return o&&"string"==typeof e&&e.startsWith(o)?this.replacePrefix[1]+e.substring(o.length):e},e}(),Mt=function(){function e(){}return e.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,at.bind(null,n.error)):n.table._trans("readonly",e).then(t)},e.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,at.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},e.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=vt(t.algorithm,e)},e.prototype._iterate=function(e,t){return Lt(this._ctx,e,t,this._ctx.table.core)},e.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&c(n,e),t._ctx=n,t},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var t=this._ctx;return this._read((function(n){return Lt(t,e,n,t.table.core)}))},e.prototype.count=function(e){var t=this;return this._read((function(e){var n=t._ctx,r=n.table.core;if(Ct(n,!0))return r.count({trans:e,query:{index:xt(n,r.schema),range:n.range}}).then((function(e){return Math.min(e,n.limit)}));var i=0;return Lt(n,(function(){return++i,!1}),e,r).then((function(){return i}))})).then(e)},e.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],i=n.length-1;function o(e,t){return t?o(e[n[t]],t-1):e[r]}var s="next"===this._ctx.dir?1:-1;function a(e,t){var n=o(e,i),r=o(t,i);return n<r?-s:n>r?s:0}return this.toArray((function(e){return e.sort(a)})).then(t)},e.prototype.toArray=function(e){var t=this;return this._read((function(e){var n=t._ctx;if("next"===n.dir&&Ct(n,!0)&&n.limit>0){var r=n.valueMapper,i=xt(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:i,range:n.range}}).then((function(e){var t=e.result;return r?t.map(r):t}))}var o=[];return Lt(n,(function(e){return o.push(e)}),e,n.table.core).then((function(){return o}))}),e)},e.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Ct(t)?Pt(t,(function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n((function(){e.advance(t),t=0})),!1))}})):Pt(t,(function(){var t=e;return function(){return--t<0}}))),this},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Pt(this._ctx,(function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this},e.prototype.until=function(e,t){return kt(this._ctx,(function(n,r,i){return!e(n.value)||(r(i),t)})),this},e.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){var t,n;return kt(this._ctx,(function(t){return e(t.value)})),t=this._ctx,n=e,t.isMatch=vt(t.isMatch,n),this},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))},e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))},e.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)},e.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&Ct(t,!0)&&t.limit>0)return this._read((function(e){var n=xt(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((function(e){return e.result})).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return kt(this._ctx,(function(e){var t=e.primaryKey.toString(),r=d(n,t);return n[t]=!0,!r})),this},e.prototype.modify=function(e){var t=this,n=this._ctx;return this._write((function(r){var i;if("function"==typeof e)i=e;else{var o=s(e),a=o.length;i=function(t){for(var n=!1,r=0;r<a;++r){var i=o[r],s=e[i],c=E(t,i);s instanceof jt?(A(t,i,s.execute(c)),n=!0):c!==s&&(A(t,i,s),n=!0)}return n}}var c=n.table.core,l=c.schema.primaryKey,u=l.outbound,d=l.extractKey,h=t.db._options.modifyChunkSize||200,f=[],p=0,g=[],m=function(e,t){var n=t.failures,r=t.numFailures;p+=e-r;for(var i=0,o=s(n);i<o.length;i++){var a=o[i];f.push(n[a])}};return t.clone().primaryKeys().then((function(t){var o=Ct(n)&&n.limit===1/0&&("function"!=typeof e||e===Ft)&&{index:n.index,range:n.range},s=function(n){var a=Math.min(h,t.length-n);return c.getMany({trans:r,keys:t.slice(n,n+a),cache:"immutable"}).then((function(l){for(var f=[],p=[],g=u?[]:null,y=[],v=0;v<a;++v){var b=l[v],_={value:R(b),primKey:t[n+v]};!1!==i.call(_,_.value,_)&&(null==_.value?y.push(t[n+v]):u||0===Tt(d(b),d(_.value))?(p.push(_.value),u&&g.push(t[n+v])):(y.push(t[n+v]),f.push(_.value)))}return Promise.resolve(f.length>0&&c.mutate({trans:r,type:"add",values:f}).then((function(e){for(var t in e.failures)y.splice(parseInt(t),1);m(f.length,e)}))).then((function(){return(p.length>0||o&&"object"==typeof e)&&c.mutate({trans:r,type:"put",keys:g,values:p,criteria:o,changeSpec:"function"!=typeof e&&e,isAdditionalChunk:n>0}).then((function(e){return m(p.length,e)}))})).then((function(){return(y.length>0||o&&e===Ft)&&c.mutate({trans:r,type:"delete",keys:y,criteria:o,isAdditionalChunk:n>0}).then((function(e){return m(y.length,e)}))})).then((function(){return t.length>n+a&&s(n+h)}))}))};return s(0).then((function(){if(f.length>0)throw new V("Error modifying one or more objects",f,p,g);return t.length}))}))}))},e.prototype.delete=function(){var e=this._ctx,t=e.range;return Ct(e)&&(e.isPrimKey||3===t.type)?this._write((function(n){var r=e.table.core.schema.primaryKey,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then((function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then((function(e){var n=e.failures;e.lastResult,e.results;var r=e.numFailures;if(r)throw new V("Could not delete some values",Object.keys(n).map((function(e){return n[e]})),t-r);return t-r}))}))})):this.modify(Ft)},e}(),Ft=function(e,t){return t.value=null};function Ut(e,t){return e<t?-1:e===t?0:1}function Bt(e,t){return e>t?-1:e===t?0:1}function Gt(e,t,n){var r=e instanceof Vt?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function qt(e){return new e.Collection(e,(function(){return zt("")})).limit(0)}function Ht(e,t,n,r,i,o){for(var s=Math.min(e.length,r.length),a=-1,c=0;c<s;++c){var l=t[c];if(l!==r[c])return i(e[c],n[c])<0?e.substr(0,c)+n[c]+n.substr(c+1):i(e[c],r[c])<0?e.substr(0,c)+r[c]+n.substr(c+1):a>=0?e.substr(0,a)+t[a]+n.substr(a+1):null;i(e[c],l)<0&&(a=c)}return s<r.length&&"next"===o?e+n.substr(e.length):s<e.length&&"prev"===o?e.substr(0,n.length):a<0?null:e.substr(0,a)+r[a]+n.substr(a+1)}function $t(e,t,n,r){var i,o,s,a,c,l,u,d=n.length;if(!n.every((function(e){return"string"==typeof e})))return Gt(e,ft);function h(e){i=function(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(e),o=function(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(e),s="next"===e?Ut:Bt;var t=n.map((function(e){return{lower:o(e),upper:i(e)}})).sort((function(e,t){return s(e.lower,t.lower)}));a=t.map((function(e){return e.upper})),c=t.map((function(e){return e.lower})),l=e,u="next"===e?"":r}h("next");var f=new e.Collection(e,(function(){return Wt(a[0],c[d-1]+r)}));f._ondirectionchange=function(e){h(e)};var p=0;return f._addAlgorithm((function(e,n,r){var i=e.key;if("string"!=typeof i)return!1;var h=o(i);if(t(h,c,p))return!0;for(var f=null,g=p;g<d;++g){var m=Ht(i,h,a[g],c[g],s,l);null===m&&null===f?p=g+1:(null===f||s(f,m)>0)&&(f=m)}return n(null!==f?function(){e.continue(f+u)}:r),!1})),f}function Wt(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function zt(e){return{type:1,lower:e,upper:e}}var Vt=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?qt(this):new this.Collection(this,(function(){return Wt(e,t,!n,!r)}))}catch(e){return Gt(this,ht)}},e.prototype.equals=function(e){return null==e?Gt(this,ht):new this.Collection(this,(function(){return zt(e)}))},e.prototype.above=function(e){return null==e?Gt(this,ht):new this.Collection(this,(function(){return Wt(e,void 0,!0)}))},e.prototype.aboveOrEqual=function(e){return null==e?Gt(this,ht):new this.Collection(this,(function(){return Wt(e,void 0,!1)}))},e.prototype.below=function(e){return null==e?Gt(this,ht):new this.Collection(this,(function(){return Wt(void 0,e,!1,!0)}))},e.prototype.belowOrEqual=function(e){return null==e?Gt(this,ht):new this.Collection(this,(function(){return Wt(void 0,e)}))},e.prototype.startsWith=function(e){return"string"!=typeof e?Gt(this,ft):this.between(e,e+ut,!0,!0)},e.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):$t(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],ut)},e.prototype.equalsIgnoreCase=function(e){return $t(this,(function(e,t){return e===t[0]}),[e],"")},e.prototype.anyOfIgnoreCase=function(){var e=B.apply(U,arguments);return 0===e.length?qt(this):$t(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=B.apply(U,arguments);return 0===e.length?qt(this):$t(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,ut)},e.prototype.anyOf=function(){var e=this,t=B.apply(U,arguments),n=this._cmp;try{t.sort(n)}catch(e){return Gt(this,ht)}if(0===t.length)return qt(this);var r=new this.Collection(this,(function(){return Wt(t[0],t[t.length-1])}));r._ondirectionchange=function(r){n="next"===r?e._ascending:e._descending,t.sort(n)};var i=0;return r._addAlgorithm((function(e,r,o){for(var s=e.key;n(s,t[i])>0;)if(++i===t.length)return r(o),!1;return 0===n(s,t[i])||(r((function(){e.continue(t[i])})),!1)})),r},e.prototype.notEqual=function(e){return this.inAnyRange([[dt,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=B.apply(U,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return Gt(this,ht)}var t=e.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[dt,t]]}),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,t){var n=this,r=this._cmp,i=this._ascending,o=this._descending,s=this._min,a=this._max;if(0===e.length)return qt(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&i(e[0],e[1])<=0})))return Gt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",X.InvalidArgument);var c,l=!t||!1!==t.includeLowers,u=t&&!0===t.includeUppers,d=i;function h(e,t){return d(e[0],t[0])}try{c=e.reduce((function(e,t){for(var n=0,i=e.length;n<i;++n){var o=e[n];if(r(t[0],o[1])<0&&r(t[1],o[0])>0){o[0]=s(o[0],t[0]),o[1]=a(o[1],t[1]);break}}return n===i&&e.push(t),e}),[]),c.sort(h)}catch(e){return Gt(this,ht)}var f=0,p=u?function(e){return i(e,c[f][1])>0}:function(e){return i(e,c[f][1])>=0},g=l?function(e){return o(e,c[f][0])>0}:function(e){return o(e,c[f][0])>=0},m=p,y=new this.Collection(this,(function(){return Wt(c[0][0],c[c.length-1][1],!l,!u)}));return y._ondirectionchange=function(e){"next"===e?(m=p,d=i):(m=g,d=o),c.sort(h)},y._addAlgorithm((function(e,t,r){for(var o=e.key;m(o);)if(++f===c.length)return t(r),!1;return!!function(e){return!p(e)&&!g(e)}(o)||(0===n._cmp(o,c[f][1])||0===n._cmp(o,c[f][0])||t((function(){d===i?e.continue(c[f][0]):e.continue(c[f][1])})),!1)})),y},e.prototype.startsWithAnyOf=function(){var e=B.apply(U,arguments);return e.every((function(e){return"string"==typeof e}))?0===e.length?qt(this):this.inAnyRange(e.map((function(e){return[e,e+ut]}))):Gt(this,"startsWithAnyOf() only works with strings")},e}();function Kt(e){return He((function(t){return Yt(t),e(t.target.error),!1}))}function Yt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Qt="storagemutated",Xt="x-storagemutated-1",Jt=Ot(null,Qt),Zt=function(){function e(){}return e.prototype._lock=function(){return w(!Oe.global),++this._reculock,1!==this._reculock||Oe.global||(Oe.lockOwnerFor=this),this},e.prototype._unlock=function(){if(w(!Oe.global),0==--this._reculock)for(Oe.global||(Oe.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{it(e[1],e[0])}catch(e){}}return this},e.prototype._locked=function(){return this._reculock&&Oe.lockOwnerFor!==this},e.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(w(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new X.DatabaseClosed(r);case"MissingAPIError":throw new X.MissingAPI(r.message,r);default:throw new X.OpenFailed(r)}if(!this.active)throw new X.TransactionInactive;return w(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=He((function(n){Yt(n),t._reject(e.error)})),e.onabort=He((function(n){Yt(n),t.active&&t._reject(new X.Abort(e.error)),t.active=!1,t.on("abort").fire(n)})),e.oncomplete=He((function(){t.active=!1,t._resolve(),"mutatedParts"in e&&Jt.storagemutated.fire(e.mutatedParts)})),this},e.prototype._promise=function(e,t,n){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return at(new X.ReadOnly("Transaction is readonly"));if(!this.active)return at(new X.TransactionInactive);if(this._locked())return new Pe((function(i,o){r._blockedFuncs.push([function(){r._promise(e,t,n).then(i,o)},Oe])}));if(n)return Qe((function(){var e=new Pe((function(e,n){r._lock();var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return e.finally((function(){return r._unlock()})),e._lib=!0,e}));var i=new Pe((function(e,n){var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return i._lib=!0,i},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var t=this._root(),n=Pe.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then((function(){return n}));else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var i=t._waitingFor;return new Pe((function(e,r){n.then((function(n){return t._waitingQueue.push(He(e.bind(null,n)))}),(function(e){return t._waitingQueue.push(He(r.bind(null,e)))})).finally((function(){t._waitingFor===i&&(t._waitingFor=null)}))}))},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new X.Abort))},e.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(d(t,e))return t[e];var n=this.schema[e];if(!n)throw new X.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r},e}();function en(e,t,n,r,i,o,s){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:o,src:(n&&!s?"&":"")+(r?"*":"")+(i?"++":"")+tn(t)}}function tn(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function nn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(r=n,i=function(e){return[e.name,e]},r.reduce((function(e,t,n){var r=i(t,n);return r&&(e[r[0]]=r[1]),e}),{}))};var r,i}var rn=function(e){try{return e.only([[]]),rn=function(){return[[]]},[[]]}catch(e){return rn=function(){return ut},ut}};function on(e){return null==e?function(){}:"string"==typeof e?function(e){var t=e.split(".");return 1===t.length?function(t){return t[e]}:function(t){return E(t,e)}}(e):function(t){return E(t,e)}}function sn(e){return[].slice.call(e)}var an=0;function cn(e){return null==e?":id":"string"==typeof e?e:"[".concat(e.join("+"),"]")}function ln(e,t,n){function r(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var n=e.lower,r=e.upper,i=e.lowerOpen,o=e.upperOpen;return void 0===n?void 0===r?null:t.upperBound(r,!!o):void 0===r?t.lowerBound(n,!!i):t.bound(n,r,!!i,!!o)}var i=function(e,t){var n=sn(e.objectStoreNames);return{schema:{name:e.name,tables:n.map((function(e){return t.objectStore(e)})).map((function(e){var t=e.keyPath,n=e.autoIncrement,r=a(t),i=null==t,o={},s={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:on(t)},indexes:sn(e.indexNames).map((function(t){return e.index(t)})).map((function(e){var t=e.name,n=e.unique,r=e.multiEntry,i=e.keyPath,s={name:t,compound:a(i),keyPath:i,unique:n,multiEntry:r,extractKey:on(i)};return o[cn(i)]=s,s})),getIndexByKeyPath:function(e){return o[cn(e)]}};return o[":id"]=s.primaryKey,null!=t&&(o[cn(t)]=s.primaryKey),s}))},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,n),o=i.schema,s=i.hasGetAll,c=o.tables.map((function(e){return function(e){var t=e.name;return{name:t,schema:e,mutate:function(e){var n=e.trans,i=e.type,o=e.keys,s=e.values,a=e.range;return new Promise((function(e,c){e=He(e);var l=n.objectStore(t),u=null==l.keyPath,d="put"===i||"add"===i;if(!d&&"delete"!==i&&"deleteRange"!==i)throw new Error("Invalid operation type: "+i);var h,f=(o||s||{length:1}).length;if(o&&s&&o.length!==s.length)throw new Error("Given keys array must have same length as given values array.");if(0===f)return e({numFailures:0,failures:{},results:[],lastResult:void 0});var p=[],g=[],m=0,y=function(e){++m,Yt(e)};if("deleteRange"===i){if(4===a.type)return e({numFailures:m,failures:g,results:[],lastResult:void 0});3===a.type?p.push(h=l.clear()):p.push(h=l.delete(r(a)))}else{var v=d?u?[s,o]:[s,null]:[o,null],b=v[0],_=v[1];if(d)for(var w=0;w<f;++w)p.push(h=_&&void 0!==_[w]?l[i](b[w],_[w]):l[i](b[w])),h.onerror=y;else for(w=0;w<f;++w)p.push(h=l[i](b[w])),h.onerror=y}var T=function(t){var n=t.target.result;p.forEach((function(e,t){return null!=e.error&&(g[t]=e.error)})),e({numFailures:m,failures:g,results:"delete"===i?o:p.map((function(e){return e.result})),lastResult:n})};h.onerror=function(e){y(e),T(e)},h.onsuccess=T}))},getMany:function(e){var n=e.trans,r=e.keys;return new Promise((function(e,i){e=He(e);for(var o,s=n.objectStore(t),a=r.length,c=new Array(a),l=0,u=0,d=function(t){var n=t.target;c[n._pos]=n.result,++u===l&&e(c)},h=Kt(i),f=0;f<a;++f)null!=r[f]&&((o=s.get(r[f]))._pos=f,o.onsuccess=d,o.onerror=h,++l);0===l&&e(c)}))},get:function(e){var n=e.trans,r=e.key;return new Promise((function(e,i){e=He(e);var o=n.objectStore(t).get(r);o.onsuccess=function(t){return e(t.target.result)},o.onerror=Kt(i)}))},query:function(e){return function(n){return new Promise((function(i,o){i=He(i);var s=n.trans,a=n.values,c=n.limit,l=n.query,u=c===1/0?void 0:c,d=l.index,h=l.range,f=s.objectStore(t),p=d.isPrimaryKey?f:f.index(d.name),g=r(h);if(0===c)return i({result:[]});if(e){var m=a?p.getAll(g,u):p.getAllKeys(g,u);m.onsuccess=function(e){return i({result:e.target.result})},m.onerror=Kt(o)}else{var y=0,v=a||!("openKeyCursor"in p)?p.openCursor(g):p.openKeyCursor(g),b=[];v.onsuccess=function(e){var t=v.result;return t?(b.push(a?t.value:t.primaryKey),++y===c?i({result:b}):void t.continue()):i({result:b})},v.onerror=Kt(o)}}))}}(s),openCursor:function(e){var n=e.trans,i=e.values,o=e.query,s=e.reverse,a=e.unique;return new Promise((function(e,c){e=He(e);var l=o.index,u=o.range,d=n.objectStore(t),h=l.isPrimaryKey?d:d.index(l.name),f=s?a?"prevunique":"prev":a?"nextunique":"next",p=i||!("openKeyCursor"in h)?h.openCursor(r(u),f):h.openKeyCursor(r(u),f);p.onerror=Kt(c),p.onsuccess=He((function(t){var r=p.result;if(r){r.___id=++an,r.done=!1;var i=r.continue.bind(r),o=r.continuePrimaryKey;o&&(o=o.bind(r));var s=r.advance.bind(r),a=function(){throw new Error("Cursor not stopped")};r.trans=n,r.stop=r.continue=r.continuePrimaryKey=r.advance=function(){throw new Error("Cursor not started")},r.fail=He(c),r.next=function(){var e=this,t=1;return this.start((function(){return t--?e.continue():e.stop()})).then((function(){return e}))},r.start=function(e){var t=new Promise((function(e,t){e=He(e),p.onerror=Kt(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=a,e(t)}})),n=function(){if(p.result)try{e()}catch(e){r.fail(e)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return p.onsuccess=He((function(e){p.onsuccess=n,n()})),r.continue=i,r.continuePrimaryKey=o,r.advance=s,n(),t},e(r)}else e(null)}),c)}))},count:function(e){var n=e.query,i=e.trans,o=n.index,s=n.range;return new Promise((function(e,n){var a=i.objectStore(t),c=o.isPrimaryKey?a:a.index(o.name),l=r(s),u=l?c.count(l):c.count();u.onsuccess=He((function(t){return e(t.target.result)})),u.onerror=Kt(n)}))}}}(e)})),l={};return c.forEach((function(e){return l[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!l[e])throw new Error("Table '".concat(e,"' not found"));return l[e]},MIN_KEY:-1/0,MAX_KEY:rn(t),schema:o}}function un(e,t,n,i){var o=n.IDBKeyRange;n.indexedDB;var s=function(e,t){return t.reduce((function(e,t){var n=t.create;return r(r({},e),n(e))}),e)}(ln(t,o,i),e.dbcore);return{dbcore:s}}function dn(e,t){var n=t.db,r=un(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach((function(t){var n=t.name;e.core.schema.tables.some((function(e){return e.name===n}))&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))}))}function hn(e,t,n,r){n.forEach((function(n){var i=r[n];t.forEach((function(t){var r=y(t,n);(!r||"value"in r&&void 0===r.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?p(t,n,{get:function(){return this.table(n)},set:function(e){f(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,i))}))}))}function fn(e,t){t.forEach((function(t){for(var n in t)t[n]instanceof e.Table&&delete t[n]}))}function pn(e,t){return e._cfg.version-t._cfg.version}function gn(e,t,n,r){var i=e._dbSchema;n.objectStoreNames.contains("$meta")&&!i.$meta&&(i.$meta=nn("$meta",Tn("")[0],[]),e._storeNames.push("$meta"));var o=e._createTransaction("readwrite",e._storeNames,i);o.create(n),o._completion.catch(r);var a=o._reject.bind(o),c=Oe.transless||Oe;Qe((function(){if(Oe.trans=o,Oe.transless=c,0!==t)return dn(e,n),function(e,t,n){return t.storeNames.includes("$meta")?t.table("$meta").get("version").then((function(e){return null!=e?e:n})):Pe.resolve(n)}(0,o,t).then((function(t){return function(e,t,n,r){var i=[],o=e._versions,a=e._dbSchema=_n(0,e.idbdb,r),c=o.filter((function(e){return e._cfg.version>=t}));if(0===c.length)return Pe.resolve();function l(){return i.length?Pe.resolve(i.shift()(n.idbtrans)).then(l):Pe.resolve()}return c.forEach((function(o){i.push((function(){var i=a,c=o._cfg.dbschema;wn(e,i,r),wn(e,c,r),a=e._dbSchema=c;var l=mn(i,c);l.add.forEach((function(e){yn(r,e[0],e[1].primKey,e[1].indexes)})),l.change.forEach((function(e){if(e.recreate)throw new X.Upgrade("Not yet support for changing primary key");var t=r.objectStore(e.name);e.add.forEach((function(e){return bn(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),bn(t,e)})),e.del.forEach((function(e){return t.deleteIndex(e)}))}));var u=o._cfg.contentUpgrade;if(u&&o._cfg.version>t){dn(e,r),n._memoizedTables={};var d=S(c);l.del.forEach((function(e){d[e]=i[e]})),fn(e,[e.Transaction.prototype]),hn(e,[e.Transaction.prototype],s(d),d),n.schema=d;var h,f=G(u);f&&Xe();var p=Pe.follow((function(){if((h=u(n))&&f){var e=Je.bind(null,null);h.then(e,e)}}));return h&&"function"==typeof h.then?Pe.resolve(h):p.then((function(){return h}))}})),i.push((function(t){!function(e,t){[].slice.call(t.db.objectStoreNames).forEach((function(n){return null==e[n]&&t.db.deleteObjectStore(n)}))}(o._cfg.dbschema,t),fn(e,[e.Transaction.prototype]),hn(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema})),i.push((function(t){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===o._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter((function(e){return"$meta"!==e}))):t.objectStore("$meta").put(o._cfg.version,"version"))}))})),l().then((function(){vn(a,r)}))}(e,t,o,n)})).catch(a);s(i).forEach((function(e){yn(n,e,i[e].primKey,i[e].indexes)})),dn(e,n),Pe.follow((function(){return e.on.populate.fire(o)})).catch(a)}))}function mn(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var i=e[n],o=t[n];if(i){var s={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto)s.recreate=!0,r.change.push(s);else{var a=i.idxByName,c=o.idxByName,l=void 0;for(l in a)c[l]||s.del.push(l);for(l in c){var u=a[l],d=c[l];u?u.src!==d.src&&s.change.push(d):s.add.push(d)}(s.del.length>0||s.add.length>0||s.change.length>0)&&r.change.push(s)}}else r.add.push([n,o])}return r}function yn(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((function(e){return bn(i,e)})),i}function vn(e,t){s(e).forEach((function(n){t.db.objectStoreNames.contains(n)||(le&&console.debug("Dexie: Creating missing table",n),yn(t,n,e[n].primKey,e[n].indexes))}))}function bn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function _n(e,t,n){var r={};return b(t.objectStoreNames,0).forEach((function(e){for(var t=n.objectStore(e),i=t.keyPath,o=en(tn(i),i||"",!0,!1,!!t.autoIncrement,i&&"string"!=typeof i,!0),s=[],a=0;a<t.indexNames.length;++a){var c=t.index(t.indexNames[a]);i=c.keyPath;var l=en(c.name,i,!!c.unique,!!c.multiEntry,!1,i&&"string"!=typeof i,!1);s.push(l)}r[e]=nn(e,o,s)})),r}function wn(e,t,n){for(var r=n.db.objectStoreNames,i=0;i<r.length;++i){var s=r[i],a=n.objectStore(s);e._hasGetAll="getAll"in a;for(var c=0;c<a.indexNames.length;++c){var l=a.indexNames[c],u=a.index(l).keyPath,d="string"==typeof u?u:"["+b(u).join("+")+"]";if(t[s]){var h=t[s].idxByName[d];h&&(h.name=l,delete t[s].idxByName[d],t[s].idxByName[l]=h)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Tn(e){return e.split(",").map((function(e,t){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return en(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),a(r),0===t)}))}var En,An=function(){function e(){}return e.prototype._parseStoresSpec=function(e,t){s(e).forEach((function(n){if(null!==e[n]){var r=Tn(e[n]),i=r.shift();if(i.unique=!0,i.multi)throw new X.Schema("Primary key cannot be multi-valued");r.forEach((function(e){if(e.auto)throw new X.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new X.Schema("Index must have a name and cannot be an empty string")})),t[n]=nn(n,i,r)}}))},e.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?c(this._cfg.storesSource,e):e;var n=t._versions,r={},i={};return n.forEach((function(e){c(r,e._cfg.storesSource),i=e._cfg.dbschema={},e._parseStoresSpec(r,i)})),t._dbSchema=i,fn(t,[t._allTables,t,t.Transaction.prototype]),hn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],s(i),i),t._storeNames=s(i),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=ce(this._cfg.contentUpgrade||ee,e),this},e}();function Sn(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new pr(gt,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function On(e){return e&&"function"==typeof e.databases}function In(e){return Qe((function(){return Oe.letThrough=!0,e()}))}function Cn(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(t){var n=function(){return indexedDB.databases().finally(t)};e=setInterval(n,100),n()})).finally((function(){return clearInterval(e)})):Promise.resolve()}function kn(e){return!("from"in e)}var Pn=function(e,t){if(!this){var n=new Pn;return e&&"d"in e&&c(n,e),n}c(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function xn(e,t,n){var r=Tt(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(kn(e))return c(e,{from:t,to:n,d:1});var i=e.l,o=e.r;if(Tt(n,e.from)<0)return i?xn(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},Nn(e);if(Tt(t,e.to)>0)return o?xn(o,t,n):e.r={from:t,to:n,d:1,l:null,r:null},Nn(e);Tt(t,e.from)<0&&(e.from=t,e.l=null,e.d=o?o.d+1:1),Tt(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var s=!e.r;i&&!e.l&&Rn(e,i),o&&s&&Rn(e,o)}}function Rn(e,t){kn(t)||function e(t,n){var r=n.from,i=n.to,o=n.l,s=n.r;xn(t,r,i),o&&e(t,o),s&&e(t,s)}(e,t)}function Ln(e,t){var n=Dn(t),r=n.next();if(r.done)return!1;for(var i=r.value,o=Dn(e),s=o.next(i.from),a=s.value;!r.done&&!s.done;){if(Tt(a.from,i.to)<=0&&Tt(a.to,i.from)>=0)return!0;Tt(i.from,a.from)<0?i=(r=n.next(a.from)).value:a=(s=o.next(i.from)).value}return!1}function Dn(e){var t=kn(e)?null:{s:0,n:e};return{next:function(e){for(var n=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&Tt(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||Tt(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Nn(e){var t,n,i=((null===(t=e.r)||void 0===t?void 0:t.d)||0)-((null===(n=e.l)||void 0===n?void 0:n.d)||0),o=i>1?"r":i<-1?"l":"";if(o){var s="r"===o?"l":"r",a=r({},e),c=e[o];e.from=c.from,e.to=c.to,e[o]=c[o],a[o]=c[s],e[s]=a,a.d=jn(a)}e.d=jn(e)}function jn(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function Mn(e,t){return s(t).forEach((function(n){e[n]?Rn(e[n],t[n]):e[n]=P(t[n])})),e}function Fn(e,t){return e.all||t.all||Object.keys(e).some((function(n){return t[n]&&Ln(t[n],e[n])}))}h(Pn.prototype,(En={add:function(e){return Rn(this,e),this},addKey:function(e){return xn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach((function(e){return xn(t,e,e)})),this}},En[j]=function(){return Dn(this)},En));var Un={},Bn={},Gn=!1;function qn(e,t){Mn(Bn,e),Gn||(Gn=!0,setTimeout((function(){Gn=!1;var e=Bn;Bn={},Hn(e,!1)}),0))}function Hn(e,t){void 0===t&&(t=!1);var n=new Set;if(e.all)for(var r=0,i=Object.values(Un);r<i.length;r++)$n(a=i[r],e,n,t);else for(var o in e){var s=/^idb\:\/\/(.*)\/(.*)\//.exec(o);if(s){var a,c=s[1],l=s[2];(a=Un["idb://".concat(c,"/").concat(l)])&&$n(a,e,n,t)}}n.forEach((function(e){return e()}))}function $n(e,t,n,r){for(var i=[],o=0,s=Object.entries(e.queries.query);o<s.length;o++){for(var a=s[o],c=a[0],l=[],u=0,d=a[1];u<d.length;u++){var h=d[u];Fn(t,h.obsSet)?h.subscribers.forEach((function(e){return n.add(e)})):r&&l.push(h)}r&&i.push([c,l])}if(r)for(var f=0,p=i;f<p.length;f++){var g=p[f];c=g[0],l=g[1],e.queries.query[c]=l}}function Wn(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?at(t.dbOpenError):e}));t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,i=Math.round(10*e.verno),o=!1;function a(){if(t.openCanceller!==r)throw new X.DatabaseClosed("db.open() was cancelled")}var c=t.dbReadyResolve,l=null,u=!1,d=function(){return new Pe((function(r,c){if(a(),!n)throw new X.MissingAPI;var h=e.name,f=t.autoSchema||!i?n.open(h):n.open(h,i);if(!f)throw new X.MissingAPI;f.onerror=Kt(c),f.onblocked=He(e._fireOnBlocked),f.onupgradeneeded=He((function(r){if(l=f.transaction,t.autoSchema&&!e._options.allowEmptyDB){f.onerror=Yt,l.abort(),f.result.close();var i=n.deleteDatabase(h);i.onsuccess=i.onerror=He((function(){c(new X.NoSuchDatabase("Database ".concat(h," doesnt exist")))}))}else{l.onerror=Kt(c);var s=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;u=s<1,e.idbdb=f.result,o&&function(e,t){vn(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=_n(0,e.idbdb,t);wn(e,e._dbSchema,t);for(var r=function(e){if(e.change.length||e.recreate)return console.warn("Unable to patch indexes of table ".concat(e.name," because it has changes on the type of index or primary key.")),{value:void 0};var n=t.objectStore(e.name);e.add.forEach((function(t){le&&console.debug("Dexie upgrade patch: Creating missing index ".concat(e.name,".").concat(t.src)),bn(n,t)}))},i=0,o=mn(n,e._dbSchema).change;i<o.length;i++){var s=r(o[i]);if("object"==typeof s)return s.value}}(e,l),gn(e,s/10,l,c)}}),c),f.onsuccess=He((function(){l=null;var n,a=e.idbdb=f.result,c=b(a.objectStoreNames);if(c.length>0)try{var p=a.transaction(1===(n=c).length?n[0]:n,"readonly");if(t.autoSchema)!function(e,t,n){e.verno=t.version/10;var r=e._dbSchema=_n(0,t,n);e._storeNames=b(t.objectStoreNames,0),hn(e,[e._allTables],s(r),r)}(e,a,p);else if(wn(e,e._dbSchema,p),!function(e,t){var n=mn(_n(0,e.idbdb,t),e._dbSchema);return!(n.add.length||n.change.some((function(e){return e.add.length||e.change.length})))}(e,p)&&!o)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),a.close(),i=a.version+1,o=!0,r(d());dn(e,p)}catch(e){}pt.push(e),a.onversionchange=He((function(n){t.vcFired=!0,e.on("versionchange").fire(n)})),a.onclose=He((function(t){e.on("close").fire(t)})),u&&function(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!On(n)&&t!==gt&&Sn(n,r).put({name:t}).catch(ee)}(e._deps,h),r()}),c)})).catch((function(e){switch(null==e?void 0:e.name){case"UnknownError":if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),d();break;case"VersionError":if(i>0)return i=0,d()}return Pe.reject(e)}))};return Pe.race([r,("undefined"==typeof navigator?Pe.resolve():Cn()).then(d)]).then((function(){return a(),t.onReadyBeingFired=[],Pe.resolve(In((function(){return e.on.ready.fire(e.vip)}))).then((function n(){if(t.onReadyBeingFired.length>0){var r=t.onReadyBeingFired.reduce(ce,ee);return t.onReadyBeingFired=[],Pe.resolve(In((function(){return r(e.vip)}))).then(n)}}))})).finally((function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)})).catch((function(n){t.dbOpenError=n;try{l&&l.abort()}catch(e){}return r===t.openCanceller&&e._close(),at(n)})).finally((function(){t.openComplete=!0,c()})).then((function(){if(u){var t={};e.tables.forEach((function(n){n.schema.indexes.forEach((function(r){r.name&&(t["idb://".concat(e.name,"/").concat(n.name,"/").concat(r.name)]=new Pn(-1/0,[[[]]]))})),t["idb://".concat(e.name,"/").concat(n.name,"/")]=t["idb://".concat(e.name,"/").concat(n.name,"/:dels")]=new Pn(-1/0,[[[]]])})),Jt(Qt).fire(t),Hn(t,!0)}return e}))}function zn(e){var t=function(t){return e.next(t)},n=i(t),r=i((function(t){return e.throw(t)}));function i(e){return function(t){var i=e(t),o=i.value;return i.done?o:o&&"function"==typeof o.then?o.then(n,r):a(o)?Promise.all(o).then(n,r):n(o)}}return i(t)()}function Vn(e,t,n){var r=arguments.length;if(r<2)throw new X.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];return n=i.pop(),[e,I(i),n]}function Kn(e,t,n,r,i){return Pe.resolve().then((function(){var o=Oe.transless||Oe,s=e._createTransaction(t,n,e._dbSchema,r);s.explicit=!0;var a={trans:s,transless:o};if(r)s.idbtrans=r.idbtrans;else try{s.create(),s.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(r){return r.name===Y.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then((function(){return Kn(e,t,n,null,i)}))):at(r)}var c,l=G(i);l&&Xe();var u=Pe.follow((function(){if(c=i.call(s,s))if(l){var e=Je.bind(null,null);c.then(e,e)}else"function"==typeof c.next&&"function"==typeof c.throw&&(c=zn(c))}),a);return(c&&"function"==typeof c.then?Pe.resolve(c).then((function(e){return s.active?e:at(new X.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):u.then((function(){return c}))).then((function(e){return r&&s._resolve(),s._completion.then((function(){return e}))})).catch((function(e){return s._reject(e),at(e)}))}))}function Yn(e,t,n){for(var r=a(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}var Qn={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return r(r({},e),{table:function(t){var n=e.table(t),i=n.schema,o={},s=[];function a(e,t,n){var i=cn(e),c=o[i]=o[i]||[],l=null==e?0:"string"==typeof e?1:e.length,u=t>0,d=r(r({},n),{name:u?"".concat(i,"(virtual-from:").concat(n.name,")"):n.name,lowLevelIndex:n,isVirtual:u,keyTail:t,keyLength:l,extractKey:on(e),unique:!u&&n.unique});return c.push(d),d.isPrimaryKey||s.push(d),l>1&&a(2===l?e[0]:e.slice(0,l-1),t+1,n),c.sort((function(e,t){return e.keyTail-t.keyTail})),d}var c=a(i.primaryKey.keyPath,0,i.primaryKey);o[":id"]=[c];for(var l=0,u=i.indexes;l<u.length;l++){var d=u[l];a(d.keyPath,0,d)}function h(t){var n,i,o=t.query.index;return o.isVirtual?r(r({},t),{query:{index:o.lowLevelIndex,range:(n=t.query.range,i=o.keyTail,{type:1===n.type?2:n.type,lower:Yn(n.lower,n.lowerOpen?e.MAX_KEY:e.MIN_KEY,i),lowerOpen:!0,upper:Yn(n.upper,n.upperOpen?e.MIN_KEY:e.MAX_KEY,i),upperOpen:!0})}}):t}var f=r(r({},n),{schema:r(r({},i),{primaryKey:c,indexes:s,getIndexByKeyPath:function(e){var t=o[cn(e)];return t&&t[0]}}),count:function(e){return n.count(h(e))},query:function(e){return n.query(h(e))},openCursor:function(t){var r=t.query.index,i=r.keyTail,o=r.isVirtual,s=r.keyLength;return o?n.openCursor(h(t)).then((function(n){return n&&function(n){var r=Object.create(n,{continue:{value:function(r){null!=r?n.continue(Yn(r,t.reverse?e.MAX_KEY:e.MIN_KEY,i)):t.unique?n.continue(n.key.slice(0,s).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,i)):n.continue()}},continuePrimaryKey:{value:function(t,r){n.continuePrimaryKey(Yn(t,e.MAX_KEY,i),r)}},primaryKey:{get:function(){return n.primaryKey}},key:{get:function(){var e=n.key;return 1===s?e[0]:e.slice(0,s)}},value:{get:function(){return n.value}}});return r}(n)})):n.openCursor(t)}});return f}})}};function Xn(e,t,n,r){return n=n||{},r=r||"",s(e).forEach((function(i){if(d(t,i)){var o=e[i],s=t[i];if("object"==typeof o&&"object"==typeof s&&o&&s){var a=N(o);a!==N(s)?n[r+i]=t[i]:"Object"===a?Xn(o,s,n,r+i+"."):o!==s&&(n[r+i]=t[i])}else o!==s&&(n[r+i]=t[i])}else n[r+i]=void 0})),s(t).forEach((function(i){d(e,i)||(n[r+i]=t[i])})),n}function Jn(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}var Zn={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return r(r({},e),{table:function(t){var n=e.table(t),o=n.schema.primaryKey,s=r(r({},n),{mutate:function(e){var s=Oe.trans,a=s.table(t).hook,c=a.deleting,l=a.creating,u=a.updating;switch(e.type){case"add":if(l.fire===ee)break;return s._promise("readwrite",(function(){return h(e)}),!0);case"put":if(l.fire===ee&&u.fire===ee)break;return s._promise("readwrite",(function(){return h(e)}),!0);case"delete":if(c.fire===ee)break;return s._promise("readwrite",(function(){return h(e)}),!0);case"deleteRange":if(c.fire===ee)break;return s._promise("readwrite",(function(){return function(e){return f(e.trans,e.range,1e4)}(e)}),!0)}return n.mutate(e);function h(e){var t=Oe.trans,s=e.keys||Jn(o,e);if(!s)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?r(r({},e),{keys:s}):r({},e)).type&&(e.values=i([],e.values,!0)),e.keys&&(e.keys=i([],e.keys,!0)),function(e,t,n){return"add"===t.type?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}(n,e,s).then((function(r){var i=s.map((function(n,i){var s=r[i],a={onerror:null,onsuccess:null};if("delete"===e.type)c.fire.call(a,n,s,t);else if("add"===e.type||void 0===s){var h=l.fire.call(a,n,e.values[i],t);null==n&&null!=h&&(n=h,e.keys[i]=n,o.outbound||A(e.values[i],o.keyPath,n))}else{var f=Xn(s,e.values[i]),p=u.fire.call(a,f,n,s,t);if(p){var g=e.values[i];Object.keys(p).forEach((function(e){d(g,e)?g[e]=p[e]:A(g,e,p[e])}))}}return a}));return n.mutate(e).then((function(t){for(var n=t.failures,o=t.results,a=t.numFailures,c=t.lastResult,l=0;l<s.length;++l){var u=o?o[l]:s[l],d=i[l];null==u?d.onerror&&d.onerror(n[l]):d.onsuccess&&d.onsuccess("put"===e.type&&r[l]?e.values[l]:u)}return{failures:n,results:o,numFailures:a,lastResult:c}})).catch((function(e){return i.forEach((function(t){return t.onerror&&t.onerror(e)})),Promise.reject(e)}))}))}function f(e,t,i){return n.query({trans:e,values:!1,query:{index:o,range:t},limit:i}).then((function(n){var o=n.result;return h({type:"delete",keys:o,trans:e}).then((function(n){return n.numFailures>0?Promise.reject(n.failures[0]):o.length<i?{failures:[],numFailures:0,lastResult:void 0}:f(e,r(r({},t),{lower:o[o.length-1],lowerOpen:!0}),i)}))}))}}});return s}})}};function er(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;for(var r=[],i=0,o=0;i<t.keys.length&&o<e.length;++i)0===Tt(t.keys[i],e[o])&&(r.push(n?R(t.values[i]):t.values[i]),++o);return r.length===e.length?r:null}catch(e){return null}}var tr={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return r(r({},n),{getMany:function(e){if(!e.cache)return n.getMany(e);var t=er(e.keys,e.trans._cache,"clone"===e.cache);return t?Pe.resolve(t):n.getMany(e).then((function(t){return e.trans._cache={keys:e.keys,values:"clone"===e.cache?R(t):t},t}))},mutate:function(e){return"add"!==e.type&&(e.trans._cache=null),n.mutate(e)}})}}}};function nr(e,t){return"readonly"===e.trans.mode&&!!e.subscr&&!e.trans.explicit&&"disabled"!==e.trans.db._options.cache&&!t.schema.primaryKey.outbound}function rr(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var ir={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new Pn(e.MIN_KEY,e.MAX_KEY);return r(r({},e),{transaction:function(t,n,r){if(Oe.subscr&&"readonly"!==n)throw new X.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Oe.querier));return e.transaction(t,n,r)},table:function(i){var o=e.table(i),c=o.schema,l=c.primaryKey,u=c.indexes,d=l.extractKey,h=l.outbound,f=l.autoIncrement&&u.filter((function(e){return e.compound&&e.keyPath.includes(l.keyPath)})),p=r(r({},o),{mutate:function(e){var r=e.trans,s=e.mutatedParts||(e.mutatedParts={}),u=function(e){var n="idb://".concat(t,"/").concat(i,"/").concat(e);return s[n]||(s[n]=new Pn)},d=u(""),h=u(":dels"),p=e.type,g="deleteRange"===e.type?[e.range]:"delete"===e.type?[e.keys]:e.values.length<50?[Jn(l,e).filter((function(e){return e})),e.values]:[],m=g[0],y=g[1],v=e.trans._cache;if(a(m)){d.addKeys(m);var b="delete"===p||m.length===y.length?er(m,v):null;b||h.addKeys(m),(b||y)&&function(e,t,n,r){function i(t){var i=e(t.name||"");function o(e){return null!=e?t.extractKey(e):null}var s=function(e){return t.multiEntry&&a(e)?e.forEach((function(e){return i.addKey(e)})):i.addKey(e)};(n||r).forEach((function(e,t){var i=n&&o(n[t]),a=r&&o(r[t]);0!==Tt(i,a)&&(null!=i&&s(i),null!=a&&s(a))}))}t.indexes.forEach(i)}(u,c,b,y)}else if(m){var _={from:m.lower,to:m.upper};h.add(_),d.add(_)}else d.add(n),h.add(n),c.indexes.forEach((function(e){return u(e.name).add(n)}));return o.mutate(e).then((function(t){return!m||"add"!==e.type&&"put"!==e.type||(d.addKeys(t.results),f&&f.forEach((function(n){var r=e.values.map((function(e){return n.extractKey(e)})),i=n.keyPath.findIndex((function(e){return e===l.keyPath}));t.results.forEach((function(e){return r[i]=e})),u(n.name).addKeys(r)}))),r.mutatedParts=Mn(r.mutatedParts||{},s),t}))}}),g=function(t){var n,r,i=t.query,o=i.index,s=i.range;return[o,new Pn(null!==(n=s.lower)&&void 0!==n?n:e.MIN_KEY,null!==(r=s.upper)&&void 0!==r?r:e.MAX_KEY)]},m={get:function(e){return[l,new Pn(e.key)]},getMany:function(e){return[l,(new Pn).addKeys(e.keys)]},count:g,query:g,openCursor:g};return s(m).forEach((function(e){p[e]=function(s){var a=Oe.subscr,c=!!a,l=nr(Oe,o)&&rr(e,s)?s.obsSet={}:a;if(c){var u=function(e){var n="idb://".concat(t,"/").concat(i,"/").concat(e);return l[n]||(l[n]=new Pn)},f=u(""),p=u(":dels"),g=m[e](s),y=g[0],v=g[1];if("query"===e&&y.isPrimaryKey&&!s.values?p.add(v):u(y.name||"").add(v),!y.isPrimaryKey){if("count"!==e){var b="query"===e&&h&&s.values&&o.query(r(r({},s),{values:!1}));return o[e].apply(this,arguments).then((function(t){if("query"===e){if(h&&s.values)return b.then((function(e){var n=e.result;return f.addKeys(n),t}));var n=s.values?t.result.map(d):t.result;s.values?f.addKeys(n):p.addKeys(n)}else if("openCursor"===e){var r=t,i=s.values;return r&&Object.create(r,{key:{get:function(){return p.addKey(r.primaryKey),r.key}},primaryKey:{get:function(){var e=r.primaryKey;return p.addKey(e),e}},value:{get:function(){return i&&f.addKey(r.primaryKey),r.value}}})}return t}))}p.add(n)}}return o[e].apply(this,arguments)}})),p}})}};function or(e,t,n){if(0===n.numFailures)return t;if("deleteRange"===t.type)return null;var i=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;if(n.numFailures===i)return null;var o=r({},t);return a(o.keys)&&(o.keys=o.keys.filter((function(e,t){return!(t in n.failures)}))),"values"in o&&a(o.values)&&(o.values=o.values.filter((function(e,t){return!(t in n.failures)}))),o}function sr(e,t){return function(e,t){return void 0===t.lower||(t.lowerOpen?Tt(e,t.lower)>0:Tt(e,t.lower)>=0)}(e,t)&&function(e,t){return void 0===t.upper||(t.upperOpen?Tt(e,t.upper)<0:Tt(e,t.upper)<=0)}(e,t)}function ar(e,t,n,r,i,o){if(!n||0===n.length)return e;var s=t.query.index,c=s.multiEntry,l=t.query.range,u=r.schema.primaryKey.extractKey,d=s.extractKey,h=(s.lowLevelIndex||s).extractKey,f=n.reduce((function(e,n){var r=e,i="add"===n.type||"put"===n.type?n.values.filter((function(e){var t=d(e);return c&&a(t)?t.some((function(e){return sr(e,l)})):sr(t,l)})).map((function(e){return e=R(e),o&&Object.freeze(e),e})):[];switch(n.type){case"add":r=e.concat(t.values?i:i.map((function(e){return u(e)})));break;case"put":var s=(new Pn).addKeys(n.values.map((function(e){return u(e)})));r=e.filter((function(e){var n=t.values?u(e):e;return!Ln(new Pn(n),s)})).concat(t.values?i:i.map((function(e){return u(e)})));break;case"delete":var h=(new Pn).addKeys(n.keys);r=e.filter((function(e){var n=t.values?u(e):e;return!Ln(new Pn(n),h)}));break;case"deleteRange":var f=n.range;r=e.filter((function(e){return!sr(u(e),f)}))}return r}),e);return f===e?e:(f.sort((function(e,t){return Tt(h(e),h(t))||Tt(u(e),u(t))})),t.limit&&t.limit<1/0&&(f.length>t.limit?f.length=t.limit:e.length===t.limit&&f.length<t.limit&&(i.dirty=!0)),o?Object.freeze(f):f)}function cr(e,t){return 0===Tt(e.lower,t.lower)&&0===Tt(e.upper,t.upper)&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function lr(e,t){return function(e,t,n,r){if(void 0===e)return void 0!==t?-1:0;if(void 0===t)return 1;var i=Tt(e,t);if(0===i){if(n&&r)return 0;if(n)return 1;if(r)return-1}return i}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&function(e,t,n,r){if(void 0===e)return void 0!==t?1:0;if(void 0===t)return-1;var i=Tt(e,t);if(0===i){if(n&&r)return 0;if(n)return-1;if(r)return 1}return i}(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function ur(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",(function(){e.subscribers.delete(n),0===e.subscribers.size&&function(e,t){setTimeout((function(){0===e.subscribers.size&&F(t,e)}),3e3)}(e,t)}))}var dr={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name,n=r(r({},e),{transaction:function(n,r,i){var o=e.transaction(n,r,i);if("readwrite"===r){var s=new AbortController,a=s.signal,c=function(i){return function(){if(s.abort(),"readwrite"===r){for(var a=new Set,c=0,l=n;c<l.length;c++){var u=l[c],d=Un["idb://".concat(t,"/").concat(u)];if(d){var h=e.table(u),f=d.optimisticOps.filter((function(e){return e.trans===o}));if(o._explicit&&i&&o.mutatedParts)for(var p=0,g=Object.values(d.queries.query);p<g.length;p++)for(var m=0,y=(_=g[p]).slice();m<y.length;m++)Fn((E=y[m]).obsSet,o.mutatedParts)&&(F(_,E),E.subscribers.forEach((function(e){return a.add(e)})));else if(f.length>0){d.optimisticOps=d.optimisticOps.filter((function(e){return e.trans!==o}));for(var v=0,b=Object.values(d.queries.query);v<b.length;v++)for(var _,w=0,T=(_=b[v]).slice();w<T.length;w++){var E;if(null!=(E=T[w]).res&&o.mutatedParts)if(i&&!E.dirty){var A=Object.isFrozen(E.res),S=ar(E.res,E.req,f,h,E,A);E.dirty?(F(_,E),E.subscribers.forEach((function(e){return a.add(e)}))):S!==E.res&&(E.res=S,E.promise=Pe.resolve({result:S}))}else E.dirty&&F(_,E),E.subscribers.forEach((function(e){return a.add(e)}))}}}}a.forEach((function(e){return e()}))}}};o.addEventListener("abort",c(!1),{signal:a}),o.addEventListener("error",c(!1),{signal:a}),o.addEventListener("complete",c(!0),{signal:a})}return o},table:function(n){var i=e.table(n),o=i.schema.primaryKey,s=r(r({},i),{mutate:function(e){var s=Oe.trans;if(o.outbound||"disabled"===s.db._options.cache||s.explicit)return i.mutate(e);var a=Un["idb://".concat(t,"/").concat(n)];if(!a)return i.mutate(e);var c=i.mutate(e);return"add"!==e.type&&"put"!==e.type||!(e.values.length>=50||Jn(o,e).some((function(e){return null==e})))?(a.optimisticOps.push(e),e.mutatedParts&&qn(e.mutatedParts),c.then((function(t){if(t.numFailures>0){F(a.optimisticOps,e);var n=or(0,e,t);n&&a.optimisticOps.push(n),e.mutatedParts&&qn(e.mutatedParts)}})),c.catch((function(){F(a.optimisticOps,e),e.mutatedParts&&qn(e.mutatedParts)}))):c.then((function(t){var n=r(r({},e),{values:e.values.map((function(e,n){var i,s=(null===(i=o.keyPath)||void 0===i?void 0:i.includes("."))?R(e):r({},e);return A(s,o.keyPath,t.results[n]),s}))}),i=or(0,n,t);a.optimisticOps.push(i),queueMicrotask((function(){return e.mutatedParts&&qn(e.mutatedParts)}))})),c},query:function(e){var r;if(!nr(Oe,i)||!rr("query",e))return i.query(e);var o="immutable"===(null===(r=Oe.trans)||void 0===r?void 0:r.db._options.cache),s=Oe,a=s.requery,c=s.signal,l=function(e,t,n,r){var i=Un["idb://".concat(e,"/").concat(t)];if(!i)return[];var o=i.queries[n];if(!o)return[null,!1,i,null];var s=o[(r.query?r.query.index.name:null)||""];if(!s)return[null,!1,i,null];switch(n){case"query":var a=s.find((function(e){return e.req.limit===r.limit&&e.req.values===r.values&&cr(e.req.query.range,r.query.range)}));return a?[a,!0,i,s]:[s.find((function(e){return("limit"in e.req?e.req.limit:1/0)>=r.limit&&(!r.values||e.req.values)&&lr(e.req.query.range,r.query.range)})),!1,i,s];case"count":var c=s.find((function(e){return cr(e.req.query.range,r.query.range)}));return[c,!!c,i,s]}}(t,n,"query",e),u=l[0],d=l[1],h=l[2],f=l[3];if(u&&d)u.obsSet=e.obsSet;else{var p=i.query(e).then((function(e){var t=e.result;if(u&&(u.res=t),o){for(var n=0,r=t.length;n<r;++n)Object.freeze(t[n]);Object.freeze(t)}else e.result=R(t);return e})).catch((function(e){return f&&u&&F(f,u),Promise.reject(e)}));u={obsSet:e.obsSet,promise:p,subscribers:new Set,type:"query",req:e,dirty:!1},f?f.push(u):(f=[u],h||(h=Un["idb://".concat(t,"/").concat(n)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),h.queries.query[e.query.index.name||""]=f)}return ur(u,f,a,c),u.promise.then((function(t){return{result:ar(t.result,e,null==h?void 0:h.optimisticOps,i,u,o)}}))}});return s}});return n}};function hr(e,t){return new Proxy(e,{get:function(e,n,r){return"db"===n?t:Reflect.get(e,n,r)}})}var fr,pr=function(){function e(t,n){var i=this;this._middlewares={},this.verno=0;var o=e.dependencies;this._options=n=r({addons:e.addons,autoOpen:!0,indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange,cache:"cloned"},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var s=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a,c={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ee,dbReadyPromise:null,cancelOpen:ee,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:n.autoOpen};c.dbReadyPromise=new Pe((function(e){c.dbReadyResolve=e})),c.openCanceller=new Pe((function(e,t){c.cancelOpen=t})),this._state=c,this.name=t,this.on=Ot(this,"populate","blocked","versionchange","close",{ready:[ce,ee]}),this.on.ready.subscribe=_(this.on.ready.subscribe,(function(t){return function(n,r){e.vip((function(){var e=i._state;if(e.openComplete)e.dbOpenError||Pe.resolve().then(n),r&&t(n);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(n),r&&t(n);else{t(n);var o=i;r||t((function e(){o.on.ready.unsubscribe(n),o.on.ready.unsubscribe(e)}))}}))}})),this.Collection=(a=this,It(Mt.prototype,(function(e,t){this.db=a;var n=bt,r=null;if(t)try{n=t()}catch(e){r=e}var i=e._ctx,o=i.table,s=o.hook.reading.fire;this._ctx={table:o,index:i.index,isPrimKey:!i.index||o.schema.primKey.keyPath&&i.index===o.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:s!==te?s:null}}))),this.Table=function(e){return It(St.prototype,(function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:Ot(null,{creating:[ie,ee],reading:[ne,te],updating:[se,ee],deleting:[oe,ee]})}))}(this),this.Transaction=function(e){return It(Zt.prototype,(function(t,n,r,i,o){var s=this;this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.chromeTransactionDurability=i,this.idbtrans=null,this.on=Ot(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Pe((function(e,t){s._resolve=e,s._reject=t})),this._completion.then((function(){s.active=!1,s.on.complete.fire()}),(function(e){var t=s.active;return s.active=!1,s.on.error.fire(e),s.parent?s.parent._reject(e):t&&s.idbtrans&&s.idbtrans.abort(),at(e)}))}))}(this),this.Version=function(e){return It(An.prototype,(function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(e){return It(Vt.prototype,(function(t,n,r){if(this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r},this._cmp=this._ascending=Tt,this._descending=function(e,t){return Tt(t,e)},this._max=function(e,t){return Tt(e,t)>0?e:t},this._min=function(e,t){return Tt(e,t)<0?e:t},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new X.MissingAPI}))}(this),this.on("versionchange",(function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(i.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(i.name,"'. Closing db now to resume the delete request.")),i.close({disableAutoOpen:!1})})),this.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('".concat(i.name,"') was blocked")):console.warn("Upgrade '".concat(i.name,"' blocked by other connection holding version ").concat(e.oldVersion/10))})),this._maxKey=rn(n.IDBKeyRange),this._createTransaction=function(e,t,n,r){return new i.Transaction(e,t,n,i._options.chromeTransactionDurability,r)},this._fireOnBlocked=function(e){i.on("blocked").fire(e),pt.filter((function(e){return e.name===i.name&&e!==i&&!e._state.vcFired})).map((function(t){return t.on("versionchange").fire(e)}))},this.use(tr),this.use(dr),this.use(ir),this.use(Qn),this.use(Zn);var l=new Proxy(this,{get:function(e,t,n){if("_vip"===t)return!0;if("table"===t)return function(e){return hr(i.table(e),l)};var r=Reflect.get(e,t,n);return r instanceof St?hr(r,l):"tables"===t?r.map((function(e){return hr(e,l)})):"_createTransaction"===t?function(){return hr(r.apply(this,arguments),l)}:r}});this.vip=l,s.forEach((function(e){return e(i)}))}return e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new X.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new X.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter((function(t){return t._cfg.version===e}))[0];return n||(n=new this.Version(e),t.push(n),t.sort(pn),n.stores({}),this._state.autoSchema=!1,n)},e.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||Oe.letThrough||this._vip)?e():new Pe((function(e,n){if(t._state.openComplete)return n(new X.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void n(new X.DatabaseClosed);t.open().catch(ee)}t._state.dbReadyPromise.then(e,n)})).then(e)},e.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,i=e.name;i&&this.unuse({stack:t,name:i});var o=this._middlewares[t]||(this._middlewares[t]=[]);return o.push({stack:t,create:n,level:null==r?10:r,name:i}),o.sort((function(e,t){return e.level-t.level})),this},e.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(e){return r?e.create!==r:!!n&&e.name!==n}))),this},e.prototype.open=function(){var e=this;return it(Se,(function(){return Wn(e)}))},e.prototype._close=function(){var e=this._state,t=pt.indexOf(this);if(t>=0&&pt.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(e){}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new Pe((function(t){e.dbReadyResolve=t})),e.openCanceller=new Pe((function(t,n){e.cancelOpen=n})))},e.prototype.close=function(e){var t=(void 0===e?{disableAutoOpen:!0}:e).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new X.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new X.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},e.prototype.delete=function(e){var t=this;void 0===e&&(e={disableAutoOpen:!0});var n=arguments.length>0&&"object"!=typeof arguments[0],r=this._state;return new Pe((function(i,o){var s=function(){t.close(e);var n=t._deps.indexedDB.deleteDatabase(t.name);n.onsuccess=He((function(){!function(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!On(n)&&t!==gt&&Sn(n,r).delete(t).catch(ee)}(t._deps,t.name),i()})),n.onerror=Kt(o),n.onblocked=t._fireOnBlocked};if(n)throw new X.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(s):s()}))},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return null!==this.idbdb},e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},e.prototype.hasFailed=function(){return null!==this._state.dbOpenError},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var e=this;return s(this._allTables).map((function(t){return e._allTables[t]}))},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var e=Vn.apply(this,arguments);return this._transaction.apply(this,e)},e.prototype._transaction=function(e,t,n){var r=this,i=Oe.trans;i&&i.db===this&&-1===e.indexOf("!")||(i=null);var o,s,a=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(s=t.map((function(e){var t=e instanceof r.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==e||e===mt)o=mt;else{if("rw"!=e&&e!=yt)throw new X.InvalidArgument("Invalid transaction mode: "+e);o=yt}if(i){if(i.mode===mt&&o===yt){if(!a)throw new X.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&s.forEach((function(e){if(i&&-1===i.storeNames.indexOf(e)){if(!a)throw new X.SubTransaction("Table "+e+" not included in parent transaction.");i=null}})),a&&i&&!i.active&&(i=null)}}catch(e){return i?i._promise(null,(function(t,n){n(e)})):at(e)}var c=Kn.bind(null,this,o,s,i,n);return i?i._promise(o,c,"lock"):Oe.trans?it(Oe.transless,(function(){return r._whenReady(c)})):this._whenReady(c)},e.prototype.table=function(e){if(!d(this._allTables,e))throw new X.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},e}(),gr="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable",mr=function(){function e(e){this._subscribe=e}return e.prototype.subscribe=function(e,t,n){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:n})},e.prototype[gr]=function(){return this},e}();try{fr={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch(e){fr={indexedDB:null,IDBKeyRange:null}}function yr(e){var t,n=!1,r=new mr((function(r){var i,o=G(e),s=!1,a={},c={},l={get closed(){return s},unsubscribe:function(){s||(s=!0,i&&i.abort(),u&&Jt.storagemutated.unsubscribe(f))}};r.start&&r.start(l);var u=!1,h=function(){return st(p)},f=function(e){Mn(a,e),Fn(c,a)&&h()},p=function(){if(!s&&fr.indexedDB){a={};var l={};i&&i.abort(),i=new AbortController;var p={subscr:l,signal:i.signal,requery:h,querier:e,trans:null},g=function(t){var n=Ue();try{o&&Xe();var r=Qe(e,t);return o&&(r=r.finally(Je)),r}finally{n&&Be()}}(p);Promise.resolve(g).then((function(e){n=!0,t=e,s||p.signal.aborted||(a={},function(e){for(var t in e)if(d(e,t))return!1;return!0}(c=l)||u||(Jt(Qt,f),u=!0),st((function(){return!s&&r.next&&r.next(e)})))}),(function(e){n=!1,["DatabaseClosedError","AbortError"].includes(null==e?void 0:e.name)||s||st((function(){s||r.error&&r.error(e)}))}))}};return setTimeout(h,0),l}));return r.hasValue=function(){return n},r.getValue=function(){return t},r}var vr=pr;function br(e){var t=wr;try{wr=!0,Jt.storagemutated.fire(e),Hn(e,!0)}finally{wr=t}}h(vr,r(r({},Z),{delete:function(e){return new vr(e,{addons:[]}).delete()},exists:function(e){return new vr(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){try{return function(e){var t=e.indexedDB,n=e.IDBKeyRange;return On(t)?Promise.resolve(t.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return e!==gt}))})):Sn(t,n).toCollection().primaryKeys()}(vr.dependencies).then(e)}catch(e){return at(new X.MissingAPI)}},defineClass:function(){return function(e){c(this,e)}},ignoreTransaction:function(e){return Oe.trans?it(Oe.transless,e):e()},vip:In,async:function(e){return function(){try{var t=zn(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Pe.resolve(t)}catch(e){return at(e)}}},spawn:function(e,t,n){try{var r=zn(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:Pe.resolve(r)}catch(e){return at(e)}},currentTransaction:{get:function(){return Oe.trans||null}},waitFor:function(e,t){var n=Pe.resolve("function"==typeof e?vr.ignoreTransaction(e):e).timeout(t||6e4);return Oe.trans?Oe.trans.waitFor(n):n},Promise:Pe,debug:{get:function(){return le},set:function(e){ue(e)}},derive:g,extend:c,props:h,override:_,Events:Ot,on:Jt,liveQuery:yr,extendObservabilitySet:Mn,getByKeyPath:E,setByKeyPath:A,delByKeyPath:function(e,t){"string"==typeof t?A(e,t,void 0):"length"in t&&[].map.call(t,(function(t){A(e,t,void 0)}))},shallowClone:S,deepClone:R,getObjectDiff:Xn,cmp:Tt,asap:T,minKey:dt,addons:[],connections:pt,errnames:Y,dependencies:fr,cache:Un,semVer:lt,version:lt.split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,n){return e+t/Math.pow(10,2*n)}))})),vr.maxKey=rn(vr.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(Jt(Qt,(function(e){var t;wr||(t=new CustomEvent(Xt,{detail:e}),wr=!0,dispatchEvent(t),wr=!1)})),addEventListener(Xt,(function(e){var t=e.detail;wr||br(t)})));var _r,wr=!1,Tr=function(){};return"undefined"!=typeof BroadcastChannel&&((Tr=function(){(_r=new BroadcastChannel(Xt)).onmessage=function(e){return e.data&&br(e.data)}})(),"function"==typeof _r.unref&&_r.unref(),Jt(Qt,(function(e){wr||_r.postMessage(e)}))),"undefined"!=typeof addEventListener&&(addEventListener("pagehide",(function(e){if(!pr.disableBfCache&&e.persisted){le&&console.debug("Dexie: handling persisted pagehide"),null==_r||_r.close();for(var t=0,n=pt;t<n.length;t++)n[t].close({disableAutoOpen:!1})}})),addEventListener("pageshow",(function(e){!pr.disableBfCache&&e.persisted&&(le&&console.debug("Dexie: handling persisted pageshow"),Tr(),br({all:new Pn(-1/0,[[]])}))}))),Pe.rejectionMapper=function(e,t){if(!e||e instanceof W||e instanceof TypeError||e instanceof SyntaxError||!e.name||!J[e.name])return e;var n=new J[e.name](t||e.message,e);return"stack"in e&&p(n,"stack",{get:function(){return this.inner.stack}}),n},ue(le),r(pr,Object.freeze({__proto__:null,Dexie:pr,liveQuery:yr,Entity:wt,cmp:Tt,PropModSymbol:Nt,PropModification:jt,replacePrefix:function(e,t){return new jt({replacePrefix:[e,t]})},add:function(e){return new jt({add:e})},remove:function(e){return new jt({remove:e})},default:pr,RangeSet:Pn,mergeRanges:Rn,rangesOverlap:Ln}),{default:pr}),pr},e.exports=r()}).call(this,n(61),n(1303).setImmediate)},function(e,t,n){var r=n(214),i=n(233),o=n(1285),s=n(198),a=n(118),c=n(1288),l=n(346),u=n(329),d=l((function(e,t){var n={};if(null==e)return n;var l=!1;t=r(t,(function(t){return t=s(t,e),l||(l=t.length>1),t})),a(e,u(e),n),l&&(n=i(n,7,c));for(var d=t.length;d--;)o(n,t[d]);return n}));e.exports=d},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(705),i=n(290);function o(e,t){const{document:n}=Object(r.a)(e),o=n.querySelectorAll("img");for(const e of Array.from(o)){if(!e.src||e.src.startsWith("data:"))continue;const n=e.getAttribute("remoteid");e.src=Object(i.a)({id:n,env:t})}return n.toString()}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(62);const i={annotation:"annotations",listEntry:"annotListEntries",bookmark:"annotBookmarks"},o={[i.annotation]:{version:r.a[33].version,fields:{pageTitle:{type:"text",optional:!0},pageUrl:{type:"string"},body:{type:"text",optional:!0},comment:{type:"text",optional:!0},selector:{type:"json",optional:!0},color:{type:"string",optional:!0},createdWhen:{type:"datetime"},lastEdited:{type:"datetime"},url:{type:"string"}},indices:[{field:"url",pk:!0},{field:"pageUrl"},{field:"pageTitle"},{field:"body"},{field:"createdWhen"},{field:"lastEdited"},{field:"comment"},{field:"color"}],history:[{version:new Date("2018-08-26"),fields:{pageTitle:{type:"text"},pageUrl:{type:"string"},body:{type:"text",optional:!0},comment:{type:"text",optional:!0},selector:{type:"json",optional:!0},createdWhen:{type:"datetime"},lastEdited:{type:"datetime"},url:{type:"string"}},indices:[{field:"url",pk:!0},{field:"pageTitle"},{field:"body"},{field:"createdWhen"},{field:"comment"}]},{version:new Date("2019-02-19"),fields:{pageTitle:{type:"text",optional:!0},pageUrl:{type:"string"},body:{type:"text",optional:!0},comment:{type:"text",optional:!0},selector:{type:"json",optional:!0},createdWhen:{type:"datetime"},lastEdited:{type:"datetime"},url:{type:"string"}},indices:[{field:"url",pk:!0},{field:"pageUrl"},{field:"pageTitle"},{field:"body"},{field:"createdWhen"},{field:"lastEdited"},{field:"comment"}]}]},[i.bookmark]:{version:new Date("2019-01-05"),fields:{url:{type:"string"},createdAt:{type:"datetime"}},indices:[{field:"url",pk:!0},{field:"createdAt"}]},[i.listEntry]:{version:r.a[39].version,fields:{listId:{type:"int"},url:{type:"string"},createdAt:{type:"datetime"}},indices:[{field:["listId","url"],pk:!0},{field:"listId"},{field:"url"},{field:"createdAt"}],history:[{version:new Date("2019-01-04"),fields:{listId:{type:"int"},url:{type:"string"},createdAt:{type:"datetime"}},indices:[{field:["listId","url"],pk:!0},{field:"listId"},{field:"url"}]}]}}},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){for(var t,n=c(e),r=n[0],s=n[1],a=new o(function(e,t,n){return 3*(t+n)/4-n}(0,r,s)),l=0,u=s>0?r-4:r,d=0;d<u;d+=4)t=i[e.charCodeAt(d)]<<18|i[e.charCodeAt(d+1)]<<12|i[e.charCodeAt(d+2)]<<6|i[e.charCodeAt(d+3)],a[l++]=t>>16&255,a[l++]=t>>8&255,a[l++]=255&t;2===s&&(t=i[e.charCodeAt(d)]<<2|i[e.charCodeAt(d+1)]>>4,a[l++]=255&t);1===s&&(t=i[e.charCodeAt(d)]<<10|i[e.charCodeAt(d+1)]<<4|i[e.charCodeAt(d+2)]>>2,a[l++]=t>>8&255,a[l++]=255&t);return a},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],s=16383,a=0,c=n-i;a<c;a+=s)o.push(l(e,a,a+s>c?c:a+s));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var i,o,s=[],a=t;a<n;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,l=c>>1,u=-7,d=n?i-1:0,h=n?-1:1,f=e[t+d];for(d+=h,o=f&(1<<-u)-1,f>>=-u,u+=a;u>0;o=256*o+e[t+d],d+=h,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=r;u>0;s=256*s+e[t+d],d+=h,u-=8);if(0===o)o=1-l;else{if(o===c)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,r),o-=l}return(f?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,c,l=8*o-i-1,u=(1<<l)-1,d=u>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,p=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=u):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+d>=1?h/c:h*Math.pow(2,1-d))*c>=2&&(s++,c/=2),s+d>=u?(a=0,s=u):s+d>=1?(a=(t*c-1)*Math.pow(2,i),s+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),s=0));i>=8;e[n+f]=255&a,f+=p,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;e[n+f]=255&s,f+=p,s/=256,l-=8);e[n+f-p]|=128*g}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){var r=n(332),i=n(897)(r);e.exports=i},function(e,t,n){var r=n(287),i=r.Buffer;function o(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(o(r,t),t.Buffer=s),o(i,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t){e.exports={cap:!1,curry:!1,fixed:!1,immutable:!1,rearg:!1}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.render=void 0;var a=s(n(600)),c=n(731),l=n(792),u=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function d(e){return e.replace(/"/g,"&quot;")}var h=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function f(e,t){void 0===t&&(t={});for(var n=("length"in e?e:[e]),r="",i=0;i<n.length;i++)r+=p(n[i],t);return r}function p(e,t){switch(e.type){case a.Root:return f(e.children,t);case a.Doctype:case a.Directive:return"<".concat(e.data,">");case a.Comment:return function(e){return"\x3c!--".concat(e.data,"--\x3e")}(e);case a.CDATA:return function(e){return"<![CDATA[".concat(e.children[0].data,"]]>")}(e);case a.Script:case a.Style:case a.Tag:return function(e,t){var n;"foreign"===t.xmlMode&&(e.name=null!==(n=l.elementNames.get(e.name))&&void 0!==n?n:e.name,e.parent&&g.has(e.parent.name)&&(t=r(r({},t),{xmlMode:!1})));!t.xmlMode&&m.has(e.name)&&(t=r(r({},t),{xmlMode:"foreign"}));var i="<".concat(e.name),o=function(e,t){var n;if(e){var r=!1===(null!==(n=t.encodeEntities)&&void 0!==n?n:t.decodeEntities)?d:t.xmlMode||"utf8"!==t.encodeEntities?c.encodeXML:c.escapeAttribute;return Object.keys(e).map((function(n){var i,o,s=null!==(i=e[n])&&void 0!==i?i:"";return"foreign"===t.xmlMode&&(n=null!==(o=l.attributeNames.get(n))&&void 0!==o?o:n),t.emptyAttrs||t.xmlMode||""!==s?"".concat(n,'="').concat(r(s),'"'):n})).join(" ")}}(e.attribs,t);o&&(i+=" ".concat(o));0===e.children.length&&(t.xmlMode?!1!==t.selfClosingTags:t.selfClosingTags&&h.has(e.name))?(t.xmlMode||(i+=" "),i+="/>"):(i+=">",e.children.length>0&&(i+=f(e.children,t)),!t.xmlMode&&h.has(e.name)||(i+="</".concat(e.name,">")));return i}(e,t);case a.Text:return function(e,t){var n,r=e.data||"";!1===(null!==(n=t.encodeEntities)&&void 0!==n?n:t.decodeEntities)||!t.xmlMode&&e.parent&&u.has(e.parent.name)||(r=t.xmlMode||"utf8"!==t.encodeEntities?(0,c.encodeXML)(r):(0,c.escapeText)(r));return r}(e,t)}}t.render=f,t.default=f;var g=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),m=new Set(["svg","math"])},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=new Uint16Array('\u1d41<\xd5\u0131\u028a\u049d\u057b\u05d0\u0675\u06de\u07a2\u07d6\u080f\u0a4a\u0a91\u0da1\u0e6d\u0f09\u0f26\u10ca\u1228\u12e1\u1415\u149d\u14c3\u14df\u1525\0\0\0\0\0\0\u156b\u16cd\u198d\u1c12\u1ddd\u1f7e\u2060\u21b0\u228d\u23c0\u23fb\u2442\u2824\u2912\u2d08\u2e48\u2fce\u3016\u32ba\u3639\u37ac\u38fe\u3a28\u3a71\u3ae0\u3b2e\u0800EMabcfglmnoprstu\\bfms\x7f\x84\x8b\x90\x95\x98\xa6\xb3\xb9\xc8\xcflig\u803b\xc6\u40c6P\u803b&\u4026cute\u803b\xc1\u40c1reve;\u4102\u0100iyx}rc\u803b\xc2\u40c2;\u4410r;\uc000\ud835\udd04rave\u803b\xc0\u40c0pha;\u4391acr;\u4100d;\u6a53\u0100gp\x9d\xa1on;\u4104f;\uc000\ud835\udd38plyFunction;\u6061ing\u803b\xc5\u40c5\u0100cs\xbe\xc3r;\uc000\ud835\udc9cign;\u6254ilde\u803b\xc3\u40c3ml\u803b\xc4\u40c4\u0400aceforsu\xe5\xfb\xfe\u0117\u011c\u0122\u0127\u012a\u0100cr\xea\xf2kslash;\u6216\u0176\xf6\xf8;\u6ae7ed;\u6306y;\u4411\u0180crt\u0105\u010b\u0114ause;\u6235noullis;\u612ca;\u4392r;\uc000\ud835\udd05pf;\uc000\ud835\udd39eve;\u42d8c\xf2\u0113mpeq;\u624e\u0700HOacdefhilorsu\u014d\u0151\u0156\u0180\u019e\u01a2\u01b5\u01b7\u01ba\u01dc\u0215\u0273\u0278\u027ecy;\u4427PY\u803b\xa9\u40a9\u0180cpy\u015d\u0162\u017aute;\u4106\u0100;i\u0167\u0168\u62d2talDifferentialD;\u6145leys;\u612d\u0200aeio\u0189\u018e\u0194\u0198ron;\u410cdil\u803b\xc7\u40c7rc;\u4108nint;\u6230ot;\u410a\u0100dn\u01a7\u01adilla;\u40b8terDot;\u40b7\xf2\u017fi;\u43a7rcle\u0200DMPT\u01c7\u01cb\u01d1\u01d6ot;\u6299inus;\u6296lus;\u6295imes;\u6297o\u0100cs\u01e2\u01f8kwiseContourIntegral;\u6232eCurly\u0100DQ\u0203\u020foubleQuote;\u601duote;\u6019\u0200lnpu\u021e\u0228\u0247\u0255on\u0100;e\u0225\u0226\u6237;\u6a74\u0180git\u022f\u0236\u023aruent;\u6261nt;\u622fourIntegral;\u622e\u0100fr\u024c\u024e;\u6102oduct;\u6210nterClockwiseContourIntegral;\u6233oss;\u6a2fcr;\uc000\ud835\udc9ep\u0100;C\u0284\u0285\u62d3ap;\u624d\u0580DJSZacefios\u02a0\u02ac\u02b0\u02b4\u02b8\u02cb\u02d7\u02e1\u02e6\u0333\u048d\u0100;o\u0179\u02a5trahd;\u6911cy;\u4402cy;\u4405cy;\u440f\u0180grs\u02bf\u02c4\u02c7ger;\u6021r;\u61a1hv;\u6ae4\u0100ay\u02d0\u02d5ron;\u410e;\u4414l\u0100;t\u02dd\u02de\u6207a;\u4394r;\uc000\ud835\udd07\u0100af\u02eb\u0327\u0100cm\u02f0\u0322ritical\u0200ADGT\u0300\u0306\u0316\u031ccute;\u40b4o\u0174\u030b\u030d;\u42d9bleAcute;\u42ddrave;\u4060ilde;\u42dcond;\u62c4ferentialD;\u6146\u0470\u033d\0\0\0\u0342\u0354\0\u0405f;\uc000\ud835\udd3b\u0180;DE\u0348\u0349\u034d\u40a8ot;\u60dcqual;\u6250ble\u0300CDLRUV\u0363\u0372\u0382\u03cf\u03e2\u03f8ontourIntegra\xec\u0239o\u0274\u0379\0\0\u037b\xbb\u0349nArrow;\u61d3\u0100eo\u0387\u03a4ft\u0180ART\u0390\u0396\u03a1rrow;\u61d0ightArrow;\u61d4e\xe5\u02cang\u0100LR\u03ab\u03c4eft\u0100AR\u03b3\u03b9rrow;\u67f8ightArrow;\u67faightArrow;\u67f9ight\u0100AT\u03d8\u03derrow;\u61d2ee;\u62a8p\u0241\u03e9\0\0\u03efrrow;\u61d1ownArrow;\u61d5erticalBar;\u6225n\u0300ABLRTa\u0412\u042a\u0430\u045e\u047f\u037crrow\u0180;BU\u041d\u041e\u0422\u6193ar;\u6913pArrow;\u61f5reve;\u4311eft\u02d2\u043a\0\u0446\0\u0450ightVector;\u6950eeVector;\u695eector\u0100;B\u0459\u045a\u61bdar;\u6956ight\u01d4\u0467\0\u0471eeVector;\u695fector\u0100;B\u047a\u047b\u61c1ar;\u6957ee\u0100;A\u0486\u0487\u62a4rrow;\u61a7\u0100ct\u0492\u0497r;\uc000\ud835\udc9frok;\u4110\u0800NTacdfglmopqstux\u04bd\u04c0\u04c4\u04cb\u04de\u04e2\u04e7\u04ee\u04f5\u0521\u052f\u0536\u0552\u055d\u0560\u0565G;\u414aH\u803b\xd0\u40d0cute\u803b\xc9\u40c9\u0180aiy\u04d2\u04d7\u04dcron;\u411arc\u803b\xca\u40ca;\u442dot;\u4116r;\uc000\ud835\udd08rave\u803b\xc8\u40c8ement;\u6208\u0100ap\u04fa\u04fecr;\u4112ty\u0253\u0506\0\0\u0512mallSquare;\u65fberySmallSquare;\u65ab\u0100gp\u0526\u052aon;\u4118f;\uc000\ud835\udd3csilon;\u4395u\u0100ai\u053c\u0549l\u0100;T\u0542\u0543\u6a75ilde;\u6242librium;\u61cc\u0100ci\u0557\u055ar;\u6130m;\u6a73a;\u4397ml\u803b\xcb\u40cb\u0100ip\u056a\u056fsts;\u6203onentialE;\u6147\u0280cfios\u0585\u0588\u058d\u05b2\u05ccy;\u4424r;\uc000\ud835\udd09lled\u0253\u0597\0\0\u05a3mallSquare;\u65fcerySmallSquare;\u65aa\u0370\u05ba\0\u05bf\0\0\u05c4f;\uc000\ud835\udd3dAll;\u6200riertrf;\u6131c\xf2\u05cb\u0600JTabcdfgorst\u05e8\u05ec\u05ef\u05fa\u0600\u0612\u0616\u061b\u061d\u0623\u066c\u0672cy;\u4403\u803b>\u403emma\u0100;d\u05f7\u05f8\u4393;\u43dcreve;\u411e\u0180eiy\u0607\u060c\u0610dil;\u4122rc;\u411c;\u4413ot;\u4120r;\uc000\ud835\udd0a;\u62d9pf;\uc000\ud835\udd3eeater\u0300EFGLST\u0635\u0644\u064e\u0656\u065b\u0666qual\u0100;L\u063e\u063f\u6265ess;\u62dbullEqual;\u6267reater;\u6aa2ess;\u6277lantEqual;\u6a7eilde;\u6273cr;\uc000\ud835\udca2;\u626b\u0400Aacfiosu\u0685\u068b\u0696\u069b\u069e\u06aa\u06be\u06caRDcy;\u442a\u0100ct\u0690\u0694ek;\u42c7;\u405eirc;\u4124r;\u610clbertSpace;\u610b\u01f0\u06af\0\u06b2f;\u610dizontalLine;\u6500\u0100ct\u06c3\u06c5\xf2\u06a9rok;\u4126mp\u0144\u06d0\u06d8ownHum\xf0\u012fqual;\u624f\u0700EJOacdfgmnostu\u06fa\u06fe\u0703\u0707\u070e\u071a\u071e\u0721\u0728\u0744\u0778\u078b\u078f\u0795cy;\u4415lig;\u4132cy;\u4401cute\u803b\xcd\u40cd\u0100iy\u0713\u0718rc\u803b\xce\u40ce;\u4418ot;\u4130r;\u6111rave\u803b\xcc\u40cc\u0180;ap\u0720\u072f\u073f\u0100cg\u0734\u0737r;\u412ainaryI;\u6148lie\xf3\u03dd\u01f4\u0749\0\u0762\u0100;e\u074d\u074e\u622c\u0100gr\u0753\u0758ral;\u622bsection;\u62c2isible\u0100CT\u076c\u0772omma;\u6063imes;\u6062\u0180gpt\u077f\u0783\u0788on;\u412ef;\uc000\ud835\udd40a;\u4399cr;\u6110ilde;\u4128\u01eb\u079a\0\u079ecy;\u4406l\u803b\xcf\u40cf\u0280cfosu\u07ac\u07b7\u07bc\u07c2\u07d0\u0100iy\u07b1\u07b5rc;\u4134;\u4419r;\uc000\ud835\udd0dpf;\uc000\ud835\udd41\u01e3\u07c7\0\u07ccr;\uc000\ud835\udca5rcy;\u4408kcy;\u4404\u0380HJacfos\u07e4\u07e8\u07ec\u07f1\u07fd\u0802\u0808cy;\u4425cy;\u440cppa;\u439a\u0100ey\u07f6\u07fbdil;\u4136;\u441ar;\uc000\ud835\udd0epf;\uc000\ud835\udd42cr;\uc000\ud835\udca6\u0580JTaceflmost\u0825\u0829\u082c\u0850\u0863\u09b3\u09b8\u09c7\u09cd\u0a37\u0a47cy;\u4409\u803b<\u403c\u0280cmnpr\u0837\u083c\u0841\u0844\u084dute;\u4139bda;\u439bg;\u67ealacetrf;\u6112r;\u619e\u0180aey\u0857\u085c\u0861ron;\u413ddil;\u413b;\u441b\u0100fs\u0868\u0970t\u0500ACDFRTUVar\u087e\u08a9\u08b1\u08e0\u08e6\u08fc\u092f\u095b\u0390\u096a\u0100nr\u0883\u088fgleBracket;\u67e8row\u0180;BR\u0899\u089a\u089e\u6190ar;\u61e4ightArrow;\u61c6eiling;\u6308o\u01f5\u08b7\0\u08c3bleBracket;\u67e6n\u01d4\u08c8\0\u08d2eeVector;\u6961ector\u0100;B\u08db\u08dc\u61c3ar;\u6959loor;\u630aight\u0100AV\u08ef\u08f5rrow;\u6194ector;\u694e\u0100er\u0901\u0917e\u0180;AV\u0909\u090a\u0910\u62a3rrow;\u61a4ector;\u695aiangle\u0180;BE\u0924\u0925\u0929\u62b2ar;\u69cfqual;\u62b4p\u0180DTV\u0937\u0942\u094cownVector;\u6951eeVector;\u6960ector\u0100;B\u0956\u0957\u61bfar;\u6958ector\u0100;B\u0965\u0966\u61bcar;\u6952ight\xe1\u039cs\u0300EFGLST\u097e\u098b\u0995\u099d\u09a2\u09adqualGreater;\u62daullEqual;\u6266reater;\u6276ess;\u6aa1lantEqual;\u6a7dilde;\u6272r;\uc000\ud835\udd0f\u0100;e\u09bd\u09be\u62d8ftarrow;\u61daidot;\u413f\u0180npw\u09d4\u0a16\u0a1bg\u0200LRlr\u09de\u09f7\u0a02\u0a10eft\u0100AR\u09e6\u09ecrrow;\u67f5ightArrow;\u67f7ightArrow;\u67f6eft\u0100ar\u03b3\u0a0aight\xe1\u03bfight\xe1\u03caf;\uc000\ud835\udd43er\u0100LR\u0a22\u0a2ceftArrow;\u6199ightArrow;\u6198\u0180cht\u0a3e\u0a40\u0a42\xf2\u084c;\u61b0rok;\u4141;\u626a\u0400acefiosu\u0a5a\u0a5d\u0a60\u0a77\u0a7c\u0a85\u0a8b\u0a8ep;\u6905y;\u441c\u0100dl\u0a65\u0a6fiumSpace;\u605flintrf;\u6133r;\uc000\ud835\udd10nusPlus;\u6213pf;\uc000\ud835\udd44c\xf2\u0a76;\u439c\u0480Jacefostu\u0aa3\u0aa7\u0aad\u0ac0\u0b14\u0b19\u0d91\u0d97\u0d9ecy;\u440acute;\u4143\u0180aey\u0ab4\u0ab9\u0aberon;\u4147dil;\u4145;\u441d\u0180gsw\u0ac7\u0af0\u0b0eative\u0180MTV\u0ad3\u0adf\u0ae8ediumSpace;\u600bhi\u0100cn\u0ae6\u0ad8\xeb\u0ad9eryThi\xee\u0ad9ted\u0100GL\u0af8\u0b06reaterGreate\xf2\u0673essLes\xf3\u0a48Line;\u400ar;\uc000\ud835\udd11\u0200Bnpt\u0b22\u0b28\u0b37\u0b3areak;\u6060BreakingSpace;\u40a0f;\u6115\u0680;CDEGHLNPRSTV\u0b55\u0b56\u0b6a\u0b7c\u0ba1\u0beb\u0c04\u0c5e\u0c84\u0ca6\u0cd8\u0d61\u0d85\u6aec\u0100ou\u0b5b\u0b64ngruent;\u6262pCap;\u626doubleVerticalBar;\u6226\u0180lqx\u0b83\u0b8a\u0b9bement;\u6209ual\u0100;T\u0b92\u0b93\u6260ilde;\uc000\u2242\u0338ists;\u6204reater\u0380;EFGLST\u0bb6\u0bb7\u0bbd\u0bc9\u0bd3\u0bd8\u0be5\u626fqual;\u6271ullEqual;\uc000\u2267\u0338reater;\uc000\u226b\u0338ess;\u6279lantEqual;\uc000\u2a7e\u0338ilde;\u6275ump\u0144\u0bf2\u0bfdownHump;\uc000\u224e\u0338qual;\uc000\u224f\u0338e\u0100fs\u0c0a\u0c27tTriangle\u0180;BE\u0c1a\u0c1b\u0c21\u62eaar;\uc000\u29cf\u0338qual;\u62ecs\u0300;EGLST\u0c35\u0c36\u0c3c\u0c44\u0c4b\u0c58\u626equal;\u6270reater;\u6278ess;\uc000\u226a\u0338lantEqual;\uc000\u2a7d\u0338ilde;\u6274ested\u0100GL\u0c68\u0c79reaterGreater;\uc000\u2aa2\u0338essLess;\uc000\u2aa1\u0338recedes\u0180;ES\u0c92\u0c93\u0c9b\u6280qual;\uc000\u2aaf\u0338lantEqual;\u62e0\u0100ei\u0cab\u0cb9verseElement;\u620cghtTriangle\u0180;BE\u0ccb\u0ccc\u0cd2\u62ebar;\uc000\u29d0\u0338qual;\u62ed\u0100qu\u0cdd\u0d0cuareSu\u0100bp\u0ce8\u0cf9set\u0100;E\u0cf0\u0cf3\uc000\u228f\u0338qual;\u62e2erset\u0100;E\u0d03\u0d06\uc000\u2290\u0338qual;\u62e3\u0180bcp\u0d13\u0d24\u0d4eset\u0100;E\u0d1b\u0d1e\uc000\u2282\u20d2qual;\u6288ceeds\u0200;EST\u0d32\u0d33\u0d3b\u0d46\u6281qual;\uc000\u2ab0\u0338lantEqual;\u62e1ilde;\uc000\u227f\u0338erset\u0100;E\u0d58\u0d5b\uc000\u2283\u20d2qual;\u6289ilde\u0200;EFT\u0d6e\u0d6f\u0d75\u0d7f\u6241qual;\u6244ullEqual;\u6247ilde;\u6249erticalBar;\u6224cr;\uc000\ud835\udca9ilde\u803b\xd1\u40d1;\u439d\u0700Eacdfgmoprstuv\u0dbd\u0dc2\u0dc9\u0dd5\u0ddb\u0de0\u0de7\u0dfc\u0e02\u0e20\u0e22\u0e32\u0e3f\u0e44lig;\u4152cute\u803b\xd3\u40d3\u0100iy\u0dce\u0dd3rc\u803b\xd4\u40d4;\u441eblac;\u4150r;\uc000\ud835\udd12rave\u803b\xd2\u40d2\u0180aei\u0dee\u0df2\u0df6cr;\u414cga;\u43a9cron;\u439fpf;\uc000\ud835\udd46enCurly\u0100DQ\u0e0e\u0e1aoubleQuote;\u601cuote;\u6018;\u6a54\u0100cl\u0e27\u0e2cr;\uc000\ud835\udcaaash\u803b\xd8\u40d8i\u016c\u0e37\u0e3cde\u803b\xd5\u40d5es;\u6a37ml\u803b\xd6\u40d6er\u0100BP\u0e4b\u0e60\u0100ar\u0e50\u0e53r;\u603eac\u0100ek\u0e5a\u0e5c;\u63deet;\u63b4arenthesis;\u63dc\u0480acfhilors\u0e7f\u0e87\u0e8a\u0e8f\u0e92\u0e94\u0e9d\u0eb0\u0efcrtialD;\u6202y;\u441fr;\uc000\ud835\udd13i;\u43a6;\u43a0usMinus;\u40b1\u0100ip\u0ea2\u0eadncareplan\xe5\u069df;\u6119\u0200;eio\u0eb9\u0eba\u0ee0\u0ee4\u6abbcedes\u0200;EST\u0ec8\u0ec9\u0ecf\u0eda\u627aqual;\u6aaflantEqual;\u627cilde;\u627eme;\u6033\u0100dp\u0ee9\u0eeeuct;\u620fortion\u0100;a\u0225\u0ef9l;\u621d\u0100ci\u0f01\u0f06r;\uc000\ud835\udcab;\u43a8\u0200Ufos\u0f11\u0f16\u0f1b\u0f1fOT\u803b"\u4022r;\uc000\ud835\udd14pf;\u611acr;\uc000\ud835\udcac\u0600BEacefhiorsu\u0f3e\u0f43\u0f47\u0f60\u0f73\u0fa7\u0faa\u0fad\u1096\u10a9\u10b4\u10bearr;\u6910G\u803b\xae\u40ae\u0180cnr\u0f4e\u0f53\u0f56ute;\u4154g;\u67ebr\u0100;t\u0f5c\u0f5d\u61a0l;\u6916\u0180aey\u0f67\u0f6c\u0f71ron;\u4158dil;\u4156;\u4420\u0100;v\u0f78\u0f79\u611cerse\u0100EU\u0f82\u0f99\u0100lq\u0f87\u0f8eement;\u620builibrium;\u61cbpEquilibrium;\u696fr\xbb\u0f79o;\u43a1ght\u0400ACDFTUVa\u0fc1\u0feb\u0ff3\u1022\u1028\u105b\u1087\u03d8\u0100nr\u0fc6\u0fd2gleBracket;\u67e9row\u0180;BL\u0fdc\u0fdd\u0fe1\u6192ar;\u61e5eftArrow;\u61c4eiling;\u6309o\u01f5\u0ff9\0\u1005bleBracket;\u67e7n\u01d4\u100a\0\u1014eeVector;\u695dector\u0100;B\u101d\u101e\u61c2ar;\u6955loor;\u630b\u0100er\u102d\u1043e\u0180;AV\u1035\u1036\u103c\u62a2rrow;\u61a6ector;\u695biangle\u0180;BE\u1050\u1051\u1055\u62b3ar;\u69d0qual;\u62b5p\u0180DTV\u1063\u106e\u1078ownVector;\u694feeVector;\u695cector\u0100;B\u1082\u1083\u61bear;\u6954ector\u0100;B\u1091\u1092\u61c0ar;\u6953\u0100pu\u109b\u109ef;\u611dndImplies;\u6970ightarrow;\u61db\u0100ch\u10b9\u10bcr;\u611b;\u61b1leDelayed;\u69f4\u0680HOacfhimoqstu\u10e4\u10f1\u10f7\u10fd\u1119\u111e\u1151\u1156\u1161\u1167\u11b5\u11bb\u11bf\u0100Cc\u10e9\u10eeHcy;\u4429y;\u4428FTcy;\u442ccute;\u415a\u0280;aeiy\u1108\u1109\u110e\u1113\u1117\u6abcron;\u4160dil;\u415erc;\u415c;\u4421r;\uc000\ud835\udd16ort\u0200DLRU\u112a\u1134\u113e\u1149ownArrow\xbb\u041eeftArrow\xbb\u089aightArrow\xbb\u0fddpArrow;\u6191gma;\u43a3allCircle;\u6218pf;\uc000\ud835\udd4a\u0272\u116d\0\0\u1170t;\u621aare\u0200;ISU\u117b\u117c\u1189\u11af\u65a1ntersection;\u6293u\u0100bp\u118f\u119eset\u0100;E\u1197\u1198\u628fqual;\u6291erset\u0100;E\u11a8\u11a9\u6290qual;\u6292nion;\u6294cr;\uc000\ud835\udcaear;\u62c6\u0200bcmp\u11c8\u11db\u1209\u120b\u0100;s\u11cd\u11ce\u62d0et\u0100;E\u11cd\u11d5qual;\u6286\u0100ch\u11e0\u1205eeds\u0200;EST\u11ed\u11ee\u11f4\u11ff\u627bqual;\u6ab0lantEqual;\u627dilde;\u627fTh\xe1\u0f8c;\u6211\u0180;es\u1212\u1213\u1223\u62d1rset\u0100;E\u121c\u121d\u6283qual;\u6287et\xbb\u1213\u0580HRSacfhiors\u123e\u1244\u1249\u1255\u125e\u1271\u1276\u129f\u12c2\u12c8\u12d1ORN\u803b\xde\u40deADE;\u6122\u0100Hc\u124e\u1252cy;\u440by;\u4426\u0100bu\u125a\u125c;\u4009;\u43a4\u0180aey\u1265\u126a\u126fron;\u4164dil;\u4162;\u4422r;\uc000\ud835\udd17\u0100ei\u127b\u1289\u01f2\u1280\0\u1287efore;\u6234a;\u4398\u0100cn\u128e\u1298kSpace;\uc000\u205f\u200aSpace;\u6009lde\u0200;EFT\u12ab\u12ac\u12b2\u12bc\u623cqual;\u6243ullEqual;\u6245ilde;\u6248pf;\uc000\ud835\udd4bipleDot;\u60db\u0100ct\u12d6\u12dbr;\uc000\ud835\udcafrok;\u4166\u0ae1\u12f7\u130e\u131a\u1326\0\u132c\u1331\0\0\0\0\0\u1338\u133d\u1377\u1385\0\u13ff\u1404\u140a\u1410\u0100cr\u12fb\u1301ute\u803b\xda\u40dar\u0100;o\u1307\u1308\u619fcir;\u6949r\u01e3\u1313\0\u1316y;\u440eve;\u416c\u0100iy\u131e\u1323rc\u803b\xdb\u40db;\u4423blac;\u4170r;\uc000\ud835\udd18rave\u803b\xd9\u40d9acr;\u416a\u0100di\u1341\u1369er\u0100BP\u1348\u135d\u0100ar\u134d\u1350r;\u405fac\u0100ek\u1357\u1359;\u63dfet;\u63b5arenthesis;\u63ddon\u0100;P\u1370\u1371\u62c3lus;\u628e\u0100gp\u137b\u137fon;\u4172f;\uc000\ud835\udd4c\u0400ADETadps\u1395\u13ae\u13b8\u13c4\u03e8\u13d2\u13d7\u13f3rrow\u0180;BD\u1150\u13a0\u13a4ar;\u6912ownArrow;\u61c5ownArrow;\u6195quilibrium;\u696eee\u0100;A\u13cb\u13cc\u62a5rrow;\u61a5own\xe1\u03f3er\u0100LR\u13de\u13e8eftArrow;\u6196ightArrow;\u6197i\u0100;l\u13f9\u13fa\u43d2on;\u43a5ing;\u416ecr;\uc000\ud835\udcb0ilde;\u4168ml\u803b\xdc\u40dc\u0480Dbcdefosv\u1427\u142c\u1430\u1433\u143e\u1485\u148a\u1490\u1496ash;\u62abar;\u6aeby;\u4412ash\u0100;l\u143b\u143c\u62a9;\u6ae6\u0100er\u1443\u1445;\u62c1\u0180bty\u144c\u1450\u147aar;\u6016\u0100;i\u144f\u1455cal\u0200BLST\u1461\u1465\u146a\u1474ar;\u6223ine;\u407ceparator;\u6758ilde;\u6240ThinSpace;\u600ar;\uc000\ud835\udd19pf;\uc000\ud835\udd4dcr;\uc000\ud835\udcb1dash;\u62aa\u0280cefos\u14a7\u14ac\u14b1\u14b6\u14bcirc;\u4174dge;\u62c0r;\uc000\ud835\udd1apf;\uc000\ud835\udd4ecr;\uc000\ud835\udcb2\u0200fios\u14cb\u14d0\u14d2\u14d8r;\uc000\ud835\udd1b;\u439epf;\uc000\ud835\udd4fcr;\uc000\ud835\udcb3\u0480AIUacfosu\u14f1\u14f5\u14f9\u14fd\u1504\u150f\u1514\u151a\u1520cy;\u442fcy;\u4407cy;\u442ecute\u803b\xdd\u40dd\u0100iy\u1509\u150drc;\u4176;\u442br;\uc000\ud835\udd1cpf;\uc000\ud835\udd50cr;\uc000\ud835\udcb4ml;\u4178\u0400Hacdefos\u1535\u1539\u153f\u154b\u154f\u155d\u1560\u1564cy;\u4416cute;\u4179\u0100ay\u1544\u1549ron;\u417d;\u4417ot;\u417b\u01f2\u1554\0\u155boWidt\xe8\u0ad9a;\u4396r;\u6128pf;\u6124cr;\uc000\ud835\udcb5\u0be1\u1583\u158a\u1590\0\u15b0\u15b6\u15bf\0\0\0\0\u15c6\u15db\u15eb\u165f\u166d\0\u1695\u169b\u16b2\u16b9\0\u16becute\u803b\xe1\u40e1reve;\u4103\u0300;Ediuy\u159c\u159d\u15a1\u15a3\u15a8\u15ad\u623e;\uc000\u223e\u0333;\u623frc\u803b\xe2\u40e2te\u80bb\xb4\u0306;\u4430lig\u803b\xe6\u40e6\u0100;r\xb2\u15ba;\uc000\ud835\udd1erave\u803b\xe0\u40e0\u0100ep\u15ca\u15d6\u0100fp\u15cf\u15d4sym;\u6135\xe8\u15d3ha;\u43b1\u0100ap\u15dfc\u0100cl\u15e4\u15e7r;\u4101g;\u6a3f\u0264\u15f0\0\0\u160a\u0280;adsv\u15fa\u15fb\u15ff\u1601\u1607\u6227nd;\u6a55;\u6a5clope;\u6a58;\u6a5a\u0380;elmrsz\u1618\u1619\u161b\u161e\u163f\u164f\u1659\u6220;\u69a4e\xbb\u1619sd\u0100;a\u1625\u1626\u6221\u0461\u1630\u1632\u1634\u1636\u1638\u163a\u163c\u163e;\u69a8;\u69a9;\u69aa;\u69ab;\u69ac;\u69ad;\u69ae;\u69aft\u0100;v\u1645\u1646\u621fb\u0100;d\u164c\u164d\u62be;\u699d\u0100pt\u1654\u1657h;\u6222\xbb\xb9arr;\u637c\u0100gp\u1663\u1667on;\u4105f;\uc000\ud835\udd52\u0380;Eaeiop\u12c1\u167b\u167d\u1682\u1684\u1687\u168a;\u6a70cir;\u6a6f;\u624ad;\u624bs;\u4027rox\u0100;e\u12c1\u1692\xf1\u1683ing\u803b\xe5\u40e5\u0180cty\u16a1\u16a6\u16a8r;\uc000\ud835\udcb6;\u402amp\u0100;e\u12c1\u16af\xf1\u0288ilde\u803b\xe3\u40e3ml\u803b\xe4\u40e4\u0100ci\u16c2\u16c8onin\xf4\u0272nt;\u6a11\u0800Nabcdefiklnoprsu\u16ed\u16f1\u1730\u173c\u1743\u1748\u1778\u177d\u17e0\u17e6\u1839\u1850\u170d\u193d\u1948\u1970ot;\u6aed\u0100cr\u16f6\u171ek\u0200ceps\u1700\u1705\u170d\u1713ong;\u624cpsilon;\u43f6rime;\u6035im\u0100;e\u171a\u171b\u623dq;\u62cd\u0176\u1722\u1726ee;\u62bded\u0100;g\u172c\u172d\u6305e\xbb\u172drk\u0100;t\u135c\u1737brk;\u63b6\u0100oy\u1701\u1741;\u4431quo;\u601e\u0280cmprt\u1753\u175b\u1761\u1764\u1768aus\u0100;e\u010a\u0109ptyv;\u69b0s\xe9\u170cno\xf5\u0113\u0180ahw\u176f\u1771\u1773;\u43b2;\u6136een;\u626cr;\uc000\ud835\udd1fg\u0380costuvw\u178d\u179d\u17b3\u17c1\u17d5\u17db\u17de\u0180aiu\u1794\u1796\u179a\xf0\u0760rc;\u65efp\xbb\u1371\u0180dpt\u17a4\u17a8\u17adot;\u6a00lus;\u6a01imes;\u6a02\u0271\u17b9\0\0\u17becup;\u6a06ar;\u6605riangle\u0100du\u17cd\u17d2own;\u65bdp;\u65b3plus;\u6a04e\xe5\u1444\xe5\u14adarow;\u690d\u0180ako\u17ed\u1826\u1835\u0100cn\u17f2\u1823k\u0180lst\u17fa\u05ab\u1802ozenge;\u69ebriangle\u0200;dlr\u1812\u1813\u1818\u181d\u65b4own;\u65beeft;\u65c2ight;\u65b8k;\u6423\u01b1\u182b\0\u1833\u01b2\u182f\0\u1831;\u6592;\u65914;\u6593ck;\u6588\u0100eo\u183e\u184d\u0100;q\u1843\u1846\uc000=\u20e5uiv;\uc000\u2261\u20e5t;\u6310\u0200ptwx\u1859\u185e\u1867\u186cf;\uc000\ud835\udd53\u0100;t\u13cb\u1863om\xbb\u13cctie;\u62c8\u0600DHUVbdhmptuv\u1885\u1896\u18aa\u18bb\u18d7\u18db\u18ec\u18ff\u1905\u190a\u1910\u1921\u0200LRlr\u188e\u1890\u1892\u1894;\u6557;\u6554;\u6556;\u6553\u0280;DUdu\u18a1\u18a2\u18a4\u18a6\u18a8\u6550;\u6566;\u6569;\u6564;\u6567\u0200LRlr\u18b3\u18b5\u18b7\u18b9;\u655d;\u655a;\u655c;\u6559\u0380;HLRhlr\u18ca\u18cb\u18cd\u18cf\u18d1\u18d3\u18d5\u6551;\u656c;\u6563;\u6560;\u656b;\u6562;\u655fox;\u69c9\u0200LRlr\u18e4\u18e6\u18e8\u18ea;\u6555;\u6552;\u6510;\u650c\u0280;DUdu\u06bd\u18f7\u18f9\u18fb\u18fd;\u6565;\u6568;\u652c;\u6534inus;\u629flus;\u629eimes;\u62a0\u0200LRlr\u1919\u191b\u191d\u191f;\u655b;\u6558;\u6518;\u6514\u0380;HLRhlr\u1930\u1931\u1933\u1935\u1937\u1939\u193b\u6502;\u656a;\u6561;\u655e;\u653c;\u6524;\u651c\u0100ev\u0123\u1942bar\u803b\xa6\u40a6\u0200ceio\u1951\u1956\u195a\u1960r;\uc000\ud835\udcb7mi;\u604fm\u0100;e\u171a\u171cl\u0180;bh\u1968\u1969\u196b\u405c;\u69c5sub;\u67c8\u016c\u1974\u197el\u0100;e\u1979\u197a\u6022t\xbb\u197ap\u0180;Ee\u012f\u1985\u1987;\u6aae\u0100;q\u06dc\u06db\u0ce1\u19a7\0\u19e8\u1a11\u1a15\u1a32\0\u1a37\u1a50\0\0\u1ab4\0\0\u1ac1\0\0\u1b21\u1b2e\u1b4d\u1b52\0\u1bfd\0\u1c0c\u0180cpr\u19ad\u19b2\u19ddute;\u4107\u0300;abcds\u19bf\u19c0\u19c4\u19ca\u19d5\u19d9\u6229nd;\u6a44rcup;\u6a49\u0100au\u19cf\u19d2p;\u6a4bp;\u6a47ot;\u6a40;\uc000\u2229\ufe00\u0100eo\u19e2\u19e5t;\u6041\xee\u0693\u0200aeiu\u19f0\u19fb\u1a01\u1a05\u01f0\u19f5\0\u19f8s;\u6a4don;\u410ddil\u803b\xe7\u40e7rc;\u4109ps\u0100;s\u1a0c\u1a0d\u6a4cm;\u6a50ot;\u410b\u0180dmn\u1a1b\u1a20\u1a26il\u80bb\xb8\u01adptyv;\u69b2t\u8100\xa2;e\u1a2d\u1a2e\u40a2r\xe4\u01b2r;\uc000\ud835\udd20\u0180cei\u1a3d\u1a40\u1a4dy;\u4447ck\u0100;m\u1a47\u1a48\u6713ark\xbb\u1a48;\u43c7r\u0380;Ecefms\u1a5f\u1a60\u1a62\u1a6b\u1aa4\u1aaa\u1aae\u65cb;\u69c3\u0180;el\u1a69\u1a6a\u1a6d\u42c6q;\u6257e\u0261\u1a74\0\0\u1a88rrow\u0100lr\u1a7c\u1a81eft;\u61baight;\u61bb\u0280RSacd\u1a92\u1a94\u1a96\u1a9a\u1a9f\xbb\u0f47;\u64c8st;\u629birc;\u629aash;\u629dnint;\u6a10id;\u6aefcir;\u69c2ubs\u0100;u\u1abb\u1abc\u6663it\xbb\u1abc\u02ec\u1ac7\u1ad4\u1afa\0\u1b0aon\u0100;e\u1acd\u1ace\u403a\u0100;q\xc7\xc6\u026d\u1ad9\0\0\u1ae2a\u0100;t\u1ade\u1adf\u402c;\u4040\u0180;fl\u1ae8\u1ae9\u1aeb\u6201\xee\u1160e\u0100mx\u1af1\u1af6ent\xbb\u1ae9e\xf3\u024d\u01e7\u1afe\0\u1b07\u0100;d\u12bb\u1b02ot;\u6a6dn\xf4\u0246\u0180fry\u1b10\u1b14\u1b17;\uc000\ud835\udd54o\xe4\u0254\u8100\xa9;s\u0155\u1b1dr;\u6117\u0100ao\u1b25\u1b29rr;\u61b5ss;\u6717\u0100cu\u1b32\u1b37r;\uc000\ud835\udcb8\u0100bp\u1b3c\u1b44\u0100;e\u1b41\u1b42\u6acf;\u6ad1\u0100;e\u1b49\u1b4a\u6ad0;\u6ad2dot;\u62ef\u0380delprvw\u1b60\u1b6c\u1b77\u1b82\u1bac\u1bd4\u1bf9arr\u0100lr\u1b68\u1b6a;\u6938;\u6935\u0270\u1b72\0\0\u1b75r;\u62dec;\u62dfarr\u0100;p\u1b7f\u1b80\u61b6;\u693d\u0300;bcdos\u1b8f\u1b90\u1b96\u1ba1\u1ba5\u1ba8\u622arcap;\u6a48\u0100au\u1b9b\u1b9ep;\u6a46p;\u6a4aot;\u628dr;\u6a45;\uc000\u222a\ufe00\u0200alrv\u1bb5\u1bbf\u1bde\u1be3rr\u0100;m\u1bbc\u1bbd\u61b7;\u693cy\u0180evw\u1bc7\u1bd4\u1bd8q\u0270\u1bce\0\0\u1bd2re\xe3\u1b73u\xe3\u1b75ee;\u62ceedge;\u62cfen\u803b\xa4\u40a4earrow\u0100lr\u1bee\u1bf3eft\xbb\u1b80ight\xbb\u1bbde\xe4\u1bdd\u0100ci\u1c01\u1c07onin\xf4\u01f7nt;\u6231lcty;\u632d\u0980AHabcdefhijlorstuwz\u1c38\u1c3b\u1c3f\u1c5d\u1c69\u1c75\u1c8a\u1c9e\u1cac\u1cb7\u1cfb\u1cff\u1d0d\u1d7b\u1d91\u1dab\u1dbb\u1dc6\u1dcdr\xf2\u0381ar;\u6965\u0200glrs\u1c48\u1c4d\u1c52\u1c54ger;\u6020eth;\u6138\xf2\u1133h\u0100;v\u1c5a\u1c5b\u6010\xbb\u090a\u016b\u1c61\u1c67arow;\u690fa\xe3\u0315\u0100ay\u1c6e\u1c73ron;\u410f;\u4434\u0180;ao\u0332\u1c7c\u1c84\u0100gr\u02bf\u1c81r;\u61catseq;\u6a77\u0180glm\u1c91\u1c94\u1c98\u803b\xb0\u40b0ta;\u43b4ptyv;\u69b1\u0100ir\u1ca3\u1ca8sht;\u697f;\uc000\ud835\udd21ar\u0100lr\u1cb3\u1cb5\xbb\u08dc\xbb\u101e\u0280aegsv\u1cc2\u0378\u1cd6\u1cdc\u1ce0m\u0180;os\u0326\u1cca\u1cd4nd\u0100;s\u0326\u1cd1uit;\u6666amma;\u43ddin;\u62f2\u0180;io\u1ce7\u1ce8\u1cf8\u40f7de\u8100\xf7;o\u1ce7\u1cf0ntimes;\u62c7n\xf8\u1cf7cy;\u4452c\u026f\u1d06\0\0\u1d0arn;\u631eop;\u630d\u0280lptuw\u1d18\u1d1d\u1d22\u1d49\u1d55lar;\u4024f;\uc000\ud835\udd55\u0280;emps\u030b\u1d2d\u1d37\u1d3d\u1d42q\u0100;d\u0352\u1d33ot;\u6251inus;\u6238lus;\u6214quare;\u62a1blebarwedg\xe5\xfan\u0180adh\u112e\u1d5d\u1d67ownarrow\xf3\u1c83arpoon\u0100lr\u1d72\u1d76ef\xf4\u1cb4igh\xf4\u1cb6\u0162\u1d7f\u1d85karo\xf7\u0f42\u026f\u1d8a\0\0\u1d8ern;\u631fop;\u630c\u0180cot\u1d98\u1da3\u1da6\u0100ry\u1d9d\u1da1;\uc000\ud835\udcb9;\u4455l;\u69f6rok;\u4111\u0100dr\u1db0\u1db4ot;\u62f1i\u0100;f\u1dba\u1816\u65bf\u0100ah\u1dc0\u1dc3r\xf2\u0429a\xf2\u0fa6angle;\u69a6\u0100ci\u1dd2\u1dd5y;\u445fgrarr;\u67ff\u0900Dacdefglmnopqrstux\u1e01\u1e09\u1e19\u1e38\u0578\u1e3c\u1e49\u1e61\u1e7e\u1ea5\u1eaf\u1ebd\u1ee1\u1f2a\u1f37\u1f44\u1f4e\u1f5a\u0100Do\u1e06\u1d34o\xf4\u1c89\u0100cs\u1e0e\u1e14ute\u803b\xe9\u40e9ter;\u6a6e\u0200aioy\u1e22\u1e27\u1e31\u1e36ron;\u411br\u0100;c\u1e2d\u1e2e\u6256\u803b\xea\u40ealon;\u6255;\u444dot;\u4117\u0100Dr\u1e41\u1e45ot;\u6252;\uc000\ud835\udd22\u0180;rs\u1e50\u1e51\u1e57\u6a9aave\u803b\xe8\u40e8\u0100;d\u1e5c\u1e5d\u6a96ot;\u6a98\u0200;ils\u1e6a\u1e6b\u1e72\u1e74\u6a99nters;\u63e7;\u6113\u0100;d\u1e79\u1e7a\u6a95ot;\u6a97\u0180aps\u1e85\u1e89\u1e97cr;\u4113ty\u0180;sv\u1e92\u1e93\u1e95\u6205et\xbb\u1e93p\u01001;\u1e9d\u1ea4\u0133\u1ea1\u1ea3;\u6004;\u6005\u6003\u0100gs\u1eaa\u1eac;\u414bp;\u6002\u0100gp\u1eb4\u1eb8on;\u4119f;\uc000\ud835\udd56\u0180als\u1ec4\u1ece\u1ed2r\u0100;s\u1eca\u1ecb\u62d5l;\u69e3us;\u6a71i\u0180;lv\u1eda\u1edb\u1edf\u43b5on\xbb\u1edb;\u43f5\u0200csuv\u1eea\u1ef3\u1f0b\u1f23\u0100io\u1eef\u1e31rc\xbb\u1e2e\u0269\u1ef9\0\0\u1efb\xed\u0548ant\u0100gl\u1f02\u1f06tr\xbb\u1e5dess\xbb\u1e7a\u0180aei\u1f12\u1f16\u1f1als;\u403dst;\u625fv\u0100;D\u0235\u1f20D;\u6a78parsl;\u69e5\u0100Da\u1f2f\u1f33ot;\u6253rr;\u6971\u0180cdi\u1f3e\u1f41\u1ef8r;\u612fo\xf4\u0352\u0100ah\u1f49\u1f4b;\u43b7\u803b\xf0\u40f0\u0100mr\u1f53\u1f57l\u803b\xeb\u40ebo;\u60ac\u0180cip\u1f61\u1f64\u1f67l;\u4021s\xf4\u056e\u0100eo\u1f6c\u1f74ctatio\xee\u0559nential\xe5\u0579\u09e1\u1f92\0\u1f9e\0\u1fa1\u1fa7\0\0\u1fc6\u1fcc\0\u1fd3\0\u1fe6\u1fea\u2000\0\u2008\u205allingdotse\xf1\u1e44y;\u4444male;\u6640\u0180ilr\u1fad\u1fb3\u1fc1lig;\u8000\ufb03\u0269\u1fb9\0\0\u1fbdg;\u8000\ufb00ig;\u8000\ufb04;\uc000\ud835\udd23lig;\u8000\ufb01lig;\uc000fj\u0180alt\u1fd9\u1fdc\u1fe1t;\u666dig;\u8000\ufb02ns;\u65b1of;\u4192\u01f0\u1fee\0\u1ff3f;\uc000\ud835\udd57\u0100ak\u05bf\u1ff7\u0100;v\u1ffc\u1ffd\u62d4;\u6ad9artint;\u6a0d\u0100ao\u200c\u2055\u0100cs\u2011\u2052\u03b1\u201a\u2030\u2038\u2045\u2048\0\u2050\u03b2\u2022\u2025\u2027\u202a\u202c\0\u202e\u803b\xbd\u40bd;\u6153\u803b\xbc\u40bc;\u6155;\u6159;\u615b\u01b3\u2034\0\u2036;\u6154;\u6156\u02b4\u203e\u2041\0\0\u2043\u803b\xbe\u40be;\u6157;\u615c5;\u6158\u01b6\u204c\0\u204e;\u615a;\u615d8;\u615el;\u6044wn;\u6322cr;\uc000\ud835\udcbb\u0880Eabcdefgijlnorstv\u2082\u2089\u209f\u20a5\u20b0\u20b4\u20f0\u20f5\u20fa\u20ff\u2103\u2112\u2138\u0317\u213e\u2152\u219e\u0100;l\u064d\u2087;\u6a8c\u0180cmp\u2090\u2095\u209dute;\u41f5ma\u0100;d\u209c\u1cda\u43b3;\u6a86reve;\u411f\u0100iy\u20aa\u20aerc;\u411d;\u4433ot;\u4121\u0200;lqs\u063e\u0642\u20bd\u20c9\u0180;qs\u063e\u064c\u20c4lan\xf4\u0665\u0200;cdl\u0665\u20d2\u20d5\u20e5c;\u6aa9ot\u0100;o\u20dc\u20dd\u6a80\u0100;l\u20e2\u20e3\u6a82;\u6a84\u0100;e\u20ea\u20ed\uc000\u22db\ufe00s;\u6a94r;\uc000\ud835\udd24\u0100;g\u0673\u061bmel;\u6137cy;\u4453\u0200;Eaj\u065a\u210c\u210e\u2110;\u6a92;\u6aa5;\u6aa4\u0200Eaes\u211b\u211d\u2129\u2134;\u6269p\u0100;p\u2123\u2124\u6a8arox\xbb\u2124\u0100;q\u212e\u212f\u6a88\u0100;q\u212e\u211bim;\u62e7pf;\uc000\ud835\udd58\u0100ci\u2143\u2146r;\u610am\u0180;el\u066b\u214e\u2150;\u6a8e;\u6a90\u8300>;cdlqr\u05ee\u2160\u216a\u216e\u2173\u2179\u0100ci\u2165\u2167;\u6aa7r;\u6a7aot;\u62d7Par;\u6995uest;\u6a7c\u0280adels\u2184\u216a\u2190\u0656\u219b\u01f0\u2189\0\u218epro\xf8\u209er;\u6978q\u0100lq\u063f\u2196les\xf3\u2088i\xed\u066b\u0100en\u21a3\u21adrtneqq;\uc000\u2269\ufe00\xc5\u21aa\u0500Aabcefkosy\u21c4\u21c7\u21f1\u21f5\u21fa\u2218\u221d\u222f\u2268\u227dr\xf2\u03a0\u0200ilmr\u21d0\u21d4\u21d7\u21dbrs\xf0\u1484f\xbb\u2024il\xf4\u06a9\u0100dr\u21e0\u21e4cy;\u444a\u0180;cw\u08f4\u21eb\u21efir;\u6948;\u61adar;\u610firc;\u4125\u0180alr\u2201\u220e\u2213rts\u0100;u\u2209\u220a\u6665it\xbb\u220alip;\u6026con;\u62b9r;\uc000\ud835\udd25s\u0100ew\u2223\u2229arow;\u6925arow;\u6926\u0280amopr\u223a\u223e\u2243\u225e\u2263rr;\u61fftht;\u623bk\u0100lr\u2249\u2253eftarrow;\u61a9ightarrow;\u61aaf;\uc000\ud835\udd59bar;\u6015\u0180clt\u226f\u2274\u2278r;\uc000\ud835\udcbdas\xe8\u21f4rok;\u4127\u0100bp\u2282\u2287ull;\u6043hen\xbb\u1c5b\u0ae1\u22a3\0\u22aa\0\u22b8\u22c5\u22ce\0\u22d5\u22f3\0\0\u22f8\u2322\u2367\u2362\u237f\0\u2386\u23aa\u23b4cute\u803b\xed\u40ed\u0180;iy\u0771\u22b0\u22b5rc\u803b\xee\u40ee;\u4438\u0100cx\u22bc\u22bfy;\u4435cl\u803b\xa1\u40a1\u0100fr\u039f\u22c9;\uc000\ud835\udd26rave\u803b\xec\u40ec\u0200;ino\u073e\u22dd\u22e9\u22ee\u0100in\u22e2\u22e6nt;\u6a0ct;\u622dfin;\u69dcta;\u6129lig;\u4133\u0180aop\u22fe\u231a\u231d\u0180cgt\u2305\u2308\u2317r;\u412b\u0180elp\u071f\u230f\u2313in\xe5\u078ear\xf4\u0720h;\u4131f;\u62b7ed;\u41b5\u0280;cfot\u04f4\u232c\u2331\u233d\u2341are;\u6105in\u0100;t\u2338\u2339\u621eie;\u69dddo\xf4\u2319\u0280;celp\u0757\u234c\u2350\u235b\u2361al;\u62ba\u0100gr\u2355\u2359er\xf3\u1563\xe3\u234darhk;\u6a17rod;\u6a3c\u0200cgpt\u236f\u2372\u2376\u237by;\u4451on;\u412ff;\uc000\ud835\udd5aa;\u43b9uest\u803b\xbf\u40bf\u0100ci\u238a\u238fr;\uc000\ud835\udcben\u0280;Edsv\u04f4\u239b\u239d\u23a1\u04f3;\u62f9ot;\u62f5\u0100;v\u23a6\u23a7\u62f4;\u62f3\u0100;i\u0777\u23aelde;\u4129\u01eb\u23b8\0\u23bccy;\u4456l\u803b\xef\u40ef\u0300cfmosu\u23cc\u23d7\u23dc\u23e1\u23e7\u23f5\u0100iy\u23d1\u23d5rc;\u4135;\u4439r;\uc000\ud835\udd27ath;\u4237pf;\uc000\ud835\udd5b\u01e3\u23ec\0\u23f1r;\uc000\ud835\udcbfrcy;\u4458kcy;\u4454\u0400acfghjos\u240b\u2416\u2422\u2427\u242d\u2431\u2435\u243bppa\u0100;v\u2413\u2414\u43ba;\u43f0\u0100ey\u241b\u2420dil;\u4137;\u443ar;\uc000\ud835\udd28reen;\u4138cy;\u4445cy;\u445cpf;\uc000\ud835\udd5ccr;\uc000\ud835\udcc0\u0b80ABEHabcdefghjlmnoprstuv\u2470\u2481\u2486\u248d\u2491\u250e\u253d\u255a\u2580\u264e\u265e\u2665\u2679\u267d\u269a\u26b2\u26d8\u275d\u2768\u278b\u27c0\u2801\u2812\u0180art\u2477\u247a\u247cr\xf2\u09c6\xf2\u0395ail;\u691barr;\u690e\u0100;g\u0994\u248b;\u6a8bar;\u6962\u0963\u24a5\0\u24aa\0\u24b1\0\0\0\0\0\u24b5\u24ba\0\u24c6\u24c8\u24cd\0\u24f9ute;\u413amptyv;\u69b4ra\xee\u084cbda;\u43bbg\u0180;dl\u088e\u24c1\u24c3;\u6991\xe5\u088e;\u6a85uo\u803b\xab\u40abr\u0400;bfhlpst\u0899\u24de\u24e6\u24e9\u24eb\u24ee\u24f1\u24f5\u0100;f\u089d\u24e3s;\u691fs;\u691d\xeb\u2252p;\u61abl;\u6939im;\u6973l;\u61a2\u0180;ae\u24ff\u2500\u2504\u6aabil;\u6919\u0100;s\u2509\u250a\u6aad;\uc000\u2aad\ufe00\u0180abr\u2515\u2519\u251drr;\u690crk;\u6772\u0100ak\u2522\u252cc\u0100ek\u2528\u252a;\u407b;\u405b\u0100es\u2531\u2533;\u698bl\u0100du\u2539\u253b;\u698f;\u698d\u0200aeuy\u2546\u254b\u2556\u2558ron;\u413e\u0100di\u2550\u2554il;\u413c\xec\u08b0\xe2\u2529;\u443b\u0200cqrs\u2563\u2566\u256d\u257da;\u6936uo\u0100;r\u0e19\u1746\u0100du\u2572\u2577har;\u6967shar;\u694bh;\u61b2\u0280;fgqs\u258b\u258c\u0989\u25f3\u25ff\u6264t\u0280ahlrt\u2598\u25a4\u25b7\u25c2\u25e8rrow\u0100;t\u0899\u25a1a\xe9\u24f6arpoon\u0100du\u25af\u25b4own\xbb\u045ap\xbb\u0966eftarrows;\u61c7ight\u0180ahs\u25cd\u25d6\u25derrow\u0100;s\u08f4\u08a7arpoon\xf3\u0f98quigarro\xf7\u21f0hreetimes;\u62cb\u0180;qs\u258b\u0993\u25falan\xf4\u09ac\u0280;cdgs\u09ac\u260a\u260d\u261d\u2628c;\u6aa8ot\u0100;o\u2614\u2615\u6a7f\u0100;r\u261a\u261b\u6a81;\u6a83\u0100;e\u2622\u2625\uc000\u22da\ufe00s;\u6a93\u0280adegs\u2633\u2639\u263d\u2649\u264bppro\xf8\u24c6ot;\u62d6q\u0100gq\u2643\u2645\xf4\u0989gt\xf2\u248c\xf4\u099bi\xed\u09b2\u0180ilr\u2655\u08e1\u265asht;\u697c;\uc000\ud835\udd29\u0100;E\u099c\u2663;\u6a91\u0161\u2669\u2676r\u0100du\u25b2\u266e\u0100;l\u0965\u2673;\u696alk;\u6584cy;\u4459\u0280;acht\u0a48\u2688\u268b\u2691\u2696r\xf2\u25c1orne\xf2\u1d08ard;\u696bri;\u65fa\u0100io\u269f\u26a4dot;\u4140ust\u0100;a\u26ac\u26ad\u63b0che\xbb\u26ad\u0200Eaes\u26bb\u26bd\u26c9\u26d4;\u6268p\u0100;p\u26c3\u26c4\u6a89rox\xbb\u26c4\u0100;q\u26ce\u26cf\u6a87\u0100;q\u26ce\u26bbim;\u62e6\u0400abnoptwz\u26e9\u26f4\u26f7\u271a\u272f\u2741\u2747\u2750\u0100nr\u26ee\u26f1g;\u67ecr;\u61fdr\xeb\u08c1g\u0180lmr\u26ff\u270d\u2714eft\u0100ar\u09e6\u2707ight\xe1\u09f2apsto;\u67fcight\xe1\u09fdparrow\u0100lr\u2725\u2729ef\xf4\u24edight;\u61ac\u0180afl\u2736\u2739\u273dr;\u6985;\uc000\ud835\udd5dus;\u6a2dimes;\u6a34\u0161\u274b\u274fst;\u6217\xe1\u134e\u0180;ef\u2757\u2758\u1800\u65cange\xbb\u2758ar\u0100;l\u2764\u2765\u4028t;\u6993\u0280achmt\u2773\u2776\u277c\u2785\u2787r\xf2\u08a8orne\xf2\u1d8car\u0100;d\u0f98\u2783;\u696d;\u600eri;\u62bf\u0300achiqt\u2798\u279d\u0a40\u27a2\u27ae\u27bbquo;\u6039r;\uc000\ud835\udcc1m\u0180;eg\u09b2\u27aa\u27ac;\u6a8d;\u6a8f\u0100bu\u252a\u27b3o\u0100;r\u0e1f\u27b9;\u601arok;\u4142\u8400<;cdhilqr\u082b\u27d2\u2639\u27dc\u27e0\u27e5\u27ea\u27f0\u0100ci\u27d7\u27d9;\u6aa6r;\u6a79re\xe5\u25f2mes;\u62c9arr;\u6976uest;\u6a7b\u0100Pi\u27f5\u27f9ar;\u6996\u0180;ef\u2800\u092d\u181b\u65c3r\u0100du\u2807\u280dshar;\u694ahar;\u6966\u0100en\u2817\u2821rtneqq;\uc000\u2268\ufe00\xc5\u281e\u0700Dacdefhilnopsu\u2840\u2845\u2882\u288e\u2893\u28a0\u28a5\u28a8\u28da\u28e2\u28e4\u0a83\u28f3\u2902Dot;\u623a\u0200clpr\u284e\u2852\u2863\u287dr\u803b\xaf\u40af\u0100et\u2857\u2859;\u6642\u0100;e\u285e\u285f\u6720se\xbb\u285f\u0100;s\u103b\u2868to\u0200;dlu\u103b\u2873\u2877\u287bow\xee\u048cef\xf4\u090f\xf0\u13d1ker;\u65ae\u0100oy\u2887\u288cmma;\u6a29;\u443cash;\u6014asuredangle\xbb\u1626r;\uc000\ud835\udd2ao;\u6127\u0180cdn\u28af\u28b4\u28c9ro\u803b\xb5\u40b5\u0200;acd\u1464\u28bd\u28c0\u28c4s\xf4\u16a7ir;\u6af0ot\u80bb\xb7\u01b5us\u0180;bd\u28d2\u1903\u28d3\u6212\u0100;u\u1d3c\u28d8;\u6a2a\u0163\u28de\u28e1p;\u6adb\xf2\u2212\xf0\u0a81\u0100dp\u28e9\u28eeels;\u62a7f;\uc000\ud835\udd5e\u0100ct\u28f8\u28fdr;\uc000\ud835\udcc2pos\xbb\u159d\u0180;lm\u2909\u290a\u290d\u43bctimap;\u62b8\u0c00GLRVabcdefghijlmoprstuvw\u2942\u2953\u297e\u2989\u2998\u29da\u29e9\u2a15\u2a1a\u2a58\u2a5d\u2a83\u2a95\u2aa4\u2aa8\u2b04\u2b07\u2b44\u2b7f\u2bae\u2c34\u2c67\u2c7c\u2ce9\u0100gt\u2947\u294b;\uc000\u22d9\u0338\u0100;v\u2950\u0bcf\uc000\u226b\u20d2\u0180elt\u295a\u2972\u2976ft\u0100ar\u2961\u2967rrow;\u61cdightarrow;\u61ce;\uc000\u22d8\u0338\u0100;v\u297b\u0c47\uc000\u226a\u20d2ightarrow;\u61cf\u0100Dd\u298e\u2993ash;\u62afash;\u62ae\u0280bcnpt\u29a3\u29a7\u29ac\u29b1\u29ccla\xbb\u02deute;\u4144g;\uc000\u2220\u20d2\u0280;Eiop\u0d84\u29bc\u29c0\u29c5\u29c8;\uc000\u2a70\u0338d;\uc000\u224b\u0338s;\u4149ro\xf8\u0d84ur\u0100;a\u29d3\u29d4\u666el\u0100;s\u29d3\u0b38\u01f3\u29df\0\u29e3p\u80bb\xa0\u0b37mp\u0100;e\u0bf9\u0c00\u0280aeouy\u29f4\u29fe\u2a03\u2a10\u2a13\u01f0\u29f9\0\u29fb;\u6a43on;\u4148dil;\u4146ng\u0100;d\u0d7e\u2a0aot;\uc000\u2a6d\u0338p;\u6a42;\u443dash;\u6013\u0380;Aadqsx\u0b92\u2a29\u2a2d\u2a3b\u2a41\u2a45\u2a50rr;\u61d7r\u0100hr\u2a33\u2a36k;\u6924\u0100;o\u13f2\u13f0ot;\uc000\u2250\u0338ui\xf6\u0b63\u0100ei\u2a4a\u2a4ear;\u6928\xed\u0b98ist\u0100;s\u0ba0\u0b9fr;\uc000\ud835\udd2b\u0200Eest\u0bc5\u2a66\u2a79\u2a7c\u0180;qs\u0bbc\u2a6d\u0be1\u0180;qs\u0bbc\u0bc5\u2a74lan\xf4\u0be2i\xed\u0bea\u0100;r\u0bb6\u2a81\xbb\u0bb7\u0180Aap\u2a8a\u2a8d\u2a91r\xf2\u2971rr;\u61aear;\u6af2\u0180;sv\u0f8d\u2a9c\u0f8c\u0100;d\u2aa1\u2aa2\u62fc;\u62facy;\u445a\u0380AEadest\u2ab7\u2aba\u2abe\u2ac2\u2ac5\u2af6\u2af9r\xf2\u2966;\uc000\u2266\u0338rr;\u619ar;\u6025\u0200;fqs\u0c3b\u2ace\u2ae3\u2aeft\u0100ar\u2ad4\u2ad9rro\xf7\u2ac1ightarro\xf7\u2a90\u0180;qs\u0c3b\u2aba\u2aealan\xf4\u0c55\u0100;s\u0c55\u2af4\xbb\u0c36i\xed\u0c5d\u0100;r\u0c35\u2afei\u0100;e\u0c1a\u0c25i\xe4\u0d90\u0100pt\u2b0c\u2b11f;\uc000\ud835\udd5f\u8180\xac;in\u2b19\u2b1a\u2b36\u40acn\u0200;Edv\u0b89\u2b24\u2b28\u2b2e;\uc000\u22f9\u0338ot;\uc000\u22f5\u0338\u01e1\u0b89\u2b33\u2b35;\u62f7;\u62f6i\u0100;v\u0cb8\u2b3c\u01e1\u0cb8\u2b41\u2b43;\u62fe;\u62fd\u0180aor\u2b4b\u2b63\u2b69r\u0200;ast\u0b7b\u2b55\u2b5a\u2b5flle\xec\u0b7bl;\uc000\u2afd\u20e5;\uc000\u2202\u0338lint;\u6a14\u0180;ce\u0c92\u2b70\u2b73u\xe5\u0ca5\u0100;c\u0c98\u2b78\u0100;e\u0c92\u2b7d\xf1\u0c98\u0200Aait\u2b88\u2b8b\u2b9d\u2ba7r\xf2\u2988rr\u0180;cw\u2b94\u2b95\u2b99\u619b;\uc000\u2933\u0338;\uc000\u219d\u0338ghtarrow\xbb\u2b95ri\u0100;e\u0ccb\u0cd6\u0380chimpqu\u2bbd\u2bcd\u2bd9\u2b04\u0b78\u2be4\u2bef\u0200;cer\u0d32\u2bc6\u0d37\u2bc9u\xe5\u0d45;\uc000\ud835\udcc3ort\u026d\u2b05\0\0\u2bd6ar\xe1\u2b56m\u0100;e\u0d6e\u2bdf\u0100;q\u0d74\u0d73su\u0100bp\u2beb\u2bed\xe5\u0cf8\xe5\u0d0b\u0180bcp\u2bf6\u2c11\u2c19\u0200;Ees\u2bff\u2c00\u0d22\u2c04\u6284;\uc000\u2ac5\u0338et\u0100;e\u0d1b\u2c0bq\u0100;q\u0d23\u2c00c\u0100;e\u0d32\u2c17\xf1\u0d38\u0200;Ees\u2c22\u2c23\u0d5f\u2c27\u6285;\uc000\u2ac6\u0338et\u0100;e\u0d58\u2c2eq\u0100;q\u0d60\u2c23\u0200gilr\u2c3d\u2c3f\u2c45\u2c47\xec\u0bd7lde\u803b\xf1\u40f1\xe7\u0c43iangle\u0100lr\u2c52\u2c5ceft\u0100;e\u0c1a\u2c5a\xf1\u0c26ight\u0100;e\u0ccb\u2c65\xf1\u0cd7\u0100;m\u2c6c\u2c6d\u43bd\u0180;es\u2c74\u2c75\u2c79\u4023ro;\u6116p;\u6007\u0480DHadgilrs\u2c8f\u2c94\u2c99\u2c9e\u2ca3\u2cb0\u2cb6\u2cd3\u2ce3ash;\u62adarr;\u6904p;\uc000\u224d\u20d2ash;\u62ac\u0100et\u2ca8\u2cac;\uc000\u2265\u20d2;\uc000>\u20d2nfin;\u69de\u0180Aet\u2cbd\u2cc1\u2cc5rr;\u6902;\uc000\u2264\u20d2\u0100;r\u2cca\u2ccd\uc000<\u20d2ie;\uc000\u22b4\u20d2\u0100At\u2cd8\u2cdcrr;\u6903rie;\uc000\u22b5\u20d2im;\uc000\u223c\u20d2\u0180Aan\u2cf0\u2cf4\u2d02rr;\u61d6r\u0100hr\u2cfa\u2cfdk;\u6923\u0100;o\u13e7\u13e5ear;\u6927\u1253\u1a95\0\0\0\0\0\0\0\0\0\0\0\0\0\u2d2d\0\u2d38\u2d48\u2d60\u2d65\u2d72\u2d84\u1b07\0\0\u2d8d\u2dab\0\u2dc8\u2dce\0\u2ddc\u2e19\u2e2b\u2e3e\u2e43\u0100cs\u2d31\u1a97ute\u803b\xf3\u40f3\u0100iy\u2d3c\u2d45r\u0100;c\u1a9e\u2d42\u803b\xf4\u40f4;\u443e\u0280abios\u1aa0\u2d52\u2d57\u01c8\u2d5alac;\u4151v;\u6a38old;\u69bclig;\u4153\u0100cr\u2d69\u2d6dir;\u69bf;\uc000\ud835\udd2c\u036f\u2d79\0\0\u2d7c\0\u2d82n;\u42dbave\u803b\xf2\u40f2;\u69c1\u0100bm\u2d88\u0df4ar;\u69b5\u0200acit\u2d95\u2d98\u2da5\u2da8r\xf2\u1a80\u0100ir\u2d9d\u2da0r;\u69beoss;\u69bbn\xe5\u0e52;\u69c0\u0180aei\u2db1\u2db5\u2db9cr;\u414dga;\u43c9\u0180cdn\u2dc0\u2dc5\u01cdron;\u43bf;\u69b6pf;\uc000\ud835\udd60\u0180ael\u2dd4\u2dd7\u01d2r;\u69b7rp;\u69b9\u0380;adiosv\u2dea\u2deb\u2dee\u2e08\u2e0d\u2e10\u2e16\u6228r\xf2\u1a86\u0200;efm\u2df7\u2df8\u2e02\u2e05\u6a5dr\u0100;o\u2dfe\u2dff\u6134f\xbb\u2dff\u803b\xaa\u40aa\u803b\xba\u40bagof;\u62b6r;\u6a56lope;\u6a57;\u6a5b\u0180clo\u2e1f\u2e21\u2e27\xf2\u2e01ash\u803b\xf8\u40f8l;\u6298i\u016c\u2e2f\u2e34de\u803b\xf5\u40f5es\u0100;a\u01db\u2e3as;\u6a36ml\u803b\xf6\u40f6bar;\u633d\u0ae1\u2e5e\0\u2e7d\0\u2e80\u2e9d\0\u2ea2\u2eb9\0\0\u2ecb\u0e9c\0\u2f13\0\0\u2f2b\u2fbc\0\u2fc8r\u0200;ast\u0403\u2e67\u2e72\u0e85\u8100\xb6;l\u2e6d\u2e6e\u40b6le\xec\u0403\u0269\u2e78\0\0\u2e7bm;\u6af3;\u6afdy;\u443fr\u0280cimpt\u2e8b\u2e8f\u2e93\u1865\u2e97nt;\u4025od;\u402eil;\u6030enk;\u6031r;\uc000\ud835\udd2d\u0180imo\u2ea8\u2eb0\u2eb4\u0100;v\u2ead\u2eae\u43c6;\u43d5ma\xf4\u0a76ne;\u660e\u0180;tv\u2ebf\u2ec0\u2ec8\u43c0chfork\xbb\u1ffd;\u43d6\u0100au\u2ecf\u2edfn\u0100ck\u2ed5\u2eddk\u0100;h\u21f4\u2edb;\u610e\xf6\u21f4s\u0480;abcdemst\u2ef3\u2ef4\u1908\u2ef9\u2efd\u2f04\u2f06\u2f0a\u2f0e\u402bcir;\u6a23ir;\u6a22\u0100ou\u1d40\u2f02;\u6a25;\u6a72n\u80bb\xb1\u0e9dim;\u6a26wo;\u6a27\u0180ipu\u2f19\u2f20\u2f25ntint;\u6a15f;\uc000\ud835\udd61nd\u803b\xa3\u40a3\u0500;Eaceinosu\u0ec8\u2f3f\u2f41\u2f44\u2f47\u2f81\u2f89\u2f92\u2f7e\u2fb6;\u6ab3p;\u6ab7u\xe5\u0ed9\u0100;c\u0ece\u2f4c\u0300;acens\u0ec8\u2f59\u2f5f\u2f66\u2f68\u2f7eppro\xf8\u2f43urlye\xf1\u0ed9\xf1\u0ece\u0180aes\u2f6f\u2f76\u2f7approx;\u6ab9qq;\u6ab5im;\u62e8i\xed\u0edfme\u0100;s\u2f88\u0eae\u6032\u0180Eas\u2f78\u2f90\u2f7a\xf0\u2f75\u0180dfp\u0eec\u2f99\u2faf\u0180als\u2fa0\u2fa5\u2faalar;\u632eine;\u6312urf;\u6313\u0100;t\u0efb\u2fb4\xef\u0efbrel;\u62b0\u0100ci\u2fc0\u2fc5r;\uc000\ud835\udcc5;\u43c8ncsp;\u6008\u0300fiopsu\u2fda\u22e2\u2fdf\u2fe5\u2feb\u2ff1r;\uc000\ud835\udd2epf;\uc000\ud835\udd62rime;\u6057cr;\uc000\ud835\udcc6\u0180aeo\u2ff8\u3009\u3013t\u0100ei\u2ffe\u3005rnion\xf3\u06b0nt;\u6a16st\u0100;e\u3010\u3011\u403f\xf1\u1f19\xf4\u0f14\u0a80ABHabcdefhilmnoprstux\u3040\u3051\u3055\u3059\u30e0\u310e\u312b\u3147\u3162\u3172\u318e\u3206\u3215\u3224\u3229\u3258\u326e\u3272\u3290\u32b0\u32b7\u0180art\u3047\u304a\u304cr\xf2\u10b3\xf2\u03ddail;\u691car\xf2\u1c65ar;\u6964\u0380cdenqrt\u3068\u3075\u3078\u307f\u308f\u3094\u30cc\u0100eu\u306d\u3071;\uc000\u223d\u0331te;\u4155i\xe3\u116emptyv;\u69b3g\u0200;del\u0fd1\u3089\u308b\u308d;\u6992;\u69a5\xe5\u0fd1uo\u803b\xbb\u40bbr\u0580;abcfhlpstw\u0fdc\u30ac\u30af\u30b7\u30b9\u30bc\u30be\u30c0\u30c3\u30c7\u30cap;\u6975\u0100;f\u0fe0\u30b4s;\u6920;\u6933s;\u691e\xeb\u225d\xf0\u272el;\u6945im;\u6974l;\u61a3;\u619d\u0100ai\u30d1\u30d5il;\u691ao\u0100;n\u30db\u30dc\u6236al\xf3\u0f1e\u0180abr\u30e7\u30ea\u30eer\xf2\u17e5rk;\u6773\u0100ak\u30f3\u30fdc\u0100ek\u30f9\u30fb;\u407d;\u405d\u0100es\u3102\u3104;\u698cl\u0100du\u310a\u310c;\u698e;\u6990\u0200aeuy\u3117\u311c\u3127\u3129ron;\u4159\u0100di\u3121\u3125il;\u4157\xec\u0ff2\xe2\u30fa;\u4440\u0200clqs\u3134\u3137\u313d\u3144a;\u6937dhar;\u6969uo\u0100;r\u020e\u020dh;\u61b3\u0180acg\u314e\u315f\u0f44l\u0200;ips\u0f78\u3158\u315b\u109cn\xe5\u10bbar\xf4\u0fa9t;\u65ad\u0180ilr\u3169\u1023\u316esht;\u697d;\uc000\ud835\udd2f\u0100ao\u3177\u3186r\u0100du\u317d\u317f\xbb\u047b\u0100;l\u1091\u3184;\u696c\u0100;v\u318b\u318c\u43c1;\u43f1\u0180gns\u3195\u31f9\u31fcht\u0300ahlrst\u31a4\u31b0\u31c2\u31d8\u31e4\u31eerrow\u0100;t\u0fdc\u31ada\xe9\u30c8arpoon\u0100du\u31bb\u31bfow\xee\u317ep\xbb\u1092eft\u0100ah\u31ca\u31d0rrow\xf3\u0feaarpoon\xf3\u0551ightarrows;\u61c9quigarro\xf7\u30cbhreetimes;\u62ccg;\u42daingdotse\xf1\u1f32\u0180ahm\u320d\u3210\u3213r\xf2\u0feaa\xf2\u0551;\u600foust\u0100;a\u321e\u321f\u63b1che\xbb\u321fmid;\u6aee\u0200abpt\u3232\u323d\u3240\u3252\u0100nr\u3237\u323ag;\u67edr;\u61fer\xeb\u1003\u0180afl\u3247\u324a\u324er;\u6986;\uc000\ud835\udd63us;\u6a2eimes;\u6a35\u0100ap\u325d\u3267r\u0100;g\u3263\u3264\u4029t;\u6994olint;\u6a12ar\xf2\u31e3\u0200achq\u327b\u3280\u10bc\u3285quo;\u603ar;\uc000\ud835\udcc7\u0100bu\u30fb\u328ao\u0100;r\u0214\u0213\u0180hir\u3297\u329b\u32a0re\xe5\u31f8mes;\u62cai\u0200;efl\u32aa\u1059\u1821\u32ab\u65b9tri;\u69celuhar;\u6968;\u611e\u0d61\u32d5\u32db\u32df\u332c\u3338\u3371\0\u337a\u33a4\0\0\u33ec\u33f0\0\u3428\u3448\u345a\u34ad\u34b1\u34ca\u34f1\0\u3616\0\0\u3633cute;\u415bqu\xef\u27ba\u0500;Eaceinpsy\u11ed\u32f3\u32f5\u32ff\u3302\u330b\u330f\u331f\u3326\u3329;\u6ab4\u01f0\u32fa\0\u32fc;\u6ab8on;\u4161u\xe5\u11fe\u0100;d\u11f3\u3307il;\u415frc;\u415d\u0180Eas\u3316\u3318\u331b;\u6ab6p;\u6abaim;\u62e9olint;\u6a13i\xed\u1204;\u4441ot\u0180;be\u3334\u1d47\u3335\u62c5;\u6a66\u0380Aacmstx\u3346\u334a\u3357\u335b\u335e\u3363\u336drr;\u61d8r\u0100hr\u3350\u3352\xeb\u2228\u0100;o\u0a36\u0a34t\u803b\xa7\u40a7i;\u403bwar;\u6929m\u0100in\u3369\xf0nu\xf3\xf1t;\u6736r\u0100;o\u3376\u2055\uc000\ud835\udd30\u0200acoy\u3382\u3386\u3391\u33a0rp;\u666f\u0100hy\u338b\u338fcy;\u4449;\u4448rt\u026d\u3399\0\0\u339ci\xe4\u1464ara\xec\u2e6f\u803b\xad\u40ad\u0100gm\u33a8\u33b4ma\u0180;fv\u33b1\u33b2\u33b2\u43c3;\u43c2\u0400;deglnpr\u12ab\u33c5\u33c9\u33ce\u33d6\u33de\u33e1\u33e6ot;\u6a6a\u0100;q\u12b1\u12b0\u0100;E\u33d3\u33d4\u6a9e;\u6aa0\u0100;E\u33db\u33dc\u6a9d;\u6a9fe;\u6246lus;\u6a24arr;\u6972ar\xf2\u113d\u0200aeit\u33f8\u3408\u340f\u3417\u0100ls\u33fd\u3404lsetm\xe9\u336ahp;\u6a33parsl;\u69e4\u0100dl\u1463\u3414e;\u6323\u0100;e\u341c\u341d\u6aaa\u0100;s\u3422\u3423\u6aac;\uc000\u2aac\ufe00\u0180flp\u342e\u3433\u3442tcy;\u444c\u0100;b\u3438\u3439\u402f\u0100;a\u343e\u343f\u69c4r;\u633ff;\uc000\ud835\udd64a\u0100dr\u344d\u0402es\u0100;u\u3454\u3455\u6660it\xbb\u3455\u0180csu\u3460\u3479\u349f\u0100au\u3465\u346fp\u0100;s\u1188\u346b;\uc000\u2293\ufe00p\u0100;s\u11b4\u3475;\uc000\u2294\ufe00u\u0100bp\u347f\u348f\u0180;es\u1197\u119c\u3486et\u0100;e\u1197\u348d\xf1\u119d\u0180;es\u11a8\u11ad\u3496et\u0100;e\u11a8\u349d\xf1\u11ae\u0180;af\u117b\u34a6\u05b0r\u0165\u34ab\u05b1\xbb\u117car\xf2\u1148\u0200cemt\u34b9\u34be\u34c2\u34c5r;\uc000\ud835\udcc8tm\xee\xf1i\xec\u3415ar\xe6\u11be\u0100ar\u34ce\u34d5r\u0100;f\u34d4\u17bf\u6606\u0100an\u34da\u34edight\u0100ep\u34e3\u34eapsilo\xee\u1ee0h\xe9\u2eafs\xbb\u2852\u0280bcmnp\u34fb\u355e\u1209\u358b\u358e\u0480;Edemnprs\u350e\u350f\u3511\u3515\u351e\u3523\u352c\u3531\u3536\u6282;\u6ac5ot;\u6abd\u0100;d\u11da\u351aot;\u6ac3ult;\u6ac1\u0100Ee\u3528\u352a;\u6acb;\u628alus;\u6abfarr;\u6979\u0180eiu\u353d\u3552\u3555t\u0180;en\u350e\u3545\u354bq\u0100;q\u11da\u350feq\u0100;q\u352b\u3528m;\u6ac7\u0100bp\u355a\u355c;\u6ad5;\u6ad3c\u0300;acens\u11ed\u356c\u3572\u3579\u357b\u3326ppro\xf8\u32faurlye\xf1\u11fe\xf1\u11f3\u0180aes\u3582\u3588\u331bppro\xf8\u331aq\xf1\u3317g;\u666a\u0680123;Edehlmnps\u35a9\u35ac\u35af\u121c\u35b2\u35b4\u35c0\u35c9\u35d5\u35da\u35df\u35e8\u35ed\u803b\xb9\u40b9\u803b\xb2\u40b2\u803b\xb3\u40b3;\u6ac6\u0100os\u35b9\u35bct;\u6abeub;\u6ad8\u0100;d\u1222\u35c5ot;\u6ac4s\u0100ou\u35cf\u35d2l;\u67c9b;\u6ad7arr;\u697bult;\u6ac2\u0100Ee\u35e4\u35e6;\u6acc;\u628blus;\u6ac0\u0180eiu\u35f4\u3609\u360ct\u0180;en\u121c\u35fc\u3602q\u0100;q\u1222\u35b2eq\u0100;q\u35e7\u35e4m;\u6ac8\u0100bp\u3611\u3613;\u6ad4;\u6ad6\u0180Aan\u361c\u3620\u362drr;\u61d9r\u0100hr\u3626\u3628\xeb\u222e\u0100;o\u0a2b\u0a29war;\u692alig\u803b\xdf\u40df\u0be1\u3651\u365d\u3660\u12ce\u3673\u3679\0\u367e\u36c2\0\0\0\0\0\u36db\u3703\0\u3709\u376c\0\0\0\u3787\u0272\u3656\0\0\u365bget;\u6316;\u43c4r\xeb\u0e5f\u0180aey\u3666\u366b\u3670ron;\u4165dil;\u4163;\u4442lrec;\u6315r;\uc000\ud835\udd31\u0200eiko\u3686\u369d\u36b5\u36bc\u01f2\u368b\0\u3691e\u01004f\u1284\u1281a\u0180;sv\u3698\u3699\u369b\u43b8ym;\u43d1\u0100cn\u36a2\u36b2k\u0100as\u36a8\u36aeppro\xf8\u12c1im\xbb\u12acs\xf0\u129e\u0100as\u36ba\u36ae\xf0\u12c1rn\u803b\xfe\u40fe\u01ec\u031f\u36c6\u22e7es\u8180\xd7;bd\u36cf\u36d0\u36d8\u40d7\u0100;a\u190f\u36d5r;\u6a31;\u6a30\u0180eps\u36e1\u36e3\u3700\xe1\u2a4d\u0200;bcf\u0486\u36ec\u36f0\u36f4ot;\u6336ir;\u6af1\u0100;o\u36f9\u36fc\uc000\ud835\udd65rk;\u6ada\xe1\u3362rime;\u6034\u0180aip\u370f\u3712\u3764d\xe5\u1248\u0380adempst\u3721\u374d\u3740\u3751\u3757\u375c\u375fngle\u0280;dlqr\u3730\u3731\u3736\u3740\u3742\u65b5own\xbb\u1dbbeft\u0100;e\u2800\u373e\xf1\u092e;\u625cight\u0100;e\u32aa\u374b\xf1\u105aot;\u65ecinus;\u6a3alus;\u6a39b;\u69cdime;\u6a3bezium;\u63e2\u0180cht\u3772\u377d\u3781\u0100ry\u3777\u377b;\uc000\ud835\udcc9;\u4446cy;\u445brok;\u4167\u0100io\u378b\u378ex\xf4\u1777head\u0100lr\u3797\u37a0eftarro\xf7\u084fightarrow\xbb\u0f5d\u0900AHabcdfghlmoprstuw\u37d0\u37d3\u37d7\u37e4\u37f0\u37fc\u380e\u381c\u3823\u3834\u3851\u385d\u386b\u38a9\u38cc\u38d2\u38ea\u38f6r\xf2\u03edar;\u6963\u0100cr\u37dc\u37e2ute\u803b\xfa\u40fa\xf2\u1150r\u01e3\u37ea\0\u37edy;\u445eve;\u416d\u0100iy\u37f5\u37farc\u803b\xfb\u40fb;\u4443\u0180abh\u3803\u3806\u380br\xf2\u13adlac;\u4171a\xf2\u13c3\u0100ir\u3813\u3818sht;\u697e;\uc000\ud835\udd32rave\u803b\xf9\u40f9\u0161\u3827\u3831r\u0100lr\u382c\u382e\xbb\u0957\xbb\u1083lk;\u6580\u0100ct\u3839\u384d\u026f\u383f\0\0\u384arn\u0100;e\u3845\u3846\u631cr\xbb\u3846op;\u630fri;\u65f8\u0100al\u3856\u385acr;\u416b\u80bb\xa8\u0349\u0100gp\u3862\u3866on;\u4173f;\uc000\ud835\udd66\u0300adhlsu\u114b\u3878\u387d\u1372\u3891\u38a0own\xe1\u13b3arpoon\u0100lr\u3888\u388cef\xf4\u382digh\xf4\u382fi\u0180;hl\u3899\u389a\u389c\u43c5\xbb\u13faon\xbb\u389aparrows;\u61c8\u0180cit\u38b0\u38c4\u38c8\u026f\u38b6\0\0\u38c1rn\u0100;e\u38bc\u38bd\u631dr\xbb\u38bdop;\u630eng;\u416fri;\u65f9cr;\uc000\ud835\udcca\u0180dir\u38d9\u38dd\u38e2ot;\u62f0lde;\u4169i\u0100;f\u3730\u38e8\xbb\u1813\u0100am\u38ef\u38f2r\xf2\u38a8l\u803b\xfc\u40fcangle;\u69a7\u0780ABDacdeflnoprsz\u391c\u391f\u3929\u392d\u39b5\u39b8\u39bd\u39df\u39e4\u39e8\u39f3\u39f9\u39fd\u3a01\u3a20r\xf2\u03f7ar\u0100;v\u3926\u3927\u6ae8;\u6ae9as\xe8\u03e1\u0100nr\u3932\u3937grt;\u699c\u0380eknprst\u34e3\u3946\u394b\u3952\u395d\u3964\u3996app\xe1\u2415othin\xe7\u1e96\u0180hir\u34eb\u2ec8\u3959op\xf4\u2fb5\u0100;h\u13b7\u3962\xef\u318d\u0100iu\u3969\u396dgm\xe1\u33b3\u0100bp\u3972\u3984setneq\u0100;q\u397d\u3980\uc000\u228a\ufe00;\uc000\u2acb\ufe00setneq\u0100;q\u398f\u3992\uc000\u228b\ufe00;\uc000\u2acc\ufe00\u0100hr\u399b\u399fet\xe1\u369ciangle\u0100lr\u39aa\u39afeft\xbb\u0925ight\xbb\u1051y;\u4432ash\xbb\u1036\u0180elr\u39c4\u39d2\u39d7\u0180;be\u2dea\u39cb\u39cfar;\u62bbq;\u625alip;\u62ee\u0100bt\u39dc\u1468a\xf2\u1469r;\uc000\ud835\udd33tr\xe9\u39aesu\u0100bp\u39ef\u39f1\xbb\u0d1c\xbb\u0d59pf;\uc000\ud835\udd67ro\xf0\u0efbtr\xe9\u39b4\u0100cu\u3a06\u3a0br;\uc000\ud835\udccb\u0100bp\u3a10\u3a18n\u0100Ee\u3980\u3a16\xbb\u397en\u0100Ee\u3992\u3a1e\xbb\u3990igzag;\u699a\u0380cefoprs\u3a36\u3a3b\u3a56\u3a5b\u3a54\u3a61\u3a6airc;\u4175\u0100di\u3a40\u3a51\u0100bg\u3a45\u3a49ar;\u6a5fe\u0100;q\u15fa\u3a4f;\u6259erp;\u6118r;\uc000\ud835\udd34pf;\uc000\ud835\udd68\u0100;e\u1479\u3a66at\xe8\u1479cr;\uc000\ud835\udccc\u0ae3\u178e\u3a87\0\u3a8b\0\u3a90\u3a9b\0\0\u3a9d\u3aa8\u3aab\u3aaf\0\0\u3ac3\u3ace\0\u3ad8\u17dc\u17dftr\xe9\u17d1r;\uc000\ud835\udd35\u0100Aa\u3a94\u3a97r\xf2\u03c3r\xf2\u09f6;\u43be\u0100Aa\u3aa1\u3aa4r\xf2\u03b8r\xf2\u09eba\xf0\u2713is;\u62fb\u0180dpt\u17a4\u3ab5\u3abe\u0100fl\u3aba\u17a9;\uc000\ud835\udd69im\xe5\u17b2\u0100Aa\u3ac7\u3acar\xf2\u03cer\xf2\u0a01\u0100cq\u3ad2\u17b8r;\uc000\ud835\udccd\u0100pt\u17d6\u3adcr\xe9\u17d4\u0400acefiosu\u3af0\u3afd\u3b08\u3b0c\u3b11\u3b15\u3b1b\u3b21c\u0100uy\u3af6\u3afbte\u803b\xfd\u40fd;\u444f\u0100iy\u3b02\u3b06rc;\u4177;\u444bn\u803b\xa5\u40a5r;\uc000\ud835\udd36cy;\u4457pf;\uc000\ud835\udd6acr;\uc000\ud835\udcce\u0100cm\u3b26\u3b29y;\u444el\u803b\xff\u40ff\u0500acdefhiosw\u3b42\u3b48\u3b54\u3b58\u3b64\u3b69\u3b6d\u3b74\u3b7a\u3b80cute;\u417a\u0100ay\u3b4d\u3b52ron;\u417e;\u4437ot;\u417c\u0100et\u3b5d\u3b61tr\xe6\u155fa;\u43b6r;\uc000\ud835\udd37cy;\u4436grarr;\u61ddpf;\uc000\ud835\udd6bcr;\uc000\ud835\udccf\u0100jn\u3b85\u3b87;\u600dj;\u600c'.split("").map((function(e){return e.charCodeAt(0)})))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=new Uint16Array("\u0200aglq\t\x15\x18\x1b\u026d\x0f\0\0\x12p;\u4026os;\u4027t;\u403et;\u403cuot;\u4022".split("").map((function(e){return e.charCodeAt(0)})))},function(e,t,n){"use strict";function r(e){for(var t=1;t<e.length;t++)e[t][0]+=e[t-1][0]+1;return e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=new Map(r([[9,"&Tab;"],[0,"&NewLine;"],[22,"&excl;"],[0,"&quot;"],[0,"&num;"],[0,"&dollar;"],[0,"&percnt;"],[0,"&amp;"],[0,"&apos;"],[0,"&lpar;"],[0,"&rpar;"],[0,"&ast;"],[0,"&plus;"],[0,"&comma;"],[1,"&period;"],[0,"&sol;"],[10,"&colon;"],[0,"&semi;"],[0,{v:"&lt;",n:8402,o:"&nvlt;"}],[0,{v:"&equals;",n:8421,o:"&bne;"}],[0,{v:"&gt;",n:8402,o:"&nvgt;"}],[0,"&quest;"],[0,"&commat;"],[26,"&lbrack;"],[0,"&bsol;"],[0,"&rbrack;"],[0,"&Hat;"],[0,"&lowbar;"],[0,"&DiacriticalGrave;"],[5,{n:106,o:"&fjlig;"}],[20,"&lbrace;"],[0,"&verbar;"],[0,"&rbrace;"],[34,"&nbsp;"],[0,"&iexcl;"],[0,"&cent;"],[0,"&pound;"],[0,"&curren;"],[0,"&yen;"],[0,"&brvbar;"],[0,"&sect;"],[0,"&die;"],[0,"&copy;"],[0,"&ordf;"],[0,"&laquo;"],[0,"&not;"],[0,"&shy;"],[0,"&circledR;"],[0,"&macr;"],[0,"&deg;"],[0,"&PlusMinus;"],[0,"&sup2;"],[0,"&sup3;"],[0,"&acute;"],[0,"&micro;"],[0,"&para;"],[0,"&centerdot;"],[0,"&cedil;"],[0,"&sup1;"],[0,"&ordm;"],[0,"&raquo;"],[0,"&frac14;"],[0,"&frac12;"],[0,"&frac34;"],[0,"&iquest;"],[0,"&Agrave;"],[0,"&Aacute;"],[0,"&Acirc;"],[0,"&Atilde;"],[0,"&Auml;"],[0,"&angst;"],[0,"&AElig;"],[0,"&Ccedil;"],[0,"&Egrave;"],[0,"&Eacute;"],[0,"&Ecirc;"],[0,"&Euml;"],[0,"&Igrave;"],[0,"&Iacute;"],[0,"&Icirc;"],[0,"&Iuml;"],[0,"&ETH;"],[0,"&Ntilde;"],[0,"&Ograve;"],[0,"&Oacute;"],[0,"&Ocirc;"],[0,"&Otilde;"],[0,"&Ouml;"],[0,"&times;"],[0,"&Oslash;"],[0,"&Ugrave;"],[0,"&Uacute;"],[0,"&Ucirc;"],[0,"&Uuml;"],[0,"&Yacute;"],[0,"&THORN;"],[0,"&szlig;"],[0,"&agrave;"],[0,"&aacute;"],[0,"&acirc;"],[0,"&atilde;"],[0,"&auml;"],[0,"&aring;"],[0,"&aelig;"],[0,"&ccedil;"],[0,"&egrave;"],[0,"&eacute;"],[0,"&ecirc;"],[0,"&euml;"],[0,"&igrave;"],[0,"&iacute;"],[0,"&icirc;"],[0,"&iuml;"],[0,"&eth;"],[0,"&ntilde;"],[0,"&ograve;"],[0,"&oacute;"],[0,"&ocirc;"],[0,"&otilde;"],[0,"&ouml;"],[0,"&div;"],[0,"&oslash;"],[0,"&ugrave;"],[0,"&uacute;"],[0,"&ucirc;"],[0,"&uuml;"],[0,"&yacute;"],[0,"&thorn;"],[0,"&yuml;"],[0,"&Amacr;"],[0,"&amacr;"],[0,"&Abreve;"],[0,"&abreve;"],[0,"&Aogon;"],[0,"&aogon;"],[0,"&Cacute;"],[0,"&cacute;"],[0,"&Ccirc;"],[0,"&ccirc;"],[0,"&Cdot;"],[0,"&cdot;"],[0,"&Ccaron;"],[0,"&ccaron;"],[0,"&Dcaron;"],[0,"&dcaron;"],[0,"&Dstrok;"],[0,"&dstrok;"],[0,"&Emacr;"],[0,"&emacr;"],[2,"&Edot;"],[0,"&edot;"],[0,"&Eogon;"],[0,"&eogon;"],[0,"&Ecaron;"],[0,"&ecaron;"],[0,"&Gcirc;"],[0,"&gcirc;"],[0,"&Gbreve;"],[0,"&gbreve;"],[0,"&Gdot;"],[0,"&gdot;"],[0,"&Gcedil;"],[1,"&Hcirc;"],[0,"&hcirc;"],[0,"&Hstrok;"],[0,"&hstrok;"],[0,"&Itilde;"],[0,"&itilde;"],[0,"&Imacr;"],[0,"&imacr;"],[2,"&Iogon;"],[0,"&iogon;"],[0,"&Idot;"],[0,"&imath;"],[0,"&IJlig;"],[0,"&ijlig;"],[0,"&Jcirc;"],[0,"&jcirc;"],[0,"&Kcedil;"],[0,"&kcedil;"],[0,"&kgreen;"],[0,"&Lacute;"],[0,"&lacute;"],[0,"&Lcedil;"],[0,"&lcedil;"],[0,"&Lcaron;"],[0,"&lcaron;"],[0,"&Lmidot;"],[0,"&lmidot;"],[0,"&Lstrok;"],[0,"&lstrok;"],[0,"&Nacute;"],[0,"&nacute;"],[0,"&Ncedil;"],[0,"&ncedil;"],[0,"&Ncaron;"],[0,"&ncaron;"],[0,"&napos;"],[0,"&ENG;"],[0,"&eng;"],[0,"&Omacr;"],[0,"&omacr;"],[2,"&Odblac;"],[0,"&odblac;"],[0,"&OElig;"],[0,"&oelig;"],[0,"&Racute;"],[0,"&racute;"],[0,"&Rcedil;"],[0,"&rcedil;"],[0,"&Rcaron;"],[0,"&rcaron;"],[0,"&Sacute;"],[0,"&sacute;"],[0,"&Scirc;"],[0,"&scirc;"],[0,"&Scedil;"],[0,"&scedil;"],[0,"&Scaron;"],[0,"&scaron;"],[0,"&Tcedil;"],[0,"&tcedil;"],[0,"&Tcaron;"],[0,"&tcaron;"],[0,"&Tstrok;"],[0,"&tstrok;"],[0,"&Utilde;"],[0,"&utilde;"],[0,"&Umacr;"],[0,"&umacr;"],[0,"&Ubreve;"],[0,"&ubreve;"],[0,"&Uring;"],[0,"&uring;"],[0,"&Udblac;"],[0,"&udblac;"],[0,"&Uogon;"],[0,"&uogon;"],[0,"&Wcirc;"],[0,"&wcirc;"],[0,"&Ycirc;"],[0,"&ycirc;"],[0,"&Yuml;"],[0,"&Zacute;"],[0,"&zacute;"],[0,"&Zdot;"],[0,"&zdot;"],[0,"&Zcaron;"],[0,"&zcaron;"],[19,"&fnof;"],[34,"&imped;"],[63,"&gacute;"],[65,"&jmath;"],[142,"&circ;"],[0,"&caron;"],[16,"&breve;"],[0,"&DiacriticalDot;"],[0,"&ring;"],[0,"&ogon;"],[0,"&DiacriticalTilde;"],[0,"&dblac;"],[51,"&DownBreve;"],[127,"&Alpha;"],[0,"&Beta;"],[0,"&Gamma;"],[0,"&Delta;"],[0,"&Epsilon;"],[0,"&Zeta;"],[0,"&Eta;"],[0,"&Theta;"],[0,"&Iota;"],[0,"&Kappa;"],[0,"&Lambda;"],[0,"&Mu;"],[0,"&Nu;"],[0,"&Xi;"],[0,"&Omicron;"],[0,"&Pi;"],[0,"&Rho;"],[1,"&Sigma;"],[0,"&Tau;"],[0,"&Upsilon;"],[0,"&Phi;"],[0,"&Chi;"],[0,"&Psi;"],[0,"&ohm;"],[7,"&alpha;"],[0,"&beta;"],[0,"&gamma;"],[0,"&delta;"],[0,"&epsi;"],[0,"&zeta;"],[0,"&eta;"],[0,"&theta;"],[0,"&iota;"],[0,"&kappa;"],[0,"&lambda;"],[0,"&mu;"],[0,"&nu;"],[0,"&xi;"],[0,"&omicron;"],[0,"&pi;"],[0,"&rho;"],[0,"&sigmaf;"],[0,"&sigma;"],[0,"&tau;"],[0,"&upsi;"],[0,"&phi;"],[0,"&chi;"],[0,"&psi;"],[0,"&omega;"],[7,"&thetasym;"],[0,"&Upsi;"],[2,"&phiv;"],[0,"&piv;"],[5,"&Gammad;"],[0,"&digamma;"],[18,"&kappav;"],[0,"&rhov;"],[3,"&epsiv;"],[0,"&backepsilon;"],[10,"&IOcy;"],[0,"&DJcy;"],[0,"&GJcy;"],[0,"&Jukcy;"],[0,"&DScy;"],[0,"&Iukcy;"],[0,"&YIcy;"],[0,"&Jsercy;"],[0,"&LJcy;"],[0,"&NJcy;"],[0,"&TSHcy;"],[0,"&KJcy;"],[1,"&Ubrcy;"],[0,"&DZcy;"],[0,"&Acy;"],[0,"&Bcy;"],[0,"&Vcy;"],[0,"&Gcy;"],[0,"&Dcy;"],[0,"&IEcy;"],[0,"&ZHcy;"],[0,"&Zcy;"],[0,"&Icy;"],[0,"&Jcy;"],[0,"&Kcy;"],[0,"&Lcy;"],[0,"&Mcy;"],[0,"&Ncy;"],[0,"&Ocy;"],[0,"&Pcy;"],[0,"&Rcy;"],[0,"&Scy;"],[0,"&Tcy;"],[0,"&Ucy;"],[0,"&Fcy;"],[0,"&KHcy;"],[0,"&TScy;"],[0,"&CHcy;"],[0,"&SHcy;"],[0,"&SHCHcy;"],[0,"&HARDcy;"],[0,"&Ycy;"],[0,"&SOFTcy;"],[0,"&Ecy;"],[0,"&YUcy;"],[0,"&YAcy;"],[0,"&acy;"],[0,"&bcy;"],[0,"&vcy;"],[0,"&gcy;"],[0,"&dcy;"],[0,"&iecy;"],[0,"&zhcy;"],[0,"&zcy;"],[0,"&icy;"],[0,"&jcy;"],[0,"&kcy;"],[0,"&lcy;"],[0,"&mcy;"],[0,"&ncy;"],[0,"&ocy;"],[0,"&pcy;"],[0,"&rcy;"],[0,"&scy;"],[0,"&tcy;"],[0,"&ucy;"],[0,"&fcy;"],[0,"&khcy;"],[0,"&tscy;"],[0,"&chcy;"],[0,"&shcy;"],[0,"&shchcy;"],[0,"&hardcy;"],[0,"&ycy;"],[0,"&softcy;"],[0,"&ecy;"],[0,"&yucy;"],[0,"&yacy;"],[1,"&iocy;"],[0,"&djcy;"],[0,"&gjcy;"],[0,"&jukcy;"],[0,"&dscy;"],[0,"&iukcy;"],[0,"&yicy;"],[0,"&jsercy;"],[0,"&ljcy;"],[0,"&njcy;"],[0,"&tshcy;"],[0,"&kjcy;"],[1,"&ubrcy;"],[0,"&dzcy;"],[7074,"&ensp;"],[0,"&emsp;"],[0,"&emsp13;"],[0,"&emsp14;"],[1,"&numsp;"],[0,"&puncsp;"],[0,"&ThinSpace;"],[0,"&hairsp;"],[0,"&NegativeMediumSpace;"],[0,"&zwnj;"],[0,"&zwj;"],[0,"&lrm;"],[0,"&rlm;"],[0,"&dash;"],[2,"&ndash;"],[0,"&mdash;"],[0,"&horbar;"],[0,"&Verbar;"],[1,"&lsquo;"],[0,"&CloseCurlyQuote;"],[0,"&lsquor;"],[1,"&ldquo;"],[0,"&CloseCurlyDoubleQuote;"],[0,"&bdquo;"],[1,"&dagger;"],[0,"&Dagger;"],[0,"&bull;"],[2,"&nldr;"],[0,"&hellip;"],[9,"&permil;"],[0,"&pertenk;"],[0,"&prime;"],[0,"&Prime;"],[0,"&tprime;"],[0,"&backprime;"],[3,"&lsaquo;"],[0,"&rsaquo;"],[3,"&oline;"],[2,"&caret;"],[1,"&hybull;"],[0,"&frasl;"],[10,"&bsemi;"],[7,"&qprime;"],[7,{v:"&MediumSpace;",n:8202,o:"&ThickSpace;"}],[0,"&NoBreak;"],[0,"&af;"],[0,"&InvisibleTimes;"],[0,"&ic;"],[72,"&euro;"],[46,"&tdot;"],[0,"&DotDot;"],[37,"&complexes;"],[2,"&incare;"],[4,"&gscr;"],[0,"&hamilt;"],[0,"&Hfr;"],[0,"&Hopf;"],[0,"&planckh;"],[0,"&hbar;"],[0,"&imagline;"],[0,"&Ifr;"],[0,"&lagran;"],[0,"&ell;"],[1,"&naturals;"],[0,"&numero;"],[0,"&copysr;"],[0,"&weierp;"],[0,"&Popf;"],[0,"&Qopf;"],[0,"&realine;"],[0,"&real;"],[0,"&reals;"],[0,"&rx;"],[3,"&trade;"],[1,"&integers;"],[2,"&mho;"],[0,"&zeetrf;"],[0,"&iiota;"],[2,"&bernou;"],[0,"&Cayleys;"],[1,"&escr;"],[0,"&Escr;"],[0,"&Fouriertrf;"],[1,"&Mellintrf;"],[0,"&order;"],[0,"&alefsym;"],[0,"&beth;"],[0,"&gimel;"],[0,"&daleth;"],[12,"&CapitalDifferentialD;"],[0,"&dd;"],[0,"&ee;"],[0,"&ii;"],[10,"&frac13;"],[0,"&frac23;"],[0,"&frac15;"],[0,"&frac25;"],[0,"&frac35;"],[0,"&frac45;"],[0,"&frac16;"],[0,"&frac56;"],[0,"&frac18;"],[0,"&frac38;"],[0,"&frac58;"],[0,"&frac78;"],[49,"&larr;"],[0,"&ShortUpArrow;"],[0,"&rarr;"],[0,"&darr;"],[0,"&harr;"],[0,"&updownarrow;"],[0,"&nwarr;"],[0,"&nearr;"],[0,"&LowerRightArrow;"],[0,"&LowerLeftArrow;"],[0,"&nlarr;"],[0,"&nrarr;"],[1,{v:"&rarrw;",n:824,o:"&nrarrw;"}],[0,"&Larr;"],[0,"&Uarr;"],[0,"&Rarr;"],[0,"&Darr;"],[0,"&larrtl;"],[0,"&rarrtl;"],[0,"&LeftTeeArrow;"],[0,"&mapstoup;"],[0,"&map;"],[0,"&DownTeeArrow;"],[1,"&hookleftarrow;"],[0,"&hookrightarrow;"],[0,"&larrlp;"],[0,"&looparrowright;"],[0,"&harrw;"],[0,"&nharr;"],[1,"&lsh;"],[0,"&rsh;"],[0,"&ldsh;"],[0,"&rdsh;"],[1,"&crarr;"],[0,"&cularr;"],[0,"&curarr;"],[2,"&circlearrowleft;"],[0,"&circlearrowright;"],[0,"&leftharpoonup;"],[0,"&DownLeftVector;"],[0,"&RightUpVector;"],[0,"&LeftUpVector;"],[0,"&rharu;"],[0,"&DownRightVector;"],[0,"&dharr;"],[0,"&dharl;"],[0,"&RightArrowLeftArrow;"],[0,"&udarr;"],[0,"&LeftArrowRightArrow;"],[0,"&leftleftarrows;"],[0,"&upuparrows;"],[0,"&rightrightarrows;"],[0,"&ddarr;"],[0,"&leftrightharpoons;"],[0,"&Equilibrium;"],[0,"&nlArr;"],[0,"&nhArr;"],[0,"&nrArr;"],[0,"&DoubleLeftArrow;"],[0,"&DoubleUpArrow;"],[0,"&DoubleRightArrow;"],[0,"&dArr;"],[0,"&DoubleLeftRightArrow;"],[0,"&DoubleUpDownArrow;"],[0,"&nwArr;"],[0,"&neArr;"],[0,"&seArr;"],[0,"&swArr;"],[0,"&lAarr;"],[0,"&rAarr;"],[1,"&zigrarr;"],[6,"&larrb;"],[0,"&rarrb;"],[15,"&DownArrowUpArrow;"],[7,"&loarr;"],[0,"&roarr;"],[0,"&hoarr;"],[0,"&forall;"],[0,"&comp;"],[0,{v:"&part;",n:824,o:"&npart;"}],[0,"&exist;"],[0,"&nexist;"],[0,"&empty;"],[1,"&Del;"],[0,"&Element;"],[0,"&NotElement;"],[1,"&ni;"],[0,"&notni;"],[2,"&prod;"],[0,"&coprod;"],[0,"&sum;"],[0,"&minus;"],[0,"&MinusPlus;"],[0,"&dotplus;"],[1,"&Backslash;"],[0,"&lowast;"],[0,"&compfn;"],[1,"&radic;"],[2,"&prop;"],[0,"&infin;"],[0,"&angrt;"],[0,{v:"&ang;",n:8402,o:"&nang;"}],[0,"&angmsd;"],[0,"&angsph;"],[0,"&mid;"],[0,"&nmid;"],[0,"&DoubleVerticalBar;"],[0,"&NotDoubleVerticalBar;"],[0,"&and;"],[0,"&or;"],[0,{v:"&cap;",n:65024,o:"&caps;"}],[0,{v:"&cup;",n:65024,o:"&cups;"}],[0,"&int;"],[0,"&Int;"],[0,"&iiint;"],[0,"&conint;"],[0,"&Conint;"],[0,"&Cconint;"],[0,"&cwint;"],[0,"&ClockwiseContourIntegral;"],[0,"&awconint;"],[0,"&there4;"],[0,"&becaus;"],[0,"&ratio;"],[0,"&Colon;"],[0,"&dotminus;"],[1,"&mDDot;"],[0,"&homtht;"],[0,{v:"&sim;",n:8402,o:"&nvsim;"}],[0,{v:"&backsim;",n:817,o:"&race;"}],[0,{v:"&ac;",n:819,o:"&acE;"}],[0,"&acd;"],[0,"&VerticalTilde;"],[0,"&NotTilde;"],[0,{v:"&eqsim;",n:824,o:"&nesim;"}],[0,"&sime;"],[0,"&NotTildeEqual;"],[0,"&cong;"],[0,"&simne;"],[0,"&ncong;"],[0,"&ap;"],[0,"&nap;"],[0,"&ape;"],[0,{v:"&apid;",n:824,o:"&napid;"}],[0,"&backcong;"],[0,{v:"&asympeq;",n:8402,o:"&nvap;"}],[0,{v:"&bump;",n:824,o:"&nbump;"}],[0,{v:"&bumpe;",n:824,o:"&nbumpe;"}],[0,{v:"&doteq;",n:824,o:"&nedot;"}],[0,"&doteqdot;"],[0,"&efDot;"],[0,"&erDot;"],[0,"&Assign;"],[0,"&ecolon;"],[0,"&ecir;"],[0,"&circeq;"],[1,"&wedgeq;"],[0,"&veeeq;"],[1,"&triangleq;"],[2,"&equest;"],[0,"&ne;"],[0,{v:"&Congruent;",n:8421,o:"&bnequiv;"}],[0,"&nequiv;"],[1,{v:"&le;",n:8402,o:"&nvle;"}],[0,{v:"&ge;",n:8402,o:"&nvge;"}],[0,{v:"&lE;",n:824,o:"&nlE;"}],[0,{v:"&gE;",n:824,o:"&ngE;"}],[0,{v:"&lnE;",n:65024,o:"&lvertneqq;"}],[0,{v:"&gnE;",n:65024,o:"&gvertneqq;"}],[0,{v:"&ll;",n:new Map(r([[824,"&nLtv;"],[7577,"&nLt;"]]))}],[0,{v:"&gg;",n:new Map(r([[824,"&nGtv;"],[7577,"&nGt;"]]))}],[0,"&between;"],[0,"&NotCupCap;"],[0,"&nless;"],[0,"&ngt;"],[0,"&nle;"],[0,"&nge;"],[0,"&lesssim;"],[0,"&GreaterTilde;"],[0,"&nlsim;"],[0,"&ngsim;"],[0,"&LessGreater;"],[0,"&gl;"],[0,"&NotLessGreater;"],[0,"&NotGreaterLess;"],[0,"&pr;"],[0,"&sc;"],[0,"&prcue;"],[0,"&sccue;"],[0,"&PrecedesTilde;"],[0,{v:"&scsim;",n:824,o:"&NotSucceedsTilde;"}],[0,"&NotPrecedes;"],[0,"&NotSucceeds;"],[0,{v:"&sub;",n:8402,o:"&NotSubset;"}],[0,{v:"&sup;",n:8402,o:"&NotSuperset;"}],[0,"&nsub;"],[0,"&nsup;"],[0,"&sube;"],[0,"&supe;"],[0,"&NotSubsetEqual;"],[0,"&NotSupersetEqual;"],[0,{v:"&subne;",n:65024,o:"&varsubsetneq;"}],[0,{v:"&supne;",n:65024,o:"&varsupsetneq;"}],[1,"&cupdot;"],[0,"&UnionPlus;"],[0,{v:"&sqsub;",n:824,o:"&NotSquareSubset;"}],[0,{v:"&sqsup;",n:824,o:"&NotSquareSuperset;"}],[0,"&sqsube;"],[0,"&sqsupe;"],[0,{v:"&sqcap;",n:65024,o:"&sqcaps;"}],[0,{v:"&sqcup;",n:65024,o:"&sqcups;"}],[0,"&CirclePlus;"],[0,"&CircleMinus;"],[0,"&CircleTimes;"],[0,"&osol;"],[0,"&CircleDot;"],[0,"&circledcirc;"],[0,"&circledast;"],[1,"&circleddash;"],[0,"&boxplus;"],[0,"&boxminus;"],[0,"&boxtimes;"],[0,"&dotsquare;"],[0,"&RightTee;"],[0,"&dashv;"],[0,"&DownTee;"],[0,"&bot;"],[1,"&models;"],[0,"&DoubleRightTee;"],[0,"&Vdash;"],[0,"&Vvdash;"],[0,"&VDash;"],[0,"&nvdash;"],[0,"&nvDash;"],[0,"&nVdash;"],[0,"&nVDash;"],[0,"&prurel;"],[1,"&LeftTriangle;"],[0,"&RightTriangle;"],[0,{v:"&LeftTriangleEqual;",n:8402,o:"&nvltrie;"}],[0,{v:"&RightTriangleEqual;",n:8402,o:"&nvrtrie;"}],[0,"&origof;"],[0,"&imof;"],[0,"&multimap;"],[0,"&hercon;"],[0,"&intcal;"],[0,"&veebar;"],[1,"&barvee;"],[0,"&angrtvb;"],[0,"&lrtri;"],[0,"&bigwedge;"],[0,"&bigvee;"],[0,"&bigcap;"],[0,"&bigcup;"],[0,"&diam;"],[0,"&sdot;"],[0,"&sstarf;"],[0,"&divideontimes;"],[0,"&bowtie;"],[0,"&ltimes;"],[0,"&rtimes;"],[0,"&leftthreetimes;"],[0,"&rightthreetimes;"],[0,"&backsimeq;"],[0,"&curlyvee;"],[0,"&curlywedge;"],[0,"&Sub;"],[0,"&Sup;"],[0,"&Cap;"],[0,"&Cup;"],[0,"&fork;"],[0,"&epar;"],[0,"&lessdot;"],[0,"&gtdot;"],[0,{v:"&Ll;",n:824,o:"&nLl;"}],[0,{v:"&Gg;",n:824,o:"&nGg;"}],[0,{v:"&leg;",n:65024,o:"&lesg;"}],[0,{v:"&gel;",n:65024,o:"&gesl;"}],[2,"&cuepr;"],[0,"&cuesc;"],[0,"&NotPrecedesSlantEqual;"],[0,"&NotSucceedsSlantEqual;"],[0,"&NotSquareSubsetEqual;"],[0,"&NotSquareSupersetEqual;"],[2,"&lnsim;"],[0,"&gnsim;"],[0,"&precnsim;"],[0,"&scnsim;"],[0,"&nltri;"],[0,"&NotRightTriangle;"],[0,"&nltrie;"],[0,"&NotRightTriangleEqual;"],[0,"&vellip;"],[0,"&ctdot;"],[0,"&utdot;"],[0,"&dtdot;"],[0,"&disin;"],[0,"&isinsv;"],[0,"&isins;"],[0,{v:"&isindot;",n:824,o:"&notindot;"}],[0,"&notinvc;"],[0,"&notinvb;"],[1,{v:"&isinE;",n:824,o:"&notinE;"}],[0,"&nisd;"],[0,"&xnis;"],[0,"&nis;"],[0,"&notnivc;"],[0,"&notnivb;"],[6,"&barwed;"],[0,"&Barwed;"],[1,"&lceil;"],[0,"&rceil;"],[0,"&LeftFloor;"],[0,"&rfloor;"],[0,"&drcrop;"],[0,"&dlcrop;"],[0,"&urcrop;"],[0,"&ulcrop;"],[0,"&bnot;"],[1,"&profline;"],[0,"&profsurf;"],[1,"&telrec;"],[0,"&target;"],[5,"&ulcorn;"],[0,"&urcorn;"],[0,"&dlcorn;"],[0,"&drcorn;"],[2,"&frown;"],[0,"&smile;"],[9,"&cylcty;"],[0,"&profalar;"],[7,"&topbot;"],[6,"&ovbar;"],[1,"&solbar;"],[60,"&angzarr;"],[51,"&lmoustache;"],[0,"&rmoustache;"],[2,"&OverBracket;"],[0,"&bbrk;"],[0,"&bbrktbrk;"],[37,"&OverParenthesis;"],[0,"&UnderParenthesis;"],[0,"&OverBrace;"],[0,"&UnderBrace;"],[2,"&trpezium;"],[4,"&elinters;"],[59,"&blank;"],[164,"&circledS;"],[55,"&boxh;"],[1,"&boxv;"],[9,"&boxdr;"],[3,"&boxdl;"],[3,"&boxur;"],[3,"&boxul;"],[3,"&boxvr;"],[7,"&boxvl;"],[7,"&boxhd;"],[7,"&boxhu;"],[7,"&boxvh;"],[19,"&boxH;"],[0,"&boxV;"],[0,"&boxdR;"],[0,"&boxDr;"],[0,"&boxDR;"],[0,"&boxdL;"],[0,"&boxDl;"],[0,"&boxDL;"],[0,"&boxuR;"],[0,"&boxUr;"],[0,"&boxUR;"],[0,"&boxuL;"],[0,"&boxUl;"],[0,"&boxUL;"],[0,"&boxvR;"],[0,"&boxVr;"],[0,"&boxVR;"],[0,"&boxvL;"],[0,"&boxVl;"],[0,"&boxVL;"],[0,"&boxHd;"],[0,"&boxhD;"],[0,"&boxHD;"],[0,"&boxHu;"],[0,"&boxhU;"],[0,"&boxHU;"],[0,"&boxvH;"],[0,"&boxVh;"],[0,"&boxVH;"],[19,"&uhblk;"],[3,"&lhblk;"],[3,"&block;"],[8,"&blk14;"],[0,"&blk12;"],[0,"&blk34;"],[13,"&square;"],[8,"&blacksquare;"],[0,"&EmptyVerySmallSquare;"],[1,"&rect;"],[0,"&marker;"],[2,"&fltns;"],[1,"&bigtriangleup;"],[0,"&blacktriangle;"],[0,"&triangle;"],[2,"&blacktriangleright;"],[0,"&rtri;"],[3,"&bigtriangledown;"],[0,"&blacktriangledown;"],[0,"&dtri;"],[2,"&blacktriangleleft;"],[0,"&ltri;"],[6,"&loz;"],[0,"&cir;"],[32,"&tridot;"],[2,"&bigcirc;"],[8,"&ultri;"],[0,"&urtri;"],[0,"&lltri;"],[0,"&EmptySmallSquare;"],[0,"&FilledSmallSquare;"],[8,"&bigstar;"],[0,"&star;"],[7,"&phone;"],[49,"&female;"],[1,"&male;"],[29,"&spades;"],[2,"&clubs;"],[1,"&hearts;"],[0,"&diamondsuit;"],[3,"&sung;"],[2,"&flat;"],[0,"&natural;"],[0,"&sharp;"],[163,"&check;"],[3,"&cross;"],[8,"&malt;"],[21,"&sext;"],[33,"&VerticalSeparator;"],[25,"&lbbrk;"],[0,"&rbbrk;"],[84,"&bsolhsub;"],[0,"&suphsol;"],[28,"&LeftDoubleBracket;"],[0,"&RightDoubleBracket;"],[0,"&lang;"],[0,"&rang;"],[0,"&Lang;"],[0,"&Rang;"],[0,"&loang;"],[0,"&roang;"],[7,"&longleftarrow;"],[0,"&longrightarrow;"],[0,"&longleftrightarrow;"],[0,"&DoubleLongLeftArrow;"],[0,"&DoubleLongRightArrow;"],[0,"&DoubleLongLeftRightArrow;"],[1,"&longmapsto;"],[2,"&dzigrarr;"],[258,"&nvlArr;"],[0,"&nvrArr;"],[0,"&nvHarr;"],[0,"&Map;"],[6,"&lbarr;"],[0,"&bkarow;"],[0,"&lBarr;"],[0,"&dbkarow;"],[0,"&drbkarow;"],[0,"&DDotrahd;"],[0,"&UpArrowBar;"],[0,"&DownArrowBar;"],[2,"&Rarrtl;"],[2,"&latail;"],[0,"&ratail;"],[0,"&lAtail;"],[0,"&rAtail;"],[0,"&larrfs;"],[0,"&rarrfs;"],[0,"&larrbfs;"],[0,"&rarrbfs;"],[2,"&nwarhk;"],[0,"&nearhk;"],[0,"&hksearow;"],[0,"&hkswarow;"],[0,"&nwnear;"],[0,"&nesear;"],[0,"&seswar;"],[0,"&swnwar;"],[8,{v:"&rarrc;",n:824,o:"&nrarrc;"}],[1,"&cudarrr;"],[0,"&ldca;"],[0,"&rdca;"],[0,"&cudarrl;"],[0,"&larrpl;"],[2,"&curarrm;"],[0,"&cularrp;"],[7,"&rarrpl;"],[2,"&harrcir;"],[0,"&Uarrocir;"],[0,"&lurdshar;"],[0,"&ldrushar;"],[2,"&LeftRightVector;"],[0,"&RightUpDownVector;"],[0,"&DownLeftRightVector;"],[0,"&LeftUpDownVector;"],[0,"&LeftVectorBar;"],[0,"&RightVectorBar;"],[0,"&RightUpVectorBar;"],[0,"&RightDownVectorBar;"],[0,"&DownLeftVectorBar;"],[0,"&DownRightVectorBar;"],[0,"&LeftUpVectorBar;"],[0,"&LeftDownVectorBar;"],[0,"&LeftTeeVector;"],[0,"&RightTeeVector;"],[0,"&RightUpTeeVector;"],[0,"&RightDownTeeVector;"],[0,"&DownLeftTeeVector;"],[0,"&DownRightTeeVector;"],[0,"&LeftUpTeeVector;"],[0,"&LeftDownTeeVector;"],[0,"&lHar;"],[0,"&uHar;"],[0,"&rHar;"],[0,"&dHar;"],[0,"&luruhar;"],[0,"&ldrdhar;"],[0,"&ruluhar;"],[0,"&rdldhar;"],[0,"&lharul;"],[0,"&llhard;"],[0,"&rharul;"],[0,"&lrhard;"],[0,"&udhar;"],[0,"&duhar;"],[0,"&RoundImplies;"],[0,"&erarr;"],[0,"&simrarr;"],[0,"&larrsim;"],[0,"&rarrsim;"],[0,"&rarrap;"],[0,"&ltlarr;"],[1,"&gtrarr;"],[0,"&subrarr;"],[1,"&suplarr;"],[0,"&lfisht;"],[0,"&rfisht;"],[0,"&ufisht;"],[0,"&dfisht;"],[5,"&lopar;"],[0,"&ropar;"],[4,"&lbrke;"],[0,"&rbrke;"],[0,"&lbrkslu;"],[0,"&rbrksld;"],[0,"&lbrksld;"],[0,"&rbrkslu;"],[0,"&langd;"],[0,"&rangd;"],[0,"&lparlt;"],[0,"&rpargt;"],[0,"&gtlPar;"],[0,"&ltrPar;"],[3,"&vzigzag;"],[1,"&vangrt;"],[0,"&angrtvbd;"],[6,"&ange;"],[0,"&range;"],[0,"&dwangle;"],[0,"&uwangle;"],[0,"&angmsdaa;"],[0,"&angmsdab;"],[0,"&angmsdac;"],[0,"&angmsdad;"],[0,"&angmsdae;"],[0,"&angmsdaf;"],[0,"&angmsdag;"],[0,"&angmsdah;"],[0,"&bemptyv;"],[0,"&demptyv;"],[0,"&cemptyv;"],[0,"&raemptyv;"],[0,"&laemptyv;"],[0,"&ohbar;"],[0,"&omid;"],[0,"&opar;"],[1,"&operp;"],[1,"&olcross;"],[0,"&odsold;"],[1,"&olcir;"],[0,"&ofcir;"],[0,"&olt;"],[0,"&ogt;"],[0,"&cirscir;"],[0,"&cirE;"],[0,"&solb;"],[0,"&bsolb;"],[3,"&boxbox;"],[3,"&trisb;"],[0,"&rtriltri;"],[0,{v:"&LeftTriangleBar;",n:824,o:"&NotLeftTriangleBar;"}],[0,{v:"&RightTriangleBar;",n:824,o:"&NotRightTriangleBar;"}],[11,"&iinfin;"],[0,"&infintie;"],[0,"&nvinfin;"],[4,"&eparsl;"],[0,"&smeparsl;"],[0,"&eqvparsl;"],[5,"&blacklozenge;"],[8,"&RuleDelayed;"],[1,"&dsol;"],[9,"&bigodot;"],[0,"&bigoplus;"],[0,"&bigotimes;"],[1,"&biguplus;"],[1,"&bigsqcup;"],[5,"&iiiint;"],[0,"&fpartint;"],[2,"&cirfnint;"],[0,"&awint;"],[0,"&rppolint;"],[0,"&scpolint;"],[0,"&npolint;"],[0,"&pointint;"],[0,"&quatint;"],[0,"&intlarhk;"],[10,"&pluscir;"],[0,"&plusacir;"],[0,"&simplus;"],[0,"&plusdu;"],[0,"&plussim;"],[0,"&plustwo;"],[1,"&mcomma;"],[0,"&minusdu;"],[2,"&loplus;"],[0,"&roplus;"],[0,"&Cross;"],[0,"&timesd;"],[0,"&timesbar;"],[1,"&smashp;"],[0,"&lotimes;"],[0,"&rotimes;"],[0,"&otimesas;"],[0,"&Otimes;"],[0,"&odiv;"],[0,"&triplus;"],[0,"&triminus;"],[0,"&tritime;"],[0,"&intprod;"],[2,"&amalg;"],[0,"&capdot;"],[1,"&ncup;"],[0,"&ncap;"],[0,"&capand;"],[0,"&cupor;"],[0,"&cupcap;"],[0,"&capcup;"],[0,"&cupbrcap;"],[0,"&capbrcup;"],[0,"&cupcup;"],[0,"&capcap;"],[0,"&ccups;"],[0,"&ccaps;"],[2,"&ccupssm;"],[2,"&And;"],[0,"&Or;"],[0,"&andand;"],[0,"&oror;"],[0,"&orslope;"],[0,"&andslope;"],[1,"&andv;"],[0,"&orv;"],[0,"&andd;"],[0,"&ord;"],[1,"&wedbar;"],[6,"&sdote;"],[3,"&simdot;"],[2,{v:"&congdot;",n:824,o:"&ncongdot;"}],[0,"&easter;"],[0,"&apacir;"],[0,{v:"&apE;",n:824,o:"&napE;"}],[0,"&eplus;"],[0,"&pluse;"],[0,"&Esim;"],[0,"&Colone;"],[0,"&Equal;"],[1,"&ddotseq;"],[0,"&equivDD;"],[0,"&ltcir;"],[0,"&gtcir;"],[0,"&ltquest;"],[0,"&gtquest;"],[0,{v:"&leqslant;",n:824,o:"&nleqslant;"}],[0,{v:"&geqslant;",n:824,o:"&ngeqslant;"}],[0,"&lesdot;"],[0,"&gesdot;"],[0,"&lesdoto;"],[0,"&gesdoto;"],[0,"&lesdotor;"],[0,"&gesdotol;"],[0,"&lap;"],[0,"&gap;"],[0,"&lne;"],[0,"&gne;"],[0,"&lnap;"],[0,"&gnap;"],[0,"&lEg;"],[0,"&gEl;"],[0,"&lsime;"],[0,"&gsime;"],[0,"&lsimg;"],[0,"&gsiml;"],[0,"&lgE;"],[0,"&glE;"],[0,"&lesges;"],[0,"&gesles;"],[0,"&els;"],[0,"&egs;"],[0,"&elsdot;"],[0,"&egsdot;"],[0,"&el;"],[0,"&eg;"],[2,"&siml;"],[0,"&simg;"],[0,"&simlE;"],[0,"&simgE;"],[0,{v:"&LessLess;",n:824,o:"&NotNestedLessLess;"}],[0,{v:"&GreaterGreater;",n:824,o:"&NotNestedGreaterGreater;"}],[1,"&glj;"],[0,"&gla;"],[0,"&ltcc;"],[0,"&gtcc;"],[0,"&lescc;"],[0,"&gescc;"],[0,"&smt;"],[0,"&lat;"],[0,{v:"&smte;",n:65024,o:"&smtes;"}],[0,{v:"&late;",n:65024,o:"&lates;"}],[0,"&bumpE;"],[0,{v:"&PrecedesEqual;",n:824,o:"&NotPrecedesEqual;"}],[0,{v:"&sce;",n:824,o:"&NotSucceedsEqual;"}],[2,"&prE;"],[0,"&scE;"],[0,"&precneqq;"],[0,"&scnE;"],[0,"&prap;"],[0,"&scap;"],[0,"&precnapprox;"],[0,"&scnap;"],[0,"&Pr;"],[0,"&Sc;"],[0,"&subdot;"],[0,"&supdot;"],[0,"&subplus;"],[0,"&supplus;"],[0,"&submult;"],[0,"&supmult;"],[0,"&subedot;"],[0,"&supedot;"],[0,{v:"&subE;",n:824,o:"&nsubE;"}],[0,{v:"&supE;",n:824,o:"&nsupE;"}],[0,"&subsim;"],[0,"&supsim;"],[2,{v:"&subnE;",n:65024,o:"&varsubsetneqq;"}],[0,{v:"&supnE;",n:65024,o:"&varsupsetneqq;"}],[2,"&csub;"],[0,"&csup;"],[0,"&csube;"],[0,"&csupe;"],[0,"&subsup;"],[0,"&supsub;"],[0,"&subsub;"],[0,"&supsup;"],[0,"&suphsub;"],[0,"&supdsub;"],[0,"&forkv;"],[0,"&topfork;"],[0,"&mlcp;"],[8,"&Dashv;"],[1,"&Vdashl;"],[0,"&Barv;"],[0,"&vBar;"],[0,"&vBarv;"],[1,"&Vbar;"],[0,"&Not;"],[0,"&bNot;"],[0,"&rnmid;"],[0,"&cirmid;"],[0,"&midcir;"],[0,"&topcir;"],[0,"&nhpar;"],[0,"&parsim;"],[9,{v:"&parsl;",n:8421,o:"&nparsl;"}],[44343,{n:new Map(r([[56476,"&Ascr;"],[1,"&Cscr;"],[0,"&Dscr;"],[2,"&Gscr;"],[2,"&Jscr;"],[0,"&Kscr;"],[2,"&Nscr;"],[0,"&Oscr;"],[0,"&Pscr;"],[0,"&Qscr;"],[1,"&Sscr;"],[0,"&Tscr;"],[0,"&Uscr;"],[0,"&Vscr;"],[0,"&Wscr;"],[0,"&Xscr;"],[0,"&Yscr;"],[0,"&Zscr;"],[0,"&ascr;"],[0,"&bscr;"],[0,"&cscr;"],[0,"&dscr;"],[1,"&fscr;"],[1,"&hscr;"],[0,"&iscr;"],[0,"&jscr;"],[0,"&kscr;"],[0,"&lscr;"],[0,"&mscr;"],[0,"&nscr;"],[1,"&pscr;"],[0,"&qscr;"],[0,"&rscr;"],[0,"&sscr;"],[0,"&tscr;"],[0,"&uscr;"],[0,"&vscr;"],[0,"&wscr;"],[0,"&xscr;"],[0,"&yscr;"],[0,"&zscr;"],[52,"&Afr;"],[0,"&Bfr;"],[1,"&Dfr;"],[0,"&Efr;"],[0,"&Ffr;"],[0,"&Gfr;"],[2,"&Jfr;"],[0,"&Kfr;"],[0,"&Lfr;"],[0,"&Mfr;"],[0,"&Nfr;"],[0,"&Ofr;"],[0,"&Pfr;"],[0,"&Qfr;"],[1,"&Sfr;"],[0,"&Tfr;"],[0,"&Ufr;"],[0,"&Vfr;"],[0,"&Wfr;"],[0,"&Xfr;"],[0,"&Yfr;"],[1,"&afr;"],[0,"&bfr;"],[0,"&cfr;"],[0,"&dfr;"],[0,"&efr;"],[0,"&ffr;"],[0,"&gfr;"],[0,"&hfr;"],[0,"&ifr;"],[0,"&jfr;"],[0,"&kfr;"],[0,"&lfr;"],[0,"&mfr;"],[0,"&nfr;"],[0,"&ofr;"],[0,"&pfr;"],[0,"&qfr;"],[0,"&rfr;"],[0,"&sfr;"],[0,"&tfr;"],[0,"&ufr;"],[0,"&vfr;"],[0,"&wfr;"],[0,"&xfr;"],[0,"&yfr;"],[0,"&zfr;"],[0,"&Aopf;"],[0,"&Bopf;"],[1,"&Dopf;"],[0,"&Eopf;"],[0,"&Fopf;"],[0,"&Gopf;"],[1,"&Iopf;"],[0,"&Jopf;"],[0,"&Kopf;"],[0,"&Lopf;"],[0,"&Mopf;"],[1,"&Oopf;"],[3,"&Sopf;"],[0,"&Topf;"],[0,"&Uopf;"],[0,"&Vopf;"],[0,"&Wopf;"],[0,"&Xopf;"],[0,"&Yopf;"],[1,"&aopf;"],[0,"&bopf;"],[0,"&copf;"],[0,"&dopf;"],[0,"&eopf;"],[0,"&fopf;"],[0,"&gopf;"],[0,"&hopf;"],[0,"&iopf;"],[0,"&jopf;"],[0,"&kopf;"],[0,"&lopf;"],[0,"&mopf;"],[0,"&nopf;"],[0,"&oopf;"],[0,"&popf;"],[0,"&qopf;"],[0,"&ropf;"],[0,"&sopf;"],[0,"&topf;"],[0,"&uopf;"],[0,"&vopf;"],[0,"&wopf;"],[0,"&xopf;"],[0,"&yopf;"],[0,"&zopf;"]]))}],[8906,"&fflig;"],[0,"&filig;"],[0,"&fllig;"],[0,"&ffilig;"],[0,"&ffllig;"]]))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attributeNames=t.elementNames=void 0,t.elementNames=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map((function(e){return[e.toLowerCase(),e]}))),t.attributeNames=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map((function(e){return[e.toLowerCase(),e]})))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prevElementSibling=t.nextElementSibling=t.getName=t.hasAttrib=t.getAttributeValue=t.getSiblings=t.getParent=t.getChildren=void 0;var r=n(155);function i(e){return(0,r.hasChildren)(e)?e.children:[]}function o(e){return e.parent||null}t.getChildren=i,t.getParent=o,t.getSiblings=function(e){var t=o(e);if(null!=t)return i(t);for(var n=[e],r=e.prev,s=e.next;null!=r;)n.unshift(r),r=r.prev;for(;null!=s;)n.push(s),s=s.next;return n},t.getAttributeValue=function(e,t){var n;return null===(n=e.attribs)||void 0===n?void 0:n[t]},t.hasAttrib=function(e,t){return null!=e.attribs&&Object.prototype.hasOwnProperty.call(e.attribs,t)&&null!=e.attribs[t]},t.getName=function(e){return e.name},t.nextElementSibling=function(e){for(var t=e.next;null!==t&&!(0,r.isTag)(t);)t=t.next;return t},t.prevElementSibling=function(e){for(var t=e.prev;null!==t&&!(0,r.isTag)(t);)t=t.prev;return t}},function(e,t,n){"use strict";function r(e){if(e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.parent){var t=e.parent.children,n=t.lastIndexOf(e);n>=0&&t.splice(n,1)}e.next=null,e.prev=null,e.parent=null}Object.defineProperty(t,"__esModule",{value:!0}),t.prepend=t.prependChild=t.append=t.appendChild=t.replaceElement=t.removeElement=void 0,t.removeElement=r,t.replaceElement=function(e,t){var n=t.prev=e.prev;n&&(n.next=t);var r=t.next=e.next;r&&(r.prev=t);var i=t.parent=e.parent;if(i){var o=i.children;o[o.lastIndexOf(e)]=t,e.parent=null}},t.appendChild=function(e,t){if(r(t),t.next=null,t.parent=e,e.children.push(t)>1){var n=e.children[e.children.length-2];n.next=t,t.prev=n}else t.prev=null},t.append=function(e,t){r(t);var n=e.parent,i=e.next;if(t.next=i,t.prev=e,e.next=t,t.parent=n,i){if(i.prev=t,n){var o=n.children;o.splice(o.lastIndexOf(i),0,t)}}else n&&n.children.push(t)},t.prependChild=function(e,t){if(r(t),t.parent=e,t.prev=null,1!==e.children.unshift(t)){var n=e.children[1];n.prev=t,t.next=n}else t.next=null},t.prepend=function(e,t){r(t);var n=e.parent;if(n){var i=n.children;i.splice(i.indexOf(e),0,t)}e.prev&&(e.prev.next=t),t.parent=n,t.prev=e.prev,t.next=e,e.prev=t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uniqueSort=t.compareDocumentPosition=t.DocumentPosition=t.removeSubsets=void 0;var r,i=n(155);function o(e,t){var n=[],o=[];if(e===t)return 0;for(var s=(0,i.hasChildren)(e)?e:e.parent;s;)n.unshift(s),s=s.parent;for(s=(0,i.hasChildren)(t)?t:t.parent;s;)o.unshift(s),s=s.parent;for(var a=Math.min(n.length,o.length),c=0;c<a&&n[c]===o[c];)c++;if(0===c)return r.DISCONNECTED;var l=n[c-1],u=l.children,d=n[c],h=o[c];return u.indexOf(d)>u.indexOf(h)?l===t?r.FOLLOWING|r.CONTAINED_BY:r.FOLLOWING:l===e?r.PRECEDING|r.CONTAINS:r.PRECEDING}t.removeSubsets=function(e){for(var t=e.length;--t>=0;){var n=e[t];if(t>0&&e.lastIndexOf(n,t-1)>=0)e.splice(t,1);else for(var r=n.parent;r;r=r.parent)if(e.includes(r)){e.splice(t,1);break}}return e},function(e){e[e.DISCONNECTED=1]="DISCONNECTED",e[e.PRECEDING=2]="PRECEDING",e[e.FOLLOWING=4]="FOLLOWING",e[e.CONTAINS=8]="CONTAINS",e[e.CONTAINED_BY=16]="CONTAINED_BY"}(r=t.DocumentPosition||(t.DocumentPosition={})),t.compareDocumentPosition=o,t.uniqueSort=function(e){return(e=e.filter((function(e,t,n){return!n.includes(e,t+1)}))).sort((function(e,t){var n=o(e,t);return n&r.PRECEDING?-1:n&r.FOLLOWING?1:0})),e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFeed=void 0;var r=n(597),i=n(604);t.getFeed=function(e){var t=c(d,e);return t?"feed"===t.name?function(e){var t,n=e.children,r={type:"atom",items:(0,i.getElementsByTagName)("entry",n).map((function(e){var t,n=e.children,r={media:a(n)};u(r,"id","id",n),u(r,"title","title",n);var i=null===(t=c("link",n))||void 0===t?void 0:t.attribs.href;i&&(r.link=i);var o=l("summary",n)||l("content",n);o&&(r.description=o);var s=l("updated",n);return s&&(r.pubDate=new Date(s)),r}))};u(r,"id","id",n),u(r,"title","title",n);var o=null===(t=c("link",n))||void 0===t?void 0:t.attribs.href;o&&(r.link=o);u(r,"description","subtitle",n);var s=l("updated",n);s&&(r.updated=new Date(s));return u(r,"author","email",n,!0),r}(t):function(e){var t,n,r=null!==(n=null===(t=c("channel",e.children))||void 0===t?void 0:t.children)&&void 0!==n?n:[],o={type:e.name.substr(0,3),id:"",items:(0,i.getElementsByTagName)("item",e.children).map((function(e){var t=e.children,n={media:a(t)};u(n,"id","guid",t),u(n,"title","title",t),u(n,"link","link",t),u(n,"description","description",t);var r=l("pubDate",t)||l("dc:date",t);return r&&(n.pubDate=new Date(r)),n}))};u(o,"title","title",r),u(o,"link","link",r),u(o,"description","description",r);var s=l("lastBuildDate",r);s&&(o.updated=new Date(s));return u(o,"author","managingEditor",r,!0),o}(t):null};var o=["url","type","lang"],s=["fileSize","bitrate","framerate","samplingrate","channels","duration","height","width"];function a(e){return(0,i.getElementsByTagName)("media:content",e).map((function(e){for(var t=e.attribs,n={medium:t.medium,isDefault:!!t.isDefault},r=0,i=o;r<i.length;r++){t[l=i[r]]&&(n[l]=t[l])}for(var a=0,c=s;a<c.length;a++){var l;t[l=c[a]]&&(n[l]=parseInt(t[l],10))}return t.expression&&(n.expression=t.expression),n}))}function c(e,t){return(0,i.getElementsByTagName)(e,t,!0,1)[0]}function l(e,t,n){return void 0===n&&(n=!1),(0,r.textContent)((0,i.getElementsByTagName)(e,t,n,1)).trim()}function u(e,t,n,r,i){void 0===i&&(i=!1);var o=l(n,r,i);o&&(e[t]=o)}function d(e){return"rss"===e||"feed"===e||"rdf:RDF"===e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parse=t.isTraversal=void 0;var r=n(518),i=/^[^\\#]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,o=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,s=new Map([[126,r.AttributeAction.Element],[94,r.AttributeAction.Start],[36,r.AttributeAction.End],[42,r.AttributeAction.Any],[33,r.AttributeAction.Not],[124,r.AttributeAction.Hyphen]]),a=new Set(["has","not","matches","is","where","host","host-context"]);function c(e){switch(e.type){case r.SelectorType.Adjacent:case r.SelectorType.Child:case r.SelectorType.Descendant:case r.SelectorType.Parent:case r.SelectorType.Sibling:case r.SelectorType.ColumnCombinator:return!0;default:return!1}}t.isTraversal=c;var l=new Set(["contains","icontains"]);function u(e,t,n){var r=parseInt(t,16)-65536;return r!=r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)}function d(e){return e.replace(o,u)}function h(e){return 39===e||34===e}function f(e){return 32===e||9===e||10===e||12===e||13===e}function p(e,t,n){var o=[];function u(e){var r=t.slice(n+e).match(i);if(!r)throw new Error("Expected name, found ".concat(t.slice(n)));var o=r[0];return n+=e+o.length,d(o)}function g(e){for(n+=e;n<t.length&&f(t.charCodeAt(n));)n++}function m(){for(var e=n+=1,r=1;r>0&&n<t.length;n++)40!==t.charCodeAt(n)||y(n)?41!==t.charCodeAt(n)||y(n)||r--:r++;if(r)throw new Error("Parenthesis not matched");return d(t.slice(e,n-1))}function y(e){for(var n=0;92===t.charCodeAt(--e);)n++;return!(1&~n)}function v(){if(o.length>0&&c(o[o.length-1]))throw new Error("Did not expect successive traversals.")}function b(e){o.length>0&&o[o.length-1].type===r.SelectorType.Descendant?o[o.length-1].type=e:(v(),o.push({type:e}))}function _(e,t){o.push({type:r.SelectorType.Attribute,name:e,action:t,value:u(1),namespace:null,ignoreCase:"quirks"})}function w(){if(o.length&&o[o.length-1].type===r.SelectorType.Descendant&&o.pop(),0===o.length)throw new Error("Empty sub-selector");e.push(o)}if(g(0),t.length===n)return n;e:for(;n<t.length;){var T=t.charCodeAt(n);switch(T){case 32:case 9:case 10:case 12:case 13:0!==o.length&&o[0].type===r.SelectorType.Descendant||(v(),o.push({type:r.SelectorType.Descendant})),g(1);break;case 62:b(r.SelectorType.Child),g(1);break;case 60:b(r.SelectorType.Parent),g(1);break;case 126:b(r.SelectorType.Sibling),g(1);break;case 43:b(r.SelectorType.Adjacent),g(1);break;case 46:_("class",r.AttributeAction.Element);break;case 35:_("id",r.AttributeAction.Equals);break;case 91:g(1);var E=void 0,A=null;124===t.charCodeAt(n)?E=u(1):t.startsWith("*|",n)?(A="*",E=u(2)):(E=u(0),124===t.charCodeAt(n)&&61!==t.charCodeAt(n+1)&&(A=E,E=u(1))),g(0);var S=r.AttributeAction.Exists,O=s.get(t.charCodeAt(n));if(O){if(S=O,61!==t.charCodeAt(n+1))throw new Error("Expected `=`");g(2)}else 61===t.charCodeAt(n)&&(S=r.AttributeAction.Equals,g(1));var I="",C=null;if("exists"!==S){if(h(t.charCodeAt(n))){for(var k=t.charCodeAt(n),P=n+1;P<t.length&&(t.charCodeAt(P)!==k||y(P));)P+=1;if(t.charCodeAt(P)!==k)throw new Error("Attribute value didn't end");I=d(t.slice(n+1,P)),n=P+1}else{for(var x=n;n<t.length&&(!f(t.charCodeAt(n))&&93!==t.charCodeAt(n)||y(n));)n+=1;I=d(t.slice(x,n))}g(0);var R=32|t.charCodeAt(n);115===R?(C=!1,g(1)):105===R&&(C=!0,g(1))}if(93!==t.charCodeAt(n))throw new Error("Attribute selector didn't terminate");n+=1;var L={type:r.SelectorType.Attribute,name:E,action:S,value:I,namespace:A,ignoreCase:C};o.push(L);break;case 58:if(58===t.charCodeAt(n+1)){o.push({type:r.SelectorType.PseudoElement,name:u(2).toLowerCase(),data:40===t.charCodeAt(n)?m():null});continue}var D=u(1).toLowerCase(),N=null;if(40===t.charCodeAt(n))if(a.has(D)){if(h(t.charCodeAt(n+1)))throw new Error("Pseudo-selector ".concat(D," cannot be quoted"));if(n=p(N=[],t,n+1),41!==t.charCodeAt(n))throw new Error("Missing closing parenthesis in :".concat(D," (").concat(t,")"));n+=1}else{if(N=m(),l.has(D)){var j=N.charCodeAt(0);j===N.charCodeAt(N.length-1)&&h(j)&&(N=N.slice(1,-1))}N=d(N)}o.push({type:r.SelectorType.Pseudo,name:D,data:N});break;case 44:w(),o=[],g(1);break;default:if(t.startsWith("/*",n)){var M=t.indexOf("*/",n+2);if(M<0)throw new Error("Comment was not terminated");n=M+2,0===o.length&&g(0);break}A=null;var F=void 0;if(42===T)n+=1,F="*";else if(124===T){if(F="",124===t.charCodeAt(n+1)){b(r.SelectorType.ColumnCombinator),g(2);break}}else{if(!i.test(t.slice(n)))break e;F=u(0)}124===t.charCodeAt(n)&&124!==t.charCodeAt(n+1)&&(A=F,42===t.charCodeAt(n+1)?(F="*",n+=2):F=u(1)),o.push("*"===F?{type:r.SelectorType.Universal,namespace:A}:{type:r.SelectorType.Tag,name:F,namespace:A})}}return w(),n}t.parse=function(e){var t=[],n=p(t,"".concat(e),0);if(n<e.length)throw new Error("Unmatched selector: ".concat(e.slice(n)));return t}},function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.stringify=void 0;var i=n(518),o=["\\",'"'],s=r(r([],o,!0),["(",")"],!1),a=new Set(o.map((function(e){return e.charCodeAt(0)}))),c=new Set(s.map((function(e){return e.charCodeAt(0)}))),l=new Set(r(r([],s,!0),["~","^","$","*","+","!","|",":","[","]"," ","."],!1).map((function(e){return e.charCodeAt(0)})));function u(e){return e.map((function(e){return e.map(d).join("")})).join(", ")}function d(e,t,n){switch(e.type){case i.SelectorType.Child:return 0===t?"> ":" > ";case i.SelectorType.Parent:return 0===t?"< ":" < ";case i.SelectorType.Sibling:return 0===t?"~ ":" ~ ";case i.SelectorType.Adjacent:return 0===t?"+ ":" + ";case i.SelectorType.Descendant:return" ";case i.SelectorType.ColumnCombinator:return 0===t?"|| ":" || ";case i.SelectorType.Universal:return"*"===e.namespace&&t+1<n.length&&"name"in n[t+1]?"":"".concat(f(e.namespace),"*");case i.SelectorType.Tag:return h(e);case i.SelectorType.PseudoElement:return"::".concat(p(e.name,l)).concat(null===e.data?"":"(".concat(p(e.data,c),")"));case i.SelectorType.Pseudo:return":".concat(p(e.name,l)).concat(null===e.data?"":"(".concat("string"==typeof e.data?p(e.data,c):u(e.data),")"));case i.SelectorType.Attribute:if("id"===e.name&&e.action===i.AttributeAction.Equals&&"quirks"===e.ignoreCase&&!e.namespace)return"#".concat(p(e.value,l));if("class"===e.name&&e.action===i.AttributeAction.Element&&"quirks"===e.ignoreCase&&!e.namespace)return".".concat(p(e.value,l));var r=h(e);return e.action===i.AttributeAction.Exists?"[".concat(r,"]"):"[".concat(r).concat(function(e){switch(e){case i.AttributeAction.Equals:return"";case i.AttributeAction.Element:return"~";case i.AttributeAction.Start:return"^";case i.AttributeAction.End:return"$";case i.AttributeAction.Any:return"*";case i.AttributeAction.Not:return"!";case i.AttributeAction.Hyphen:return"|";case i.AttributeAction.Exists:throw new Error("Shouldn't be here")}}(e.action),'="').concat(p(e.value,a),'"').concat(null===e.ignoreCase?"":e.ignoreCase?" i":" s","]")}}function h(e){return"".concat(f(e.namespace)).concat(p(e.name,l))}function f(e){return null!==e?"".concat("*"===e?"*":p(e,l),"|"):""}function p(e,t){for(var n=0,r="",i=0;i<e.length;i++)t.has(e.charCodeAt(i))&&(r+="".concat(e.slice(n,i),"\\").concat(e.charAt(i)),n=i+1);return r.length>0?r+e.slice(n):e}t.stringify=u},function(e,t){e.exports={trueFunc:function(){return!0},falseFunc:function(){return!1}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomUtils=t.parseFeed=t.getFeed=t.ElementType=t.Tokenizer=t.createDomStream=t.parseDOM=t.parseDocument=t.DefaultHandler=t.DomHandler=t.Parser=void 0;var a=n(606),c=n(606);Object.defineProperty(t,"Parser",{enumerable:!0,get:function(){return c.Parser}});var l=n(155),u=n(155);function d(e,t){var n=new l.DomHandler(void 0,t);return new a.Parser(n,t).end(e),n.root}function h(e,t){return d(e,t).children}Object.defineProperty(t,"DomHandler",{enumerable:!0,get:function(){return u.DomHandler}}),Object.defineProperty(t,"DefaultHandler",{enumerable:!0,get:function(){return u.DomHandler}}),t.parseDocument=d,t.parseDOM=h,t.createDomStream=function(e,t,n){var r=new l.DomHandler(e,t,n);return new a.Parser(r,t)};var f=n(607);Object.defineProperty(t,"Tokenizer",{enumerable:!0,get:function(){return s(f).default}}),t.ElementType=o(n(801));var p=n(319),g=n(319);Object.defineProperty(t,"getFeed",{enumerable:!0,get:function(){return g.getFeed}});var m={xmlMode:!0};t.parseFeed=function(e,t){return void 0===t&&(t=m),(0,p.getFeed)(h(e,t))},t.DomUtils=o(n(319))},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Doctype=t.CDATA=t.Tag=t.Style=t.Script=t.Comment=t.Directive=t.Text=t.Root=t.isTag=t.ElementType=void 0,function(e){e.Root="root",e.Text="text",e.Directive="directive",e.Comment="comment",e.Script="script",e.Style="style",e.Tag="tag",e.CDATA="cdata",e.Doctype="doctype"}(r=t.ElementType||(t.ElementType={})),t.isTag=function(e){return e.type===r.Tag||e.type===r.Script||e.type===r.Style},t.Root=r.Root,t.Text=r.Text,t.Directive=r.Directive,t.Comment=r.Comment,t.Script=r.Script,t.Style=r.Style,t.Tag=r.Tag,t.CDATA=r.CDATA,t.Doctype=r.Doctype},function(e,t,n){var r=n(26),i=n(112);t.mergeOptions=function(e){var t={},n={parsers:[],refiners:[]};return e.forEach((function(e){e.call&&(e=e.call()),e.parsers&&e.parsers.forEach((function(e){t[e.constructor]||(n.parsers.push(e),t[e.constructor]=!0)})),e.refiners&&e.refiners.forEach((function(e){t[e.constructor]||(n.refiners.push(e),t[e.constructor]=!0)}))})),n},t.commonPostProcessing=function(){return{refiners:[new i.ExtractTimezoneOffsetRefiner,new i.ExtractTimezoneAbbrRefiner,new i.UnlikelyFormatFilter]}},t.strictOption=function(){var e={strict:!0};return t.mergeOptions([t.en(e),t.de(e),t.es(e),t.fr(e),t.ja(e),t.zh,t.commonPostProcessing])},t.casualOption=function(){return t.mergeOptions([t.en.casual,t.de({strict:!0}),t.es.casual,t.fr.casual,t.ja.casual,t.zh,t.commonPostProcessing])},t.de=function(e){return{parsers:[new r.DEDeadlineFormatParser(e),new r.DEMonthNameLittleEndianParser(e),new r.DEMonthNameParser(e),new r.DESlashDateFormatParser(e),new r.DETimeAgoFormatParser(e),new r.DETimeExpressionParser(e)],refiners:[new i.OverlapRemovalRefiner,new i.ForwardDateRefiner,new i.DEMergeDateTimeRefiner,new i.DEMergeDateRangeRefiner]}},t.de.casual=function(){var e=t.de({strict:!1});return e.parsers.unshift(new r.DECasualDateParser),e.parsers.unshift(new r.DEWeekdayParser),e},t.en=function(e){return{parsers:[new r.ENISOFormatParser(e),new r.ENDeadlineFormatParser(e),new r.ENMonthNameLittleEndianParser(e),new r.ENMonthNameMiddleEndianParser(e),new r.ENMonthNameParser(e),new r.ENSlashDateFormatParser(e),new r.ENSlashDateFormatStartWithYearParser(e),new r.ENSlashMonthFormatParser(e),new r.ENTimeAgoFormatParser(e),new r.ENTimeFromNowFormatParser(e),new r.ENTimeExpressionParser(e)],refiners:[new i.OverlapRemovalRefiner,new i.ForwardDateRefiner,new i.ENMergeDateTimeRefiner,new i.ENMergeDateRangeRefiner,new i.ENPrioritizeSpecificDateRefiner]}},t.en.casual=function(e){(e=e||{}).strict=!1;var n=t.en(e);return n.parsers.unshift(new r.ENCasualDateParser),n.parsers.unshift(new r.ENCasualTimeParser),n.parsers.unshift(new r.ENWeekdayParser),n.parsers.unshift(new r.ENRelativeDateFormatParser),n},t.en_GB=function(e){return(e=e||{}).littleEndian=!0,t.en(e)},t.en_GB.casual=function(e){return(e=e||{}).littleEndian=!0,t.en.casual(e)},t.ja=function(){return{parsers:[new r.JPStandardParser],refiners:[new i.OverlapRemovalRefiner,new i.ForwardDateRefiner,new i.JPMergeDateRangeRefiner]}},t.ja.casual=function(){var e=t.ja();return e.parsers.unshift(new r.JPCasualDateParser),e},t.es=function(e){return{parsers:[new r.ESTimeAgoFormatParser(e),new r.ESDeadlineFormatParser(e),new r.ESTimeExpressionParser(e),new r.ESMonthNameLittleEndianParser(e),new r.ESSlashDateFormatParser(e)],refiners:[new i.OverlapRemovalRefiner,new i.ForwardDateRefiner]}},t.es.casual=function(){var e=t.es({strict:!1});return e.parsers.unshift(new r.ESCasualDateParser),e.parsers.unshift(new r.ESWeekdayParser),e},t.fr=function(e){return{parsers:[new r.FRDeadlineFormatParser(e),new r.FRMonthNameLittleEndianParser(e),new r.FRSlashDateFormatParser(e),new r.FRTimeAgoFormatParser(e),new r.FRTimeExpressionParser(e)],refiners:[new i.OverlapRemovalRefiner,new i.ForwardDateRefiner,new i.FRMergeDateRangeRefiner,new i.FRMergeDateTimeRefiner]}},t.fr.casual=function(){var e=t.fr({strict:!1});return e.parsers.unshift(new r.FRCasualDateParser),e.parsers.unshift(new r.FRWeekdayParser),e.parsers.unshift(new r.FRRelativeDateFormatParser),e},t.zh=function(){return{parsers:[new r.ZHHantDateParser,new r.ZHHantWeekdayParser,new r.ZHHantTimeExpressionParser,new r.ZHHantCasualDateParser,new r.ZHHantDeadlineFormatParser],refiners:[new i.OverlapRemovalRefiner,new i.ForwardDateRefiner]}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=new RegExp("(\\W|^)([0-9]{4})\\-([0-9]{1,2})\\-([0-9]{1,2})(?:T([0-9]{1,2}):([0-9]{1,2})(?::([0-9]{1,2})(?:\\.(\\d{1,4}))?)?(?:Z|([+-]\\d{2}):?(\\d{2})?)?)?(?=\\W|$)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return s},this.extract=function(e,t,n,i){e=n[0].substr(n[1].length);var s=n.index+n[1].length,a=new o({text:e,index:s,ref:t});if(a.start.assign("year",parseInt(n[2])),a.start.assign("month",parseInt(n[3])),a.start.assign("day",parseInt(n[4])),r(a.start.get("month"))>12||r(a.start.get("month"))<1||r(a.start.get("day"))>31||r(a.start.get("day"))<1)return null;if(null!=n[5])if(a.start.assign("hour",parseInt(n[5])),a.start.assign("minute",parseInt(n[6])),null!=n[7]&&a.start.assign("second",parseInt(n[7])),null!=n[8]&&a.start.assign("millisecond",parseInt(n[8])),null==n[9])a.start.assign("timezoneOffset",0);else{var c=0,l=parseInt(n[9]);null!=n[10]&&(c=parseInt(n[10]));var u=60*l;u<0?u-=c:u+=c,a.start.assign("timezoneOffset",u)}return a.tags.ENISOFormatParser=!0,a}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(204),a=new RegExp("(\\W|^)(within|in)\\s*("+s.INTEGER_WORDS_PATTERN+"|[0-9]+|an?(?:\\s*few)?|half(?:\\s*an?)?)\\s*(seconds?|min(?:ute)?s?|hours?|days?|weeks?|months?|years?)\\s*(?=\\W|$)","i"),c=new RegExp("(\\W|^)(within|in)\\s*("+s.INTEGER_WORDS_PATTERN+"|[0-9]+|an?)\\s*(seconds?|minutes?|hours?|days?)\\s*(?=\\W|$)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return this.isStrictMode()?c:a},this.extract=function(e,t,n,i){var a=n.index+n[1].length;n[0];e=n[0].substr(n[1].length,n[0].length-n[1].length);var c=new o({index:a,text:e,ref:t}),l=n[3].toLowerCase();l=void 0!==s.INTEGER_WORDS[l]?s.INTEGER_WORDS[l]:"a"===l||"an"===l?1:l.match(/few/i)?3:l.match(/half/i)?.5:parseInt(l);var u=r(t);return n[4].match(/day|week|month|year/i)?(n[4].match(/day/i)?u.add(l,"d"):n[4].match(/week/i)?u.add(7*l,"d"):n[4].match(/month/i)?u.add(l,"month"):n[4].match(/year/i)&&u.add(l,"year"),c.start.assign("year",u.year()),c.start.assign("month",u.month()+1),c.start.assign("day",u.date()),c):(n[4].match(/hour/i)?u.add(l,"hour"):n[4].match(/min/i)?u.add(l,"minute"):n[4].match(/second/i)&&u.add(l,"second"),c.start.imply("year",u.year()),c.start.imply("month",u.month()+1),c.start.imply("day",u.date()),c.start.assign("hour",u.hour()),c.start.assign("minute",u.minute()),c.start.assign("second",u.second()),c.tags.ENDeadlineFormatParser=!0,c)}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(204),a=new RegExp("(\\W|^)(next|last|past)\\s*("+s.INTEGER_WORDS_PATTERN+"|[0-9]+|few|half(?:\\s*an?)?)?\\s*(seconds?|min(?:ute)?s?|hours?|days?|weeks?|months?|years?)(?=\\s*)(?=\\W|$)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,i){var a=n.index+n[1].length,c=n[2].toLowerCase().match(/^next/)?1:-1;n[0];e=n[0].substr(n[1].length,n[0].length-n[1].length);var l=new o({index:a,text:e,ref:t});l.tags.ENRelativeDateFormatParser=!0;var u=void 0===n[3]?"":n[3].toLowerCase();u=void 0!==s.INTEGER_WORDS[u]?s.INTEGER_WORDS[u]:""===u?1:u.match(/few/i)?3:u.match(/half/i)?.5:parseInt(u),u*=c;var d=r(t);return n[4].match(/day|week|month|year/i)?(n[4].match(/day/i)?(d.add(u,"d"),l.start.assign("year",d.year()),l.start.assign("month",d.month()+1),l.start.assign("day",d.date())):n[4].match(/week/i)?(d.add(7*u,"d"),l.start.imply("day",d.date()),l.start.imply("month",d.month()+1),l.start.imply("year",d.year())):n[4].match(/month/i)?(d.add(u,"month"),l.start.imply("day",d.date()),l.start.assign("year",d.year()),l.start.assign("month",d.month()+1)):n[4].match(/year/i)&&(d.add(u,"year"),l.start.imply("day",d.date()),l.start.imply("month",d.month()+1),l.start.assign("year",d.year())),l):(n[4].match(/hour/i)?(d.add(u,"hour"),l.start.imply("minute",d.minute()),l.start.imply("second",d.second())):n[4].match(/min/i)?(d.add(u,"minute"),l.start.assign("minute",d.minute()),l.start.imply("second",d.second())):n[4].match(/second/i)&&(d.add(u,"second"),l.start.assign("second",d.second()),l.start.assign("minute",d.minute())),l.start.assign("hour",d.hour()),l.start.assign("year",d.year()),l.start.assign("month",d.month()+1),l.start.assign("day",d.date()),l)}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(204),a=new RegExp("(\\W|^)(?:on\\s*?)?(?:(Sunday|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sun|Mon|Tue|Wed|Thu|Fri|Sat)\\s*,?\\s*)?(([0-9]{1,2})(?:st|nd|rd|th)?|"+s.ORDINAL_WORDS_PATTERN+")(?:\\s*(?:to|\\-|\\\u2013|until|through|till|\\s)\\s*(([0-9]{1,2})(?:st|nd|rd|th)?|"+s.ORDINAL_WORDS_PATTERN+"))?(?:-|/|\\s*(?:of)?\\s*)(Jan(?:uary|\\.)?|Feb(?:ruary|\\.)?|Mar(?:ch|\\.)?|Apr(?:il|\\.)?|May|Jun(?:e|\\.)?|Jul(?:y|\\.)?|Aug(?:ust|\\.)?|Sep(?:tember|\\.)?|Oct(?:ober|\\.)?|Nov(?:ember|\\.)?|Dec(?:ember|\\.)?)(?:(?:-|/|,?\\s*)([0-9]{1,4}(?![^\\s]\\d))(\\s*(?:BE|AD|BC))?)?(?=\\W|$)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,i){var a=new o({text:n[0].substr(n[1].length,n[0].length-n[1].length),index:n.index+n[1].length,ref:t}),c=n[7];c=s.MONTH_OFFSET[c.toLowerCase()];var l=n[4]?parseInt(n[4]):s.ORDINAL_WORDS[n[3].trim().replace("-"," ").toLowerCase()],u=null;if(n[8])if(u=n[8],u=parseInt(u),n[9])/BE/i.test(n[9])?u-=543:/BC/i.test(n[9])&&(u=-u);else{if(u<10)return null;u<100&&(u+=2e3)}if(u)a.start.assign("day",l),a.start.assign("month",c),a.start.assign("year",u);else{var d=r(t);d.month(c-1),d.date(l),d.year(r(t).year());var h=d.clone().add(1,"y"),f=d.clone().add(-1,"y");Math.abs(h.diff(r(t)))<Math.abs(d.diff(r(t)))?d=h:Math.abs(f.diff(r(t)))<Math.abs(d.diff(r(t)))&&(d=f),a.start.assign("day",l),a.start.assign("month",c),a.start.imply("year",d.year())}if(n[2]){var p=n[2];p=s.WEEKDAY_OFFSET[p.toLowerCase()],a.start.assign("weekday",p)}if(n[5]){var g=n[6]?parseInt(n[6]):s.ORDINAL_WORDS[n[5].trim().replace("-"," ").toLowerCase()];a.end=a.start.clone(),a.end.assign("day",g)}return a.tags.ENMonthNameLittleEndianParser=!0,a}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(204),a=new RegExp("(\\W|^)(?:(?:on\\s*?)?(Sunday|Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sun\\.?|Mon\\.?|Tue\\.?|Wed\\.?|Thu\\.?|Fri\\.?|Sat\\.?)\\s*,?\\s*)?(Jan\\.?|January|Feb\\.?|February|Mar\\.?|March|Apr\\.?|April|May\\.?|Jun\\.?|June|Jul\\.?|July|Aug\\.?|August|Sep\\.?|Sept\\.?|September|Oct\\.?|October|Nov\\.?|November|Dec\\.?|December)(?:-|/|\\s*,?\\s*)(([0-9]{1,2})(?:st|nd|rd|th)?|"+s.ORDINAL_WORDS_PATTERN+")\\s*(?:(?:to|\\-)\\s*(([0-9]{1,2})(?:st|nd|rd|th)?| "+s.ORDINAL_WORDS_PATTERN+")\\s*)?(?:(?:-|/|\\s*,?\\s*)(?:([0-9]{4})\\s*(BE|AD|BC)?|([0-9]{1,4})\\s*(AD|BC))\\s*)?(?=\\W|$)(?!\\:\\d)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,i){var a=new o({text:n[0].substr(n[1].length,n[0].length-n[1].length),index:n.index+n[1].length,ref:t}),c=n[3];c=s.MONTH_OFFSET[c.toLowerCase()];var l=n[5]?parseInt(n[5]):s.ORDINAL_WORDS[n[4].trim().replace("-"," ").toLowerCase()],u=null;if(n[8]||n[10]){u=n[8]||n[10],u=parseInt(u);var d=n[9]||n[11];d?/BE/i.test(d)?u-=543:/BC/i.test(d)&&(u=-u):u<100&&(u+=2e3)}if(u)a.start.assign("day",l),a.start.assign("month",c),a.start.assign("year",u);else{var h=r(t);h.month(c-1),h.date(l);var f=h.clone().add(1,"y"),p=h.clone().add(-1,"y");Math.abs(f.diff(r(t)))<Math.abs(h.diff(r(t)))?h=f:Math.abs(p.diff(r(t)))<Math.abs(h.diff(r(t)))&&(h=p),a.start.assign("day",l),a.start.assign("month",c),a.start.imply("year",h.year())}if(n[2]){var g=n[2];g=s.WEEKDAY_OFFSET[g.toLowerCase()],a.start.assign("weekday",g)}if(n[6]){var m=n[7]?m=parseInt(n[7]):s.ORDINAL_WORDS[n[6].replace("-"," ").trim().toLowerCase()];a.end=a.start.clone(),a.end.assign("day",m)}return a.tags.ENMonthNameMiddleEndianParser=!0,a}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(204),a=new RegExp("(^|\\D\\s+|[^\\w\\s])(Jan\\.?|January|Feb\\.?|February|Mar\\.?|March|Apr\\.?|April|May\\.?|Jun\\.?|June|Jul\\.?|July|Aug\\.?|August|Sep\\.?|Sept\\.?|September|Oct\\.?|October|Nov\\.?|November|Dec\\.?|December)\\s*(?:[,-]?\\s*([0-9]{4})(\\s*BE|AD|BC)?)?(?=[^\\s\\w]|\\s+[^0-9]|\\s+$|$)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,i){var a=new o({text:n[0].substr(n[1].length,n[0].length-n[1].length),index:n.index+n[1].length,ref:t}),c=n[2];c=s.MONTH_OFFSET[c.toLowerCase()];var l=null;if(n[3]&&(l=n[3],l=parseInt(l),n[4]?n[4].match(/BE/)?l-=543:n[4].match(/BC/)&&(l=-l):l<100&&(l+=2e3)),l)a.start.imply("day",1),a.start.assign("month",c),a.start.assign("year",l);else{var u=r(t);u.month(c-1),u.date(1);var d=u.clone().add(1,"y"),h=u.clone().add(-1,"y");Math.abs(d.diff(r(t)))<Math.abs(u.diff(r(t)))?u=d:Math.abs(h.diff(r(t)))<Math.abs(u.diff(r(t)))&&(u=h),a.start.imply("day",1),a.start.assign("month",c),a.start.imply("year",u.year())}return a.tags.ENMonthNameParser=!0,a}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=new RegExp("(\\W|^)(?:(?:on\\s*?)?((?:sun|mon|tues?|wed(?:nes)?|thu(?:rs?)?|fri|sat(?:ur)?)(?:day)?)\\s*\\,?\\s*)?([0-3]{0,1}[0-9]{1})[\\/\\.\\-]([0-3]{0,1}[0-9]{1})(?:[\\/\\.\\-]([0-9]{4}s*,?s*|[0-9]{2}s*,?s*))?(\\W|$)","i"),a={sunday:0,sun:0,monday:1,mon:1,tuesday:2,wednesday:3,wed:3,thursday:4,thur:4,friday:5,fri:5,saturday:6,sat:6};t.Parser=function(e){i.apply(this,arguments);var t=(e=e||{}).littleEndian,n=t?4:3,c=t?3:4;this.pattern=function(){return s},this.extract=function(e,t,i,s){if("/"!=i[1]&&"/"!=i[6]){var l=i.index+i[1].length,u=(e=i[0].substr(i[1].length,i[0].length-i[6].length),new o({text:e,index:l,ref:t}));if(!e.match(/^\d\.\d$/)&&!e.match(/^\d\.\d{1,2}\.\d{1,2}$/)&&(i[5]||!(i[0].indexOf("/")<0))){var d=i[5]||r(t).year()+"",h=i[n],f=i[c];if(h=parseInt(h),f=parseInt(f),d=parseInt(d),(h<1||h>12)&&h>12){if(!(f>=1&&f<=12&&h>=13&&h<=31))return null;var p=h;h=f,f=p}return f<1||f>31?null:(d<100&&(d+=d>50?1900:2e3),u.start.assign("day",f),u.start.assign("month",h),u.start.assign("year",d),i[2]&&u.start.assign("weekday",a[i[2].toLowerCase()]),u.tags.ENSlashDateFormatParser=!0,u)}}else i.index+=i[0].length}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=new RegExp("(\\W|^)([0-9]{4})[\\-\\.\\/]([0-9]{1,2})[\\-\\.\\/]([0-9]{1,2})(?=\\W|$)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return s},this.extract=function(e,t,n,i){e=n[0].substr(n[1].length);var s=n.index+n[1].length,a=new o({text:e,index:s,ref:t});return a.start.assign("year",parseInt(n[2])),a.start.assign("month",parseInt(n[3])),a.start.assign("day",parseInt(n[4])),r(a.start.get("month"))>12||r(a.start.get("month"))<1||r(a.start.get("day"))>31||r(a.start.get("day"))<1?null:(a.tags.ENDateFormatParser=!0,a)}}},function(e,t,n){n(16);var r=n(26).Parser,i=n(23).ParsedResult,o=new RegExp("(^|[^\\d/]\\s+|[^\\w\\s])([0-9]|0[1-9]|1[012])/([0-9]{4})([^\\d/]|$)","i");t.Parser=function(e){r.apply(this,arguments),this.pattern=function(){return o},this.extract=function(e,t,n,r){var o=n.index+n[1].length,s=(e=n[0].substr(n[1].length,n[0].length-(1+n[4].length)).trim(),new i({text:e,index:o,ref:t})),a=n[3],c=n[2];return c=parseInt(c),a=parseInt(a),s.start.imply("day",1),s.start.assign("month",c),s.start.assign("year",a),s.tags.ENSlashMonthFormatParser=!0,s}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(204),a="("+s.INTEGER_WORDS_PATTERN+"|[0-9]+|an?(?:\\s*few)?|half(?:\\s*an?)?)\\s*(sec(?:onds?)?|min(?:ute)?s?|hours?|weeks?|days?|months?|years?)\\s*",c=new RegExp(a,"i"),l=new RegExp("(\\W|^)(?:within\\s*)?((?:"+a+")+)(?:ago|before|earlier)(?=(?:\\W|$))","i"),u=new RegExp("(\\W|^)(?:within\\s*)?((?:([0-9]+|an?)\\s*(seconds?|minutes?|hours?|days?)\\s*)+)ago(?=(?:\\W|$))","i");t.Parser=function(){function e(e,t){var n=e[1].toLowerCase();return n=void 0!==s.INTEGER_WORDS[n]?s.INTEGER_WORDS[n]:"a"===n||"an"===n?1:n.match(/few/)?3:n.match(/half/)?.5:parseInt(n),e[2].match(/hour/i)?t.hour=n:e[2].match(/min/i)?t.minute=n:e[2].match(/sec/i)?t.second=n:e[2].match(/week/i)?t.week=n:e[2].match(/day/i)?t.d=n:e[2].match(/month/i)?t.month=n:e[2].match(/year/i)&&(t.year=n),t}i.apply(this,arguments),this.pattern=function(){return this.isStrictMode()?u:l},this.extract=function(t,n,i,s){if(i.index>0&&t[i.index-1].match(/\w/))return null;t=i[0];t=i[0].substr(i[1].length,i[0].length-i[1].length),index=i.index+i[1].length;var a=new o({index:index,text:t,ref:n}),l=function(t){var n={},r=t,i=c.exec(r);for(;i;)e(i,n),r=r.substring(i[0].length),i=c.exec(r);return n}(i[2]),u=r(n);for(var d in l)u.add(-l[d],d);return(l.hour>0||l.minute>0||l.second>0)&&(a.start.assign("hour",u.hour()),a.start.assign("minute",u.minute()),a.start.assign("second",u.second()),a.tags.ENTimeAgoFormatParser=!0),l.d>0||l.month>0||l.year>0?(a.start.assign("day",u.date()),a.start.assign("month",u.month()+1),a.start.assign("year",u.year())):(l.week>0&&a.start.imply("weekday",u.day()),a.start.imply("day",u.date()),a.start.imply("month",u.month()+1),a.start.imply("year",u.year())),a}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(23).ParsedComponents,a=new RegExp("(^|\\s|T)(?:(?:at|from)\\s*)??(\\d{1,4}|noon|midnight)(?:(?:\\.|\\:|\\\uff1a)(\\d{1,2})(?:(?:\\:|\\\uff1a)(\\d{2}))?)?(?:\\s*(A\\.M\\.|P\\.M\\.|AM?|PM?))?(?=\\W|$)","i"),c=new RegExp("^\\s*(\\-|\\\u2013|\\~|\\\u301c|to|\\?)\\s*(\\d{1,4})(?:(?:\\.|\\:|\\\uff1a)(\\d{1,2})(?:(?:\\.|\\:|\\\uff1a)(\\d{1,2}))?)?(?:\\s*(A\\.M\\.|P\\.M\\.|AM?|PM?))?(?=\\W|$)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,i){if(n.index>0&&e[n.index-1].match(/\w/))return null;var a=r(t),l=new o;l.ref=t,l.index=n.index+n[1].length,l.text=n[0].substring(n[1].length),l.tags.ENTimeExpressionParser=!0,l.start.imply("day",a.date()),l.start.imply("month",a.month()+1),l.start.imply("year",a.year());var u=0,d=0,h=-1;if(null!=n[4]){if((f=parseInt(n[4]))>=60)return null;l.start.assign("second",f)}if("noon"==n[2].toLowerCase()?(h=1,u=12):"midnight"==n[2].toLowerCase()?(h=0,u=0):u=parseInt(n[2]),null!=n[3]?d=parseInt(n[3]):u>100&&(d=u%100,u=parseInt(u/100)),d>=60)return null;if(u>24)return null;if(u>=12&&(h=1),null!=n[5]){if(u>12)return null;"a"==(p=n[5][0].toLowerCase())&&(h=0,12==u&&(u=0)),"p"==p&&(h=1,12!=u&&(u+=12))}if(l.start.assign("hour",u),l.start.assign("minute",d),h>=0?l.start.assign("meridiem",h):u<12?l.start.imply("meridiem",0):l.start.imply("meridiem",1),!(n=c.exec(e.substring(l.index+l.text.length))))return l.text.match(/^\d+$/)?null:l;if(n[0].match(/^\s*(\+|\-)\s*\d{3,4}$/))return l;null==l.end&&(l.end=new s(null,l.start.date()));u=0,d=0,h=-1;if(null!=n[4]){var f;if((f=parseInt(n[4]))>=60)return null;l.end.assign("second",f)}if(u=parseInt(n[2]),null!=n[3]){if((d=parseInt(n[3]))>=60)return l}else u>100&&(d=u%100,u=parseInt(u/100));if(d>=60)return null;if(u>24)return null;if(u>=12&&(h=1),null!=n[5]){if(u>12)return null;var p;"a"==(p=n[5][0].toLowerCase())&&(h=0,12==u&&(u=0,l.end.isCertain("day")||l.end.imply("day",l.end.get("day")+1))),"p"==p&&(h=1,12!=u&&(u+=12)),l.start.isCertain("meridiem")||(0==h?(l.start.imply("meridiem",0),12==l.start.get("hour")&&l.start.assign("hour",0)):(l.start.imply("meridiem",1),12!=l.start.get("hour")&&l.start.assign("hour",l.start.get("hour")+12)))}(l.text=l.text+n[0],l.end.assign("hour",u),l.end.assign("minute",d),h>=0)?l.end.assign("meridiem",h):l.start.isCertain("meridiem")&&1==l.start.get("meridiem")&&l.start.get("hour")>u?l.end.imply("meridiem",0):u>12&&l.end.imply("meridiem",1);return l.end.date().getTime()<l.start.date().getTime()&&l.end.imply("day",l.end.get("day")+1),l}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(204),a=new RegExp("(\\W|^)(?:within\\s*)?("+s.INTEGER_WORDS_PATTERN+"|[0-9]+|an?(?:\\s*few)?|half(?:\\s*an?)?)\\s*(seconds?|min(?:ute)?s?|hours?|weeks?|days?|months?|years?)\\s*(?:from now|henceforth|forward|out)(?=(?:\\W|$))","i"),c=new RegExp("(\\W|^)(?:within\\s*)?([0-9]+|an?)\\s*(seconds?|minutes?|hours?|days?)\\s*from now(?=(?:\\W|$))","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return this.isStrictMode()?c:a},this.extract=function(e,t,n,i){if(n.index>0&&e[n.index-1].match(/\w/))return null;e=n[0];e=n[0].substr(n[1].length,n[0].length-n[1].length),index=n.index+n[1].length;var a=new o({index:index,text:e,ref:t}),c=n[2].toLowerCase();c=void 0!==s.INTEGER_WORDS[c]?s.INTEGER_WORDS[c]:"a"===c||"an"===c?1:c.match(/few/)?3:c.match(/half/)?.5:parseInt(c);var l=r(t);return n[3].match(/hour|min|second/i)?(n[3].match(/hour/i)?l.add(+c,"hour"):n[3].match(/min/i)?l.add(+c,"minute"):n[3].match(/second/i)&&l.add(+c,"second"),a.start.imply("day",l.date()),a.start.imply("month",l.month()+1),a.start.imply("year",l.year()),a.start.assign("hour",l.hour()),a.start.assign("minute",l.minute()),a.start.assign("second",l.second()),a.tags.ENTimeFromNowFormatParser=!0,a):n[3].match(/week/i)?(l.add(+c,"week"),a.start.imply("day",l.date()),a.start.imply("month",l.month()+1),a.start.imply("year",l.year()),a.start.imply("weekday",l.day()),a):(n[3].match(/day/i)&&l.add(+c,"d"),n[3].match(/month/i)&&l.add(+c,"month"),n[3].match(/year/i)&&l.add(+c,"year"),a.start.assign("day",l.date()),a.start.assign("month",l.month()+1),a.start.assign("year",l.year()),a)}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=/(\W|^)(now|today|tonight|last\s*night|(?:tomorrow|tmr|yesterday)\s*|tomorrow|tmr|yesterday)(?=\W|$)/i;t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return s},this.extract=function(e,t,n,i){e=n[0].substr(n[1].length);var s=n.index+n[1].length,a=new o({index:s,text:e,ref:t}),c=r(t),l=c.clone(),u=e.toLowerCase();return"tonight"==u?(a.start.imply("hour",22),a.start.imply("meridiem",1)):/^tomorrow|^tmr/.test(u)?c.hour()>1&&l.add(1,"day"):/^yesterday/.test(u)?l.add(-1,"day"):u.match(/last\s*night/)?(a.start.imply("hour",0),c.hour()>6&&l.add(-1,"day")):u.match("now")&&(a.start.assign("hour",c.hour()),a.start.assign("minute",c.minute()),a.start.assign("second",c.second()),a.start.assign("millisecond",c.millisecond())),a.start.assign("day",l.date()),a.start.assign("month",l.month()+1),a.start.assign("year",l.year()),a.tags.ENCasualDateParser=!0,a}}},function(e,t,n){n(16);var r=n(26).Parser,i=n(23).ParsedResult,o=/(\W|^)((this)?\s*(morning|afternoon|evening|noon))/i,s=4;t.Parser=function(){r.apply(this,arguments),this.pattern=function(){return o},this.extract=function(e,t,n,r){e=n[0].substr(n[1].length);var o=n.index+n[1].length,a=new i({index:o,text:e,ref:t});return n[s]||(s=3),"afternoon"==n[s]?a.start.imply("hour",r.afternoon?r.afternoon:15):"evening"==n[s]?a.start.imply("hour",r.evening?r.evening:18):"morning"==n[s]?a.start.imply("hour",r.morning?r.morning:6):"noon"==n[s]&&a.start.imply("hour",r.noon?r.noon:12),a.tags.ENCasualTimeParser=!0,a}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(818),a=/(?:(\u540c|((\u662d\u548c|\u5e73\u6210)?([0-9\uff10-\uff19]{2,4})))\u5e74\s*)?([0-9\uff10-\uff19]{1,2})\u6708\s*([0-9\uff10-\uff19]{1,2})\u65e5/i;t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,i){var a=r(t),c=new o({text:n[0],index:n.index,ref:t}),l=n[5];l=s.toHankaku(l),l=parseInt(l);var u=n[6];if(u=s.toHankaku(u),u=parseInt(u),a.set("date",u),a.set("month",l-1),c.start.assign("day",a.date()),c.start.assign("month",a.month()+1),n[2])if(n[2].match("\u540c\u5e74"))c.start.assign("year",a.year());else{var d=n[4];d=s.toHankaku(d),d=parseInt(d),"\u5e73\u6210"==n[3]?d+=1988:"\u662d\u548c"==n[3]&&(d+=1925),c.start.assign("year",d)}else{a.year(r(t).year());var h=a.clone().add(1,"y"),f=a.clone().add(-1,"y");Math.abs(h.diff(r(t)))<Math.abs(a.diff(r(t)))?a=h:Math.abs(f.diff(r(t)))<Math.abs(a.diff(r(t)))&&(a=f),c.start.assign("day",a.date()),c.start.assign("month",a.month()+1),c.start.imply("year",a.year())}return c.tags.JPStandardParser=!0,c}}},function(e,t){t.toHankaku=function(e,t){function n(e){return t(e.charCodeAt(0)-65248)}return function(t){return e(t).replace(/\u2019/g,"'").replace(/\u201D/g,'"').replace(/\u3000/g," ").replace(/\uFFE5/g,"\xa5").replace(/[\uFF01\uFF03-\uFF06\uFF08\uFF09\uFF0C-\uFF19\uFF1C-\uFF1F\uFF21-\uFF3B\uFF3D\uFF3F\uFF41-\uFF5B\uFF5D\uFF5E]/g,n)}}(String,String.fromCharCode),t.toZenkaku=function(e,t){function n(e){return t(e.charCodeAt(0)+65248)}return function(t){return e(t).replace(/\u0020/g,"\u3000").replace(/\u0022/g,"\u201d").replace(/\u0027/g,"\u2019").replace(/\u00A5/g,"\uffe5").replace(/[!#-&(),-9\u003C-?A-[\u005D_a-{}~]/g,n)}}(String,String.fromCharCode)},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=/\u4eca\u65e5|\u5f53\u65e5|\u6628\u65e5|\u660e\u65e5|\u4eca\u591c|\u4eca\u5915|\u4eca\u6669|\u4eca\u671d/i;t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return s},this.extract=function(e,t,n,i){var s=n.index,a=(e=n[0],new o({index:s,text:e,ref:t})),c=r(t),l=c.clone();return"\u4eca\u591c"==e||"\u4eca\u5915"==e||"\u4eca\u6669"==e?(a.start.imply("hour",22),a.start.imply("meridiem",1)):"\u660e\u65e5"==e?c.hour()>4&&l.add(1,"day"):"\u6628\u65e5"==e?l.add(-1,"day"):e.match("\u4eca\u671d")&&(a.start.imply("hour",6),a.start.imply("meridiem",0)),a.start.assign("day",l.date()),a.start.assign("month",l.month()+1),a.start.assign("year",l.year()),a.tags.JPCasualDateParser=!0,a}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=/(\W|^)(ahora|esta\s*(ma\xf1ana|tarde|noche)|(ayer|ma\xf1ana)\s*por\s*la\s*(ma\xf1ana|tarde|noche)|hoy|ma\xf1ana|ayer|anoche)(?=\W|$)/i;t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return s},this.extract=function(e,t,n,i){e=n[0].substr(n[1].length);var s=n.index+n[1].length,a=new o({index:s,text:e,ref:t}),c=r(t),l=c.clone(),u=e.toLowerCase().replace(/\s+/g," ");if("ma\xf1ana"==u)c.hour()>1&&l.add(1,"day");else if("ayer"==u)l.add(-1,"day");else if("anoche"==u)a.start.imply("hour",0),c.hour()>6&&l.add(-1,"day");else if(u.match("esta")){"tarde"==(d=n[3].toLowerCase())?a.start.imply("hour",18):"ma\xf1ana"==d?a.start.imply("hour",6):"noche"==d&&(a.start.imply("hour",22),a.start.imply("meridiem",1))}else if(u.match(/por\s*la/)){var d,h=n[4].toLowerCase();"ayer"===h?l.add(-1,"day"):"ma\xf1ana"===h&&l.add(1,"day"),"tarde"==(d=n[5].toLowerCase())?a.start.imply("hour",18):"ma\xf1ana"==d?a.start.imply("hour",9):"noche"==d&&(a.start.imply("hour",22),a.start.imply("meridiem",1))}else u.match("ahora")&&(a.start.imply("hour",c.hour()),a.start.imply("minute",c.minute()),a.start.imply("second",c.second()),a.start.imply("millisecond",c.millisecond()));return a.start.assign("day",l.date()),a.start.assign("month",l.month()+1),a.start.assign("year",l.year()),a.tags.ESCasualDateParser=!0,a}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=/(\W|^)(dentro\s*de|en)\s*([0-9]+|medi[oa]|una?)\s*(minutos?|horas?|d[i\xed]as?)\s*(?=(?:\W|$))/i;t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return s},this.extract=function(e,t,n,i){var s=n.index+n[1].length;n[0];e=n[0].substr(n[1].length,n[0].length-n[1].length);var a=new o({index:s,text:e,ref:t}),c=parseInt(n[3]);isNaN(c)&&(c=n[3].match(/medi/)?.5:1);var l=r(t);return n[4].match(/d[i\xed]a/)?(l.add(c,"d"),a.start.assign("year",l.year()),a.start.assign("month",l.month()+1),a.start.assign("day",l.date()),a):(n[4].match(/hora/)?l.add(c,"hour"):n[4].match(/minuto/)&&l.add(c,"minute"),a.start.imply("year",l.year()),a.start.imply("month",l.month()+1),a.start.imply("day",l.date()),a.start.assign("hour",l.hour()),a.start.assign("minute",l.minute()),a.tags.ESDeadlineFormatParser=!0,a)}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=/(\W|^)hace\s*([0-9]+|medi[oa]|una?)\s*(minutos?|horas?|semanas?|d[i\xed]as?|mes(es)?|a\xf1os?)(?=(?:\W|$))/i;t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return s},this.extract=function(e,t,n,i){if(n.index>0&&e[n.index-1].match(/\w/))return null;e=n[0];e=n[0].substr(n[1].length,n[0].length-n[1].length),index=n.index+n[1].length;var s=new o({index:index,text:e,ref:t}),a=parseInt(n[2]);isNaN(a)&&(a=n[2].match(/medi/)?.5:1);var c=r(t);return n[3].match(/hora/)||n[3].match(/minuto/)?(n[3].match(/hora/)?c.add(-a,"hour"):n[3].match(/minuto/)&&c.add(-a,"minute"),s.start.imply("day",c.date()),s.start.imply("month",c.month()+1),s.start.imply("year",c.year()),s.start.assign("hour",c.hour()),s.start.assign("minute",c.minute()),s.tags.ESTimeAgoFormatParser=!0,s):n[3].match(/semana/)?(c.add(-a,"week"),s.start.imply("day",c.date()),s.start.imply("month",c.month()+1),s.start.imply("year",c.year()),s.start.imply("weekday",c.day()),s):(n[3].match(/d[i\xed]a/)&&c.add(-a,"d"),n[3].match(/mes/)&&c.add(-a,"month"),n[3].match(/a\xf1o/)&&c.add(-a,"year"),s.start.assign("day",c.date()),s.start.assign("month",c.month()+1),s.start.assign("year",c.year()),s)}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(23).ParsedComponents,a=new RegExp("(^|\\s|T)(?:(?:a las?|al?|desde|de)\\s*)?(\\d{1,4}|mediod[i\xed]a|medianoche)(?:(?:\\.|\\:|\\\uff1a)(\\d{1,2})(?:(?:\\:|\\\uff1a)(\\d{2}))?)?(?:\\s*(A\\.M\\.|P\\.M\\.|AM?|PM?))?(?=\\W|$)","i"),c=new RegExp("^\\s*(\\-|\\\u2013|\\~|\\\u301c|a(?:s*las)?|\\?)\\s*(\\d{1,4})(?:(?:\\.|\\:|\\\uff1a)(\\d{1,2})(?:(?:\\.|\\:|\\\uff1a)(\\d{1,2}))?)?(?:\\s*(A\\.M\\.|P\\.M\\.|AM?|PM?))?(?=\\W|$)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,i){if(n.index>0&&e[n.index-1].match(/\w/))return null;var a=r(t),l=new o;l.ref=t,l.index=n.index+n[1].length,l.text=n[0].substring(n[1].length),l.tags.ESTimeExpressionParser=!0,l.start.imply("day",a.date()),l.start.imply("month",a.month()+1),l.start.imply("year",a.year());var u=0,d=0,h=-1;if(null!=n[4]){if((p=parseInt(n[4]))>=60)return null;l.start.assign("second",p)}if(n[2].toLowerCase().match(/mediod/)?(h=1,u=12):"medianoche"==n[2].toLowerCase()?(h=0,u=0):u=parseInt(n[2]),null!=n[3]?d=parseInt(n[3]):u>100&&(d=u%100,u=parseInt(u/100)),d>=60)return null;if(u>24)return null;if(u>=12&&(h=1),null!=n[5]){if(u>12)return null;var f=n[5][0].toLowerCase();"a"==f&&(h=0,12==u&&(u=0)),"p"==f&&(h=1,12!=u&&(u+=12))}if(l.start.assign("hour",u),l.start.assign("minute",d),h>=0&&l.start.assign("meridiem",h),!(n=c.exec(e.substring(l.index+l.text.length))))return l.text.match(/^\d+$/)?null:l;if(n[0].match(/^\s*(\+|\-)\s*\d{3,4}$/))return l;null==l.end&&(l.end=new s(null,l.start.date()));u=0,d=0,h=-1;if(null!=n[4]){var p;if((p=parseInt(n[4]))>=60)return null;l.end.assign("second",p)}if(u=parseInt(n[2]),null!=n[3]){if((d=parseInt(n[3]))>=60)return l}else u>100&&(d=u%100,u=parseInt(u/100));if(d>=60)return null;if(u>24)return null;if(u>=12&&(h=1),null!=n[5]){if(u>12)return null;"a"==n[5][0].toLowerCase()&&(h=0,12==u&&(u=0,l.end.isCertain("day")||l.end.imply("day",l.end.get("day")+1))),"p"==n[5][0].toLowerCase()&&(h=1,12!=u&&(u+=12)),l.start.isCertain("meridiem")||(0==h?(l.start.imply("meridiem",0),12==l.start.get("hour")&&l.start.assign("hour",0)):(l.start.imply("meridiem",1),12!=l.start.get("hour")&&l.start.assign("hour",l.start.get("hour")+12)))}else u>=12&&(h=1);return l.text=l.text+n[0],l.end.assign("hour",u),l.end.assign("minute",d),h>=0&&l.end.assign("meridiem",h),l.end.date().getTime()<l.start.date().getTime()&&l.end.imply("day",l.end.get("day")+1),l}}},function(e,t,n){n(16);var r=n(26).Parser,i=n(23).ParsedResult,o=n(348).updateParsedComponent,s={domingo:0,dom:0,lunes:1,lun:1,martes:2,mar:2,miercoles:3,"mi\xe9rcoles":3,mie:3,jueves:4,jue:4,viernes:5,vier:5,sabado:6,"s\xe1bado":6,sab:6},a=new RegExp("(\\W|^)(?:(?:\\,|\\(|\\\uff08)\\s*)?(?:(este|pasado|pr[o\xf3]ximo)\\s*)?("+Object.keys(s).join("|")+")(?:\\s*(?:\\,|\\)|\\\uff09))?(?:\\s*(este|pasado|pr[\xf3o]ximo)\\s*week)?(?=\\W|$)","i");t.Parser=function(){r.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,r){var a=n.index+n[1].length,c=(e=n[0].substr(n[1].length,n[0].length-n[1].length),new i({index:a,text:e,ref:t})),l=n[3].toLowerCase(),u=s[l];if(void 0===u)return null;var d=null,h=n[2],f=n[4];if(h||f){var p=h||f;"pasado"==(p=p.toLowerCase())?d="this":"pr\xf3ximo"==p||"proximo"==p?d="next":"este"==p&&(d="this")}return o(c,t,u,d),c.tags.ESWeekdayParser=!0,c}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(826),a=(s.WEEKDAY_OFFSET,new RegExp("(\\W|^)(?:(Domingo|Lunes|Martes|Mi\xe9rcoles|Miercoles|Jueves|Viernes|S\xe1bado|Sabado|Dom|Lun|Mar|Mie|Jue|Vie|Sab)\\s*,?\\s*)?([0-9]{1,2})(?:\xba|\xaa|\xb0)?(?:\\s*(?:desde|de|\\-|\\\u2013|al?|hasta|\\s)\\s*([0-9]{1,2})(?:\xba|\xaa|\xb0)?)?\\s*(?:de)?\\s*(Ene(?:ro|\\.)?|Feb(?:rero|\\.)?|Mar(?:zo|\\.)?|Abr(?:il|\\.)?|May(?:o|\\.)?|Jun(?:io|\\.)?|Jul(?:io|\\.)?|Ago(?:sto|\\.)?|Sep(?:tiembre|\\.)?|Oct(?:ubre|\\.)?|Nov(?:iembre|\\.)?|Dic(?:iembre|\\.)?)(?:\\s*(?:del?)?(\\s*[0-9]{1,4}(?![^\\s]\\d))(\\s*[ad]\\.?\\s*c\\.?|a\\.?\\s*d\\.?)?)?(?=\\W|$)","i"));t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,i){var a=new o({text:n[0].substr(n[1].length,n[0].length-n[1].length),index:n.index+n[1].length,ref:t}),c=n[5];c=s.MONTH_OFFSET[c.toLowerCase()];var l=n[3];l=parseInt(l);var u=null;if(n[6]&&(u=n[6],u=parseInt(u),n[7]?/a\.?\s*c\.?/i.test(n[7])&&(u=-u):u<100&&(u+=2e3)),u)a.start.assign("day",l),a.start.assign("month",c),a.start.assign("year",u);else{var d=r(t);d.month(c-1),d.date(l),d.year(r(t).year());var h=d.clone().add(1,"y"),f=d.clone().add(-1,"y");Math.abs(h.diff(r(t)))<Math.abs(d.diff(r(t)))?d=h:Math.abs(f.diff(r(t)))<Math.abs(d.diff(r(t)))&&(d=f),a.start.assign("day",l),a.start.assign("month",c),a.start.imply("year",d.year())}if(n[2]){var p=n[2];p=s.WEEKDAY_OFFSET[p.toLowerCase()],a.start.assign("weekday",p)}return n[4]&&(a.end=a.start.clone(),a.end.assign("day",parseInt(n[4]))),a.tags.ESMonthNameLittleEndianParser=!0,a}}},function(e,t){t.WEEKDAY_OFFSET={domingo:0,dom:0,lunes:1,lun:1,martes:2,mar:2,"mi\xe9rcoles":3,miercoles:3,mie:3,jueves:4,jue:4,viernes:5,vie:5,"s\xe1bado":6,sabado:6,sab:6},t.MONTH_OFFSET={enero:1,ene:1,"ene.":1,febrero:2,feb:2,"feb.":2,marzo:3,mar:3,"mar.":3,abril:4,abr:4,"abr.":4,mayo:5,may:5,"may.":5,junio:6,jun:6,"jun.":6,julio:7,jul:7,"jul.":7,agosto:8,ago:8,"ago.":8,septiembre:9,sep:9,sept:9,"sep.":9,"sept.":9,octubre:10,oct:10,"oct.":10,noviembre:11,nov:11,"nov.":11,diciembre:12,dic:12,"dic.":12}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=new RegExp("(\\W|^)(?:((?:domingo|dom|lunes|lun|martes|mar|mi[\xe9e]rcoles|mie|jueves|jue|viernes|vie|s[\xe1a]bado|sab))\\s*\\,?\\s*)?([0-1]{0,1}[0-9]{1})[\\/\\.\\-]([0-3]{0,1}[0-9]{1})(?:[\\/\\.\\-]([0-9]{4}s*,?s*|[0-9]{2}s*,?s*))?(\\W|$)","i"),a={domingo:0,dom:0,lunes:1,lun:1,martes:2,mar:2,miercoles:3,"mi\xe9rcoles":3,mie:3,jueves:4,jue:4,viernes:5,vier:5,"s\xe1bado":6,sabado:6,sab:6};t.Parser=function(e){i.apply(this,arguments),this.pattern=function(){return s},this.extract=function(e,t,n,i){if("/"!=n[1]&&"/"!=n[6]){var s=n.index+n[1].length,c=(e=n[0].substr(n[1].length,n[0].length-n[6].length),new o({text:e,index:s,ref:t}));if(!e.match(/^\d\.\d$/)&&!e.match(/^\d\.\d{1,2}\.\d{1,2}$/)&&(n[5]||!(n[0].indexOf("/")<0))){var l=n[5]||r(t).year()+"",u=n[4],d=n[3];if(u=parseInt(u),d=parseInt(d),l=parseInt(l),(u<1||u>12)&&u>12){if(!(d>=1&&d<=12&&u>=13&&u<=31))return null;var h=u;u=d,d=h}return d<1||d>31?null:(l<100&&(l+=l>50?1900:2e3),c.start.assign("day",d),c.start.assign("month",u),c.start.assign("year",l),n[2]&&c.start.assign("weekday",a[n[2].toLowerCase()]),c.tags.ESSlashDateFormatParser=!0,c)}}else n.index+=n[0].length}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=/(\W|^)(maintenant|aujourd'hui|ajd|cette\s*nuit|la\s*veille|(demain|hier)(\s*(matin|soir|aprem|apr\xe8s-midi))?|ce\s*(matin|soir)|cet\s*(apr\xe8s-midi|aprem))(?=\W|$)/i;t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return s},this.extract=function(e,t,n,i){e=n[0].substr(n[1].length);var s=n.index+n[1].length,a=new o({index:s,text:e,ref:t}),c=r(t),l=c.clone(),u=e.toLowerCase();return u.match(/demain/)&&c.hour()>1&&l.add(1,"day"),u.match(/hier/)&&l.add(-1,"day"),u.match(/cette\s*nuit/)?(a.start.imply("hour",22),a.start.imply("meridiem",1)):u.match(/la\s*veille/)?(a.start.imply("hour",0),c.hour()>6&&l.add(-1,"day")):u.match(/(apr\xe8s-midi|aprem)/)?a.start.imply("hour",14):u.match(/(soir)/)?a.start.imply("hour",18):u.match(/matin/)?a.start.imply("hour",8):u.match("maintenant")&&(a.start.imply("hour",c.hour()),a.start.imply("minute",c.minute()),a.start.imply("second",c.second()),a.start.imply("millisecond",c.millisecond())),a.start.assign("day",l.date()),a.start.assign("month",l.month()+1),a.start.assign("year",l.year()),a.tags.FRCasualDateParser=!0,a}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(519),a=new RegExp("(\\W|^)(dans|en)\\s*("+s.INTEGER_WORDS_PATTERN+"|[0-9]+|une?|(?:\\s*quelques)?|demi(?:\\s*|-?)?)\\s*(secondes?|min(?:ute)?s?|heures?|jours?|semaines?|mois|ann\xe9es?)\\s*(?=\\W|$)","i"),c=new RegExp("(\\W|^)(dans|en)\\s*("+s.INTEGER_WORDS_PATTERN+"|[0-9]+|un?)\\s*(secondes?|minutes?|heures?|jours?)\\s*(?=\\W|$)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return this.isStrictMode()?c:a},this.extract=function(e,t,n,i){var a=n.index+n[1].length;n[0];e=n[0].substr(n[1].length,n[0].length-n[1].length);var c=new o({index:a,text:e,ref:t}),l=n[3];l=void 0!==s.INTEGER_WORDS[l]?s.INTEGER_WORDS[l]:"un"===l||"une"===l?1:l.match(/quelques?/i)?3:l.match(/demi-?/i)?.5:parseInt(l);var u=r(t);return n[4].match(/jour|semaine|mois|ann\xe9e/i)?(n[4].match(/jour/)?u.add(l,"d"):n[4].match(/semaine/i)?u.add(7*l,"d"):n[4].match(/mois/i)?u.add(l,"month"):n[4].match(/ann\xe9e/i)&&u.add(l,"year"),c.start.assign("year",u.year()),c.start.assign("month",u.month()+1),c.start.assign("day",u.date()),c):(n[4].match(/heure/i)?u.add(l,"hour"):n[4].match(/min/i)?u.add(l,"minutes"):n[4].match(/secondes/i)&&u.add(l,"second"),c.start.imply("year",u.year()),c.start.imply("month",u.month()+1),c.start.imply("day",u.date()),c.start.assign("hour",u.hour()),c.start.assign("minute",u.minute()),c.start.assign("second",u.second()),c.tags.FRDeadlineFormatParser=!0,c)}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(519),a=(s.WEEKDAY_OFFSET,new RegExp("(\\W|^)(?:(Dimanche|Lundi|Mardi|mercredi|Jeudi|Vendredi|Samedi|Dim|Lun|Mar|Mer|Jeu|Ven|Sam)\\s*,?\\s*)?([0-9]{1,2}|1er)(?:\\s*(?:au|\\-|\\\u2013|jusqu'au?|\\s)\\s*([0-9]{1,2})(?:er)?)?\\s*(?:de)?\\s*(Jan(?:vier|\\.)?|F[\xe9e]v(?:rier|\\.)?|Mars|Avr(?:il|\\.)?|Mai|Juin|Juil(?:let|\\.)?|Ao[u\xfb]t|Sept(?:embre|\\.)?|Oct(?:obre|\\.)?|Nov(?:embre|\\.)?|d[\xe9e]c(?:embre|\\.)?)(?:\\s*(\\s*[0-9]{1,4}(?![^\\s]\\d))(?:\\s*(AC|[ap]\\.?\\s*c(?:h(?:r)?)?\\.?\\s*n\\.?))?)?(?=\\W|$)","i"));t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,i){var a=new o({text:n[0].substr(n[1].length,n[0].length-n[1].length),index:n.index+n[1].length,ref:t}),c=n[5];c=s.MONTH_OFFSET[c.toLowerCase()];var l=n[3];l=parseInt(l);var u=null;if(n[6]&&(u=n[6],u=parseInt(u),n[7]?/a/i.test(n[7])&&(u=-u):u<100&&(u+=2e3)),u)a.start.assign("day",l),a.start.assign("month",c),a.start.assign("year",u);else{var d=r(t);d.month(c-1),d.date(l),d.year(r(t).year());var h=d.clone().add(1,"y"),f=d.clone().add(-1,"y");Math.abs(h.diff(r(t)))<Math.abs(d.diff(r(t)))?d=h:Math.abs(f.diff(r(t)))<Math.abs(d.diff(r(t)))&&(d=f),a.start.assign("day",l),a.start.assign("month",c),a.start.imply("year",d.year())}if(n[2]){var p=n[2];p=s.WEEKDAY_OFFSET[p.toLowerCase()],a.start.assign("weekday",p)}return n[4]&&(a.end=a.start.clone(),a.end.assign("day",parseInt(n[4]))),a.tags.FRMonthNameLittleEndianParser=!0,a}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=new RegExp("(\\W|^)(?:((?:dimanche|dim|lundi|lun|mardi|mar|mercredi|mer|jeudi|jeu|vendredi|ven|samedi|sam|le))\\s*\\,?\\s*)?([0-3]{0,1}[0-9]{1})[\\/\\.\\-]([0-3]{0,1}[0-9]{1})(?:[\\/\\.\\-]([0-9]{4}s*,?s*|[0-9]{2}s*,?s*))?(\\W|$)","i"),a={dimanche:0,dim:0,lundi:1,lun:1,mardi:2,mar:2,mercredi:3,mer:3,jeudi:4,jeu:4,vendredi:5,ven:5,samedi:6,sam:6};t.Parser=function(e){i.apply(this,arguments),this.pattern=function(){return s},this.extract=function(e,t,n,i){if("/"!=n[1]&&"/"!=n[6]){var s=n.index+n[1].length,c=(e=n[0].substr(n[1].length,n[0].length-n[6].length),new o({text:e,index:s,ref:t}));if(!e.match(/^\d\.\d$/)&&!e.match(/^\d\.\d{1,2}\.\d{1,2}$/)&&(n[5]||!(n[0].indexOf("/")<0))){var l=n[5]||r(t).year()+"",u=n[4],d=n[3];if(d=parseInt(d),u=parseInt(u),l=parseInt(l),(u<1||u>12)&&u>12){if(!(d>=1&&d<=12&&u>=13&&u<=31))return null;var h=u;u=d,d=h}return d<1||d>31?null:(l<100&&(l+=l>50?1900:2e3),c.start.assign("day",d),c.start.assign("month",u),c.start.assign("year",l),n[2]&&c.start.assign("weekday",a[n[2].toLowerCase()]),c.tags.FRSlashDateFormatParser=!0,c)}}else n.index+=n[0].length}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=/(\W|^)il y a\s*([0-9]+|une?)\s*(minutes?|heures?|semaines?|jours?|mois|ann\xe9es?|ans?)(?=(?:\W|$))/i;t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return s},this.extract=function(e,t,n,i){if(n.index>0&&e[n.index-1].match(/\w/))return null;e=n[0];e=n[0].substr(n[1].length,n[0].length-n[1].length),index=n.index+n[1].length;var s=new o({index:index,text:e,ref:t});s.tags.FRTimeAgoFormatParser=!0;var a=parseInt(n[2]);isNaN(a)&&(a=n[2].match(/demi/)?.5:1);var c=r(t);return n[3].match(/heure/)||n[3].match(/minute/)?(n[3].match(/heure/)?c.add(-a,"hour"):n[3].match(/minute/)&&c.add(-a,"minute"),s.start.imply("day",c.date()),s.start.imply("month",c.month()+1),s.start.imply("year",c.year()),s.start.assign("hour",c.hour()),s.start.assign("minute",c.minute()),s):n[3].match(/semaine/)?(c.add(-a,"week"),s.start.imply("day",c.date()),s.start.imply("month",c.month()+1),s.start.imply("year",c.year()),s.start.imply("weekday",c.day()),s):(n[3].match(/jour/)&&c.add(-a,"d"),n[3].match(/mois/)&&c.add(-a,"month"),n[3].match(/ann\xe9es?|ans?/)&&c.add(-a,"year"),s.start.assign("day",c.date()),s.start.assign("month",c.month()+1),s.start.assign("year",c.year()),s)}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(23).ParsedComponents,a=new RegExp("(^|\\s|T)(?:(?:[\xe0a])\\s*)?(\\d{1,2}(?:h)?|midi|minuit)(?:(?:\\.|\\:|\\\uff1a|h)(\\d{1,2})(?:m)?(?:(?:\\:|\\\uff1a|m)(\\d{0,2})(?:s)?)?)?(?:\\s*(A\\.M\\.|P\\.M\\.|AM?|PM?))?(?=\\W|$)","i"),c=new RegExp("^\\s*(\\-|\\\u2013|\\~|\\\u301c|[\xe0a]|\\?)\\s*(\\d{1,2}(?:h)?)(?:(?:\\.|\\:|\\\uff1a|h)(\\d{1,2})(?:m)?(?:(?:\\.|\\:|\\\uff1a|m)(\\d{1,2})(?:s)?)?)?(?:\\s*(A\\.M\\.|P\\.M\\.|AM?|PM?))?(?=\\W|$)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,i){if(n.index>0&&e[n.index-1].match(/\w/))return null;var a=r(t),l=new o;l.ref=t,l.index=n.index+n[1].length,l.text=n[0].substring(n[1].length),l.tags.FRTimeExpressionParser=!0,l.start.imply("day",a.date()),l.start.imply("month",a.month()+1),l.start.imply("year",a.year());var u=0,d=0,h=-1;if(null!=n[4]){if((p=parseInt(n[4]))>=60)return null;l.start.assign("second",p)}if("midi"==n[2].toLowerCase()?(h=1,u=12):"minuit"==n[2].toLowerCase()?(h=0,u=0):u=parseInt(n[2]),null!=n[3]?d=parseInt(n[3]):u>100&&(d=u%100,u=parseInt(u/100)),d>=60)return null;if(u>24)return null;if(u>=12&&(h=1),null!=n[5]){if(u>12)return null;var f=n[5][0].toLowerCase();"a"==f&&(h=0,12==u&&(u=0)),"p"==f&&(h=1,12!=u&&(u+=12))}if(l.start.assign("hour",u),l.start.assign("minute",d),h>=0&&l.start.assign("meridiem",h),!(n=c.exec(e.substring(l.index+l.text.length))))return l.text.match(/^\d+$/)?null:l;if(n[0].match(/^\s*(\+|\-)\s*\d{3,4}$/))return l;null==l.end&&(l.end=new s(null,l.start.date()));u=0,d=0,h=-1;if(null!=n[4]){var p;if((p=parseInt(n[4]))>=60)return null;l.end.assign("second",p)}if(u=parseInt(n[2]),null!=n[3]){if((d=parseInt(n[3]))>=60)return l}else u>100&&(d=u%100,u=parseInt(u/100));if(d>=60)return null;if(u>24)return null;if(u>=12&&(h=1),null!=n[5]){if(u>12)return null;"a"==n[5][0].toLowerCase()&&(h=0,12==u&&(u=0,l.end.isCertain("day")||l.end.imply("day",l.end.get("day")+1))),"p"==n[5][0].toLowerCase()&&(h=1,12!=u&&(u+=12)),l.start.isCertain("meridiem")||(0==h?(l.start.imply("meridiem",0),12==l.start.get("hour")&&l.start.assign("hour",0)):(l.start.imply("meridiem",1),12!=l.start.get("hour")&&l.start.assign("hour",l.start.get("hour")+12)))}else u>=12&&(h=1);return l.text=l.text+n[0],l.end.assign("hour",u),l.end.assign("minute",d),h>=0&&l.end.assign("meridiem",h),l.end.date().getTime()<l.start.date().getTime()&&l.end.imply("day",l.end.get("day")+1),l}}},function(e,t,n){n(16);var r=n(26).Parser,i=n(23).ParsedResult,o=n(348).updateParsedComponent,s={dimanche:0,dim:0,lundi:1,lun:1,mardi:2,mar:2,mercredi:3,mer:3,jeudi:4,jeu:4,vendredi:5,ven:5,samedi:6,sam:6},a=new RegExp("(\\s|^)(?:(?:\\,|\\(|\\\uff08)\\s*)?(?:(ce)\\s*)?("+Object.keys(s).join("|")+")(?:\\s*(?:\\,|\\)|\\\uff09))?(?:\\s*(dernier|prochain)\\s*)?(?=\\W|$)","i");t.Parser=function(){r.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,r){var a=n.index+n[1].length,c=(e=n[0].substr(n[1].length,n[0].length-n[1].length),new i({index:a,text:e,ref:t})),l=n[3].toLowerCase(),u=s[l];if(void 0===u)return null;var d=null,h=n[2],f=n[4];if(h||f){var p=h||f;"dernier"==(p=p.toLowerCase())?d="last":"prochain"==p?d="next":"ce"==p&&(d="this")}return o(c,t,u,d),c.tags.FRWeekdayParser=!0,c}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(519),a=r.locale();n(836),r.locale(a);var c=new RegExp("(\\W|^)(?:les?|la|l'|du|des?)\\s*("+s.INTEGER_WORDS_PATTERN+"|\\d+)?\\s*(prochaine?s?|derni[e\xe8]re?s?|pass[\xe9e]e?s?|pr[\xe9e]c[\xe9e]dents?|suivante?s?)?\\s*(secondes?|min(?:ute)?s?|heures?|jours?|semaines?|mois|trimestres?|ann\xe9es?)\\s*(prochaine?s?|derni[e\xe8]re?s?|pass[\xe9e]e?s?|pr[\xe9e]c[\xe9e]dents?|suivante?s?)?(?=\\W|$)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return c},this.extract=function(e,t,n,i){var a=n.index+n[1].length;n[0];e=n[0].substr(n[1].length,n[0].length-n[1].length);var c=void 0===n[2]?"1":n[2];c=void 0!==s.INTEGER_WORDS[c]?s.INTEGER_WORDS[c]:parseInt(c);var l=void 0===n[3]?void 0===n[5]?"":n[5].toLowerCase():n[3].toLowerCase();if(l){var u,d=new o({index:a,text:e,ref:t});switch(d.tags.FRRelativeDateFormatParser=!0,!0){case/prochaine?s?/.test(l):case/suivants?/.test(l):u=1;break;case/derni[e\xe8]re?s?/.test(l):case/pass[\xe9e]e?s?/.test(l):case/pr[\xe9e]c[\xe9e]dents?/.test(l):u=-1}var h=c*u,f=r(t),p=r(t);f.locale("fr"),p.locale("fr");var g,m=n[4];switch(!0){case/secondes?/.test(m):f.add(h,"s"),p.add(u,"s"),g="second";break;case/min(?:ute)?s?/.test(m):f.add(h,"m"),p.add(u,"m"),g="minute";break;case/heures?/.test(m):f.add(h,"h"),p.add(u,"h"),g="hour";break;case/jours?/.test(m):f.add(h,"d"),p.add(u,"d"),g="day";break;case/semaines?/.test(m):f.add(h,"w"),p.add(u,"w"),g="week";break;case/mois?/.test(m):f.add(h,"M"),p.add(u,"M"),g="month";break;case/trimestres?/.test(m):f.add(h,"Q"),p.add(u,"Q"),g="quarter";break;case/ann\xe9es?/.test(m):f.add(h,"y"),p.add(u,"y"),g="year"}if(u>0){var y=f;f=p,p=y}return f.startOf(g),p.endOf(g),d.start.assign("year",f.year()),d.start.assign("month",f.month()+1),d.start.assign("day",f.date()),d.start.assign("minute",f.minute()),d.start.assign("second",f.second()),d.start.assign("hour",f.hour()),d.start.assign("millisecond",f.millisecond()),d.end=d.start.clone(),d.end.assign("year",p.year()),d.end.assign("month",p.month()+1),d.end.assign("day",p.date()),d.end.assign("minute",p.minute()),d.end.assign("second",p.second()),d.end.assign("hour",p.hour()),d.end.assign("millisecond",p.millisecond()),d}}}},function(e,t,n){!function(e){"use strict";e.defineLocale("fr",{months:"janvier_f\xe9vrier_mars_avril_mai_juin_juillet_ao\xfbt_septembre_octobre_novembre_d\xe9cembre".split("_"),monthsShort:"janv._f\xe9vr._mars_avr._mai_juin_juil._ao\xfbt_sept._oct._nov._d\xe9c.".split("_"),monthsParseExact:!0,weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"di_lu_ma_me_je_ve_sa".split("_"),weekdaysParseExact:!0,longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY HH:mm",LLLL:"dddd D MMMM YYYY HH:mm"},calendar:{sameDay:"[Aujourd\u2019hui \xe0] LT",nextDay:"[Demain \xe0] LT",nextWeek:"dddd [\xe0] LT",lastDay:"[Hier \xe0] LT",lastWeek:"dddd [dernier \xe0] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",ss:"%d secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},dayOfMonthOrdinalParse:/\d{1,2}(er|)/,ordinal:function(e,t){switch(t){case"D":return e+(1===e?"er":"");default:case"M":case"Q":case"DDD":case"d":return e+(1===e?"er":"e");case"w":case"W":return e+(1===e?"re":"e")}},week:{dow:1,doy:4}})}(n(16))},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(349),a=new RegExp("(\\d{2,4}|["+Object.keys(s.NUMBER).join("")+"]{2,4})?(?:\\s*)(?:\u5e74)?(?:[\\s|,|\uff0c]*)(\\d{1,2}|["+Object.keys(s.NUMBER).join("")+"]{1,2})(?:\\s*)(?:\u6708)(?:\\s*)(\\d{1,2}|["+Object.keys(s.NUMBER).join("")+"]{1,2})?(?:\\s*)(?:\u65e5|\u865f)?");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,i){var a=r(t),c=new o({text:n[0],index:n.index,ref:t}),l=parseInt(n[2]);if(isNaN(l)&&(l=s.zhStringToNumber(n[2])),c.start.assign("month",l),n[3]){var u=parseInt(n[3]);isNaN(u)&&(u=s.zhStringToNumber(n[3])),c.start.assign("day",u)}else c.start.imply("day",a.date());if(n[1]){var d=parseInt(n[1]);isNaN(d)&&(d=s.zhStringToYear(n[1])),c.start.assign("year",d)}else c.start.imply("year",a.year());return c.tags.ZHHantDateParser=!0,c}}},function(e,t,n){n(16);var r=n(26).Parser,i=n(23).ParsedResult,o=n(348).updateParsedComponent,s=n(349),a=new RegExp("(\u4e0a|\u4eca|\u4e0b|\u9019|\u5462)?(?:\u500b)?(?:\u661f\u671f|\u79ae\u62dc)("+Object.keys(s.WEEKDAY_OFFSET).join("|")+")");t.Parser=function(){r.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,r){var a=n.index;e=n[0];var c=new i({index:a,text:e,ref:t}),l=n[2],u=s.WEEKDAY_OFFSET[l];if(void 0===u)return null;var d=null,h=n[1];return"\u4e0a"==h?d="last":"\u4e0b"==h?d="next":"\u4eca"!=h&&"\u9019"!=h&&"\u5462"!=h||(d="this"),o(c,t,u,d),c.tags.ZHHantWeekdayParser=!0,c}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(23).ParsedComponents,a=n(349),c="(?:\u7531|\u5f9e|\u81ea)?(?:(\u4eca|\u660e|\u807d|\u6628|\u5c0b|\u7434)(\u65e9|\u671d|\u665a)|(\u4e0a(?:\u5348|\u665d)|\u671d(?:\u65e9)|\u65e9(?:\u4e0a)|\u4e0b(?:\u5348|\u665d)|\u664f(?:\u665d)|\u665a(?:\u4e0a)|\u591c(?:\u665a)?|\u4e2d(?:\u5348)|\u51cc(?:\u6668))|(\u4eca|\u660e|\u807d|\u6628|\u5c0b|\u7434)(?:\u65e5|\u5929)(?:[\\s,\uff0c]*)(?:(\u4e0a(?:\u5348|\u665d)|\u671d(?:\u65e9)|\u65e9(?:\u4e0a)|\u4e0b(?:\u5348|\u665d)|\u664f(?:\u665d)|\u665a(?:\u4e0a)|\u591c(?:\u665a)?|\u4e2d(?:\u5348)|\u51cc(?:\u6668)))?)?(?:[\\s,\uff0c]*)(?:(\\d+|["+Object.keys(a.NUMBER).join("")+"]+)(?:\\s*)(?:\u9ede|\u6642|:|\uff1a)(?:\\s*)(\\d+|\u534a|\u6b63|\u6574|["+Object.keys(a.NUMBER).join("")+"]+)?(?:\\s*)(?:\u5206|:|\uff1a)?(?:\\s*)(\\d+|["+Object.keys(a.NUMBER).join("")+"]+)?(?:\\s*)(?:\u79d2)?)(?:\\s*(A.M.|P.M.|AM?|PM?))?",l="(?:\\s*(?:\u5230|\u81f3|\\-|\\\u2013|\\~|\\\u301c)\\s*)(?:(\u4eca|\u660e|\u807d|\u6628|\u5c0b|\u7434)(\u65e9|\u671d|\u665a)|(\u4e0a(?:\u5348|\u665d)|\u671d(?:\u65e9)|\u65e9(?:\u4e0a)|\u4e0b(?:\u5348|\u665d)|\u664f(?:\u665d)|\u665a(?:\u4e0a)|\u591c(?:\u665a)?|\u4e2d(?:\u5348)|\u51cc(?:\u6668))|(\u4eca|\u660e|\u807d|\u6628|\u5c0b|\u7434)(?:\u65e5|\u5929)(?:[\\s,\uff0c]*)(?:(\u4e0a(?:\u5348|\u665d)|\u671d(?:\u65e9)|\u65e9(?:\u4e0a)|\u4e0b(?:\u5348|\u665d)|\u664f(?:\u665d)|\u665a(?:\u4e0a)|\u591c(?:\u665a)?|\u4e2d(?:\u5348)|\u51cc(?:\u6668)))?)?(?:[\\s,\uff0c]*)(?:(\\d+|["+Object.keys(a.NUMBER).join("")+"]+)(?:\\s*)(?:\u9ede|\u6642|:|\uff1a)(?:\\s*)(\\d+|\u534a|\u6b63|\u6574|["+Object.keys(a.NUMBER).join("")+"]+)?(?:\\s*)(?:\u5206|:|\uff1a)?(?:\\s*)(\\d+|["+Object.keys(a.NUMBER).join("")+"]+)?(?:\\s*)(?:\u79d2)?)(?:\\s*(A.M.|P.M.|AM?|PM?))?",u=new RegExp(c,"i"),d=new RegExp(l,"i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return u},this.extract=function(e,t,n,i){if(n.index>0&&e[n.index-1].match(/\w/))return null;var c=r(t),l=new o;l.ref=t,l.index=n.index,l.text=n[0],l.tags.ZHTimeExpressionParser=!0;var u=c.clone();if(n[1])"\u660e"==(m=n[1])||"\u807d"==m?c.hour()>1&&u.add(1,"day"):"\u6628"!=m&&"\u5c0b"!=m&&"\u7434"!=m||u.add(-1,"day"),l.start.assign("day",u.date()),l.start.assign("month",u.month()+1),l.start.assign("year",u.year());else if(n[4]){"\u660e"==(v=n[4])||"\u807d"==v?u.add(1,"day"):"\u6628"!=v&&"\u5c0b"!=v&&"\u7434"!=v||u.add(-1,"day"),l.start.assign("day",u.date()),l.start.assign("month",u.month()+1),l.start.assign("year",u.year())}else l.start.imply("day",u.date()),l.start.imply("month",u.month()+1),l.start.imply("year",u.year());var h=0,f=0,p=-1;if(n[8]){var g=parseInt(n[8]);if(isNaN(g)&&(g=a.zhStringToNumber(n[8])),g>=60)return null;l.start.assign("second",g)}if(h=parseInt(n[6]),isNaN(h)&&(h=a.zhStringToNumber(n[6])),n[7]?"\u534a"==n[7]?f=30:"\u6b63"==n[7]||"\u6574"==n[7]?f=0:(f=parseInt(n[7]),isNaN(f)&&(f=a.zhStringToNumber(n[7]))):h>100&&(f=h%100,h=parseInt(h/100)),f>=60)return null;if(h>24)return null;if(h>=12&&(p=1),n[9]){if(h>12)return null;"a"==(b=n[9][0].toLowerCase())&&(p=0,12==h&&(h=0)),"p"==b&&(p=1,12!=h&&(h+=12))}else if(n[2]){"\u671d"==(_=n[2][0])||"\u65e9"==_?(p=0,12==h&&(h=0)):"\u665a"==_&&(p=1,12!=h&&(h+=12))}else if(n[3]){"\u4e0a"==(w=n[3][0])||"\u671d"==w||"\u65e9"==w||"\u51cc"==w?(p=0,12==h&&(h=0)):"\u4e0b"!=w&&"\u664f"!=w&&"\u665a"!=w||(p=1,12!=h&&(h+=12))}else if(n[5]){"\u4e0a"==(T=n[5][0])||"\u671d"==T||"\u65e9"==T||"\u51cc"==T?(p=0,12==h&&(h=0)):"\u4e0b"!=T&&"\u664f"!=T&&"\u665a"!=T||(p=1,12!=h&&(h+=12))}if(l.start.assign("hour",h),l.start.assign("minute",f),p>=0?l.start.assign("meridiem",p):h<12?l.start.imply("meridiem",0):l.start.imply("meridiem",1),!(n=d.exec(e.substring(l.index+l.text.length))))return l.text.match(/^\d+$/)?null:l;var m,y=u.clone();if(l.end=new s(null,null),n[1])"\u660e"==(m=n[1])||"\u807d"==m?c.hour()>1&&y.add(1,"day"):"\u6628"!=m&&"\u5c0b"!=m&&"\u7434"!=m||y.add(-1,"day"),l.end.assign("day",y.date()),l.end.assign("month",y.month()+1),l.end.assign("year",y.year());else if(n[4]){var v;"\u660e"==(v=n[4])||"\u807d"==v?y.add(1,"day"):"\u6628"!=v&&"\u5c0b"!=v&&"\u7434"!=v||y.add(-1,"day"),l.end.assign("day",y.date()),l.end.assign("month",y.month()+1),l.end.assign("year",y.year())}else l.end.imply("day",y.date()),l.end.imply("month",y.month()+1),l.end.imply("year",y.year());if(h=0,f=0,p=-1,n[8]){g=parseInt(n[8]);if(isNaN(g)&&(g=a.zhStringToNumber(n[8])),g>=60)return null;l.end.assign("second",g)}if(h=parseInt(n[6]),isNaN(h)&&(h=a.zhStringToNumber(n[6])),n[7]?"\u534a"==n[7]?f=30:"\u6b63"==n[7]||"\u6574"==n[7]?f=0:(f=parseInt(n[7]),isNaN(f)&&(f=a.zhStringToNumber(n[7]))):h>100&&(f=h%100,h=parseInt(h/100)),f>=60)return null;if(h>24)return null;if(h>=12&&(p=1),n[9]){if(h>12)return null;var b;"a"==(b=n[9][0].toLowerCase())&&(p=0,12==h&&(h=0)),"p"==b&&(p=1,12!=h&&(h+=12)),l.start.isCertain("meridiem")||(0==p?(l.start.imply("meridiem",0),12==l.start.get("hour")&&l.start.assign("hour",0)):(l.start.imply("meridiem",1),12!=l.start.get("hour")&&l.start.assign("hour",l.start.get("hour")+12)))}else if(n[2]){var _;"\u671d"==(_=n[2][0])||"\u65e9"==_?(p=0,12==h&&(h=0)):"\u665a"==_&&(p=1,12!=h&&(h+=12))}else if(n[3]){var w;"\u4e0a"==(w=n[3][0])||"\u671d"==w||"\u65e9"==w||"\u51cc"==w?(p=0,12==h&&(h=0)):"\u4e0b"!=w&&"\u664f"!=w&&"\u665a"!=w||(p=1,12!=h&&(h+=12))}else if(n[5]){var T;"\u4e0a"==(T=n[5][0])||"\u671d"==T||"\u65e9"==T||"\u51cc"==T?(p=0,12==h&&(h=0)):"\u4e0b"!=T&&"\u664f"!=T&&"\u665a"!=T||(p=1,12!=h&&(h+=12))}(l.text=l.text+n[0],l.end.assign("hour",h),l.end.assign("minute",f),p>=0)?l.end.assign("meridiem",p):l.start.isCertain("meridiem")&&1==l.start.get("meridiem")&&l.start.get("hour")>h?l.end.imply("meridiem",0):h>12&&l.end.imply("meridiem",1);return l.end.date().getTime()<l.start.date().getTime()&&l.end.imply("day",l.end.get("day")+1),l}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=new RegExp("(\u800c\u5bb6|\u7acb(?:\u523b|\u5373)|\u5373\u523b)|(\u4eca|\u660e|\u807d|\u6628|\u5c0b|\u7434)(\u65e9|\u671d|\u665a)|(\u4e0a(?:\u5348|\u665d)|\u671d(?:\u65e9)|\u65e9(?:\u4e0a)|\u4e0b(?:\u5348|\u665d)|\u664f(?:\u665d)|\u665a(?:\u4e0a)|\u591c(?:\u665a)?|\u4e2d(?:\u5348)|\u51cc(?:\u6668))|(\u4eca|\u660e|\u807d|\u6628|\u5c0b|\u7434)(?:\u65e5|\u5929)(?:[\\s|,|\uff0c]*)(?:(\u4e0a(?:\u5348|\u665d)|\u671d(?:\u65e9)|\u65e9(?:\u4e0a)|\u4e0b(?:\u5348|\u665d)|\u664f(?:\u665d)|\u665a(?:\u4e0a)|\u591c(?:\u665a)?|\u4e2d(?:\u5348)|\u51cc(?:\u6668)))?","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return s},this.extract=function(e,t,n,i){e=n[0];var s=n.index,a=new o({index:s,text:e,ref:t}),c=r(t),l=c.clone();if(n[1])a.start.imply("hour",c.hour()),a.start.imply("minute",c.minute()),a.start.imply("second",c.second()),a.start.imply("millisecond",c.millisecond());else if(n[2]){var u=n[2],d=n[3];"\u660e"==u||"\u807d"==u?c.hour()>1&&l.add(1,"day"):"\u6628"!=u&&"\u5c0b"!=u&&"\u7434"!=u||l.add(-1,"day"),"\u65e9"==d||"\u671d"==d?a.start.imply("hour",6):"\u665a"==d&&(a.start.imply("hour",22),a.start.imply("meridiem",1))}else if(n[4]){var h=n[4][0];"\u65e9"==h||"\u671d"==h||"\u4e0a"==h?a.start.imply("hour",6):"\u4e0b"==h||"\u664f"==h?(a.start.imply("hour",15),a.start.imply("meridiem",1)):"\u4e2d"==h?(a.start.imply("hour",12),a.start.imply("meridiem",1)):"\u591c"==h||"\u665a"==h?(a.start.imply("hour",22),a.start.imply("meridiem",1)):"\u51cc"==h&&a.start.imply("hour",0)}else if(n[5]){var f=n[5];"\u660e"==f||"\u807d"==f?c.hour()>1&&l.add(1,"day"):"\u6628"!=f&&"\u5c0b"!=f&&"\u7434"!=f||l.add(-1,"day");var p=n[6];if(p){var g=p[0];"\u65e9"==g||"\u671d"==g||"\u4e0a"==g?a.start.imply("hour",6):"\u4e0b"==g||"\u664f"==g?(a.start.imply("hour",15),a.start.imply("meridiem",1)):"\u4e2d"==g?(a.start.imply("hour",12),a.start.imply("meridiem",1)):"\u591c"==g||"\u665a"==g?(a.start.imply("hour",22),a.start.imply("meridiem",1)):"\u51cc"==g&&a.start.imply("hour",0)}}return a.start.assign("day",l.date()),a.start.assign("month",l.month()+1),a.start.assign("year",l.year()),a.tags.ZHHantCasualDateParser=!0,a}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(349),a=new RegExp("(\\d+|["+Object.keys(s.NUMBER).join("")+"]+|\u534a|\u5e7e)(?:\\s*)(?:\u500b)?(\u79d2(?:\u9418)?|\u5206\u9418|\u5c0f\u6642|\u9418|\u65e5|\u5929|\u661f\u671f|\u79ae\u62dc|\u6708|\u5e74)(?:(?:\u4e4b|\u904e)?\u5f8c|(?:\u4e4b)?\u5167)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,i){var a=n.index;e=n[0];var c=new o({index:a,text:e,ref:t}),l=parseInt(n[1]);if(isNaN(l)&&(l=s.zhStringToNumber(n[1])),isNaN(l)){var u=n[1];if("\u5e7e"===u)l=3;else{if("\u534a"!==u)return null;l=.5}}var d=r(t),h=n[2][0];return h.match(/[\u65e5\u5929\u661f\u79ae\u6708\u5e74]/)?("\u65e5"==h||"\u5929"==h?d.add(l,"d"):"\u661f"==h||"\u79ae"==h?d.add(7*l,"d"):"\u6708"==h?d.add(l,"month"):"\u5e74"==h&&d.add(l,"year"),c.start.assign("year",d.year()),c.start.assign("month",d.month()+1),c.start.assign("day",d.date()),c):("\u79d2"==h?d.add(l,"second"):"\u5206"==h?d.add(l,"minute"):"\u5c0f"!=h&&"\u9418"!=h||d.add(l,"hour"),c.start.imply("year",d.year()),c.start.imply("month",d.month()+1),c.start.imply("day",d.date()),c.start.assign("hour",d.hour()),c.start.assign("minute",d.minute()),c.start.assign("second",d.second()),c.tags.ZHHantDeadlineFormatParser=!0,c)}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(350),a=new RegExp("(\\W|^)(in|nach)\\s*("+s.INTEGER_WORDS_PATTERN+"|[0-9]+|einigen|eine[rm]\\s*halben|eine[rm])\\s*(sekunden?|min(?:ute)?n?|stunden?|tag(?:en)?|wochen?|monat(?:en)?|jahr(?:en)?)\\s*(?=\\W|$)","i"),c=new RegExp("(\\W|^)(in|nach)\\s*("+s.INTEGER_WORDS_PATTERN+"|[0-9]+|eine(?:r|m)?)\\s*(sekunden?|minuten?|stunden?|tag(?:en)?)\\s*(?=\\W|$)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return this.isStrictMode()?c:a},this.extract=function(e,t,n,i){var a=n.index+n[1].length;n[0];e=n[0].substr(n[1].length,n[0].length-n[1].length);var c=new o({index:a,text:e,ref:t}),l=n[3].toLowerCase();l=void 0!==s.INTEGER_WORDS[l]?s.INTEGER_WORDS[l]:"einer"===l||"einem"===l?1:"einigen"===l?3:/halben/.test(l)?.5:parseInt(l);var u=r(t);return/tag|woche|monat|jahr/i.test(n[4])?(/tag/i.test(n[4])?u.add(l,"d"):/woche/i.test(n[4])?u.add(7*l,"d"):/monat/i.test(n[4])?u.add(l,"month"):/jahr/i.test(n[4])&&u.add(l,"year"),c.start.assign("year",u.year()),c.start.assign("month",u.month()+1),c.start.assign("day",u.date()),c):(/stunde/i.test(n[4])?u.add(l,"hour"):/min/i.test(n[4])?u.add(l,"minute"):/sekunde/i.test(n[4])&&u.add(l,"second"),c.start.imply("year",u.year()),c.start.imply("month",u.month()+1),c.start.imply("day",u.date()),c.start.assign("hour",u.hour()),c.start.assign("minute",u.minute()),c.start.assign("second",u.second()),c.tags.DEDeadlineFormatParser=!0,c)}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(350),a=new RegExp("(\\W|^)(?:am\\s*?)?(?:(Sonntag|Montag|Dienstag|Mittwoch|Donnerstag|Freitag|Samstag|So|Mo|Di|Mi|Do|Fr|Sa)\\s*,?\\s*)?(?:den\\s*)?([0-9]{1,2})\\.(?:\\s*(?:bis(?:\\s*(?:am|zum))?|\\-|\\\u2013|\\s)\\s*([0-9]{1,2})\\.)?\\s*(Jan(?:uar|\\.)?|Feb(?:ruar|\\.)?|M\xe4r(?:z|\\.)?|Maerz|Mrz\\.?|Apr(?:il|\\.)?|Mai|Jun(?:i|\\.)?|Jul(?:i|\\.)?|Aug(?:ust|\\.)?|Sep(?:t|t\\.|tember|\\.)?|Okt(?:ober|\\.)?|Nov(?:ember|\\.)?|Dez(?:ember|\\.)?)(?:,?\\s*([0-9]{1,4}(?![^\\s]\\d))(\\s*[vn]\\.?\\s*C(?:hr)?\\.?)?)?(?=\\W|$)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,i){var a=new o({text:n[0].substr(n[1].length,n[0].length-n[1].length),index:n.index+n[1].length,ref:t}),c=n[5];c=s.MONTH_OFFSET[c.toLowerCase()];var l=n[3];l=parseInt(l);var u=null;if(n[6]&&(u=n[6],u=parseInt(u),n[7]?/v/i.test(n[7])&&(u=-u):u<100&&(u+=2e3)),u)a.start.assign("day",l),a.start.assign("month",c),a.start.assign("year",u);else{var d=r(t);d.month(c-1),d.date(l),d.year(r(t).year());var h=d.clone().add(1,"y"),f=d.clone().add(-1,"y");Math.abs(h.diff(r(t)))<Math.abs(d.diff(r(t)))?d=h:Math.abs(f.diff(r(t)))<Math.abs(d.diff(r(t)))&&(d=f),a.start.assign("day",l),a.start.assign("month",c),a.start.imply("year",d.year())}if(n[2]){var p=n[2];p=s.WEEKDAY_OFFSET[p.toLowerCase()],a.start.assign("weekday",p)}return n[4]&&(a.end=a.start.clone(),a.end.assign("day",parseInt(n[4]))),a.tags.DEMonthNameLittleEndianParser=!0,a}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(350),a=new RegExp("(^|\\D\\s+|[^\\w\\s])(Jan\\.?|Januar|Feb\\.?|Februar|M\xe4r\\.?|M(?:\xe4|ae)rz|Mrz\\.?|Apr\\.?|April|Mai\\.?|Jun\\.?|Juni|Jul\\.?|Juli|Aug\\.?|August|Sep\\.?|Sept\\.?|September|Okt\\.?|Oktober|Nov\\.?|November|Dez\\.?|Dezember)\\s*(?:,?\\s*(?:([0-9]{4})(\\s*[vn]\\.?\\s*C(?:hr)?\\.?)?|([0-9]{1,4})\\s*([vn]\\.?\\s*C(?:hr)?\\.?)))?(?=[^\\s\\w]|$)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,i){var a=new o({text:n[0].substr(n[1].length,n[0].length-n[1].length),index:n.index+n[1].length,ref:t}),c=n[2];c=s.MONTH_OFFSET[c.toLowerCase()];var l=null;if((n[3]||n[5])&&(l=n[3]||n[5],l=parseInt(l),n[4]||n[6]?/v/i.test(n[4]||n[6])&&(l=-l):l<100&&(l+=2e3)),l)a.start.imply("day",1),a.start.assign("month",c),a.start.assign("year",l);else{var u=r(t);u.month(c-1),u.date(1);var d=u.clone().add(1,"y"),h=u.clone().add(-1,"y");Math.abs(d.diff(r(t)))<Math.abs(u.diff(r(t)))?u=d:Math.abs(h.diff(r(t)))<Math.abs(u.diff(r(t)))&&(u=h),a.start.imply("day",1),a.start.assign("month",c),a.start.imply("year",u.year())}return a.tags.DEMonthNameParser=!0,a}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=new RegExp("(\\W|^)(?:(?:am\\s*?)?((?:sonntag|so|montag|mo|dienstag|di|mittwoch|mi|donnerstag|do|freitag|fr|samstag|sa))\\s*\\,?\\s*(?:den\\s*)?)?([0-3]{0,1}[0-9]{1})[\\/\\.\\-]([0-3]{0,1}[0-9]{1})(?:[\\/\\.\\-]([0-9]{4}s*,?s*|[0-9]{2}s*,?s*))?(\\W|$)","i"),a={sonntag:0,so:0,montag:1,mo:1,dienstag:2,di:2,mittwoch:3,mi:3,donnerstag:4,do:4,freitag:5,fr:5,samstag:6,sa:6};t.Parser=function(e){i.apply(this,arguments),this.pattern=function(){return s},this.extract=function(e,t,n,i){if("/"!=n[1]&&"/"!=n[6]){var s=n.index+n[1].length,c=(e=n[0].substr(n[1].length,n[0].length-n[6].length),new o({text:e,index:s,ref:t}));if(!e.match(/^\d\.\d$/)&&!e.match(/^\d\.\d{1,2}\.\d{1,2}$/)&&(n[5]||!(n[0].indexOf("/")<0))){var l=n[5]||r(t).year()+"",u=n[4],d=n[3];return u=parseInt(u),d=parseInt(d),l=parseInt(l),u<1||u>12?null:d<1||d>31?null:(l<100&&(l+=l>50?1900:2e3),c.start.assign("day",d),c.start.assign("month",u),c.start.assign("year",l),n[2]&&c.start.assign("weekday",a[n[2].toLowerCase()]),c.tags.DESlashDateFormatParser=!0,c)}}else n.index+=n[0].length}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(350),a=new RegExp("(\\W|^)vor\\s*("+s.INTEGER_WORDS_PATTERN+"|[0-9]+|einigen|eine[rm]\\s*halben|eine[rm])\\s*(sekunden?|min(?:ute)?n?|stunden?|wochen?|tag(?:en)?|monat(?:en)?|jahr(?:en)?)\\s*(?=(?:\\W|$))","i"),c=new RegExp("(\\W|^)vor\\s*([0-9]+|eine(?:r|m))\\s*(sekunden?|minuten?|stunden?|tag(?:en)?)(?=(?:\\W|$))","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return this.isStrictMode()?c:a},this.extract=function(e,t,n,i){if(n.index>0&&e[n.index-1].match(/\w/))return null;e=n[0];e=n[0].substr(n[1].length,n[0].length-n[1].length),index=n.index+n[1].length;var a=new o({index:index,text:e,ref:t}),c=n[2].toLowerCase();c=void 0!==s.INTEGER_WORDS[c]?s.INTEGER_WORDS[c]:"einer"===c||"einem"===c?1:"einigen"===c?3:/halben/.test(c)?.5:parseInt(c);var l=r(t);return/stunde|min|sekunde/i.test(n[3])?(/stunde/i.test(n[3])?l.add(-c,"hour"):/min/i.test(n[3])?l.add(-c,"minute"):/sekunde/i.test(n[3])&&l.add(-c,"second"),a.start.imply("day",l.date()),a.start.imply("month",l.month()+1),a.start.imply("year",l.year()),a.start.assign("hour",l.hour()),a.start.assign("minute",l.minute()),a.start.assign("second",l.second()),a.tags.DETimeAgoFormatParser=!0,a):/woche/i.test(n[3])?(l.add(-c,"week"),a.start.imply("day",l.date()),a.start.imply("month",l.month()+1),a.start.imply("year",l.year()),a.start.imply("weekday",l.day()),a):(/tag/i.test(n[3])&&l.add(-c,"d"),/monat/i.test(n[3])&&l.add(-c,"month"),/jahr/i.test(n[3])&&l.add(-c,"year"),a.start.assign("day",l.date()),a.start.assign("month",l.month()+1),a.start.assign("year",l.year()),a)}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=n(23).ParsedComponents,a=new RegExp("(^|\\s|T)(?:(?:um|von)\\s*)?(\\d{1,4}|mittags?|mitternachts?)(?:(?:\\.|\\:|\\\uff1a)(\\d{1,2})(?:(?:\\:|\\\uff1a)(\\d{2}))?)?(?:\\s*uhr)?(?:\\s*(morgens|vormittags|mittags|nachmittags|abends|nachts))?(?=\\W|$)","i"),c=new RegExp("^\\s*(\\-|\\\u2013|\\~|\\\u301c|bis|\\?)\\s*(\\d{1,4})(?:(?:\\.|\\:|\\\uff1a)(\\d{1,2})(?:(?:\\.|\\:|\\\uff1a)(\\d{1,2}))?)?(?:\\s*(morgens|vormittags|mittags|nachmittags|abends|nachts))?(?=\\W|$)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,i){if(n.index>0&&e[n.index-1].match(/\w/))return null;var a=r(t),l=new o;l.ref=t,l.index=n.index+n[1].length,l.text=n[0].substring(n[1].length),l.tags.DETimeExpressionParser=!0,l.start.imply("day",a.date()),l.start.imply("month",a.month()+1),l.start.imply("year",a.year());var u=0,d=0,h=-1;if(null!=n[4]){if((f=parseInt(n[4]))>=60)return null;l.start.assign("second",f)}if(/mittags?/i.test(n[2])?(h=1,u=12):/mitternachts?/i.test(n[2])?(h=0,u=0):u=parseInt(n[2]),null!=n[3]?d=parseInt(n[3]):u>100&&(d=u%100,u=parseInt(u/100)),d>=60)return null;if(u>24)return null;if(u>=12&&(h=1),null!=n[5]){if(u>12)return null;"morgens"===(p=n[5][0].toLowerCase())||"vormittags"===p?(h=0,12==u&&(u=0)):(h=1,12!=u&&(u+=12))}if(l.start.assign("hour",u),l.start.assign("minute",d),h>=0?l.start.assign("meridiem",h):u<12?l.start.imply("meridiem",0):l.start.imply("meridiem",1),!(n=c.exec(e.substring(l.index+l.text.length))))return l.text.match(/^\d+$/)?null:l;if(n[0].match(/^\s*(\+|\-)\s*\d{3,4}$/))return l;null==l.end&&(l.end=new s(null,l.start.date()));u=0,d=0,h=-1;if(null!=n[4]){var f;if((f=parseInt(n[4]))>=60)return null;l.end.assign("second",f)}if(u=parseInt(n[2]),null!=n[3]){if((d=parseInt(n[3]))>=60)return l}else u>100&&(d=u%100,u=parseInt(u/100));if(d>=60)return null;if(u>24)return null;if(u>=12&&(h=1),null!=n[5]){if(u>12)return null;var p;"morgens"===(p=n[5][0].toLowerCase())||"vormittags"===p?(h=0,12==u&&(u=0,l.end.isCertain("day")||l.end.imply("day",l.end.get("day")+1))):(h=1,12!=u&&(u+=12)),l.start.isCertain("meridiem")||(0==h?(l.start.imply("meridiem",0),12==l.start.get("hour")&&l.start.assign("hour",0)):(l.start.imply("meridiem",1),12!=l.start.get("hour")&&l.start.assign("hour",l.start.get("hour")+12)))}(l.text=l.text+n[0],l.end.assign("hour",u),l.end.assign("minute",d),h>=0)?l.end.assign("meridiem",h):l.start.isCertain("meridiem")&&1==l.start.get("meridiem")&&l.start.get("hour")>u?l.end.imply("meridiem",0):u>12&&l.end.imply("meridiem",1);return l.end.date().getTime()<l.start.date().getTime()&&l.end.imply("day",l.end.get("day")+1),l}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s={sonntag:0,so:0,montag:1,mo:1,dienstag:2,di:2,mittwoch:3,mi:3,donnerstag:4,do:4,freitag:5,fr:5,samstag:6,sa:6},a=new RegExp("(\\W|^)(?:(?:\\,|\\(|\\\uff08)\\s*)?(?:a[mn]\\s*?)?(?:(diese[mn]|letzte[mn]|n(?:\xe4|ae)chste[mn])\\s*)?("+Object.keys(s).join("|")+")(?:\\s*(?:\\,|\\)|\\\uff09))?(?:\\s*(diese|letzte|n(?:\xe4|ae)chste)\\s*woche)?(?=\\W|$)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return a},this.extract=function(e,t,n,i){var a=n.index+n[1].length,c=(e=n[0].substr(n[1].length,n[0].length-n[1].length),new o({index:a,text:e,ref:t})),l=n[3].toLowerCase(),u=s[l];if(void 0===u)return null;var d=r(t),h=n[2],f=n[4],p=d.day(),g=h||f;return g=(g=g||"").toLowerCase(),/letzte/.test(g)?d.day(u-7):/n(?:\xe4|ae)chste/.test(g)?d.day(u+7):/diese/.test(g)?i.forwardDatesOnly&&p>u?d.day(u+7):d.day(u):i.forwardDatesOnly&&p>u?d.day(u+7):!i.forwardDatesOnly&&Math.abs(u-7-p)<Math.abs(u-p)?d.day(u-7):!i.forwardDatesOnly&&Math.abs(u+7-p)<Math.abs(u-p)?d.day(u+7):d.day(u),c.start.assign("weekday",u),c.start.imply("day",d.date()),c.start.imply("month",d.month()+1),c.start.imply("year",d.year()),c}}},function(e,t,n){var r=n(16),i=n(26).Parser,o=n(23).ParsedResult,s=new RegExp("(\\W|^)(jetzt|(?:heute|diesen)\\s*(morgen|vormittag|mittag|nachmittag|abend)|(?:heute|diese)\\s*nacht|heute|(?:(?:\xfc|ue)ber)?morgen(?:\\s*(morgen|vormittag|mittag|nachmittag|abend|nacht))?|(?:vor)?gestern(?:\\s*(morgen|vormittag|mittag|nachmittag|abend|nacht))?|letzte\\s*nacht)(?=\\W|$)","i");t.Parser=function(){i.apply(this,arguments),this.pattern=function(){return s},this.extract=function(e,t,n,i){e=n[0].substr(n[1].length);var s=n.index+n[1].length,a=new o({index:s,text:e,ref:t}),c=r(t),l=c.clone(),u=e.toLowerCase();/(?:heute|diese)\s*nacht/.test(u)?(a.start.imply("hour",22),a.start.imply("meridiem",1)):/^(?:\xfc|ue)bermorgen/.test(u)?l.add(c.hour()>1?2:1,"day"):/^morgen/.test(u)?c.hour()>1&&l.add(1,"day"):/^gestern/.test(u)?l.add(-1,"day"):/^vorgestern/.test(u)?l.add(-2,"day"):/letzte\s*nacht/.test(u)?(a.start.imply("hour",0),c.hour()>6&&l.add(-1,"day")):"jetzt"===u&&(a.start.imply("hour",c.hour()),a.start.imply("minute",c.minute()),a.start.imply("second",c.second()),a.start.imply("millisecond",c.millisecond()));var d=n[3]||n[4]||n[5];if(d)switch(d.toLowerCase()){case"morgen":a.start.imply("hour",6);break;case"vormittag":a.start.imply("hour",9);break;case"mittag":a.start.imply("hour",12);break;case"nachmittag":a.start.imply("hour",15),a.start.imply("meridiem",1);break;case"abend":a.start.imply("hour",18),a.start.imply("meridiem",1);break;case"nacht":a.start.imply("hour",0)}return a.start.assign("day",l.date()),a.start.assign("month",l.month()+1),a.start.assign("year",l.year()),a.tags.DECasualDateParser=!0,a}}},function(e,t,n){var r=n(112).Refiner;t.Refiner=function(){r.call(this),this.refine=function(e,t,n){if(t.length<2)return t;for(var r=[],i=t[0],o=1;o<t.length;o++){var s=t[o];s.index<i.index+i.text.length?s.text.length>i.text.length&&(i=s):(r.push(i),i=s)}return null!=i&&r.push(i),r}}},function(e,t,n){var r=n(112).Refiner,i=new RegExp("^\\s*(GMT|UTC)?(\\+|\\-)(\\d{1,2}):?(\\d{2})","i");t.Refiner=function(){r.call(this),this.refine=function(e,t,n){return t.forEach((function(t){if(!t.start.isCertain("timezoneOffset")){var n=i.exec(e.substring(t.index+t.text.length));if(n){var r=60*parseInt(n[3])+parseInt(n[4]);"-"===n[2]&&(r=-r),null!=t.end&&t.end.assign("timezoneOffset",r),t.start.assign("timezoneOffset",r),t.text+=n[0],t.tags.ExtractTimezoneOffsetRefiner=!0}}})),t}}},function(e,t,n){var r=n(112).Refiner,i={},o=new RegExp("^\\s*\\(?([A-Z]{2,4})\\)?(?=\\W|$)","i");t.Refiner=function(){r.call(this),this.refine=function(e,t,n){return t.forEach((function(t){if(t.tags.ENTimeExpressionParser||t.tags.ZHTimeExpressionParser||t.tags.FRTimeExpressionParser||t.tags.DETimeExpressionParser){var n=o.exec(e.substring(t.index+t.text.length));if(n){var r=n[1].toUpperCase();if(void 0===i[r])return;var s=i[r];t.start.isCertain("timezoneOffset")||t.start.assign("timezoneOffset",s),null==t.end||t.end.isCertain("timezoneOffset")||t.end.assign("timezoneOffset",s),t.text+=n[0],t.tags.ExtractTimezoneAbbrRefiner=!0}}})),t}},i={ACDT:630,ACST:570,ADT:-180,AEDT:660,AEST:600,AFT:270,AKDT:-480,AKST:-540,ALMT:360,AMST:-180,AMT:-240,ANAST:720,ANAT:720,AQTT:300,ART:-180,AST:-240,AWDT:540,AWST:480,AZOST:0,AZOT:-60,AZST:300,AZT:240,BNT:480,BOT:-240,BRST:-120,BRT:-180,BST:60,BTT:360,CAST:480,CAT:120,CCT:390,CDT:-300,CEST:120,CET:60,CHADT:825,CHAST:765,CKT:-600,CLST:-180,CLT:-240,COT:-300,CST:-360,CVT:-60,CXT:420,ChST:600,DAVT:420,EASST:-300,EAST:-360,EAT:180,ECT:-300,EDT:-240,EEST:180,EET:120,EGST:0,EGT:-60,EST:-300,ET:-300,FJST:780,FJT:720,FKST:-180,FKT:-240,FNT:-120,GALT:-360,GAMT:-540,GET:240,GFT:-180,GILT:720,GMT:0,GST:240,GYT:-240,HAA:-180,HAC:-300,HADT:-540,HAE:-240,HAP:-420,HAR:-360,HAST:-600,HAT:-90,HAY:-480,HKT:480,HLV:-210,HNA:-240,HNC:-360,HNE:-300,HNP:-480,HNR:-420,HNT:-150,HNY:-540,HOVT:420,ICT:420,IDT:180,IOT:360,IRDT:270,IRKST:540,IRKT:540,IRST:210,IST:60,JST:540,KGT:360,KRAST:480,KRAT:480,KST:540,KUYT:240,LHDT:660,LHST:630,LINT:840,MAGST:720,MAGT:720,MART:-510,MAWT:300,MDT:-360,MESZ:120,MEZ:60,MHT:720,MMT:390,MSD:240,MSK:240,MST:-420,MUT:240,MVT:300,MYT:480,NCT:660,NDT:-90,NFT:690,NOVST:420,NOVT:360,NPT:345,NST:-150,NUT:-660,NZDT:780,NZST:720,OMSST:420,OMST:420,PDT:-420,PET:-300,PETST:720,PETT:720,PGT:600,PHOT:780,PHT:480,PKT:300,PMDT:-120,PMST:-180,PONT:660,PST:-480,PT:-480,PWT:540,PYST:-180,PYT:-240,RET:240,SAMT:240,SAST:120,SBT:660,SCT:240,SGT:480,SRT:-180,SST:-660,TAHT:-600,TFT:300,TJT:300,TKT:780,TLT:540,TMT:300,TVT:720,ULAT:480,UTC:0,UYST:-120,UYT:-180,UZT:300,VET:-210,VLAST:660,VLAT:660,VUT:660,WAST:120,WAT:60,WEST:60,WESZ:60,WET:0,WEZ:0,WFT:720,WGST:-120,WGT:-180,WIB:420,WIT:540,WITA:480,WST:780,WT:0,YAKST:600,YAKT:600,YAPT:600,YEKST:360,YEKT:360}},function(e,t,n){var r=n(16),i=n(112).Refiner;t.Refiner=function(){i.call(this),this.refine=function(e,t,n){return n.forwardDate||n.forwardDatesOnly?(t.forEach((function(e){var t=r(e.ref);if(e.start.isCertain("day")&&e.start.isCertain("month")&&!e.start.isCertain("year")&&t.isAfter(e.start.moment())){for(var n=0;n<3&&t.isAfter(e.start.moment());n++)e.start.imply("year",e.start.get("year")+1),e.end&&!e.end.isCertain("year")&&e.end.imply("year",e.end.get("year")+1);e.tags.ExtractTimezoneOffsetRefiner=!0}e.start.isCertain("day")||e.start.isCertain("month")||e.start.isCertain("year")||!e.start.isCertain("weekday")||!t.isAfter(e.start.moment())||(t.day()>e.start.get("weekday")?t.day(e.start.get("weekday")+7):t.day(e.start.get("weekday")),e.start.imply("day",t.date()),e.start.imply("month",t.month()+1),e.start.imply("year",t.year()),e.tags.ExtractTimezoneOffsetRefiner=!0)})),t):t}}},function(e,t,n){var r=n(112).Filter;t.Refiner=function(){r.call(this),this.isValid=function(e,t,n){return!t.text.replace(" ","").match(/^\d*(\.\d*)?$/)}}},function(e,t,n){n(23).ParsedComponents;var r=n(112).Refiner,i=new RegExp("^\\s*(at|after|before|on|,|-|\\(|\\))?\\s*$");function o(e,t){var n=!1;return e.start.isCertain("year")&&(t.start.isCertain("year")?e.start.isCertain("month")&&(t.start.isCertain("month")?e.start.isCertain("day")&&!t.start.isCertain("day")&&(n=!0):n=!0):n=!0),n}function s(e,t,n){var r=e.substring(t.index+t.text.length,n.index),o=t.tags.ENRelativeDateFormatParser||n.tags.ENRelativeDateFormatParser,s=!t.start.isCertain("day")&&!t.start.isCertain("month")&&!t.start.isCertain("year");return t.start.isCertain("year")&&n.start.isCertain("year")&&(s=t.start.get("year")===n.start.get("year")),t.start.isCertain("month")&&n.start.isCertain("month")&&(s=t.start.get("month")===n.start.get("month")&&s),o&&r.match(i)&&s}function a(e,t,n){t.start,n.start;var r=Math.min(t.index,n.index),i=Math.max(t.index+t.text.length,n.index+n.text.length);for(var o in t.index=r,t.text=e.substring(r,i),n.tags)t.tags[o]=!0;return t.tags.ENPrioritizeSpecificDateRefiner=!0,t}t.Refiner=function(){r.call(this),this.refine=function(e,t,n){if(t.length<2)return t;for(var r=[],i=null,c=null,l=1;l<t.length;l++)i=t[l],o(c=t[l-1],i)&&s(e,c,i)?(c=a(e,c,i),i=null,l+=1):o(i,c)&&s(e,c,i)&&(c=a(e,i,c),i=null,l+=1),r.push(c);return null!=i&&r.push(i),r}}},function(e,t,n){var r=n(520).Refiner;t.Refiner=function(){r.call(this),this.pattern=function(){return/^\s*(\u304b\u3089|\u30fc)\s*$/i}}},function(e,t,n){var r=n(112).Refiner;t.Refiner=function(){r.call(this),this.pattern=function(){return/^\s*(\xe0|a|\-)\s*$/i},this.refine=function(e,t,n){if(t.length<2)return t;for(var r=[],i=null,o=null,s=1;s<t.length;s++)i=t[s],(o=t[s-1]).end||i.end||!this.isAbleToMerge(e,o,i)||(o=this.mergeResult(e,o,i),i=null,s+=1),r.push(o);return null!=i&&r.push(i),r},this.isAbleToMerge=function(e,t,n){var r=t.index+t.text.length,i=n.index;return e.substring(r,i).match(this.pattern())},this.isWeekdayResult=function(e){return e.start.isCertain("weekday")&&!e.start.isCertain("day")},this.mergeResult=function(e,t,n){if(!this.isWeekdayResult(t)&&!this.isWeekdayResult(n)){for(var r in n.start.knownValues)t.start.isCertain(r)||t.start.assign(r,n.start.get(r));for(var r in t.start.knownValues)n.start.isCertain(r)||n.start.assign(r,t.start.get(r))}if(t.start.date().getTime()>n.start.date()){var i=n;n=t,t=i}for(var o in t.end=n.start,n.tags)t.tags[o]=!0;var s=Math.min(t.index,n.index),a=Math.max(t.index+t.text.length,n.index+n.text.length);return t.index=s,t.text=e.substring(s,a),t.tags[this.constructor.name]=!0,t}}},function(e,t,n){n(23).ParsedComponents;var r=n(112).Refiner,i=n(296).mergeDateTimeComponent,o=new RegExp("^\\s*(T|\xe0|a|vers|de|,|-)?\\s*$");function s(e){return!e.start.isCertain("hour")||e.tags.FRCasualDateParser}function a(e){return!e.start.isCertain("month")&&!e.start.isCertain("weekday")}function c(e,t,n){return e.substring(t.index+t.text.length,n.index).match(o)}function l(e,t,n){var r=t.start,o=n.start,s=i(r,o);if(null!=t.end||null!=n.end){var a=null==t.end?t.start:t.end,c=null==n.end?n.start:n.end,l=i(a,c);null==t.end&&l.date().getTime()<s.date().getTime()&&(l.isCertain("day")?l.assign("day",l.get("day")+1):l.imply("day",l.get("day")+1)),t.end=l}t.start=s;var u=Math.min(t.index,n.index),d=Math.max(t.index+t.text.length,n.index+n.text.length);for(var h in t.index=u,t.text=e.substring(u,d),n.tags)t.tags[h]=!0;return t.tags.FRMergeDateAndTimeRefiner=!0,t}t.Refiner=function(){r.call(this),this.refine=function(e,t,n){if(t.length<2)return t;for(var r=[],i=null,o=null,u=1;u<t.length;u++)i=t[u],s(o=t[u-1])&&a(i)&&c(e,o,i)?(o=l(e,o,i),i=null,u+=1):s(i)&&a(o)&&c(e,o,i)&&(o=l(e,i,o),i=null,u+=1),r.push(o);return null!=i&&r.push(i),r}}},function(e,t,n){var r=n(520).Refiner;t.Refiner=function(){r.call(this),this.pattern=function(){return/^\s*(bis(?:\s*(?:am|zum))?|\-)\s*$/i}}},function(e,t,n){n(23).ParsedComponents;var r=n(112).Refiner,i=n(296).mergeDateTimeComponent,o=n(296).isDateOnly,s=n(296).isTimeOnly,a=new RegExp("^\\s*(T|um|am|,|-)?\\s*$");function c(e,t,n){return e.substring(t.index+t.text.length,n.index).match(a)}function l(e,t,n){var r=t.start,o=n.start,s=i(r,o);if(null!=t.end||null!=n.end){var a=null==t.end?t.start:t.end,c=null==n.end?n.start:n.end,l=i(a,c);null==t.end&&l.date().getTime()<s.date().getTime()&&(l.isCertain("day")?l.assign("day",l.get("day")+1):l.imply("day",l.get("day")+1)),t.end=l}t.start=s;var u=Math.min(t.index,n.index),d=Math.max(t.index+t.text.length,n.index+n.text.length);for(var h in t.index=u,t.text=e.substring(u,d),n.tags)t.tags[h]=!0;return t.tags.DEMergeDateAndTimeRefiner=!0,t}t.Refiner=function(){r.call(this),this.refine=function(e,t,n){if(t.length<2)return t;for(var r=[],i=null,a=null,u=1;u<t.length;u++)i=t[u],a=t[u-1],o(a)&&s(i)&&c(e,a,i)?(a=l(e,a,i),i=null,u+=1):o(i)&&s(a)&&c(e,a,i)&&(a=l(e,i,a),i=null,u+=1),r.push(a);return null!=i&&r.push(i),r}}},,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return T})),n.d(t,"c",(function(){return A})),n.d(t,"d",(function(){return S}));var r=n(74),i=n(30),o=n(201);const s="type.googleapis.com/google.protobuf.Int64Value",a="type.googleapis.com/google.protobuf.UInt64Value";function c(e,t){const n={};for(const r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function l(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map((e=>l(e)));if("function"==typeof e||"object"==typeof e)return c(e,(e=>l(e)));throw new Error("Data cannot be encoded in JSON: "+e)}function u(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case s:case a:{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map((e=>u(e))):"function"==typeof e||"object"==typeof e?c(e,(e=>u(e))):e}const d="functions",h={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class f extends i.FirebaseError{constructor(e,t,n){super(`${d}/${e}`,t||""),this.details=n}}class p{constructor(e,t,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then((e=>this.auth=e),(()=>{})),this.messaging||t.get().then((e=>this.messaging=e),(()=>{})),this.appCheck||n.get().then((e=>this.appCheck=e),(()=>{}))}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return null==e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getAppCheckToken(e){if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken(e)}}}const g="us-central1";class m{constructor(e,t,n,r,i=g,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new p(t,n,r),this.cancelAllRequests=new Promise((e=>{this.deleteService=()=>Promise.resolve(e())}));try{const e=new URL(i);this.customDomain=e.origin,this.region=g}catch(e){this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;if(null!==this.emulatorOrigin){return`${this.emulatorOrigin}/${t}/${this.region}/${e}`}return null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function y(e,t,n){return r=>function(e,t,n,r){const i=e._url(t);return b(e,i,n,r)}(e,t,r,n||{})}async function v(e,t,n,r){let i;n["Content-Type"]="application/json";try{i=await r(e,{method:"POST",body:JSON.stringify(t),headers:n})}catch(e){return{status:0,json:null}}let o=null;try{o=await i.json()}catch(e){}return{status:i.status,json:o}}async function b(e,t,n,r){const i={data:n=l(n)},o={},s=await e.contextProvider.getContext(r.limitedUseAppCheckTokens);s.authToken&&(o.Authorization="Bearer "+s.authToken),s.messagingToken&&(o["Firebase-Instance-ID-Token"]=s.messagingToken),null!==s.appCheckToken&&(o["X-Firebase-AppCheck"]=s.appCheckToken);const a=function(e){let t=null;return{promise:new Promise(((n,r)=>{t=setTimeout((()=>{r(new f("deadline-exceeded","deadline-exceeded"))}),e)})),cancel:()=>{t&&clearTimeout(t)}}}(r.timeout||7e4),c=await Promise.race([v(t,i,o,e.fetchImpl),a.promise,e.cancelAllRequests]);if(a.cancel(),!c)throw new f("cancelled","Firebase Functions instance was deleted.");const d=function(e,t){let n,r=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),i=r;try{const e=t&&t.error;if(e){const t=e.status;if("string"==typeof t){if(!h[t])return new f("internal","internal");r=h[t],i=t}const o=e.message;"string"==typeof o&&(i=o),n=e.details,void 0!==n&&(n=u(n))}}catch(e){}return"ok"===r?null:new f(r,i,n)}(c.status,c.json);if(d)throw d;if(!c.json)throw new f("internal","Response is not valid JSON object.");let p=c.json.data;if(void 0===p&&(p=c.json.result),void 0===p)throw new f("internal","Response is missing data field.");return{data:u(p)}}const _="@firebase/functions",w="0.11.4";function T(e=Object(r.getApp)(),t=g){const n=Object(r._getProvider)(Object(i.getModularInstance)(e),d).getImmediate({identifier:t}),o=Object(i.getDefaultEmulatorHostnameAndPort)("functions");return o&&E(n,...o),n}function E(e,t,n){!function(e,t,n){e.emulatorOrigin=`http://${t}:${n}`}(Object(i.getModularInstance)(e),t,n)}function A(e,t,n){return y(Object(i.getModularInstance)(e),t,n)}function S(e,t,n){return function(e,t,n){return r=>b(e,t,r,n||{})}(Object(i.getModularInstance)(e),t,n)}var O,I;O=fetch.bind(self),Object(r._registerComponent)(new o.Component(d,((e,{instanceIdentifier:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("messaging-internal"),o=e.getProvider("app-check-internal");return new m(n,r,i,o,t,O)}),"PUBLIC").setMultipleInstances(!0)),Object(r.registerVersion)(_,w,I),Object(r.registerVersion)(_,w,"esm2017")},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));const r={tag:"tags"},i={[r.tag]:{version:new Date("2018-02-01"),fields:{url:{type:"string"},name:{type:"string"}},indices:[{field:["name","url"],pk:!0},{field:"name"},{field:"url"}]}}},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n(218);const i=1559735977587,o=[],s={db_error:{id:"db_error",overview:{title:"Database errors encountered.",message:"Your memex may be functioning unexpectedly due to issues with your database. It may be low on space."}},quota_warning:{id:"quota_warning",system:{title:"\u26a0\ufe0f Low storage space",message:"Data might be deleted. Click to backup & free up space.",buttons:[{action:{type:r.a,url:"/options.html#/overview?showInbox=true",context:"self"},label:"Learn more"}]},overview:{title:"\u26a0\ufe0f You're almost out of storage space. Your browser may delete Memex data",message:"Due to the browsers policy to evict local storage when space gets low it might happen that your Memex data gets deleted. Free up disk space and make sure to backup your data for the worst case",buttons:[{action:{type:r.a,url:"/options.html#/backup",context:"self"},label:"Backup Now"}]},search:{title:"\u26a0\ufe0f You're almost out of storage space. Your browser may delete Memex data",message:"Due to the browsers policy to evict local storage on low disc space it might happen that your Memex data gets deleted. Free up disk space and make sure to backup your data for the worst case",buttons:[{action:{type:r.a,url:"https://worldbrain.io/warning/browser_data_loss",context:"new-tab"},label:"Find out more"}]}},backup_error:{id:"backup_error",system:{title:"Error backing up data.",message:"Please check your internet connectivity",buttons:[{action:{type:r.a,url:"/options.html#/overview?showInbox=true",context:"self"},label:"Backup Now"}]},overview:{title:"Backup Error due to poor internet connectivity.",message:"Please make sure that you have an internet connection\n                for a successful backup.",buttons:[{action:{type:r.a,url:"/options.html#/backup",context:"self"},label:"Retry"}]}},drive_size_empty:{id:"drive_size_empty",system:{title:"Drive Size",message:"There seems to be no space in your Google Drive",buttons:[{action:{type:r.a,url:"/options.html#/overview?showInbox=true"},label:"Retry"}]},overview:{title:"No Drive Size Available",message:"There is no space available in your Google Drive.\n                Please clear some space in your drive to be able to successfully\n                backup your future data.",buttons:[{action:{type:r.a,url:"https://drive.google.com"},label:"Go to Google Drive"}]}},auto_backup_expired:{id:"auto_backup_expired",system:{title:"Auto Backup",message:"Your Auto Backup subscription has expired.",buttons:[{action:{type:r.a,url:"https://worldbrain.io/pricing",context:"self"},label:"Renew Subscription"}]},overview:{title:"Auto Backup Subscription",message:"Your Auto Backup subscription has expired. If you want to\n                renew your subscription click on the button below.",buttons:[{action:{type:r.a,url:"https://worldbrain.io/pricing",context:"self"},label:"Renew Subscription"}]}},incremental_backup_down:{id:"incremental_backup_down",system:{title:"Auto Backup Down",message:"Your Auto Backup hasn't ran in more than 24 hours."},overview:{title:"Auto Backup Down",message:"Your Auto Backup hasn't ran in more than 24 hours. Is the Memex Backup Helper running?"}},usage_survey_1:{id:"usage_survey_1",search:{title:"How disappointed would you be if Memex does not exist?",message:"Take a 2-5min survey, get 1 month Memex Pro",buttons:[{action:{type:r.a,url:"https://worldbrain.io/survey/disappointed",context:"new-tab"},label:"Take Survey"}]},overview:{title:"How disappointed would you be if Memex does not exist?",message:"Take a 2-5min survey, get 1 month free premium and a chance to win 12 additional months.",buttons:[{action:{type:r.a,url:"https://worldbrain.io/survey/disappointed",context:"new-tab"},label:"Take Survey"}]},system:{title:"Take a 2-5min survey",message:"Get 1 month free premium and a chance to win 12 months!",buttons:[{action:{type:r.a,url:"https://worldbrain.io/survey/disappointed",context:"new-tab"},label:"Take Survey"}]}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(581),i=n.n(r);const o=/to:[''"](.+)['"]/i,s=/from:['"](.+)['"]/i;function a(e){const t=e.match(o),n=e.match(s);let r,a;if(t){const e=i.a.parseDate(t[1]);a=e&&e.getTime()}if(n){const e=i.a.parseDate(n[1]);r=e&&e.getTime()}return{from:r,to:a,query:e.replace(o,"").replace(s,"").trim()}}},,,,,,function(e,t,n){var r,i=n(1332),o=n(1182),s=n(1334),a=n(1335),c=n(1336);"undefined"!=typeof ArrayBuffer&&(r=n(1337));var l="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),u="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),d=l||u;t.protocol=3;var h=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},f=i(h),p={type:"error",data:"parser error"},g=n(1338);function m(e,t,n){for(var r=new Array(e.length),i=a(e.length,n),o=function(e,n,i){t(n,(function(t,n){r[e]=n,i(t,r)}))},s=0;s<e.length;s++)o(s,e[s],i)}t.encodePacket=function(e,n,r,i){"function"==typeof n&&(i=n,n=!1),"function"==typeof r&&(i=r,r=null);var o=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&o instanceof ArrayBuffer)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=e.data,o=new Uint8Array(i),s=new Uint8Array(1+i.byteLength);s[0]=h[e.type];for(var a=0;a<o.length;a++)s[a+1]=o[a];return r(s.buffer)}(e,n,i);if(void 0!==g&&o instanceof g)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(d)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=new FileReader;return i.onload=function(){t.encodePacket({type:e.type,data:i.result},n,!0,r)},i.readAsArrayBuffer(e.data)}(e,n,r);var i=new Uint8Array(1);i[0]=h[e.type];var o=new g([i.buffer,e.data]);return r(o)}(e,n,i);if(o&&o.base64)return function(e,n){var r="b"+t.packets[e.type]+e.data.data;return n(r)}(e,i);var s=h[e.type];return void 0!==e.data&&(s+=r?c.encode(String(e.data),{strict:!1}):String(e.data)),i(""+s)},t.encodeBase64Packet=function(e,n){var r,i="b"+t.packets[e.type];if(void 0!==g&&e.data instanceof g){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];n(i+e)},o.readAsDataURL(e.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var s=new Uint8Array(e.data),a=new Array(s.length),c=0;c<s.length;c++)a[c]=s[c];r=String.fromCharCode.apply(null,a)}return i+=btoa(r),n(i)},t.decodePacket=function(e,n,r){if(void 0===e)return p;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&!1===(e=function(e){try{e=c.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return p;var i=e.charAt(0);return Number(i)==i&&f[i]?e.length>1?{type:f[i],data:e.substring(1)}:{type:f[i]}:p}i=new Uint8Array(e)[0];var o=s(e,1);return g&&"blob"===n&&(o=new g([o])),{type:f[i],data:o}},t.decodeBase64Packet=function(e,t){var n=f[e.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:e.substr(1)}};var i=r.decode(e.substr(1));return"blob"===t&&g&&(i=new g([i])),{type:n,data:i}},t.encodePayload=function(e,n,r){"function"==typeof n&&(r=n,n=null);var i=o(e);if(n&&i)return g&&!d?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r);if(!e.length)return r("0:");m(e,(function(e,r){t.encodePacket(e,!!i&&n,!1,(function(e){r(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return r(t.join(""))}))},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);var i;if("function"==typeof n&&(r=n,n=null),""===e)return r(p,0,1);for(var o,s,a="",c=0,l=e.length;c<l;c++){var u=e.charAt(c);if(":"===u){if(""===a||a!=(o=Number(a)))return r(p,0,1);if(a!=(s=e.substr(c+1,o)).length)return r(p,0,1);if(s.length){if(i=t.decodePacket(s,n,!1),p.type===i.type&&p.data===i.data)return r(p,0,1);if(!1===r(i,c+o,l))return}c+=o,a=""}else a+=u}return""!==a?r(p,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){if(!e.length)return n(new ArrayBuffer(0));m(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){return n(null,e)}))}),(function(e,t){var r=t.reduce((function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2}),0),i=new Uint8Array(r),o=0;return t.forEach((function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),s=0;s<e.length;s++)r[s]=e.charCodeAt(s);n=r.buffer}i[o++]=t?0:1;var a=n.byteLength.toString();for(s=0;s<a.length;s++)i[o++]=parseInt(a[s]);i[o++]=255;for(r=new Uint8Array(n),s=0;s<r.length;s++)i[o++]=r[s]})),n(i.buffer)}))},t.encodePayloadAsBlob=function(e,n){m(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);e=r.buffer,t[0]=0}var o=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),s=new Uint8Array(o.length+1);for(i=0;i<o.length;i++)s[i]=parseInt(o[i]);if(s[o.length]=255,g){var a=new g([t.buffer,s.buffer,e]);n(null,a)}}))}),(function(e,t){return n(new g(t))}))},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var i=e,o=[];i.byteLength>0;){for(var a=new Uint8Array(i),c=0===a[0],l="",u=1;255!==a[u];u++){if(l.length>310)return r(p,0,1);l+=a[u]}i=s(i,2+l.length),l=parseInt(l);var d=s(i,0,l);if(c)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(e){var h=new Uint8Array(d);d="";for(u=0;u<h.length;u++)d+=String.fromCharCode(h[u])}o.push(d),i=s(i,l)}var f=o.length;o.forEach((function(e,i){r(t.decodePacket(e,n,!0),i,f)}))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.merge=t.contains=t.root=t.parseHTML=t.text=t.xml=t.html=void 0;var a=n(319),c=s(n(1188));function l(e,t,n){return e?e(null!=t?t:e._root.children,null,void 0,n).toString():""}function u(e){if(Array.isArray(e))return!0;if("object"!=typeof e||!Object.prototype.hasOwnProperty.call(e,"length")||"number"!=typeof e.length||e.length<0)return!1;for(var t=0;t<e.length;t++)if(!(t in e))return!1;return!0}t.html=function(e,t){return l(this,function(e,t){return!t&&"object"==typeof e&&null!=e&&!("length"in e)&&!("type"in e)}(e)?void(t=e):e,r(r(r({},c.default),null==this?void 0:this._options),(0,c.flatten)(null!=t?t:{})))},t.xml=function(e){return l(this,e,r(r({},this._options),{xmlMode:!0}))},t.text=function(e){for(var t=e||(this?this.root():[]),n="",r=0;r<t.length;r++)n+=(0,a.textContent)(t[r]);return n},t.parseHTML=function(e,t,n){if(void 0===n&&(n="boolean"==typeof t&&t),!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t);var r=this.load(e,c.default,!1);return n||r("script").remove(),r.root()[0].children.slice()},t.root=function(){return this(this._root)},t.contains=function(e,t){if(t===e)return!1;for(var n=t;n&&n!==n.parent;)if((n=n.parent)===e)return!0;return!1},t.merge=function(e,t){if(u(e)&&u(t)){for(var n=e.length,r=+t.length,i=0;i<r;i++)e[n++]=t[i];return e.length=n,e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isHtml=t.cloneDom=t.domEach=t.cssCase=t.camelCase=t.isCheerio=t.isTag=void 0;var r,i=n(155),o=n(155);Object.defineProperty(t,"isTag",{enumerable:!0,get:function(){return o.isTag}}),t.isCheerio=function(e){return null!=e.cheerio},t.camelCase=function(e){return e.replace(/[_.-](\w|$)/g,(function(e,t){return t.toUpperCase()}))},t.cssCase=function(e){return e.replace(/[A-Z]/g,"-$&").toLowerCase()},t.domEach=function(e,t){for(var n=e.length,r=0;r<n;r++)t(e[r],r);return e},t.cloneDom=function(e){var t="length"in e?Array.prototype.map.call(e,(function(e){return(0,i.cloneNode)(e,!0)})):[(0,i.cloneNode)(e,!0)],n=new i.Document(t);return t.forEach((function(e){e.parent=n})),t},function(e){e[e.LowerA=97]="LowerA",e[e.LowerZ=122]="LowerZ",e[e.UpperA=65]="UpperA",e[e.UpperZ=90]="UpperZ",e[e.Exclamation=33]="Exclamation"}(r||(r={})),t.isHtml=function(e){var t=e.indexOf("<");if(t<0||t>e.length-3)return!1;var n=e.charCodeAt(t+1);return(n>=r.LowerA&&n<=r.LowerZ||n>=r.UpperA&&n<=r.UpperZ||n===r.Exclamation)&&e.includes(">",t+2)}},,,,function(e,t,n){var r=n(356),i=n(1169),o=n(472),s=n(347),a=o((function(e,t){if(null==e)return[];var n=t.length;return n>1&&s(e,t[0],t[1])?t=[]:n>2&&s(t[0],t[1],t[2])&&(t=[t[0]]),i(e,r(t,1),[])}));e.exports=a},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var r=n(2),i=n(56),o=n.n(i),s=n(80),a=n(62);const c={annotationPrivacy:"annotationPrivacyLevels",annotationMetadata:"sharedAnnotationMetadata",listMetadata:"sharedListMetadata",shareAction:"contentSharingAction"};class l extends s.a{constructor(){super(...arguments),this.getConfig=()=>({collections:{[c.listMetadata]:{version:a.a[35].version,fields:{localId:{type:"int"},remoteId:{type:"string"},private:{type:"boolean",optional:!0}},indices:[{field:"localId",pk:!0},{field:"remoteId"}],history:[{version:a.a[32].version,fields:{localId:{type:"int"},remoteId:{type:"string"},private:{type:"boolean",optional:!0}},indices:[{field:"localId",pk:!0}]},{version:a.a[20].version,fields:{localId:{type:"int"},remoteId:{type:"string"}},indices:[{field:"localId",pk:!0}]}]},[c.annotationMetadata]:{version:a.a[21].version,fields:{localId:{type:"string"},remoteId:{type:"string"},excludeFromLists:{type:"boolean",optional:!0}},indices:[{field:"localId",pk:!0},{field:"remoteId"}]},[c.annotationPrivacy]:{version:a.a[24].version,fields:{annotation:{type:"string"},privacyLevel:{type:"int"},createdWhen:{type:"datetime"},updatedWhen:{type:"datetime",optional:!0}},indices:[{field:"annotation"}]},[c.shareAction]:{version:a.a[20].version,fields:{createdWhen:{type:"timestamp"},action:{type:"json"}},indices:[{field:"createdWhen"}],backup:!1,watch:!1}},operations:{createListMetadata:{operation:"createObject",collection:"sharedListMetadata"},getListMetadata:{operation:"findObject",collection:"sharedListMetadata",args:{localId:"$localId:number"}},getListMetadataByRemoteId:{operation:"findObject",collection:"sharedListMetadata",args:{remoteId:"$remoteId:string"}},getMetadataForList:{operation:"findObject",collection:"sharedListMetadata",args:{localId:"$localId:pk"}},getMetadataForLists:{operation:"findObjects",collection:"sharedListMetadata",args:{localId:{$in:"$localIds:array:pk"}}},getMetadataForRemoteList:{operation:"findObject",collection:"sharedListMetadata",args:{remoteId:"$remoteListId"}},getAllSharedListMetadata:{operation:"findObjects",collection:"sharedListMetadata",args:{}},deleteMetadataByLocalListId:{operation:"deleteObject",collection:"sharedListMetadata",args:{localId:"$localListId:number"}},updateListPrivacy:{operation:"updateObjects",collection:"sharedListMetadata",args:[{localId:"$localId:pk"},{private:"$private:boolean"}]},createAnnotationMetadata:{operation:"createObject",collection:"sharedAnnotationMetadata"},getAnnotationMetadata:{operation:"findObject",collection:"sharedAnnotationMetadata",args:{localId:"$localId:number"}},getMetadataForAnnotations:{operation:"findObjects",collection:"sharedAnnotationMetadata",args:{localId:{$in:"$localIds:array:pk"}}},deleteAnnotationMetadata:{operation:"deleteObjects",collection:"sharedAnnotationMetadata",args:{localId:{$in:"$localIds:array:pk"}}},updateAnnotationExcludedFromLists:{operation:"updateObjects",collection:"sharedAnnotationMetadata",args:[{localId:"$localId:pk"},{excludeFromLists:"$excludeFromLists:boolean"}]},getPages:{operation:"findObjects",collection:"pages",args:{url:{$in:"$normalizedPageUrls:array"}}},getPage:{operation:"findObject",collection:"pages",args:{url:"$normalizedPageUrl"}},createAction:{operation:"createObject",collection:"contentSharingAction"},getOldestAction:{operation:"findObject",collection:"contentSharingAction",args:[{},{order:[["createdWhen","asc"]]}]},deleteActionById:{operation:"deleteObject",collection:"contentSharingAction",args:{id:"$actionId"}},createAnnotationPrivacyLevel:{collection:c.annotationPrivacy,operation:"createObject"},findAnnotationPrivacyLevel:{collection:c.annotationPrivacy,operation:"findObject",args:{annotation:"$annotation:string"}},findAnnotationPrivacyLevels:{collection:c.annotationPrivacy,operation:"findObjects",args:{annotation:{$in:"$annotations:string"}}},deleteAnnotationPrivacyLevel:{collection:c.annotationPrivacy,operation:"deleteObjects",args:{annotation:"$annotation:string"}},updateAnnotationPrivacyLevel:{collection:c.annotationPrivacy,operation:"updateObjects",args:[{annotation:"$annotation:string"},{privacyLevel:"$privacyLevel:int",updatedWhen:"$updatedWhen:timestamp"}]}}}),this.getPage=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("getPage",{normalizedPageUrl:e});return t?{normalizedUrl:t.url,originalUrl:t.fullUrl,fullTitle:t.fullTitle}:null})),this.getPages=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.operation("getPages",{normalizedPageUrls:e.normalizedPageUrls})).map((e=>({normalizedUrl:e.url,originalUrl:e.fullUrl,fullTitle:e.fullTitle})))}))}storeListId(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(yield this.operation("getListMetadata",e))throw new Error(`List #${e.localId} already has server ID`);yield this.operation("createListMetadata",{localId:e.localId,remoteId:e.remoteId,private:e.private})}))}updateListPrivacy(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("updateListPrivacy",{localId:e.localId,private:e.private})}))}getLocalListId(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.operation("getListMetadataByRemoteId",e);return null!==(t=null==n?void 0:n.localId)&&void 0!==t?t:null}))}getLocalListIds(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("getMetadataForLists",{localIds:e.localIds});return o()(t.map((e=>[e.localId,e.remoteId])))}))}getRemoteListId(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.operation("getListMetadata",e);return null!==(t=null==n?void 0:n.remoteId)&&void 0!==t?t:null}))}getAllRemoteListIds(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.operation("getAllSharedListMetadata",{});return o()(e.map((e=>[e.localId,e.remoteId])))}))}deleteMetadataByLocalListId(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteMetadataByLocalListId",{localListId:e.localListId})}))}getRemoteListIds(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("getMetadataForLists",{localIds:e.localIds});return o()(t.map((e=>[e.localId,e.remoteId])))}))}getRemoteListShareMetadata(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.operation("getMetadataForRemoteList",{remoteListId:e.remoteListId})}))}getListShareMetadata(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("getMetadataForLists",{localIds:e.localIds});return o()(t.map((e=>[e.localId,e])))}))}storeAnnotationMetadata(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getRemoteAnnotationMetadata({localIds:e.map((e=>e.localId))});for(const n of e){const e=t[n.localId];e?e.excludeFromLists!==n.excludeFromLists&&(yield this.setAnnotationsExcludedFromLists({localIds:[n.localId],excludeFromLists:n.excludeFromLists})):yield this.operation("createAnnotationMetadata",n)}}))}setAnnotationsExcludedFromLists(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t=yield this.getRemoteAnnotationMetadata({localIds:e.localIds});for(let n of e.localIds){let r=t[n];r&&(r.excludeFromLists!==e.excludeFromLists&&(yield this.operation("updateAnnotationExcludedFromLists",{localId:n,excludeFromLists:e.excludeFromLists})))}}))}deleteAnnotationMetadata(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteAnnotationMetadata",e)}))}getRemoteAnnotationIds(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("getMetadataForAnnotations",e);return o()(t.map((e=>[e.localId,e.remoteId])))}))}getRemoteAnnotationId(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getRemoteAnnotationIds({localIds:[e.localId]});return null!==(t=n[e.localId])&&void 0!==t?t:null}))}getRemoteAnnotationMetadata(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("getMetadataForAnnotations",e);return o()(t.map((e=>[e.localId,e])))}))}getPageTitles(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t={};for(const n of yield this.getPages(e))t[n.normalizedUrl]=n.fullTitle;return t}))}areListsShared(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getRemoteListIds(e);return o()(e.localIds.map((e=>[e,null!=t[e]])))}))}queueAction(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{object:t}=yield this.operation("createAction",Object.assign({createdWhen:"$now"},e));return{actionId:t.id}}))}peekAction(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.operation("getOldestAction",{});return e?{id:e.id,action:e.action}:null}))}removeAction(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteActionById",e)}))}findAnnotationPrivacyLevel(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findAnnotationPrivacyLevel",{annotation:e.annotation})}))}getPrivacyLevelsByAnnotation(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.operation("findAnnotationPrivacyLevels",{annotations:e.annotations})).reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.annotation]:t})),{})}))}deleteAnnotationPrivacyLevel(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteAnnotationPrivacyLevel",{annotation:e.annotation})}))}setAnnotationPrivacyLevelBulk(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.getPrivacyLevelsByAnnotation(e);for(const i of e.annotations)null!=r[i]?r[i].privacyLevel!==e.privacyLevel&&(yield this.operation("updateAnnotationPrivacyLevel",{annotation:i,privacyLevel:e.privacyLevel,updatedWhen:null!==(n=e.updatedWhen)&&void 0!==n?n:new Date})):yield this.operation("createAnnotationPrivacyLevel",{id:l.generateAnnotationPrivacyLevelId(),annotation:i,privacyLevel:e.privacyLevel,createdWhen:null!==(t=e.updatedWhen)&&void 0!==t?t:new Date})}))}setAnnotationPrivacyLevel(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.findAnnotationPrivacyLevel(e);null!=r?r.privacyLevel!==e.privacyLevel&&(yield this.operation("updateAnnotationPrivacyLevel",{annotation:e.annotation,privacyLevel:e.privacyLevel,updatedWhen:null!==(n=e.updatedWhen)&&void 0!==n?n:new Date})):yield this.operation("createAnnotationPrivacyLevel",{id:l.generateAnnotationPrivacyLevelId(),annotation:e.annotation,privacyLevel:e.privacyLevel,createdWhen:null!==(t=e.updatedWhen)&&void 0!==t?t:new Date})}))}}l.generateAnnotationPrivacyLevelId=()=>Date.now()},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));const r=/^-?#\"\w+([-. ]\w+)*\"$|^-?#\w+([-. ]\w+)*$/,i=/^\w+([-. ]\w+)*$/},function(e,t,n){var r=n(1317),i=n(346)((function(e,t){return null==e?{}:r(e,t)}));e.exports=i},,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(705);const i=/[^A-Za-z\x80-\xFF 0-9 \u2018\u2019\u201C|\u201D\u2026 \u00C0-\u1FFF \u2C00-\uD7FF \.,\?""!@#\$%\^&\*\(\)-_=\+;:<>\/\\\|\}\{\[\]`~'-\w]*/g,o="textractwrapper";const s=({html:e=""})=>function({html:e="",performDOMManipulation:t}){let n=e.toString().replace(/< *(br|p|div|section|span|aside|button|header|footer|li|article|blockquote|cite|code|h1|h2|h3|h4|h5|h6|legend|nav)((.*?)>)/g,"<$1$2|||||").replace(/< *\/(td|a|option) *>/g," </$1>").replace(/< *(a|td|option)/g," <$1").replace(/< *(br|hr) +\/>/g,"|||||<$1\\>").replace(/<\/ +?(p|div|section|span|aside|button|header|footer|li|article|blockquote|cite|code|h1|h2|h3|h4|h5|h6|legend|nav)>/g,"|||||</$1>");return n=`<textractwrapper>${n}<textractwrapper>`,n=t(n).replace(/\|\|\|\|\|/g,"\n").replace(/(\n\u00A0|\u00A0\n|\n | \n)+/g,"\n").replace(/(\r\u00A0|\u00A0\r|\r | \r)+/g,"\n").replace(/(\v\u00A0|\u00A0\v|\v | \v)+/g,"\n").replace(/(\t\u00A0|\u00A0\t|\t | \t)+/g,"\n").replace(/[\n\r\t\v]+/g,"\n").replace(i," ").replace(/ (?! )/g,"").replace(/[ \t\v\u00A0]{2,}/g," "),{text:n,lenBefore:e.length,lenAfter:n.length}}({html:e,performDOMManipulation:e=>{var t,n;const{document:i}=Object(r.a)(`<${o}>${e}</${o}>`),s=e=>e.remove();i.querySelectorAll("script").forEach(s),i.querySelectorAll("noscript").forEach(s),i.querySelectorAll("svg").forEach(s),i.querySelectorAll("select").forEach(s),i.querySelectorAll("style").forEach(s);return null!==(n=null===(t=i.querySelector(o))||void 0===t?void 0:t.textContent)&&void 0!==n?n:""}})},function(e,t,n){var r=n(1086),i=n(347),o=n(236),s=Math.ceil,a=Math.max;e.exports=function(e,t,n){t=(n?i(e,t,n):void 0===t)?1:a(o(t),0);var c=null==e?0:e.length;if(!c||t<1)return[];for(var l=0,u=0,d=Array(s(c/t));l<c;)d[u++]=r(e,l,l+=t);return d}},function(e,t,n){"use strict";var r=n(874);n.d(t,"a",(function(){return r.b})),n.d(t,"b",(function(){return r.c}))},function(e,t,n){var r=n(134);e.exports=function(e,t){return function(n,i){if(null==n)return n;if(!r(n))return e(n,i);for(var o=n.length,s=t?o:-1,a=Object(n);(t?s--:++s<o)&&!1!==i(a[s],s,a););return n}}},function(e,t){e.exports=function(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(r,s,n(s),e)}return r}},function(e,t,n){var r=n(785);e.exports=function(e,t,n,i){return r(e,(function(e,r,o){t(i,e,n(e),o)})),i}},function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}},function(e,t,n){(function(t){if(void 0!==t.URL)e.exports={makeUrlAbsolute:(e,t)=>new URL(t,e).href,parseUrl:e=>new URL(e).host};else{const t=n(207);e.exports={makeUrlAbsolute:(e,n)=>null===t.parse(n).host?t.resolve(e,n):n,parseUrl:e=>t.parse(e).hostname}}}).call(this,n(61))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));class r extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class i extends r{}class o extends r{}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2),i=n(288),o=n(6),s=n(73),a=n(68),c=n(566);const l="@memexContextMenu:",u=l+"createHighlight",d=l+"saveImage",h=l+"analyseImage";class f{constructor(e){this.options=e,this.createHighlightInTab=e=>Object(o.l)(e).createHighlight(!1,null),this.saveImageAsNewNote=(e,t)=>Object(o.l)(e).saveImageAsNewNote(t),this.analyseImageAsWithAI=(e,t)=>Object(o.l)(e).analyseImageAsWithAI(t),this.remoteFunctions={showSidebar:Object(i.a)(this,"showSidebar"),openDashboard:Object(i.a)(this,"openDashboard"),getCurrentTabURL:Object(i.a)(this,"getCurrentTabURL"),checkStripePlan:Object(i.a)(this,"checkStripePlan"),updateContextMenuEntries:Object(i.a)(this,"updateContextMenuEntries")},this.setupContextMenuEntries()}setupRemoteFunctions(){Object(o.d)(this.remoteFunctions)}getHighlightContextMenuTitle(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return"Highlight with Memex"}))}setupContextMenuEntries(){this.options.contextMenuAPI.create({id:u,title:"Highlight with Memex",contexts:["selection"]}),this.options.contextMenuAPI.onClicked.addListener((({menuItemId:e,srcUrl:t},n)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){if(e===u)return this.createHighlightInTab(n.id);if(e===d&&t){const e=yield this.options.fetch(t).then((e=>e.blob())),r=yield Object(c.a)(e);yield this.saveImageAsNewNote(n.id,r)}if(e===h&&t){const e=yield this.options.fetch(t).then((e=>e.blob())),r=yield Object(c.a)(e);yield this.analyseImageAsWithAI(n.id,r)}})))),this.options.contextMenuAPI.create({id:d,title:"Save with Memex",contexts:["image"]}),this.options.contextMenuAPI.create({id:h,title:"Analyse with AI",contexts:["image"]})}updateContextMenuEntries(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.options.contextMenuAPI.update(u,{title:yield this.getHighlightContextMenuTitle()})}))}openDashboard(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.options.tabsAPI.create({url:s.c})}))}checkStripePlan(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield Object(a.b)(e,this.options.browserAPIs)}))}getCurrentTabURL(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.options.tabsAPI.query({active:!0,currentWindow:!0});return e.length>0?e[0].url:null}))}showSidebar(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=(yield this.options.tabsAPI.query({active:!0,currentWindow:!0}))[0];Object(o.l)(e.id).showSidebar()}))}}},function(e,t,n){var r=n(232)("debounce",n(105));r.placeholder=n(164),e.exports=r},,,,,,,,,,,function(e,t,n){var r=n(1173)((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}));e.exports=r},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(62);const i={followedList:"followedList",followedListEntry:"followedListEntry"},o={[i.followedList]:{version:r.a[30].version,fields:{name:{type:"string"},creator:{type:"string"},sharedList:{type:"string"},type:{type:"string",optional:!0},platform:{type:"string",optional:!0},lastSync:{type:"timestamp",optional:!0}},indices:[{pk:!0,field:"sharedList"}],history:[{version:r.a[27].version,fields:{name:{type:"string"},creator:{type:"string"},sharedList:{type:"string"},platform:{type:"string",optional:!0},lastSync:{type:"timestamp",optional:!0}},indices:[{pk:!0,field:"sharedList"}]}],backup:!1,watch:!1},[i.followedListEntry]:{version:r.a[30].version,fields:{creator:{type:"string"},entryTitle:{type:"text"},followedList:{type:"string"},sharedListEntry:{type:"string"},normalizedPageUrl:{type:"string"},hasAnnotationsFromOthers:{type:"boolean"},createdWhen:{type:"timestamp"},updatedWhen:{type:"timestamp"}},indices:[{unique:!0,field:"sharedListEntry"},{field:"normalizedPageUrl"},{field:"followedList"}],history:[{version:r.a[27].version,fields:{creator:{type:"string"},entryTitle:{type:"text"},followedList:{type:"string"},normalizedPageUrl:{type:"string"},hasAnnotationsFromOthers:{type:"boolean"},createdWhen:{type:"timestamp"},updatedWhen:{type:"timestamp"}},indices:[{field:"normalizedPageUrl"},{field:"followedList"}]}],watch:!1,backup:!1}}},function(e,t,n){var r=n(233);e.exports=function(e){return r(e,5)}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n(2),i=n(29),o=n(230),s=n(32);const a="check-memex-update-alarm";function c(){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=`${(null===(t=e.env.REACT_APP_FIREBASE_PROJECT_ID)||void 0===t?void 0:t.includes("staging"))||!1?i.b.staging:i.b.production}/checkForUpdates`,r=yield fetch(n,{method:"GET",headers:{"Content-Type":"application/json"}}),a=yield r.json(),c=parseFloat(a.hasUpdate),l=yield Object(s.a)(o.b);(c>l||c&&!l)&&(yield Object(s.b)(o.c,!1),yield Object(s.b)(o.b,c))}))}}).call(this,n(131))},,function(e,t,n){var r=n(214),i=n(193),o=n(1059),s=n(329);e.exports=function(e,t){if(null==e)return{};var n=r(s(e),(function(e){return[e]}));return t=i(t),o(e,n,(function(e,n){return t(e,n[0])}))}},function(e,t,n){var r=n(213),i=n(1085),o=n(198);e.exports=function(e,t,n){for(var s=-1,a=t.length,c={};++s<a;){var l=t[s],u=r(e,l);n(u,l)&&i(c,o(l,e),u)}return c}},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ERR=void 0,function(e){e.controlCharacterInInputStream="control-character-in-input-stream",e.noncharacterInInputStream="noncharacter-in-input-stream",e.surrogateInInputStream="surrogate-in-input-stream",e.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",e.endTagWithAttributes="end-tag-with-attributes",e.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",e.unexpectedSolidusInTag="unexpected-solidus-in-tag",e.unexpectedNullCharacter="unexpected-null-character",e.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",e.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",e.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",e.missingEndTagName="missing-end-tag-name",e.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",e.unknownNamedCharacterReference="unknown-named-character-reference",e.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",e.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",e.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",e.eofBeforeTagName="eof-before-tag-name",e.eofInTag="eof-in-tag",e.missingAttributeValue="missing-attribute-value",e.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",e.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",e.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",e.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",e.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",e.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",e.missingDoctypePublicIdentifier="missing-doctype-public-identifier",e.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",e.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",e.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",e.cdataInHtmlContent="cdata-in-html-content",e.incorrectlyOpenedComment="incorrectly-opened-comment",e.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",e.eofInDoctype="eof-in-doctype",e.nestedComment="nested-comment",e.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",e.eofInComment="eof-in-comment",e.incorrectlyClosedComment="incorrectly-closed-comment",e.eofInCdata="eof-in-cdata",e.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",e.nullCharacterReference="null-character-reference",e.surrogateCharacterReference="surrogate-character-reference",e.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",e.controlCharacterReference="control-character-reference",e.noncharacterCharacterReference="noncharacter-character-reference",e.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",e.missingDoctypeName="missing-doctype-name",e.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",e.duplicateAttribute="duplicate-attribute",e.nonConformingDoctype="non-conforming-doctype",e.missingDoctype="missing-doctype",e.misplacedDoctype="misplaced-doctype",e.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",e.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",e.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",e.openElementsLeftAfterEof="open-elements-left-after-eof",e.abandonedHeadElementChild="abandoned-head-element-child",e.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",e.nestedNoscriptInHead="nested-noscript-in-head",e.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"}(t.ERR||(t.ERR={}))},,,,,function(e,t,n){var r=n(232)("pickBy",n(1058));r.placeholder=n(164),e.exports=r},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(778),i=n.n(r);let o,s=null;const a=()=>{o=new Promise((e=>s=e))};a();const c=e=>{var t;s||a(),(t=e.backend.dexieInstance)._createTransaction=i.a.override(t._createTransaction,(e=>(n,r,...i)=>("readwrite"!==n||r.includes("backupChanges")||(r=[...r,"backupChanges"]),e.call(t,n,r,...i)))),s(e),s=null}},function(e,t,n){var r=n(1169),i=n(41);e.exports=function(e,t,n,o){return null==e?[]:(i(t)||(t=null==t?[]:[t]),i(n=o?void 0:n)||(n=null==n?[]:[n]),r(e,t,n))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),i=n(93);function o(e){var{nodeId:t,newParentNodeId:n}=e,o=Object(r.__rest)(e,["nodeId","newParentNodeId"]);return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=new Map,s=t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=e.get(t);if(n)return n;const r=yield o.retrieveNode(t);return e.set(t,r),r})),a=(t,n)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield o.createNode(t,null!=n?n:null);e.set(t,r)})),c=null!=n?yield s(n):null;c||null==n||(yield a(n)),o.assertSuitableParent(c);const l=yield s(t);if(l)o.isNodeALeaf(l)?o.updateNodesParent(l,null):yield Object(i.c)({root:l,concurrent:!0,getChildren:t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield o.getChildrenOfNode(t)).map((t=>{const n=o.selectNodeId(t),r=e.get(n);return r||e.set(n,t),null!=r?r:t}))})),cb:(e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=0===t?null!=n?n:i.a:o.selectNodeParentId(e),a=r!==i.a?yield s(r):null;o.updateNodesParent(e,a)}))});else{const e=null!=n?yield s(n):void 0;yield a(t,e)}}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),i=n(80),o=n(78);class s extends i.a{constructor(){super(...arguments),this.getConfig=()=>({collections:{homeFeedInfo:{version:o.a[4].date,fields:{lastSeen:{type:"timestamp"}},relationships:[{childOf:"user"}],indices:[{field:{relationship:"user"},pk:!0}]}},operations:{createHomeFeedInfo:{operation:"createObject",collection:"homeFeedInfo"},updateHomeFeedInfo:{operation:"updateObjects",collection:"homeFeedInfo",args:[{user:"$user:pk"},{lastSeen:"$lastSeen:pk"}]},findHomeFeedInfoByUser:{operation:"findObject",collection:"homeFeedInfo",args:{user:"$user:pk"}}},accessRules:{ownership:{homeFeedInfo:{field:"user",access:["create","update","read"]}}}})}updateHomeFeedTimestamp(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.operation("findHomeFeedInfoByUser",{user:e.user.id});return n?yield this.operation("updateHomeFeedInfo",{user:e.user.id,lastSeen:e.timestamp}):yield this.operation("createHomeFeedInfo",{user:e.user.id,lastSeen:e.timestamp}),{previousTimestamp:null!==(t=null==n?void 0:n.lastSeen)&&void 0!==t?t:null}}))}retrieveHomeFeedTimestamp(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findHomeFeedInfoByUser",{user:e.user.id});return(null==t?void 0:t.lastSeen)?{timestamp:t.lastSeen}:null}))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2),i=n(16),o=n.n(i),s=n(321),a=n(595),c=n(596),l=n(86);class u extends s.a{constructor(){super(...arguments),this.listWithUrl=({url:e,endDate:t,startDate:n})=>{if(!e)throw new Error("URL must be supplied to list annotations.");const r=this.backend.dexieInstance.table(c.a.ANNOTS_COLL).where("pageUrl").equals(e);return n||t?(n=n||0,t=t||Date.now(),n=n instanceof Date?n.getTime():n,t=t instanceof Date?t.getTime():t,r.filter((({lastEdited:e})=>{const r=e.getTime();return r>=n&&r<=t}))):r}}install(e){super.install(e),e.registerOperation(u.TERMS_SEARCH_OP_ID,this.searchAnnots.bind(this)),e.registerOperation(u.LIST_BY_PAGE_OP_ID,this.listAnnotsByPage.bind(this)),e.registerOperation(u.LIST_BY_DAY_OP_ID,this.listAnnotsByDay.bind(this))}filterByBookmarks(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.backend.dexieInstance.table(c.a.BMS_COLL).where("url").anyOf(e).primaryKeys()}))}filterByTags(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=t.tagsExc&&t.tagsExc.length?new Set(t.tagsExc):null,r=t.tagsInc&&t.tagsInc.length?new Set(t.tagsInc):null;let i=new Map;return yield this.backend.dexieInstance.table(c.a.TAGS_COLL).where("url").anyOf(e).eachPrimaryKey((([e,t])=>{const n=i.get(t)||[];i.set(t,[...n,e])})),n&&(i=new Map([...i].filter((([,e])=>e.some((e=>!n.has(e))))))),r&&(i=new Map([...i].filter((([,e])=>e.some((e=>r.has(e))))))),e.filter((e=>{if(!r){return(i.get(e)||[]).some((e=>!n.has(e)))}return i.has(e)}))}))}filterByCollections(e,{collections:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=this.backend.dexieInstance,r=new Map,i=yield n.table("sharedListMetadata").where("localId").anyOf(t).primaryKeys(),o=t.filter((e=>i.includes(e)));if(o.length>0){const t=(yield n.table("annotationPrivacyLevels").where("annotation").anyOf(e).toArray()).filter((e=>Object(l.d)(e.privacyLevel).public)).map((e=>e.annotation)),i=yield n.table(c.a.ANNOTS_COLL).where("url").anyOf(t).toArray(),s=new Map;i.forEach((({url:e,pageUrl:t})=>{var n;const r=null!==(n=s.get(t))&&void 0!==n?n:[];s.set(t,[...r,e])}));(yield n.table("pageListEntries").where("pageUrl").anyOf([...s.keys()]).and((e=>o.includes(e.listId))).primaryKeys()).forEach((([e,t])=>{var n,i;const o=null!==(n=s.get(t))&&void 0!==n?n:[];for(const t of o){const n=null!==(i=r.get(t))&&void 0!==i?i:[];r.set(t,[...n,e])}}))}const s=yield n.table(c.a.LIST_ENTRIES_COLL).where("url").anyOf(e).and((e=>t.includes(e.listId))).primaryKeys(),a=new Set;s.forEach((([e,t])=>{var n;const i=null!==(n=r.get(t))&&void 0!==n?n:[];r.set(t,[...i,e])}));for(const[e,n]of r.entries())t.length===n.length&&n.every((e=>t.includes(e)))&&a.add(e);return[...a]}))}filterByDomains(e,{domainsInc:t,domainsExc:n}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=t&&t.length?new Set(t):null,i=new Set(n);return e.filter((e=>{const{domain:t}=Object(a.a)(e);return r?r.has(t)&&!i.has(t):!i.has(t)}))}))}mapUrlsToAnnots(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=new Map;return yield this.backend.dexieInstance.table(c.a.ANNOTS_COLL).where("url").anyOf(e).each((e=>t.set(e.url,e))),e.map((e=>t.get(e)))}))}filterResults(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return t.bookmarksOnly&&(e=yield this.filterByBookmarks(e)),(t.tagsInc&&t.tagsInc.length||t.tagsExc&&t.tagsExc.length)&&(e=yield this.filterByTags(e,t)),t.collections&&t.collections.length&&(e=yield this.filterByCollections(e,t)),(t.domainsExc&&t.domainsInc.length||t.domainsExc&&t.domainsExc.length)&&(e=yield this.filterByDomains(e,t)),e}))}calcHardLowerTimeBound({startDate:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.backend.dexieInstance.table(c.a.ANNOTS_COLL).orderBy("lastEdited").first();return t&&o()(t.lastEdited).isAfter(e||0)?o()(t.lastEdited):e?o()(new Date(e)):o()("2018-06-01")}))}mergeResults(e,t){for(const[n,r]of t){const t=e.get(n)||new Map;for(const[e,n]of r){const r=t.get(e)||[];t.set(e,[...r,...n])}e.set(n,t)}}clusterAnnotsByDays(e){const t=new Map;for(const n of e.sort(((e,t)=>t.lastEdited.getTime()-e.lastEdited.getTime()))){const e=o()(n.lastEdited).startOf("day").toDate(),r=t.get(e.getTime())||[];t.set(e.getTime(),[...r,n])}return t}clusterAnnotsByPage(e){const t=new Map;for(const[n,r]of this.clusterAnnotsByDays(e)){const e=new Map;for(const t of r){const n=e.get(t.pageUrl)||[];e.set(t.pageUrl,[...n,t])}t.set(n,e)}return t}queryAnnotsByDay(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.backend.dexieInstance.table(c.a.ANNOTS_COLL).where("lastEdited").between(e,t,!0,!0).reverse().toArray()}))}queryTermsField(e,{startDate:t,endDate:n}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let r=this.backend.dexieInstance.table(c.a.ANNOTS_COLL).where(e.field).equals(e.term);return(t||n)&&(r=r.filter((e=>e.lastEdited>=new Date(t||0)&&e.lastEdited<=new Date(n||Date.now())))),r.primaryKeys()}))}lookupTerms(e){var{termsInc:t,includeHighlights:n,includeNotes:i}=e,o=Object(r.__rest)(e,["termsInc","includeHighlights","includeNotes"]);return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=[];n&&e.push("_body_terms"),i&&e.push("_comment_terms");const r=new Map;for(const n of t){const t=yield Promise.all(e.map((e=>this.queryTermsField({field:e,term:n},o))));r.set(n,[...new Set([].concat(...t))])}return[...r.values()].reduce(((e,t)=>{const n=new Set(t);return e.filter((e=>n.has(e)))}))}))}paginateAnnotsResults(e,{skip:t,limit:n}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=2*n,i=new Map,o=new Set;let s=0;for(;i.size<n;){const a=e.slice(s,s+r);if(!a.length)break;(yield this.mapUrlsToAnnots(a)).forEach((e=>{o.add(e.pageUrl);const r=i.get(e.pageUrl)||[];i.size!==n&&o.size>t&&i.set(e.pageUrl,[...r,e])})),s+=r}return i}))}searchAnnots(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.lookupTerms(e),n=yield this.filterResults(t,e);return yield this.paginateAnnotsResults(n,e)}))}listAnnotsByDay(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.calcHardLowerTimeBound(e);let n=e.endDate?o()(e.endDate):o()().endOf("day"),r=new Map;for(;r.size<e.limit&&n.isAfter(t);){const i=n.clone();n.diff(t,"days")<e.limit?n=t:n.subtract(e.limit,"days");let o=yield this.queryAnnotsByDay(n.toDate(),i.toDate());const s=new Set(yield this.filterResults(o.map((e=>e.url)),e));o=o.filter((e=>s.has(e.url))),this.mergeResults(r,this.clusterAnnotsByPage(o))}return r.size>e.limit&&(r=new Map([...r].slice(e.skip,e.skip+e.limit))),r}))}listAnnotsByPage(e,t){var{limit:n=10,skip:i=0}=e,o=Object(r.__rest)(e,["limit","skip"]);return void 0===t&&(t=u.DEF_INNER_LIMIT_MULTI),Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=n*t;let r,s=0,a=[];do{let t=[];t=yield this.listWithUrl(o).offset(s).limit(e).primaryKeys(),r=t.length>=e,t=yield this.filterResults(t,o),a=[...a,...t],s+=e}while(r);return a.length>n&&(a=[...a].slice(i,i+n)),this.mapUrlsToAnnots(a)}))}}u.TERMS_SEARCH_OP_ID="memex:dexie.searchAnnotations",u.LIST_BY_PAGE_OP_ID="memex:dexie.listAnnotationsByPage",u.LIST_BY_DAY_OP_ID="memex:dexie.listAnnotationsByDay",u.DEF_INNER_LIMIT_MULTI=2},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2);class i{constructor(e){this.options=e,this.followEntity=e=>this.options.executeCall("activityStreams-followEntity",e),this.unfollowEntity=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.options.executeCall("activityStreams-unfollowEntity",e)})),this.addActivity=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.options.executeCall("activityStreams-addActivity",e)}))}getHomeFeedActivities(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.options.executeCall("activityStreams-getHomeFeedActivities",{})}))}getRawFeedActivitiesForDebug(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.options.executeCall("activityStreams-getRawFeedActivitiesForDebug",{})}))}getHomeFeedInfo(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.options.executeCall("activityStreams-getHomeFeedInfo",{})}))}}},function(e,t,n){"use strict";function r(e,t){return Array(t+1).join(e)}var i=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function o(e){return l(e,i)}var s=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function a(e){return l(e,s)}var c=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function l(e,t){return t.indexOf(e.nodeName)>=0}function u(e,t){return e.getElementsByTagName&&t.some((function(t){return e.getElementsByTagName(t).length}))}var d={};function h(e){return e?e.replace(/(\n+\s*)+/g,"\n"):""}function f(e){for(var t in this.options=e,this._keep=[],this._remove=[],this.blankRule={replacement:e.blankReplacement},this.keepReplacement=e.keepReplacement,this.defaultRule={replacement:e.defaultReplacement},this.array=[],e.rules)this.array.push(e.rules[t])}function p(e,t,n){for(var r=0;r<e.length;r++){var i=e[r];if(g(i,t,n))return i}}function g(e,t,n){var r=e.filter;if("string"==typeof r){if(r===t.nodeName.toLowerCase())return!0}else if(Array.isArray(r)){if(r.indexOf(t.nodeName.toLowerCase())>-1)return!0}else{if("function"!=typeof r)throw new TypeError("`filter` needs to be a string, array, or function");if(r.call(e,t,n))return!0}}function m(e){var t=e.nextSibling||e.parentNode;return e.parentNode.removeChild(e),t}function y(e,t,n){return e&&e.parentNode===t||n(t)?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}d.paragraph={filter:"p",replacement:function(e){return"\n\n"+e+"\n\n"}},d.lineBreak={filter:"br",replacement:function(e,t,n){return n.br+"\n"}},d.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(e,t,n){var i=Number(t.nodeName.charAt(1));return"setext"===n.headingStyle&&i<3?"\n\n"+e+"\n"+r(1===i?"=":"-",e.length)+"\n\n":"\n\n"+r("#",i)+" "+e+"\n\n"}},d.blockquote={filter:"blockquote",replacement:function(e){return"\n\n"+(e=(e=e.replace(/^\n+|\n+$/g,"")).replace(/^/gm,"> "))+"\n\n"}},d.list={filter:["ul","ol"],replacement:function(e,t){var n=t.parentNode;return"LI"===n.nodeName&&n.lastElementChild===t?"\n"+e:"\n\n"+e+"\n\n"}},d.listItem={filter:"li",replacement:function(e,t,n){e=e.replace(/^\n+/,"").replace(/\n+$/,"\n").replace(/\n/gm,"\n    ");var r=n.bulletListMarker+"   ",i=t.parentNode;if("OL"===i.nodeName){var o=i.getAttribute("start"),s=Array.prototype.indexOf.call(i.children,t);r=(o?Number(o)+s:s+1)+".  "}return r+e+(t.nextSibling&&!/\n$/.test(e)?"\n":"")}},d.indentedCodeBlock={filter:function(e,t){return"indented"===t.codeBlockStyle&&"PRE"===e.nodeName&&e.firstChild&&"CODE"===e.firstChild.nodeName},replacement:function(e,t,n){return"\n\n    "+t.firstChild.textContent.replace(/\n/g,"\n    ")+"\n\n"}},d.fencedCodeBlock={filter:function(e,t){return"fenced"===t.codeBlockStyle&&"PRE"===e.nodeName&&e.firstChild&&"CODE"===e.firstChild.nodeName},replacement:function(e,t,n){for(var i,o=((t.firstChild.getAttribute("class")||"").match(/language-(\S+)/)||[null,""])[1],s=t.firstChild.textContent,a=n.fence.charAt(0),c=3,l=new RegExp("^"+a+"{3,}","gm");i=l.exec(s);)i[0].length>=c&&(c=i[0].length+1);var u=r(a,c);return"\n\n"+u+o+"\n"+s.replace(/\n$/,"")+"\n"+u+"\n\n"}},d.horizontalRule={filter:"hr",replacement:function(e,t,n){return"\n\n"+n.hr+"\n\n"}},d.inlineLink={filter:function(e,t){return"inlined"===t.linkStyle&&"A"===e.nodeName&&e.getAttribute("href")},replacement:function(e,t){var n=t.getAttribute("href"),r=h(t.getAttribute("title"));return r&&(r=' "'+r+'"'),"["+e+"]("+n+r+")"}},d.referenceLink={filter:function(e,t){return"referenced"===t.linkStyle&&"A"===e.nodeName&&e.getAttribute("href")},replacement:function(e,t,n){var r,i,o=t.getAttribute("href"),s=h(t.getAttribute("title"));switch(s&&(s=' "'+s+'"'),n.linkReferenceStyle){case"collapsed":r="["+e+"][]",i="["+e+"]: "+o+s;break;case"shortcut":r="["+e+"]",i="["+e+"]: "+o+s;break;default:var a=this.references.length+1;r="["+e+"]["+a+"]",i="["+a+"]: "+o+s}return this.references.push(i),r},references:[],append:function(e){var t="";return this.references.length&&(t="\n\n"+this.references.join("\n")+"\n\n",this.references=[]),t}},d.emphasis={filter:["em","i"],replacement:function(e,t,n){return e.trim()?n.emDelimiter+e+n.emDelimiter:""}},d.strong={filter:["strong","b"],replacement:function(e,t,n){return e.trim()?n.strongDelimiter+e+n.strongDelimiter:""}},d.code={filter:function(e){var t=e.previousSibling||e.nextSibling,n="PRE"===e.parentNode.nodeName&&!t;return"CODE"===e.nodeName&&!n},replacement:function(e){if(!e)return"";e=e.replace(/\r?\n|\r/g," ");for(var t=/^`|^ .*?[^ ].* $|`$/.test(e)?" ":"",n="`",r=e.match(/`+/gm)||[];-1!==r.indexOf(n);)n+="`";return n+t+e+t+n}},d.image={filter:"img",replacement:function(e,t){var n=h(t.getAttribute("alt")),r=t.getAttribute("src")||"",i=h(t.getAttribute("title"));return r?"!["+n+"]("+r+(i?' "'+i+'"':"")+")":""}},f.prototype={add:function(e,t){this.array.unshift(t)},keep:function(e){this._keep.unshift({filter:e,replacement:this.keepReplacement})},remove:function(e){this._remove.unshift({filter:e,replacement:function(){return""}})},forNode:function(e){return e.isBlank?this.blankRule:(t=p(this.array,e,this.options))||(t=p(this._keep,e,this.options))||(t=p(this._remove,e,this.options))?t:this.defaultRule;var t},forEach:function(e){for(var t=0;t<this.array.length;t++)e(this.array[t],t)}};var v="undefined"!=typeof window?window:{};var b,_,w=function(){var e=v.DOMParser,t=!1;try{(new e).parseFromString("","text/html")&&(t=!0)}catch(e){}return t}()?v.DOMParser:(b=function(){},function(){var e=!1;try{document.implementation.createHTMLDocument("").open()}catch(t){v.ActiveXObject&&(e=!0)}return e}()?b.prototype.parseFromString=function(e){var t=new window.ActiveXObject("htmlfile");return t.designMode="on",t.open(),t.write(e),t.close(),t}:b.prototype.parseFromString=function(e){var t=document.implementation.createHTMLDocument("");return t.open(),t.write(e),t.close(),t},b);function T(e,t){var n;"string"==typeof e?n=(_=_||new w).parseFromString('<x-turndown id="turndown-root">'+e+"</x-turndown>","text/html").getElementById("turndown-root"):n=e.cloneNode(!0);return function(e){var t=e.element,n=e.isBlock,r=e.isVoid,i=e.isPre||function(e){return"PRE"===e.nodeName};if(t.firstChild&&!i(t)){for(var o=null,s=!1,a=null,c=y(a,t,i);c!==t;){if(3===c.nodeType||4===c.nodeType){var l=c.data.replace(/[ \r\n\t]+/g," ");if(o&&!/ $/.test(o.data)||s||" "!==l[0]||(l=l.substr(1)),!l){c=m(c);continue}c.data=l,o=c}else{if(1!==c.nodeType){c=m(c);continue}n(c)||"BR"===c.nodeName?(o&&(o.data=o.data.replace(/ $/,"")),o=null,s=!1):r(c)||i(c)?(o=null,s=!0):o&&(s=!1)}var u=y(a,c,i);a=c,c=u}o&&(o.data=o.data.replace(/ $/,""),o.data||m(o))}}({element:n,isBlock:o,isVoid:a,isPre:t.preformattedCode?E:null}),n}function E(e){return"PRE"===e.nodeName||"CODE"===e.nodeName}function A(e,t){return e.isBlock=o(e),e.isCode="CODE"===e.nodeName||e.parentNode.isCode,e.isBlank=function(e){return!a(e)&&!function(e){return l(e,c)}(e)&&/^\s*$/i.test(e.textContent)&&!function(e){return u(e,s)}(e)&&!function(e){return u(e,c)}(e)}(e),e.flankingWhitespace=function(e,t){if(e.isBlock||t.preformattedCode&&e.isCode)return{leading:"",trailing:""};var n=(r=e.textContent,i=r.match(/^(([ \t\r\n]*)(\s*))(?:(?=\S)[\s\S]*\S)?((\s*?)([ \t\r\n]*))$/),{leading:i[1],leadingAscii:i[2],leadingNonAscii:i[3],trailing:i[4],trailingNonAscii:i[5],trailingAscii:i[6]});var r,i;n.leadingAscii&&S("left",e,t)&&(n.leading=n.leadingNonAscii);n.trailingAscii&&S("right",e,t)&&(n.trailing=n.trailingNonAscii);return{leading:n.leading,trailing:n.trailing}}(e,t),e}function S(e,t,n){var r,i,s;return"left"===e?(r=t.previousSibling,i=/ $/):(r=t.nextSibling,i=/^ /),r&&(3===r.nodeType?s=i.test(r.nodeValue):n.preformattedCode&&"CODE"===r.nodeName?s=!1:1!==r.nodeType||o(r)||(s=i.test(r.textContent))),s}var O=Array.prototype.reduce,I=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function C(e){if(!(this instanceof C))return new C(e);var t={rules:d,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(e,t){return t.isBlock?"\n\n":""},keepReplacement:function(e,t){return t.isBlock?"\n\n"+t.outerHTML+"\n\n":t.outerHTML},defaultReplacement:function(e,t){return t.isBlock?"\n\n"+e+"\n\n":e}};this.options=function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}return e}({},t,e),this.rules=new f(this.options)}function k(e){var t=this;return O.call(e.childNodes,(function(e,n){var r="";return 3===(n=new A(n,t.options)).nodeType?r=n.isCode?n.nodeValue:t.escape(n.nodeValue):1===n.nodeType&&(r=x.call(t,n)),R(e,r)}),"")}function P(e){var t=this;return this.rules.forEach((function(n){"function"==typeof n.append&&(e=R(e,n.append(t.options)))})),e.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function x(e){var t=this.rules.forNode(e),n=k.call(this,e),r=e.flankingWhitespace;return(r.leading||r.trailing)&&(n=n.trim()),r.leading+t.replacement(n,e,this.options)+r.trailing}function R(e,t){var n=function(e){for(var t=e.length;t>0&&"\n"===e[t-1];)t--;return e.substring(0,t)}(e),r=t.replace(/^\n*/,""),i=Math.max(e.length-n.length,t.length-r.length);return n+"\n\n".substring(0,i)+r}C.prototype={turndown:function(e){if(!function(e){return null!=e&&("string"==typeof e||e.nodeType&&(1===e.nodeType||9===e.nodeType||11===e.nodeType))}(e))throw new TypeError(e+" is not a string, or an element/document/fragment node.");if(""===e)return"";var t=k.call(this,new T(e,this.options));return P.call(this,t)},use:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)this.use(e[t]);else{if("function"!=typeof e)throw new TypeError("plugin must be a Function or an Array of Functions");e(this)}return this},addRule:function(e,t){return this.rules.add(e,t),this},keep:function(e){return this.rules.keep(e),this},remove:function(e){return this.rules.remove(e),this},escape:function(e){return I.reduce((function(e,t){return e.replace(t[0],t[1])}),e)}},e.exports=C},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return x.b}));var r=n(2),i=n(1069),o=n.n(i),s=n(80),a=n(104),c=n(328),l=n(78);var u=n(29);const d={createSharedList:{operation:"createObject",collection:"sharedList"},createSharedListTree:{operation:"createObject",collection:"sharedListTree"},createSharedListDeleteAction:{operation:"createObject",collection:"sharedListDeleteAction"},createSharedListCreatorInfo:{operation:"createObject",collection:"sharedListCreatorInfo"},createListEmailInvite:{operation:"createObject",collection:"sharedListEmailInvite"},createListEntries:{operation:"executeBatch",args:["$batch"]},findListByID:{operation:"findObject",collection:"sharedList",args:{id:"$id:pk"}},findListsByIDs:{operation:"findObjects",collection:"sharedList",args:{id:{$in:"$ids:pk[]"}}},findListsByCreator:{operation:"findObjects",collection:"sharedList",args:{creator:"$creatorId:pk"}},findListEntriesByList:{operation:"findObjects",collection:"sharedListEntry",args:[{sharedList:"$sharedListID:pk"},{order:[["updatedWhen",u.c]]}]},findListEntriesByListPaginated:{operation:"findObjects",collection:"sharedListEntry",args:[{sharedList:"$sharedListID:pk",updatedWhen:{$lt:"$from:timestamp"}},{order:[["updatedWhen",u.c]],limit:"$limit:number"}]},findListEntriesByListAfterTime:{operation:"findObjects",collection:"sharedListEntry",args:[{sharedList:"$sharedListID:pk",updatedWhen:{$gt:"$from:number"}},{order:[["updatedWhen",u.c]]}]},findListEntryByListAndId:{operation:"findObject",collection:"sharedListEntry",args:[{sharedList:"$sharedList:pk",id:"$id:pk"}]},findListEntryByUrl:{operation:"findObject",collection:"sharedListEntry",args:{sharedList:"$sharedList:pk",normalizedUrl:"$normalizedUrl:string"}},findListEntriesByUrl:{operation:"findObjects",collection:"sharedListEntry",args:{sharedList:"$sharedList:pk",normalizedUrl:"$normalizedUrl:string"}},findListEntriesByUrls:{operation:"findObjects",collection:"sharedListEntry",args:{sharedList:"$sharedList:pk",normalizedUrl:{$in:"$normalizedUrls:string"}}},findListEntryById:{operation:"findObject",collection:"sharedListEntry",args:{id:"$id:pk"}},findSingleEntryByUserAndUrl:{operation:"findObject",collection:"sharedListEntry",args:[{creator:"$creator:pk",normalizedUrl:"$normalizedUrl:string"},{limit:1}]},findAllEntriesByUserAndUrl:{operation:"findObjects",collection:"sharedListEntry",args:{creator:"$creator:pk",normalizedUrl:"$normalizedUrl:string"}},updateListEntryTimestamp:{operation:"updateObject",collection:"sharedListEntry",args:[{id:"$id:pk"},{updatedWhen:"$updatedWhen:number"}]},updateListEntryTitle:{operation:"updateObject",collection:"sharedListEntry",args:[{id:"$id:pk"},{entryTitle:"$entryTitle:string"}]},deleteListEntriesByIds:{operation:"deleteObjects",collection:"sharedListEntry",args:{id:{$in:"$ids:array:pk"}}},updateListDescription:{operation:"updateObjects",collection:"sharedList",args:[{id:"$id"},{description:"$newDescription"}]},updateListTitle:{operation:"updateObjects",collection:"sharedList",args:[{id:"$id"},{title:"$newTitle"}]},updateListPrivacy:{operation:"updateObjects",collection:"sharedList",args:[{id:"$id"},{private:"$isPrivateList:boolean"}]},findListEmailInvite:{operation:"findObject",collection:"sharedListEmailInvite",args:{id:"$id"}},findListEmailInviteByKey:{operation:"findObject",collection:"sharedListEmailInvite",args:{sharedListKey:"$key:fk"}},findListEmailInvitesByList:{operation:"findObjects",collection:"sharedListEmailInvite",args:{sharedList:"$listId"}},findListEmailInvitesByEmail:{operation:"findObjects",collection:"sharedListEmailInvite",args:{sharedList:"$sharedList:fk",email:"$email:string"}},updateListEmailInviteAcceptance:{operation:"updateObjects",collection:"sharedListEmailInvite",args:[{id:"$id"},{acceptedWhen:"$acceptedWhen:number",user:"$user:fk"}]},createPageInfo:{operation:"createObject",collection:"sharedPageInfo"},findPageInfoById:{operation:"findObject",collection:"sharedPageInfo",args:{id:"$id:pk"}},findPageInfoByCreatorAndUrl:{operation:"findObject",collection:"sharedPageInfo",args:{normalizedUrl:"$normalizedUrl:string",creator:"$creator:pk"}},findPageInfosByCreatorAndUrls:{operation:"findObjects",collection:"sharedPageInfo",args:{normalizedUrl:{$in:"$normalizedUrls:string[]"},creator:"$creator:pk"}},updatePageInfoTitleById:{operation:"updateObjects",collection:"sharedPageInfo",args:[{id:"$id:pk"},{fullTitle:"$fullTitle:string"}]},deleteList:{operation:"executeBatch",args:[[{placeholder:"role",operation:"deleteObjects",collection:"sharedListRole",args:{sharedList:"$sharedList:pk"}},{placeholder:"roleByUser",operation:"deleteObjects",collection:"sharedListRoleByUser",args:{sharedList:"$sharedList:pk",user:{$in:"$users:string"}}},{operation:"deleteObjects",collection:"sharedListEntry",args:{sharedList:"$sharedList:pk"}},{operation:"deleteObjects",collection:"sharedListKey",args:{sharedList:"$sharedList:pk"}},{operation:"deleteObjects",collection:"sharedAnnotationListEntry",args:{sharedList:"$sharedList:pk"}},{operation:"deleteObject",collection:"sharedList",args:{id:"$sharedList:pk"}}]]},deletePageInfoById:{operation:"deleteObject",collection:"sharedPageInfo",args:{id:"$id:pk"}},createAnnotationsAndEntries:{operation:"executeBatch",args:["$batch"]},createAnnotationListEntries:{operation:"executeBatch",args:["$batch"]},findAnnotationEntryById:{operation:"findObject",collection:"sharedAnnotationListEntry",args:{id:"$id:pk"}},findSingleAnnotationEntryByListPage:{operation:"findObject",collection:"sharedAnnotationListEntry",args:[{sharedList:"$sharedList:pk",normalizedPageUrl:"$normalizedPageUrl:string"},{limit:1}]},findAnnotationEntriesByCreatorAndPageUrl:{operation:"findObjects",collection:"sharedAnnotationListEntry",args:[{creator:"$creator:pk",sharedList:"$sharedList:pk",normalizedPageUrl:"$normalizedPageUrl:string"}]},findAnnotationEntriesByListPages:{operation:"findObjects",collection:"sharedAnnotationListEntry",args:[{sharedList:"$sharedList:pk",normalizedPageUrl:{$in:"$normalizedPageUrls:array:string"}},{order:[["createdWhen",u.a]]}]},findAnnotationEntriesByListAfterTime:{operation:"findObjects",collection:"sharedAnnotationListEntry",args:[{sharedList:"$sharedList:pk",updatedWhen:{$gt:"$from:number"}},{order:[["createdWhen",u.a]]}]},findAnnotationEntriesByList:{operation:"findObjects",collection:"sharedAnnotationListEntry",args:[{sharedList:"$sharedList:pk"},{order:[["createdWhen",u.a]]}]},findAnnotationEntriesByLists:{operation:"findObjects",collection:"sharedAnnotationListEntry",args:{sharedList:{$in:"$sharedLists:array:pk"}}},findAnnotationEntriesByListsOnPage:{operation:"findObjects",collection:"sharedAnnotationListEntry",args:{sharedList:{$in:"$sharedLists:array:pk"},normalizedPageUrl:"$normalizedPageUrl:string"}},findAnnotationsByIds:{operation:"findObjects",collection:"sharedAnnotation",args:{id:{$in:"$ids:array:pk"}}},findAnnotationById:{operation:"findObject",collection:"sharedAnnotation",args:{id:"$id:pk"}},findAnnotationsByCreatorAndPageUrl:{operation:"findObjects",collection:"sharedAnnotation",args:{creator:"$creator:pk",normalizedPageUrl:"$normalizedPageUrl:pk"}},findAnnotationEntriesForAnnotation:{operation:"findObjects",collection:"sharedAnnotationListEntry",args:{sharedAnnotation:"$sharedAnnotation:pk"}},findAnnotationEntriesForAnnotations:{operation:"findObjects",collection:"sharedAnnotationListEntry",args:{sharedAnnotation:{$in:"$sharedAnnotations:array:pk"}}},deleteAnnotationEntries:{operation:"executeBatch",args:["$batch"]},deleteAnnotations:{operation:"executeBatch",args:["$batch"]},updateAnnotationComment:{operation:"updateObjects",collection:"sharedAnnotation",args:[{id:"$id:pk"},{comment:"$comment:string",updatedWhen:"$updatedWhen:number"}]},updateAnnotationHighlight:{operation:"updateObjects",collection:"sharedAnnotation",args:[{id:"$id:pk"},{body:"$body:string",updatedWhen:"$updatedWhen:number"}]},updateAnnotationColor:{operation:"updateObjects",collection:"sharedAnnotation",args:[{id:"$id:pk"},{color:"$color:string",updatedWhen:"$updatedWhen:number"}]},createListRole:{operation:"executeBatch",args:[[{placeholder:"role",operation:"createObject",collection:"sharedListRole",args:{createdWhen:"$createdWhen:timestamp",updatedWhen:"$updatedWhen:timestamp",roleID:"$roleID:timestamp",sharedList:"$sharedList:pk",user:"$user:pk"}},{placeholder:"roleByUser",operation:"createObject",collection:"sharedListRoleByUser",args:{createdWhen:"$createdWhen:timestamp",updatedWhen:"$updatedWhen:timestamp",roleID:"$roleID:timestamp",sharedList:"$sharedList:pk",user:"$user:pk"}}]]},removeListRole:{operation:"executeBatch",args:[[{placeholder:"role",operation:"deleteObject",collection:"sharedListRole",args:{sharedList:"$sharedList:pk",user:"$user:pk"}},{placeholder:"roleByUser",operation:"deleteObject",collection:"sharedListRoleByUser",args:{sharedList:"$sharedList:pk",user:"$user:pk"}}]]},updateListRole:{operation:"updateObject",collection:"sharedListRole",args:[{sharedList:"$sharedList:pk",user:"$user:pk"},{roleID:"$roleID:number"}]},findListRole:{operation:"findObject",collection:"sharedListRole",args:{sharedList:"$sharedList:pk",user:"$user:pk"}},findListRoles:{operation:"findObjects",collection:"sharedListRole",args:{sharedList:"$sharedList:pk"}},findListRolesByUser:{operation:"findObjects",collection:"sharedListRoleByUser",args:{user:"$user:pk"}},findListRolesByUserForList:{operation:"findObjects",collection:"sharedListRoleByUser",args:{user:"$user:pk",sharedList:"$sharedList:pk"}},findListRolesByUserForLists:{operation:"findObjects",collection:"sharedListRoleByUser",args:{user:"$user:pk",sharedList:{$in:"$sharedLists:pk[]"}}},createListKey:{operation:"createObject",collection:"sharedListKey"},findKey:{operation:"findObject",collection:"sharedListKey",args:{id:"$id:pk",sharedList:"$sharedList:fk"}},findKeys:{operation:"findObjects",collection:"sharedListKey",args:{id:{$in:"$ids:pk[]"},sharedList:"$sharedList:fk"}},findKeysByList:{operation:"findObjects",collection:"sharedListKey",args:{sharedList:"$sharedList:pk"}},findKeysByLists:{operation:"findObjects",collection:"sharedListKey",args:{sharedList:{$in:"$sharedLists:pk[]"}}},findListKey:{operation:"findObject",collection:"sharedListKey",args:{sharedList:"$sharedList:pk",id:"$id:string"}},findSharedListTree:{operation:"findObject",collection:"sharedListTree",args:{sharedList:"$sharedList:fk"}},findSharedListTrees:{operation:"findObjects",collection:"sharedListTree",args:{sharedList:{$in:"$sharedLists:fk[]"}}},findSharedListTreesByParent:{operation:"findObjects",collection:"sharedListTree",args:{parentListId:"$parentListId:string"}},updateSharedListTreeOrder:{operation:"updateObjects",collection:"sharedListTree",args:[{sharedList:"$sharedList:fk"},{order:"$order:number",updatedWhen:"$updatedWhen:number"}]},deleteSharedListTree:{operation:"deleteObjects",collection:"sharedListTree",args:{sharedList:"$sharedList:fk"}},deleteListKey:{operation:"deleteObjects",collection:"sharedListKey",args:{sharedList:"$sharedList:pk",id:"$id:string"}},deleteListKeys:{operation:"deleteObjects",collection:"sharedListKey",args:{sharedList:"$sharedList:pk",id:{$in:"$ids:array:pk"}}},deleteListEmailInvite:{operation:"deleteObject",collection:"sharedListEmailInvite",args:{id:"$id:string"}},createFingerprintsAndLocators:{operation:"executeBatch",args:["$batch"]},findFingerprintInLists:{operation:"findObjects",collection:"sharedContentFingerprint",args:{fingerprint:"$fingerprint:array",sharedList:{$in:"$sharedLists:array:pk"}}},findFingerprintsInListsByUrl:{operation:"findObjects",collection:"sharedContentFingerprint",args:{normalizedUrl:"$normalizedUrl:string",sharedList:{$in:"$sharedLists:array:pk"}}},findFingerprintsByUrl:{operation:"findObjects",collection:"sharedContentFingerprint",args:{normalizedUrl:"$normalizedUrl:string"}},createUploadLocator:{operation:"createObject",collection:"sharedContentLocator"},findLocatorsInListsByUrl:{operation:"findObjects",collection:"sharedContentLocator",args:{normalizedUrl:"$normalizedUrl:string",sharedList:{$in:"$sharedLists:array:pk"}}},findLocatorsInList:{operation:"findObjects",collection:"sharedContentLocator",args:{sharedList:"$sharedList:string"}},findLocatorsInListByLocationScheme:{operation:"findObjects",collection:"sharedContentLocator",args:{sharedList:"$sharedList:string",locationScheme:"$scheme:string"}},findLocatorsInListByUrl:{operation:"findObjects",collection:"sharedContentLocator",args:{normalizedUrl:"$normalizedUrl:string",sharedList:"$sharedList:string"}},findLocatorsByUrl:{operation:"findObjects",collection:"sharedContentLocator",args:{normalizedUrl:"$normalizedUrl:string"}},findLocatorsByUrlAndCreator:{operation:"findObjects",collection:"sharedContentLocator",args:{creator:"$creator:string",normalizedUrl:"$normalizedUrl:string"}}};var h=n(18);function f(e){return{prepare:[m(e)],rule:{eq:["$list.creator","$context.userId"]}}}function p(e,t){return{prepare:[m(e),y({sharedList:e,user:"$context.userId"})],rule:{or:[{eq:["$list.platform","bsky"]},{eq:["$list.creator","$value.creator"]},{and:[{exists:"$role"},{ge:["$role.roleID",t]}]}]}}}function g(e,t){return{prepare:[m(e),y({sharedList:e,user:"$context.userId"})],rule:{or:[{ne:["$list.private",!0]},{eq:["$list.creator","$value.creator"]},{and:[{exists:"$role"},{ge:["$role.roleID",t]}]}]}}}function m(e){return{placeholder:"list",operation:"findObject",collection:"sharedList",where:{id:e}}}function y(e){return{placeholder:"role",operation:"findObject",collection:"sharedListRole",where:{sharedList:e.sharedList,user:e.user}}}const v={ownership:{sharedList:{field:"creator",access:["create","update","delete"]},sharedListCreatorInfo:{field:"creator",access:["create","update","delete"]},sharedContentFingerprint:{field:"creator",access:["create","update","delete"]},sharedContentLocator:{field:"creator",access:["create","update","delete"]},sharedListEntry:{field:"creator",access:["create","update","delete"]},sharedPageInfo:{field:"creator",access:["create","update","delete"]},sharedAnnotation:{field:"creator",access:["create","update","delete"]},sharedAnnotationListEntry:{field:"creator",access:["create","update","delete"]}},permissions:{sharedList:{read:{rule:!0}},sharedListCreatorInfo:{read:{rule:!0}},sharedContentFingerprint:{read:g("$value.sharedList",h.a.AddOnly),create:p("$value.sharedList",h.a.AddOnly),update:p("$value.sharedList",h.a.AddOnly),delete:p("$value.sharedList",h.a.AddOnly)},sharedContentLocator:{read:g("$value.sharedList",h.a.AddOnly),create:p("$value.sharedList",h.a.AddOnly),update:p("$value.sharedList",h.a.AddOnly),delete:p("$value.sharedList",h.a.AddOnly)},sharedListEntry:{read:g("$value.sharedList",h.a.AddOnly),create:p("$value.sharedList",h.a.AddOnly),update:p("$value.sharedList",h.a.AddOnly),delete:p("$value.sharedList",h.a.AddOnly)},sharedListKey:{list:f("$groupKeys.sharedList"),read:f("$groupKeys.sharedList"),create:f("$groupKeys.sharedList"),update:f("$groupKeys.sharedList"),delete:f("$groupKeys.sharedList")},sharedListRole:{read:{rule:!0},create:f("$groupKeys.sharedList")},sharedListRoleByUser:{read:{rule:!0},create:f("$newValue.sharedList")},sharedPageInfo:{read:{rule:!0}},sharedAnnotation:{read:{rule:!0}},sharedAnnotationListEntry:{read:g("$value.sharedList",h.a.AddOnly),create:p("$value.sharedList",h.a.AddOnly),update:p("$value.sharedList",h.a.AddOnly),delete:p("$value.sharedList",h.a.AddOnly)}}};var b=n(167),_=n(71),w=n(223),T=n.n(w),E=n(714);n(895),n(595),n(163);var A=n(86),S=n(93),O=n(1070);const I="highlightColors.highlightColors";var C=n(20);class k extends s.a{constructor(e){super(e),this.options=e,this.getConfig=()=>({collections:{sharedList:{version:l.a[0].date,fields:{createdWhen:{type:"timestamp"},updatedWhen:{type:"timestamp"},type:{type:"string",optional:!0},title:{type:"string"},description:{type:"string",optional:!0},platform:{type:"string",optional:!0},private:{type:"boolean",optional:!0}},relationships:[{alias:"creator",childOf:"user"}]},sharedListCreatorInfo:{version:l.a[0].date,fields:{localListId:{type:"timestamp"}},relationships:[{childOf:"sharedList"},{alias:"creator",childOf:"user"}],groupBy:[{key:"creator",subcollectionName:"lists"}]},sharedContentFingerprint:{version:l.a[10].date,fields:{normalizedUrl:{type:"string"},fingerprintScheme:{type:"string"},fingerprint:{type:"string"}},relationships:[{childOf:"sharedList"},{alias:"creator",childOf:"user"}]},sharedContentLocator:{version:l.a[10].date,fields:{normalizedUrl:{type:"string"},originalUrl:{type:"string"},location:{type:"string",optional:!0},locationScheme:{type:"string"}},relationships:[{childOf:"sharedList"},{alias:"creator",childOf:"user"}]},sharedListEntry:{version:l.a[0].date,fields:{createdWhen:{type:"timestamp"},updatedWhen:{type:"timestamp"},entryTitle:{type:"string",optional:!0},normalizedUrl:{type:"string"},originalUrl:{type:"string"}},relationships:[{childOf:"sharedList"},{alias:"creator",childOf:"user"}]},sharedListRole:{version:l.a[7].date,fields:{createdWhen:{type:"timestamp"},updatedWhen:{type:"timestamp"},roleID:{type:"int"}},relationships:[{childOf:"sharedList"},{childOf:"user"}],groupBy:[{subcollectionName:"users",key:"sharedList"}],indices:[{field:{relationship:"user"},pk:!0}]},sharedListRoleByUser:{version:l.a[7].date,fields:{createdWhen:{type:"timestamp"},updatedWhen:{type:"timestamp"},roleID:{type:"int"}},relationships:[{childOf:"sharedList"},{childOf:"user"}],groupBy:[{subcollectionName:"lists",key:"user"}],indices:[{field:{relationship:"sharedList"},pk:!0}]},sharedListKey:{version:l.a[7].date,fields:{createdWhen:{type:"timestamp"},updatedWhen:{type:"timestamp"},expiresWhen:{type:"timestamp",optional:!0},singleUse:{type:"boolean",optional:!0},disabled:{type:"boolean",optional:!0},roleID:{type:"int"}},relationships:[{childOf:"sharedList"}],groupBy:[{subcollectionName:"keys",key:"sharedList"}]},sharedPageInfo:{version:l.a[2].date,fields:{createdWhen:{type:"timestamp"},updatedWhen:{type:"timestamp"},normalizedUrl:{type:"string"},originalUrl:{type:"string"},fullTitle:{type:"string",optional:!0}},relationships:[{alias:"creator",childOf:"user"}]},sharedAnnotation:{version:l.a[1].date,fields:{normalizedPageUrl:{type:"string"},createdWhen:{type:"timestamp"},uploadedWhen:{type:"timestamp"},updatedWhen:{type:"timestamp"},body:{type:"string",optional:!0},comment:{type:"string",optional:!0},selector:{type:"string",optional:!0}},relationships:[{alias:"creator",childOf:"user"}]},sharedAnnotationListEntry:{version:l.a[1].date,fields:{createdWhen:{type:"timestamp"},uploadedWhen:{type:"timestamp"},updatedWhen:{type:"timestamp"},normalizedPageUrl:{type:"string"}},relationships:[{alias:"creator",childOf:"user"},{connects:["sharedList","sharedAnnotation"]}]},sharedListEmailInvite:{version:l.a[16].date,fields:{email:{type:"string"},createdWhen:{type:"timestamp"},user:{type:"foreign-key",optional:!0},acceptedWhen:{type:"timestamp",optional:!0}},relationships:[{childOf:"sharedList"},{singleChildOf:"sharedListKey"}],indices:[{field:"email"}]},sharedListDeleteAction:{version:l.a[17].date,fields:{listMemberIdsConcat:{type:"string"}},relationships:[{childOf:"sharedList"}]},sharedListTree:{version:l.a[20].date,fields:{path:{type:"string",optional:!0},order:{type:"int"},createdWhen:{type:"timestamp"},updatedWhen:{type:"timestamp"}},relationships:[{singleChildOf:"sharedList"},{childOf:"sharedList",alias:"linkTarget"},{childOf:"sharedList",alias:"parentListId"},{childOf:"user",alias:"creator"}]}},operations:d,accessRules:v}),this.indexLocatorsByNormalizedUrl=e=>{var t;const n=new Map;for(const r of e){const e=null!==(t=n.get(r.normalizedUrl))&&void 0!==t?t:[];n.set(r.normalizedUrl,[...e,r])}return n},this._prepareRetrievedListEntry=e=>Object(c.a)(e,"shared-list-entry-reference",{sharedList:"shared-list-reference",creator:"user-reference"}),this._preparePageInfoForUser=e=>{if(!e)return null;const t={type:"shared-page-info-reference",id:e.id},n={type:"user-reference",id:e.creator};return delete e.id,delete e.creator,{reference:t,creatorReference:n,pageInfo:e}}}getSharedListLinkID(e){const t=e.id;return"string"==typeof t?t:t.toString()}getSharedListReferenceFromLinkID(e){return{type:"shared-list-reference",id:e}}getSharedPageInfoLinkID(e){const t=e.id;return"string"==typeof t?t:t.toString()}getSharedPageInfoReferenceFromLinkID(e){return this._referenceFromLinkId("shared-page-info-reference",e)}getSharedAnnotationLinkID(e){const t=e.id;return"string"==typeof t?t:t.toString()}getSharedAnnotationReferenceFromLinkID(e){return{type:"shared-annotation-reference",id:e}}createSharedList(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){return{type:"shared-list-reference",id:(yield this.options.storageManager.operation("createObject","sharedList",Object.assign(Object.assign(Object.assign({},e.listReference?{id:e.listReference.id}:{}),e.listData),{creator:e.userReference.id,createdWhen:"$now",updatedWhen:"$now",description:null!==(t=e.listData.description)&&void 0!==t?t:null}))).object.id}}))}createListEntries(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield Object(b.f)(e.listEntries,(t=>this.getListEntriesByListAndUrls({listReference:e.listReference,normalizedPageUrls:t.map((e=>e.normalizedUrl))}))),n=new Set(t.map((e=>e.normalizedUrl))),i=e.listEntries.filter((e=>!n.has(e.normalizedUrl)));e.ensurePageInfoExists&&(yield Object(b.b)(i,(t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield Promise.all(t.map((t=>this.ensurePageInfo({creatorReference:e.userReference,pageInfo:{normalizedUrl:t.normalizedUrl,originalUrl:t.originalUrl,fullTitle:t.entryTitle}}))))})))));return yield this.operation("createListEntries",{batch:i.map((t=>{var n,{reference:i}=t,o=Object(r.__rest)(t,["reference"]);return{placeholder:o.normalizedUrl,operation:"createObject",collection:"sharedListEntry",args:Object.assign(Object.assign(Object.assign({},i?{id:i.id}:{}),{sharedList:this._idFromReference(e.listReference),creator:e.userReference.id,createdWhen:"$now",updatedWhen:null!==(n=o.createdWhen)&&void 0!==n?n:"$now"}),o)}}))})}))}updateListEntry(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("updateListEntryTimestamp",{id:e.listEntryReference.id,updatedWhen:null!==(t=e.now)&&void 0!==t?t:Date.now()})}))}removeListEntries(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=(yield this.operation("findListEntriesByUrl",{sharedList:this._idFromReference(e.listReference),normalizedUrl:e.normalizedUrl})).map((e=>e.id));t.length&&(yield Object(b.f)(t,(e=>this.operation("deleteListEntriesByIds",{ids:e}))))}))}getSharedList(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=this._idFromReference(e),n=yield this.operation("findListByID",{id:t});if(!n)return null;return Object(c.a)(n,"shared-list-reference",{creator:"user-reference"})}))}getSharedLists(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findListsByIDs",{ids:e.map((e=>e.id))}),n={creator:"user-reference"};return t.map((e=>Object(c.a)(e,"shared-list-reference",n)))}))}getSharedUploadListLocators(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findLocatorsInListByLocationScheme",{sharedList:e.id,scheme:_.f.UploadStorage})}))}getSharedListEntries(e,t){var n,i,o;return Object(r.__awaiter)(this,void 0,void 0,(function*(){let r;if(null==t?void 0:t.fetchSingleEntry){const n=yield this.operation("findListEntryByListAndId",{sharedList:e.reference.id,id:this._idFromReference(t.fetchSingleEntry)});r=n?[n]:[]}else r=yield this.operation((null==t?void 0:t.maxEntryCount)?"findListEntriesByListPaginated":"findListEntriesByList",{sharedListID:e.reference.id,from:Date.now(),limit:null!==(n=t.maxEntryCount)&&void 0!==n?n:100});r=r.sort(((e,t)=>{var n,r;return(null!==(n=t.updatedWhen)&&void 0!==n?n:t.createdWhen)-(null!==(r=e.updatedWhen)&&void 0!==r?r:e.createdWhen)}));const s={sharedList:"shared-list-reference",creator:"user-reference"},l=yield this.operation("findLocatorsInList",{sharedList:e.reference.id}),u=this.indexLocatorsByNormalizedUrl(l),d=[];for(const e of r){let n=e.originalUrl;if(Object(a.e)({url:n})){const r=null!==(i=u.get(e.normalizedUrl))&&void 0!==i?i:[],[s]=r;n=null!==(o=null==s?void 0:s.originalUrl)&&void 0!==o?o:e.originalUrl;const a=r.find((e=>e.locationScheme===_.f.UploadStorage));if(a&&t.getUploadedPdfUrl){const e=a.location;n=yield t.getUploadedPdfUrl(e)}}d.push(Object(c.a)(Object.assign(Object.assign({},e),{sourceUrl:n}),"shared-list-entry-reference",s))}return d}))}createSharedListTree(e){var t,n,i,o,s;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{object:r}=yield this.operation("createSharedListTree",{path:null!==(t=e.data.path)&&void 0!==t?t:null,order:e.data.order,creator:e.userReference.id,linkTarget:e.isLink?e.listReference.id:null,sharedList:e.isLink?null:e.listReference.id,parentListId:null!==(i=null===(n=e.parentListReference)||void 0===n?void 0:n.id)&&void 0!==i?i:S.a,createdWhen:null!==(o=e.now)&&void 0!==o?o:"$now",updatedWhen:null!==(s=e.now)&&void 0!==s?s:"$now"});return{type:"shared-list-tree-reference",id:r.id}}))}updateSharedListTreeOrder(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("updateSharedListTreeOrder",{sharedList:e.listReference.id,order:e.order,updatedWhen:null!==(t=e.updatedWhen)&&void 0!==t?t:Date.now()})}))}moveSharedListTree(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const i=[];yield Object(O.a)({nodeId:e.listReference.id,newParentNodeId:null!==(n=null===(t=e.parentListReference)||void 0===t?void 0:t.id)&&void 0!==n?n:null,selectNodeId:e=>{var t;return null!==(t=e.sharedList)&&void 0!==t?t:e.linkTarget},selectNodeParentId:e=>e.parentListId,retrieveNode:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.getListTree({listReference:{type:"shared-list-reference",id:e}})})),createNode:(t,n)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var r;const i=!1,o=(yield this.getListTreeChildren({listReference:{type:"shared-list-reference",id:null==n?S.a:n.sharedList}})).map((e=>({id:e.id,key:e.order}))),s=o.length>0?Object(C.d)(o,"",0).create.key:Object(C.e)(o,"").create.key,a=null!=n?Object(A.a)(...Object(A.c)(n.path,"string"),n.sharedList):null;return{id:(yield this.createSharedListTree({listReference:{type:"shared-list-reference",id:t},parentListReference:null!=n?{type:"shared-list-reference",id:n.sharedList}:void 0,userReference:e.userReference,data:{order:s,path:a},now:e.now,isLink:i})).id,path:a,order:s,linkTarget:null,sharedList:t,parentListId:null!==(r=null==n?void 0:n.sharedList)&&void 0!==r?r:S.a,createdWhen:e.now,updatedWhen:e.now}})),getChildrenOfNode:e=>this.getListTreeChildren({listReference:{type:"shared-list-reference",id:e.sharedList}}),isNodeALeaf:e=>null!=e.linkTarget,updateNodesParent:(t,n)=>{var r,o,s;t.parentListId=null!==(r=null==n?void 0:n.sharedList)&&void 0!==r?r:S.a,t.path=null!=n?Object(A.a)(...Object(A.c)(null!==(o=n.path)&&void 0!==o?o:"","string"),n.sharedList):null,i.push({operation:"updateObjects",collection:"sharedListTree",where:{id:t.id},updates:{path:t.path,parentListId:t.parentListId,updatedWhen:null!==(s=null==e?void 0:e.now)&&void 0!==s?s:Date.now()}})},assertSuitableParent:e=>{if(null!=(null==e?void 0:e.linkTarget))throw new Error("Cannot move a list tree node to be a child of a link target node")}}),yield this.options.storageManager.operation("executeBatch",i)}))}deleteSharedListTree(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteSharedListTree",{sharedList:e.listReference.id})}))}createListEmailInvite(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{keyString:r}=yield this.createListKey({now:e.now,listReference:e.listReference,key:{disabled:!1,singleUse:!0,roleID:e.roleID,expiresWhen:(null!==(t=e.now)&&void 0!==t?t:Date.now())+1728e5}});return yield this.operation("createListEmailInvite",{email:e.email,sharedList:e.listReference.id,createdWhen:null!==(n=e.now)&&void 0!==n?n:"$now",sharedListKey:r,user:null,acceptedWhen:null}),{keyString:r}}))}getListInviteById(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findListEmailInvite",{id:e.id});return null!=t?t:null}))}getListInvitesByList(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.operation("findListEmailInvitesByList",{listId:e.id})}))}getListInviteByKey(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findListEmailInviteByKey",{key:e.id});return null!=t?t:null}))}acceptListInvite(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.createListRole({now:e.acceptedWhen,roleID:e.key.roleID,userReference:e.userReference,listReference:{type:"shared-list-reference",id:e.invite.sharedList}}),yield this.operation("updateListEmailInviteAcceptance",{id:e.invite.id,user:e.userReference.id,acceptedWhen:e.acceptedWhen});const t=yield this.operation("findListEmailInvitesByEmail",{email:e.invite.email,sharedList:e.invite.sharedList});yield this.operation("deleteListKeys",{ids:t.map((e=>e.id)),sharedList:e.invite.sharedList})}))}deleteListInvite(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteListEmailInvite",{id:e.inviteReference.id}),yield this.deleteListKey({keyString:e.keyString,listReference:e.listReference})}))}retrieveList(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getSharedList(e);return{entries:yield this.getSharedListEntries(n,t),sharedList:n,sharedListTree:null,creator:n.creator}}))}updateListDescription(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("updateListDescription",{id:this._idFromReference(e),newDescription:t})}))}updateListTitle(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("updateListTitle",{id:this._idFromReference(e),newTitle:t})}))}updateListPrivacy(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("updateListPrivacy",{id:this._idFromReference(e),isPrivateList:t})}))}getListByReference(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findListByID",{id:Object(E.a)(e.id)});return Object(c.a)(t,"shared-list-reference",{creator:"user-reference"})}))}getListsByReferences(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield Object(b.f)(e,(e=>this.operation("findListsByIDs",{ids:e.map((e=>e.id))}))),n={creator:"user-reference"};return t.map((e=>Object(c.a)(e,"shared-list-reference",n)))}))}getListKeysByListReferences(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield Object(b.f)(e,(e=>this.operation("findKeysByLists",{sharedLists:e.map((e=>e.id))}))),n={sharedList:"shared-list-reference"};return t.map((e=>Object(c.a)(e,"shared-list-key-reference",n)))}))}deleteListByReference(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=Object(E.a)(e.id),{storageManager:n}=this.options,r=yield n.collection("sharedList").findObject({id:t});if(!r)throw new Error(`Could not find sharedList to delete: ${e.id}`);const i=yield n.collection("sharedListEntry").findObjects({sharedList:t}),o=yield n.collection("sharedAnnotationListEntry").findObjects({sharedList:t}),s=yield n.collection("sharedListKey").findObjects({sharedList:t}),a=(yield this.getListRoles({baseListReference:e})).map((e=>Object(E.a)(e.user.id)));yield this.options.storageManager.operation("deleteObjects","sharedListRole",{sharedList:t,user:{$in:a}});for(const e of a)yield this.options.storageManager.operation("deleteObjects","sharedListRoleByUser",{sharedList:t,user:e});yield this.options.storageManager.operation("deleteObjects","sharedListEntry",{id:{$in:i.map((e=>e.id))}}),yield this.options.storageManager.operation("deleteObjects","sharedAnnotationListEntry",{id:{$in:o.map((e=>e.id))}}),yield this.options.storageManager.operation("deleteObjects","sharedListKey",{id:{$in:s.map((e=>e.id))},sharedList:t}),yield this.options.storageManager.operation("deleteObject","sharedList",{id:t}),yield this.operation("createSharedListDeleteAction",Object.assign(Object.assign({},(e=>({listMemberIdsConcat:e.join(",")}))([r.creator,...a])),{sharedList:t}))}))}getListKeysByKeyReferences(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield Object(b.f)(e,(e=>this.operation("findKeys",{ids:e.map((e=>e.id)),sharedList:t.id})))}))}getListKeyByKeyReference(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.operation("findKey",{id:e.id,sharedList:t.id});return null!=n?n:null}))}getUserPersonalListBySharedListRef(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.options.storageManager.collection("personalListShare").findObject({user:e.userReference.id,remoteId:e.listReference.id});if(!t)return null;const n=yield this.options.storageManager.collection("personalList").findObject({user:e.userReference.id,id:t.personalList});return null==(null==n?void 0:n.localId)?null:n}))}getListEntryByReference(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findListEntryById",{id:e.id});return this._prepareRetrievedListEntry(t)}))}getListEntryByListAndUrl(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findListEntryByUrl",{sharedList:e.listReference.id,normalizedUrl:e.normalizedPageUrl});return this._prepareRetrievedListEntry(t)}))}getListEntriesByListAndUrls(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.operation("findListEntriesByUrls",{sharedList:e.listReference.id,normalizedUrls:e.normalizedPageUrls})).map(this._prepareRetrievedListEntry)}))}getListEntriesByList(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t="findListEntriesByList";e.from&&e.limit?t="findListEntriesByListPaginated":e.from&&(t="findListEntriesByListAfterTime");return(yield this.operation(t,{sharedListID:e.listReference.id,from:e.from,limit:e.limit})).map(this._prepareRetrievedListEntry)}))}getAnnotationEntryByReference(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findAnnotationEntryById",{id:e.id});return Object(c.a)(t,"shared-annotation-list-entry-reference",{sharedList:"shared-list-reference",sharedAnnotation:"shared-list-reference",creator:"user-reference"})}))}getListsByCreator(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=this._idFromReference(e);return this.operation("findListsByCreator",{creatorId:t})}))}getListReferencesByCreator(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.getListsByCreator(e)).map((e=>({id:e.id,type:"shared-list-reference"})))}))}getRandomUserListEntryForUrl(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findSingleEntryByUserAndUrl",{creator:this._idFromReference(e.creatorReference),normalizedUrl:e.normalizedUrl});return t?(delete t.id,delete t.creator,delete t.sharedList,{entry:t}):null}))}getUserListEntriesForUrl(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findAllEntriesByUserAndUrl",{creator:e.creatorReference.id,normalizedUrl:e.normalizedUrl}),n={sharedList:"shared-list-reference"};return t.map((e=>Object(c.a)(e,"shared-list-reference",n)))}))}getUserLists(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findListsByCreator",{creatorId:e.userReference.id}),n=yield this.operation("findListRolesByUser",{user:e.userReference.id}),r=new Set,i=[],o=(e,t)=>{r.has(t)||(i.push({reason:e,listReference:{type:"shared-list-reference",id:t}}),r.add(t))};for(const e of t)o("creator",e.id);for(const e of n)o("joined",e.sharedList);return i}))}createPageInfo(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return{type:"shared-page-info-reference",id:(yield this.operation("createPageInfo",Object.assign(Object.assign({},e.pageInfo),{createdWhen:"$now",updatedWhen:"$now",creator:this._idFromReference(e.creatorReference)}))).object.id}}))}ensurePageInfo(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getPageInfoByCreatorAndUrl({normalizedUrl:e.pageInfo.normalizedUrl,creatorReference:e.creatorReference});if(t)return t.reference;return yield this.createPageInfo(e)}))}updatePageInfoTitle(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=null===(t=e.pageInfo.fullTitle)||void 0===t?void 0:t.trim();if(!(null==n?void 0:n.length))throw new Error("Cannot set empty title");if(!(yield this.getPageInfo({type:"shared-page-info-reference",id:e.pageInfo.id})))throw new Error("Cannot update title for non-existent page");yield this.operation("updatePageInfoTitleById",{id:e.pageInfo.id,fullTitle:n})}))}updateListEntryTitle(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=null===(t=e.listEntry.entryTitle)||void 0===t?void 0:t.trim();if(!(null==n?void 0:n.length))throw new Error("Cannot set empty title");yield this.operation("updateListEntryTitle",{id:e.listEntry.id,entryTitle:n})}))}resolveSourceUrlForPDFPageInfo(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t=e.originalUrl;if(Object(a.e)({url:e.normalizedUrl})){const{locators:n}=yield this.getContentLocatorsByUrl({normalizedUrl:e.normalizedUrl,creatorReference:{type:"user-reference",id:e.creator}});n.length>0&&(t=n[0].originalUrl)}return Object.assign(Object.assign({},e),{sourceUrl:t})}))}getPageInfo(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findPageInfoById",{id:this._idFromReference(e)});return this._preparePageInfoForUser(yield this.resolveSourceUrlForPDFPageInfo(t))}))}getPageInfoByCreatorAndUrl(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findPageInfoByCreatorAndUrl",{normalizedUrl:e.normalizedUrl,creator:this._idFromReference(e.creatorReference)});return t?this._preparePageInfoForUser(yield this.resolveSourceUrlForPDFPageInfo(t)):null}))}getPageInfosByCreatorAndUrls(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.operation("findPageInfosByCreatorAndUrls",{normalizedUrls:e.normalizedUrls,creator:this._idFromReference(e.creatorReference)});return null!==(t=null==n?void 0:n.map(this._preparePageInfoForUser))&&void 0!==t?t:[]}))}deletePageInfo(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deletePageInfoById",{id:this._idFromReference(e)})}))}findContentLocatorsByUrlAndUser(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findLocatorsByUrlAndCreator",{normalizedUrl:e.normalizedUrl,creator:e.userReference.id});return{locators:t,references:t.map((e=>({type:"shared-content-locator-reference",id:e.id})))}}))}getContentLocatorsByUrl(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t;t="listReference"in e?yield this.operation("findLocatorsInListByUrl",{normalizedUrl:e.normalizedUrl,sharedList:e.listReference.id}):yield this.operation("findLocatorsByUrlAndCreator",{normalizedUrl:e.normalizedUrl,creator:e.creatorReference.id});const n={locators:[],references:[]};for(let e of t){const{id:t}=e,i=Object(r.__rest)(e,["id"]);n.references.push({id:t,type:"shared-content-locator-reference"}),n.locators.push(i)}return n}))}createAnnotations(e){var t,n,i,o,s,a,c;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const l=[],u={},d={},h={annotations:0,entries:0},f=yield Object(b.f)(T()(Object.values(e.annotationsByPage)),(e=>this.operation("findAnnotationEntriesForAnnotations",{sharedAnnotations:e.map((e=>e.id))}))),p=new Set(f.map(P));for(const[f,g]of Object.entries(e.annotationsByPage))for(let m of g){const{localId:g}=m,y=Object(r.__rest)(m,["localId"]),v="annotation-"+h.annotations++;u[g]=v,l.push({placeholder:v,operation:"createObject",collection:"sharedAnnotation",args:Object.assign(Object.assign({},y),{body:null!==(t=y.body)&&void 0!==t?t:null,selector:null!==(n=y.selector)&&void 0!==n?n:null,comment:null!==(i=y.comment)&&void 0!==i?i:null,color:null!==(o=y.color)&&void 0!==o?o:null,normalizedPageUrl:f,createdWhen:null!==(s=y.createdWhen)&&void 0!==s?s:"$now",uploadedWhen:"$now",updatedWhen:"$now",creator:e.creator.id})});for(const t of e.listReferences){const n={sharedList:this._idFromReference(t),createdWhen:null!==(a=y.createdWhen)&&void 0!==a?a:"$now",uploadedWhen:"$now",updatedWhen:"$now",creator:e.creator.id,normalizedPageUrl:f};if(p.has(P(n)))continue;const r="entry-"+h.entries++;d[g]=[...null!==(c=d[g])&&void 0!==c?c:[],r],l.push({placeholder:r,operation:"createObject",collection:"sharedAnnotationListEntry",args:n,replace:[{path:"sharedAnnotation",placeholder:v}]})}}const g=yield this.operation("createAnnotationsAndEntries",{batch:l}),m={sharedAnnotationReferences:{},sharedAnnotationListEntryReferences:{}};for(const[e,t]of Object.entries(u))m.sharedAnnotationReferences[e]={type:"shared-annotation-reference",id:g.info[t].object.id};for(const[e,t]of Object.entries(d))m.sharedAnnotationListEntryReferences[e]=t.map((e=>({type:"shared-annotation-list-entry-reference",id:g.info[e].object.id})));return m}))}doesAnnotationExistForPageInList(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return null!=(yield this.operation("findSingleAnnotationEntryByListPage",{sharedList:this._idFromReference(e.listReference),normalizedPageUrl:e.normalizedPageUrl}))}))}getAnnotationsForPagesInList(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!e.normalizedPageUrls.length)return{};if(e.normalizedPageUrls.length>10)throw new Error("We can't fetch annotations for more than 10 pages at a time");const n=yield this.operation("findAnnotationEntriesByListPages",{sharedList:this._idFromReference(e.listReference),normalizedPageUrls:e.normalizedPageUrls}),r={},i=yield Object(b.f)(n,(e=>this.operation("findAnnotationsByIds",{ids:e.map((e=>e.sharedAnnotation))})),10);for(const e of i){(r[e.normalizedPageUrl]=null!==(t=r[e.normalizedPageUrl])&&void 0!==t?t:[]).push({annotation:e})}for(const e of Object.keys(r))r[e]=o()(r[e],[({annotation:e})=>e.createdWhen,u.a]);return r}))}getAnnotationListEntriesForListsOnPage(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield Object(b.f)(e.listReferences,(t=>this.operation("findAnnotationEntriesByListsOnPage",{sharedLists:t.map((e=>this._idFromReference(e))),normalizedPageUrl:e.normalizedPageUrl})));if("error"in n)throw new Error(n.error);const r={};for(const e of n){const n={type:"shared-annotation-list-entry-reference",id:e.id},i={type:"shared-annotation-reference",id:e.sharedAnnotation},o={type:"shared-list-reference",id:e.sharedList};delete e.id,r[e.sharedList]=[...null!==(t=r[e.sharedList])&&void 0!==t?t:[],Object.assign(Object.assign({},e),{reference:n,creator:{type:"user-reference",id:e.creator},sharedList:o,sharedAnnotation:i})]}return r}))}getAnnotationListEntriesForLists(e){var t,n,i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield Object(b.f)(e.listReferences,(e=>this.operation("findAnnotationEntriesByLists",{sharedLists:e.map((e=>this._idFromReference(e)))})));if("error"in r)throw new Error(r.error);const o={};for(const e of r){const r={type:"shared-annotation-list-entry-reference",id:e.id},s={type:"shared-annotation-reference",id:e.sharedAnnotation},a={type:"shared-list-reference",id:e.sharedList};delete e.id,o[e.sharedList]=Object.assign(Object.assign({},null!==(t=o[e.sharedList])&&void 0!==t?t:{}),{[e.normalizedPageUrl]:[...null!==(i=null===(n=o[e.sharedList])||void 0===n?void 0:n[e.normalizedPageUrl])&&void 0!==i?i:[],Object.assign(Object.assign({},e),{reference:r,creator:{type:"user-reference",id:e.creator},sharedList:a,sharedAnnotation:s})]})}return o}))}getAnnotationListEntries(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=null!=e.from?"findAnnotationEntriesByListAfterTime":"findAnnotationEntriesByList";let r=yield this.operation(n,{sharedList:this._idFromReference(e.listReference),from:e.from});e.ignoreFromUser&&(r=r.filter((t=>t.creator!==e.ignoreFromUser.id)));const i={};for(const e of r){const n={type:"shared-annotation-list-entry-reference",id:e.id},r={type:"shared-annotation-reference",id:e.sharedAnnotation},o={type:"shared-list-reference",id:e.sharedList};delete e.id;(i[e.normalizedPageUrl]=null!==(t=i[e.normalizedPageUrl])&&void 0!==t?t:[]).push(Object.assign(Object.assign({},e),{reference:n,creator:{type:"user-reference",id:e.creator},sharedList:o,sharedAnnotation:r}))}return i}))}getAnnotationListEntriesForAnnotation(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findAnnotationEntriesForAnnotation",{sharedAnnotation:e.annotationReference.id}),n={creator:"user-reference",sharedAnnotation:"shared-annotation-reference",sharedList:"shared-list-reference"};return t.map((e=>Object(c.a)(e,"shared-annotation-list-entry-reference",n)))}))}enrichAnnotationsWithColorsFromUsers(e,t){var n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r={};for(const t of e){const e=yield this.options.storageManager.collection("personalMemexSetting").findOneObject({name:I,user:t});e&&(r[t]=e.value)}for(const e of t)if(e.color){const t=null===(n=r[e.creator])||void 0===n?void 0:n.find((t=>e.color===t.id));t&&(e.color=JSON.stringify([t.color,t.label]))}return t}))}getAnnotations(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t=yield Object(b.f)(e.references,(e=>this.operation("findAnnotationsByIds",{ids:e.map((e=>e.id))})));const n=[];for(const e of t)n.includes(e.creator)||n.push(e.creator);e.skipUserHighlightColors||(t=yield this.enrichAnnotationsWithColorsFromUsers(n,t));const r={};for(const e of t){r[e.id]=this._prepareAnnotationForUser(e)}return r}))}getListAnnotationsByCreatorAndPageUrl(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findAnnotationEntriesByCreatorAndPageUrl",{creator:this._idFromReference(e.creatorReference),normalizedPageUrl:e.normalizedPageUrl,sharedList:e.sharedListReference.id});return(yield this.operation("findAnnotationsByIds",{ids:t.map((e=>e.sharedAnnotation))})).map((e=>this._prepareAnnotationForUser(e)))}))}getAnnotationsByCreatorAndPageUrl(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.operation("findAnnotationsByCreatorAndPageUrl",{creator:this._idFromReference(e.creatorReference),normalizedPageUrl:e.normalizedPageUrl})).map((e=>this._prepareAnnotationForUser(e)))}))}_prepareAnnotationForUser(e){const t={type:"shared-annotation-reference",id:e.id};delete e.id;const n={type:"user-reference",id:e.creator};return Object.assign(Object.assign({},e),{creator:n,reference:t,linkId:this.getSharedAnnotationLinkID(t)})}getAnnotation(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=this._idFromReference(e.reference),n=yield this.operation("findAnnotationById",{id:t});if(!n)return null;const r={type:"user-reference",id:n.creator};return delete n.id,delete n.creator,{annotation:n,creatorReference:r}}))}addAnnotationsToLists(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=e.skipCheckExisting?[]:yield Object(b.f)(e.sharedAnnotations,(e=>this.operation("findAnnotationEntriesForAnnotations",{sharedAnnotations:e.map((e=>e.reference.id))}))),n=new Set(t.map(P)),r=[],i={entries:0};for(const{reference:t,normalizedPageUrl:o,createdWhen:s}of e.sharedAnnotations)for(const a of e.sharedListReferences){const c={sharedList:this._idFromReference(a),sharedAnnotation:this._idFromReference(t),createdWhen:s,uploadedWhen:"$now",updatedWhen:"$now",creator:e.creator.id,normalizedPageUrl:o};!e.skipCheckExisting&&n.has(P(c))||r.push({placeholder:"entry-"+i.entries++,operation:"createObject",collection:"sharedAnnotationListEntry",args:c})}yield this.operation("createAnnotationListEntries",{batch:r})}))}removeAnnotationsFromLists(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=[];let n=0;const i=e.sharedListReferences&&new Set(e.sharedListReferences.map((e=>this._idFromReference(e))));yield Object(b.b)(e.sharedAnnotationReferences,(e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.operation("findAnnotationEntriesForAnnotations",{sharedAnnotations:e.map((e=>this._idFromReference(e)))}),o=i?r.filter((e=>!i||i.has(e.sharedList))):r;t.push(...o.map((e=>({placeholder:"deletion-"+n++,operation:"deleteObjects",collection:"sharedAnnotationListEntry",where:{id:e.id}}))))})))),yield Object(b.b)(t,(e=>this.operation("deleteAnnotationEntries",{batch:e})),400)}))}removeAnnotationListEntries(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=e.annotationEntryReferences.map(((e,t)=>({placeholder:`deletion-${t}`,operation:"deleteObjects",collection:"sharedAnnotationListEntry",where:{id:e.id}})));yield Object(b.b)(t,(e=>this.operation("deleteAnnotationEntries",{batch:e})),400)}))}removeAnnotations(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.removeAnnotationsFromLists(e);let t=0;const n=e.sharedAnnotationReferences.map((e=>({placeholder:"deletion-"+t++,operation:"deleteObjects",collection:"sharedAnnotation",where:{id:this._idFromReference(e)}})));yield Object(b.b)(n,(e=>this.operation("deleteAnnotations",{batch:e})),400)}))}updateAnnotationComment(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("updateAnnotationComment",{id:this._idFromReference(e.sharedAnnotationReference),comment:e.updatedComment,updatedWhen:null!==(t=e.now)&&void 0!==t?t:Date.now()})}))}updateAnnotationHighlight(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("updateAnnotationHighlight",{id:this._idFromReference(e.sharedAnnotationReference),body:e.updatedHighlight,updatedWhen:null!==(t=e.now)&&void 0!==t?t:Date.now()})}))}updateAnnotationColor(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("updateAnnotationColor",{id:this._idFromReference(e.sharedAnnotationReference),color:e.updatedColor,updatedWhen:null!==(t=e.now)&&void 0!==t?t:Date.now()})}))}createListKey(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=null!==(t=e.now)&&void 0!==t?t:Date.now();return{keyString:(yield this.options.storageManager.operation("createObject","sharedListKey",Object.assign(Object.assign(Object.assign({},e.key),e.listKeyReference?{id:Object(E.a)(e.listKeyReference.id)}:{}),{createdWhen:n,updatedWhen:n,sharedList:e.listReference.id,disabled:!1}))).object.id}}))}getListKeys(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findKeysByList",{sharedList:e.listReference.id}),n={sharedList:"shared-list-reference"};return t.map((e=>Object(c.a)(e,"shared-list-key-reference",n)))}))}getListKey(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t="string"===this.options.autoPkType?e.keyString:parseInt(e.keyString);if("number"==typeof t&&isNaN(t))return null;const n=yield this.operation("findListKey",{sharedList:Object(E.a)(e.listReference.id),id:t});return Object(c.a)(n,"shared-list-key-reference",{sharedList:"shared-list-reference"})}))}deleteListKey(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteListKey",{sharedList:e.listReference.id,id:"number"===this.options.autoPkType?parseInt(e.keyString):e.keyString})}))}mapRawListRolesToReferences(e){const t={user:"user-reference",sharedList:"shared-list-reference"};return e.map((e=>Object(c.a)(e,"shared-list-role-reference",t)))}getUserListRoles(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findListRolesByUser",{user:e.userReference.id});return this.mapRawListRolesToReferences(t)}))}getUserListRolesForLists(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findListRolesByUserForLists",{user:e.userReference.id,sharedLists:e.listReferences.map((e=>e.id))});return this.mapRawListRolesToReferences(t)}))}getListTree(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.operation("findSharedListTree",{sharedList:e.listReference.id})}))}getListTrees(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.operation("findSharedListTrees",{sharedLists:e.listReferences.map((e=>e.id))})}))}getListTreeChildren(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.operation("findSharedListTreesByParent",{parentListId:e.listReference.id})}))}getListRole(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findListRole",{sharedList:e.listReference.id,user:e.userReference.id});return Object(c.a)(t,"shared-list-role-reference",{user:"user-reference",sharedList:"shared-list-reference"})}))}getListRolesLineage(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getListTree({listReference:e.baseListReference});if(!t){const t=yield this.getListRoles(e);return{[e.baseListReference.id]:t}}const n=[...Object(A.c)(t.path,"string"),t.sharedList],r={};for(const e of n){const t=yield this.operation("findListRoles",{sharedList:e});r[e]=this.mapRawListRolesToReferences(t)}return r}))}getListRoles(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findListRoles",{sharedList:e.baseListReference.id});return this.mapRawListRolesToReferences(t)}))}getListRolesLineageForUsers(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=null!==(t=e.sharedListTree)&&void 0!==t?t:yield this.getListTree({listReference:e.baseListReference});if(null==n)return this.getListRoles(e);const r=[...Object(A.c)(n.path,"string"),n.sharedList].reverse(),i=yield this.operation("findListRolesByUserForLists",{user:e.userReference.id,sharedLists:r});return this.mapRawListRolesToReferences(i)}))}createListRole(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("createListRole",{createdWhen:null!==(t=e.now)&&void 0!==t?t:Date.now(),updatedWhen:null!==(n=e.now)&&void 0!==n?n:Date.now(),sharedList:Object(E.a)(e.listReference.id),user:e.userReference.id,roleID:e.roleID})}))}updateListRole(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("updateListRole",{sharedList:Object(E.a)(e.listReference.id),user:e.userReference.id,roleID:e.roleID})}))}createUploadLocator(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("createUploadLocator",{locationScheme:_.f.UploadStorage,location:e.uploadId,creator:e.userReference.id,normalizedUrl:e.normalizedUrl,originalUrl:e.originalUrl,sharedList:null!==(n=null===(t=e.listReference)||void 0===t?void 0:t.id)&&void 0!==n?n:null})}))}createLocatorsAndFingerprintsForList(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield Object(b.a)(e.listReferences,(t=>this.operation("findFingerprintsInListsByUrl",{normalizedUrl:e.normalizedPageUrl,sharedLists:t.map((e=>e.id))}))),r=yield Object(b.a)(e.listReferences,(t=>this.operation("findLocatorsInListsByUrl",{normalizedUrl:e.normalizedPageUrl,sharedLists:t.map((e=>e.id))}))),i=[];for(const[o,s]of e.listReferences.entries()){for(const[t,r]of e.fingerprints.entries())n.find((e=>e.sharedList===s.id&&Object(a.d)(e,r)))||i.push({placeholder:`fingerprint-${t}-${o}`,operation:"createObject",collection:"sharedContentFingerprint",args:Object.assign(Object.assign({},r),{creator:e.creator.id,normalizedUrl:e.normalizedPageUrl,sharedList:s.id})});for(const[n,a]of e.locators.entries())r.find((e=>e.sharedList===s.id&&e.originalUrl===a.originalUrl))||i.push({placeholder:`locator-${n}-${o}`,operation:"createObject",collection:"sharedContentLocator",args:Object.assign(Object.assign({},a),{location:null!==(t=a.location)&&void 0!==t?t:null,creator:e.creator.id,normalizedUrl:e.normalizedPageUrl,sharedList:s.id})})}yield Object(b.b)(i,(e=>this.operation("createFingerprintsAndLocators",{batch:e})))}))}createUnlistedLocatorsAndFingerprints(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.operation("findFingerprintsByUrl",{normalizedUrl:e.normalizedPageUrl}),r=[];for(const[t,i]of e.fingerprints.entries())n.find((e=>Object(a.d)(e,i)))||r.push({placeholder:`fingerprint-${t}`,operation:"createObject",collection:"sharedContentFingerprint",args:Object.assign(Object.assign({},i),{creator:e.creator.id,normalizedUrl:e.normalizedPageUrl,sharedList:null})});for(const[n,i]of e.locators.entries())r.push({placeholder:`locator-${n}`,operation:"createObject",collection:"sharedContentLocator",args:Object.assign(Object.assign({},i),{location:null!==(t=i.location)&&void 0!==t?t:null,creator:e.creator.id,normalizedUrl:e.normalizedPageUrl,sharedList:null})});yield Object(b.b)(r,(e=>this.operation("createFingerprintsAndLocators",{batch:e})))}))}getNormalizedUrlsByFingerprints(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(e.fingerprints.length>10)throw new Error("Cannot normalized URLs for more than 10 fingerprints at a time");const t=T()(yield Promise.all(e.fingerprints.map((t=>Object(b.a)(e.listReferences,(e=>this.operation("findFingerprintInLists",{fingerprint:t.fingerprint,sharedLists:e.map((e=>e.id))}))))))),n={};for(const r of t){const t=e.fingerprints.find((e=>Object(a.d)(e,r)));t&&(n[r.sharedList]={fingerprint:t,normalizedUrl:r.normalizedUrl,listReference:{type:"shared-list-reference",id:r.sharedList}})}return n}))}_idFromReference(e){return Object(c.c)(e,this.options)}_referenceFromLinkId(e,t){return Object(c.b)(e,t,this.options)}}const P=e=>`${e.sharedList}-${e.normalizedPageUrl}`;var x=n(890)},function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var r=n(2),i=n(778),o=n.n(i),s=(n(1305),n(295)),a=n(767),c=n(569);const l=e=>`_${e}_terms`;function u(e){const t={};return Object.entries(e).forEach((([e,n])=>{t[e]=function({name:e,fields:t,indices:n,relationshipsByAlias:r}){const i=t=>{const n=r[t.relationship];if(!n)throw new Error(`You tried to create an index in collection\n                '${e}' on non-existing relationship '${t.relationship}'`);if(Object(c.c)(n))return n.fieldName;if(Object(c.d)(n))return n.fieldNames;throw new Error(`Unsupported relationship index in collection '${name}'`)};return(n?[...n]:[]).sort((({pk:e})=>e?-1:1)).map((e=>{var n;if(e.field instanceof Array){const t=[];for(const n of e.field)if(Object(c.e)(n)){const e=i(n);if(e instanceof Array)throw new Error("Cannot create a compound index involving a 'connects' relationship");t.push(e)}else t.push(n);return`[${t.join("+")}]`}if(!Object(c.e)(e.field)&&!(null==r?void 0:r[e.field])&&"text"===t[e.field].type){return`*${e.fullTextIndexName||l(e.field)}`}let o=Object(c.e)(e.field)?i(e.field):e.field,s=e.unique?"&":"";return s=e.pk&&(e.autoInc||"auto-pk"===(null===(n=t[e.field])||void 0===n?void 0:n.type))?"++":s,`${s}${o}`})).join(", ")}(n)})),{schema:t}}var d=n(1040);function h(e,t){for(const[n,r]of Object.entries(t.fields))r.optional&&void 0===e[n]&&(e[n]=null)}function f(e,t){const n={$inc:(e,t,n)=>e[t]+=n,$set:(e,t,n)=>e[t]=n,$mul:(e,t,n)=>e[t]*=n,$unset:(e,t)=>e[t]=void 0,$rename:()=>{},$min:()=>{},$max:()=>{},$addToSet:()=>{},$pop:()=>{},$push:()=>{},$pull:()=>{},$pullAll:()=>{},$slice:()=>{},$sort:()=>{}};for(const[r,i]of Object.entries(e))null!=n[r]?Object.entries(i).forEach((([e,i])=>n[r](t,e,i))):t[r]=i}var p=n(321);function g(e){return(t,n)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){for(const r of e)t=(yield r(t,n))||t;return t}))}const m=({purpose:e})=>(t,n)=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){for(const[r,i]of Object.entries(n.collectionDefinition.fields))if("text"===i.type){if(null==i._index)continue;const o=t[r];if(!o)continue;if(!n.stemmerSelector)throw new Error(`You tried to write to an indexed text field (${r}) without specifying a stemmer selector`);const s=n.stemmerSelector({collectionName:n.collectionDefinition.name,fieldName:r});if(!s)throw new Error(`You tried to write to an indexed text field (${r}) without specifying a stemmer for that field`);const a=n.collectionDefinition.indices[i._index].fullTextIndexName||l(r);if("update"===e&&Object.keys(t).includes(a))return;t[a]=[...s(o)]}}));function y(e){const t=e.purpose,n="from-storage"===("read"===t?"from-storage":"to-storage")?"prepareFromStorage":"prepareForStorage";return(e,i)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){for(const[r,o]of Object.entries(i.collectionDefinition.fields))if(o.fieldObject){const i=e[r];if("create"!==t&&!Object.keys(e).includes(r))continue;const s=yield o.fieldObject[n](i);e[r]=s}}))}const v=(e,t)=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){for(const n of t.collectionDefinition.relationships||[])Object(p.d)(n)?n.alias!==n.fieldName&&void 0!==e[n.alias]&&(e[n.fieldName]=e[n.alias],delete e[n.alias]):Object(p.e)(n)&&(n.aliases[0]!==n.fieldNames[0]&&e[n.aliases[0]],n.aliases[1]!==n.fieldNames[1]&&e[n.aliases[1]])})),b=(e,t)=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){for(const n of t.collectionDefinition.relationships||[])Object(p.d)(n)?n.alias!==n.fieldName&&(e[n.alias]=e[n.fieldName],delete e[n.fieldName]):Object(p.e)(n)&&(n.aliases[0]!==n.fieldNames[0]&&e[n.aliases[0]],n.aliases[1]!==n.fieldNames[1]&&e[n.aliases[1]])})),_=(e,t)=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){for(const[n,r]of Object.entries(t.collectionDefinition.fields))"timestamp"===r.type&&"$now"===e[n]&&(e[n]=Date.now())})),w=e=>e;class T extends a.b{constructor(e){if(super(),this.options=e,this.features={count:!0,createWithRelationships:!0,fullTextSearch:!0,rawCreateObjects:!0,executeBatch:!0,transaction:!0,customFields:!0,streamObjects:!0},this.initialized=!1,this.readObjectCleaner=g([b,y({purpose:"read"})]),this.createObjectCleaner=g([y({purpose:"create"}),m({purpose:"create"}),v,_]),this.updateObjectCleaner=g([y({purpose:"update"}),m({purpose:"update"}),v,_]),this.whereObjectCleaner=g([y({purpose:"query-where"}),v]),this._onRegistryInitialized=()=>{this._validateRegistry(),this._initDexie(),this.initialized=!0},this._initDexie=()=>{if(null!=this.dexie)return;this.dexie=new o.a(this.dbName,{indexedDB:this.idbImplementation.factory,IDBKeyRange:this.idbImplementation.range}),o.a.prototype.collection=function(e){return this.table(e)};const e=function(e){const t={},n=[];let r=0;for(const{collections:i,version:o}of e.getSchemaHistory())Object.assign(t,i),n.push(Object.assign(Object.assign({},u(t)),{dexieSchemaVersion:++r,storexSchemaVersion:o}));return n}(this.registry);for(const{dexieSchemaVersion:t,schema:n}of this.schemaPatcher(e))this.dexie.version(t).stores(n)},this.hasStemmer=!(!e.stemmer&&!e.stemmerSelector),this.hasCustomStemmerSelector=!!e.stemmerSelector,e.stemmerSelector){if(e.stemmer)throw new Error("You cannot pass both a 'stemmer' and a 'stemmerSelector' into DexieStorageBackend")}else e.stemmer?e.stemmerSelector=()=>e.stemmer:e.stemmerSelector=()=>null;this.dbName=e.dbName,this.idbImplementation=e.idbImplementation||{factory:(null!==window&&void 0!==window?window:self).indexedDB,range:(null!==window&&void 0!==window?window:self).IDBKeyRange},this.stemmerSelector=e.stemmerSelector,this.schemaPatcher=e.schemaPatcher||w}get dexieInstance(){return this.dexie}configure({registry:e}){super.configure({registry:e}),e.once("initialized",this._onRegistryInitialized)}supports(e){return"fullTextSearch"!==e?super.supports(e):!!this.stemmerSelector}_validateRegistry(){if(this.hasStemmer&&!this.hasCustomStemmerSelector)for(const[e,t]of Object.entries(this.registry.collections))for(const n of t.indices||[])if("string"==typeof n){if("text"===t.fields[n].type)throw new Error(`Trying to create full-text index on '${e}.${n}'\n                            without having supplied a stemmer to the Dexie back-end`)}}migrate({database:e}={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(e)throw new Error("This backend doesn't support multiple databases directly")}))}cleanup(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){}))}rawCreateObjects(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!0===(null==n?void 0:n.withNestedObjects))throw Error("rawCreateObjects must be called withNestedObjects equal to false. (nested and complex Objects are not supported in these low level bulk creations)");return yield this.dexie.table(e).bulkPut(t),{objects:t}}))}createObject(e,t,n={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this._complexCreateObject(e,t,Object.assign(Object.assign({},n),{needsRawCreates:!1}))}))}_complexCreateObject(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{collectionDefinition:n}=this._prepareOperation({operationName:"createObject",collection:e}),r=Object(s.b)({operation:"createObject",collection:e,args:t},this.registry),i=Object(s.a)(r),o=yield this._rawExecuteBatch(i,{needsRawCreates:!0});return this._reconstructCreatedObject(t,e,r,o.info),this.options.legacyMemexCompatibility||h(t,n),{object:t}}))}_reconstructCreatedObject(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function*(){for(const r of n.objects){const n=this.registry.collections[t].pkIndex;Object(s.g)(e,[...r.path,n],i[r.placeholder].object[n])}}))}_rawCreateObject(e,t,n={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{collectionDefinition:n}=this._prepareOperation({operationName:"createObject",collection:e});return yield this.createObjectCleaner(t,{collectionDefinition:n,stemmerSelector:this.stemmerSelector}),yield this.dexie.table(e).put(t),this.options.legacyMemexCompatibility||h(t,n),{object:t}}))}_findIgnoreCase(e,t,n={}){const[[r,i],...o]=Object.entries(t);if(o.length)throw new d.b("Find methods with `ignoreCase` set only support querying a single field.");if(n.ignoreCase&&n.ignoreCase[0]!==r)throw new d.a(`Specified ignoreCase field '${n.ignoreCase[0]}' is not in filter query.`);return this.dexie.table(e).where(r).equalsIgnoreCase(i)}_rawFindObjects(e,t,n={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{collectionDefinition:r}=this._prepareOperation({operationName:"findObjects",collection:e}),i=n.order&&n.order.length?n.order[0]:null;if(i&&n.order.length>1)throw new Error("Sorting on multiple fields is not supported");const o=n.reverse||i&&"desc"==i[1];yield this.whereObjectCleaner(t,{collectionDefinition:r,stemmerSelector:this.stemmerSelector});let s,a=n.ignoreCase&&n.ignoreCase.length?this._findIgnoreCase(e,t,n):this.dexie.collection(e).find(t);return i?(s=yield a.sortBy(i[0]),o&&s.reverse(),n.limit&&(s=s.slice(0,n.limit))):(n.skip&&n.skip>0&&(a=a.offset(n.skip)),n.limit&&(a=a.limit(n.limit)),s=yield a.toArray()),s}))}findObjects(e,t,n={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{collectionDefinition:i}=this._prepareOperation({operationName:"findObjects",collection:e}),o=yield this._rawFindObjects(e,t,n);return yield Promise.all(o.map((e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){this.options.legacyMemexCompatibility||h(e,i),yield this.readObjectCleaner(e,{collectionDefinition:i,stemmerSelector:this.stemmerSelector})}))))),o}))}streamObjects(e){return Object(r.__asyncGenerator)(this,arguments,(function*(){const t=this.dexie.table(e),n=1e3;let i,o=0;do{i=yield Object(r.__await)(t.toCollection().offset(o*n).limit(n).primaryKeys());for(const e of i)yield yield Object(r.__await)(yield Object(r.__await)(t.get(e)));o++}while(i.length===n)}))}updateObjects(e,t,n,i={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{collectionDefinition:r}=this._prepareOperation({operationName:"updateObjects",collection:e});yield this.updateObjectCleaner(n,{collectionDefinition:r,stemmerSelector:this.stemmerSelector});const o=yield this._rawFindObjects(e,t,i);for(const t of o)f(n,t),yield this.dexie.table(e).put(t)}))}deleteObjects(e,t,n={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{collectionDefinition:n}=this._prepareOperation({operationName:"deleteObjects",collection:e});yield this.whereObjectCleaner(t,{collectionDefinition:n,stemmerSelector:this.stemmerSelector});const{deletedCount:r}=yield this.dexie.collection(e).remove(t)}))}countObjects(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.dexie.collection(e).count(t)}))}executeBatch(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!e.length)return{info:{}};const t=Array.from(new Set(function(e,t){const n=[];let r=0;const i=()=>"auto-gen:"+ ++r;for(const r of e){if("createObject"!==r.operation){n.push(r);continue}const e=Object(s.b)(r,t,{generatePlaceholder:(()=>{let e=!0;return()=>e?(e=!1,r.placeholder||i()):i()})()}),o=Object(s.a)(e);for(const e of o)n.push(e)}return n}(e,this.registry).map((e=>e.collection))));let n=null;return yield this.transaction({collections:t},(()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){n=(yield this._rawExecuteBatch(e,{needsRawCreates:!1})).info})))),{info:n}}))}transaction(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return t({transactionOperation:(e,...t)=>this.operation(e,...t)})}));if("undefined"!=typeof navigator){const t=e.collections.map((e=>this.dexie.table(e)));return this.dexie.transaction("rw",t,n)}return n()}))}_rawExecuteBatch(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n={},r={};for(const i of e)if("createObject"===i.operation){for(const{path:e,placeholder:t}of i.replace||[])i.args[e]=r[t].id;const{object:e}=t.needsRawCreates?yield this._rawCreateObject(i.collection,i.args):yield this._complexCreateObject(i.collection,i.args,{needsRawCreates:!0});i.placeholder&&(n[i.placeholder]={object:e},r[i.placeholder]=e)}else"updateObjects"===i.operation?yield this.updateObjects(i.collection,i.where,i.updates):"deleteObjects"===i.operation&&(yield this.deleteObjects(i.collection,i.where));return{info:n}}))}operation(e,...t){const n=Object.create(null,{operation:{get:()=>super.operation}});return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!this.initialized)throw new Error("Tried to use Dexie backend without calling StorageManager.finishInitialization() first");return yield n.operation.call(this,e,...t)}))}_prepareOperation(e){const t=this.registry.collections[e.collection];if(!t)throw new Error(`Tried to do '${e.operationName}' operation on non-existing collection: ${e.collection}`);return{collectionDefinition:t}}}},function(e,t,n){"use strict";var r=n(693);n.d(t,"a",(function(){return r.a}));r.a.registerVersion("firebase","10.11.0","app-compat")},function(e,t,n){var r=n(232)("keys",n(116),n(787));r.placeholder=n(164),e.exports=r},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return Vo})),n.d(t,"c",(function(){return Ko})),n.d(t,"b",(function(){return Yo}));var r=n(2),i=n(1053),o=n.n(i),s=n(1240),a=n(6),c=n(80);const l="notifications",u={[l]:{version:new Date("2019-08-18"),fields:{id:{type:"string"},title:{type:"string"},message:{type:"string"},buttonText:{type:"string"},link:{type:"string"},sentTime:{type:"datetime"},deliveredTime:{type:"datetime"},readTime:{type:"datetime"},buttons:{type:"json"}},indices:[{field:"id",pk:!0}],history:[{version:new Date("2018-08-04"),fields:{id:{type:"string"},title:{type:"string"},message:{type:"string"},buttonText:{type:"string"},link:{type:"string"},sentTime:{type:"datetime"},deliveredTime:{type:"datetime"},readTime:{type:"datetime"}},indices:[{field:"id",pk:!0}]}]}};class d extends c.a{constructor(){super(...arguments),this.getConfig=()=>({collections:Object.assign({},u),operations:{createNotification:{collection:d.NOTIFS_COLL,operation:"createObject"},findUnreadNotifications:{collection:d.NOTIFS_COLL,operation:"findObjects",args:[{readTime:{$eq:null}},{reverse:!0}]},findReadNotifications:{collection:d.NOTIFS_COLL,operation:"findObjects",args:[{readTime:{$ne:null}},{reverse:!0,limit:"$limit:int",skip:"$skip:int"}]},findNotificationById:{collection:d.NOTIFS_COLL,operation:"findObject",args:{id:"$id:pk"}},countNotifications:{collection:d.NOTIFS_COLL,operation:"countObjects",args:{readTime:{$exists:"$isRead:boolean"}}},readNotification:{collection:d.NOTIFS_COLL,operation:"updateObject",args:[{id:"$id:pk"},{$set:{readTime:"$readTime:number"}}]}}})}storeNotification(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!(yield this.operation("findNotificationById",{id:e.id})))return e.readTime=null!==(t=e.readTime)&&void 0!==t?t:null,this.operation("createNotification",e)}))}fetchUnreadNotifications(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findUnreadNotifications",{})}))}fetchReadNotifications({limit:e=10,skip:t=0}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.operation("findReadNotifications",{limit:e,skip:t});return{notifications:n,resultExhausted:n.length<e}}))}fetchUnreadCount(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("countNotifications",{isRead:!1})}))}readNotification(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("readNotification",{id:e,readTime:Date.now()})}))}fetchNotifById(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findNotificationById",{id:e})}))}}d.NOTIFS_COLL=l;var h=n(876),f=n(726),p=n(3),g=n.n(p);class m{constructor(e){this.dependencies=Object.assign({eventNotifs:h.a,updateNotifs:h.b,releaseTime:h.c,createNotif:f.a},e),this.storage=new d({storageManager:e.storageManager}),this.remoteFunctions={storeNotification:(...e)=>this.storeNotification(...e),fetchUnreadCount:()=>this.fetchUnreadCount(),fetchUnreadNotifications:()=>this.fetchUnreadNotifications(),fetchReadNotifications:e=>this.fetchReadNotifications(e),readNotification:e=>this.readNotification(e),fetchNotifById:e=>this.fetchNotifById(e),dispatchNotification:e=>this.dispatchNotification(e),createNotification:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield Object(f.a)(e)}))}}setupRemoteFunctions(){Object(a.d)(this.remoteFunctions)}storeNotification(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.storage.storeNotification(e)}))}fetchUnreadCount(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.fetchUnreadCount()}))}fetchUnreadNotifications(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.fetchUnreadNotifications()}))}fetchReadNotifications(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.fetchReadNotifications(e)}))}readNotification(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.storage.readNotification(e)}))}fetchNotifById(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.fetchNotifById(e)}))}dispatchNotification(e,t){var n,i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=this.dependencies.eventNotifs[e];if(r.overview){const e=Object.assign(Object.assign({},r.overview),{id:r.id,deliveredTime:Date.now(),sentTime:this.dependencies.releaseTime});(null==t?void 0:t.dontStore)||(yield this.storeNotification(e))}if(r.system){const e=null===(i=null===(n=(r.system.buttons||[])[0])||void 0===n?void 0:n.action)||void 0===i?void 0:i.url;yield Object(f.a)({title:r.system.title,message:r.system.message,requireInteraction:!1},(()=>{if(e)return g.a.tabs.create({url:e})}))}}))}deliverStaticNotifications(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=(yield g.a.storage.local.get(m.LAST_NOTIF_TIME))[m.LAST_NOTIF_TIME];for(let t of this.dependencies.updateNotifs){if(t.system&&(!e||e<t.sentTime)){const e=t.system.buttons[0].action.url;yield Object(f.a)({title:t.system.title,message:t.system.message},(()=>g.a.tabs.create({url:e})))}t.overview&&(t=Object.assign(Object.assign({},t.overview),{id:t.id,deliveredTime:Date.now(),sentTime:this.dependencies.releaseTime}),(!e||e<t.sentTime)&&(yield this.storeNotification(t)))}g.a.storage.local.set({[m.LAST_NOTIF_TIME]:Date.now()})}))}}m.LAST_NOTIF_TIME="last-notif-proc-timestamp";var y=n(34);const v="socialTags",b="socialPosts",_="socialUsers",w="socialBookmarks",T="socialPostListEntries",E={[b]:{version:new Date("2019-04-22"),fields:{text:{type:"text"},serviceId:{type:"string"},createdAt:{type:"datetime"},createdWhen:{type:"datetime"}},relationships:[{childOf:_,alias:"userId",fieldName:"userId"}],indices:[{field:"text"},{field:"serviceId"},{field:"createdAt"},{field:{relationship:"userId"}}]},[_]:{version:new Date("2019-04-22"),fields:{serviceId:{type:"string"},name:{type:"string"},username:{type:"string"},isVerified:{type:"boolean"},profilePic:{type:"blob"},type:{type:"string"}},indices:[{field:"serviceId"},{field:"name"},{field:"username"}]},[v]:{version:new Date("2019-05-17"),fields:{name:{type:"string"}},relationships:[{childOf:b,alias:"postId",fieldName:"postId"}],indices:[{field:"name"},{field:{relationship:"postId"}}]},[w]:{version:new Date("2019-05-15"),fields:{createdAt:{type:"datetime"}},relationships:[{singleChildOf:b,alias:"postId",fieldName:"postId"}],indices:[{field:"createdAt"},{field:{relationship:"postId"}}]},[T]:{version:new Date("2019-05-17"),fields:{createdAt:{type:"datetime"}},relationships:[{childOf:y.b.list,alias:"listId",fieldName:"listId"},{childOf:b,alias:"postId",fieldName:"postId"}],indices:[{field:{relationship:"listId"}},{field:{relationship:"postId"}}]}};var A=n(353);const S="socialPosts",O="socialUsers",I=/^twitter\.com\/(.+)\/status\/(.+)$/;function C({postId:e}){return{url:`${S}:${e}`}}class k extends c.a{constructor({storageManager:e,tweetsColl:t=k.TWEETS_COLL,usersColl:n=k.USERS_COLL,tagsColl:r=k.TAGS_COLL,bookmarksColl:i=k.BMS_COLL,listEntriesColl:o=k.LIST_ENTRIES_COLL}){super({storageManager:e}),this.getConfig=()=>({collections:Object.assign({},E),operations:{createSocialPost:{collection:this.postsColl,operation:"createObject"},createSocialUser:{collection:this.usersColl,operation:"createObject"},createListEntry:{collection:this.listEntriesColl,operation:"createObject"},createHashTag:{collection:this.tagsColl,operation:"createObject"},createSocialBookmark:{collection:this.bookmarksColl,operation:"createObject"},deleteListEntry:{collection:this.listEntriesColl,operation:"deleteObjects",args:{listId:"$listId:number",postId:"$postId:number"}},deleteSocialBookmark:{collection:this.bookmarksColl,operation:"deleteObjects",args:{postId:"$postId:number"}},deleteSocialUser:{collection:this.usersColl,operation:"deleteObject",args:{id:"$id:number"}},deleteListEntriesForPost:{collection:this.listEntriesColl,operation:"deleteObjects",args:{postId:"$postId:number"}},deleteHashTagsForPost:{collection:this.tagsColl,operation:"deleteObjects",args:{postId:"$postId:number"}},deleteSocialPost:{collection:this.postsColl,operation:"deleteObject",args:{id:"$postId:number"}},findSocialPost:{collection:this.postsColl,operation:"findObject",args:{id:"$id:number"}},findSocialUsers:{collection:this.usersColl,operation:"findObjects",args:{id:{$in:"$userIds:number[]"}}},findSocialUsersExc:{collection:this.usersColl,operation:"findObjects",args:[{id:{$nin:"$userIds:number[]"}},"$opts:any"]},findPostByServiceId:{collection:this.postsColl,operation:"findObject",args:{serviceId:"$serviceId:string"}},findUserByServiceId:{collection:this.usersColl,operation:"findObject",args:{serviceId:"$serviceId:string"}},findListEntriesForPost:{collection:this.listEntriesColl,operation:"findObjects",args:{postId:"$postId:number"}},findHashTagsExc:{collection:this.tagsColl,operation:"findObjects",args:[{name:{$nin:"$excludedIds:number[]"}},"$opts:any"]},updateSocialPost:{collection:this.postsColl,operation:"updateObject",args:[{id:"$id:pk"},{$set:{createdAt:"$createdAt:date"}}]},countSocialPostsForUser:{collection:this.postsColl,operation:"countObjects",args:{userId:"$userId:number"}},suggestUsers:{operation:A.c.SUGGEST_OBJS_OP_ID,args:{collection:this.usersColl,query:{name:"$name:string"},options:{includePks:!0,ignoreCase:["name"]}}},suggestHashTags:{operation:A.c.SUGGEST_OBJS_OP_ID,args:{collection:this.tagsColl,query:{name:"$name:string"},options:{ignoreCase:["name"]}}}}}),this.encodeImage=(e,t)=>new Promise(((n,r)=>{if(!t)return n(URL.createObjectURL(e));const i=new FileReader;i.onerror=r,i.onload=()=>n(i.result),i.readAsDataURL(e)})),this.storageManager=e,this.postsColl=t,this.usersColl=n,this.tagsColl=r,this.bookmarksColl=i,this.listEntriesColl=o}addListEntry(e){var{createdAt:t=new Date}=e,n=Object(r.__rest)(e,["createdAt"]);return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{object:e}=yield this.operation("createListEntry",Object.assign({createdAt:t},n));return e.id}))}delListEntry({listId:e,postId:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("deleteListEntry",{listId:e,postId:t})}))}changeListsBeforeSending(e,t){return e.map((e=>{const n=t.find((({listId:t})=>t===e.id));return delete e._name_terms,Object.assign(Object.assign({},e),{pages:[],active:Boolean(n)})}))}fetchAllLists({query:e={},opts:t={}}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.storageManager.collection("customLists").findObjects(e,t);return this.changeListsBeforeSending(n,[])}))}fetchListPagesByPostId({postId:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findListEntriesForPost",{postId:e}),n=t.map((({listId:e})=>e)),r=yield this.fetchAllLists({query:{id:{$in:n}}});return this.changeListsBeforeSending(r,t)}))}addSocialPost(e){var{hashtags:t,createdAt:n=new Date,createdWhen:i,serviceId:o}=e,s=Object(r.__rest)(e,["hashtags","createdAt","createdWhen","serviceId"]);return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.getPostIdForServiceId({serviceId:o});if(e)return this.operation("updateSocialPost",{id:e,createdAt:n});const{object:r}=yield this.operation("createSocialPost",Object.assign({createdAt:n,createdWhen:new Date(i),serviceId:o},s)),a=r.id;return yield this.addSocialTags({hashtags:t,postId:a}),a}))}addSocialUser({serviceId:e,name:t,username:n,isVerified:i,profilePic:o,type:s}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{object:r}=yield this.operation("createSocialUser",{name:t,username:n,isVerified:i,profilePic:o,type:s,serviceId:e});return r.id}))}addSocialTags({hashtags:e,postId:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield Promise.all(e.map((e=>this.operation("createHashTag",{name:e,postId:t}))))}))}addSocialBookmark({postId:e,time:t=new Date}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{object:n}=yield this.operation("createSocialBookmark",{postId:e,createdAt:t});return n.id}))}addTagForPost({name:e,url:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storageManager.collection("tags").createObject({name:e,url:t})}))}delTagForPost({name:e,url:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storageManager.collection("tags").deleteObjects({name:e,url:t})}))}fetchSocialPostTags({url:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.storageManager.collection("tags").findObjects({url:e})).map((({name:e})=>e))}))}delSocialBookmark({postId:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("deleteSocialBookmark",{postId:e})}))}maybeDeletePostAuthor({postId:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{userId:t}=yield this.operation("findSocialPost",{id:e});if(!((yield this.operation("countSocialPostsForUser",{userId:t}))>1))return this.operation("deleteSocialUser",{id:t})}))}deletePostAnnots({postUrlId:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=(yield this.storageManager.collection("annotations").findObjects({pageUrl:e})).map((e=>e.url));return Promise.all([this.storageManager.collection("annotBookmarks").deleteObjects({url:{$in:t}}),this.storageManager.collection("annotListEntries").deleteObjects({url:{$in:t}}),this.storageManager.collection("annotations").deleteObjects({pageUrl:e})])}))}delSocialPages({postIds:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){for(const t of e){const e=C({postId:t}).url;yield this.maybeDeletePostAuthor({postId:t}),yield Promise.all([this.operation("deleteSocialPost",{postId:t}),this.operation("deleteHashTagsForPost",{postId:t}),this.operation("deleteListEntriesForPost",{postId:t}),this.delSocialBookmark({postId:t}),this.deletePostAnnots({postUrlId:e}),this.storageManager.collection("tags").deleteObjects({url:e})])}}))}getSocialPost({id:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findSocialPost",{id:e})}))}getUserIdForServiceId({serviceId:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findUserByServiceId",{serviceId:e});return null==t?null:t.id}))}getPostIdForServiceId({serviceId:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findPostByServiceId",{serviceId:e});return null==t?null:t.id}))}attachImage(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return Promise.all(e.map((e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=e.profilePic?yield this.encodeImage(e.profilePic,t):void 0;return Object.assign(Object.assign({},e),{profilePic:n})})))))}))}fetchUserSuggestions({name:e,base64Img:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=(yield this.operation("suggestUsers",{name:e})).map((({pk:e})=>e)),r=yield this.operation("findSocialUsers",{userIds:n});return this.attachImage(r,t)}))}fetchAllUsers(e){var{excludeIds:t}=e,n=Object(r.__rest)(e,["excludeIds"]);return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.operation("findSocialUsersExc",{userIds:t,opts:n});return this.attachImage(e,n.base64Img)}))}fetchAllHashtags(e){var{excludeIds:t}=e,n=Object(r.__rest)(e,["excludeIds"]);return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.operation("findHashTagsExc",{excludedIds:t,opts:n})).map((({name:e})=>e))}))}fetchHashtagSuggestions({name:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.operation("suggestHashTags",{name:e})).map((({suggestion:e})=>e))}))}}k.TWEETS_COLL=b,k.USERS_COLL=_,k.TAGS_COLL=v,k.BMS_COLL=w,k.LIST_ENTRIES_COLL=T;var P=n(511);var x=function(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(null===e)return;const t=yield fetch(e);if(t.status>=400&&t.status<600)return void console.error(t.statusText);const n=yield t.blob();return Object(P.a)(n)}))};const R=n(1316);class L{constructor({storageManager:e}){this.getPostIdFromUrl=e=>{const{serviceId:t}=function({url:e}){const t=e.match(I);return null==t||3!==t.length?{username:null,serviceId:null}:{username:t[1],serviceId:t[2]}}({url:e});return this.storage.getPostIdForServiceId({serviceId:t})},this.storage=new k({storageManager:e})}setupRemoteFunctions(){Object(a.d)({addTweet:this.addTweet.bind(this),addPostToList:this.addPostToList.bind(this),delPostFromList:this.delPostFromList.bind(this),fetchSocialPostLists:this.fetchSocialPostLists.bind(this),delSocialPages:this.delSocialPages.bind(this),addSocialBookmark:this.addSocialBookmark.bind(this),delSocialBookmark:this.delSocialBookmark.bind(this),addTagForTweet:this.addTagForTweet.bind(this),delTagForTweet:this.delTagForTweet.bind(this),fetchSocialPostTags:this.fetchSocialPostTags.bind(this),fetchUserSuggestions:this.fetchUserSuggestions.bind(this),fetchAllUsers:this.fetchAllUsers.bind(this),fetchAllHashtags:this.fetchAllHashtags.bind(this),fetchHashtagSuggestions:this.fetchHashtagSuggestions.bind(this)})}addTweet(e){var{user:t}=e,n=Object(r.__rest)(e,["user"]);return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.addUser(t);return this.storage.addSocialPost(Object.assign(Object.assign({},n),{userId:e}))}))}addPostToList({id:e,url:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getPostIdFromUrl(t);return this.storage.addListEntry({listId:e,postId:n})}))}delPostFromList({id:e,url:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getPostIdFromUrl(t);return this.storage.delListEntry({listId:e,postId:n})}))}fetchSocialPostLists({url:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getPostIdFromUrl(e);return t?this.storage.fetchListPagesByPostId({postId:t}):[]}))}delSocialPages(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield Promise.all(e.map(this.getPostIdFromUrl));return this.storage.delSocialPages({postIds:t})}))}addTagForTweet({url:e,tag:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getPostIdFromUrl(e);return this.storage.addTagForPost({name:t,url:C({postId:n}).url})}))}delTagForTweet({url:e,tag:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getPostIdFromUrl(e);return this.storage.delTagForPost({name:t,url:C({postId:n}).url})}))}fetchSocialPostTags({url:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=C({postId:yield this.getPostIdFromUrl(e)}).url;return this.storage.fetchSocialPostTags({url:t})}))}addSocialBookmark({url:e,time:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getPostIdFromUrl(e);return this.storage.addSocialBookmark({postId:n,time:t})}))}delSocialBookmark({url:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getPostIdFromUrl(e);return this.storage.delSocialBookmark({postId:t})}))}addUser(e){var{profilePicUrl:t,serviceId:n}=e,i=Object(r.__rest)(e,["profilePicUrl","serviceId"]);return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.storage.getUserIdForServiceId({serviceId:n});if(e)return e;const r=yield x(t),o=r?R(r):void 0;return this.storage.addSocialUser(Object.assign(Object.assign({},i),{profilePic:o,serviceId:n}))}))}fetchUserSuggestions({name:e,base64Img:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.fetchUserSuggestions({name:e,base64Img:t})}))}fetchAllUsers({excludeIds:e=[],skip:t=0,limit:n=20,base64Img:i=!1}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return e=yield Promise.all(e.map((e=>this.storage.getUserIdForServiceId({serviceId:e})))),this.storage.fetchAllUsers({excludeIds:e,skip:t,limit:n,base64Img:i})}))}fetchAllHashtags({excludeIds:e=[],skip:t=0,limit:n=20}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.fetchAllHashtags({excludeIds:e,limit:n,skip:t})}))}fetchHashtagSuggestions({name:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.fetchHashtagSuggestions({name:e})}))}}var D=n(19),N=n(596),j=n(75),M=n(130),F=n(65);class U{constructor(e){this.options=e,this.listAnnotationsByPageUrl=({tab:e},t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var{pageUrl:e}=t,n=Object(r.__rest)(t,["pageUrl"]);return(yield this.annotationStorage.listAnnotationsByPageUrl(Object.assign({pageUrl:e},n))).map((e=>{var t,n,r;return Object.assign(Object.assign({},e),{createdWhen:null===(t=e.createdWhen)||void 0===t?void 0:t.getTime(),lastEdited:null===(r=null!==(n=e.lastEdited)&&void 0!==n?n:e.createdWhen)||void 0===r?void 0:r.getTime()})}))})),this.listAnnotationIdsByColor=(e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.annotationStorage.listAnnotationIdsByColor(t.color)})),this.getAllAnnotationsByUrl=({tab:e},t,n)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var{url:i,limit:o=1e3,skip:s=0}=t,a=Object(r.__rest)(t,["url","limit","skip"]);console.warn("DEPRECIATED this.annotationStorage.getAllAnnotationsByUrl...",Object.assign({url:i,limit:o,skip:s},a)),i=null==i&&null!=e?Object(M.a)(e.url):i,i=n?yield this.lookupSocialId(i):this._normalizeUrl(i);const c=yield this.annotationStorage.getAllAnnotationsByUrl(Object.assign({url:i,limit:o,skip:s},a));return yield Promise.all(c.map((e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var{createdWhen:t,lastEdited:n}=e,i=Object(r.__rest)(e,["createdWhen","lastEdited"]);try{const e=yield this.annotationStorage.getTagsByAnnotationUrl(i.url);return Object.assign(Object.assign({},i),{hasBookmark:yield this.annotationStorage.annotHasBookmark({url:i.url}),createdWhen:t.getTime(),tags:e.map((e=>e.name)),lastEdited:n&&n instanceof Date?n.getTime():void 0})}catch(e){throw console.error("Error getting extra annotation data",e),e}})))))})),this.getSharedAnnotations=(e,{sharedAnnotationReferences:t,withCreatorData:n})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const{users:e,contentSharing:r}=this.options.serverStorage,i=yield r.getAnnotations({references:t,skipUserHighlightColors:!0});let o;if(n){const t=new Set(Object.values(i).map((e=>e.creator.id)));o=yield e.getUsersPublicDetails([...t].map((e=>({type:"user-reference",id:e})))).catch((e=>null))}return t.map((e=>Object.assign(Object.assign({},i[e.id]),{color:i[e.id].color,creatorReference:i[e.id].creator,creator:null==o?void 0:o[i[e.id].creator.id],selector:null!=i[e.id].selector?JSON.parse(i[e.id].selector):void 0})))})),this.getListIdsForAnnotation=(e,{annotationId:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.annotationStorage.findListEntriesByUrl({url:t}),n=new Set;return e.forEach((e=>n.add(e.listId))),[...n]})),this.socialBg=e.socialBg,this.annotationStorage=new N.a({storageManager:e.storageManager,pkmSyncBG:e.pkmSyncBG,___storageAPI:e.browserAPIs.storage}),this._normalizeUrl=e.normalizeUrl||D.c,this.remoteFunctions={getAllAnnotationsByUrl:this.getAllAnnotationsByUrl.bind(this),listAnnotationsByPageUrl:this.listAnnotationsByPageUrl.bind(this),listAnnotationIdsByColor:this.listAnnotationIdsByColor,createAnnotation:this.createAnnotation.bind(this),editAnnotation:this.editAnnotation.bind(this),editAnnotationTags:this.editAnnotationTags.bind(this),updateAnnotationTags:this.updateAnnotationTags.bind(this),deleteAnnotation:this.deleteAnnotation.bind(this),getAnnotationTags:this.getTagsByAnnotationUrl.bind(this),addAnnotationTag:this.addTagForAnnotation.bind(this),delAnnotationTag:this.delTagForAnnotation.bind(this),updateAnnotationBookmark:this.updateAnnotationBookmark.bind(this),toggleSidebarOverlay:this.toggleSidebarOverlay.bind(this),toggleAnnotBookmark:this.toggleAnnotBookmark.bind(this),getAnnotBookmark:this.getAnnotBookmark.bind(this),getSharedAnnotations:this.getSharedAnnotations,getListIdsForAnnotation:this.getListIdsForAnnotation,getAnnotationByPk:this.getAnnotationByPk.bind(this)}}setupRemoteFunctions(){Object(a.d)(this.remoteFunctions,{insertExtraArg:!0})}_triggerSidebar(e,...t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const[n]=yield this.options.browserAPIs.tabs.query({active:!0,currentWindow:!0});yield Object(a.h)(e,{tabId:n.id})(...t)}))}toggleSidebarOverlay({tab:e},{anchor:t,override:n,openSidebar:i,openToTags:o,openToComment:s,openToBookmark:c,openToCollections:l,unifiedAnnotationId:u}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const[e]=yield this.options.browserAPIs.tabs.query({active:!0,currentWindow:!0}),{id:t}=e;if(i)yield Object(a.l)(t).showSidebar({action:"show_annotation",annotationLocalId:u});else{const e={tag:o,comment:s,bookmark:c,list:l,bookmarksNudge:!1},n=Object.entries(e).findIndex((e=>e[1]))[0];yield Object(a.l)(t).showRibbon({action:n})}}))}removeChildAnnotationsFromList(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.annotationStorage.listAnnotationsByPageUrl({pageUrl:e});yield Promise.all(n.map((({url:e})=>this.annotationStorage.removeAnnotFromList({listId:t,url:e}))))}))}createAnnotation({tab:e},t,{skipPageIndexing:n}={}){var i,o,s,a;return Object(r.__awaiter)(this,void 0,void 0,(function*(){let r=null!==(i=t.pageUrl)&&void 0!==i?i:Object(M.a)(null==e?void 0:e.url);if(!Object(D.b)(r)&&(r=Object(M.a)(null==e?void 0:e.url),!Object(D.b)(r)))throw new Error("Could not get full URL while creating annotation");let c=this._normalizeUrl(r);t.isSocialPost&&(c=yield this.lookupSocialId(c));const l=yield this.options.browserAPIs.tabs.query({active:!0,currentWindow:!0}),u=null===(o=l[0])||void 0===o?void 0:o.title,d=null==t.title?u:t.title;n||(yield this.options.pages.indexPage({fullUrl:r,visitTime:"$now",tabId:null==e?void 0:e.id,metaData:{pageTitle:null!=d?d:null}},{addInboxEntryOnCreate:!0}));const h=null!==(s=t.url)&&void 0!==s?s:Object(j.b)({pageUrl:c,now:()=>Date.now()});if(Object(D.b)(h))throw new Error("Annotation ID should not be a full URL");const f=yield this.options.authBG.authService.getCurrentUser(),p=null==f?void 0:f.id;yield this.annotationStorage.createAnnotation({pageUrl:c,url:h.toString(),pageTitle:d,comment:t.comment,body:t.body,selector:t.selector,color:t.color,createdWhen:new Date(null!==(a=t.createdWhen)&&void 0!==a?a:Date.now()),userId:p});try{t.comment&&!t.body&&(yield Object(F.a)(this.options.analyticsBG,{annotationType:"note"}))}catch(e){console.error("Error tracking annotation create event",e)}return h.toString()}))}getAnnotationByPk(e,{url:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.annotationStorage.getAnnotationByPk({url:t})}))}toggleAnnotBookmark(e,{url:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.annotationStorage.toggleAnnotBookmark({url:t})}))}getAnnotBookmark(e,{url:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.annotationStorage.annotHasBookmark({url:t})}))}updateAnnotationBookmark(e,{url:t,isBookmarked:n}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.annotationStorage.updateAnnotationBookmark({url:t,isBookmarked:n})}))}editAnnotation(e,t,n,i,o){var s;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.getAnnotationByPk(t,{url:t});if(!(null===(s=null==e?void 0:e.comment)||void 0===s?void 0:s.length)&&this.options.analyticsBG)try{Object(F.a)(this.options.analyticsBG,{annotationType:"annotation"})}catch(e){console.error(`Error tracking space create event', ${e}`)}return this.annotationStorage.editAnnotation(t,null!=n?n:e.comment,null!=i?i:e.color,null!=o?o:e.body)}))}deleteAnnotation(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){n&&(t=yield this.lookupSocialId(t));const r=yield this.getAnnotBookmark(e,{url:t}),i=yield this.annotationStorage.findListEntriesByUrl({url:t}),o=yield this.getTagsByAnnotationUrl(e,t);r&&(yield this.annotationStorage.deleteBookmarkByUrl({url:t})),(null==i?void 0:i.length)&&(yield this.annotationStorage.deleteListEntriesByUrl({url:t})),(null==o?void 0:o.length)&&(yield this.annotationStorage.deleteTagsByUrl({url:t})),yield this.options.preAnnotationDelete({annotationUrl:t}),yield this.annotationStorage.deleteAnnotation(t)}))}getTagsByAnnotationUrl(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.annotationStorage.getTagsByAnnotationUrl(t)}))}addTagForAnnotation(e,{tag:t,url:n}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.annotationStorage.modifyTags(!0)(t,n)}))}delTagForAnnotation(e,{tag:t,url:n}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.annotationStorage.modifyTags(!1)(t,n)}))}editAnnotationTags({tab:e},{tagsToBeAdded:t,tagsToBeDeleted:n,url:i}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.annotationStorage.editAnnotationTags(t,n,i)}))}updateAnnotationTags(e,{tags:t,url:n}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.annotationStorage.getTagsByAnnotationUrl(n),i=new Set(r.map((e=>e.name))),o=new Set(t),s=[],a=[];for(const e of o)i.has(e)||a.push(e);for(const e of i)o.has(e)||s.push(e);return this.editAnnotationTags(e,{url:n,tagsToBeAdded:a,tagsToBeDeleted:s})}))}lookupSocialId(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return C({postId:yield this.socialBg.getPostIdFromUrl(e)}).url}))}}var B=n(217),G=n.n(B),q=n(56),H=n.n(q),$=n(699),W=n.n($),z=n(728);class V extends c.a{constructor(){super(...arguments),this.getConfig=()=>({operations:{[z.a.SUGGEST_OP_ID]:{operation:z.a.SUGGEST_OP_ID,args:{query:"$query:string",type:"$type:string",limit:"$limit:number"}},[z.a.SUGGEST_EXT_OP_ID]:{operation:z.a.SUGGEST_EXT_OP_ID,args:{notInclude:"$notInclude:string[]",type:"$type:string",limit:"$limit:number"}}}}),this.suggest=e=>this.operation(z.a.SUGGEST_OP_ID,e),this.suggestExtended=e=>this.operation(z.a.SUGGEST_EXT_OP_ID,e)}}var K=n(361),Y=n(721);class Q extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}class X extends Q{}var J=n(104),Z=n(71);const ee=e=>e.length?e.reduce(((e,t)=>{const n=new Set(t);return e.filter((e=>n.has(e)))})):[],te=(e,t,n)=>n.matchTermsFuzzyStartsWith?e.startsWith(t):e.equals(t),ne=(e,t)=>(n,i=[])=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){if(!t.matchHighlights&&!t.matchNotes)return[];const r=e.backend.dexieInstance.table("annotations"),o=yield Promise.all([...n.map((e=>{if(t.matchHighlights&&!t.matchNotes)return te(r.where("_body_terms"),e,t).primaryKeys();if(!t.matchHighlights&&t.matchNotes)return te(r.where("_comment_terms"),e,t).primaryKeys();const n=te(r.where("_body_terms"),e,t);return te(n.or("_comment_terms"),e,t).primaryKeys()})),...i.map((e=>r.filter((t=>{var n,r;const i=null===(n=t.comment)||void 0===n?void 0:n.toLocaleLowerCase().includes(e),o="body"in t&&(null===(r=t.body)||void 0===r?void 0:r.toLocaleLowerCase().includes(e));return i||o})).primaryKeys()))]),s=ee(o);return r.bulkGet(s)}));var re=n(11),ie=n(51),oe=n(702),se=n(700),ae=n(566);const ce=e=>t=>new Set([...t].filter((t=>e.has(t)))),le=e=>[...e].reduce(((e,[t,n])=>(e[t]=n,e)),{});var ue=n(163),de=n(701),he=n(703);class fe{constructor(e){this.options=e,this.unifiedSearch=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.unifiedIntermediarySearch(e),n=yield this.lookupDataForUnifiedResults(t.resultDataByPage);return{docs:Object(K.d)(t.resultDataByPage).map((([e,{annotations:t}])=>{const r=n.pages.get(e);if(!r)throw new Error("Search error: Missing page data for search result");return Object.assign(Object.assign({},r),{annotations:t.map((e=>n.annotations.get(e.url))).filter(Boolean)})})).filter(Boolean),resultsExhausted:t.resultsExhausted,oldestResultTimestamp:t.oldestResultTimestamp}})),this.storage=new V({storageManager:e.storageManager}),this.remoteFunctions={suggest:this.storage.suggest,unifiedSearch:this.unifiedSearch,extendedSuggest:this.storage.suggestExtended,delPages:this.options.pages.delPages.bind(this.options.pages),resolvePdfPageFullUrls:this.resolvePdfPageFullUrls.bind(this)}}static handleSearchError(e){return e instanceof X?{docs:[],resultsExhausted:!0,totalCount:null,isBadTerm:!0}:{docs:[],resultsExhausted:!0,totalCount:null,isInvalidSearch:!0}}static shapePageResult(e,t,n={}){return Object.assign({resultsExhausted:e.length<t,totalCount:null,docs:e},n)}setupRemoteFunctions(){Object(a.d)(this.remoteFunctions)}calcSearchTimeBoundEdge(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t="bottom"===e?Date.now():0,n=this.options.storageManager.backend.dexie,r=n.table("visits").orderBy("time"),i=n.table("bookmarks").orderBy("time"),o=n.table("annotations").orderBy("lastEdited"),s=(yield Promise.all("bottom"===e?[r.first(),i.first(),o.first()]:[r.last(),i.last(),o.last()])).filter(Boolean).map((e=>"time"in e?e.time:e.lastEdited.valueOf())),a="bottom"===e?Math.min(...s):Math.max(...s);return Math.abs(a)!==1/0?a:t}))}calcBlankSearchTimeBoundEdges(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t=[],n=[];if(!Object(K.b)(e)&&!e.filterByListIds.length)return[yield this.calcSearchTimeBoundEdge("bottom"),yield this.calcSearchTimeBoundEdge("top")];const r=this.options.storageManager.backend.dexie;if(e.filterByListIds){let[i,o]=yield Promise.all([r.table("pageListEntries").where("listId").anyOf(e.filterByListIds).toArray(),r.table("annotListEntries").where("listId").anyOf(e.filterByListIds).toArray()]),s=new Set,a=new Set,c=G()(i,(e=>e.pageUrl)),l=G()(o,(e=>e.url));for(const[t,n]of Object.entries(c))n.length===e.filterByListIds.length&&s.add(t);for(const[t,n]of Object.entries(l))n.length===e.filterByListIds.length&&a.add(t);i=i.filter((e=>s.has(e.pageUrl))),o=o.filter((e=>a.has(e.url)));const u=i.map((e=>e.createdAt.valueOf())).concat(o.map((e=>e.createdAt.valueOf()))).sort(((e,t)=>e-t));1===u.length?t.push(u[0]):u.length>1&&(n.push(u[0]),t.push(u[u.length-1]))}if(e.omitPagesWithoutAnnotations){const e=r.table("annotations"),i=yield e.orderBy("lastEdited").last(),o=yield e.orderBy("lastEdited").first();i&&t.push(i.lastEdited.valueOf()),o&&n.push(o.lastEdited.valueOf())}let i=[];if(e.filterByDomains.length&&i.push(...e.filterByDomains),e.filterByPDFs&&i.push(ue.b),e.filterByEvents&&i.push(...de.a),e.filterByVideos&&i.push(...ie.a.concat(ie.b)),e.filterByTweets&&i.push(...he.b),i.length){const e=e=>e.where("url").startsWithAnyOf(i).toArray(),[o,s,a]=yield Promise.all([e(r.table("visits")),e(r.table("bookmarks")),e(r.table("annotations"))]),c=o.map((e=>e.time)).concat(s.map((e=>e.time))).concat(a.map((e=>e.lastEdited.valueOf()))).sort(((e,t)=>e-t));1===c.length?t.push(c[0]):c.length>1&&(n.push(c[0]),t.push(c[c.length-1]))}let o=Math.max(...n),s=Math.min(...t);return o=Math.abs(o)===1/0?0:o,s=Math.abs(s)===1/0?Date.now():s,[o,s]}))}filterUnifiedSearchResultsByFilters(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=Object(K.b)(t);if(!n&&!e.size&&!t.filterByListIds.length)return;const r=new Set;if(n&&e.forEach((({annotations:e},n)=>{(t.omitPagesWithoutAnnotations&&!e.length||t.filterByEvents&&!Object(se.a)(n)||t.filterByTweets&&!Object(oe.a)(n)||t.filterByVideos&&!Object(ie.d)(n)||t.filterByPDFs&&!Object(J.e)({url:n})||t.filterByDomains.length&&!t.filterByDomains.reduce(((e,t)=>{const r=new RegExp(`^(\\w+\\.)?${t}`);return e||r.test(n)}),!1))&&r.add(n)})),r.forEach((t=>e.delete(t))),!e.size||!t.filterByListIds.length)return;const i=[],o=new Map;e.forEach((({annotations:e},t)=>e.forEach((e=>{i.push(e.url),o.set(e.url,t)}))));const s=yield this.options.storageManager.collection("annotationPrivacyLevels").findObjects({annotation:{$in:i}}),a=H()(s.map((e=>[e.annotation,e.privacyLevel])));let[c,l]=W()(i,(e=>[re.a.PROTECTED,re.a.PRIVATE].includes(a[e])));const u=(e=[])=>{const n=e.map((e=>e.listId));return t.filterByListIds.reduce(((e,t)=>e&&n.includes(t)),!0)},d=yield this.options.storageManager.collection("annotListEntries").findObjects({listId:{$in:t.filterByListIds},url:{$in:c}}),h=G()(d,(e=>e.url));c=c.filter((e=>u(h[e])));const f=yield this.options.storageManager.collection("pageListEntries").findObjects({listId:{$in:t.filterByListIds},pageUrl:{$in:[...e.keys()]}}),p=G()(f,(e=>e.pageUrl));l=l.filter((e=>u(p[o.get(e)]))),e.forEach(((e,t)=>{e.annotations=e.annotations.filter((e=>c.includes(e.url)||l.includes(e.url))),e.annotations.length||u(p[t])||r.add(t)})),r.forEach((t=>e.delete(t)))}))}unifiedBlankListsSearch(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!e.filterByListIds.length)throw new Error("Lists search was called but no lists were filtered");const r=new Map,i=this.options.storageManager.backend.dexie,[o,s]=yield Promise.all([i.table("pageListEntries").where("listId").anyOf(e.filterByListIds).toArray(),i.table("annotListEntries").where("listId").anyOf(e.filterByListIds).toArray()]),a=H()(o.sort(((e,t)=>e.createdAt.valueOf()-t.createdAt.valueOf())).map((e=>[e.pageUrl,e.createdAt.valueOf()]))),c=e.filterByListIds.map((e=>new Set(o.filter((t=>t.listId===e)).map((e=>e.pageUrl))))).reduce(((e,t)=>ce(e)(t))),l=e.filterByListIds.map((e=>new Set(s.filter((t=>t.listId===e)).map((e=>e.url))))).reduce(((e,t)=>ce(e)(t)));let u=yield i.table("annotations").where("pageUrl").anyOf([...c]).toArray(),d=yield i.table("annotationPrivacyLevels").where("annotation").anyOf(u.map((e=>e.url))).toArray(),h=new Set(d.filter((e=>[re.a.SHARED,re.a.SHARED_PROTECTED].includes(e.privacyLevel)&&!l.has(e.annotation))).map((e=>e.annotation)));u=u.filter((e=>h.has(e.url)));const f=yield i.table("annotations").bulkGet([...l]);let p=!1;const g=G()([...u,...f].filter((e=>{let t=null!=e;return t&&(p=!0),t})),(e=>e.pageUrl));p&&this.options.captureException(new Error("OwnError: Encountered annotListEntry referencing non-existent annotation"));for(const[e,t]of Object.entries(g)){const n=t.sort(((e,t)=>t.lastEdited.valueOf()-e.lastEdited.valueOf()));r.set(e,{annotations:n,latestPageTimestamp:n[0].lastEdited.valueOf(),oldestTimestamp:0})}for(const e of c){const i=null!==(t=a[e])&&void 0!==t?t:0,o=null!==(n=r.get(e))&&void 0!==n?n:{annotations:[],latestPageTimestamp:i,oldestTimestamp:0};r.set(e,Object.assign(Object.assign({},o),{latestPageTimestamp:i}))}return{resultDataByPage:r,oldestResultTimestamp:0,resultsExhausted:!0}}))}unifiedBlankSearch(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=new Map,i=this.options.storageManager.backend.dexie;let[o,s,a]=yield Promise.all([i.table("annotations").where("lastEdited").below(new Date(e.untilWhen)).reverse().limit(e.limit).toArray(),i.table("visits").where("[time+url]").below([e.untilWhen]).reverse().limit(e.limit).toArray(),i.table("bookmarks").where("time").below(e.untilWhen).reverse().limit(e.limit).toArray()]);const c=[...o,...s,...a].filter((t=>("lastEdited"in t?t.lastEdited.valueOf():t.time)>=e.lowestTimeBound)).sort(((e,t)=>{const n="lastEdited"in e?e.lastEdited.valueOf():e.time;return("lastEdited"in t?t.lastEdited.valueOf():t.time)-n})).slice(0,e.limit),l=e=>c.includes(e);o=o.filter(l),a=a.filter(l),s=s.filter(l);const u=G()(o,(e=>e.pageUrl));for(const[e,t]of Object.entries(u)){const n=t.sort(((e,t)=>t.lastEdited.valueOf()-e.lastEdited.valueOf()));r.set(e,{annotations:n,latestPageTimestamp:n[0].lastEdited.valueOf(),oldestTimestamp:n[n.length-1].lastEdited.valueOf()})}const d=[...a,...s].sort(((e,t)=>e.time-t.time));for(const{url:e,time:i}of d){const o=null!==(n=null===(t=r.get(e))||void 0===t?void 0:t.annotations)&&void 0!==n?n:[];r.set(e,{annotations:o,latestPageTimestamp:i,oldestTimestamp:d[0].time})}let h;if(yield this.filterUnifiedSearchResultsByFilters(r,e),c.length){const e=c[c.length-1];h="lastEdited"in e?e.lastEdited.valueOf():e.time}else h=0;return{resultDataByPage:r,resultsExhausted:h<=e.lowestTimeBound,oldestResultTimestamp:h}}))}unifiedIntermediarySearch(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!e.query.trim().length){if(e.filterByListIds.length)return this.unifiedBlankListsSearch(e);{let r,[i,o]=yield this.calcBlankSearchTimeBoundEdges(e);i<e.fromWhen&&(i=e.fromWhen),o+=1;do{r=yield this.unifiedBlankSearch(Object.assign(Object.assign({},e),{lowestTimeBound:i,untilWhen:null!==(n=null!==(t=null==r?void 0:r.oldestResultTimestamp)&&void 0!==t?t:e.untilWhen)&&void 0!==n?n:o}))}while(!r.resultsExhausted&&!r.resultDataByPage.size);return r}}const{phrases:i,terms:o,inTitle:s,inContent:a,inHighlight:c,inComment:l,matchTermsFuzzyStartsWith:u}=Object(Y.a)(e.query);return e.matchPageTitleUrl=s,e.matchPageText=a,e.matchNotes=l,e.matchHighlights=c,e.phrases=i,e.terms=o,e.matchTermsFuzzyStartsWith=u,Object(Y.b)(Object.assign(Object.assign({},e),{storageManager:this.options.storageManager,queryPages:(d=this.options.storageManager,h=e,(e,t=[])=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){if(!h.matchPageText&&!h.matchPageTitleUrl)return[];const n=d.backend.dexieInstance,r=n.table("pages"),i=yield Promise.all([...e.map((e=>{if(h.matchPageText&&!h.matchPageTitleUrl)return te(r.where("terms"),e,h).primaryKeys();if(!h.matchPageText&&h.matchPageTitleUrl){const t=te(r.where("urlTerms"),e,h);return te(t.or("titleTerms"),e,h).primaryKeys()}let t=te(r.where("terms"),e,h);return t=te(t.or("urlTerms"),e,h),te(t.or("titleTerms"),e,h).primaryKeys()})),...t.map((e=>r.filter((t=>{var n;return null===(n=t.text)||void 0===n?void 0:n.toLocaleLowerCase().includes(e)})).primaryKeys()))]),o=ee(i),s=new Map,a=({url:e,time:t})=>{var n;return s.set(e,Math.max(t,null!==(n=s.get(e))&&void 0!==n?n:0))},c=e=>e.where("url").anyOf(o).reverse().sortBy("time"),[l,u]=yield Promise.all([c(n.table("visits")),c(n.table("bookmarks"))]);return l.forEach(a),u.forEach(a),o.map((e=>{var t;return{id:e,latestTimestamp:null!==(t=s.get(e))&&void 0!==t?t:0}}))}))),queryAnnotations:ne(this.options.storageManager,e)}));var d,h}))}lookupDataForUnifiedResults(e){var t,n,i,o,s,a;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const c=[...e.keys()],l=[...e.values()].flatMap((({annotations:e})=>e.map((e=>e.url)))),u=this.options.storageManager.backend.dexie,[d,h,f,p,g]=yield Promise.all([u.table("pages").bulkGet(c),u.table("annotations").bulkGet(l),u.table("annotationPrivacyLevels").where("annotation").anyOf(l).toArray(),u.table("pageListEntries").where("pageUrl").anyOf(c).filter((e=>e.listId!==y.c.INBOX)).primaryKeys(),u.table("annotListEntries").where("url").anyOf(l).filter((e=>e.listId!==y.c.INBOX)).primaryKeys()]),m=H()(yield Promise.all(d.map((e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return[e.url,yield u.table("annotations").where("pageUrl").equals(e.url).count()]})))))),v=[...new Set(d.map((e=>e.hostname)))],b=yield u.table("favIcons").bulkGet(v),_=yield Promise.all(b.filter((e=>null!=(null==e?void 0:e.favIcon))).map((e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return{hostname:e.hostname,favIconDataURL:yield Object(ae.a)(e.favIcon)}}))))),w=H()(_.map((e=>[e.hostname,e.favIconDataURL]))),T=G()(p,(([,e])=>e)),E=G()(g,(([,e])=>e)),A=H()(f.map((e=>[e.annotation,e.privacyLevel]))),S={annotations:new Map,pages:new Map};for(const r of d)S.pages.set(r.url,Object.assign(Object.assign({},r),{lists:(null!==(t=T[r.url])&&void 0!==t?t:[]).map((([e])=>e)),displayTime:null!==(i=null===(n=e.get(r.url))||void 0===n?void 0:n.latestPageTimestamp)&&void 0!==i?i:0,favIcon:w[r.hostname],totalAnnotationsCount:null!==(o=m[r.url])&&void 0!==o?o:0}));for(const e of h)S.annotations.set(e.url,Object.assign(Object.assign({},e),{privacyLevel:null!==(s=A[e.url])&&void 0!==s?s:re.a.PROTECTED,lists:(null!==(a=E[e.url])&&void 0!==a?a:[]).map((([e])=>e))}));return S}))}resolvePdfPageFullUrls(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n={url:e},r=yield this.options.pages.findLocatorsByNormalizedUrl(Object(D.c)(n.url)),i=Object(J.h)(r,{priority:Z.b.Remote});let o=i;return i&&i.locationScheme===Z.f.UploadStorage?o.originalLocation=i.originalLocation+"?upload_id="+i.location:o.originalLocation=null!==(t=null==i?void 0:i.originalLocation)&&void 0!==t?t:void 0,o}))}}const pe="eventLog",ge={[pe]:{version:new Date("2018-07-14"),fields:{time:{type:"datetime"},type:{type:"string"},details:{type:"json"}},indices:[{field:["time","type"],pk:!0},{field:"time"},{field:"type"}],watch:!1,backup:!1}},me={SUCCESSFUL_SEARCH:"succesfulSearch",PAGINATE_SEARCH:"paginateSearch",UNSUCCESSFUL_SEARCH:"unsuccessfulSearch",DATEPICKER:"datepicker",DATEPICKER_DROPDOWN:"datepickerByDropdown",DATEPICKER_DROPDOWN_START:"datepickerByDropdownStartDate",DATEPICKER_CLEAR_START:"datepickerClearStartDate",DATEPICKER_DROPDOWN_END:"datepickerByDropdownEndDate",DATEPICKER_CLEAR_END:"datepickerClearEndDate",BOOKMARK_FILTER:"bookmarkFilter",TAG_FILTER:"tagFilter",DOMAIN_FILTER:"domainFilter",ADD_TAG:"addTag",DELETE_TAG:"deleteTag",DELETE_RESULT:"deleteResult",CREATE_RESULT_BOOKMARK:"createResultBookmark",REMOVE_RESULT_BOOKMARK:"removeResultBookmark",CREATE_BROWSER_BOOKMARK:"createBrowserBookmark",REMOVE_BROWSER_BOOKMARK:"removeBrowserBookmark",CREATE_POPUP_BOOKMARK:"createPopupBookmark",REMOVE_POPUP_BOOKMARK:"removePopupBookmark",ADD_POPUP_TAG:"addPopupTag",DELETE_POPUP_TAG:"deletePopupTag",BLACKLIST_SITE:"blacklistSite",BLACKLIST_DOMAIN:"blacklistDomain",REMOVE_BLACKLIST_ENTRY:"removeBlacklistEntry",CHANGE_TRACKING_PREF_OPTOUT:"changeTrackingPrefOptOut",CHANGE_TRACKING_PREF_OPTIN:"changeTrackingPrefOptIn",START_IMPORT:"startImport",PAUSE_IMPORT:"pauseImport",RESUME_IMPORT:"resumeImport",CANCEL_IMPORT:"cancelImport",FINISH_IMPORT:"finishImport",SEARCH_POPUP:"serachPopup",SUCCESSFUL_OMNIBAR_SEARCH:"successfulOmnibarSearch",UNSUCCESSFUL_OMNIBAR_SEARCH:"unsuccessfulOmnibarSearch",DATEPICKER_NLP_START_DATE:"datepickerByNlpStartDate",DATEPICKER_NLP_END_DATE:"datepickerByNlpEndDate",NLP_SEARCH:"nlpSearch",ONBOARDING_CANCEL_IMPORT:"onboardingCancelImport",ONBOARDING_FINISH_IMPORT:"onboardingFinishImport",ADD_BLACKLIST_ENTRY:"addBlacklistEntry",READ_NOTIFICATION_SEARCH_ENGINE:"redNotificationSearchEngine",READ_NOTIFICATION_OVERVIEW:"readNotificationOverview",READ_NOTIFICATION_PAGINATION:"readNotificationPagination",OPEN_INBOX_OVERVIEW:"openInboxOveview",CLICK_STORAGE_CHANGE_NOTIF_BUTTON:"clickStorageChangeNotifButton",CLICK_OPEN_NEW_LINK_BUTTON:"clickOpenNewLinkButton",CLOSE_INBOX_OVERVIEW:"closeInboxOverview",CLICK_ON_SYSTEM_NOTIFICATION:"clickOnSystemNotification",TOGGLE_STORAGE_SEARCH_ENGINE:"toggleStorageSearchEngine",CLICK_OPEN_NEW_LINK_BUTTON_SEARCH:"clickOpenNewLinkButtonSearch",RESUME_INDEXING:"resumeIndexing",PAUSE_INDEXING:"pauseIndexing",CLOSE_COMMENT_SIDEBAR:"closeCommentSidebar",OPEN_COMMENT_SIDEBAR:"openCommentSidebar",CREATE_ANNOTATION:"createAnnotation",REMOVE_RIBBON:"removeRibbon",OPEN_SIDEBAR_PAGE:"openSidebarPage",CLOSE_SIDEBAR_PAGE:"closeSidebarPage",CREATE_ANNOTATION_PAGE:"createAnnotationPage",DISABLE_SIDEBAR_PAGE:"disableSidebarPage",ENABLE_TOOLTIP_POPUP:"enableTooltipPopup",DISABLE_TOOLTIP_POPUP:"disableTooltipPopup",DELETE_ANNOTATION:"deleteAnnotation",CREATE_COLLECTION:"createCollection",INSERT_PAGE_COLLECTION:"insertPageToCollection",REMOVE_COLLECTION:"removeCollection",REMOVE_PAGE_COLLECTION:"removePageFromCollection",OPEN_URL_FEATURE:"openURLFeature",START_ONBOARDING:"startOnboarding",FINISH_ONBOARDING:"finishOnboarding",CLICK_REPLY_BUTTON:"clickReplyButton",CLICK_SHARE_BUTTON:"clickShareButton",LEARN_MORE_CROWD_FUNDING:"learnMoreCrowdFunding",BOOKMARK:"bookmark",BLACKLIST:"blacklist",ADDRESS_BAR_SEARCH:"addressBarSearch",DATEPICKER_NLP:"datepickerNlp",START_ANNOTATION_ONBOARDING:"startAnnotationOnboarding",ONBOARDING_HIGHLIGHT_MADE:"onboardingHighlightMade",FINISH_ANNOTATION_ONBOARDING:"finishAnnotationOnboarding",START_POWERSEARCH_ONBOARDING:"startPowerSearchOnboarding",POWERSEARCH_BROWSE_PAGE:"powerSearchBrowsePage",POWERSEARCH_GOTO_DASH:"powerSearchGotoDash",FINISH_POWERSEARCH_ONBOARDING:"finshPowerSearchOnboarding",START_TAGGING_ONBOARDING:"startTaggingOnboarding",FINISH_TAGGING_ONBOARDING:"finishTaggingOnboarding",FINISH_BACKUP_ONBOARDING:"finishBackupOnboarding",OVERVIEW_TOOLTIP:"overviewTooltip",SET_TOOLTIP:"setTooltip",CLOSE_TOOLTIP:"closeTooltip",CLICK_RESULT_LINK:"clickResultLink"},ye={[me.SUCCESSFUL_SEARCH]:{id:1,notifType:me.SUCCESSFUL_SEARCH},[me.PAGINATE_SEARCH]:{id:2,notifType:me.SUCCESSFUL_SEARCH},[me.UNSUCCESSFUL_SEARCH]:{id:3,notifType:me.UNSUCCESSFUL_SEARCH},[me.DATEPICKER_DROPDOWN_START]:{id:4,notifType:me.DATEPICKER},[me.DATEPICKER_CLEAR_START]:{id:5,notifType:me.DATEPICKER},[me.DATEPICKER_DROPDOWN_END]:{id:6,notifType:me.DATEPICKER},[me.DATEPICKER_CLEAR_END]:{id:7,notifType:me.DATEPICKER},[me.BOOKMARK_FILTER]:{id:8,notifType:me.BOOKMARK_FILTER},[me.TAG_FILTER]:{id:9,notifType:me.TAG_FILTER},[me.DOMAIN_FILTER]:{id:10,notifType:me.DOMAIN_FILTER},[me.ADD_TAG]:{id:12,notifType:me.TAGGING},[me.DELETE_TAG]:{id:13,notifType:me.TAGGING},[me.DELETE_RESULT]:{id:14},[me.CREATE_RESULT_BOOKMARK]:{id:15,notifType:me.BOOKMARK},[me.REMOVE_RESULT_BOOKMARK]:{id:16,notifType:me.BOOKMARK},[me.CREATE_BROWSER_BOOKMARK]:{id:17,notifType:me.BOOKMARK},[me.REMOVE_BROWSER_BOOKMARK]:{id:18,notifType:me.BOOKMARK},[me.CREATE_POPUP_BOOKMARK]:{id:19,notifType:me.BOOKMARK},[me.REMOVE_POPUP_BOOKMARK]:{id:20,notifType:me.BOOKMARK},[me.ADD_POPUP_TAG]:{id:21,notifType:me.TAGGING},[me.DELETE_POPUP_TAG]:{id:22,notifType:me.TAGGING},[me.BLACKLIST_SITE]:{id:23,notifType:me.BLACKLIST},[me.BLACKLIST_DOMAIN]:{id:24,notifType:me.BLACKLIST},[me.REMOVE_BLACKLIST_ENTRY]:{id:25,notifType:me.BLACKLIST},[me.CHANGE_TRACKING_PREF_OPTOUT]:{id:26},[me.CHANGE_TRACKING_PREF_OPTIN]:{id:27},[me.START_IMPORT]:{id:28},[me.PAUSE_IMPORT]:{id:29},[me.RESUME_IMPORT]:{id:30},[me.CANCEL_IMPORT]:{id:31},[me.FINISH_IMPORT]:{id:32},[me.SEARCH_POPUP]:{id:33,notifType:me.ADDRESS_BAR_SEARCH},[me.SUCCESSFUL_OMNIBAR_SEARCH]:{id:34,notifType:me.ADDRESS_BAR_SEARCH},[me.UNSUCCESSFUL_OMNIBAR_SEARCH]:{id:35,notifType:me.ADDRESS_BAR_SEARCH},[me.DATEPICKER_NLP_START_DATE]:{id:36,notifType:me.DATEPICKER_NLP},[me.DATEPICKER_NLP_END_DATE]:{id:37,notifType:me.DATEPICKER_NLP},[me.NLP_SEARCH]:{id:38,notifType:me.NLP_SEARCH},[me.ONBOARDING_CANCEL_IMPORT]:{id:39},[me.ONBOARDING_FINISH_IMPORT]:{id:40},[me.ADD_BLACKLIST_ENTRY]:{id:41,notifType:me.BLACKLIST},[me.READ_NOTIFICATION_SEARCH_ENGINE]:{id:42},[me.READ_NOTIFICATION_OVERVIEW]:{id:43},[me.READ_NOTIFICATION_PAGINATION]:{id:44},[me.OPEN_INBOX_OVERVIEW]:{id:45},[me.CLICK_STORAGE_CHANGE_NOTIF_BUTTON]:{id:46},[me.CLICK_OPEN_NEW_LINK_BUTTON]:{id:47},[me.CLOSE_INBOX_OVERVIEW]:{id:48},[me.CLICK_ON_SYSTEM_NOTIFICATION]:{id:49},[me.TOGGLE_STORAGE_SEARCH_ENGINE]:{id:50},[me.CLICK_OPEN_NEW_LINK_BUTTON_SEARCH]:{id:51},[me.RESUME_INDEXING]:{id:52},[me.PAUSE_INDEXING]:{id:53},[me.CLOSE_COMMENT_SIDEBAR]:{id:54},[me.OPEN_COMMENT_SIDEBAR]:{id:55},[me.CREATE_ANNOTATION]:{id:56},[me.REMOVE_RIBBON]:{id:57},[me.OPEN_SIDEBAR_PAGE]:{id:58},[me.CLOSE_SIDEBAR_PAGE]:{id:59},[me.CREATE_ANNOTATION_PAGE]:{id:60},[me.DISABLE_SIDEBAR_PAGE]:{id:61},[me.ENABLE_TOOLTIP_POPUP]:{id:62},[me.DISABLE_TOOLTIP_POPUP]:{id:63},[me.DELETE_ANNOTATION]:{id:64},[me.CREATE_COLLECTION]:{id:65},[me.INSERT_PAGE_COLLECTION]:{id:66},[me.REMOVE_COLLECTION]:{id:67},[me.REMOVE_PAGE_COLLECTION]:{id:68},[me.OPEN_URL_FEATURE]:{id:69},[me.START_ONBOARDING]:{id:70},[me.FINISH_ONBOARDING]:{id:71},[me.CLICK_REPLY_BUTTON]:{id:72},[me.CLICK_SHARE_BUTTON]:{id:73},[me.LEARN_MORE_CROWD_FUNDING]:{id:74},[me.START_ANNOTATION_ONBOARDING]:{id:75},[me.FINISH_ANNOTATION_ONBOARDING]:{id:76},[me.START_POWERSEARCH_ONBOARDING]:{id:77},[me.FINISH_POWERSEARCH_ONBOARDING]:{id:78},[me.ONBOARDING_HIGHLIGHT_MADE]:{id:79},[me.POWERSEARCH_BROWSE_PAGE]:{id:80},[me.POWERSEARCH_GOTO_DASH]:{id:81},[me.SET_TOOLTIP]:{id:82,notifType:me.OVERVIEW_TOOLTIP},[me.CLOSE_TOOLTIP]:{id:83,notifType:me.OVERVIEW_TOOLTIP},[me.START_TAGGING_ONBOARDING]:{id:84},[me.FINISH_TAGGING_ONBOARDING]:{id:85},[me.FINISH_BACKUP_ONBOARDING]:{id:86},[me.CLICK_RESULT_LINK]:{id:87}},ve={[me.SUCCESSFUL_SEARCH]:[1,2],[me.UNSUCCESSFUL_SEARCH]:[3],[me.DATEPICKER]:[4,5,6,7],[me.BOOKMARK_FILTER]:[8],[me.TAG_FILTER]:[9],[me.DOMAIN_FILTER]:[10],[me.TAGGING]:[12,13,21,22],[me.BOOKMARK]:[14,15,16,17,18,19,20],[me.BLACKLIST]:[23,24,25,41],[me.ADDRESS_BAR_SEARCH]:[33,34,35],[me.DATEPICKER_NLP]:[36,37],[me.NLP_SEARCH]:[38],[me.OVERVIEW_TOOLTIP]:[82,83]};new Set([me.SUCCESSFUL_SEARCH,me.NLP_SEARCH,me.BOOKMARK,me.BOOKMARK_FILTER,me.REMOVE_RESULT_BOOKMARK,me.REMOVE_POPUP_BOOKMARK,me.CREATE_RESULT_BOOKMARK,me.ADD_BLACKLIST_ENTRY,me.ADD_TAG,me.ADD_POPUP_TAG,me.DELETE_TAG,me.DELETE_POPUP_TAG,me.DELETE_ANNOTATION,me.CREATE_ANNOTATION,me.CREATE_ANNOTATION_PAGE,me.CREATE_COLLECTION,me.INSERT_PAGE_COLLECTION,me.REMOVE_COLLECTION,me.REMOVE_PAGE_COLLECTION,me.REMOVE_BLACKLIST_ENTRY,me.DOMAIN_FILTER,me.DELETE_RESULT,me.TAG_FILTER,me.PAUSE_INDEXING,me.RESUME_INDEXING,me.PAGINATE_SEARCH,me.CLICK_RESULT_LINK]);class be extends c.a{constructor(e){super({storageManager:e}),this.getConfig=()=>({collections:Object.assign({},ge),operations:{createEvent:{collection:be.EVENT_LOG_COLL,operation:"createObject"},findLatestEventOfType:{collection:be.EVENT_LOG_COLL,operation:"findObject",args:[{type:"$type:int"},{reverse:"$reverse:boolean",limit:"$limit:int"}]},countEventsOfType:{collection:be.EVENT_LOG_COLL,operation:"countObjects",args:{type:"$type:int"}}}})}storeEvent({time:e,details:t,type:n}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("createEvent",{time:e,details:t,type:ye[n].id})}))}getLatestTimeWithCount({notifType:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t=0,n=0;for(const r of ve[e]){const e=yield this.operation("findLatestEventOfType",{type:r,reverse:!0});e&&(n=Math.max(e.time,n));t+=(yield this.operation("countEventsOfType",{type:r}))}return 0===t?null:{latestTime:n,count:t}}))}}be.EVENT_LOG_COLL=pe;class _e{constructor({storageManager:e}){this.storage=new be(e)}setupRemoteFunctions(){Object(a.d)({processEvent:(...e)=>{}})}storeEvent(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.storage.storeEvent(e)}))}getLatestTimeWithCount(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.getLatestTimeWithCount(e)}))}}var we=n(133),Te=n(1055),Ee=n.n(Te),Ae=n(316),Se=n(187),Oe=n(20),Ie=n(553),Ce=n(117),ke=n(36),Pe=n(93),xe=n(1070);const Re=e=>Object.assign(Object.assign({},e),{parentListId:e.parentListId===Pe.a?null:e.parentListId});class Le extends c.a{constructor(e){super(e),this.options=e}getConfig(){const e=Ee()(y.a);return e[y.b.listDescription].version=Ae.b[20].version,e[y.b.listEntryDescription].version=Ae.b[20].version,{collections:e,operations:{createList:{collection:Le.CUSTOM_LISTS_COLL,operation:"createObject"},createListEntry:{collection:Le.LIST_ENTRIES_COLL,operation:"createObject"},createListDescription:{collection:Le.LIST_DESCRIPTIONS_COLL,operation:"createObject"},countListEntries:{collection:Le.LIST_ENTRIES_COLL,operation:"countObjects",args:{listId:"$listId:int"}},findListTreeByListId:{collection:Le.LIST_TREES_COLL,operation:"findObject",args:{listId:"$listId:int"}},findListTreesByParentListId:{collection:Le.LIST_TREES_COLL,operation:"findObjects",args:{parentListId:"$parentListId:int"}},findListTreesByLocalListIds:{collection:Le.LIST_TREES_COLL,operation:"findObjects",args:{listId:{$in:"$listIds:int[]"}}},findListsIncluding:{collection:Le.CUSTOM_LISTS_COLL,operation:"findObjects",args:{id:{$in:"$includedIds:array"}}},findLists:{collection:Le.CUSTOM_LISTS_COLL,operation:"findObjects",args:[{},{limit:"$limit:int",skip:"$skip:int"}]},findListById:{collection:Le.CUSTOM_LISTS_COLL,operation:"findObject",args:{id:"$id:pk"}},findListsByIds:{collection:Le.CUSTOM_LISTS_COLL,operation:"findObjects",args:{id:{$in:"$ids:array"}}},findListEntriesByListId:{collection:Le.LIST_ENTRIES_COLL,operation:"findObjects",args:{listId:"$listId:int"}},findListEntriesByUrl:{collection:Le.LIST_ENTRIES_COLL,operation:"findObjects",args:{pageUrl:"$url:string"}},findListEntriesByUrls:{collection:Le.LIST_ENTRIES_COLL,operation:"findObjects",args:{listId:"$listId:number",pageUrl:{$in:"$urls:string"}}},findListEntriesByLists:{collection:Le.LIST_ENTRIES_COLL,operation:"findObjects",args:{listId:{$in:"$listIds:array"},pageUrl:"$url:string"}},findPageByUrl:{operation:"findObject",collection:"pages",args:{url:"$url:string"}},findListEntry:{collection:Le.LIST_ENTRIES_COLL,operation:"findObject",args:{pageUrl:"$pageUrl:string",listId:"$listId:int"}},findListByNameIgnoreCase:{collection:Le.CUSTOM_LISTS_COLL,operation:"findObject",args:[{name:"$name:string"},{ignoreCase:["name"]}]},findListsByNames:{collection:Le.CUSTOM_LISTS_COLL,operation:"findObjects",args:{name:{$in:"$name:string[]"}}},findListDescriptionByList:{collection:Le.LIST_DESCRIPTIONS_COLL,operation:"findObject",args:{listId:"$listId:pk"}},findListDescriptionsByLists:{collection:Le.LIST_DESCRIPTIONS_COLL,operation:"findObjects",args:{listId:{$in:"$listIds:array"}}},updateListName:{collection:Le.CUSTOM_LISTS_COLL,operation:"updateObject",args:[{id:"$id:pk"},{name:"$name:string",searchableName:"$name:string"}]},updateListDescription:{collection:Le.LIST_DESCRIPTIONS_COLL,operation:"updateObject",args:[{listId:"$listId:pk"},{description:"$description:string"}]},updateListTreeOrder:{collection:Le.LIST_TREES_COLL,operation:"updateObjects",args:[{listId:"$listId:int"},{order:"$order:int",updatedWhen:"$updatedWhen:number"}]},deleteList:{collection:Le.CUSTOM_LISTS_COLL,operation:"deleteObject",args:{id:"$id:pk"}},deleteListEntriesByListId:{collection:Le.LIST_ENTRIES_COLL,operation:"deleteObjects",args:{listId:"$listId:pk"}},deleteListEntriesById:{collection:Le.LIST_ENTRIES_COLL,operation:"deleteObjects",args:{listId:"$listId:pk",pageUrl:"$pageUrl:string"}},deleteListDescriptions:{collection:Le.LIST_DESCRIPTIONS_COLL,operation:"deleteObjects",args:{listId:"$listId:pk"}},deleteListTreeByListId:{collection:Le.LIST_TREES_COLL,operation:"deleteObjects",args:{listId:"$listId:int"}},deleteListTreeByLinkTarget:{collection:Le.LIST_TREES_COLL,operation:"deleteObjects",args:{linkTarget:"$listId:int"}},deleteListTreeById:{collection:Le.LIST_TREES_COLL,operation:"deleteObjects",args:{id:"$id:int"}},[A.c.SUGGEST_OBJS_OP_ID]:{operation:A.c.SUGGEST_OBJS_OP_ID,args:{collection:"$collection:string",query:"$query:string",options:"$options:any"}}}}}prepareList(e,t=[],n=!1){return delete e._name_terms,Object.assign(Object.assign({},e),{pages:t,active:n})}createListDescription({listId:e,description:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("createListDescription",{listId:e,description:t})}))}createInboxListIfAbsent({createdAt:e=new Date}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findListByNameIgnoreCase",{name:y.d.INBOX});return t?t.id:(yield this.operation("createList",{name:y.d.INBOX,id:y.c.INBOX,searchableName:y.d.INBOX,isDeletable:!1,isNestable:!1,createdAt:e})).object.id}))}countListEntries(e){return this.operation("countListEntries",{listId:e})}countInboxUnread(){return this.countListEntries(y.c.INBOX)}fetchListDescriptionByList(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findListDescriptionByList",{listId:e})}))}fetchListDescriptionsByLists(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findListDescriptionsByLists",{listIds:e})}))}fetchAllLists({limit:e,skip:t,skipSpecialLists:n,includeDescriptions:i}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.operation("findLists",{limit:e,skip:t});if(i){const e=(yield this.fetchListDescriptionsByLists(r.map((e=>e.id)))).reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.listId]:t.description})),{});for(const t of r)t.description=e[t.id]}const o=r.map((e=>this.prepareList(e)));return n?o.filter(Le.filterOutSpecialLists):o}))}fetchListById(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findListById",{id:e})}))}fetchListByIds(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findListsByIds",{ids:e}),n=[];for(const r of new Set(e)){const e=t.find((e=>e.id===r));e&&n.push(e)}return n}))}fetchListWithPagesById(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.fetchListById(e);if(!t)return null;const n=yield this.fetchListPagesById({listId:t.id});return this.prepareList(t,n.map((e=>e.fullUrl)),n.length>0)}))}fetchListEntry(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findListEntry",{listId:e,pageUrl:t})}))}fetchListPagesById({listId:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findListEntriesByListId",{listId:e})}))}fetchListIdsByUrl(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.operation("findListEntriesByUrl",{url:e})).map((e=>e.listId))}))}fetchListPagesByUrl({url:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findListEntriesByUrl",{url:e}),n=new Map,r=new Set;t.filter(Le.filterOutSpecialListEntries).forEach((e=>{r.add(e.listId);const t=n.get(e.listId)||[];n.set(e.listId,[...t,e.fullUrl])}));return(yield this.operation("findListsIncluding",{includedIds:[...r]})).filter(Le.filterOutSpecialLists).map((e=>{const t=n.get(e.id);return this.prepareList(e,t,null!=t)}))}))}fetchPageListEntriesByUrl({normalizedPageUrl:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.operation("findListEntriesByUrl",{url:e})}))}fetchListPageEntriesByUrls({listId:e,normalizedPageUrls:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.operation("findListEntriesByUrls",{urls:t,listId:e})}))}insertCustomList({id:e,type:t,name:n,isDeletable:i=!0,isNestable:o=!0,createdAt:s=new Date,analyticsBG:a,dontTrack:c}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{object:r}=yield this.operation("createList",{id:e,name:n,type:t,isNestable:o,isDeletable:i,searchableName:n,createdAt:s});if(a&&null==c)try{yield Object(F.j)(a,{type:"private"})}catch(e){console.error(`Error tracking space create event', ${e}`)}return r.id}))}createListTree(e){var t,n,i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!(yield this.fetchListById(e.localListId)))throw new Error(`List does not exist to create list tree data for: ${e}`);const r=null!==(t=e.parentListId)&&void 0!==t?t:Pe.a;let o;if(null!=e.order)o=e.order;else{const e=(yield this.operation("findListTreesByParentListId",{parentListId:r})).sort(Oe.c).map((e=>({id:e.id,key:e.order})));o=e.length>0?Object(Oe.d)(e,"",0).create.key:Object(Oe.e)(e,"").create.key}const s=null!==(n=e.now)&&void 0!==n?n:Date.now(),a={parentListId:r,listId:e.isLink?null:e.localListId,linkTarget:e.isLink?e.localListId:null,path:(null===(i=e.pathIds)||void 0===i?void 0:i.length)?Object(ke.a)(...e.pathIds):null,order:o,createdWhen:s,updatedWhen:s},c=e.skipSyncEntry?this.options.storageManager.backend:this.options.storageManager,{object:l}=yield c.operation("createObject","customListTrees",a);return Object.assign(Object.assign({},a),{id:l.id})}))}getMaterializedPathIdsFromTree(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=[e.id];let n=e.id;for(;;){const e=yield this.operation("findListTreeByListId",{listId:n});if(n=null==e?void 0:e.parentListId,n===Pe.a||null==n)break;t.unshift(n)}return t}))}getTreesByParent(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.operation("findListTreesByParentListId",{parentListId:e.parentListId})).map(Re)}))}getTreeDataForList(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findListTreeByListId",{listId:e.localListId});return t?Re(t):null}))}getTreeDataForLists(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findListTreesByLocalListIds",{listIds:e.localListIds});return H()(t.map((e=>[e.listId,Re(e)])))}))}updateListTreeParent(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=null!==(t=e.now)&&void 0!==t?t:Date.now(),r=[];yield Object(xe.a)({nodeId:e.localListId,newParentNodeId:e.newParentListId,selectNodeId:e=>{var t;return null!==(t=e.listId)&&void 0!==t?t:e.linkTarget},selectNodeParentId:e=>e.parentListId,retrieveNode:e=>this.getTreeDataForList({localListId:e}),createNode:(t,n)=>this.createListTree({localListId:t,parentListId:null==n?void 0:n.listId,pathIds:null!=n?[...Object(ke.b)(n.path,"number"),n.listId]:void 0,now:e.now,skipSyncEntry:!0}),getChildrenOfNode:e=>this.getTreesByParent({parentListId:e.listId}),isNodeALeaf:e=>null!=e.linkTarget,updateNodesParent:(e,t)=>{var i,o;e.parentListId=null!==(i=null==t?void 0:t.listId)&&void 0!==i?i:Pe.a,e.path=null!=t?Object(ke.a)(...Object(ke.b)(null!==(o=t.path)&&void 0!==o?o:"","number"),t.listId):null,r.push({collection:Le.LIST_TREES_COLL,operation:"updateObjects",where:{id:e.id},updates:{path:e.path,parentListId:e.parentListId,updatedWhen:n}})},assertSuitableParent:e=>{if(null!=(null==e?void 0:e.linkTarget))throw new Error("Cannot move a list tree node to be a child of a link target node")}}),yield this.options.storageManager.backend.executeBatch(r)}))}isListAAncestorOfListB(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getTreeDataForList({localListId:t});if(!n)return!1;return Object(ke.b)(n.path,"number").includes(e)}))}deleteListTree(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteListTreeById",{id:e.treeId})}))}updateListName({id:e,name:t,updatedAt:n=new Date}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("updateListName",{id:e,name:t})}))}findPageByUrl(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.operation("findPageByUrl",{url:e})}))}createOrUpdateListDescription({listId:e,description:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.fetchListDescriptionByList(e);yield this.operation(n?"updateListDescription":"createListDescription",{listId:e,description:t})}))}updateListTreeOrder(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("updateListTreeOrder",{listId:e.localListId,order:e.order,updatedWhen:null!==(t=e.now)&&void 0!==t?t:Date.now()})}))}deleteListTreeLink(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteListTreeByLinkTarget",{listId:e.localListId})}))}getAllNodesInTreeByList(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getTreeDataForList({localListId:e.rootLocalListId});if(!n)throw new Error(`Could not find root list data of tree to traverse - list ID: ${e.rootLocalListId}`);if(null!=n.linkTarget)return[n];const r=Object(ke.a)(...Object(ke.b)(null!==(t=n.path)&&void 0!==t?t:"","number"),n.listId),i=this.options.storageManager.backend,o=yield i.dexieInstance.table("customListTrees").where("path").startsWith(r).toArray();return o.push(n),o}))}removeListAssociatedData({listId:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteListEntriesByListId",{listId:e}),yield this.operation("deleteListTreeByListId",{listId:e}),yield this.deleteListDescriptions({listId:e})}))}removeList({id:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteList",{id:e})}))}checkIfPageInfilteredList({url:e,listNames:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let n=yield this.fetchListIdsByUrl(Object(D.c)(e));if(0===(null==n?void 0:n.length))return!1;n=n.filter((e=>20201014!=e));for(const e of n){const n=(yield this.operation("findListById",{id:e})).name;if(t.includes(n))return!0}}))}insertPageToList({listId:e,pageUrl:t,fullUrl:n,createdAt:i=new Date,pageTitle:o,analyticsBG:s,isShared:a,dontTrack:c}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const o=yield this.fetchListById(e);if(Boolean(o)){if(s&&null==c&&e!==y.c.INBOX&&e!==y.c.MOBILE)try{yield Object(F.k)(s,{type:a?"shared":"private"})}catch(e){}if(Object(Ce.c)({storageAPI:this.options.___storageAPI}))try{const e=yield this.operation("findPageByUrl",{url:Object(D.c)(n)}),t={pageUrl:n,pageTitle:e.fullTitle,pkmSyncType:"page",pageSpaces:o.name,createdWhen:Date.now()};Object(Ie.b)(t,this.options.pkmSyncBG,((e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.checkIfPageInfilteredList({url:e,listNames:t})}))))}catch(e){}return this.operation("createListEntry",{listId:e,pageUrl:t,fullUrl:n,createdAt:i})}}))}removePageFromList({listId:e,pageUrl:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(Object(Ce.c)({storageAPI:this.options.___storageAPI}))try{const n=yield this.fetchListById(e),r=yield this.operation("findPageByUrl",{url:Object(D.c)(t)}),i={pageUrl:t,pageTitle:r.fullTitle,pkmSyncType:"page",pageSpaces:n.name,createdWhen:Date.now()};Object(Ie.b)(i,this.options.pkmSyncBG)}catch(e){}return this.operation("deleteListEntriesById",{listId:e,pageUrl:t})}))}removeAllListPages({listId:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("deleteListEntriesByListId",{listId:e})}))}deleteListDescriptions({listId:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteListDescriptions",{listId:e})}))}suggestLists({query:e,limit:t=20}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=e.replace(Se.a," "),r=yield this.operation(A.c.SUGGEST_OBJS_OP_ID,{collection:Le.CUSTOM_LISTS_COLL,query:{nameTerms:n},options:{multiEntryAssocField:"name",ignoreCase:["nameTerms"],limit:t}});return(yield this.operation("findListsIncluding",{includedIds:r.map((({pk:e})=>e))})).filter(Le.filterOutSpecialLists)}))}fetchListIgnoreCase({name:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findListByNameIgnoreCase",{name:e})}))}}Le.LIST_DESCRIPTIONS_COLL=y.b.listDescription,Le.CUSTOM_LISTS_COLL=y.b.list,Le.LIST_ENTRIES_COLL=y.b.listEntry,Le.LIST_TREES_COLL=y.b.listTrees,Le.filterOutSpecialListEntries=e=>!Object.values(y.c).includes(e.listId),Le.filterOutSpecialLists=e=>!Object.values(y.d).includes(e.name);var De=n(580),Ne=n(37);var je=n(711),Me=n(554),Fe=n(352);class Ue{constructor(e){this.options=e,this.serverToTalkTo=Fe.b,this.fetchAnnotationRefsForRemoteListsOnPage=({sharedListIds:e,normalizedPageUrl:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.options.contentSharingBackend.loadPageAnnotationRefsForLists({listIds:e,normalizedPageUrl:t})})),this.fetchLocalDataForRemoteListEntryFromServer=({normalizedPageUrl:e,remoteListId:t,opts:n})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.options.contentSharingBackend.loadLocalDataForListEntry({listId:t,normalizedPageUrl:e,opts:n});if("permission-denied"===r.status)throw new Error("Cannot get user data from server when unauthorized");return"not-found"===r.status?null:r.data})),this.fetchSharedListDataWithPageAnnotations=({normalizedPageUrl:e,remoteListId:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var n,r,i;const o=yield this.options.contentSharingBackend.loadCollectionDetails({listId:t,normalizedPageUrl:e});if("permission-denied"===o.status)throw new Error("Cannot get user data from server when unauthorized");return"not-found"===o.status?null:Object.assign(Object.assign({},o.data.retrievedList.sharedList),{sharedAnnotations:Object.values(null!==(n=o.data.annotations)&&void 0!==n?n:{}),order:null!==(i=null===(r=o.data.retrievedList.sharedListTree)||void 0===r?void 0:r.order)&&void 0!==i?i:1})})),this.fetchSharedListDataWithOwnership=({remoteListId:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t,n;const r=yield this.options.authServices.auth.getCurrentUser();if(!r)return null;const i=yield this.options.contentSharingBackend.loadCollectionDetails({listId:e});if("permission-denied"===i.status)throw new Error("Cannot get user data from server when unauthorized");if("not-found"===i.status)return null;const o=i.data.retrievedList.sharedList;return{name:o.title,id:o.createdWhen,order:null!==(n=null===(t=i.data.retrievedList.sharedListTree)||void 0===t?void 0:t.order)&&void 0!==n?n:1,remoteId:o.reference.id.toString(),createdAt:new Date(o.createdWhen),isOwned:o.creator.id===r.id,parentListId:null,pathListIds:[]}})),this.fetchAllLists=({skip:e=0,limit:t=5e3,skipSpecialLists:n=!1,includeTreeData:i,includeDescriptions:o})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.storage.fetchAllLists({includeDescriptions:o,skipSpecialLists:n,limit:t,skip:e}),s=i?yield this.storage.getTreeDataForLists({localListIds:r.map((e=>e.id))}):{};return r.map(((e,t)=>{var n,r,i,o,a,c;return Object.assign(Object.assign({},e),{order:null!==(r=null===(n=s[e.id])||void 0===n?void 0:n.order)&&void 0!==r?r:Oe.a+10*t,parentListId:null!==(o=null===(i=s[e.id])||void 0===i?void 0:i.parentListId)&&void 0!==o?o:null,pathListIds:Object(ke.b)(null!==(c=null===(a=s[e.id])||void 0===a?void 0:a.path)&&void 0!==c?c:"","number")})}))})),this.fetchListTreeById=({id:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t,n,r;const i=(yield this.storage.fetchListByIds([e]))[0],o=yield this.storage.getTreeDataForList({localListId:i.id});return o?Object.assign(Object.assign(Object.assign({},i),o),{order:null!==(t=o.order)&&void 0!==t?t:Oe.a,parentListId:null!==(n=o.parentListId)&&void 0!==n?n:null,pathListIds:Object(ke.b)(null!==(r=o.path)&&void 0!==r?r:"","number")}):null})),this.fetchListById=({id:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.fetchListWithPagesById(e)})),this.findSimilarBackground=(e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=new Me.a({url:this.serverToTalkTo,storageAPI:this.options.browserAPIs.storage});return yield n.findSimilar(e,t)})),this.findPageByUrl=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.storage.findPageByUrl(e)})),this.fetchListByName=({name:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.fetchListIgnoreCase({name:e})})),this.createCustomLists=({names:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=new Map;for(const n of e){const e=yield this.fetchListByName({name:n});e&&t.set(e.name,e.id)}const n=e.filter((e=>!t.has(e))),r=new Map;for(const e of n){const t=Date.now();r.set(e,t),yield this.createCustomList({name:e,id:t})}const i=new Map([...t,...r]);return e.map((e=>i.get(e)))})),this.fetchListPagesById=({id:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.fetchListPagesById({listId:e})})),this.fetchListPagesByUrl=({url:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.fetchListPagesByUrl({url:Object(D.c)(e)})})),this.fetchPageListEntriesByUrl=({url:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.fetchPageListEntriesByUrl({normalizedPageUrl:Object(D.c)(e)})})),this.fetchPageLists=({url:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.fetchListPagesByUrl({url:e})).map((({id:e})=>e))})),this.updateListSuggestionsCache=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return function(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t=yield e.getCache();if(null!=e.added){const n=t.indexOf(e.added);-1!==n&&(delete t[n],t=t.filter((e=>null!=e))),t.unshift(e.added)}if(null!=e.removed){const n=t.indexOf(e.removed);delete t[n],t=t.filter((e=>null!=e))}e.suggestionLimit&&(t=t.slice(0,e.suggestionLimit)),yield e.setCache(t)}))}(Object.assign(Object.assign({},e),{suggestionLimit:25,getCache:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.localStorage.get("suggestionIds");return null!=e?e:[]})),setCache:e=>this.localStorage.set("suggestionIds",e)}))})),this.getInboxUnreadCount=()=>this.storage.countInboxUnread(),this.createTabGroup=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=e;if(null==t)return;const n=(yield this.fetchListById({id:t})).pages,r=yield this.options.browserAPIs.windows.create();for(const e of n)yield this.options.browserAPIs.tabs.create({windowId:r.id,url:e})})),this.createCustomList=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var{name:t,id:n,type:i,order:o,createdAt:s,dontTrack:a,parentListId:c}=e,l=Object(r.__rest)(e,["name","id","type","order","createdAt","dontTrack","parentListId"]);const u=null!=n?n:this.generateListId(),d=yield this.storage.insertCustomList({id:u,type:i,name:t,createdAt:s,analyticsBG:this.options.analyticsBG,dontTrack:a});yield this.updateListSuggestionsCache({added:u});const h=yield this.options.contentSharing.scheduleListShare(Object.assign({localListId:d,isPrivate:"page-link"!==i},l));return yield this.createListTree({order:o,localListId:d,parentListId:c,now:null==s?void 0:s.getTime()}),Object.assign(Object.assign({},h),{localListId:d})})),this.createListTree=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=null!=e.parentListId?yield this.storage.getMaterializedPathIdsFromTree({id:e.parentListId}):[],{id:n}=yield this.storage.createListTree({localListId:e.localListId,parentListId:e.parentListId,order:e.order,now:e.now,pathIds:t});return{treeId:n}})),this.updateListTreeOrder=({localListId:e,siblingListIds:t,intendedIndexAmongSiblings:n,now:i})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.storage.getTreeDataForLists({localListIds:t}),o=Object.values(r).sort(Oe.c).map((e=>({id:e.id,key:e.order}))),s=n===t.length?Object(Oe.e)(o,e):Object(Oe.d)(o,e,n);yield this.storage.updateListTreeOrder({order:s.create.key,localListId:e,now:i})})),this.updateListTreeParent=({localListId:e,parentListId:t,now:n})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){if(null!=t&&(yield this.storage.isListAAncestorOfListB(e,t)))throw new Error("Cannot make list a child of a descendent - this would result in a cycle");yield this.options.storageManager.operation(je.a.moveTree,Le.LIST_TREES_COLL,{localListId:e,newParentListId:t,now:n})})),this.deleteListTree=({treeId:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.storage.deleteListTree({treeId:e})})),this.updateList=({id:e,oldName:t,newName:n})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.updateListName({id:e,name:n})})),this.insertPageToList=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t,n;const{id:r}=e,i="contentIdentifier"in e?null===(t=e.contentIdentifier)||void 0===t?void 0:t.fullUrl:e.url;if(!Object(we.b)(i))throw new Error("Tried to insert page to list with a normalized, instead of a full URL");yield this.updateListSuggestionsCache({added:r}),e.skipPageIndexing||(yield this.options.pages.indexPage({tabId:e.tabId,fullUrl:i,visitTime:e.suppressVisitCreation?void 0:"$now",metaData:{pageTitle:e.pageTitle}},{addInboxEntryOnCreate:!e.suppressInboxEntry}));const o=Object(D.c)(i),s=yield this.storage.fetchListEntry(r,o);let a=null;try{a=yield this.options.contentSharing.storage.getRemoteListId({localId:r})}catch(e){console.error(e)}if(null!=s)return{object:s};return yield this.storage.insertPageToList({pageUrl:o,listId:r,fullUrl:i,createdAt:e.createdAt,pageTitle:e.pageTitle,analyticsBG:this.options.analyticsBG,isShared:null!==(n=null!=a)&&void 0!==n&&n,dontTrack:e.dontTrack})})),this.removePageFromList=({id:e,url:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.options.removeChildAnnotationsFromList(t,e),this.storage.removePageFromList({listId:e,pageUrl:Object(D.c)(t)})})),this.removeAllListPages=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.removeAllListPages({listId:e})})),this.addOpenTabsToList=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t;if(!(yield this.fetchListById({id:e.listId})))throw new Error("No list found for ID:"+e.listId);const n=yield this.options.tabManagement.getOpenTabsInCurrentWindow();yield Promise.all(n.map((e=>this.options.tabManagement.injectContentScriptsIfNeeded(e.id))));const r=yield Object(De.b)(n,{createPage:this.options.pages.indexPage,waitForContentIdentifier:this.options.pages.waitForContentIdentifier,time:null!==(t=e.time)&&void 0!==t?t:"$now"}),i=yield this.storage.fetchListPageEntriesByUrls({listId:e.listId,normalizedPageUrls:r.map((({fullUrl:e})=>Object(D.c)(e)))}),o=new Set(i.map((e=>e.fullUrl)));yield Promise.all(r.filter((({fullUrl:e})=>!o.has(e))).map((({fullUrl:t})=>{this.storage.insertPageToList({listId:e.listId,fullUrl:t,pageUrl:Object(D.c)(t),pageTitle:e.pageTitle,analyticsBG:this.options.analyticsBG})}))),yield this.updateListSuggestionsCache({added:e.listId})})),this.removeOpenTabsFromList=({listId:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.options.tabManagement.getOpenTabsInCurrentWindow();yield Promise.all(t.map((t=>this.storage.removePageFromList({listId:e,pageUrl:Object(D.c)(t.url)}))))})),this.fetchListDescriptions=({listIds:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.storage.fetchListDescriptionsByLists(e)).reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.listId]:t.description})),{})})),this.updateListDescription=({description:e,listId:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.storage.createOrUpdateListDescription({description:e,listId:t})})),this.updateListForPage=({added:e,deleted:t,url:n,tabId:i,skipPageIndexing:o,pageTitle:s})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=null!=e?e:t;e&&(yield this.insertPageToList({id:r,url:n,tabId:i,skipPageIndexing:o,pageTitle:s})),t&&(yield this.removePageFromList({id:r,url:n}))})),this.storage=new Le({storageManager:e.storageManager,pkmSyncBG:e.pkmSyncBG,___storageAPI:e.browserAPIs.storage}),this.remoteFunctions={createCustomList:this.createCustomList,deleteListTree:this.deleteListTree,updateListTreeParent:this.updateListTreeParent,updateListTreeOrder:this.updateListTreeOrder,insertPageToList:t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var n;if(!t.indexUrl){const r=yield e.browserAPIs.tabs.query({active:!0,currentWindow:!0});t.tabId=null===(n=null==r?void 0:r[0])||void 0===n?void 0:n.id}return this.insertPageToList(t)})),updateListName:this.updateList,findPageByUrl:this.findPageByUrl,removePageFromList:this.removePageFromList,removeAllListPages:this.removeAllListPages,fetchAllLists:this.fetchAllLists,fetchListById:this.fetchListById,fetchListTreeById:this.fetchListTreeById,findSimilarBackground:this.findSimilarBackground,fetchAnnotationRefsForRemoteListsOnPage:this.fetchAnnotationRefsForRemoteListsOnPage,fetchSharedListDataWithPageAnnotations:this.fetchSharedListDataWithPageAnnotations,fetchSharedListDataWithOwnership:this.fetchSharedListDataWithOwnership,fetchListPagesByUrl:this.fetchListPagesByUrl,fetchPageListEntriesByUrl:this.fetchPageListEntriesByUrl,fetchPageLists:this.fetchPageLists,addOpenTabsToList:this.addOpenTabsToList,removeOpenTabsFromList:this.removeOpenTabsFromList,updateListForPage:this.updateListForPage,fetchListDescriptions:this.fetchListDescriptions,updateListDescription:this.updateListDescription,getInboxUnreadCount:this.getInboxUnreadCount,createTabGroup:this.createTabGroup,fetchLocalDataForRemoteListEntryFromServer:this.fetchLocalDataForRemoteListEntryFromServer},this.localStorage=new Ne.a(e.browserAPIs.storage.local,{prefix:"custom-lists_"})}generateListId(){return Date.now()}createInboxListIfAbsent({createdAt:e=new Date}={}){return this.storage.createInboxListIfAbsent({createdAt:e})}createInboxListEntry({fullUrl:e,createdAt:t=new Date}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.createInboxListIfAbsent({createdAt:t});return this.storage.insertPageToList({listId:n,fullUrl:e,createdAt:t,pageUrl:Object(D.c)(e)})}))}}var Be=n(875),Ge=n(891);class qe extends c.a{constructor(){super(...arguments),this.getConfig=()=>({collections:Object.assign({},Be.a),operations:{findAllTagsOfPage:{collection:qe.TAGS_COLL,operation:"findObjects",args:{url:"$url:string"}},createTag:{collection:qe.TAGS_COLL,operation:"createObject"},deleteTag:{collection:qe.TAGS_COLL,operation:"deleteObjects",args:{name:"$name:string",url:"$url:string"}},deleteAllTagsForPage:{collection:qe.TAGS_COLL,operation:"deleteObjects",args:{url:"$url:string"}},deleteTagsForPage:{collection:qe.TAGS_COLL,operation:"deleteObjects",args:{url:"$url:string",name:{$in:"$tags:string[]"}}}}})}fetchAnnotationTags({url:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.operation("findAllTagsOfPage",{url:e})).map((({name:e})=>e))}))}fetchPageTags({url:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.operation("findAllTagsOfPage",{url:Object(D.c)(e,{})})).map((({name:e})=>e))}))}addTag({name:e,url:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!Ge.b.test(e))throw new Error(`Attempted to create a badly shaped tag: ${e}`);return t=Object(D.c)(t,{}),this.operation("createTag",{name:e,url:t})}))}addAnnotationTag({name:e,url:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!Ge.b.test(e))throw new Error(`Attempted to create a badly shaped tag: ${e}`);return this.operation("createTag",{name:e,url:t})}))}addTags({name:e,urls:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield Promise.all(t.map((t=>this.addTag({name:e,url:t}))))}))}delTag({name:e,url:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return t=Object(D.c)(t,{}),this.operation("deleteTag",{name:e,url:t})}))}delTags({name:e,urls:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield Promise.all(t.map((t=>this.delTag({name:e,url:t}))))}))}deleteAllTagsForPage({url:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("deleteAllTagsForPage",{url:e})}))}deleteTagsForPage({url:e,tags:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("deleteTagsForPage",{url:e,tags:t})}))}}qe.TAGS_COLL=Be.b.tag;var He=n(514);class $e{constructor(e){this.options=e,this.searchForTagSuggestions=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.options.searchBackgroundModule.storage.suggest(Object.assign({type:"tag"},e))})),this.addTagsToOpenTabs=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.options.tabManagement.getOpenTabsInCurrentWindow(),n=yield Object(De.b)(t,{createPage:this.options.pages.indexPage,waitForContentIdentifier:this.options.pages.waitForContentIdentifier,time:e.time||"$now"});yield this.storage.addTags({name:e.name,urls:n.map((e=>e.fullUrl))}),this._updateTagSuggestionsCache({added:e.name})})),this.delTagsFromOpenTabs=({name:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.options.tabManagement.getOpenTabsInCurrentWindow();return this.storage.delTags({name:e,urls:t.map((e=>e.url))})})),this.fetchPageTags=({url:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.fetchPageTags({url:e})})),this.fetchAnnotationTags=({url:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.fetchAnnotationTags({url:e})})),this.addTagToExistingUrl=({tag:e,url:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this._updateTagSuggestionsCache({added:e}),this.storage.addTag({name:e,url:t})})),this.addTagsToExistingAnnotationUrl=({tags:e,url:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){for(const n of e)yield this._updateTagSuggestionsCache({added:n}),yield this.storage.addAnnotationTag({name:n,url:t})})),this.addTagsToExistingUrl=({tags:e,url:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){for(const n of e)yield this._updateTagSuggestionsCache({added:n}),yield this.storage.addTag({name:n,url:t})})),this._updateTagSuggestionsCache=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){})),this.delTag=({tag:e,url:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.delTag({name:e,url:t})})),this.addTagToPage=({url:e,tag:t,tabId:n})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.options.pages.indexPage({fullUrl:e,tabId:n,visitTime:"$now"},{addInboxEntryOnCreate:!0}),this.options.analytics.trackEvent({category:"Tags",action:"createTagForPage"}),yield this.storage.addTag({url:e,name:t}).catch(Object(He.a)()),yield this._updateTagSuggestionsCache({added:t})})),this.updateTagForPage=({added:e,deleted:t,url:n,tabId:i})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){e&&(yield this.addTagToPage({url:n,tag:e,tabId:i})),t&&(yield this.delTag({url:n,tag:t}))})),this.deleteAllTagsForPage=({url:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.deleteAllTagsForPage({url:e})})),this.deleteTagsForPage=({url:e,tags:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.deleteTagsForPage({url:e,tags:t})})),this.setTagsForAnnotation=({url:e,tags:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.fetchAnnotationTags({url:e}),r=new Set(n),i=new Set(t),o=t.filter((e=>!r.has(e))),s=n.filter((e=>!i.has(e)));o.length&&(yield this.addTagsToExistingAnnotationUrl({url:e,tags:o})),s.length&&(yield this.deleteTagsForPage({url:e,tags:s}))})),this.storage=new qe({storageManager:e.storageManager}),this.remoteFunctions={addTagToExistingUrl:this.addTagToExistingUrl,delTag:this.delTag,addTagToPage:this.addTagToPage,updateTagForPage:this.updateTagForPage,setTagsForAnnotation:this.setTagsForAnnotation,fetchPageTags:this.fetchPageTags,addTagsToOpenTabs:this.addTagsToOpenTabs,delTagsFromOpenTabs:this.delTagsFromOpenTabs,searchForTagSuggestions:this.searchForTagSuggestions},this.localStorage=new Ne.a(e.localBrowserStorage,{prefix:"tags_"})}}var We=n(507);class ze extends c.a{constructor({storageManager:e,bookmarksColl:t=ze.BMS_COLL}){super({storageManager:e}),this.getConfig=()=>({collections:{[ze.BMS_COLL]:We.a[ze.BMS_COLL]},operations:{createBookmark:{collection:this.bookmarksColl,operation:"createObject"},deleteBookmark:{collection:this.bookmarksColl,operation:"deleteObjects",args:{url:"$url:pk"}},findBookmarkByUrl:{collection:this.bookmarksColl,operation:"findObject",args:{url:"$url:string"}},findTabBookmarks:{collection:this.bookmarksColl,operation:"findObjects",args:{url:{$in:"$normalizedPageUrls"}}}}}),this.pageHasBookmark=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return!!(yield this.findBookmark(e))})),this.findBookmark=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=Object(D.c)(e);return this.operation("findBookmarkByUrl",{url:t})})),this.bookmarksColl=t}addBookmark({url:e,time:t=Date.now()}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=Object(D.c)(e);return this.operation("createBookmark",{url:n,time:t})}))}delBookmark({url:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=Object(D.c)(e);return this.operation("deleteBookmark",{url:t})}))}createBookmarkIfNeeded(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){(yield this.pageHasBookmark(e))||(yield this.addBookmark({url:Object(D.c)(e),time:t}))}))}findTabBookmarks(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findTabBookmarks",{normalizedPageUrls:e})}))}}ze.BMS_COLL=We.b.bookmark;var Ve=n(49),Ke=n(892),Ye=n.n(Ke),Qe=n(162),Xe=n(32);const Je="memex:settings:bookmarkSync";class Ze{constructor(e){this.options=e,this.addPageBookmark=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t;const n=null!==(t=e.fullUrl)&&void 0!==t?t:e.url;if(!Object(we.b)(n))throw console.error("Invalid Bookmark",{params:e}),new Error("Tried to create a bookmark with a normalized, instead of a full URL");let r=e.tabId;if(null==r){const[e]=yield this.options.browserAPIs.tabs.query({currentWindow:!0,active:!0});r=null==e?void 0:e.id}e.skipIndexing||(yield this.options.pages.indexPage({tabId:r,fullUrl:n,visitTime:e.timestamp||"$now",metaData:e.metaData},{addInboxEntryOnCreate:!0})),yield this.storage.createBookmarkIfNeeded(n,e.timestamp),yield Object(F.b)(this.options.analyticsBG)})),this.delPageBookmark=({url:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.storage.delBookmark({url:e}),yield this.options.pages.storage.deletePageIfOrphaned(e)})),this.addBookmark=this.addPageBookmark,this.delBookmark=this.delPageBookmark,this.autoSetBookmarkStatusInBrowserIcon=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.options.browserAPIs.tabs.get(e);if(null==(null==t?void 0:t.url))return;const n=yield this.storage.pageHasBookmark(t.url);yield this.setBookmarkStatus(n,e)})),this.setBookmarkStatusInBrowserIcon=(e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const[n]=yield this.options.browserAPIs.tabs.query({currentWindow:!0,active:!0});(null==n?void 0:n.url)===t&&(yield this.setBookmarkStatus(e,n.id))})),this.storage=new ze(Ye()(e,"storageManager")),this.addBookmark=this.addBookmark.bind(this),this.delBookmark=this.delBookmark.bind(this),this.remoteFunctions={addPageBookmark:this.addPageBookmark,delPageBookmark:this.delPageBookmark,findBookmark:this.storage.findBookmark,pageHasBookmark:this.storage.pageHasBookmark,setBookmarkStatusInBrowserIcon:this.setBookmarkStatusInBrowserIcon,autoSetBookmarkStatusInBrowserIcon:this.autoSetBookmarkStatusInBrowserIcon}}get ROOT_BM(){return{id:"firefox"===Object(Qe.a)()?"":"0"}}setupBookmarkListeners(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){(yield Object(Xe.a)(Je))&&(this.options.browserAPIs.bookmarks.onCreated.addListener(this.handleBookmarkCreation.bind(this)),this.options.browserAPIs.bookmarks.onRemoved.addListener(this.handleBookmarkRemoval.bind(this))),this.options.browserAPIs.storage.onChanged.addListener(((e,t)=>{null!=e[Je]&&(!0===e[Je].newValue?this.options.browserAPIs.bookmarks.onCreated.addListener(this.handleBookmarkCreation.bind(this)):this.options.browserAPIs.bookmarks.onCreated.removeListener(this.handleBookmarkCreation.bind(this)))}))}))}findTabBookmarks(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=new Map;for(const n of e)t.set(n.url,Object(D.c)(n.url));const n=yield this.storage.findTabBookmarks([...t.values()]),r=new Set;for(const{url:e}of n)r.add(e);const i=new Map;for(const n of e){const e=t.get(n.url);i.set(n.url,r.has(e))}return i}))}handleBookmarkRemoval(e,{node:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(t.url)try{yield this.delPageBookmark({url:t.url})}catch(e){Object(Ve.b)(e)}}))}getBookmarkCollectionName(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t="",n=e;for(;n!==this.ROOT_BM.id;){const e=(yield this.options.browserAPIs.bookmarks.get(n))[0];t=""===t?e.title:e.title+" > "+t,n=e.parentId}return t}))}handleBookmarkCreation(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield Object(Xe.a)(Je);if(!t.url||!e)return;let n;const[r]=yield this.options.browserAPIs.tabs.query({currentWindow:!0,active:!0});return null!=r&&r.url===t.url&&(n=r.id),this.addPageBookmark({fullUrl:t.url,tabId:n})}))}setBookmarkStatus(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n="2"===this.options.manifestVersion?this.options.browserAPIs.browserAction:this.options.browserAPIs.action;e?(yield n.setBadgeText({text:"\u2764\ufe0f",tabId:t}),yield n.setBadgeBackgroundColor({color:"white"})):yield n.setBadgeText({text:"",tabId:t})}))}}var et=n(1241),tt=n.n(et);const nt="backupChanges",rt={[nt]:{version:new Date("2018-12-13"),fields:{timestamp:{type:"datetime"},collection:{type:"string"},objectPk:{type:"string"},operation:{type:"string"}},indices:[{pk:!0,field:"timestamp"},{field:"collection"}],watch:!1,backup:!1}};function it(e){return!1===e.backup}class ot extends c.a{constructor({storageManager:e}){super({storageManager:e}),this.recordingChanges=!1,this.getConfig=()=>({collections:Object.assign({},rt),operations:{findBackupChanges:{collection:ot.BACKUP_COLL,operation:"findObjects",args:[{},{limit:"$limit:int"}]},createBackupChange:{collection:ot.BACKUP_COLL,operation:"createObject"},deleteBackupChanges:{collection:ot.BACKUP_COLL,operation:"deleteObjects",args:{timestamp:{$in:"$pks:int"}}},deleteAllBackupChanges:{collection:ot.BACKUP_COLL,operation:"deleteObjects",args:{}},countBackupChanges:{collection:ot.BACKUP_COLL,operation:"countObjects",args:{collection:"$collectionName:string",timestamp:{$lte:"$timestamp:int"}}}}}),this.storageManager=e}handleStorageChange({collection:e,pk:t,operation:n}){if(!this.recordingChanges)return;it(this.storageManager.registry.collections[e])||this.registerChange({collection:e,pk:t,operation:n})}registerChange({collection:e,pk:t,operation:n}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("createBackupChange",{timestamp:Date.now(),collection:e,objectPk:t,operation:n})}))}startRecordingChanges(){this.recordingChanges=!0}stopRecordingChanges(){this.recordingChanges=!1}streamChanges(e,{batchSize:t}){return Object(r.__asyncGenerator)(this,arguments,(function*(){let n;const i={changes:[],forget:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=i.changes.map((e=>e.timestamp));yield this.operation("deleteBackupChanges",{pks:e})}))};let o=!0;for(;o&&(n=yield Object(r.__await)(this.operation("findBackupChanges",{limit:t})),n.length);){for(const s of n){if(s.timestamp>e.getTime()){o=!1;break}null!=s.objectPk&&(i.changes.push(s),i.changes.length===t&&(yield yield Object(r.__await)(i),i.changes=[]))}if(n.length<t)break}i.changes.length&&(yield yield Object(r.__await)(i))}))}countQueuedChangesByCollection(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("countBackupChanges",{collectionName:e,timestamp:t.getTime()})}))}forgetAllChanges(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteAllBackupChanges",{})}))}}ot.BACKUP_COLL=nt;class st{constructor(e){this.deps=e,this.idCache={},this.baseUrl="https://www.googleapis.com"}isIdCacheEmpty(e){return!this.idCache[e]}storeObject({folderName:e,fileName:t,object:n}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.deps.tokenManager.refreshAccessToken();const{id:r,created:i}=yield this.createFolder({parentId:"appDataFolder",name:e}),o=yield this.getFolderChildId(r,t),s={name:t,mimeType:"application/json"};o||(s.parents=[r]);const a=`/files${o?`/${o}`:""}?uploadType=resumable`,c=yield this._request(a,{prefix:"upload",json:!1,method:o?"PATCH":"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json; charset=UTF-8"}}),l=JSON.stringify(n);yield this._request(c.headers.get("Location"),{prefix:null,json:!1,method:o?"PATCH":"PUT",headers:{"Content-Type":"application/json","Content-Length":l.length},body:l}),o||(this.idCache[r][t]="NEW")}))}deleteObject({folderName:e,fileName:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.deps.tokenManager.refreshAccessToken();const n=yield this.getFolderChildId("appDataFolder",e);if(!n)return;const r=yield this.getFolderChildId(n,t);r&&(yield this._request(`/files/${r}`,{method:"DELETE"}),delete this.idCache[n][t])}))}cacheFolderContentIDs(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t=null;do{let n="";"appDataFolder"!==e&&(n+=`q=${encodeURIComponent(`'${e}' in parents`)}&`),t&&(n+=`pageToken=${t}&`);const r=yield this._request(`/files?${n}spaces=appDataFolder`),i=r.files;t=r.nextPageToken,this.idCache[e]||(this.idCache[e]={});for(const t of i)this.idCache[e][t.name]=t.id}while(t)}))}getFolderChildId(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.idCache[e]||(yield this.cacheFolderContentIDs(e));let n=this.idCache[e][t];return"NEW"===n&&(yield this.cacheFolderContentIDs(e),n=this.idCache[e][t]),n}))}listFolder(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.cacheFolderContentIDs(e),this.idCache[e]}))}getFile(e,t={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this._request(`/files/${e}?alt=media`,{method:"GET",json:t.json})}))}createFolder({parentId:e,name:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(this.isIdCacheEmpty(e)&&(yield this.cacheFolderContentIDs(e)),this.idCache[e][t])return{id:this.idCache[e][t],created:!1};const n=yield this._request("/files",{method:"POST",body:JSON.stringify({name:t,mimeType:"application/vnd.google-apps.folder",parents:[e]}),headers:{"Content-Type":"application/json"}});return this.idCache[e][t]=n.id,this.idCache[n.id]={},{id:n.id,created:!0}}))}getDriveStorageQuota(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this._request("/about?fields=storageQuota",{method:"GET",headers:{"Content-Type":"application/json"}})).storageQuota}))}_request(e,t={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.deps.tokenManager.getAccessToken();t.headers=t.headers||{},t.headers.Authorization=`Bearer ${n}`,void 0===t.prefix&&(t.prefix="main"),void 0===t.json&&(t.json=!0);let r="";null!==t.prefix&&(r=this.baseUrl),"main"===t.prefix?r+="/drive/v3":"upload"===t.prefix&&(r+="/upload/drive/v3"),delete t.prefix;const i=r+e,o=yield fetch(i,t);if(!o.ok)throw console.error("Something went wrong making a request to Drive:",o),yield this.deps.localBackupSettings.set("backupStatus","fail"),yield this.deps.localBackupSettings.set("backupStatusId","drive_size_empty"),new Error("Error during request to Drive");return t.json?o.json():o}))}}class at{constructor({tokenStore:e,memexCloudOrigin:t}){this.memexCloudOrigin=t,this.tokenStore=e,this.initializationPromise=new Promise(((e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){try{const{token:t,expiryDate:n}=yield this.tokenStore.retrieveAccessToken();t&&(this.accessToken=t,this.tokenExpiryDate=n);const r=yield this.tokenStore.retrieveRefreshToken();r&&(this.refreshToken=r),e()}catch(e){t(e)}}))))}getAccessToken(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.initializationPromise,this.accessToken}))}getRefreshToken(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.initializationPromise,this.accessToken}))}handleNewTokens({accessToken:e,refreshToken:t,expiresInSeconds:n}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){e&&n&&(this.tokenExpiryDate=new Date(Date.now()+1e3*n),this.accessToken=e,yield this.tokenStore.storeAccessToken(this.accessToken,this.tokenExpiryDate)),t&&(this.refreshToken=t,yield this.tokenStore.storeRefreshToken(this.refreshToken))}))}refreshAccessToken({force:e}={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!e&&!this.isAccessTokenExpired())return;const t=yield fetch(`${this.memexCloudOrigin}/auth/google/refresh`,{method:"POST",credentials:"include",body:JSON.stringify({refreshToken:this.refreshToken}),headers:{"Content-Type":"application/json"}}),{accessToken:n,expiresInSeconds:r}=yield t.json();n&&r?yield this.handleNewTokens({accessToken:n,expiresInSeconds:r}):console.error("Tried to refresh Google Drive access token, but got no token from the server")}))}isAccessTokenExpired({margin:e=6e5}={}){const t=this.tokenExpiryDate.getTime()-e;return Date.now()>=t}}class ct{constructor(e){this.deps=e}storeAccessToken(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.deps.localBackupSettings.set("accessToken",e),yield this.deps.localBackupSettings.set("accessTokenExpiry",t)}))}retrieveAccessToken(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return{token:yield this.deps.localBackupSettings.get("accessToken"),expiryDate:yield this.deps.localBackupSettings.get("accessTokenExpiry")}}))}storeRefreshToken(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.deps.localBackupSettings.set("refreshToken",e)}))}retrieveRefreshToken(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.deps.localBackupSettings.get("refreshToken")}))}}class lt{getLoginUrl(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return null}))}handleLoginRedirectedBack(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){}))}startBackup({events:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){}))}commitBackup({events:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){}))}sendNotificationOnFailure(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){}))}storeObject({backupObject:e,events:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){}))}deleteObject({backupObject:e,events:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){}))}backupChanges({changes:e,events:t,currentSchemaVersion:n,options:i}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){for(const n of e)"delete"!==n.operation?yield this.storeObject({backupObject:{collection:n.collection,pk:n.objectPk,object:n.object},events:t}):yield this.deleteObject({backupObject:{collection:n.collection,pk:n.objectPk},events:t})}))}listObjects(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return null}))}retrieveObject(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return null}))}}var ut=e=>new Promise(((t,n)=>{const r=new FileReader;r.readAsDataURL(e),r.onloadend=function(){let e=r.result;e&&(e=e.split(",")[1],t(e))},r.onerror=function(){n(r.error)}}));function dt(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=[];for(const n of e){const e=yield ft(n);for(const[r,i]of Object.entries(e))t.push({collection:n.collection,pk:n.objectPk,type:r,data:i})}return{changes:e,images:t}}))}function ht(e,t){return t&&!!e.length}function ft(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t={};if("pages"===e.collection&&null!=e.object&&null!=e.object.screenshot){try{t.screenshot=yield ut(e.object.screenshot)}catch(e){Ve.b(e)}e.object.screenshot=void 0}if("favIcons"===e.collection&&null!=e.object&&null!=e.object.favIcon)try{e.object.favIcon=yield ut(e.object.favIcon)}catch(e){Ve.b(e)}if(e.collection===O&&null!=e.object&&null!=e.object.profilePic){try{t.profilePic=yield ut(e.object.profilePic)}catch(e){Ve.b(e)}e.object.profilePic=void 0}return t}))}const pt="https://www.googleapis.com/auth/drive.appdata";class gt extends lt{constructor({tokenStore:e,memexCloudOrigin:t,localBackupSettings:n,scope:r=pt}){super(),this.authUrl="https://accounts.google.com/o/oauth2/v2/auth",this.scope=r,this.tokenManager=new at({tokenStore:e,memexCloudOrigin:t}),this.client=new st({tokenManager:this.tokenManager,localBackupSettings:n}),this.memexCloudOrigin=t}getLoginUrl({provider:e,returnUrl:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return`${this.memexCloudOrigin}/auth/google?scope=${this.scope}`}))}isAuthenticated(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return!!(yield this.tokenManager.getAccessToken())}))}isConnected(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return!!(yield this.tokenManager.getAccessToken())&&!this.tokenManager.isAccessTokenExpired({margin:24e5})}))}isReachable(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return!0}))}sendNotificationOnFailure(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield this.client.getDriveStorageQuota(),r=yield n();(t.limit&&t.usage>=t.limit||r.bytesWithBlobs+r.bytesWithoutBlobs>t.limit-t.usage)&&(e="drive_size_empty")}catch(t){e="backup_error"}return yield t.dispatchNotification(e),e}))}handleLoginRedirectedBack(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield fetch(e),{profile:n,accessToken:r,refreshToken:i,expiresInSeconds:o}=yield t.json();yield this.tokenManager.handleNewTokens({accessToken:r,refreshToken:i,expiresInSeconds:o})}))}backupChanges({changes:e,events:t,currentSchemaVersion:n,options:i}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{images:t,changes:r}=yield dt(e);yield this.client.storeObject({folderName:"change-sets",fileName:Date.now().toString(),object:{version:n,changes:r}}),ht(t,i.storeBlobs)&&(yield this.client.storeObject({folderName:"images",fileName:Date.now().toString(),object:{version:n,images:t}}))}))}listObjects(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.tokenManager.refreshAccessToken();const t=yield this.client.getFolderChildId("appDataFolder",e);return t?Object.keys(yield this.client.listFolder(t)):[]}))}retrieveObject(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.tokenManager.refreshAccessToken();const n=yield this.client.getFolderChildId("appDataFolder",e),r=(yield this.client.listFolder(n))[t];return this.client.getFile(r,{json:!0})}))}}class mt extends lt{constructor(e){super(),this.deps=e}isConnected(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield Object(Ce.b)(this.deps),t=JSON.stringify({syncKey:e});try{const e=yield fetch(`${this.deps.url}/status`,{method:"POST",headers:{"Content-Type":"application/json"},body:t});return 200===e.status||(e.status,!1)}catch(e){return!1}}))}isAuthenticated(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.isConnected()}))}isReachable(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.isConnected()}))}storeObject({backupObject:e,events:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this._writeToPath(`${e.collection}/${encodeURIComponent(encodeURIComponent(e.pk))}`,JSON.stringify(e.object))}))}_writeToPath(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield Object(Ce.b)(this.deps),r=(yield this.deps.storageAPI.local.get("PKMSYNCpkmFolders")).PKMSYNCpkmFolders.backupFolder;let i=JSON.parse(t);i.syncKey=n,i.backupPath=r,i=JSON.stringify(i);try{const t=yield fetch(`${this.deps.url}/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:i});if(!t.ok)throw new Error(`Failed to write to path: ${t.statusText}`)}catch(e){throw console.error(e),e}}))}deleteObject({backupObject:e,events:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){throw new Error("Not yet implemented  :(")}))}backupChanges({changes:e,events:t,currentSchemaVersion:n,options:i}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=e=>JSON.stringify(e,null,4),{images:r,changes:o}=yield dt(e),s=Date.now();yield this._writeToPath(`backup/change-sets/${s}`,t({version:n,changes:o})),ht(r,i.storeBlobs)&&(yield this._writeToPath(`backup/images/${s}`,t({version:n,images:r})))}))}listObjects(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield fetch(`${this.deps.url}/backup/${e}`);if(404===t.status)return[];if(!t.ok)throw new Error(yield t.text());const n=yield t.text();if(n.length>0){const e=n.split(",");return e.length>0?e:[]}return[]}))}retrieveObject(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield fetch(`${this.deps.url}/backup/${e}/${t}`)).json()}))}}class yt{constructor(e){this.deps=e,this.serverToTalkTo=Fe.b}restoreBackend(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.restoreBackendLocation();return"local"===e?(this.saveBackendLocation("local"),this.initLocalBackend()):"google-drive"===e?(this.saveBackendLocation("google-drive"),this.initGDriveBackend()):void 0}))}initGDriveBackend(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return new gt({localBackupSettings:this.deps.localBackupSettings,tokenStore:new ct({localBackupSettings:this.deps.localBackupSettings,prefix:"drive-token-"}),memexCloudOrigin:Gt()})}))}initLocalBackend(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return new mt({url:this.serverToTalkTo,storageAPI:this.deps.storageAPI})}))}restoreBackendLocation(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.deps.storageAPI.local.get("backendInfo");if(e.backendInfo){return e.backendInfo.location}}))}saveBackendLocation(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.deps.storageAPI.local.set({backendInfo:{location:e}})}))}}const vt=(e,t)=>new Promise(((n,i)=>{let o={bytesWithBlobs:0,bytesWithoutBlobs:0};const s=e.transaction(t,"readonly").objectStore(t).openCursor();s.onsuccess=function(){const e=this.result;if(!e)return n(o);const i=e.value;if(null!=i){const e=function(e,t){if("pages"===e&&null!=t.screenshot){const{screenshot:e}=t,n=Object(r.__rest)(t,["screenshot"]),i=JSON.stringify(n).length;return{bytesWithBlobs:i+bt(e),bytesWithoutBlobs:i}}if("favIcons"===e&&null!=t.favIcon){const{favIcon:e}=t,n=Object(r.__rest)(t,["favIcon"]),i=JSON.stringify(n).length+bt(e);return{bytesWithBlobs:i,bytesWithoutBlobs:i}}if(e===O&&null!=t.profilePic){const{profilePic:e}=t,n=Object(r.__rest)(t,["profilePic"]),i=JSON.stringify(n).length;return{bytesWithBlobs:i+bt(e),bytesWithoutBlobs:i}}const n=JSON.stringify(t).length;return{bytesWithBlobs:n,bytesWithoutBlobs:n}}(t,i);o=wt(o,e)}e.continue()},s.onerror=function(){i(this.error)}}));const bt=e=>4*Math.ceil(e.size/3),_t=({registry:e})=>Object.entries(e.collections).filter((([,e])=>!it(e))).map((([e])=>e)),wt=(e,t)=>({bytesWithBlobs:e.bytesWithBlobs+t.bytesWithBlobs,bytesWithoutBlobs:e.bytesWithoutBlobs+t.bytesWithoutBlobs}),Tt=(e,t)=>({bytesWithBlobs:e.bytesWithBlobs+e.bytesWithBlobs*(t/100),bytesWithoutBlobs:e.bytesWithoutBlobs+e.bytesWithoutBlobs*(t/100)});var Et=({storageManager:e,indexedDB:t=globalThis.indexedDB,dbName:n="memex",estimateBoost:i=20})=>new Promise(((o,s)=>{let a={bytesWithBlobs:0,bytesWithoutBlobs:0};const c=_t(e),l=t.open(n);l.onsuccess=function(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=this.result;for(const t of c){const n=yield vt(e,t);a=wt(a,n)}o(Tt(a,i))}))},l.onerror=function(){s(this.error)}})),At=n(53),St=n(167);const Ot=n(1058);class It{constructor({localBackupSettings:e,storageManager:t,storageAPI:n,storage:i,backend:o}){this._backupChanges=(e,t,n)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){for(const t of e.changes){const e=Ot(yield this.storageManager.operation(A.b.FIND_BY_PK_OP,{collection:t.collection,pk:t.objectPk}),((e,t)=>"terms"!==t&&-1===t.indexOf("_terms")));t.object=e}{const t=!!(yield this.localBackupSettings.get("saveBlobs"));yield this.pkmBackend.backupChanges({changes:e.changes,events:n,currentSchemaVersion:this.currentSchemaVersion,options:{storeBlobs:t}})}yield e.forget(),t.processedChanges+=e.changes.length})),this.localBackupSettings=e,this.storageManager=t,this.storage=i,this.backend=o,this.pkmBackend=new mt({url:Fe.b,storageAPI:n}),this.currentSchemaVersion=Object(St.c)(t).getTime(),this.reset()}reset(){this.running=!1,this.info=null,this.events=null}pause(){this.info&&"synching"===this.info.state&&(this.info.state="paused",this.pausePromise=new Promise((e=>{this.resolvePausePromise=e})),this.events.emit("info",this.info))}resume(){this.info&&"paused"===this.info.state&&(this.info.state="synching",this.pausePromise=null,this.resolvePausePromise(),this.resolvePausePromise=null,this.events.emit("info",this.info))}cancel(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.events=null,this.info.state="cancelled",yield this.completionPromise,yield this.storage.forgetAllChanges(),yield new Promise((e=>{setTimeout(e,1e3)}))}))}run(){let e;this.running=!0,this.events=new At.EventEmitter,this.info={state:"preparing",totalChanges:null,processedChanges:null},this.completionPromise=new Promise((t=>{e=t}));const t=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.localBackupSettings.get("lastBackup");if(yield this.backend.startBackup({events:this.events}),!e){console.log("no last backup found, putting everything in backup table"),console.time("put initial backup into changes table");try{this.events.emit("info",this.info),yield this.storage.forgetAllChanges(),yield this._queueInitialBackup()}catch(e){throw Ve.b(e),e}finally{console.timeEnd("put initial backup into changes table")}}const t=new Date;yield this._doIncrementalBackup(t,this.events),yield this.localBackupSettings.set("lastBackup",t.toString()),yield this.localBackupSettings.set("lastBackupFinished",t.toString())}));setTimeout((()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){t().then((()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){this.running=!1,this.events&&this.events.emit("success"),yield this.localBackupSettings.set("backupStatus","success"),yield this.localBackupSettings.set("backupStatusId","success"),this.reset(),e()})))).catch((t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){this.running=!1,Ve.b(t),console.error(t),console.error(t.stack);const n=yield this.localBackupSettings.get("backupStatus");"success"!==n&&"no_backup"!==n||(yield this.localBackupSettings.set("backupStatus","fail"),yield this.localBackupSettings.set("backupStatusId","backup_error")),this.events&&this.events.emit("fail",t),this.reset(),e()}))))}))),200)}_queueInitialBackup(e=1e3){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=this._getCollectionsToBackup().map((e=>e.name));yield this.storageManager.operation(A.a.QUEUE_CHANGES,{collections:t,chunkSize:e})}))}_doIncrementalBackup(e,t){var n,i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const o=this._getCollectionsToBackup(),s=this.info=yield this._createBackupInfo(o,e);t.emit("info",{info:s});try{for(var a,c=Object(r.__asyncValues)(this.storage.streamChanges(e,{batchSize:parseInt("500",10)}));!(a=yield c.next()).done;){const e=a.value;if("paused"===this.info.state&&(yield this.pausePromise),"cancelled"===this.info.state)break;yield this._backupChanges(e,s,t),t.emit("info",{info:s})}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=c.return)&&(yield i.call(c))}finally{if(n)throw n.error}}yield this.localBackupSettings.remove("runningBackup")}))}_getCollectionsToBackup(){return Object.entries(this.storageManager.registry.collections).filter((([e,t])=>!it(t))).map((([e,t])=>({name:e,version:t.version})))}_createBackupInfo(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n={state:"synching",totalChanges:0,processedChanges:0},i=yield Promise.all(e.map((({name:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return[e,yield this.storage.countQueuedChangesByCollection(e,t)]})))));for(const[e,t]of i)console.log("no. of queued changed to %s: %d",e,t),n.totalChanges+=t;return n}))}}class Ct{constructor(){this.cancelled=!1,this.paused=!1}cancel(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.cancelled=!0}))}pause(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.paused||this.cancelled||(this.paused=!0,this.pausePromise=new Promise((e=>{this.resolvePausePromise=e})))}))}resume(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.paused=!1,this.pausePromise=null,this.resolvePausePromise(),this.resolvePausePromise=null}))}whileLoop(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!this.cancelled)for(;(yield e())&&!(yield this._shouldCancelAfterWaitingForPause());)yield t()}))}forOfLoop(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){for(const n of e){if(yield this._shouldCancelAfterWaitingForPause())break;yield t(n)}}))}execute(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!(yield this._shouldCancelAfterWaitingForPause()))return e()}))}_shouldCancelAfterWaitingForPause(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.paused&&(yield this.pausePromise),this.cancelled}))}}class kt{constructor({items:e,fetcher:t=fetch,concurrency:n=1}){this.downloads=[],this.consumed=0,this.items=e,this.fetcher=t,this.concurrency=n,this.queueNext()}get hasFreeDownloadSlots(){return this.downloads.reduce(((e,t)=>e+(null!=t?1:0)),0)<this.concurrency}downloadNext(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=this.items.shift(),t=yield this.fetcher(e);return this.queueNext(),t}))}queueNext(){if(this.items.length&&this.hasFreeDownloadSlots){const e=this.downloads.length;this.downloads.push(this.downloadNext().then((t=>()=>(this.downloads[e]=null,this.queueNext(),t))))}}getNext(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!this.hasNext())return null;this.queueNext();return this.downloads[this.consumed++].then((e=>e()))}))}hasNext(){return!!this.items.length||!!this.downloads.length&&!!this.downloads[this.downloads.length-1]}}function Pt(e,t){const n=t&&t.blobClass||Blob,r=t&&t.atobFunction||atob,i=e.match(/^data:((.*?)(;charset=.*?)?)(;base64)?,/);if(!i)throw new Error("invalid dataURI");const o=i[2]?i[1]:"text/plain"+(i[3]||";charset=utf-8"),s=!!i[4],a=e.slice(i[0].length),c=s?r(a):decodeURIComponent(a),l=[];for(let e=0;e<c.length;++e)l.push(c.charCodeAt(e));return new n([new Uint8Array(l)],{type:o})}var xt=n(889),Rt=n.n(xt),Lt=n(1242),Dt=n.n(Lt);class Nt{constructor({storageManager:e,storage:t,backend:n,logErrors:r=!0}){this.info=null,this.storageManager=e,this.storage=t,this.backend=n,this.logErrors=r}get running(){return!!this.interruptable}runner(){this.events=new At.EventEmitter,this.interruptable=new Ct;return()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){this._updateInfo({status:"preparing",processedChanges:0});try{this._stopRecordingChanges(),yield this._clearDatabase(),yield this._blockDatabase();const[e,t]=yield Promise.all([this._listBackupCollection("change-sets"),this._listBackupCollection("images")]);if(!e.length)throw yield this._unblockDatabase(),new Error("Backup file not found");return this._updateInfo({status:"synching",totalChanges:e.length+t.length}),yield this.interruptable.execute((()=>this._restoreCollection("change-sets",e,"changes",this._writeChange.bind(this)))),yield this.interruptable.execute((()=>this._restoreCollection("images",t,"images",this._writeImage.bind(this)))),yield this._unblockDatabase(),this.interruptable.cancelled?(yield this._clearDatabase(),this.events.emit("cancelled"),"cancelled"):(this._startRecordingChanges(),this.events.emit("success"),"success")}catch(e){return this.logErrors&&console.error(e),Ve.b(e),this.events.emit("fail",{error:e.message}),"fail"}finally{this.interruptable=null,this.events=null,this.info=null}}))}_startRecordingChanges(){this.storage.startRecordingChanges()}_stopRecordingChanges(){this.storage.stopRecordingChanges()}_clearDatabase(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){var e;yield(e=this.storageManager,Object(r.__awaiter)(void 0,void 0,void 0,(function*(){return e.operation(A.b.NUKE_DB_OP)})))}))}_blockDatabase(){}_restoreCollection(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=this._createDownloadQueue(e,t);yield this._restoreFromDownloadQueue(r,n,i)}))}_restoreFromDownloadQueue(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.interruptable.whileLoop((()=>e.hasNext()),(()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield e.getNext();yield this.interruptable.forOfLoop(t.changes||t.images,(e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield n(e)})))),this._updateInfo({processedChanges:this.info.processedChanges+1})}))))}))}_unblockDatabase(){}_writeChange(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){e=this._filterBadChange(e),this._deserializeChangeFields(e),function(e){const t=e.object,n=n=>{e.collection===n.collection&&(t[n.field]=n.value(t))};n({collection:"annotations",field:"lastEdited",value:e=>e.createdWhen})}(e);const t=this.storageManager.collection(e.collection);"create"===e.operation?yield t.createObject(e.object):"update"===e.operation?yield t.updateObjects(this._getChangeWhere(e),e.object):"delete"===e.operation&&(yield t.deleteObjects(this._getChangeWhere(e)))}))}_writeImage(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!e||!e.data)return;const t=this.storageManager.collection(e.collection),n=this._getChangeWhere(e),r={$set:{[e.type]:this._blobFromPngString(e.data)}};try{yield t.updateOneObject(n,r)}catch(t){Ve.b(t),console.error("Failed to commit image",n,e,r)}}))}_createDownloadQueue(e,t){const n=Rt()(t).map((t=>[e,t]));return new kt({items:n,fetcher:this._createBackupObjectFetcher()})}_listBackupCollection(e){return this.backend.listObjects(e)}_createBackupObjectFetcher(){return([e,t])=>this.backend.retrieveObject(e,t)}_updateInfo(e){this.info=Object.assign(Object.assign({},this.info),e),this.events.emit("info",{info:this.info})}_getChangeWhere(e){const t=this.storageManager.registry.collections[e.collection].pkIndex;return t instanceof Array?Dt()(t,e.objectPk||e.pk):"string"==typeof t?{[t]:e.objectPk||e.pk}:void 0}_filterBadChange(e){var{object:t}=e,n=Object(r.__rest)(e,["object"]);if("delete"!==n.operation&&null!=t&&0===Object.entries(t).length)return Object.assign(Object.assign({},n),{object:t,operation:null});if("pages"===n.collection&&null!=t&&this._isBadBlob(t.screenshot)){const{screenshot:e}=t,i=Object(r.__rest)(t,["screenshot"]);return Object.assign(Object.assign({},n),{object:i})}if("favIcons"===n.collection&&null!=t&&this._isBadBlob(t.favIcon))return Object.assign(Object.assign({},n),{object:t,operation:null});if(n.collection===O&&null!=t&&this._isBadBlob(t.profilePic)){const{profilePic:e}=t,i=Object(r.__rest)(t,["profilePic"]);return Object.assign(Object.assign({},n),{object:i})}return Object.assign(Object.assign({},n),{object:t})}_isBadBlob(e){return!(null==e||e instanceof this._getBlobClass()||Object.keys(e).length)}_getBlobClass(){return Blob}_getAtobFunction(){return atob}_deserializeChangeFields(e){const t=e.object,n=(n,r)=>n.includes(e.collection)&&!!t[r]&&"string"==typeof t[r];n(["favIcons"],"favIcon")&&(t.favIcon=this._blobFromPngString(t.favIcon)),n(["annotations",S],"createdWhen")&&(t.createdWhen=new Date(t.createdWhen)),n(["annotations"],"lastEdited")&&(t.lastEdited=new Date(t.lastEdited)),n(["customLists","pageListEntries",S,"socialBookmarks"],"createdAt")&&(t.createdAt=new Date(t.createdAt))}_blobFromPngString(e){const t="data:";return e.substr(0,5)!==t&&(e="data:image/png;base64,"+e),Pt(e,{blobClass:this._getBlobClass(),atobFunction:this._getAtobFunction()})}}class jt{constructor(e){this.eventName=e,this._uiTabIds={}}registerUiTab(e){this._uiTabIds[e.id]=!0}sendEvent(e,t){var n;for(const r of Object.keys(this._uiTabIds))try{(null!==(n=globalThis.browser)&&void 0!==n?n:globalThis.chrome).tabs.sendMessage(parseInt(r,10),{type:this.eventName,event:Object.assign({type:e},t||{})})}catch(e){delete this._uiTabIds[r]}}connect(e,t=null){for(const n of["info","fail","success"])e.on(n,(e=>{t?t(n,e):this.sendEvent(n,e)}))}}var Mt=n(583);function Ft(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=setInterval(t.runtimeAPI.getPlatformInfo,25e3);try{return yield e}finally{clearInterval(n)}}))}const Ut="automated-legacy-data-backup";class Bt{constructor(e){this.options=e,this.backupUiCommunication=new jt("backup-event"),this.restoreUiCommunication=new jt("restore-event"),this.automaticBackupTimeout=null,this.isAutomaticBackupAllowed=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.checkAuthorizedForAutoBackup()})),this.isAutomaticBackupEnabled=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var e;return null!==(e=yield this.localBackupSettings.get("automaticBackupsEnabled"))&&void 0!==e&&e})),this.enableAutomaticBackup=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.localBackupSettings.set("automaticBackupsEnabled",!0)})),this.disableAutomaticBackup=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.localBackupSettings.set("automaticBackupsEnabled",!1)})),e.createQueue=e.createQueue||tt.a,e.queueOpts=e.queueOpts||{autostart:!0,concurrency:1},this.backendSelect=new yt({storageAPI:e.browserAPIs.storage,localBackupSettings:e.localBackupSettings}),this.storageManager=e.storageManager,this.storage=new ot({storageManager:e.storageManager}),this.changeTrackingQueue=e.createQueue(e.queueOpts),this.notifications=e.notifications,this.checkAuthorizedForAutoBackup=e.checkAuthorizedForAutoBackup,this.localBackupSettings=e.localBackupSettings,this.remoteFunctions={enableAutomaticBackup:this.enableAutomaticBackup,disableAutomaticBackup:this.disableAutomaticBackup,isAutomaticBackupEnabled:this.isAutomaticBackupEnabled,isAutomaticBackupAllowed:this.isAutomaticBackupAllowed,disableRecordingChanges:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){this.storage.stopRecordingChanges(),yield this.disableAutomaticBackup(),yield this.localBackupSettings.set("lastBackup",null)})),getBackupTimes:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.getBackupTimes()})),startBackup:({tab:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){if(this.backupUiCommunication.registerUiTab(t),!this.backupProcedure.running){if(this.restoreProcedure&&this.restoreProcedure.running)throw new Error("Come on, don't be crazy and run backup and restore at once please");yield Ft(this.doBackup(),{runtimeAPI:e.browserAPIs.runtime}),this.backupUiCommunication.connect(this.backupProcedure.events)}}))}}setupRemoteFunctions(){Object(a.d)(Object.assign(Object.assign({},this.remoteFunctions),{getBackupProviderLoginLink:(e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return`${Gt()}/auth/google?scope=${pt}`})),initRestoreProcedure:(e,t)=>this.initRestoreProcedure(t),getBackupInfo:()=>this.backupProcedure.info,pauseBackup:()=>{this.backupProcedure.pause()},resumeBackup:()=>{this.backupProcedure.resume()},cancelBackup:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.backupProcedure.cancel()})),startRestore:({tab:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){this.restoreUiCommunication.registerUiTab(e),yield this.startRestore()})),getRestoreInfo:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.restoreProcedure.info})),pauseRestore:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.restoreProcedure.interruptable.pause()})),resumeRestore:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.restoreProcedure.interruptable.resume()})),cancelRestore:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.restoreProcedure.interruptable.cancel()})),hasInitialBackup:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return null!=(yield this.localBackupSettings.get("lastBackup"))})),setBackendLocation:(e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){"google-drive"===t&&this.backendLocation!==t?(this.backendLocation=t,yield this.backendSelect.saveBackendLocation(t),this.backend=yield this.backendSelect.initGDriveBackend()):"local"===t&&this.backendLocation!==t&&(this.backendLocation=t,yield this.backendSelect.saveBackendLocation(t),this.backend=yield this.backendSelect.initLocalBackend()),this.initBackendDependants()})),getBackendLocation:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.backendLocation=yield this.backendSelect.restoreBackendLocation(),this.backendLocation})),isBackupBackendAuthenticated:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.restoreProcedure&&null!=this.restoreProcedure.backend?this.restoreProcedure.backend.isAuthenticated():null!=this.backend&&this.backend.isAuthenticated()})),sendNotification:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.backend.sendNotificationOnFailure(e,this.notifications,(()=>this.estimateInitialBackupSize()))})),estimateInitialBackupSize:()=>this.estimateInitialBackupSize(),setBackupBlobs:(e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.localBackupSettings.set("saveBlobs",t)})),forgetAllChanges:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.forgetAllChanges()}))}),{insertExtraArg:!0})}handlePostStorageChange(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){for(const t of e.info.changes)if("create"===t.type)this.storage.handleStorageChange({collection:t.collection,operation:"create",pk:t.pk});else for(const e of t.pks)this.storage.handleStorageChange({collection:t.collection,operation:"modify"===t.type?"update":"delete",pk:e})}))}estimateInitialBackupSize(){return Et({storageManager:this.storageManager})}setBackendFromStorage(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.backend=yield this.backendSelect.restoreBackend(),this.initBackendDependants()}))}initBackendDependants(){this.backupProcedure=new It({localBackupSettings:this.localBackupSettings,storageManager:this.storageManager,storageAPI:this.options.browserAPIs.storage,storage:this.storage,backend:this.backend})}initRestoreProcedure(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t=null;"local"===e?t=yield this.backendSelect.initLocalBackend():"google-drive"===e&&(t=yield this.backendSelect.initGDriveBackend()),this.restoreProcedure=new Nt({storageManager:this.storageManager,storage:this.storage,backend:t})}))}resetRestoreProcedure(){this.restoreProcedure=null}startRecordingChangesIfNeeded(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){(yield this.localBackupSettings.get("lastBackup"))&&!this.storage.recordingChanges&&(this.storage.startRecordingChanges(),this.scheduleAutomaticBackup())}))}scheduleAutomaticBackup(){if(null!=this.automaticBackupTimeout||this.backupProcedure&&this.backupProcedure.running)return;this.scheduledAutomaticBackupTimestamp=Date.now()+9e5,this.options.browserAPIs.alarms.create(Ut,{delayInMinutes:15}),this.automaticBackupTimeout=-1}clearAutomaticBackupTimeout(){null!=this.automaticBackupTimeout&&(this.options.browserAPIs.alarms.clear(Ut),this.automaticBackupTimeout=null)}forgetAllChanges(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.storage.forgetAllChanges(),yield this.localBackupSettings.remove("lastProblemNotifShown")}))}getBackupTimes(){var e;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.localBackupSettings.get("lastBackupFinished");let n=null;if((null===(e=this.backupProcedure)||void 0===e?void 0:e.running)?n="running":(yield this.isAutomaticBackupEnabled())&&(n=new Date(this.scheduledAutomaticBackupTimestamp)),t){return{lastBackup:null!=t?t:null,nextBackup:t&&n&&n.getTime?n.getTime():null}}return{lastBackup:null,nextBackup:null}}))}maybeShowBackupProblemNotif(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.localBackupSettings.get("lastBackupFinished");if(!t)return;if(new Date(t).getTime()>0){if(Date.now()-new Date(t).getTime()<864e5)return}const n=yield this.localBackupSettings.get("lastProblemNotifShown");if(n&&Date.now()-n.getTime()<6048e5)return;const r=!!n&&new Date(n)>new Date(t);yield this.showBackupProblemNotif(e,{storeNotif:!r})}))}showBackupProblemNotif(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.notifications.dispatchNotification(e,{dontStore:!t.storeNotif}),yield this.localBackupSettings.set("lastProblemNotifShown",new Date)}))}doBackup(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){(yield Object(Mt.a)({storageAPI:this.options.browserAPIs.storage}))||(yield this.localBackupSettings.set("backupStatus","fail")),this.clearAutomaticBackupTimeout();const e=()=>{this.scheduleAutomaticBackup()};if(this.storage.startRecordingChanges(),!(yield this.backend.isReachable()))return yield this.maybeShowBackupProblemNotif("incremental_backup_down"),e();try{this.backupProcedure.run()}catch(t){throw Ve.b(t),e(),t}this.backupProcedure.events.once("success",(()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.localBackupSettings.set("progressSuccessful",!0),e()})))),this.backupProcedure.events.once("fail",(()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.maybeShowBackupProblemNotif("backup_error"),e()}))))}))}prepareRestore(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.clearAutomaticBackupTimeout();const e=this.restoreProcedure.runner();return this.restoreProcedure.events.once("success",(()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.startRecordingChangesIfNeeded(),this.scheduleAutomaticBackup(),this.resetRestoreProcedure()})))),e}))}startRestore({debug:e=!1}={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(this.restoreProcedure.running)return;if(this.backupProcedure.running)throw new Error("Come on, don't be crazy and run backup and restore at once please");const t=yield this.prepareRestore();e?this.restoreUiCommunication.connect(this.restoreProcedure.events,((e,t)=>{})):this.restoreUiCommunication.connect(this.restoreProcedure.events),t()}))}}function Gt(){return"https://memex.cloud"}var qt=n(16),Ht=n.n(qt),$t=n(1074),Wt=n.n($t),zt=n(705);function Vt(e,t){if(!(null==e?void 0:e.length))return"";const{document:n}=Object(zt.a)(e),r=new Wt.a({headingStyle:"atx",hr:"---",codeBlockStyle:"fenced"});null==t||t(r);let i=r.turndown(n);return i=i.replace(/\\(.)/g,"$1"),i}var Kt=n(780);class Yt{constructor(e){this.deps=e,this.PKMSYNCremovewarning=!0,this.serverToTalkTo=Fe.b,this.getSystemArchAndOS=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){let e,t;return yield this.deps.browserAPIs.runtime.getPlatformInfo().then((function(n){e=n.os,t=n.arch})),"aarch64"!==t&&"arm"!==t&&"arm64"!==t||(t="arm"),"x86-64"===t&&(t="x64"),{arch:t,os:e}})),this.checkConnectionStatus=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.backendNew.isReadyToSync()})),this.loadFeedSources=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=new Me.a({storageAPI:this.deps.browserAPIs.storage,url:this.serverToTalkTo});return yield e.loadFeedSources()})),this.addFeedSources=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=new Me.a({storageAPI:this.deps.browserAPIs.storage,url:this.serverToTalkTo});yield t.addFeedSources(e)})),this.openLocalFile=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=new Me.a({storageAPI:this.deps.browserAPIs.storage,url:this.serverToTalkTo});yield t.openLocalFile(e)})),this.removeFeedSource=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=new Me.a({storageAPI:this.deps.browserAPIs.storage,url:this.serverToTalkTo});yield t.removeFeedSource(e)})),this.removeLocalFolder=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=new Me.a({storageAPI:this.deps.browserAPIs.storage,url:this.serverToTalkTo});yield t.removeLocalFolder(e)})),this.addLocalFolder=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=new Me.a({storageAPI:this.deps.browserAPIs.storage,url:this.serverToTalkTo});return yield e.addLocalFolder()})),this.getLocalFolders=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=new Me.a({storageAPI:this.deps.browserAPIs.storage,url:this.serverToTalkTo});return yield e.getLocalFolders()})),this.checkFeedSource=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){try{let t={feedUrl:null,feedTitle:null,feedFavIcon:null};const n=yield fetch(e),r=yield n.text(),i=n.headers.get("content-type"),o=r.includes("<feed xml"),s=(null==i?void 0:i.includes("rss"))||(null==i?void 0:i.includes("xml"));if(o){const n=r.match(/<title>(.*?)<\/title>/)[1];return t.feedTitle=n,t.feedUrl=e,t}if(s){t.feedUrl=e;const n=r.match(/<title>(.*?)<\/title>/)[1];return t.feedTitle=n,t}{const n=new URL(e);e=`${n.protocol}//${n.hostname}/feed`,t.feedUrl=e;const r=yield fetch(e),i=r.headers.get("content-type");if(i&&(i.includes("rss")||i.includes("xml"))){const e=(yield r.text()).match(/<title>(.*?)<\/title>/)[1];return t.feedTitle=e,t}throw new Error("not-found")}}catch(t){console.error(`Error checking feed source: ${e}`,t)}})),this.backendNew=new Me.a({storageAPI:e.browserAPIs.storage,url:this.serverToTalkTo}),this.remoteFunctions={addFeedSources:this.addFeedSources,checkConnectionStatus:this.checkConnectionStatus,loadFeedSources:this.loadFeedSources,checkFeedSource:this.checkFeedSource,removeFeedSource:this.removeFeedSource,openLocalFile:this.openLocalFile,addLocalFolder:this.addLocalFolder,getLocalFolders:this.getLocalFolders,removeLocalFolder:this.removeLocalFolder,getSystemArchAndOS:this.getSystemArchAndOS}}setupRemoteFunctions(){Object(a.d)(Object.assign({},this.remoteFunctions))}pushRabbitHoleUpdate(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(yield this.backendNew.isConnected()){const t={createdWhen:e.createdWhen,creatorId:e.creatorId,pageTitle:e.pageTitle,fullUrl:e.fullUrl,contentType:e.contentType,fullHTML:e.fullHTML};yield this.backendNew.vectorIndexDocument(t)}}))}pushPKMSyncUpdate(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(yield this.backendNew.isConnected()){const n=yield this.getBufferedItems();n.push(e);const r=yield this.deps.browserAPIs.storage.local.get("PKMSYNCremovewarning");this.PKMSYNCremovewarning=r.PKMSYNCremovewarning;for(const e of n)yield this.processChanges(e,t)}else yield this.bufferPKMSyncItems(e)}))}applySyncFilters(e,t,n){var i,o,s,a,c;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=t.data.annotationSpaces||t.data.pageSpaces;if("obsidian"===e){const e=yield this.deps.browserAPIs.storage.local.get("PKMSYNCfilterTagsObsidian");return!(!r||!(null===(i=e.PKMSYNCfilterTagsObsidian)||void 0===i?void 0:i.includes(r)))||!(n&&(null===(o=e.PKMSYNCfilterTagsObsidian)||void 0===o?void 0:o.length)>0&&!(yield n("annotation"===t.type?t.data.annotationId:t.data.pageUrl,e.PKMSYNCfilterTagsObsidian)))&&!(null==n&&(null===(s=e.PKMSYNCfilterTagsObsidian)||void 0===s?void 0:s.length)>0)}if("logseq"===e){const e=yield this.deps.browserAPIs.storage.local.get("PKMSYNCfilterTagsLogseq");return!(!r||!e.PKMSYNCfilterTagsLogseq.includes(r))||!(n&&(null===(a=e.PKMSYNCfilterTagsLogseq)||void 0===a?void 0:a.length)>0&&!(yield n("annotation"===t.type?t.data.annotationId:t.data.pageUrl,e.PKMSYNCfilterTagsLogseq)))&&!(null==n&&(null===(c=e.PKMSYNCfilterTagsObsidian)||void 0===c?void 0:c.length)>0)}}))}bufferPKMSyncItems(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=(yield this.deps.browserAPIs.storage.local.get("PKMSYNCbufferedItems")).PKMSYNCbufferedItems||[];(null==t?void 0:t.length)>2e3?yield this.deps.browserAPIs.storage.local.set({PKMSYNCbufferMaxReached:!0}):(t.push(e),yield this.deps.browserAPIs.storage.local.set({PKMSYNCbufferedItems:t}))}))}getBufferedItems(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=(yield this.deps.browserAPIs.storage.local.get("PKMSYNCbufferedItems")).PKMSYNCbufferedItems||[];return yield this.deps.browserAPIs.storage.local.remove("PKMSYNCbufferedItems"),e}))}getValidFolders(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=(yield this.deps.browserAPIs.storage.local.get("PKMSYNCpkmFolders")).PKMSYNCpkmFolders||{};return{logSeq:!!e.logSeqFolder,obsidian:!!e.obsidianFolder}}))}processChanges(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getValidFolders();if(n.logSeq){if(!(yield this.applySyncFilters("logseq",e,t)))return;const n=yield this.deps.browserAPIs.storage.local.get("PKMSYNCtitleformatLogseq"),r=yield this.deps.browserAPIs.storage.local.get("PKMSYNCdateformatLogseq"),i=yield this.deps.browserAPIs.storage.local.get("PKMSYNCcustomTagsLogseq");e.data.pageTitle=this.cleanFileName(e.data.pageTitle,!1,!0);try{yield this.createPageUpdate(e,"logseq",r.PKMSYNCdateformatLogseq,i.PKMSYNCcustomTagsLogseq,n.PKMSYNCtitleformatLogseq)}catch(e){console.error("error",e)}}if(n.obsidian){if(!(yield this.applySyncFilters("obsidian",e,t)))return;const n=yield this.deps.browserAPIs.storage.local.get("PKMSYNCtitleformatObsidian"),r=yield this.deps.browserAPIs.storage.local.get("PKMSYNCdateformatObsidian"),i=yield this.deps.browserAPIs.storage.local.get("PKMSYNCcustomTagsObsidian");e.data.pageTitle=this.cleanFileName(e.data.pageTitle,!1,!0);try{yield this.createPageUpdate(e,"obsidian",r.PKMSYNCdateformatObsidian,i.PKMSYNCcustomTagsObsidian,n.PKMSYNCtitleformatObsidian)}catch(t){this.bufferPKMSyncItems(e),console.error("error",t)}}}))}cleanFileName(e,t,n){let r=e;if(r=null==r?void 0:r.replace(/\(.*?\)/g,""),n)r=null==r?void 0:r.replace(/:/g," ");else if(!t){const e=/[#%&{}\\<>?:/$!'"@+`|=]/g;r=null==r?void 0:r.replace(e,"-")}return r=null==r?void 0:r.trim(),r}processPageTitleFormat(e,t,n){let r=e,i=this.cleanFileName(t,!1,!1);r=r.replace("{{{PageTitle}}}",i);const o=/{{{Date: "(.*?)"}}}/,s=r.match(o);if(s){const e=s[1],t=Ht()(n).format(e);r=r.replace(o,t)}return r.trim()}createPageUpdate(e,t,n,i,o){var s,a;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=this.processPageTitleFormat(o,e.data.pageTitle,e.data.pageCreatedWhen||e.data.createdWhen);let c,[l,u]=[null,null],d="";try{c=yield this.backendNew.retrievePage(r,t)}catch(e){}if(c)[l,u]=c.split("### Annotations\n"),"page"===e.type?l=this.extractAndUpdatePageData(l||this.pageObjectDefault(e.data.pageTitle,e.data.pageUrl,e.data.pageSpaces||null,null!==(s=e.data.pageCreatedWhen)&&void 0!==s?s:e.data.createdWhen,e.data.type,t,n,o),e.data.pageTitle||null,e.data.pageURL||null,e.data.pageSpaces||null,null!==(a=e.data.pageCreatedWhen)&&void 0!==a?a:e.data.createdWhen,e.data.type||null,t,n,i,o):"annotation"===e.type&&(u=yield this.replaceOrAppendAnnotation(u,e,t,n));else{let r=[],s="";i&&(i.includes(",")?i.split(",").map((e=>r.push(e.trim()))):r.push(i)),e.data.pageSpaces&&r.push(e.data.pageSpaces),e.data.annotationSpaces&&r.push(e.data.annotationSpaces),"obsidian"===t&&"page"===e.type&&(s=r.map((e=>` - "[[${e}]]"\n`)).join("")),"logseq"===t&&(s=r.map((e=>`[[${e}]]`)).join(" ")),"obsidian"===t&&"annotation"===e.type&&(s=r.map((e=>`[[${e}]]`)).join(", ")),l=this.pageObjectDefault(e.data.pageTitle,e.data.pageUrl,"page"===e.type?s:null,e.data.pageCreatedWhen||e.data.createdWhen,e.data.type,t,n,o),"annotation"!==e.type&&"note"!==e.type||(u=yield this.annotationObjectDefault(e.data.annotationId,e.data.body?Qt(e.data.body):"",e.data.comment,s,Ht()(e.data.createdWhen).format(`${n} hh:mma`),e.data.type,t,n))}return d=l+"### Annotations\n"+(u||""),yield this.backendNew.storeObject(r,d,t)}))}replaceOrAppendAnnotation(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let r,o;if("obsidian"===n&&null!=e){const o=`<span class="annotationStartLine" id="${t.data.annotationId}"></span>\n`,s=`<span class="annotationEndLine" id="${t.data.annotationId}"> --- </span>\n`;if(r=e.indexOf(o),-1!==r){const o=e.indexOf(s,r),a=e.slice(r,o),c=yield this.extractAndUpdateAnnotationData(a,t.data.annotationId,t.data.body,t.data.comment,t.data.annotationSpaces,t.data.createdWhen,t.data.type,n,i);return e.slice(0,r)+c+e.slice(o+(null==s?void 0:s.length))}}if("logseq"===n&&null!=e){let s=`- \x3c!-- NoteStartLine ${t.data.annotationId} --\x3e---\n`;const a=` \x3c!-- NoteEndLine ${t.data.annotationId} --\x3e\n\n`;if(r=e.indexOf(s),o=e.indexOf(a),-1!==o&&-1!==r){const s=e.slice(r,o),c=yield this.extractAndUpdateAnnotationData(s,t.data.annotationId,t.data.body,t.data.comment,t.data.annotationSpaces,t.data.createdWhen,t.data.type,n,i);return e.slice(0,r)+c+e.slice(o+(null==a?void 0:a.length))}}if(-1===r||null===e){const r=yield this.annotationObjectDefault(t.data.annotationId,t.data.body?Qt(t.data.body):"",t.data.comment,t.data.annotationSpaces?`[[${t.data.annotationSpaces}]]`:null,Ht()(t.data.createdWhen).format(`${i} hh:mma`),t.data.type,n,i);return e?e+r:r}}))}extractAndUpdateAnnotationData(e,t,n,i,o,s,a,c,l){var u,d;return Object(r.__awaiter)(this,void 0,void 0,(function*(){let r,h=e,f=null;if("obsidian"===c){const e=`<span class="annotationStartLine" id="${t}"></span>\n`,d=`<span class="annotationEndLine" id="${t}"> --- </span>\n`;let p;h=h.replace(e,""),h=h.replace(d,""),p=h.match(/> \s*(.+)\n\n/);const g="\x3c!-- Note --\x3e\n",m=h.indexOf(g),y=h.indexOf('\n<div id="end"/>\n\r');-1!==m&&-1!==y&&(f=h.slice(m+(null==g?void 0:g.length),y));const v=h.match(/<!-- Created at -->\n(.+)\n/),b=h.match(/<!-- Spaces -->\n(.+)\n\n/),_=null!==(u=Qt(n))&&void 0!==u?u:p?p[1]:null,w=i||f||null,T=(v?v[1]:null)||Ht()(s).format(`${l} hh:mma`),E=b?b[1].split(", ").map((e=>e.replace(/\[\[(.+)\]\]/,"$1"))):[];if(o){const e=E.indexOf(o);-1!==e?E.splice(e,1):E.push(o)}const A=E.map((e=>`[[${e}]]`)).join(", ");r=yield this.annotationObjectDefault(t,_,w,A,T,a,c,l)}if("logseq"===c){let e=h.match(/ - >\s*(.+)\n/);const u=h.match(/  - \*\*Note\*\* \n    - (.+)\n/),f=h.match(/Created at:\*\* (.+)\r/),p=h.match(/  - \*\*Spaces:\*\* (.+)\n/),g=null!==(d=Qt(n))&&void 0!==d?d:e?e[1]:null,m=i||(u?u[1]:null),y=(f?f[1]:null)||Ht()(s).format(`${l} hh:mma`),v=p?p[1].split(" ").map((e=>e.replace(/\[\[(.+)\]\]/,"$1"))):[];if(o){const e=v.indexOf(o);-1!==e?v.splice(e,1):v.push(o)}const b=v.map((e=>`[[${e}]]`)).join(" ");r=yield this.annotationObjectDefault(t,g,m,b,y,a,c,l)}return r}))}extractAndUpdatePageData(e,t,n,r,i,o,s,a,c,l){let u,d=i;if("obsidian"===s){const i=e.match(/Title: (.+)/),h=e.match(/Url: (.+)/),f=e.match(/Created at: (.+)/),p=(i?i[1]:null)||t,g=(h?h[1]:null)||n,m=(f?f[1]:null)||d;let y=e.split("\n"),v=y.findIndex((e=>e.startsWith("Spaces:"))),b=[];if(-1!==v)for(let e=v+1;e<(null==y?void 0:y.length);e++){let t=y[e].match(/^ - "\[\[(.+)\]\]"$/);if(!t)break;{let e=t[1];b.push(e)}}if(r){const e=b.indexOf(r);-1!==e?b.splice(e,1):b.push(r)}let _=[];if(c){_=c.split(","),_.map((e=>e.trim())).forEach((e=>{-1===b.indexOf(e)&&b.push(e)}))}const w=b.map((e=>` - "[[${e}]]"\n`)).join("");u=this.pageObjectDefault(p,g,w,m,o,s,a,l)}if("logseq"===s){const i=e.match(/pagetitle:: (.+)/),h=e.match(/pageurl:: (.+)/),f=e.match(/createdat:: (.+)/),p=(i?i[1]:null)||t,g=(h?h[1]:null)||n,m=(f?f[1]:null)||d;let y=[],v=e.split("\n").find((e=>e.startsWith("spaces::")));if(v){let e=v.match(/\[\[(.+?)\]\]/g);e&&(y=e.map((e=>e.slice(2,-2))))}let b=[];if(c){b=c.split(","),b.map((e=>e.trim())).forEach((e=>{-1===y.indexOf(e)&&y.push(e)}))}const _=y.indexOf(r);-1!==_?y.splice(_,1):y.push(r);const w=y.map((e=>`[[${e}]]`)).join(" ");u=this.pageObjectDefault(p,g,w,m,o,s,a,l)}return u}pageObjectDefault(e,t,n,r,i,o,s,a){let c,l,u,d,h,f=r,p="";return"obsidian"===o&&"number"==typeof f?f=`"[[${Ht.a.unix(f/1e3).format(s)}]]"`:"logseq"===o&&"number"==typeof f&&(f=`[[${Ht.a.unix(f/1e3).format(s)}]]`),"obsidian"===o?(c=`Title: ${e}\n`,l=`Url: ${t}\n`,u=`Created at: ${f}\n`,d=n?`Spaces: \n${n}`:"",h="---\n",p=this.PKMSYNCremovewarning?"":"```\n\u2757\ufe0fYou can edit this file, though be aware that updates via Memex to an individual highlight will overwrite the changes you made to it in here. For feedback, go to memex.garden/chatSupport.\n```\n",h+c+l+u+d+h+p):"logseq"===o?(l=`pageurl:: ${t}\n`,c=`pagetitle:: ${e}\n`,u=`createdat:: ${f}\n`,d=n?`spaces:: ${n}\n`:"",p=this.PKMSYNCremovewarning?"":"- ```\n\u2757\ufe0fYou can edit this file, though be aware that updates via Memex to an individual highlight will overwrite the changes you made to it in here. For feedback, go to memex.garden/chatSupport.\n```\n",c+l+u+d+p):void 0}annotationObjectDefault(e,t,n,i,o,s,a,c){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=Object(Kt.a)(n,"production"),s=Object(Kt.a)(t,"production");if("obsidian"===a){return`<span class="annotationStartLine" id="${e}"></span>\n`+(s?`> ${s.trim()}\n\n`:"")+(r?`\x3c!-- Note --\x3e\n${Qt(r)}\n<div id="end"/>\n\r`:"")+(i?`\x3c!-- Spaces --\x3e\n${i}\n\n`:"")+`\x3c!-- Created at --\x3e\n${o}\n`+`\r<span class="annotationEndLine" id="${e}"> --- </span>\n`}if("logseq"===a){let t="";t=s?` - > ${s}\n`:"";return`- \x3c!-- NoteStartLine ${e} --\x3e---\n`+t+(r?`  - **Note** \n    - ${Qt(r)}\n`:"")+(i?`  - **Spaces:** ${i}\n`:"")+`  - **Created at:** ${o}\r`+` \x3c!-- NoteEndLine ${e} --\x3e\n\n`}}))}}function Qt(e){let t=Vt(e,(e=>{e.addRule("paragraph",{filter:"p",replacement:function(e){return e.trim()+"\n"}})}));return t=t.replace(/[\\](?!\n)/g,""),t}var Xt=n(517),Jt=n(282);function Zt(e,t){return new Proxy({},{get:(n,r)=>n=>t(`${e}-${r}`,n)})}var en=n(24),tn=n(722);const nn=e=>{const t=e.toString(),n=Date.now().toString().length-t.length;return 0===n?e:n>0?(e=>{const t=e.toString(),n=Date.now().toString().length,r=t.length,i=t+"0".repeat(n-r);return Number.parseInt(i,10)})(e):n<0?(e=>{const t=e.toString(),n=Date.now().toString().length,r=t.slice(0,n);return Number.parseInt(r,10)})(e):e},rn=(e,t,...n)=>t?rn(((e,t)=>[].concat(...e.map((e=>t.map((t=>[].concat(e,t)))))))(e,t),...n):e,on=/^[0-9]+\s+\bmin\b/;var sn=e=>{const t=[],n=[],r=e.getElementsByTagName("h1"),i=e.getElementsByTagName("ul");for(const e of r)t.push(e.textContent);for(const[e,r]of Object.entries(i)){const i=r.getElementsByTagName("a");for(const r of i){if(!r.hasAttribute("href"))continue;const i=r.hasAttribute("tags")&&0!==r.getAttribute("tags").length?r.getAttribute("tags").split(","):[],o={url:r.getAttribute("href"),title:r.textContent||r.getAttribute("href"),tags:i.map((e=>e.trim().replace(/\s\s+/g," ").toLowerCase())).filter((e=>!e.match(on))),collections:t[e]?["Pocket-"+t[e]]:[],timeAdded:r.hasAttribute("time_added")?Number(r.getAttribute("time_added")):Date.now()};n.push(o)}}return n};const an=(e,t)=>{const n=e.hasAttribute("tags")&&0!==e.getAttribute("tags").length?e.getAttribute("tags").split(","):[];return{url:e.getAttribute("href"),title:e.textContent||e.getAttribute("href"),tags:n.map((e=>e.trim().replace(/\s\s+/g," ").toLowerCase())),collections:[t],timeAdded:e.hasAttribute("add_date")?Number(e.getAttribute("add_date")):Date.now()}},cn=(e,t=[],n="")=>{if("DT"===e.tagName){if(!["H3","H2","H1"].includes(e.children[0].tagName)){const r=Array.from(e.querySelectorAll("a")).filter((e=>e.hasAttribute("href"))).map((e=>an(e,n)));return t.concat(r)}{const r=""!==e.children[0].textContent?e.children[0].textContent:"Imported Bookmarks",i=""!==n?`${n} > ${r}`:r;if("DL"===e.children[1].tagName)return cn(e.children[1],t,i)}}else if("DL"===e.tagName)for(let r of e.children)"DT"===r.tagName&&(t=cn(r,t,n));return t};var ln=e=>(e=>["h1","h2","h3"].map((t=>e.querySelectorAll(`dl dt ${t} ~ dl dt a`).length)).some((e=>e>0)))(e)?cn(e.querySelector("dl"),[],""):(e=>rn(["h1","h2","h3"],["ul","ol"]).map((t=>e.querySelectorAll(`${t[0]}~${t[1]} li a`).length)).some((e=>e>0)))(e)?(e=>{let t=[];const n=[].concat(...["h1","h2","h3"].map((t=>Array.from(e.querySelectorAll(`body > ${t}`)))));for(let e of n){const n=""!==e.textContent?e.textContent:"Imported Bookmarks",r=Array.from(e.nextElementSibling.querySelectorAll("a")).filter((e=>e.hasAttribute("href"))).map((e=>an(e,n)));t=t.concat(r)}return t})(e):(e=>{const t=Array.from(e.getElementsByTagName("a"));return t.filter((e=>e.hasAttribute("href"))).map((e=>an(e,"Imported Bookmarks")))})(e),un=n(98);class dn{constructor({history:e=null,bookmarks:t=null,browserAPIs:n=null}){this._createHistParams=e=>Object.assign(Object.assign({},dn.DEF_HIST_PARAMS),{endTime:e,startTime:e-un.a}),this._history=e,this._bookmarks=t,this.browserAPIs=n}get ROOT_BM(){return{id:"firefox"===Object(Qe.a)()?"":"0"}}history(){return Object(r.__asyncGenerator)(this,arguments,(function*(){const e=Object(un.g)(Date.now())-dn.LOOKBACK_WEEKS*un.a;for(let t=Date.now();t>=e;t-=un.a)yield yield Object(r.__await)(this._history.search(this._createHistParams(t.valueOf())))}))}bookmarks(e=null){return Object(r.__asyncGenerator)(this,arguments,(function*(){e||(e=this.ROOT_BM);const t=(yield Object(r.__await)(this.browserAPIs.bookmarks.getChildren(e.id))).reduce(((e,t)=>{const n=t.url?"bms":"dirs",r=Object.assign(Object.assign({},t),t.parentId&&{parentId:t.parentId});return Object.assign(Object.assign({},e),{[n]:[...e[n],r]})}),{dirs:[],bms:[]});yield yield Object(r.__await)(t.bms);for(const e of t.dirs)yield Object(r.__await)(yield*Object(r.__asyncDelegator)(Object(r.__asyncValues)(this.bookmarks(e))))}))}parseFile(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let n,r=[];if(!t||!e)return r;if(t[en.h.OTHERS]===en.g.POCKET||t[en.h.OTHERS]===en.g.NETSCAPE)if(e.startsWith("data:text/html;base64,")){const t=e.split("data:text/html;base64,")[1],r=atob(t);n=Object(zt.a)(r).document}else n=yield(({url:e,timeout:t,responseType:n})=>new Promise(((r,i)=>{const o=new XMLHttpRequest;o.timeout=t,o.responseType=n,o.open("GET",e,!0),o.onload=()=>r(o.response),o.onerror=()=>i(o.statusText),o.send()})))({url:e,timeout:1e4,responseType:"document"});return t[en.h.OTHERS]===en.g.POCKET?r=sn(n):t[en.h.OTHERS]===en.g.NETSCAPE&&(r=ln(n)),r}))}}function hn(e,t){const n=[];for(let r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}dn.LOOKBACK_WEEKS=12,dn.DEF_HIST_PARAMS={text:"",maxResults:999999};class fn{constructor({browserAPIs:e,limits:t=fn.DEF_LIMITS,dataSources:n=new dn({browserAPIs:e}),existingKeySource:r}){this._filterItemsByUrl=(e,t)=>n=>{const r=new Map;for(const i of n)if(Object(tn.b)(i))try{const n=Object(D.c)(i.url);t.has(n)||(t.add(n),r.set(n,e(i)))}catch(e){continue}return r},this.limits=t,this._dataSources=n,this._existingKeys=r,this.initData()}set limits({histLimit:e=fn.DEF_LIMITS.histLimit,bmLimit:t=fn.DEF_LIMITS.bmLimit,servicesLimit:n=fn.DEF_LIMITS.servicesLimit}){this._histLimit=e,this._bmLimit=t,this._servicesLimit=n}get completedBmCount(){return this._bmKeys.size}get completedHistCount(){return this._histKeys.size-this.completedBmCount}get completedServicesCount(){return this._completedServicesKeys.size}initData(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.existingDataReady=new Promise(((e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield this._existingKeys();this._histKeys=t.histKeys,this._bmKeys=t.bmKeys,e()}catch(e){t(e)}})))),yield this.existingDataReady,this._servicesData=e?yield this._dataSources.parseFile(e,t):[],this._completedServicesKeys=new Set(this._servicesData.filter((e=>this._histKeys.has(Object(D.c)(e.url)))).map((e=>e.url)))}))}_iterateItems(e,t,n,i){return Object(r.__asyncGenerator)(this,arguments,(function*(){var o,s;let a=0;try{for(var c,l=Object(r.__asyncValues)(e);!(c=yield Object(r.__await)(l.next())).done;){const e=c.value,o=a,s=t(e);if(a+=s.size,a>=n)return yield Object(r.__await)(yield yield Object(r.__await)({data:fn._limitMap(s,n-o),type:i}));s.size&&(yield yield Object(r.__await)({data:s,type:i}))}}catch(e){o={error:e}}finally{try{c&&!c.done&&(s=l.return)&&(yield Object(r.__await)(s.call(l)))}finally{if(o)throw o.error}}}))}createImportItems(){return Object(r.__asyncGenerator)(this,arguments,(function*(){if(this._bmLimit>0){const t=this._filterItemsByUrl((e=en.h.BOOKMARK,t=>({browserId:t.id,url:t.url,title:t.title,collections:t.collections,timeAdded:t.dateAdded,parentId:t.parentId,type:e})),this._bmKeys);yield Object(r.__await)(yield*Object(r.__asyncDelegator)(Object(r.__asyncValues)(this._iterateItems(this._dataSources.bookmarks(),t,this._bmLimit,en.h.BOOKMARK))))}var e;if(this._servicesData&&this._servicesLimit>0){const e=this._filterItemsByUrl((e=>t=>Object.assign(Object.assign({},t),{type:e}))(en.h.OTHERS),new Set);yield Object(r.__await)(yield*Object(r.__asyncDelegator)(Object(r.__asyncValues)(this._iterateItems(hn(this._servicesData,10),e,this._servicesLimit,en.h.OTHERS))))}}))}}fn.DEF_LIMITS={histLimit:1/0,bmLimit:1/0,servicesLimit:1/0},fn._limitMap=(e,t)=>new Map([...e].slice(0,t));var pn=n(1080),gn=n.n(pn);class mn{constructor({initChunkSize:e=mn.DEF_CHUNK_SIZE}){this._getCurrChunkKey=()=>mn._getChunkKey(mn.STORAGE_PREFIX,this.storageKeyStack.length-1),this._getNextChunkKey=()=>mn._getChunkKey(mn.STORAGE_PREFIX,this.storageKeyStack.length),this._getNextErrChunkKey=()=>mn._getChunkKey(mn.ERR_STORAGE_PREFIX,this.errStorageKeyStack.length),this.chunkSize=e,this.ready=this._rehydrate()}static _getChunk(e,t=mn.DEF_CHUNK){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return{chunk:(yield g.a.storage.local.get({[e]:t}))[e],chunkKey:e}}))}get expired(){return this.calculatedAt<Date.now()-mn.DAY_IN_MS}set expired(e){!0===e&&(this.calculatedAt=0)}_rehydrate(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let e,t,n,i;try{const o=yield g.a.storage.local.get({[mn.ERR_STATE_STORAGE_KEY]:[],[mn.STATE_STORAGE_KEY]:[],[mn.ESTS_STORAGE_KEY]:mn.INIT_ESTS}),s=o[mn.ERR_STATE_STORAGE_KEY],a=o[mn.STATE_STORAGE_KEY],c=o[mn.ESTS_STORAGE_KEY],{calculatedAt:l}=c,u=Object(r.__rest)(c,["calculatedAt"]);e=a,t=s,n=u,i=l}catch(r){e=[],t=[],n=mn.INIT_ESTS,i=0}finally{this.storageKeyStack=e,this.errStorageKeyStack=t,this.counts=n,this.calculatedAt=i}}))}persistEsts(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.calculatedAt=Date.now(),yield g.a.storage.local.set({[mn.ESTS_STORAGE_KEY]:Object.assign(Object.assign({},e),{calculatedAt:this.calculatedAt})})}))}_splitChunks(e){const t=[...e],n=[];for(let e=0;e<t.length;e+=this.chunkSize){const r=new Map(t.slice(e,e+this.chunkSize));n.push(le(r))}return n}_diffAgainstStored(e,t){var n,i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){let o=[...e];try{for(var s,a=Object(r.__asyncValues)(this.getItems(!t));!(s=yield a.next()).done;){const{chunk:e}=s.value,t=new Set(gn()(e));o=o.filter((([e])=>!t.has(e)))}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=a.return)&&(yield i.call(a))}finally{if(n)throw n.error}}return new Map(o)}))}_fillCurrChunk(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=this._getCurrChunkKey(),{chunk:r}=yield mn._getChunk(n),i=Object.keys(r.entries).length,o=this.chunkSize-i;if(o<=0||t!==r.type)return e;const s=[...e].slice(0,o);return yield g.a.storage.local.set({[n]:Object.assign(Object.assign({},r),{entries:Object.assign(Object.assign({},r.entries),le(new Map(s)))})}),new Map([...e].slice(o))}))}_addChunk(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=this._getNextChunkKey();this.storageKeyStack.push(n),yield g.a.storage.local.set({[n]:{entries:e,type:t},[mn.STATE_STORAGE_KEY]:[...this.storageKeyStack]})}))}_checkErrExists(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){try{for(var i,o=Object(r.__asyncValues)(this.getErrItems());!(i=yield o.next()).done;){const{chunk:t}=i.value;if(new Set(gn()(t)).has(e))return!0}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&(yield n.call(o))}finally{if(t)throw t.error}}return!1}))}persistItems(e,t,n=!1){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let r=t===en.h.HISTORY||t===en.h.BOOKMARK?yield this._diffAgainstStored(e,n):e;const i=r.size;if(!i)return 0;this.storageKeyStack.length>0&&(r=yield this._fillCurrChunk(r,t));for(const e of this._splitChunks(r))yield this._addChunk(e,t);return i}))}getItems(e=!1){return Object(r.__asyncGenerator)(this,arguments,(function*(){for(const e of this.storageKeyStack){const{chunk:{entries:t}}=yield Object(r.__await)(mn._getChunk(e));yield yield Object(r.__await)({chunk:t,chunkKey:e})}e&&(yield Object(r.__await)(yield*Object(r.__asyncDelegator)(Object(r.__asyncValues)(this.getErrItems()))))}))}getErrItems(){return Object(r.__asyncGenerator)(this,arguments,(function*(){for(const e of this.errStorageKeyStack)yield yield Object(r.__await)(yield Object(r.__await)(mn._getChunk(e,{})))}))}removeItem(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{chunk:n}=yield mn._getChunk(e),i=n.entries,o=t,s=i[o],a=Object(r.__rest)(i,["symbol"==typeof o?o:o+""]);return null!=s&&(yield g.a.storage.local.set({[e]:Object.assign(Object.assign({},n),{entries:a})})),s}))}flagItemAsError(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(yield this._checkErrExists(e))return;let n;this.errStorageKeyStack.length?n=this.errStorageKeyStack[this.errStorageKeyStack.length-1]:(n=mn.ERR_STORAGE_PREFIX+"0",this.errStorageKeyStack.push(n));let{[n]:r}=yield g.a.storage.local.get({[n]:{}});gn()(r).length>=this.chunkSize&&(r={},n=this._getNextErrChunkKey(),this.errStorageKeyStack.push(n)),r[e]=t,yield g.a.storage.local.set({[n]:r,[mn.ERR_STATE_STORAGE_KEY]:this.errStorageKeyStack})}))}clear(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield g.a.storage.local.remove([...this.storageKeyStack,mn.STATE_STORAGE_KEY]),this.storageKeyStack=[]}))}}mn.ESTS_STORAGE_KEY="import-estimate-counts",mn.STATE_STORAGE_KEY="import-items-state",mn.ERR_STATE_STORAGE_KEY="import-err-items-state",mn.STORAGE_PREFIX="import-items-",mn.ERR_STORAGE_PREFIX="err-import-items-",mn.DAY_IN_MS=864e5,mn.DEF_CHUNK_SIZE=50,mn.INIT_ESTS={calculatedAt:0,completed:{[en.h.BOOKMARK]:0,[en.h.HISTORY]:0,[en.h.OTHERS]:0},remaining:{[en.h.BOOKMARK]:0,[en.h.HISTORY]:0,[en.h.OTHERS]:0}},mn.DEF_CHUNK={type:en.h.HISTORY,entries:{}},mn._getChunkKey=(e,t)=>e+t;class yn{constructor({storageManager:e,cacheBackend:t=new mn({}),itemCreator:n,browserAPIs:i}){this._includeErrs=!1,this.allowTypes=yn.DEF_ALLOW_TYPES,this.options={},this._cache=t,this._itemCreator=n||new fn({browserAPIs:i,existingKeySource:()=>function(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t,n;try{t=new Set(yield e.operation(A.b.GET_PKS_OP,{collection:"pages"})),n=new Set(yield e.operation(A.b.GET_PKS_OP,{collection:"bookmarks"}))}catch(e){Object(He.a)({histKeys:new Set,bmKeys:new Set})(e)}return{histKeys:t,bmKeys:n}}))}(e)}),this._initFromCache()}get counts(){return{completed:Object.assign({},this.completed),remaining:Object.assign({},this.remaining)}}set counts({completed:e,remaining:t}){this.completed=Object.assign({},e),this.remaining=Object.assign({},t)}_initFromCache(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this._cache.ready,this.counts=this._cache.counts}))}_markOffItem({type:e},t){this.remaining[e]-=1,t||(this.completed[e]+=1)}_calcCompletedCounts(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.completed={[en.h.HISTORY]:this._itemCreator.completedHistCount,[en.h.BOOKMARK]:this._itemCreator.completedBmCount,[en.h.OTHERS]:this._itemCreator.completedServicesCount}}))}_calcRemainingCounts(){var e,t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){let n=new Set;try{for(var i,o=Object(r.__asyncValues)(this._itemCreator.createImportItems());!(i=yield o.next()).done;){let{data:e,type:t}=i.value;t===en.h.BOOKMARK&&(n=new Set([...n,...e.keys()]));const r=yield this._cache.persistItems(e,t,this._includeErrs);this.remaining[t]+=r}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=o.return)&&(yield t.call(o))}finally{if(e)throw e.error}}}))}_calcCounts(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.clearItems(),yield this._itemCreator.initData(e,this.allowTypes),yield this._calcCompletedCounts(),yield this._calcRemainingCounts()}))}dirtyEstsCache(){this._cache.expired=!0}fetchEsts(e,t=!1,n=!1){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this._itemCreator.limits=t?yn.QUICK_MODE_ITEM_LIMITS:{},(this._cache.expired||e)&&(this._includeErrs=n,yield this._calcCounts(e),yield this._cache.persistEsts(this.counts),t&&this.dirtyEstsCache()),this.counts}))}fetchItems(e=!1){return Object(r.__asyncGenerator)(this,arguments,(function*(){yield Object(r.__await)(yield*Object(r.__asyncDelegator)(Object(r.__asyncValues)(this._cache.getItems(e))))}))}removeItem(e,t,n=!1){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this._cache.removeItem(e,t);return null!=r&&this._markOffItem(r,n),r}))}flagItemAsError(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.removeItem(e,t,!0);yield this._cache.flagItemAsError(t,n)}))}clearItems(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.counts=mn.INIT_ESTS,yield this._cache.clear()}))}}yn.QUICK_MODE_ITEM_LIMITS={histLimit:30,bmLimit:0},yn.DEF_ALLOW_TYPES={[en.h.HISTORY]:!1,[en.h.BOOKMARK]:!1,[en.h.OTHERS]:""};let vn=null;var bn=function(){return vn},_n=n(1243),wn=n.n(_n),Tn=n(712),En=n.n(Tn),An=n(73);new Set(["link","generated","keyword","keyword_generated","typed","auto_bookmark","manual_subframe","reload","auto_toplevel"]);class Sn{constructor(e){this.options=e,this.cancelled=!1,this.finished=!1}static makeInterruptedErr(){const e=new Error("Execution interrupted");return e.cancelled=!0,e}_checkCancelled(){if(this.cancelled)throw Sn.makeInterruptedErr()}_storeDocs({pageDoc:e,bookmark:t,visits:n=[],rejectNoContent:i=!0}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this._checkCancelled(),yield this.options.pages.addPage({pageDoc:e,visits:n,rejectNoContent:i})}))}_storeOtherData({url:e,spaceId:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(this._checkCancelled(),null!=t&&null!=e)try{if(!t)return void console.error(`No spaceId found for parentId: ${t}`);yield this.options.customListsModule.insertPageToList({id:t,url:e,suppressVisitCreation:!0,skipPageIndexing:!0})}catch(t){console.error(t,e)}}))}_processBookmark(e,t,n={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{url:n,title:r,parentId:i}=e,o=nn(e.timeAdded);yield this.options.pages.indexPage({fullUrl:e.url,skipUpdatePageCount:!0,metaData:{pageTitle:r}}),yield this.options.bookmarks.storage.createBookmarkIfNeeded(e.url,null!=o?o:Date.now());const s=t[i];return yield this._storeOtherData({url:e.url,spaceId:s}),this._checkCancelled(),{status:en.d.SUCC}}))}_processBookmarkWithTags(e,t,n={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=this._processBookmark(e,t,n),i=yield Object(Xe.a)(An.e,[]);return yield Object(Xe.b)(An.e,[...new Set([...i,...e.tags])]),this._checkCancelled(),r}))}_processService(e,t={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{url:t,title:n,spaceId:r}=e,i=nn(e.timeAdded);yield this.options.pages.indexPage({fullUrl:e.url}),yield this.options.bookmarks.storage.createBookmarkIfNeeded(e.url,null!=i?i:Date.now()),yield this._storeOtherData({url:t,spaceId:r});const o=yield Object(Xe.a)(An.e,[]);return yield Object(Xe.b)(An.e,[...new Set([...o])]),this._checkCancelled(),{status:en.d.SUCC}}))}process(e,t,n={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){switch(this._checkCancelled(),e.type){case en.h.BOOKMARK:return this._processBookmark(e,t,n);case en.h.OTHERS:return this._processService(e,n);default:throw new Error("Unknown import type")}}))}cancel(){this.cancelled=!0}}class On{constructor(e){var t,n,i;this.options=e,this.processors=[],this.stopped=!0,this._processItem=(e,t)=>([n,i])=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=new this._Processor({tagsModule:this.options.tagsModule,customListsModule:this.options.customListsModule,pages:this.options.pages,bookmarks:this.options.bookmarks}),o={type:i.type,url:i.url};try{if(this.stopped)throw this._Processor.makeInterruptedErr();this.processors[this._nextProcIndex()]=r;const e=yield r.process(i,t,this.options.stateManager.options);o.status=e.status}catch(e){if(e.cancelled)throw e;o.error=e.message}finally{r.finished=!0,this.stopped||(this._observer.next(o),o.error?yield this.options.stateManager.flagItemAsError(e,n):yield this.options.stateManager.removeItem(e,n))}})),this.concurrency=null!==(t=e.concurrency)&&void 0!==t?t:On.DEF_CONCURR,this._observer=null!==(n=e.observer)&&void 0!==n?n:On.DEF_OBSERVER,this._Processor=null!==(i=e.Processor)&&void 0!==i?i:Sn}set concurrency(e){e>0&&e<=On.CONCURR_LIMIT&&(this._concurrency=e,this.runConcurrent=wn()(e))}_nextProcIndex(){for(let e=0;e<this._concurrency;e++){const t=this.processors[e];if(null==t||t.finished)return e}return 0}_checkChunkTypeAllowed([e,t]){return!!this.options.stateManager.allowTypes[t.type]}start(){var e,t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.stopped=!1;try{for(var n,i=Object(r.__asyncValues)(this.options.stateManager.fetchItems());!(n=yield i.next()).done;){const{chunk:e,chunkKey:t}=n.value,r=Object.entries(e);if(!r.length||!this._checkChunkTypeAllowed(r[0]))continue;const i=r[0][1].type;let o=null;if(i===en.h.BOOKMARK){let e=null,t={};const n=yield this.options.customListsModule.fetchListByName({name:"Browser Bookmarks"});if(null==n){const n=yield this.options.customListsModule.createCustomList({name:"Browser Bookmarks"});t[-1]=n.localListId,e=n.localListId}else t[-1]=n.id,e=n.id;o=yield this.createSpaceTreeForBookmarkFolder(null,e,t)}try{yield this.runConcurrent.map(r,this._processItem(t,o))}catch(e){if(e.cancelled)break;console.error(e)}}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&(yield t.call(i))}finally{if(e)throw e.error}}this.stopped||this._observer.complete()}))}stop(){this.stopped=!0,this.processors.forEach((e=>null!=e&&e.cancel())),this.processors=[]}get ROOT_BM(){return{id:"firefox"===Object(Qe.a)()?"":"0"}}createSpaceTreeForBookmarkFolder(e=null,t=null,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){e||(e=this.ROOT_BM);const r=yield g.a.bookmarks.getChildren(e.id);for(const e of r){const{id:r,parentId:i,title:o,url:s}=e;if(!s){const s=yield this.options.customListsModule.fetchListByName({name:o});if(s){if((yield this.options.customListsModule.fetchListTreeById({id:s.id})).pathListIds.includes(n[-1])){n[i]=s.id;continue}}const{localListId:a}=yield this.options.customListsModule.createCustomList({name:o,parentListId:t});n[r]=a,yield this.createSpaceTreeForBookmarkFolder(e,a,n)}}return n}))}}On.CONCURR_LIMIT=20,On.DEF_CONCURR=1,On.DEF_OBSERVER={next:En.a,complete:En.a};class In{constructor(e){this.options=e,this._includeErrs=!1,this.itemObserver={next:e=>this.port.postMessage(Object.assign({cmd:en.a.NEXT},e)),complete:()=>{this.port.postMessage({cmd:en.a.COMPLETE}),this.setImportInProgressFlag(!1)}},this.messageListener=({cmd:e,payload:t})=>{switch(e){case en.a.START:return this.startImport(t.allowTypes,t.blobUrl,t.options);case en.a.RESUME:return this.importer.start();case en.a.PAUSE:return this.importer.stop();case en.a.CANCEL:return this.cancelImport();case en.a.FINISH:return this.finishImport();case en.a.RECALC:return this.recalcState(t.allowTypes,t.blobUrl);case en.a.SET_CONCURRENCY:return this.importer.concurrency=t;case en.a.SET_PROCESS_ERRS:return this.setProcessErrs(t);default:return console.error(`unknown command: ${e}`)}},this.port=e.port,this._quickMode=e.quick,this.importer=new On({concurrency:en.b,observer:this.itemObserver,stateManager:bn(),tagsModule:e.tagsModule,customListsModule:e.customListsModule,bookmarks:e.bookmarks,pages:e.pages}),e.port.onMessage.addListener(this.messageListener),e.port.onDisconnect.addListener((()=>this.importer.stop())),this.attemptRehydrate()}attemptRehydrate(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(yield this.getImportInProgressFlag())this.port.postMessage({cmd:en.a.PAUSE});else{const e=yield bn().fetchEsts([],this._quickMode);this.port.postMessage(Object.assign({cmd:en.a.INIT},e))}}))}setProcessErrs(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this._includeErrs=e,yield this.recalcState()}))}recalcState(e,t=null){return Object(r.__awaiter)(this,void 0,void 0,(function*(){bn().dirtyEstsCache(),bn().allowTypes=e;const n=yield bn().fetchEsts(t,this._quickMode,this._includeErrs);this.port.postMessage(Object.assign({cmd:en.a.INIT},n))}))}startImport(e,t=null,n={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){bn().allowTypes=e,bn().options=n,(yield this.getImportInProgressFlag())||(yield bn().fetchEsts(t,this._quickMode)),this.port.postMessage({cmd:en.a.START}),this.setImportInProgressFlag(!0),this.importer.start()}))}finishImport(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.setImportInProgressFlag(!1);const e=yield bn().fetchEsts(null,this._quickMode);this.port.postMessage(Object.assign({cmd:en.a.INIT},e))}))}cancelImport(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.importer.stop(),this.setImportInProgressFlag(!1),this.port.postMessage({cmd:en.a.COMPLETE})}))}getImportInProgressFlag(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.options.storageAPI.local.get({[In.IMPORTS_PROGRESS_KEY]:!1}))[In.IMPORTS_PROGRESS_KEY]}))}setImportInProgressFlag(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.options.storageAPI.local.set({[In.IMPORTS_PROGRESS_KEY]:e})}))}}In.IMPORTS_PROGRESS_KEY="is-imports-in-progress";n(359);var Cn=n(709),kn=n(515),Pn=n(45),xn=n(43);var Rn=n(76);const Ln=(e,t)=>n=>console.warn(`${Object.values(n.failures).length} ${t} failed to be created. However, ${e-Object.values(n.failures).length} ${t} were created successfully.`);var Dn;!function(e){e.PushObject="push-object",e.ExecuteClientInstructions="execute-client-instruction"}(Dn||(Dn={}));var Nn=n(344),jn=n(513),Mn=n(129),Fn=n(64);const Un="db-data-loss-check",Bn={name:"STORAGE_CHECK_FLAG",postId:-1};function Gn({db:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let[t]=yield e.table("socialTags").where({postId:Bn.postId}).primaryKeys();return!t}))}function qn(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){(yield Gn(e))&&(yield e.db.table("socialTags").add(Bn))}))}const Hn="@QnDMigration-",$n={[Hn+"add-db-data-loss-check-flag-01"]:({db:e,captureException:t})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){yield qn({db:e,captureException:t})})),[Hn+"reset-template-order-01"]:({storex:e,bgModules:t})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){yield t.personalCloud.waitForSync();const n=yield e.collection("templates").findAllObjects({});if(!n.length)return;const r=Object(Oe.f)(n).map((e=>({operation:"updateObjects",collection:"templates",placeholder:`template-reorder-${e.id}`,where:{id:e.id},updates:{order:e.order}})));yield e.operation("executeBatch",r)})),[Hn+"reset-list-tree-order-01"]:({storex:e,bgModules:t})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){var n;yield t.personalCloud.waitForSync();const r=yield e.collection("customListTrees").findAllObjects({}),i=new Map;for(const e of r){const t=null!==(n=i.get(e.parentListId))&&void 0!==n?n:[];t.push(e),i.set(e.parentListId,t)}const o=[];for(const e of i.values()){const t=Object(Oe.f)(e);o.push(...t.map((e=>({operation:"updateObjects",collection:"customListTrees",placeholder:`tree-reorder-${e.id}`,where:{id:e.id},updates:{order:e.order}}))))}o.length&&(yield e.operation("executeBatch",o))})),[Hn+"set-order-for-templates-01"]:({bgModules:e,storex:t})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){const n=(yield e.copyPaster.findAllTemplates()).filter((e=>null==e.order)).map(((e,t)=>({operation:"updateObjects",collection:"templates",placeholder:`template-${e.id}`,where:{id:e.id},updates:{order:Oe.a+t*Oe.b}})));n.length&&(yield t.operation("executeBatch",n))})),[Hn+"reconcile-highlight-colors-in-synced-settings-storage-01"]:({bgModules:e,localStorage:t})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){const{[jn.a]:n}=yield t.get({[jn.a]:Mn.a});let r=(yield e.syncSettings.get(xn.c.highlightColors.highlightColors))[xn.c.highlightColors.highlightColors];r?r.unshift(Object.assign(Object.assign({},Fn.a[0]),{color:n})):r=Fn.a,yield e.syncSettings.set({[xn.c.highlightColors.highlightColors]:r})})),[Hn+"recreate-auto-inc-pk-colls-backup-changes-0"]:({storex:e,bgModules:t})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){const t=["annotationPrivacyLevels","locators","customListTrees"],n=Date.now();yield e.collection("backupChanges").deleteObjects({collection:{$in:t}});const i=[];let o=0;function s(t,s=100){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let r,a=0;for(;r=yield e.collection(t).findObjects({},{limit:s,skip:a*s}),i.push(...r.map(((e,r)=>({collection:"backupChanges",operation:"createObject",placeholder:`${t}-${a}-${r}`,args:{collection:t,objectPk:e.id,operation:"create",timestamp:n+o++}})))),a++,r.length===s;);}))}for(const e of t)yield s(e);yield e.operation("executeBatch",i)})),[Hn+"create-tree-data-for-lists-01"]:({bgModules:e,storex:t})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){const n=Date.now();let r=0,i=0;const o=[];for(;;){const t=yield e.customLists.storage.fetchAllLists({limit:50,skip:50*r,skipSpecialLists:!1,includeDescriptions:!1}),s=t.filter((e=>!Object.values(y.c).includes(e.id)&&e.name!==y.d.MOBILE)),a=yield e.customLists.storage.getTreeDataForLists({localListIds:s.map((e=>e.id))});if(o.push(...s.filter((e=>null==a[e.id])).map((e=>({operation:"createObject",collection:"customListTrees",placeholder:`list-tree-${i}`,args:{listId:e.id,linkTarget:null,path:null,parentListId:Pe.a,order:Oe.a+(i+=Oe.b),createdWhen:n,updatedWhen:n}})))),50!==t.length)break;r++}o.length&&(yield t.operation("executeBatch",o))})),[Hn+"share-unshared-lists-and-entries"]:({bgModules:e})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){const t=(yield e.customLists.fetchAllLists({})).map((e=>e.id));let n=yield e.contentSharing.getListShareMetadata({localListIds:t}),r=[];for(let e in n)r.push(n[e].localId);const i=t.filter((e=>!r.includes(e)));for(let t of i)yield e.contentSharing.scheduleListShare({localListId:t,isPrivate:!0})})),[Hn+"trigger-reinit-followed-list-pull-resync-01"]:({bgModules:e,storex:t})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){yield e.auth.authService.waitForAuthReady(),yield t.backend.operation("deleteObjects","followedList",{}),yield t.backend.operation("deleteObjects","followedListEntry",{}),yield e.pageActivityIndicator.syncFollowedLists(),yield e.pageActivityIndicator.syncFollowedListEntries()})),[Hn+"trigger-init-followed-list-pull-sync"]:({bgModules:e})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){yield e.pageActivityIndicator.syncFollowedLists()})),[Hn+"migrate-tags-to-spaces"]:({bgModules:{personalCloud:e},syncSettingsStore:t,db:n})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){(yield t.extension.get("areTagsMigratedToSpaces"))||(yield function({dexie:e,queueChangesForCloudSync:t,chunkSize:n=100}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield e.transaction("rw",["tags","customLists","pageListEntries","annotListEntries","personalCloudAction"],(()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const i=new Set,o=new Map;let s=Date.now();yield(t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){let r,i=0;do{r=yield e.table("tags").toCollection().offset(i*n).limit(n).primaryKeys(),yield t(r.map((e=>({name:e[0],url:e[1]})))),i++}while(r.length===n)})))((n=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=new Set(n.filter((e=>!i.has(e.name))).map((e=>e.name)));if(r.size){(yield e.table("customLists").where("name").anyOf([...r]).toArray()).forEach((e=>{r.delete(e.name),o.set(e.name,e.id)}));const n=[...r].map((e=>(s++,o.set(e,s),{name:e,id:s,createdAt:new Date(s),searchableName:e,nameTerms:[...Object(Cn.b)(e)],isDeletable:!0,isNestable:!0})));yield e.table("customLists").bulkAdd(n).catch(Ln(n.length,"spaces")),yield t({collection:"customLists",objs:n}),r.forEach((e=>i.add(e)))}const a=[],c=[];for(const e of n){const t=o.get(e.name);null!=t?Object(Rn.d)(e.url)?c.push({listId:t,url:e.url,createdAt:new Date}):a.push({listId:t,pageUrl:e.url,fullUrl:"https://"+e.url,createdAt:new Date}):Ve.b(new Error(`Tags migration: List ID not found for tag name: ${e.name}`))}yield e.table("pageListEntries").bulkAdd(a).catch(Ln(a.length,"page entries")),yield t({collection:"pageListEntries",objs:a}),yield e.table("annotListEntries").bulkAdd(c).catch(Ln(c.length,"annotation entries")),yield t({collection:"annotListEntries",objs:c})}))))}))))}))}({dexie:n,queueChangesForCloudSync:({collection:t,objs:n})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){return e.actionQueue.scheduleManyActions(n.map((n=>({type:Dn.PushObject,updates:[{collection:t,deviceId:e.deviceId,type:Nn.c.Overwrite,schemaVersion:e.currentSchemaVersion,object:e.preprocessObjectForPush({collection:t,object:n})}]}))),{queueInteraction:"queue-and-return"})}))}),yield t.extension.set("areTagsMigratedToSpaces",!0))})),[Hn+"migrate-to-cloud"]:({localExtSettingStore:e,storex:t,bgModules:n})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){if(null!=(yield e.get("installTimestamp")))return;const i=Object(Pn.a)({syncSettingsBG:n.syncSettings});yield i.dashboard.set("subscribeBannerShownAfter",Date.now()),yield n.syncSettings.__migrateLocalStorage(),yield function(e){var t,{fallbackNow:n=Date.now()}=e,i=Object(r.__rest)(e,["fallbackNow"]);return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield i.getOldInstallTime();if("number"==typeof e&&e>new Date("2017-01-01").getTime())return void(yield i.setInstallTime(e));const[r]=yield i.storageManager.collection("visits").findAllObjects({},{order:[["time","asc"]],limit:1});yield i.setInstallTime(null!==(t=null==r?void 0:r.time)&&void 0!==t?t:n)}))}({storageManager:t,getOldInstallTime:()=>e.__rawGet(An.g),setInstallTime:t=>e.set("installTimestamp",t)})})),[Hn+"migrate-readwise-key"]:({bgModules:e,localStorage:t})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){const{[xn.c.readwise.apiKey]:n}=yield t.get(xn.c.readwise.apiKey),r=new Date("2021-10-13T04:00:00.000+00:00");if(!n)return;const i=Object(Pn.a)({syncSettingsBG:e.syncSettings});yield i.readwise.set("apiKey",n),yield e.readwise.uploadAllAnnotations({annotationFilter:({createdWhen:e,lastEdited:t})=>e>r||t>r})})),"point-old-mobile-list-entries-to-new":({db:e})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield e.table("pageListEntries").orderBy("listId").uniqueKeys(),n=new Set(yield e.table("customLists").where("id").anyOf(t).primaryKeys());let r=[];if(t.forEach((e=>{n.has(e)||r.push(e)})),!r.length)return;let i=!1;yield e.table("pageListEntries").where("listId").anyOf(r).modify({listId:y.c.MOBILE}).catch((e=>{i=!0})),i&&(yield e.table("pageListEntries").where("listId").anyOf(r).delete())})),"remove-then-re-add-broken-backup-log-entries":({db:e})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){if(!(yield e.table("backupChanges").toCollection().modify(((e,t)=>{null==e.objectPk&&delete t.value}))))return;const t=Date.now(),n=[];let r=0;yield e.table("annotationPrivacyLevels").toCollection().eachPrimaryKey((e=>n.push({timestamp:t+r++,collection:"annotationPrivacyLevels",operation:"create",objectPk:e}))),yield e.table("backupChanges").bulkAdd(n)})),"staticize-mobile-list-id":({db:e})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){let t,n=!1;yield e.table("customLists").where("name").equals(y.d.MOBILE).modify((e=>{n=!0,e.id!==y.c.MOBILE&&(t=e.id,e.id=y.c.MOBILE)})),n||(yield e.table("customLists").add({searchableName:y.d.MOBILE,name:y.d.MOBILE,id:y.c.MOBILE,createdAt:new Date,isDeletable:!1,isNestable:!1})),null!=t&&(yield e.table("pageListEntries").where("listId").equals(t).modify((e=>{e.listId=y.c.MOBILE})))})),"normalise-all-annotation-url-keys":({db:e,storex:t,normalizeUrl:n})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){const t=new Map;yield e.table("annotations").where("url").startsWith("http").modify((e=>{try{const r=e.url,[i,o]=e.url.split("#");e.url=`${n(i)}#${o}`,t.set(r,Object.assign(Object.assign({},e),{oldUrl:r}))}catch(t){console.error("Error migrating old annotation",e),console.error(t)}})),yield e.table("annotBookmarks").where("url").anyOf([...t.keys()]).modify((e=>e.url=t.get(e.url).url)),yield e.table("tags").where("url").anyOf([...t.keys()]).modify((e=>e.url=t.get(e.url).url))})),"searchable-list-name-2":({storex:e})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){const t=e.collection("customLists"),n=yield t.findAllObjects({});for(const{id:e,name:r,nameTerms:i}of n)i||(yield t.updateOneObject({id:e},{nameTerms:[...Object(Cn.a)(r)],searchableName:r}))})),"searchable-list-name":({storex:e})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){const t=e.collection("customLists"),n=(yield t.findAllObjects({})).filter((({name:e})=>!Object.values(y.d).includes(e)));for(const{id:e,name:r}of n)yield t.updateObjects({id:e},{searchableName:r})})),"disable-auto-indexing-on-visit":({localStorage:e})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){yield e.set({[kn.a.LINKS]:!0,[kn.a.BOOKMARKS]:!0,[kn.a.STUBS]:!1,[kn.a.VISITS]:!1,[kn.a.SCREENSHOTS]:!1})})),"fill-out-empty-sync-log-fields":({db:e})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){yield e.table("clientSyncLogEntry").toCollection().modify((e=>{var t;e.sharedOn=null!==(t=e.sharedOn)&&void 0!==t?t:0,e.needsIntegration=e.needsIntegration?1:0}))})),"reseed-collections-suggestion-cache":({localStorage:e,db:t})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){const n="custom-lists_suggestions",r=(yield t.table("customLists").limit(1e3).toArray()).map((e=>e.name));yield e.set({[n]:r})})),"annots-undefined-pageUrl-field":({db:e,normalizeUrl:t})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){yield e.table("annotations").toCollection().filter((e=>void 0===e.pageUrl)).modify((e=>{e.pageUrl=t(e.url)}))})),"annots-created-when-to-last-edited":({db:e})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){yield e.table("annotations").toCollection().filter((e=>null==e.lastEdited||0===Object.keys(e.lastEdited).length&&e.lastEdited.constructor===Object)).modify((e=>{e.lastEdited=e.createdWhen}))})),"unify-duped-mobile-lists":({db:e})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield e.table("customLists").where("name").equals(y.d.MOBILE).toArray();if(t.length<2)return;const n=[yield e.table("pageListEntries").where("listId").equals(t[0].id).toArray(),yield e.table("pageListEntries").where("listId").equals(t[1].id).toArray()],r=n[0].length>n[1].length?0:1,i=0===r?1:0;for(const o of n[i])yield e.table("pageListEntries").put(Object.assign(Object.assign({},o),{listId:t[r].id}));yield e.table("pageListEntries").where("listId").equals(t[i].id).delete(),yield e.table("customLists").where("id").equals(t[i].id).delete()})),"remove-empty-url":({db:e})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){yield e.table("tags").where("url").equals("").delete(),yield e.table("visits").where("url").equals("").delete(),yield e.table("annotations").where("pageUrl").equals("").delete(),yield e.table("pageListEntries").where("pageUrl").equals("").delete()})),"denormalize-list-entry-full-urls":({db:e})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){yield e.table("pageListEntries").toCollection().modify((e=>{e.fullUrl&&!e.fullUrl.startsWith("http")&&(e.fullUrl="http://"+e.fullUrl)}))}))};var Wn=n(1244);const zn="last-search-timestamp",Vn="user-id",Kn=()=>g.a.storage.local.set({[zn]:Date.now()});var Yn=n(692),Qn=n(52),Xn=n(38),Jn=n(230),Zn=n(55),er=n(68),tr=n(29),nr=n(1056);var rr,ir=class{constructor(e){this.deps=e,this.setOnboardingTutorialState=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e={"@onboarding-dashboard-tutorials":{pages:!0,notes:!0,videos:!0,pdf:!0,twitter:!0}};yield this.deps.storageAPI.local.set(e)})),this.prepareAndUpdateExtension=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const{runtimeAPI:e,bgModules:t}=this.deps;try{yield t.tabManagement.mapTabChunks((e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){t.tabManagement.canTabRunContentScripts(e)&&(yield Object(a.l)(e.id).teardownContentScripts())}))),{onError:(e,t)=>{console.error(`Error encountered attempting to teardown content scripts for extension update on tab "${t.id}" - url "${t.url}":`,e.message),this.deps.captureException(e)}})}catch(e){console.error("Error encountered attempting to teardown content scripts for extension update:",e.message),this.deps.captureException(e)}e.reload()})),this.broadcastSpaceChangeToAllTabs=({tab:e},t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){let{bgModules:n}=this.deps;try{yield n.tabManagement.mapTabChunks((i=>Object(r.__awaiter)(this,void 0,void 0,(function*(){i.id!==e.id&&n.tabManagement.canTabRunContentScripts(i)&&("create"===t.type?yield Object(a.l)(i.id).addListToCache({list:t.list}):"delete"===t.type&&(yield Object(a.l)(i.id).removeListFromCache({localListId:t.localListId})))}))),{onError:()=>{}})}catch(e){this.deps.captureException(e)}})),this.chooseTabOpenFn=e=>(null==e?void 0:e.openInSameTab)?this.deps.tabsAPI.update:this.deps.tabsAPI.create,this.openDashboardPage=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){let t;(null==e?void 0:e.selectedSpace)&&(t=`selectedSpace=${e.selectedSpace}`);const n=null!=t?t:null,r=(null==e?void 0:e.missingPdf)?Zn.c:null;n&&r?yield this.chooseTabOpenFn(e)({url:An.c+"?"+n+"&"+r}):n?yield this.chooseTabOpenFn(e)({url:An.c+"?"+n}):r?yield this.chooseTabOpenFn(e)({url:An.c+"?"+r}):yield this.chooseTabOpenFn(e)({url:An.c})})),this.openOptionsPage=({query:e,params:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.chooseTabOpenFn(t)({url:`${An.b}#${e}`})})),this.createCheckoutLink=({billingPeriod:e,selectedPremiumPlans:t,doNotOpen:n,removedPremiumPlans:i})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.deps.bgModules.auth.authService.getCurrentUser(),o=null==r?void 0:r.creationTime,s=Date.now();let a=!1;a=o&&s-new Date(o).getTime()<2592e6;const c=r.email,l=e,u=tr.b.production;let d="",h="",f="";if(t.includes("lifetime")?(d="lifetime",h=i.join(","),f=`${u}/create-checkout?billingPeriod=lifetime&powerUps=${d}&removedPowerUps=${h}&prefilled_email=${encodeURIComponent(c)}&uwt=${a}`):(d=t.join(","),h=i.join(","),f=`${u}/create-checkout?billingPeriod=${l}&powerUps=${d}&removedPowerUps=${h}&prefilled_email=${encodeURIComponent(c)}&uwt=${a}`),n)try{const e=yield fetch(f),t=yield e.text();return JSON.parse(t).message}catch(e){console.error("Error executing checkout link:",e)}else try{g.a.tabs&&g.a.tabs.create&&g.a.tabs.create({url:f})}catch(e){console.error("Error fetching checkout link:",e)}})),this.remoteFunctions={openOptionsTab:Object(a.j)(this.openOptionsPage),openOverviewTab:Object(a.j)(this.openDashboardPage),createCheckoutLink:Object(a.j)(this.createCheckoutLink),broadcastListChangeToAllTabs:Object(a.i)(this.broadcastSpaceChangeToAllTabs)}}get defaultUninstallURL(){return"https://us-central1-worldbrain-1057.cloudfunctions.net/uninstall"}runOnboarding(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if("firefox"===Object(Qe.a)())yield this.deps.tabsAPI.create({url:`${An.c}?${Xn.d.NEW_USER}`});else{let e;e="production"==="production"?"https://memex.social/":"https://staging.memex.social/",yield this.deps.tabsAPI.create({url:`${e}auth`})}}))}handleInstallLogic(e=Date.now()){return Object(r.__awaiter)(this,void 0,void 0,(function*(){Qn.a.trackEvent({category:"Global",action:"installExtension"}),yield this.runOnboarding(),yield this.deps.localExtSettingStore.set("installTimestamp",Date.now()),yield qn({captureException:this.deps.captureException,db:this.deps.storageManager.backend.dexie}),yield this.deps.syncSettingsStore.pdfIntegration.set("shouldAutoOpen",!1),yield this.deps.syncSettingsStore.extension.set("areTagsMigratedToSpaces",!0),this.deps.syncSettingsStore.dashboard.set("subscribeBannerShownAfter",e),yield Object(Yn.b)({copyPaster:this.deps.bgModules.copyPaster,localStorage:this.deps.storageAPI.local})}))}handleUnifiedLogic(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.deps.bgModules.customLists.createInboxListIfAbsent()}))}setupOnDemandContentScriptInjection(){this.deps.tabsAPI.onActivated.addListener((({tabId:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.deps.bgModules.tabManagement.injectContentScriptsIfNeeded(e)}))))}setupInstallHooks(){this.deps.runtimeAPI.onInstalled.addListener((e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){switch(e.reason){case"install":yield this.handleInstallLogic(),yield this.handleUnifiedLogic(),yield Object(Xe.b)(Jn.c,!0),yield this.setOnboardingTutorialState(),yield this.trackInstallTime();break;case"update":this.runQuickAndDirtyMigrations(),yield Object(nr.b)(),yield this.handleUnifiedLogic(),yield this.checkForSubscriptionStatus()}}))))}trackInstallTime(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return null}))}checkForSubscriptionStatus(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.deps.bgModules.auth.authService.waitForAuthReady().then((()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){let e=yield this.deps.bgModules.auth.authService.getCurrentUser();if(e){let t=e.email;Object(er.b)(t,this.deps.browserAPIs)}}))))}))}___runQnDMigration(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield $n[Hn+e]({bgModules:this.deps.bgModules,storex:this.deps.storageManager,db:this.deps.storageManager.backend.dexieInstance,captureException:this.deps.captureException,localStorage:this.deps.storageAPI.local,normalizeUrl:this.deps.urlNormalizer,syncSettingsStore:this.deps.syncSettingsStore,localExtSettingStore:this.deps.localExtSettingStore})}))}runQuickAndDirtyMigrations(e=!1){return Object(r.__awaiter)(this,void 0,void 0,(function*(){for(const[t,n]of Object.entries($n)){const r=yield this.deps.storageAPI.local.get(t),i=!e&&!t.startsWith(Hn);r[t]||i||(yield n({bgModules:this.deps.bgModules,storex:this.deps.storageManager,db:this.deps.storageManager.backend.dexieInstance,captureException:this.deps.captureException,localStorage:this.deps.storageAPI.local,normalizeUrl:this.deps.urlNormalizer,syncSettingsStore:this.deps.syncSettingsStore,localExtSettingStore:this.deps.localExtSettingStore}),yield this.deps.storageAPI.local.set({[t]:!0}))}}))}setupUninstallURL(){this.deps.runtimeAPI.setUninstallURL(this.defaultUninstallURL),setTimeout((()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield function({generateId:e=Wn.v4,storage:t=g.a.storage,storageKey:n=Vn}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=(yield t.local.get(n))[n];if(r)return r;const i=e();return yield t.local.set({[n]:i}),i}))}({storage:this.deps.storageAPI});this.deps.runtimeAPI.setUninstallURL(`${this.defaultUninstallURL}?user=${e}`)}))),1e3),this.deps.storageChangesMan.addListener("local",Vn,(({newValue:e})=>this.deps.runtimeAPI.setUninstallURL(`${this.defaultUninstallURL}?user=${e}`)))}sendNotification(e){return this.deps.bgModules.notifications.dispatchNotification(e)}setupRemoteFunctions(){Object(a.f)(this.remoteFunctions)}setupWebExtAPIHandlers(){this.setupInstallHooks(),this.setupOnDemandContentScriptInjection(),this.setupUninstallURL(),this.deps.runtimeAPI.onUpdateAvailable.addListener(this.prepareAndUpdateExtension)}},or=n(727);function sr(e){return{message:atob(e.message),payload:e.payload?atob(e.payload):null}}function ar(e,t){return{message:btoa(e),payload:t?btoa(t):null}}function cr(e){return e&&"string"==typeof e}!function(e){e.EXT_IS_READY="EXT_IS_READY",e.EXT_IS_READY_RESPONSE="EXT_IS_READY_RESPONSE",e.EXT_IS_LOGGED_IN="EXT_IS_LOGGED_IN",e.TRIGGER_ONBOARDING="TRIGGER_ONBOARDING",e.LOGGED_IN="LOGGED_IN",e.TOKEN_REQUEST="TOKEN_REQUEST",e.TOKEN="TOKEN",e.URL_TO_OPEN="URL_TO_OPEN"}(rr||(rr={}));const lr=!1;function ur(e,t,n){n.onMessageExternal.addListener(((n,r,i)=>{const o=function(e,t,n){return!function(e,t){return"object"==typeof e&&"string"==typeof e.origin&&t.includes(e.origin)}(t,n)||!(r=e)||"object"!=typeof r||"string"!=typeof r.message||r.payload&&"string"!=typeof r.payload?null:sr(e);var r}(n,r,t);if(!o)return;!function(e,t,n=!1){n&&(t?t+=": ":t="",console.log(t+e.message))}(o,"Recieved",lr);return e((e=>{!function(e,t,n=!1){n&&(t?t+=": ":t="",console.log(t+sr(e).message))}(e,"Sending",lr),i(e)}),o)}))}function dr(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const i=["https://memex.social"];yield e.waitForAuthReady();let o=!1;ur(((t,s)=>!o&&(o=!0,s.message===rr.TRIGGER_ONBOARDING&&e.getCurrentUser().then((e=>{if(!!e)return t(ar(rr.TRIGGER_ONBOARDING)),g.a.tabs.create({url:`${An.c}?${Xn.d.NEW_USER}`}),g.a.tabs.query({}).then((e=>{const t=e.find((e=>i.some((t=>e.url.startsWith(`${t}/auth`)))));t&&g.a.tabs.remove(t.id)})),o=!1,!0})),s.message===rr.EXT_IS_LOGGED_IN&&e.getCurrentUser().then((e=>{if(!!e)return t(ar(rr.EXT_IS_LOGGED_IN)),o=!1,!0})),s.message===rr.EXT_IS_READY?(t(ar(rr.EXT_IS_READY_RESPONSE)),o=!1,!0):s.message===rr.URL_TO_OPEN?(n.set({"@URL_TO_OPEN":JSON.parse(s.payload)}),t(ar(rr.URL_TO_OPEN)),o=!1,!0):(e.getCurrentUser().then((n=>!!n?function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){n.message===rr.TOKEN_REQUEST?yield e.generateLoginToken().then((e=>{const n=e.token;cr(n)&&t(ar(rr.TOKEN,n))})):t(ar(rr.LOGGED_IN))}))}(e,t,s):function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){n.message===rr.TOKEN?n.payload&&(yield e.loginWithToken(n.payload),t(ar(rr.TOKEN_REQUEST))):t(ar(rr.TOKEN_REQUEST))}))}(e,t,s))).then((()=>o=!1)),!0))),i,t)}))}class hr{constructor(e){this.options=e,this.refreshUserInfo=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.options.remoteEmitter.emit("onLoadingUser",!0),yield this.authService.refreshUserInfo(),yield this.options.remoteEmitter.emit("onLoadingUser",!1)})),this.sendPasswordResetEmailProcess=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield Object(Xt.e)(Object(Xt.d)(),e)})),this.changeEmailProcess=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield Object(Xt.h)(Object(Xt.d)().currentUser,e)})),this.generateLoginToken=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=(yield this.authService.generateLoginToken()).token;if(cr(e))return e})),this.getJWTTokenForFeatureBase=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var e;const t=yield this.authService.getJWTTokenForFeatureBase(),n=null!==(e=null==t?void 0:t.token)&&void 0!==e?e:null;if(cr(n))return n})),this.registerWithEmailPassword=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const{result:t}=yield this.authService.registerWithEmailAndPassword(e.email,e.password);if("registered-and-authenticated"!==t.status)return{result:t};const n=yield this.authService.getCurrentUser();if(!n){const e="User registered successfuly, but didn't detect authenticated user after";return console.error("Error while registering user",e),{result:{status:"error",reason:"unknown",internalReason:e}}}return e.displayName&&(yield this.options.userManagement.updateUser({type:"user-reference",id:n.id},{knownStatus:"new"},{displayName:e.displayName})),{result:{status:"registered-and-authenticated"}}})),this.loginWithEmailPassword=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){try{return yield this.authService.loginWithEmailAndPassword(e.email,e.password),{result:{status:"authenticated"}}}catch(e){const t=e;return"auth/invalid-email"===t.code?{result:{status:"error",reason:"invalid-email"}}:"auth/user-not-found"===t.code?{result:{status:"error",reason:"user-not-found"}}:"auth/wrong-password"===t.code?{result:{status:"error",reason:"wrong-password"}}:(console.error(e),{result:{status:"error",reason:"unknown"}})}})),this.loginWithProvider=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){try{return yield this.authService.loginWithProvider(e),{result:{status:"authenticated"}}}catch(e){return console.error(e),{result:{status:"error",reason:"unknown"}}}})),this.authService=e.authServices.auth,this.backendFunctions=e.backendFunctions,this.subscriptionService=e.authServices.subscriptions,this.settings=new Ne.a(e.localStorageArea,{prefix:"auth."}),this.remoteFunctions={refreshUserInfo:this.refreshUserInfo,registerWithEmailPassword:this.registerWithEmailPassword,generateLoginToken:this.generateLoginToken,getJWTTokenForFeatureBase:this.getJWTTokenForFeatureBase,loginWithEmailPassword:this.loginWithEmailPassword,loginWithProvider:this.loginWithProvider,getCurrentUser:()=>this.authService.getCurrentUser(),signOut:()=>{delete this._userProfile,this.authService.signOut()},sendPasswordResetEmailProcess:this.sendPasswordResetEmailProcess,changeEmailProcess:this.changeEmailProcess,getAuthorizedFeatures:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return Object(or.a)(yield this.subscriptionService.getCurrentUserClaims())})),getAuthorizedPlans:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return Object(or.b)(yield this.subscriptionService.getCurrentUserClaims())})),isAuthorizedForFeature:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return Object(or.c)({claims:yield this.subscriptionService.getCurrentUserClaims(),settings:this.settings,feature:e})})),getUserProfile:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.authService.getCurrentUser();return e?(this._userProfile=this.options.userManagement.getUser({type:"user-reference",id:e.id}),this._userProfile):null})),getUserByReference:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.options.userManagement.getUser(e)})),updateUserProfile:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.authService.getCurrentUser();if(!t)return null;delete this._userProfile,yield this.options.userManagement.updateUser({type:"user-reference",id:t.id},{},{displayName:e.displayName})}))},dr(this.authService,e.runtimeAPI,e.localStorageArea)}registerRemoteEmitter(){this.authService.events.on("changed",(({user:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.options.remoteEmitter.emit("onLoadingUser",!0),Ve.d(e?{email:e.email,id:e.id}:void 0);const t=e?Object.assign(Object.assign({},e),{claims:yield this.subscriptionService.getCurrentUserClaims()}):null;if(this.options.remoteEmitter.emit("onLoadingUser",!1),this.options.remoteEmitter.emit("onAuthStateChanged",t),null!=this.options.getFCMRegistrationToken&&null!=e){const t=yield this.options.getFCMRegistrationToken();yield this.options.userManagement.addUserFCMRegistrationToken({type:"user-reference",id:e.id},t)}}))))}}const fr=[{id:"pdf-annotations",name:"PDF Annotations",description:"Annotate PDFs via the Memex extension (no phone support yet). Check 'Read more' for known issues.",link:"https://worldbrain.io/tutorial/pdf-annotations",enabled:!0,available:!0},{id:"sharing-collections",name:"Co-curating and discussing collections of pages, PDFs and annotations",description:"Easily share and collaborate with peers on timeless repositories of quality content, feedback on articles, and create references to important text passages.",link:"https://worldbrain.io/tutorials/share-research",enabled:!0,available:!0}];class pr{constructor(){this.keyPrefix="BetaFeature_",this.getFeatures=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=fr;for(const e of fr)e.enabled=yield this.getFeatureState(e.id);return e})),this.getFeatureState=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=localStorage.getItem(`${this.keyPrefix}${e}`);return null!==t?JSON.parse(t):fr.find((t=>t.id===e)).enabled})),this.toggleFeature=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getFeatureState(e);localStorage.setItem(`${this.keyPrefix}${e}`,JSON.stringify(!t))}))}}var gr=n(157),mr=n.n(gr),yr=n(223),vr=n.n(yr);class br extends c.a{constructor(e){super(e),this.options=e,this.disableBlobProcessing=!1,this.getConfig=()=>({collections:Object.assign({},We.a),operations:{createPage:{operation:"createObject",collection:"pages"},updatePage:{operation:"updateObject",collection:"pages",args:[{url:"$url:string"},"$updates"]},findPageByUrl:{operation:"findObject",collection:"pages",args:{url:"$url:string"}},deletePage:{operation:"deleteObject",collection:"pages",args:{url:"$url:string"}},createPageMetadata:{operation:"createObject",collection:"pageMetadata"},findPageMetadata:{operation:"findObject",collection:"pageMetadata",args:{normalizedPageUrl:"$normalizedPageUrl:string"}},updatePageMetadata:{operation:"updateObject",collection:"pageMetadata",args:[{normalizedPageUrl:"$normalizedPageUrl:string"},{doi:"$doi:string",title:"$title:string",annotation:"$annotation:string",sourceName:"$sourceName:string",journalName:"$journalName:string",journalPage:"$journalPage:string",journalIssue:"$journalIssue:string",journalVolume:"$journalVolume:string",releaseDate:"$releaseDate:number",accessDate:"$accessDate:number"}]},deletePageMetadata:{operation:"deleteObject",collection:"pageMetadata",args:{normalizedPageUrl:"$normalizedPageUrl:string"}},createPageEntity:{operation:"createObject",collection:"pageEntities"},findPageEntitiesByUrl:{operation:"findObjects",collection:"pageEntities",args:{normalizedPageUrl:"$normalizedPageUrl:string"}},updatePageEntity:{operation:"updateObject",collection:"pageEntities",args:[{id:"$id:number"},{name:"$name:string",isPrimary:"$isPrimary:boolean",additionalName:"$additionalName:string"}]},updatePageEntityOrder:{operation:"updateObject",collection:"pageEntities",args:[{id:"$id:number"},{order:"$order:number"}]},deletePageEntitiesByUrl:{operation:"deleteObjects",collection:"pageEntities",args:{normalizedPageUrl:"$normalizedPageUrl:string"}},deletePageEntity:{operation:"deleteObject",collection:"pageEntities",args:{id:"$id:number"}},createVisit:{operation:"createObject",collection:"visits"},countVisits:{operation:"countObjects",collection:"visits",args:{url:"$url:string"}},findLatestVisitByUrl:{operation:"findObjects",collection:"visits",args:[{url:"$url:string"},{order:[["time","desc"]],limit:1}]},findOldestVisitByUrl:{operation:"findObjects",collection:"visits",args:[{url:"$url:string"},{order:[["time","asc"]],limit:1}]},findVisitsByUrl:{operation:"findObjects",collection:"visits",args:{url:"$url:string"}},createFavIcon:{operation:"createObject",collection:"favIcons"},countFavIconByHostname:{operation:"countObjects",collection:"favIcons",args:{hostname:"$hostname:string"}},updateFavIcon:{operation:"updateObject",collection:"favIcons",args:[{hostname:"$hostname:string"},{favIcon:"$favIcon"}]},countBookmarksByUrl:{operation:"countObjects",collection:"bookmarks",args:{url:"$url:string"}},findBookmarkByUrl:{operation:"findObject",collection:"bookmarks",args:{url:"$url:string"}},findLocatorsByNormalizedUrl:{operation:"findObjects",collection:"locators",args:{normalizedUrl:"$normalizedUrl:string"}},findLocatorsByFingerprint:{operation:"findObjects",collection:"locators",args:{fingerprint:"$fingerprint:string"}},createLocator:{operation:"createObject",collection:"locators"},updateLocatorStatus:{operation:"updateObjects",collection:"locators",args:[{normalizedUrl:"$normalizedUrl:string",locationScheme:"$locationScheme:string"},{status:"$status:string"}]}}})}createPageIfNotExists(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=Object(D.c)(e.url);if(!(yield this.pageExists(t)))return this.createPage(e)}))}createPage(e,t,n){var i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=Object(D.c)(e.url);if(yield this.operation("createPage",Object.assign(Object.assign({},e),{url:n})),yield Object(Ce.c)({storageAPI:this.options.___storageAPI}))try{let n;if(e.fullUrl.startsWith("https://memex.cloud")){n={pageUrl:null===(i=t[e.url])||void 0===i?void 0:i.locators[0].originalLocation,pageTitle:e.fullTitle,createdWhen:Date.now(),pkmSyncType:"page"}}else n={pageUrl:e.fullUrl,pageTitle:e.fullTitle,createdWhen:Date.now(),pkmSyncType:"page",contentText:e.htmlBody};Object(Ie.b)(n,this.options.pkmSyncBG)}catch(e){console.error(e)}}))}updatePage(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){e=Object.assign({},e);const n={};for(const r of Object.keys(e)){const i=Object(St.d)("pages",r);if(i){if(!e[r]||t[r]===e[r]){delete e[r];continue}const o=Object(J.g)(i,e,t);n[r]=e[r],n[i]=o}else"string"==typeof t[r]||"string"==typeof e[r]?e[r]!==t[r]&&(n[r]=e[r]):r in We.a.pages.fields&&(n[r]=e[r])}Object.keys(n).length&&(yield this.operation("updatePage",{url:Object(D.c)(e.url),updates:n}))}))}createVisitsIfNeeded(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=Object(D.c)(e),r=[];for(const e of t)r.push({url:n,time:e});for(const e of r)yield this.operation("createVisit",e)}))}pageExists(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=Object(D.c)(e);return!!(yield this.operation("findPageByUrl",{url:t}))}))}pageHasVisits(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=Object(D.c)(e);return(yield this.operation("countVisits",{url:t}))>0}))}addPageVisit(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=Object(D.c)(e);yield this.operation("createVisit",{url:n,time:t})}))}addPageVisitIfHasNone(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){(yield this.pageHasVisits(e))||(yield this.addPageVisit(e,t))}))}getPage(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=Object(D.c)(e);return this.operation("findPageByUrl",{url:t})}))}updateVisitMetadata(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=Object(D.c)(e.url,{});return this.options.storageManager.collection("visits").updateObjects({time:e.time,url:n},t).catch(Object(He.a)())}))}updatePageEntities(e,t){var n,i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.getPageEntities(e),o=new Set(r.map((e=>e.id))),s=new Set(t.map((e=>e.id))),a=t.filter((e=>!o.has(e.id))),c=t.filter((e=>o.has(e.id))),l=r.filter((e=>!s.has(e.id)));for(const t of a)yield this.operation("createPageEntity",Object.assign(Object.assign({},t),{normalizedPageUrl:e}));for(const e of l)yield this.operation("deletePageEntity",e);for(const e of c){const t=r.find((t=>t.id===e.id));t.name===e.name.trim()&&t.additionalName===(null===(n=e.additionalName)||void 0===n?void 0:n.trim())&&t.isPrimary===e.isPrimary||(yield this.operation("updatePageEntity",{id:e.id,name:e.name.trim(),isPrimary:e.isPrimary,additionalName:null===(i=e.additionalName)||void 0===i?void 0:i.trim()}))}}))}getPageMetadata(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.operation("findPageMetadata",{normalizedPageUrl:e})}))}getPageEntities(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.operation("findPageEntitiesByUrl",{normalizedPageUrl:e})}))}setEntityOrder(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("updatePageEntityOrder",{id:e,order:t})}))}updatePageMetadata(e){var t,n,i,o,s,a,c,l,u,{normalizedPageUrl:d,accessDate:h=Date.now(),entities:f}=e,p=Object(r.__rest)(e,["normalizedPageUrl","accessDate","entities"]);return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e={accessDate:h,normalizedPageUrl:d,doi:null===(t=p.doi)||void 0===t?void 0:t.trim(),title:null===(n=p.title)||void 0===n?void 0:n.trim(),releaseDate:p.releaseDate,annotation:null===(i=p.annotation)||void 0===i?void 0:i.trim(),sourceName:null===(o=p.sourceName)||void 0===o?void 0:o.trim(),description:null===(s=p.description)||void 0===s?void 0:s.trim(),journalName:null===(a=p.journalName)||void 0===a?void 0:a.trim(),journalPage:null===(c=p.journalPage)||void 0===c?void 0:c.trim(),journalVolume:null===(l=p.journalVolume)||void 0===l?void 0:l.trim(),previewImageUrl:null===(u=p.previewImageUrl)||void 0===u?void 0:u.trim(),journalIssue:p.journalIssue};(yield this.getPageMetadata(d))?yield this.operation("updatePageMetadata",e):yield this.operation("createPageMetadata",e),yield this.updatePageEntities(d,f)}))}createFavIconIfNeeded(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=!!(yield this.operation("countFavIconByHostname",{hostname:e}));return n||(yield this.operation("createFavIcon",{hostname:e,favIcon:yield this._maybeDecodeBlob(t)})),{created:!n}}))}createOrUpdateFavIcon(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{created:n}=yield this.createFavIconIfNeeded(e,t);n||(yield this.operation("updateFavIcon",{hostname:e,favIcon:yield this._maybeDecodeBlob(t)}))}))}deletePageIfOrphaned(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=Object(D.c)(e);(yield this.operation("countVisits",{url:t}))>0||(yield this.operation("countBookmarksByUrl",{url:D.c}))||(yield this.operation("deletePage",{url:t}))}))}getFirstVisitOrBookmarkTime(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const[t]=yield this.operation("findOldestVisitByUrl",{url:e}),n=yield this.operation("findBookmarkByUrl",{url:e});return t||n?Math.min(...[null==n?void 0:n.time,null==t?void 0:t.time].filter((e=>null!=e))):null}))}getLatestVisit(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=Object(D.c)(e),n=yield this.operation("findLatestVisitByUrl",{url:t});return n.length?n[0]:null}))}getContentIdentifier(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=vr()(yield Promise.all(e.fingerprints.map((e=>this.operation("findLocatorsByFingerprint",{fingerprint:e}))))),n=t.find((t=>!!e.fingerprints.find((e=>Object(J.d)({fingerprintScheme:e.fingerprintScheme,fingerprint:e.fingerprint},t)))));if(!n)return null;const r=yield this.getPage(n.normalizedUrl);return r?{locators:t,identifier:{normalizedUrl:r.url,fullUrl:r.fullUrl}}:null}))}findLocatorsByNormalizedUrl(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findLocatorsByNormalizedUrl",{normalizedUrl:e})}))}storeLocators(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findLocatorsByNormalizedUrl",e.identifier),n=e.locators.filter((e=>!Object(J.f)(e.originalLocation)&&!t.find((t=>Object(J.d)(t,e)&&t.originalLocation===e.originalLocation))));yield Promise.all(n.map((e=>this.operation("createLocator",e))))}))}updateLocatorStatus(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("updateLocatorStatus",e)}))}_maybeDecodeBlob(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.disableBlobProcessing?e:"string"==typeof e?Pt(e):e}))}}var _r=n(595),wr=n(242);Error;function Tr(e){if(!e||!e.length)return new Set;const{text:t}=Object(wr.c)(e);return t&&t.length?new Set(Object(J.c)(t,{separator:Se.a})):new Set}var Er=e=>{var t=e.pageDoc,{content:n={},url:i,originalUrl:o,getFullText:s}=t,a=Object(r.__rest)(t,["content","url","originalUrl","getFullText"]);const{pathname:c,hostname:l,domain:u}=Object(_r.a)(null!=o?o:i),d=[...Tr(n.fullText)],h=[...Tr(n.title)],f=[...Tr(c)];return Promise.resolve(Object.assign({url:Object(D.c)(i),fullUrl:i,fullTitle:n.title,text:n.fullText,terms:d,urlTerms:f,titleTerms:h,domain:u,hostname:l,tags:[],pageMetadata:n.metadata},a))};class Ar{constructor(e){this.db=e}get collections(){return e=this.db,Object.keys(e.registry.collections);var e}}Ar.DEF_NON_ENUM_PROP={enumerable:!1,writable:!0},Ar.getBlobURL=e=>URL.createObjectURL(e),Ar.dataURLToBlob=e=>{const t=atob(e.split(",")[1]),n=e.split(",")[0].split(":")[1].split(";")[0],r=new ArrayBuffer(t.length),i=new Uint8Array(r);for(let e=0;e<t.length;e++)i[e]=t.charCodeAt(e);return new Blob([r],{type:n})};var Sr=class extends Ar{constructor(e,{url:t,time:n}){super(e),this.url=t,this.time="number"==typeof n?n:+n}get data(){return{url:this.url,time:this.time}}};class Or extends Sr{constructor(e,t){var{url:n,time:i}=t,o=Object(r.__rest)(t,["url","time"]);super(e,{url:n,time:i}),this.duration=o.duration,this.scrollPx=o.scrollPx,this.scrollPerc=o.scrollPerc,this.scrollMaxPx=o.scrollMaxPx,this.scrollMaxPerc=o.scrollMaxPerc}get pk(){return[this.time,this.url]}_hasChanged(e){return this.hasChanged=null==e||e.duration!==this.duration||e.scrollPx!==this.scrollPx||e.scrollPerc!==this.scrollPerc||e.scrollMaxPx!==this.scrollMaxPx||e.scrollMaxPerc!==this.scrollMaxPerc,this.hasChanged}save(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{object:e}=yield this.db.collection("visits").createObject(this.data);return[e.time,e.url]}))}}class Ir extends Sr{save(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{object:e}=yield this.db.collection("bookmarks").createObject(this.data);return e.url}))}}class Cr extends Ar{constructor(e,{name:t,url:n}){super(e),this.name=t,this.url=n}get data(){return{url:this.url,name:this.name}}save(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{object:e}=yield this.db.collection("tags").createObject(this.data);return[e.name,e.url]}))}delete(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.db.collection("tags").deleteOneObject({name:this.name,url:this.url})}))}}const kr=Symbol("assocVisits"),Pr=Symbol("assocTags"),xr=Symbol("assocBookmark"),Rr=Symbol("latestEvent"),Lr=Symbol("screenshotURI");class Dr extends Ar{constructor(e,t){super(e),this.url=t.url,this.fullUrl=t.fullUrl,this.fullTitle=t.fullTitle,this.text=t.text,this.terms=t.terms,this.urlTerms=t.urlTerms,this.titleTerms=t.titleTerms,this.domain=t.domain,this.hostname=t.hostname,t.screenshotURI&&(this.screenshotURI=t.screenshotURI),t.lang&&(this.lang=t.lang),t.canonicalUrl&&(this.canonicalUrl=t.canonicalUrl),t.description&&(this.description=t.description),t.keywords&&(this.keywords=t.keywords),t.pouchMigrationError&&(this.pouchMigrationError=t.pouchMigrationError),Object.defineProperties(this,{[kr]:Object.assign({value:[]},Ar.DEF_NON_ENUM_PROP),[xr]:Object.assign({value:void 0},Ar.DEF_NON_ENUM_PROP),[Pr]:Object.assign({value:[]},Ar.DEF_NON_ENUM_PROP),[Lr]:Ar.DEF_NON_ENUM_PROP,[Rr]:Ar.DEF_NON_ENUM_PROP})}get data(){return{url:this.url,fullUrl:this.fullUrl,fullTitle:this.fullTitle,text:this.text,terms:this.terms,urlTerms:this.urlTerms,titleTerms:this.titleTerms,domain:this.domain,hostname:this.hostname,screenshot:this.screenshot}}get screenshotURI(){return this[Lr]}get latest(){return this[Rr]}get hasBookmark(){return null!=this[xr]}get tags(){return this[Pr].map((e=>e.name))}get visits(){return this[kr]}get bookmark(){return this[xr]}get shouldDelete(){return!this.hasBookmark&&0===this[kr].length}set screenshotURI(e){e&&(this.screenshot=Ar.dataURLToBlob(e),this[Lr]=Ar.getBlobURL(this.screenshot))}getLatest(e=Date.now()){let t,n=0;for(t of this[kr])t.time>n&&t.time<=e&&(n=t.time);const r=this[xr];return null!=r&&r.time>n&&r.time<=e&&(n=r.time),n}addVisit(e=Date.now(),t={}){this[kr].push(new Or(this.db,Object.assign({url:this.url,time:e},t)))}addTag(e){-1===this[Pr].findIndex((t=>t.name===e))&&this[Pr].push(new Cr(this.db,{url:this.url,name:e}))}delTag(e){const t=this[Pr].findIndex((t=>t.name===e));-1!==t&&(this[Pr]=[...this[Pr].slice(0,t),...this[Pr].slice(t+1)])}setBookmark(e=Date.now()){this[xr]=new Ir(this.db,{url:this.url,time:e})}delBookmark(){this[xr]=void 0}_mergeTerms(e,t=[]){this[e]=this[e]?[...new Set([...this[e],...t])]:t}loadBlobs(){try{this.screenshot&&!this[Lr]&&(this[Lr]=Ar.getBlobURL(this.screenshot))}catch(e){this.screenshot=void 0,this[Lr]=void 0}}loadRels(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.loadBlobs();const e=yield this.db.collection("visits").findAllObjects({url:this.url}),t=yield this.db.collection("tags").findAllObjects({url:this.url}),n=yield this.db.collection("bookmarks").findOneObject({url:this.url});this[kr]=e.map((e=>new Or(this.db,e))),this[Pr]=t.map((e=>new Cr(this.db,e))),this[xr]=n?new Ir(this.db,n):void 0;let r=null!=n?n.time:0;r<(e[e.length-1]||{time:0}).time&&(r=e[e.length-1].time),this[Rr]=r}))}delete(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=(yield this.db.collection("annotations").findObjects({pageUrl:this.url})).map((e=>e.url));return this.db.operation("executeBatch",[{collection:"visits",operation:"deleteObjects",where:{url:this.url}},{collection:"bookmarks",operation:"deleteObjects",where:{url:this.url}},{collection:"tags",operation:"deleteObjects",where:{url:this.url}},{collection:"pageListEntries",operation:"deleteObjects",where:{pageUrl:this.url}},{collection:"pageMetadata",operation:"deleteObjects",where:{normalizedPageUrl:this.url}},{collection:"pageEntities",operation:"deleteObjects",where:{normalizedPageUrl:this.url}},{collection:"annotListEntries",operation:"deleteObjects",where:{url:{$in:e}}},{collection:"annotationPrivacyLevels",operation:"deleteObjects",where:{annotation:{$in:e}}},{collection:"images",operation:"deleteObjects",where:{normalizedUrl:this.url}},{collection:"annotations",operation:"deleteObjects",where:{pageUrl:this.url}},{collection:"locators",operation:"deleteObjects",where:{normalizedUrl:this.url}},{collection:"pages",operation:"deleteObjects",where:{url:this.url}}])}))}saveNewVisits(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.db.collection("visits").findObjects({url:this.url}),t=new Map;return e.forEach((e=>t.set(e.time,e))),Promise.all(this[kr].map((e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return e._hasChanged(t.get(e.time))?e.save():e.pk})))))}))}saveNewTags(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.db.collection("tags").findObjects({url:this.url}),t=new Map;return e.forEach((e=>t.set(e.name,e))),Promise.all(this[Pr].map((e=>t.get(e.name)?[e.name,e.url]:e.save())))}))}save(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.db.operation("transaction",{collections:this.collections},(()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){this.loadBlobs();const e=yield this.db.collection("pages").findOneObject({url:this.url});e?(this._mergeTerms("terms",e.terms),this._mergeTerms("urlTerms",e.urlTerms),this._mergeTerms("titleTerms",e.titleTerms),!this.screenshot&&e.screenshot&&(this.screenshot=e.screenshot),yield this.db.collection("pages").updateObjects({url:this.url},this.data)):yield this.db.collection("pages").createObject(this.data);const t=yield this.saveNewVisits(),n=yield this.saveNewTags();null!=this[xr]?this[xr].save():yield this.db.collection("bookmarks").deleteOneObject({url:this.url});const r=t.map((([e])=>e)),i=n.map((([e])=>e));return yield Promise.all([this.db.collection("visits").deleteObjects({url:this.url,time:{$nin:r}}),this.db.collection("tags").deleteObjects({url:this.url,name:{$nin:i}})]),this.url}))))}))}}Symbol("favIconURI");n(1068);var Nr=n(894),jr=n(706);var Mr,Fr=e=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){var t,n;let r,i;if(e.includeFavIcon=null===(t=e.includeFavIcon)||void 0===t||t,!e.includeContent)return;const o=Object(ie.c)(e.url);console.log("videoId",o);const s=yield e.tabManagement.extractRawPageContent(e.tabId);if(!s)throw new Error("Could extract raw page content");let c;if("pdf"===s.type){const t=yield Object(a.l)(e.tabId).extractPDFContents();r=t.pdfMetadata,i=t.pdfPageTexts,delete t.pdfMetadata,delete t.pdfPageTexts,c=t}else c={title:null!==(n=s.metadata.title)&&void 0!==n?n:"",metadata:s.metadata,fullText:""};if("metadata-with-full-text"===e.includeContent&&(c.fullText="html"===s.type?Object(Nr.a)({html:s.body}).text:c.fullText),o){let e=yield Object(jr.b)(o,"en");null!=e&&(c.fullText=c.fullText+JSON.parse(e).transcriptText)}const l=e.includeFavIcon&&"pdf"!==s.type?yield e.tabManagement.getFavIcon({tabId:e.tabId}):void 0;return{content:c,htmlBody:"html"===s.type?s.body:void 0,favIconURI:l,pdfMetadata:r,pdfPageTexts:i}}));class Ur extends c.a{constructor(){super(...arguments),this.getConfig=()=>({collections:{docContent:{version:Ae.a[0].version,fields:{normalizedUrl:{type:"string"},storedContentType:{type:"string"},content:{type:"json"}},indices:[{field:"normalizedUrl"}]}},operations:{createDocContent:{operation:"createObject",collection:"docContent"},findDocContentByUrl:{operation:"findObject",collection:"docContent",args:{normalizedUrl:"$normalizedUrl:string"}},updateDocContent:{operation:"updateObjects",collection:"docContent",args:[{normalizedUrl:"$normalizedUrl:string"},{htmlBody:"$htmlBody:string"}]}}})}createOrUpdatePage(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){(yield this.operation("findDocContentByUrl",e))?yield this.operation("updateDocContent",e):yield this.operation("createDocContent",e)}))}}!function(e){e.HtmlBody="htmlBody",e.PdfContent="pdfContent"}(Mr||(Mr={}));function Br(e){var t,n,i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r={doi:e.doi,entities:[]},o=yield e.fetch("https://api.crossref.org/works/"+e.doi);if(!o.ok)throw new Error(`Failed fetching data from Crossref API - DOI: ${e.doi}`);const s=yield o.json();if(!(null==s?void 0:s.message))throw new Error(`Received unexpected data from Crossref API - DOI: ${e.doi}`);return r.title=null===(t=s.message.title)||void 0===t?void 0:t[0],r.journalPage=s.message.page,r.journalVolume=s.message.volume,r.sourceName=s.message.publisher,r.journalName=null===(n=s.message["container-title"])||void 0===n?void 0:n[0],r.journalIssue=null===(i=s.message["journal-issue"])||void 0===i?void 0:i.issue,r.releaseDate=function(e){var t,n;if(null==!(null===(n=null===(t=null==e?void 0:e["date-parts"])||void 0===t?void 0:t[0])||void 0===n?void 0:n[0]))return;const{"date-parts":[r]}=e;return null!=r[1]&&(r[1]-=1),Date.UTC(...r).valueOf()}(s.message.published),r.entities=function(e=[]){return e.map((e=>({isPrimary:"first"===e.sequence,additionalName:e.given,name:e.family})))}(s.message.author),r}))}var Gr=n(47);class qr{constructor(e){this.options=e,this.identifiersForTabPages={},this.getFirstAccessTimeForPage=({normalizedPageUrl:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.storage.getFirstVisitOrBookmarkTime(e)})),this.getTitleForPage=({fullPageUrl:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t;const n=yield this.storage.getPage(e);return null!==(t=null==n?void 0:n.fullTitle)&&void 0!==t?t:null})),this.getOriginalUrlForPdfPage=({normalizedPageUrl:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t;const n=yield this.storage.findLocatorsByNormalizedUrl(e),r=Object(J.h)(n,{ignoreUploadLocators:!0,priority:Z.b.Remote});return null!==(t=null==r?void 0:r.originalLocation)&&void 0!==t?t:null})),this.getPageMetadata=({normalizedPageUrl:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.storage.getPageMetadata(e);if(!t)return null;const n=yield this.storage.getPageEntities(e);return Object.assign(Object.assign({},t),{entities:n})})),this.assignEntityData=(e,t)=>({id:e+t,order:Oe.a+t*Oe.b-e}),this.fetchPageMetadataByDOI=({doi:e,now:t=Date.now()})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield Br({doi:e,fetch:this.options.fetch});return Object.assign(Object.assign({},n),{entities:n.entities.map(((e,n)=>Object.assign(Object.assign({},e),this.assignEntityData(t,n))))})}catch(e){return null}})),this.waitForContentIdentifier=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t;yield this.getIdentifierResolvableForTabPage(e);const n=yield this.getContentInfoForPages(),r=Object(M.a)(e.fullUrl),i=Object(D.c)(r),o=n[i];return null!==(t=null==o?void 0:o.primaryIdentifier)&&void 0!==t?t:{fullUrl:r,normalizedUrl:i}})),this.indexPage=(e,t={})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var n,r,i,o;const s=Object(J.e)({url:e.fullUrl});if(!s&&!e.tabId){const t=yield this._findTabId(e.fullUrl);t?e.tabId=t:e.fullUrl.includes("mail.google.com/mail")||delete e.tabId}let a=yield null!=e.tabId?this.processPageDataFromTab(e):this.processPageDataFromUrl(e);if(a.isExisting){return(yield this.storage.getLatestVisit(a.fullUrl))||(yield this.storage.addPageVisit(a.fullUrl,this._getTime(e.visitTime))),{fullUrl:a.fullUrl}}if((e.fullUrl.includes("web.telegram.org/")||e.fullUrl.includes("x.com/")||e.fullUrl.includes("twitter.com/"))&&null!=(null===(n=e.metaData)||void 0===n?void 0:n.pageTitle)&&(a.fullTitle=e.metaData.pageTitle),yield this.createOrUpdatePage(a,t),yield null===(i=(r=this.options).onPagePut)||void 0===i?void 0:i.call(r,{identifier:{normalizedUrl:a.url,fullUrl:a.fullUrl},isLocalPdf:s&&a.isLocalPdf,isNew:!a.isExisting,tabId:e.tabId,isPdf:s}),e.visitTime&&(yield this.storage.addPageVisit(a.url,this._getTime(e.visitTime))),s){const t=this.attemptToExtractDOIFromPDFData(a);if(null==t?void 0:t.length){const n=yield this.fetchPageMetadataByDOI({doi:t});yield this.storage.updatePageMetadata({doi:t,normalizedPageUrl:a.url,accessDate:this._getTime(e.visitTime),entities:null!==(o=null==n?void 0:n.entities)&&void 0!==o?o:[],title:null==n?void 0:n.title,annotation:null==n?void 0:n.annotation,sourceName:null==n?void 0:n.sourceName,journalName:null==n?void 0:n.journalName,journalPage:null==n?void 0:n.journalPage,journalIssue:null==n?void 0:n.journalIssue,journalVolume:null==n?void 0:n.journalVolume,releaseDate:null==n?void 0:n.releaseDate})}}else if(a.pageMetadata){const t=Date.now(),n=a.pageMetadata.publishedTime?new Date(a.pageMetadata.publishedTime).valueOf():void 0;yield this.storage.updatePageMetadata({releaseDate:isNaN(n)?void 0:n,normalizedPageUrl:a.url,accessDate:this._getTime(e.visitTime),title:a.pageMetadata.title,sourceName:a.pageMetadata.provider,previewImageUrl:a.pageMetadata.image,description:a.pageMetadata.description,entities:a.pageMetadata.authors.filter((e=>null==e?void 0:e.trim().length)).map(((e,n)=>Object.assign({name:e,isPrimary:!1},this.assignEntityData(t,n))))})}return{fullUrl:a.fullUrl}})),this.setEntityOrder=({id:e,order:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.storage.setEntityOrder(e,t)})),this.updatePageMetadata=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var{normalizedPageUrl:t}=e,n=Object(r.__rest)(e,["normalizedPageUrl"]);yield this.storage.updatePageMetadata(Object.assign({normalizedPageUrl:t},n))})),this.storage=new br({pkmSyncBG:e.pkmSyncBG,storageManager:e.storageManager,___storageAPI:e.browserAPIs.storage}),this.persistentStorage=new Ur({storageManager:e.persistentStorageManager}),this.remoteFunctions={setEntityOrder:Object(a.j)(this.setEntityOrder),updatePageMetadata:Object(a.j)(this.updatePageMetadata),updatePageTitle:Object(a.i)(((e,t)=>this.updatePageTitle(t))),initContentIdentifier:Object(a.i)(((e,t)=>{var n,r;return this.initContentIdentifier(Object.assign(Object.assign({},t),{tabId:null!==(n=t.tabId)&&void 0!==n?n:null===(r=e.tab)||void 0===r?void 0:r.id}))})),waitForContentIdentifier:Object(a.i)(((e,t)=>{var n,r;return this.waitForContentIdentifier(Object.assign(Object.assign({},t),{tabId:null!==(n=t.tabId)&&void 0!==n?n:null===(r=e.tab)||void 0===r?void 0:r.id}))})),getOriginalUrlForPdfPage:Object(a.j)(this.getOriginalUrlForPdfPage),getFirstAccessTimeForPage:Object(a.j)(this.getFirstAccessTimeForPage),getTitleForPage:Object(a.j)(this.getTitleForPage),fetchPageMetadataByDOI:Object(a.j)(this.fetchPageMetadataByDOI),getPageMetadata:Object(a.j)(this.getPageMetadata)}}setupRemoteFunctions(){Object(a.f)(this.remoteFunctions)}initContentIdentifier(e){var t,n,i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=this.getIdentifierResolvableForTabPage({tabId:e.tabId,fullUrl:e.locator.originalLocation,forceNewResolvable:!0}),o=Object(D.c)(e.locator.originalLocation),s={normalizedUrl:o,fullUrl:e.locator.originalLocation};if(!e.fingerprints.length)return null===(t=null==r?void 0:r.resolve)||void 0===t||t.call(r),s;const a=yield this.getContentInfoForPages();let c,l=a[o];if(!l||Date.now()-l.asOf>qr.ONE_WEEK_MS)if(c=yield this.storage.getContentIdentifier({fingerprints:e.fingerprints}),c)l=null!==(n=a[c.identifier.normalizedUrl])&&void 0!==n?n:{asOf:Date.now(),primaryIdentifier:c.identifier,locators:c.locators,aliasIdentifiers:c.locators.map((e=>({normalizedUrl:Object(D.c)(e.originalLocation),fullUrl:e.originalLocation})))};else{const t=Object(J.a)(e.fingerprints[0].fingerprint,e.locator.format);l={asOf:Date.now(),primaryIdentifier:{fullUrl:t,normalizedUrl:Object(D.c)(t)},locators:[],aliasIdentifiers:[s]}}a[o]=l,a[l.primaryIdentifier.normalizedUrl]=l,l.aliasIdentifiers.find((e=>e.normalizedUrl===o))||l.aliasIdentifiers.push(s);let u=!1;const d=l.aliasIdentifiers.length>0&&!Object(De.a)({fullUrl:e.locator.originalLocation});for(const t of e.fingerprints){if(l.locators.find((n=>Object(J.d)(n,t)&&(n.originalLocation===e.locator.originalLocation||d))))continue;u=!0;const n=Object(D.a)(e.locator.originalLocation);l.locators.push(Object.assign(Object.assign({},e.locator),{location:Object(D.c)(e.locator.originalLocation),locationType:n?Z.b.Local:Z.b.Remote,locationScheme:n?Z.f.FilesystemPathV1:Z.f.NormalizedUrlV1,fingerprint:t.fingerprint,fingerprintScheme:t.fingerprintScheme,normalizedUrl:l.primaryIdentifier.normalizedUrl,primary:!0,valid:!0,version:0,lastVisited:this.options.getNow()}))}return yield this.options.pageIndexingSettingsStore.set("pageContentInfo",a),null===(i=null==r?void 0:r.resolve)||void 0===i||i.call(r),c&&u&&(yield this.storeLocators(l.primaryIdentifier)),l.primaryIdentifier}))}getContentInfoForPages(){var e;return Object(r.__awaiter)(this,void 0,void 0,(function*(){return null!==(e=yield this.options.pageIndexingSettingsStore.get("pageContentInfo"))&&void 0!==e?e:{}}))}getIndexedTabPages(){var e;return Object(r.__awaiter)(this,void 0,void 0,(function*(){return null!==(e=yield this.options.pageIndexingSettingsStore.get("indexedTabPages"))&&void 0!==e?e:{}}))}addPage({visits:e=[],pageDoc:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield Er({pageDoc:t}),{favIconURI:i}=n,o=Object(r.__rest)(n,["favIconURI"]);yield this.createOrUpdatePage(o),e=e.length?e:[Date.now()],yield this.storage.createVisitsIfNeeded(o.url,e)}))}updatePageTitle(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=e.title.trim();if(!t.length)throw new Error("Cannot set empty title");const n=yield this.storage.getPage(e.normaliedPageUrl);if(!n)throw new Error("Cannot update title for non-existent page");yield this.storage.updatePage(Object.assign(Object.assign({},n),{fullTitle:t,titleTerms:[...Tr(t)]}),n)}))}addFavIconIfNeeded(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{hostname:n}=Object(_r.a)(e);return this.storage.createFavIconIfNeeded(n,t)}))}addPageTerms(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield Er(e);yield this.createOrUpdatePage(t)}))}_deletePages(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.options.storageManager.collection("pages").findObjects(e);return Promise.all(t.map((e=>new Dr(this.options.storageManager,e).delete()))).catch(Object(He.a)())}))}delPages(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=e.map((e=>Object(D.c)(e)));return this._deletePages({url:{$in:t}})}))}addVisit(e,t=Date.now()){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!(yield this.storage.pageExists(e)))throw new Error(`Cannot add visit for non-existent page: ${e}`);yield this.storage.addPageVisit(e,t).catch(Object(He.a)())}))}updateTimestampMeta(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.updateVisitMetadata({url:e,time:t},n)}))}addFavIcon(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{hostname:n}=Object(_r.a)(e);yield this.storage.createOrUpdateFavIcon(n,t).catch(Object(He.a)())}))}domainHasFavIcon(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=this.options.storageManager,{hostname:n}=Object(_r.a)(e);return null!=(yield t.collection("favIcons").findOneObject({hostname:n}).catch(Object(He.a)()))}))}removeAnyUnregisteredFields(e){const t=Object.assign({},e);for(const e in t)this.storage.collections.pages.fields[e]||Object(St.e)({collection:"pages",field:e})||delete t[e];return t}createOrUpdatePage(e,t={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{favIconURI:n}=e,r=e.htmlBody;(e=this.removeAnyUnregisteredFields(e)).htmlBody=r;const i=yield this.getContentInfoForPages(),o=yield this.options.authBG.authService.getCurrentUser(),s=null==o?void 0:o.id,a=i[e.url],c=null==a?void 0:a.primaryIdentifier;c&&(e.fullUrl=c.fullUrl,e.url=c.normalizedUrl);const l=e.url,u=yield this.storage.getPage(l);if(u)yield this.storage.updatePage(e,u);else{try{yield Object(er.e)(this.options.browserAPIs,Gr.a,this.options.collectionsBG,e.fullUrl,!1)}catch(e){}yield this.storage.createPage(e,a,s)}c&&(yield this.storeLocators(c)),t.addInboxEntryOnCreate&&!u&&(yield this.options.createInboxEntry(e.fullUrl)),null!=n&&(yield this.addFavIconIfNeeded(e.url,n))}))}storeLocators(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=(yield this.getContentInfoForPages())[e.normalizedUrl];t&&(yield this.storage.storeLocators({identifier:t.primaryIdentifier,locators:t.locators}))}))}storeDocContent(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(t.htmlBody)yield this.persistentStorage.createOrUpdatePage({normalizedUrl:e,storedContentType:Mr.HtmlBody,content:t.htmlBody});else if(t.pdfMetadata&&t.pdfPageTexts){for(const e of Object.keys(t.pdfMetadata))null===t.pdfMetadata[e]&&delete t.pdfMetadata[e];yield this.persistentStorage.createOrUpdatePage({normalizedUrl:e,storedContentType:Mr.PdfContent,content:{metadata:t.pdfMetadata,pageTexts:t.pdfPageTexts}})}}))}processPageDataFromTab(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(null==e.tabId)throw new Error(`No tabID provided to extract content: ${e.fullUrl}`);const n=Object(J.b)(e.fullUrl);let r=!1;const i=yield this.storage.getPage(e.fullUrl);if((null===(t=null==i?void 0:i.text)||void 0===t?void 0:t.length)>0)return Object.assign(Object.assign({},i),{isExisting:!0});let o=e.fullUrl;if(n){let t=(yield this.getContentInfoForPages())[Object(D.c)(e.fullUrl)];if(!(null==t?void 0:t.locators.length))throw new Error("Could not find content info for PDF page");const n=t.locators.sort(((e,t)=>{var n,r;return(null!==(n=t.lastVisited)&&void 0!==n?n:0)-(null!==(r=e.lastVisited)&&void 0!==r?r:0)}))[0];n.originalLocation.startsWith("blob:")||n.originalLocation.startsWith("file:")?r=!0:o=n.originalLocation}const s=!(yield this.domainHasFavIcon(e.fullUrl)),a=yield Fr({tabId:e.tabId,tabManagement:this.options.tabManagement,includeContent:"metadata-with-full-text",includeFavIcon:s,url:e.fullUrl}),c=yield Er({pageDoc:Object.assign(Object.assign({},a),{url:e.fullUrl,originalUrl:o})});return yield this.storeDocContent(Object(D.c)(c.url),a),a.favIconURI&&(yield this.storage.createFavIconIfNeeded(c.hostname,a.favIconURI)),Object.assign(Object.assign({},c),{isLocalPdf:r})}))}attemptToExtractDOIFromPDFData({pdfMetadata:e,pdfPageTexts:t}){var n,r,i,o,s;if(!e&&!(null==t?void 0:t.length))return null;let a=null;if(e&&(a=null!==(o=null!==(r=null===(n=e.metadataMap)||void 0===n?void 0:n["crossmark:doi"])&&void 0!==r?r:null===(i=e.metadataMap)||void 0===i?void 0:i["pdfx:doi"])&&void 0!==o?o:null===(s=e.metadataMap)||void 0===s?void 0:s["prism:doi"]),!a&&(null==t?void 0:t.length)){const e=/\b(10[.][0-9]{4,}(?:[.][0-9]+)*\/(?:(?!["&\'<>])[\x21-\x7E])+)\b/i,n=t[0].match(e);(null==n?void 0:n.length)&&(a=n[0])}return a}processPageDataFromUrl(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n={url:e.fullUrl,originalUrl:e.fullUrl,content:{}};if(Object(J.b)(e.fullUrl)){const t=yield this.options.fetchPdfData(e.fullUrl),r=yield this.initContentIdentifier({locator:{format:Z.a.PDF,originalLocation:e.fullUrl},fingerprints:t.pdfMetadata.fingerprints.map((e=>({fingerprintScheme:Z.e.PdfV1,fingerprint:e})))}),i=yield this.storage.getPage(r.fullUrl);if(i)return Object.assign(Object.assign({},i),{isExisting:!0});yield this.storeDocContent(r.normalizedUrl,{pdfMetadata:t.pdfMetadata,pdfPageTexts:t.pdfPageTexts}),n.url=r.fullUrl,n.content.title=t.title,n.content.fullText=t.fullText,n.pdfMetadata=t.pdfMetadata,n.pdfPageTexts=t.pdfPageTexts}else{const r=yield this.storage.getPage(e.fullUrl);if(r)return Object.assign(Object.assign({},r),{isExisting:!0});let i,o,s;const a=yield this.options.fetchPageData(e.fullUrl);i=a.content,o=a.htmlBody,s=a.favIconURI,yield this.storeDocContent(Object(D.c)(e.fullUrl),{htmlBody:o}),n.favIconURI=s,n.content.title=(null==i?void 0:i.title)||(null===(t=e.metaData)||void 0===t?void 0:t.pageTitle),n.content.fullText=null==i?void 0:i.fullText}return Er({pageDoc:n})}))}_findTabId(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){let n=yield this.options.tabManagement.findTabIdByFullUrl(e);if(n)return n;const r=(yield this.getContentInfoForPages())[Object(D.c)(e)];for(const e of null!==(t=null==r?void 0:r.locators)&&void 0!==t?t:[])if(n=yield this.options.tabManagement.findTabIdByFullUrl(e.originalLocation),n)return n;return null}))}indexTestPage(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield Er({pageDoc:{url:e.fullUrl,content:{}}});yield this.storage.createPageIfNotExists(t),e.visitTime&&(yield this.storage.addPageVisit(t.url,this._getTime(e.visitTime)))}))}isTabPageIndexed(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.getIndexedTabPages();return null!==(n=null===(t=r[e.tabId])||void 0===t?void 0:t[e.fullPageUrl])&&void 0!==n&&n}))}markTabPageAsIndexed({tabId:e,fullPageUrl:t}){var n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!e)return;const r=yield this.getIndexedTabPages();r[e]=null!==(n=r[e])&&void 0!==n?n:{},r[e][t]=!0,yield this.options.pageIndexingSettingsStore.set("indexedTabPages",r)}))}handleTabClose(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getIndexedTabPages();delete t[e.tabId],yield this.options.pageIndexingSettingsStore.set("indexedTabPages",t),delete this.identifiersForTabPages[e.tabId]}))}findLocatorsByNormalizedUrl(e){return this.storage.findLocatorsByNormalizedUrl(e)}getIdentifierResolvableForTabPage(e){var t;const n=null!==(t=this.identifiersForTabPages[e.tabId])&&void 0!==t?t:{};this.identifiersForTabPages[e.tabId]=n;const r=e.forceNewResolvable?mr()():n[e.fullUrl];return n[e.fullUrl]=r,null!=r?r:null}_getTime(e){if(e||0===e)return"$now"!==e?e:this.options.getNow()}}qr.ONE_WEEK_MS=6048e5;var Hr,$r=n(1245),Wr=n.n($r);!function(e){e[e.BAD_REQUEST=1]="BAD_REQUEST",e[e.NOT_ALLOWED=2]="NOT_ALLOWED",e[e.SCHEMA_NOT_ALLOWED=3]="SCHEMA_NOT_ALLOWED"}(Hr||(Hr={}));const zr={registerApp:{path:"/app/register"},identifyApp:{path:"/app/identify"},getSessionInfo:{path:"/session"},destroySession:{path:"/session/destroy"},executeOperation:{path:"/storage/operation"},updateSchema:{path:"/schema/update"},executeRemoteOperation:{path:"/remote/operation"},executeRemoteCall:{path:"/remote/call"},subscribeToEvent:{path:"/remote/event/subscribe"},unsubscribeFromEvent:{path:"/remote/event/unsubscribe"},emitEvent:{path:"/event/emit"},describeAppSettings:{path:"/app/settings/describe"},getAppSettingsDescription:{path:"/app/settings/description"},setAppSettings:{path:"/app/settings/set"},getAppSettings:{path:"/app/settings/get"},deleteAppSettings:{path:"/app/settings/delete"},listPlugins:{path:"/plugins/list"},inspectPlugin:{path:"/plugins/inspect"},installPlugin:{path:"/plugins/inspect"},removePlugin:{path:"/plugins/remove"}};function Vr(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=new Promise(((t,n)=>{e.once("connect",(()=>{t()}))})),i=new Promise(((t,n)=>{e.once("error",(e=>{n(e)}))}));if(null==t?void 0:t.callbacks){const n=t.callbacks;e.on("request",(t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=n[t.methodName];if(!r)return{status:"not-implemented"};const i=yield r(t.methodOptions);e.emit("response",{requestId:t.requestId,response:i})}))))}yield Promise.race([n,i]);let o=0;return function(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n="methodName"!==(null==t?void 0:t.identifier),i={};for(const t of Object.entries(zr))i[t[0]]=(t=>i=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield e(n?t[1].path:t[0],{methodOptions:i})).result})))(t);return i}))}(((t,n)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=++o,s=new Promise(((t,n)=>{const i=n=>{n.requestId===r&&(e.removeListener("response",i),t({result:n.result}))};e.addEventListener("response",i)}));e.emit("request",{requestId:r,methodName:t,methodOptions:n.methodOptions});return{result:(yield Promise.race([s,i])).result}}))),{identifier:"methodName"})}))}const Kr="io.worldbrain.memex";class Yr{constructor(e){this.dependencies=e,this.development=!1,this.inMemory=!1,this.subscriptionCount=0,this.logger=console.log.bind(console)}connect(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.port=null==e?void 0:e.port,this.development=null!==(t=null==e?void 0:e.development)&&void 0!==t&&t,this.inMemory=null!==(n=e.inMemory)&&void 0!==n&&n,this.client=yield this._createClient({callbacks:{handleRemoteOperation:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return{result:yield this.dependencies.storageManager.operation(e.operation[0],...e.operation.slice(1))}})),handleSubscription:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return{subscriptionId:(++this.subscriptionCount).toString()}})),handleRemoteCall:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return"indexPage"===e.call?this._indexPage(e.args):{status:"call-not-found"}}))}}),yield this.registerOrIdentify()}))}_createClient(e){var t;return this.socket=Wr()(`http://localhost:${null!==(t=this.port)&&void 0!==t?t:this.development?50483:50482}`),this.socket.on("reconnect",(()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){this.logger("Re-connected to Storex Hub"),yield this.registerOrIdentify()})))),this.socket.on("disconnect",(e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){this.logger("Lost connection to Storex Hub:",e)})))),Vr(this.socket,{callbacks:null==e?void 0:e.callbacks})}_indexPage(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!e.url||"string"!=typeof e.url)return{status:"invalid-args"};const n=e.url,r=Object(D.c)(n);try{yield this.dependencies.storePageContent(undefined)}catch(e){return{status:"internal-error",errorStatus:"could-not-index",errorText:`Error while indexing page: ${e}`}}try{yield this.dependencies.addVisit({fullUrl:n,normalizedUrl:r,time:null!==(t=e.visitTime)&&void 0!==t?t:Date.now()})}catch(e){return{status:"internal-error",errorStatus:"could-not-add-visit",errorText:`Error while adding visit to page: ${e}`}}try{if(e.bookmark){const t="boolean"==typeof e.bookmark?null:e.bookmark.creationTime;yield this.dependencies.addBookmark({fullUrl:n,normalizedUrl:r,time:t||Date.now()})}}catch(e){return{status:"internal-error",errorStatus:"could-not-bookmark",errorText:`Error while bookmarking page: ${e}`}}try{e.tags&&(yield this.dependencies.addTags({fullUrl:n,normalizedUrl:r,tags:e.tags}))}catch(e){return{status:"internal-error",errorStatus:"could-not-tag",errorText:`Error while adding tags to page: ${e}`}}try{e.lists&&(yield this.dependencies.addToLists({fullUrl:n,normalizedUrl:r,lists:e.lists}))}catch(e){return{status:"internal-error",errorStatus:"could-not-list",errorText:`Error while adding page to lists: ${e}`}}return{status:"success",result:{}}}))}handlePostStorageChange(e){this.client&&this.client.emitEvent({event:{type:"storage-change",info:e.info}})}registerOrIdentify(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.logger(`Identifying with Storex Hub as '${Kr}'`);const e="storex-hub.access-token."+(this.development?"development":"production"),{[e]:t}=this.inMemory?{[e]:null}:yield this.dependencies.localBrowserStorage.get(e);if(t){this.logger("Found existing access token, using it to identify");const e=yield this.client.identifyApp({name:Kr,accessToken:t});if("success"!==e.status)throw new Error(`Couldn't identify app '${Kr}': ${e.status}`)}else{this.logger("Could not find existing access token, so registering");const t=yield this.client.registerApp({name:Kr,identify:!0,remote:!0});if("success"!==t.status)throw new Error(`Couldn't register app '${Kr}'": ${t.status}`);{const n=t.accessToken;(null==this?void 0:this.inMemory)||(yield this.dependencies.localBrowserStorage.set({[e]:n}))}}this.logger(`Successfuly identified with Storex Hub as '${Kr}'`)}))}}var Qr=n(288),Xr=n(1246),Jr=n(1041);const Zr={daily:864e5,weekly:6048e5,monthly:2592e6},ei={ActivityPings:{daily:!0,monthly:!0,weekly:!0}};class ti{constructor(e){this.options=e,this.checkPingInterval=36e5,this.activityPingIntervals=Zr,this._setInterval=Object(Qr.a)(globalThis,"setInterval"),this._getNow=()=>Date.now()}setup(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(this._setInterval((()=>this.maybePing()),this.checkPingInterval),this.lastPings=yield this.options.settings.get("lastPingTimestamps"),!this.lastPings){const e=this._getNow();this.lastPings={daily:e,weekly:e,monthly:e},yield this.options.settings.set("lastPingTimestamps",this.lastPings)}this.pendingPings=yield this.options.settings.get("pendingActivityPings"),this.pendingPings||(this.pendingPings={daily:[],weekly:[],monthly:[]},yield this.options.settings.set("pendingActivityPings",this.pendingPings))}))}isActivityPing(e){var t;return!!(null===(t=ei[e.category])||void 0===t?void 0:t[e.action])}storeActivity(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=e.category;for(const e of Object.keys(this.pendingPings)){if(this.pendingPings[e].includes(t))return;this.pendingPings[e].push(t),yield this.options.settings.set("pendingActivityPings",this.pendingPings)}}))}maybePing(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.needsPing();for(const t of Object.keys(this.pendingPings))e[t]&&(yield this.sendPing(t),yield this.updateActivityPings(t))}))}sendPing(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.options.analytics.trackEvent({category:"ActivityPings",action:e,value:{usedFeatures:this.pendingPings[e]}})}))}updateActivityPings(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.pendingPings[e]=[],yield this.options.settings.set("pendingActivityPings",this.pendingPings),this.lastPings[e]=this._getNow(),yield this.options.settings.set("lastPingTimestamps",this.lastPings)}))}needsPing(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e={daily:!1,weekly:!1,monthly:!1};for(const t of Object.keys(e))this._getNow()-this.lastPings[t]>this.activityPingIntervals[t]&&(e[t]=!0);return e}))}}class ni{constructor(e,t){this.analyticsManager=e,this.options=t,this.trackBqEvent=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){this.options.sendBqEvent(e)})),this.remoteFunctions={trackEvent:Object(Qr.a)(this,"trackEvent"),trackBqEvent:this.trackBqEvent,updateLastActive:Kn},this.activityPings=new ti({analytics:e,settings:new Ne.a(t.localBrowserStorage,{prefix:"analyticsPings"})})}setup(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.activityPings.setup()}))}trackEvent(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.activityPings.isActivityPing(e)?this.activityPings.storeActivity(e):this.analyticsManager.trackEvent(e)}))}}var ri=n(715);class ii extends c.a{constructor(e){super(e),this.options=e,this.getConfig=()=>({collections:Object.assign({},ri.a),operations:{createTemplate:{collection:ri.b.templates,operation:"createObject"},findTemplate:{collection:ri.b.templates,operation:"findObject",args:{id:"$id:pk"}},updateTemplate:{collection:ri.b.templates,operation:"updateObject",args:[{id:"$id:pk"},{code:"$code:string",title:"$title:string",order:"$order:number",outputFormat:"$outputFormat:string"}]},deleteTemplate:{collection:ri.b.templates,operation:"deleteObject",args:{id:"$id:pk"}},findAllTemplates:{collection:ri.b.templates,operation:"findObjects",args:[]}}})}getId(){return Date.now()}__createTemplateWithId(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{object:t}=yield this.options.storageManager.backend.operation("createObject",ri.b.templates,e);return t.id}))}createTemplate({title:e,code:t,order:n,outputFormat:i}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{object:r}=yield this.operation("createTemplate",{id:this.getId(),title:e,code:t,order:n,isFavourite:!1,outputFormat:i});return r.id}))}findTemplate({id:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findTemplate",{id:e})}))}updateTemplate({id:e,title:t,code:n,order:i,outputFormat:o}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("updateTemplate",{id:e,code:n,title:t,order:i,outputFormat:o})}))}deleteTemplate({id:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("deleteTemplate",{id:e})}))}findAllTemplates(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findAllTemplates",{})}))}}var oi=n(1247),si=n.n(oi),ai=n(1248),ci=n.n(ai);const li={PageUrl:"page",PageTitle:"page",PageTags:"pageTags",PageTagList:"pageTags",PageSpaces:"pageSpaces",PageSpacesList:"pageSpaces",PageCreatedAt:"pageCreatedAt",PageLink:"pageLink",PageDOI:"pageMetadata",PageMetaTitle:"pageMetadata",PageAnnotation:"pageMetadata",PageSourceName:"pageMetadata",PageJournalName:"pageMetadata",PageJournalPage:"pageMetadata",PageJournalIssue:"pageMetadata",PageJournalVolume:"pageMetadata",PageReleaseDate:"pageMetadata",PageAccessDate:"pageMetadata",EntityName:"pageEntities",EntityAdditionalName:"pageEntities",EntityAdditionalNameShort:"pageEntities",isPrimary:"pageEntities",showEtAl:"pageEntities",secondLast:"pageEntities",last:"pageEntities",HasNotes:"hasNotes",NoteHighlight:"note",NoteText:"note",NoteTags:"noteTags",NoteTagList:"noteTags",NoteSpaces:"noteSpaces",NoteSpacesList:"noteSpaces",NoteCreatedAt:"noteCreatedAt",NoteLink:"noteLink",url:"page",title:"page",tags:"pageTags"},ui={NoteHighlight:!0,NoteText:!0,NoteTags:!0,NoteTagList:!0,NoteSpaces:!0,NoteSpacesList:!0,NoteLink:!0,NoteCreatedAt:!0},di=new Set(["title","tags","url"]);function hi(e,t){si()(t).forEach((function(e){"string"==typeof e&&this.update(`@startvalue%${e.trim().replace(/<br\s*\/?>/g,"\n").replace(/\r?\n/g,"  \n")}@endvalue%`)}));const n=e=>null==e?void 0:()=>(t,n)=>n(Ht()(e).format(t));let r=ci.a.render(e.code,Object.assign(Object.assign({},t),{literal:()=>e=>e,b:()=>(e,t)=>`__${t(e)}__`,i:()=>(e,t)=>`_${t(e)}_`,NoteCreatedAt:n(t.NoteCreatedAt),PageCreatedAt:n(t.PageCreatedAt),PageAccessDate:n(t.PageAccessDate),PageReleaseDate:n(t.PageReleaseDate)})).replace("\r\n","\n");for(;;){const e=/@startvalue%([\s\S]+?)@endvalue%/g;let t=!1;if(r=r.replace(e,((e,n,i)=>{if(t)return e;t=!0;const o=r.lastIndexOf("\n",i);let s=r.lastIndexOf(" ",i);s<o&&(s=i-1);const a=r.substring(o>0?o+1:0,s>0?s+1:i).replace(/\S/," ");return n.replace(/\n/g,`\n${a}`)})),!t)break}return r}function fi(e,t){return e.map((e=>hi(t,e))).join("\n")}function pi(e){const t={Pages:[{}],Notes:[{}],PageEntities:[{}]};for(const e of Object.keys(li))t[e]=`@key%${e}.note@endkey%`,t.Pages[0][e]=`@key%${e}.page-list@endkey%`,t.Notes[0][e]=`@key%${e}.page@endkey%`,t.PageEntities[0][e]=`@key%${e}.entities@endkey%`;const n=hi(e,t),r=/@key%([a-zA-Z\.\-]+)@endkey%/g,i={};let o,s=!1;for(;;){const e=r.exec(n);if(!e)break;const t=e[1].split("."),a=t[0],c=t[1];"page-list"===c?o="page-list":"page-list"!==o&&ui[a]&&(o&&"page"!==c||(o=c));i[li[a]]=!0,s=s||di.has(a)}return o||(o="page"),i.pageMetadata=!0,i.pageCreatedAt=!0,i.noteCreatedAt=!0,i.page=!0,{usesLegacyTags:s,expectedContext:o,requirements:i}}function gi(e,t){if(!(null==e?void 0:e.length))return;const n=e.split(" ");let r="";for(const e of n){if(!e.length)continue;r+=e[0].toUpperCase()+". "}return r}const mi=e=>null==e?void 0:e.reduce(((t,n,r)=>`${t}#${n}${r===e.length-1?"":" "}`),""),yi=e=>null==e?void 0:e.reduce(((t,n,r)=>`${t}${n.includes(" ")?`[[${n}]]`:`#${n}`}${r===e.length-1?"":" "}`),""),vi=e=>{if(null!=e)return"number"==typeof e&&(e=new Date(e)),e.valueOf()},bi=e=>e.map((e=>(e.Notes&&(e.Notes=e.Notes.map(_i)),e.PageEntities&&(e.PageEntities=e.PageEntities.map(_i)),e.Pages&&(e.Pages=e.Pages.map((e=>{var t,n,{Notes:i,PageEntities:o}=e,s=Object(r.__rest)(e,["Notes","PageEntities"]);return Object.assign(Object.assign({},_i(s)),{Notes:null!==(t=null==i?void 0:i.map(_i))&&void 0!==t?t:[],PageEntities:null!==(n=null==o?void 0:o.map(_i))&&void 0!==n?n:[]})}))),_i(e)))),_i=e=>{var t;const n=Object.assign({},e);for(const e in n)(null==n[e]||"string"==typeof n[e]&&0===(null===(t=n[e])||void 0===t?void 0:t.length))&&delete n[e];return n},wi=(e=[])=>{const t=e.sort(((e,t)=>{const n=Object(Oe.c)(e,t);return(Number(t.isPrimary)-Number(e.isPrimary))*n})),n=t.findIndex((e=>!e.isPrimary))-1;return t.map(((t,r)=>({EntityName:t.name,EntityAdditionalName:t.additionalName,EntityAdditionalNameShort:gi(t.additionalName),secondLast:r+1===e.length-1,last:r+1===e.length,isPrimary:t.isPrimary,showEtAl:r===n})))},Ti=e=>{var t,n,i,o,s,a,c,l,u,d,h,f,p,g,m,y,v,b,_,w,T,E,A,S,O,I,C,k,P,x,R,L,D,N,j,M,F,U,B,G,q,$;return Object(r.__awaiter)(void 0,void 0,void 0,(function*(){var{templateAnalysis:W,dataFetchers:z}=e,V=Object(r.__rest)(e,["templateAnalysis","dataFetchers"]);const K=yield z.getNotes(V.annotationUrls),Y=((e,t)=>{var n;const r={};for(const i of Object.values(e)){const e=t(i);r[e]=[...null!==(n=r[e])&&void 0!==n?n:[],i]}return r})(K,(e=>e.pageUrl));let Q={},X={},J={},Z={},ee={},te={},ne={},re={},ie={},oe={};if(W.requirements.page&&(Z=yield z.getPages(V.normalizedPageUrls)),W.requirements.pageSpaces&&(re=yield z.getSpacesForPages(V.normalizedPageUrls)),W.requirements.pageMetadata&&(ne=yield z.getMetadataForPages(V.normalizedPageUrls)),W.requirements.pageEntities&&(te=yield z.getEntitiesForPages(V.normalizedPageUrls)),W.requirements.pageCreatedAt&&(oe=yield z.getCreatedAtForPages(V.normalizedPageUrls)),W.requirements.noteTags&&(Q=yield z.getTagsForNotes(V.annotationUrls)),W.requirements.noteSpaces&&(X=yield z.getSpacesForNotes(V.annotationUrls)),W.requirements.pageLink&&(ie=yield z.getPageLinks(H()(V.normalizedPageUrls.map((e=>[e,{annotationUrls:Object.values(K).filter((e=>e.pageUrl)).map((e=>e.url))}]))))),W.requirements.noteLink&&(J=yield z.getNoteLinks(V.annotationUrls)),!(W.requirements.note||W.requirements.noteLink||W.requirements.noteTags||W.requirements.noteSpaces||W.requirements.noteCreatedAt)){const e=[];for(const[r,{fullTitle:h,fullUrl:f}]of Object.entries(Z))e.push({PageTitle:h,PageTags:mi(ee[r]),PageTagList:ee[r],PageSpaces:yi(re[r]),PageSpacesList:re[r],PageUrl:f,PageLink:ie[r],PageCreatedAt:vi(oe[r]),PageEntities:wi(te[r]),PageDOI:null===(t=ne[r])||void 0===t?void 0:t.doi,PageMetaTitle:null===(n=ne[r])||void 0===n?void 0:n.title,PageAnnotation:null===(i=ne[r])||void 0===i?void 0:i.annotation,PageSourceName:null===(o=ne[r])||void 0===o?void 0:o.sourceName,PageJournalName:null===(s=ne[r])||void 0===s?void 0:s.journalName,PageJournalPage:null===(a=ne[r])||void 0===a?void 0:a.journalPage,PageJournalIssue:null===(c=ne[r])||void 0===c?void 0:c.journalIssue,PageJournalVolume:null===(l=ne[r])||void 0===l?void 0:l.journalVolume,PageReleaseDate:vi(null===(u=ne[r])||void 0===u?void 0:u.releaseDate),PageAccessDate:vi(null===(d=ne[r])||void 0===d?void 0:d.accessDate),title:h,tags:ee[r],url:f});return e}if("note"===W.expectedContext){const e=[];for(const[t,{body:n,comment:r,pageUrl:i,createdAt:o}]of Object.entries(K)){const s=null!==(h=Z[i])&&void 0!==h?h:{};e.push({NoteText:r,NoteHighlight:n,NoteTagList:Q[t],NoteTags:mi(Q[t]),NoteSpacesList:X[t],NoteSpaces:yi(X[t]),NoteLink:J[t],NoteCreatedAt:W.requirements.noteCreatedAt?vi(o):void 0,PageTitle:s.fullTitle,PageUrl:s.fullUrl,PageTags:mi(ee[i]),PageTagList:ee[i],PageSpaces:yi(re[i]),PageSpacesList:re[i],PageLink:ie[i],PageCreatedAt:vi(oe[i]),PageEntities:wi(te[i]),PageDOI:null===(f=ne[i])||void 0===f?void 0:f.doi,PageMetaTitle:null===(p=ne[i])||void 0===p?void 0:p.title,PageAnnotation:null===(g=ne[i])||void 0===g?void 0:g.annotation,PageSourceName:null===(m=ne[i])||void 0===m?void 0:m.sourceName,PageJournalName:null===(y=ne[i])||void 0===y?void 0:y.journalName,PageJournalPage:null===(v=ne[i])||void 0===v?void 0:v.journalPage,PageJournalIssue:null===(b=ne[i])||void 0===b?void 0:b.journalIssue,PageJournalVolume:null===(_=ne[i])||void 0===_?void 0:_.journalVolume,PageReleaseDate:vi(null===(w=ne[i])||void 0===w?void 0:w.releaseDate),PageAccessDate:vi(null===(T=ne[i])||void 0===T?void 0:T.accessDate),title:s.fullTitle,url:s.fullUrl,tags:ee[i]})}return e}if(!W.requirements.page){const e=[];for(const[t,{body:n,comment:r,createdAt:i,pageUrl:o}]of Object.entries(K))e.push({NoteText:r,NoteHighlight:n,NoteTagList:Q[t],NoteTags:mi(Q[t]),NoteSpacesList:X[t],NoteSpaces:yi(X[t]),NoteLink:J[t],NoteCreatedAt:W.requirements.noteCreatedAt?vi(i):void 0,PageEntities:wi(te[o]),PageDOI:null===(E=ne[o])||void 0===E?void 0:E.doi,PageMetaTitle:null===(A=ne[o])||void 0===A?void 0:A.title,PageAnnotation:null===(S=ne[o])||void 0===S?void 0:S.annotation,PageSourceName:null===(O=ne[o])||void 0===O?void 0:O.sourceName,PageJournalName:null===(I=ne[o])||void 0===I?void 0:I.journalName,PageJournalPage:null===(C=ne[o])||void 0===C?void 0:C.journalPage,PageJournalIssue:null===(k=ne[o])||void 0===k?void 0:k.journalIssue,PageJournalVolume:null===(P=ne[o])||void 0===P?void 0:P.journalVolume,PageReleaseDate:vi(null===(x=ne[o])||void 0===x?void 0:x.releaseDate),PageAccessDate:vi(null===(R=ne[o])||void 0===R?void 0:R.accessDate)});return[{Notes:e}]}const se=[];for(const[e,{fullUrl:t,fullTitle:n}]of Object.entries(Z))se.push({PageTitle:n,PageUrl:t,PageTags:mi(ee[e]),PageTagList:ee[e],PageSpaces:yi(re[e]),PageSpacesList:re[e],PageLink:ie[e],PageCreatedAt:vi(oe[e]),HasNotes:(null===(L=Y[e])||void 0===L?void 0:L.length)>0,PageDOI:null===(D=ne[e])||void 0===D?void 0:D.doi,PageMetaTitle:null===(N=ne[e])||void 0===N?void 0:N.title,PageAnnotation:null===(j=ne[e])||void 0===j?void 0:j.annotation,PageSourceName:null===(M=ne[e])||void 0===M?void 0:M.sourceName,PageJournalName:null===(F=ne[e])||void 0===F?void 0:F.journalName,PageJournalPage:null===(U=ne[e])||void 0===U?void 0:U.journalPage,PageJournalIssue:null===(B=ne[e])||void 0===B?void 0:B.journalIssue,PageJournalVolume:null===(G=ne[e])||void 0===G?void 0:G.journalVolume,PageReleaseDate:vi(null===(q=ne[e])||void 0===q?void 0:q.releaseDate),PageAccessDate:vi(null===($=ne[e])||void 0===$?void 0:$.accessDate),title:n,url:t,tags:ee[e],PageEntities:wi(te[e]),Notes:Y[e].map((({url:r,body:i,comment:o,createdAt:s})=>{var a,c,l,u,d,h,f,p,g,m;return{NoteText:o,NoteHighlight:i,NoteTagList:Q[r],NoteTags:mi(Q[r]),NoteSpacesList:X[r],NoteSpaces:yi(X[r]),NoteLink:J[r],NoteCreatedAt:W.requirements.noteCreatedAt?vi(s):void 0,PageTitle:n,PageUrl:t,PageTags:mi(ee[e]),PageTagList:ee[e],PageSpaces:yi(re[e]),PageSpacesList:re[e],PageLink:ie[e],PageCreatedAt:vi(oe[e]),PageDOI:null===(a=ne[e])||void 0===a?void 0:a.doi,PageMetaTitle:null===(c=ne[e])||void 0===c?void 0:c.title,PageAnnotation:null===(l=ne[e])||void 0===l?void 0:l.annotation,PageSourceName:null===(u=ne[e])||void 0===u?void 0:u.sourceName,PageJournalName:null===(d=ne[e])||void 0===d?void 0:d.journalName,PageJournalPage:null===(h=ne[e])||void 0===h?void 0:h.journalPage,PageJournalIssue:null===(f=ne[e])||void 0===f?void 0:f.journalIssue,PageJournalVolume:null===(p=ne[e])||void 0===p?void 0:p.journalVolume,PageReleaseDate:vi(null===(g=ne[e])||void 0===g?void 0:g.releaseDate),PageAccessDate:vi(null===(m=ne[e])||void 0===m?void 0:m.accessDate),title:n,url:t,tags:ee[e]}}))});return"page-list"===W.expectedContext?[{Pages:se}]:se}))};function Ei(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t=[],n=e.annotationUrls,i=e.normalizedPageUrls;if((null==i?void 0:i.length)>0){const i=e.normalizedPageUrls.filter((e=>!n.some((t=>t.startsWith(e)))));e.normalizedPageUrls=i;const b=yield(o=e,Object(r.__awaiter)(void 0,void 0,void 0,(function*(){var{templateAnalysis:e,dataFetchers:t}=o,n=Object(r.__rest)(o,["templateAnalysis","dataFetchers"]);const i=yield t.getPages(n.normalizedPageUrls);let b={},_={},w={},T={},E={},A={},S={},O={},I={},C={};e.requirements.pageTags&&(b=yield t.getTagsForPages(n.normalizedPageUrls)),e.requirements.pageSpaces&&(T=yield t.getSpacesForPages(n.normalizedPageUrls)),e.requirements.pageMetadata&&(_=yield t.getMetadataForPages(n.normalizedPageUrls)),e.requirements.pageEntities&&(w=yield t.getEntitiesForPages(n.normalizedPageUrls)),e.requirements.pageCreatedAt&&(E=yield t.getCreatedAtForPages(n.normalizedPageUrls)),(e.requirements.note||e.requirements.noteTags||e.requirements.noteSpaces||e.requirements.noteLink||e.requirements.noteCreatedAt)&&!n.skipNotes&&(C=yield t.getNoteIdsForPages(n.normalizedPageUrls));const k=[];for(const[r,{fullTitle:o,fullUrl:P}]of Object.entries(i)){const i=null!==(s=b[r])&&void 0!==s?s:[],x=null!==(a=T[r])&&void 0!==a?a:[],R=null!==(c=C[r])&&void 0!==c?c:[];e.requirements.note&&(I=yield t.getNotes(R)),e.requirements.noteTags&&(A=yield t.getTagsForNotes(R)),e.requirements.noteSpaces&&(S=yield t.getSpacesForNotes(R)),e.requirements.noteLink&&(O=yield t.getNoteLinks(R));const L=e.requirements.pageLink&&(yield t.getPageLinks({[r]:{annotationUrls:R}},n.now))[r];k.push({PageTitle:o,PageTags:mi(i),PageTagList:i,PageSpaces:yi(x),PageSpacesList:x,PageUrl:P,PageLink:L,PageCreatedAt:vi(E[r]),PageDOI:null===(l=_[r])||void 0===l?void 0:l.doi,PageMetaTitle:null===(u=_[r])||void 0===u?void 0:u.title,PageAnnotation:null===(d=_[r])||void 0===d?void 0:d.annotation,PageSourceName:null===(h=_[r])||void 0===h?void 0:h.sourceName,PageJournalName:null===(f=_[r])||void 0===f?void 0:f.journalName,PageJournalPage:null===(p=_[r])||void 0===p?void 0:p.journalPage,PageJournalIssue:null===(g=_[r])||void 0===g?void 0:g.journalIssue,PageJournalVolume:null===(m=_[r])||void 0===m?void 0:m.journalVolume,PageReleaseDate:vi(null===(y=_[r])||void 0===y?void 0:y.releaseDate),PageAccessDate:vi(null===(v=_[r])||void 0===v?void 0:v.accessDate),PageEntities:wi(w[r]),HasNotes:R.length>0,Notes:R.map((t=>{var n,r,i;return{NoteText:null===(n=I[t])||void 0===n?void 0:n.comment,NoteHighlight:null===(r=I[t])||void 0===r?void 0:r.body,NoteTagList:A[t],NoteTags:mi(A[t]),NoteSpacesList:S[t],NoteSpaces:yi(S[t]),NoteLink:O[t],NoteCreatedAt:e.requirements.noteCreatedAt?vi(null===(i=I[t])||void 0===i?void 0:i.createdAt):void 0}})),title:o,tags:i,url:P})}return"page-list"===e.expectedContext?[{Pages:k}]:k})));t.push(...b)}var o,s,a,c,l,u,d,h,f,p,g,m,y,v;if((null==n?void 0:n.length)>0){const r=e.normalizedPageUrls.filter((e=>n.some((t=>t.startsWith(e)))));for(const e of n){const t=e.split("/#")[0];r.includes(t)||r.push(t)}e.normalizedPageUrls=r;const i=yield Ti(e);t.push(...i)}return[...bi(t)]}))}var Ai=n(153);function Si({storageManager:e,contentSharing:t,previewMode:n}){const i=t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var n;const r=yield e.collection("tags").findObjects({url:{$in:t}}),i={};for(const e of r)i[e.url]=[...null!==(n=i[e.url])&&void 0!==n?n:[],e.name];return i})),o=t=>n=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r={},i=yield t(n),o=new Set;if(i.forEach((e=>o.add(e.listId))),!o.size)return r;const s=yield e.collection("customLists").findObjects({id:{$in:[...o]}}),a=new Map;return s.forEach((e=>a.set(e.id,e.name))),i.forEach((e=>{var t,n;const i=a.get(e.listId);null==i||(null===(t=r[e.url])||void 0===t?void 0:t.includes(i))||(r[e.url]=[...null!==(n=r[e.url])&&void 0!==n?n:[],i])})),r}));return{getPages:t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield e.collection("pages").findObjects({url:{$in:t}}),r=yield e.collection("locators").findObjects({normalizedUrl:{$in:t}});return n.reduce(((e,t)=>{let n=t.fullUrl;if(Object(J.e)(t)){const e=r.filter((e=>e.normalizedUrl===t.url)),i=Object(J.h)(e,{ignoreUploadLocators:!0,priority:Z.b.Remote});n=(null==i?void 0:i.originalLocation)?encodeURI(i.originalLocation):t.fullUrl}return Object.assign(Object.assign({},e),{[t.url]:{fullTitle:t.fullTitle,fullUrl:n}})}),{})})),getNotes:t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=(yield e.collection("annotations").findObjects({url:{$in:t}})).sort(Ai.b),r={};for(const e of n)r[e.url]={url:e.url,body:null!=e.body?Vt(Object(Kt.a)(e.body,"production")):"",comment:null!=e.comment?Vt(Object(Kt.a)(e.comment,"production")):"",pageUrl:e.pageUrl,createdAt:e.createdWhen};return r})),getNoteIdsForPages:t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield e.collection("annotations").findObjects({pageUrl:{$in:t}})).sort(Ai.b).reduce(((e,t)=>{var n;return Object.assign(Object.assign({},e),{[t.pageUrl]:[...null!==(n=e[t.pageUrl])&&void 0!==n?n:[],t.url]})}),{})})),getNoteLinks:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield t.shareAnnotations({annotationUrls:e,shareToParentPageLists:!0,skipAnalytics:!0});const n=yield t.storage.getRemoteAnnotationIds({localIds:e}),r={};for(const[e,t]of Object.entries(n))r[e]=Object(ke.f)({remoteAnnotationId:"string"==typeof t?t:t.toString()});return r})),getPageLinks:(i,o)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=Object.keys(i);if(n)return H()(r.map((e=>[e,Object(ke.g)({remoteListId:"XX",remoteListEntryId:"YY"})])));const s=vr()(Object.values(i).map((e=>e.annotationUrls)));yield t.shareAnnotations({annotationUrls:s,shareToParentPageLists:!0,skipAnalytics:!0});const a=new Map,c=yield e.collection("pages").findObjects({url:{$in:r}}),l=yield e.collection("followedListEntry").findObjects({normalizedPageUrl:{$in:r}},{order:[["createdWhen","asc"]]}),u=yield e.collection("sharedListMetadata").findObjects({remoteId:{$in:l.map((e=>e.followedList))}}),d=yield e.collection("customLists").findObjects({id:{$in:u.map((e=>e.localId))},type:"page-link"}),h=new Set(d.map((e=>e.id))),f=new Set(u.filter((e=>h.has(e.localId))).map((e=>e.remoteId)));for(const e of l)f.has(e.followedList)&&a.set(e.normalizedPageUrl,e);const p=H()(c.map((e=>[e.url,e.fullUrl]))),g=new Set(r.map((e=>a.has(e)?null:p[e])).filter((e=>null!=e))),m=yield t.scheduleManyPageLinkCreations({fullPageUrls:g,now:o});for(const{url:e,fullUrl:t}of c){const n=m[t];n&&a.set(e,{followedList:n.remoteListId,sharedListEntry:n.remoteListEntryId})}return H()(r.map((e=>{const t=a.get(e);if(!t)throw new Error(`Could not get page link for page with normalized URL: ${e}`);return[e,Object(ke.g)({remoteListId:t.followedList,remoteListEntryId:t.sharedListEntry})]})))})),getCreatedAtForPages:t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var n;const r=yield e.collection("visits").findObjects({url:{$in:t}}),i={};for(const e of r)(!i[e.url]||e.time<(null===(n=i[e.url])||void 0===n?void 0:n.getTime()))&&(i[e.url]=new Date(e.time));const o=t.filter((e=>!i[e]));if(!o.length)return i;const s=yield e.collection("bookmarks").findObjects({url:{$in:o}});for(const e of s)i[e.url]=new Date(e.time);return i})),getTagsForPages:i,getTagsForNotes:i,getMetadataForPages:t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield e.collection("pageMetadata").findObjects({normalizedPageUrl:{$in:t}});return H()(n.map((e=>[e.normalizedPageUrl,e])))})),getEntitiesForPages:t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield e.collection("pageEntities").findObjects({normalizedPageUrl:{$in:t}});return G()(n,(e=>e.normalizedPageUrl))})),getSpacesForPages:o((t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield e.collection("pageListEntries").findObjects({pageUrl:{$in:t}})).map((e=>({url:e.pageUrl,listId:e.listId})))})))),getSpacesForNotes:o((t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield e.collection("annotListEntries").findObjects({url:{$in:t}}),r=yield e.collection("annotationPrivacyLevels").findObjects({annotation:{$in:t}});for(const t of r){if(![re.a.SHARED,re.a.SHARED_PROTECTED].includes(t.privacyLevel))continue;const r=yield e.collection("annotations").findObject({url:t.annotation});if(null==r)continue;const i=yield e.collection("pageListEntries").findObjects({pageUrl:r.pageUrl}),o=yield e.collection("sharedListMetadata").findObjects({localId:{$in:i.map((e=>e.listId))}}),s=new Set([...o.map((e=>e.localId))]);n.push(...i.filter((e=>s.has(e.listId))).map((e=>({url:t.annotation,listId:e.listId}))))}return n}))))}}class Oi{constructor(e){this.options=e,this.renderPreview=({template:e,annotationUrls:t,normalizedPageUrls:n,templateType:i,skipNotes:o})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){let r=[];return r="examplePage"===i?[{HasNotes:!0,Notes:[{NoteHighlight:"@startvalue%Testing this highlight@endvalue%",NoteText:"@startvalue%Testing this note @endvalue%"}],PageTitle:"@startvalue%Testing Page Title @endvalue%",PageUrl:"@startvalue%Testing Page URL @endvalue%",title:"@startvalue%Testing Title @endvalue%",url:"@startvalue%https://en.wikipedia.org/wiki/NCAA_Division_I@endvalue%"}]:yield Ei({annotationUrls:t,normalizedPageUrls:n,templateAnalysis:pi(e),dataFetchers:Si(Object.assign(Object.assign({},this.options),{previewMode:!0})),skipNotes:null!=o&&o}),fi(r,e)})),this.renderTemplate=({id:e,annotationUrls:t,normalizedPageUrls:n,skipNotes:i})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.storage.findTemplate({id:e});return fi(yield Ei({annotationUrls:t,normalizedPageUrls:n,templateAnalysis:pi(r),dataFetchers:Si(this.options),skipNotes:null!=i&&i}),r)})),this.renderTemplateForPageSearch=({id:e,searchParams:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.storage.findTemplate({id:e}),r=(yield this.options.search.unifiedSearch(Object.assign(Object.assign({},t),{fromWhen:0,untilWhen:Date.now(),skip:0,limit:1e5}))).docs.map((e=>e.url));return fi(yield Ei({annotationUrls:[],normalizedPageUrls:r,templateAnalysis:pi(n),dataFetchers:Si(this.options)}),n)})),this.renderPreviewForPageSearch=({template:e,searchParams:t,templateType:n})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){let r=[];if("examplePage"===n)r=[{HasNotes:!0,Notes:[{NoteHighlight:"@startvalue%Testing this highlight@endvalue%",NoteText:"@startvalue%Testing this note @endvalue%"}],PageTitle:"@startvalue%Testing Page Title @endvalue%",PageUrl:"@startvalue%Testing Page URL @endvalue%",title:"@startvalue%Testing Title @endvalue%",url:"@startvalue%https://en.wikipedia.org/wiki/NCAA_Division_I@endvalue%"}];else{const n=(yield this.options.search.unifiedSearch(Object.assign(Object.assign({},t),{fromWhen:0,untilWhen:Date.now(),skip:0,limit:1e5}))).docs.slice(0,100).map((e=>e.url));r=yield Ei({annotationUrls:[],normalizedPageUrls:n,templateAnalysis:pi(e),dataFetchers:Si(Object.assign(Object.assign({},this.options),{previewMode:!0}))})}return fi(r,e)})),this.renderTemplateForAnnotationSearch=({id:e,searchParams:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.storage.findTemplate({id:e}),r=yield this.options.search.unifiedSearch(Object.assign(Object.assign({},t),{fromWhen:0,untilWhen:Date.now(),skip:0,limit:1e5})),i=r.docs.map((e=>e.url)),o=r.docs.flatMap((e=>e.annotations.map((e=>e.url))));return fi(yield Ei({annotationUrls:o,normalizedPageUrls:i,templateAnalysis:pi(n),dataFetchers:Si(this.options)}),n)})),this.renderPreviewForAnnotationSearch=({template:e,searchParams:t,templateType:n})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){let r=[];if("examplePage"===n);else{const n=(yield this.options.search.unifiedSearch(Object.assign(Object.assign({},t),{fromWhen:0,untilWhen:Date.now(),skip:0,limit:1e5}))).docs.slice(0,100),i=n.map((e=>e.url)),o=n.flatMap((e=>e.annotations.map((e=>e.url))));r=yield Ei({annotationUrls:o,normalizedPageUrls:i,templateAnalysis:pi(e),dataFetchers:Si(Object.assign(Object.assign({},this.options),{previewMode:!0}))})}return fi(r,e)})),this.storage=new ii({storageManager:e.storageManager}),this.remoteFunctions={findTemplate:Object(Qr.a)(this,"findTemplate"),createTemplate:Object(Qr.a)(this,"createTemplate"),updateTemplate:Object(Qr.a)(this,"updateTemplate"),deleteTemplate:Object(Qr.a)(this,"deleteTemplate"),findAllTemplates:Object(Qr.a)(this,"findAllTemplates"),renderTemplate:this.renderTemplate,renderPreview:this.renderPreview,renderTemplateForPageSearch:this.renderTemplateForPageSearch,renderTemplateForAnnotationSearch:this.renderTemplateForAnnotationSearch,renderPreviewForPageSearch:this.renderPreviewForPageSearch,renderPreviewForAnnotationSearch:this.renderPreviewForAnnotationSearch}}createTemplate(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.createTemplate(e)}))}findTemplate(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.findTemplate(e)}))}updateTemplate(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.updateTemplate(e)}))}deleteTemplate(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.deleteTemplate(e)}))}findAllTemplates(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.findAllTemplates()}))}}var Ii=n(62);const Ci="readablePageArchives",ki={[Ci]:{version:Ii.a[20].version,fields:{url:{type:"string"},title:{type:"text"},excerpt:{type:"text",optional:!0},byline:{type:"text",optional:!0},dir:{type:"string"},content:{type:"text"},length:{type:"int"},strategy:{type:"string"},createdWhen:{type:"datetime"},lastEdited:{type:"datetime"}},indices:[{field:"url",pk:!0},{field:"createdWhen"},{field:"lastEdited"}]}};class Pi extends c.a{constructor(e){super(e),this.options=e,this.getConfig=()=>({collections:Object.assign({},ki),operations:{createReadable:{operation:"createObject",collection:Pi.READER_COLL},findReadableByUrl:{operation:"findObject",collection:Pi.READER_COLL,args:{url:"$url:string"}}}}),this.readableExists=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=Object(D.c)(e,{});return!!(yield this.operation("findReadableByUrl",{url:t}))})),this.createReadableIfNotExists=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=Object(D.c)(e.url,{});(yield this.readableExists(t))||(yield this.operation("createReadable",Object.assign(Object.assign({},e),{url:t})))})),this.parseAndSaveReadable=({fullUrl:e,doc:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return null})),this.getReadable=e=>{const t=Object(D.c)(e,{});return this.operation("findReadableByUrl",{url:t})}}}Pi.READER_COLL=Ci;class xi{constructor(e){this.options=e,this.storage=new Pi({storageManager:e.storageManager}),this.remoteFunctions={getReadableVersion:this.storage.getReadable,setReadableVersion:this.storage.createReadableIfNotExists,readableExists:this.storage.readableExists,parseAndSaveReadable:this.storage.parseAndSaveReadable}}}var Ri=n(86),Li=n(1077),Di=n(18);class Ni{constructor(e){this.deps=e,this.generateRemoteAnnotationId=()=>this.deps.generateServerId("sharedAnnotation").toString(),this.getAnnotationSharingState=({annotationUrl:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t,n;const r=yield this.deps.storage.findAnnotationPrivacyLevel({annotation:e}),i=Object(Ri.d)(null!==(t=null==r?void 0:r.privacyLevel)&&void 0!==t?t:re.a.PRIVATE),o=i.public?yield this.deps.annotationStorage.getAnnotation(e):null,s=yield this.deps.annotationStorage.getEntriesForAnnotation(e),a=yield this.deps.storage.getRemoteAnnotationId({localId:e}),c=yield this.deps.storage.getRemoteListIds({localIds:s.map((e=>e.listId))}),l=new Set,u=new Set;if(s.forEach((e=>{null!=c[e.listId]?l.add(e.listId):u.add(e.listId)})),i.public){(yield this.fetchSharedListIdsForPage(o.pageUrl)).forEach((e=>l.add(e)))}return{hasLink:!!a,remoteId:null!=a?a:void 0,sharedListIds:[...l],privateListIds:[...u],privacyLevel:null!==(n=null==r?void 0:r.privacyLevel)&&void 0!==n?n:re.a.PRIVATE}})),this.getAnnotationSharingStates=({annotationUrls:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t,n,r,i,o,s;const a={},c=yield this.deps.storage.getPrivacyLevelsByAnnotation({annotations:e}),l=yield this.deps.storage.getRemoteAnnotationIds({localIds:e}),u=new Set,d=new Set;for(const r of e){Object(Ri.d)(null!==(n=null===(t=c[r])||void 0===t?void 0:t.privacyLevel)&&void 0!==n?n:re.a.PRIVATE).public?d.add(r):u.add(r)}const h=yield this.deps.annotationStorage.getAnnotations([...d]),f=yield this.deps.annotationStorage.getEntriesForAnnotations(e),p=new Set;for(const e of Object.values(f))e.forEach((e=>p.add(e.listId)));const g=yield this.deps.storage.getRemoteListIds({localIds:[...p]}),m=(e,t)=>{var n,r;return(null!==(r=null===(n=f[e])||void 0===n?void 0:n.map((e=>e.listId)))&&void 0!==r?r:[]).filter((e=>"shared"===t?null!=g[e]:null==g[e]))};for(const e of u)a[e]={remoteId:l[e],hasLink:!!l[e],sharedListIds:m(e,"shared"),privateListIds:m(e,"private"),privacyLevel:null!==(i=null===(r=c[e])||void 0===r?void 0:r.privacyLevel)&&void 0!==i?i:re.a.PRIVATE};const y=new Map;for(const e of h){let t=y.get(e.pageUrl);null==t&&(t=yield this.fetchSharedListIdsForPage(e.pageUrl),y.set(e.pageUrl,t)),a[e.url]={remoteId:l[e.url],hasLink:!!l[e.url],sharedListIds:[...t],privateListIds:m(e.url,"private"),privacyLevel:null!==(s=null===(o=c[e.url])||void 0===o?void 0:o.privacyLevel)&&void 0!==s?s:re.a.PRIVATE}}return a})),this.shareAnnotation=({sharingState:e,shareToParentPageLists:t,annotationUrl:n,remoteAnnotationId:i,setBulkShareProtected:o,skipPrivacyLevelUpdate:s,excludeFromLists:a})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var r;const c=null!=e?e:yield this.getAnnotationSharingState({annotationUrl:n});if(c.hasLink=!0,(null==c?void 0:c.remoteId)||(c.remoteId=null!=i?i:this.generateRemoteAnnotationId(),yield this.deps.storage.storeAnnotationMetadata([{localId:n,excludeFromLists:null===(r=null!=a?a:!t)||void 0===r||r,remoteId:c.remoteId}])),t){const e=yield this.deps.annotationStorage.getAnnotation(n);c.sharedListIds=yield this.fetchSharedListIdsForPage(e.pageUrl)}else{const e=yield this.deps.annotationStorage.getEntriesForAnnotation(n),t=yield this.deps.storage.getRemoteListIds({localIds:e.map((e=>e.listId))});c.sharedListIds=[],c.privateListIds=[],e.forEach((e=>{null!=t[e.listId]?c.sharedListIds.push(e.listId):c.privateListIds.push(e.listId)}))}if(!s){const e=Object(Ri.j)({public:t,protected:o});yield this.deps.storage.setAnnotationPrivacyLevel({annotation:n,privacyLevel:e}),c.privacyLevel=e}return c})),this.addAnnotationToLists=({listIds:e,annotationUrl:t,protectAnnotation:n,skipListExistenceCheck:i})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){for(const t of e)yield this.deps.addToListSuggestions(t);const r=yield this.deps.annotationStorage.getAnnotation(t),o=yield this.getAnnotationSharingState({annotationUrl:t}),s=Object(Ri.d)(o.privacyLevel),a=(yield this.deps.listStorage.getEntriesForPage(r.pageUrl)).map((e=>e.listId)),c=yield this.deps.storage.getRemoteListIds({localIds:[...new Set([...a,...e])]}),l=e.reduce(((e,t)=>null==c[t]&&e),!0);if(l||s.public&&!n||(o.privacyLevel=re.a.PROTECTED,yield this.deps.storage.setAnnotationPrivacyLevel({annotation:t,privacyLevel:o.privacyLevel})),s.public&&n){yield this.deps.storage.setAnnotationsExcludedFromLists({localIds:[t],excludeFromLists:!0});for(const e of a)null!=c[e]&&(yield this.deps.annotationStorage.ensureAnnotationInList({annotationUrl:t,listId:e},{skipListExistenceCheck:i}))}if(!l&&!(null==o?void 0:o.remoteId)){const{remoteId:e}=yield this.shareAnnotation({shareToParentPageLists:s.public,excludeFromLists:!s.public,skipPrivacyLevelUpdate:!0,annotationUrl:t,sharingState:o});o.remoteId=e,o.hasLink=!0}yield this.deps.storage.getPage(r.pageUrl);for(const r of e)[...o.privateListIds,...o.sharedListIds].includes(r)||(null!=c[r]?(s.public&&!n||(yield this.deps.annotationStorage.insertAnnotationToList({annotationUrl:t,listId:r},{skipListExistenceCheck:i})),o.sharedListIds.push(r)):(yield this.deps.annotationStorage.ensureAnnotationInList({annotationUrl:t,listId:r},{skipListExistenceCheck:i}),o.privateListIds.push(r)));return o})),this.removeAnnotationFromList=({listId:e,annotationUrl:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getAnnotationSharingState({annotationUrl:t}),r=t=>t!==e;n.privateListIds=n.privateListIds.filter(r),n.sharedListIds=n.sharedListIds.filter(r);const i=Object(Ri.d)(n.privacyLevel),o=yield this.deps.storage.getRemoteListId({localId:e});if(!i.public||null==o)return yield this.deps.annotationStorage.removeAnnotationFromList({annotationUrl:t,listId:e}),n;const s=yield this.deps.annotationStorage.getAnnotation(t);n.privacyLevel=re.a.PROTECTED,yield this.deps.storage.setAnnotationPrivacyLevel({annotation:t,privacyLevel:re.a.PROTECTED}),yield this.deps.storage.setAnnotationsExcludedFromLists({localIds:[t],excludeFromLists:!0});const a=yield this.deps.listStorage.getEntriesForPage(s.pageUrl),c=new Set(a.map((e=>e.listId))),l=yield this.deps.storage.getRemoteListIds({localIds:[...c]});for(const n of c)n!==e&&null!=l[n]&&(yield this.deps.annotationStorage.ensureAnnotationInList({annotationUrl:t,listId:n}));return n})),this.removeAnnotationFromAllLists=({sharingState:e,annotationUrl:t,setBulkShareProtected:n})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=n?re.a.PROTECTED:re.a.PRIVATE,i=null!=e?e:yield this.getAnnotationSharingState({annotationUrl:t});for(const e of i.sharedListIds)yield this.deps.annotationStorage.removeAnnotationFromList({listId:e,annotationUrl:t});i.sharedListIds=[],i.privacyLevel=r;const o=yield this.deps.storage.getRemoteAnnotationMetadata({localIds:[t]});null==o[t]||o[t].excludeFromLists||(yield this.deps.storage.setAnnotationsExcludedFromLists({localIds:[t],excludeFromLists:!0})),yield this.deps.storage.setAnnotationPrivacyLevel({annotation:t,privacyLevel:r});for(const e of i.privateListIds)yield this.deps.annotationStorage.ensureAnnotationInList({listId:e,annotationUrl:t});return i})),this.setAnnotationLists=({annotationUrl:e,listIds:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=new Set(t),r=yield this.deps.storage.areListsShared({localIds:[...n]}),i=yield this.getAnnotationSharingState({annotationUrl:e});i.sharedListIds=[],i.privateListIds=[];const o=yield this.deps.annotationStorage.getEntriesForAnnotation(e),s=new Set(o.map((e=>e.listId))),a=new Set,c=new Set;for(const e of n)s.has(e)||a.add(e),r[e]?i.sharedListIds.push(e):i.privateListIds.push(e);for(const e of s)n.has(e)||c.add(e);yield this.addAnnotationToLists({annotationUrl:e,listIds:[...a]});for(const t of c)yield this.removeAnnotationFromList({annotationUrl:e,listId:t});return i})),this.setAnnotationPrivacyLevel=({privacyLevel:e,annotationUrl:t,keepListsIfUnsharing:n})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.getAnnotationSharingState({annotationUrl:t});if(e===re.a.SHARED||e===re.a.SHARED_PROTECTED){for(const e of r.sharedListIds)yield this.deps.annotationStorage.removeAnnotationFromList({listId:e,annotationUrl:t});return yield this.deps.storage.setAnnotationsExcludedFromLists({localIds:[t],excludeFromLists:!1}),this.shareAnnotation({annotationUrl:t,setBulkShareProtected:e===re.a.SHARED_PROTECTED,shareToParentPageLists:!0,excludeFromLists:!1,sharingState:r,remoteAnnotationId:r.remoteId})}if(n){for(const e of r.sharedListIds)yield this.deps.annotationStorage.ensureAnnotationInList({listId:e,annotationUrl:t});return yield this.deps.storage.setAnnotationsExcludedFromLists({localIds:[t],excludeFromLists:!0}),r.privacyLevel=re.a.PROTECTED,yield this.deps.storage.setAnnotationPrivacyLevel({annotation:t,privacyLevel:re.a.PROTECTED}),r}return this.removeAnnotationFromAllLists({sharingState:r,annotationUrl:t,setBulkShareProtected:e===re.a.PROTECTED})}))}fetchSharedListIdsForPage(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=(yield this.deps.listStorage.getEntriesForPage(e)).map((e=>e.listId)),n=yield this.deps.storage.getLocalListIds({localIds:t});return t.filter((e=>null!=n[e]))}))}}var ji,Mi=n(714);class Fi{constructor(e){this.deps=e,this.ensureRemoteAnnotationIdsExistForList=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.deps.annotationStorage.getEntriesByList(e),n=yield this.deps.storage.getRemoteAnnotationIds({localIds:t.map((e=>e.url))});for(const e of t)null==n[e.url]&&(n[e.url]=this.deps.generateServerId("sharedAnnotation"));return n})),this.shareList=({isPrivate:e,localListId:t,remoteListId:n,collabKey:i,annotationLocalToRemoteIdsDict:o})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const{remoteListId:r,alreadyRemotelyAvailable:s}=yield this.ensureListRemotelyAvailable(t,n,e);if(s){let{links:e}=yield this.deps.listKeysService.getExistingKeyLinksForList({listReference:{id:r,type:"shared-list-reference"}});return 1===e.length&&(e=yield this.generateKeyLinks(r,i)),{linksPromise:new Promise((t=>t(e))),remoteListId:r,annotationSharingStatesPromise:this.deps.annotationSharingService.getAnnotationSharingStates({annotationUrls:Object.keys(o)})}}return{remoteListId:r,linksPromise:this.generateKeyLinks(r,i,!0),annotationSharingStatesPromise:this.selectivelySharePrivateListAnnotations(t,o)}}))}selectivelySharePrivateListAnnotations(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=Object.keys(t),r=yield this.deps.annotationSharingService.getAnnotationSharingStates({annotationUrls:n}),i=yield this.deps.annotationStorage.getAnnotations(n),o=new Set([...i.map((e=>e.pageUrl))]),s=yield this.deps.storage.getPages({normalizedPageUrls:[...o]}),a=yield this.deps.listStorage.getListEntriesForPages({listId:e,normalizedPageUrls:s.map((e=>e.normalizedUrl))}),c=new Set(a.map((e=>e.pageUrl)));for(const t of s)c.has(t.normalizedUrl)||(yield this.deps.listStorage.insertPageToList({normalizedPageUrl:t.normalizedUrl,fullPageUrl:t.originalUrl,listId:e}));const l=n.filter((e=>{var t;return[re.a.PRIVATE,re.a.PROTECTED].includes(null===(t=r[e])||void 0===t?void 0:t.privacyLevel)}));yield this.deps.storage.storeAnnotationMetadata(l.map((e=>{var n;const i=null!==(n=t[e])&&void 0!==n?n:this.deps.generateServerId("sharedAnnotation").toString();return r[e].hasLink=!0,r[e].remoteId=i,r[e].privacyLevel=re.a.PROTECTED,{localId:e,remoteId:i,excludeFromLists:!0}}))),yield this.deps.storage.setAnnotationPrivacyLevelBulk({annotations:l,privacyLevel:re.a.PROTECTED});for(const t of l)yield this.deps.annotationStorage.removeAnnotationFromList({listId:e,annotationUrl:t}),yield this.deps.annotationStorage.insertAnnotationToList({listId:e,annotationUrl:t});return r}))}ensureListRemotelyAvailable(e,t,n){var i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.deps.storage.getRemoteListId({localId:e});if(r)return{remoteListId:r,alreadyRemotelyAvailable:!0};if(!(yield this.deps.listStorage.getList(e)))throw new Error(`Tried to share non-existing list: ID ${e}`);const o=null!==(i=null==t?void 0:t.toString())&&void 0!==i?i:this.deps.generateServerId("sharedList").toString();return yield this.deps.storage.storeListId({localId:e,remoteId:o,private:null!=n&&n}),{remoteListId:o,alreadyRemotelyAvailable:!1}}))}generateKeyLinks(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){n&&(yield this.deps.waitForSync());return yield Promise.all([Di.a.Commenter,Di.a.ReadWrite].map((n=>this.deps.listKeysService.generateKeyLink({key:{roleID:n},listReference:{id:Object(Mi.a)(e),type:"shared-list-reference"},listKeyReference:n===Di.a.ReadWrite&&t?{id:t,type:"shared-list-key-reference"}:void 0}))))}))}}!function(e){e.PageLink="page-link"}(ji||(ji={}));var Ui=n(165);class Bi{constructor(e){this.options=e,this.pageLinkCreationProgress={},this.listShareSideEffectPromises={},this.getExistingKeyLinksForList=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){let{contentSharing:t}=this.options.services,{links:n}=yield t.getExistingKeyLinksForList(e);if(1===n.length&&n[0].roleID!==Di.a.ReadWrite){let r=yield t.generateKeyLink({key:{roleID:Di.a.ReadWrite},listReference:e.listReference});n.push(r)}return{links:n}})),this.generateRemoteAnnotationId=()=>this.options.generateServerId("sharedAnnotation").toString(),this.getRemoteAnnotationLink=({annotationUrl:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t;const n=null===(t=(yield this.storage.getRemoteAnnotationIds({localIds:[e]}))[e])||void 0===t?void 0:t.toString();return null==n?null:Object(ke.f)({remoteAnnotationId:n})})),this.getAllRemoteLists=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.storage.getAllRemoteListIds(),t=[];for(const n of Object.keys(e).map(Number)){const r=yield this.options.getBgModules().customLists.storage.fetchListById(n);t.push({localId:n,remoteId:e[n],name:r.name})}return t})),this.fetchLocalListDataByRemoteId=({remoteListId:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t;return null===(t=yield this.storage.getRemoteListShareMetadata({remoteListId:e}))||void 0===t?void 0:t.localId})),this.deleteListAndAllAssociatedData=({localListId:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.options.storageManager.operation(je.a.deleteTree,y.b.listTrees,{localListId:e})})),this.performDeleteListAndAllAssociatedData=({localListId:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const{customLists:t}=this.options.getBgModules();yield function(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield e.getAllNodesInTree();t.reverse();const n=[];for(const e of t){const t=e.listId;n.push({collection:"annotListEntries",operation:"deleteObjects",where:{listId:t}},{collection:"pageListEntries",operation:"deleteObjects",where:{listId:t}},{collection:"customListTrees",operation:"deleteObjects",where:{listId:t}},{collection:"customListDescriptions",operation:"deleteObjects",where:{listId:t}},{collection:"customLists",operation:"deleteObjects",where:{id:t}},{collection:"sharedListMetadata",operation:"deleteObjects",where:{localId:t}}),null!=e.remoteListId&&n.push({collection:"followedListEntry",operation:"deleteObjects",where:{followedList:e.remoteListId}},{collection:"followedList",operation:"deleteObjects",where:{sharedList:e.remoteListId}})}yield e.storageManager.backend.executeBatch(n)}))}({storageManager:this.options.storageManager,getAllNodesInTree:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield t.storage.getAllNodesInTreeByList({rootLocalListId:e}),r=yield this.storage.getRemoteListIds({localIds:n.filter((e=>null!=e.listId)).map((e=>e.listId))});return n.map((e=>{var t;return Object.assign(Object.assign({},e),{remoteListId:null!==(t=r[e.listId])&&void 0!==t?t:null})}))}))})})),this.scheduleListShare=e=>{var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){var{isPrivate:i,localListId:o}=e,s=Object(r.__rest)(e,["isPrivate","localListId"]);if(this.listShareSideEffectPromises[o])throw new Error('This list is already in the process of being shared - try calling "waitForListShareSideEffects" RPC method');const a=null!==(t=s.remoteListId)&&void 0!==t?t:this.options.generateServerId("sharedList").toString(),c=null!==(n=s.collabKey)&&void 0!==n?n:this.options.generateServerId("sharedListKey").toString(),l=yield this.listSharingService.ensureRemoteAnnotationIdsExistForList(o);return yield this.performListShare({collabKey:c,isPrivate:i,localListId:o,remoteListId:a,annotationLocalToRemoteIdsDict:l}),{collabKey:c,remoteListId:a,annotationLocalToRemoteIdsDict:l,links:[{roleID:Di.a.Commenter,link:Object(Ri.f)({remoteListId:a})},{keyString:c,roleID:Di.a.ReadWrite,link:Object(Ri.f)({remoteListId:a,collaborationKey:c})}]}}))},this.waitForListShareSideEffects=({localListId:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=this.listShareSideEffectPromises[e];delete this.listShareSideEffectPromises[e],yield t})),this.shareAnnotation=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.annotationSharingService.shareAnnotation(e)})),this.shareAnnotationsToAllLists=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.storage.getRemoteAnnotationMetadata({localIds:e.annotationUrls}),n=e.annotationUrls.filter((e=>{var n;return null===(n=t[e])||void 0===n?void 0:n.excludeFromLists}));if(yield this.storage.setAnnotationsExcludedFromLists({localIds:n,excludeFromLists:!1}),yield this.storage.setAnnotationPrivacyLevelBulk({annotations:n,privacyLevel:re.a.SHARED}),this.options.analyticsBG)try{yield Object(F.i)(this.options.analyticsBG,{type:"autoShared"})}catch(e){console.error(`Error tracking autoshare annotation event'', ${e}`)}return{sharingStates:yield this.getAnnotationSharingStates(e)}})),this.ensureRemotePageId=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t;const n=null===(t=yield this.options.getBgModules().auth.authService.getCurrentUser())||void 0===t?void 0:t.id;if(!n)throw new Error("Tried to execute sharing action without being authenticated");let r=yield this.lookupRemotePageIdInCache(e);if(null!=r)return r;const i={type:"user-reference",id:n},o=yield this.storage.getPage(e);if(null==o)throw new Error("No local page data exists for the given normalized page URL");const{contentSharing:s}=this.options.serverStorage,a=yield s.ensurePageInfo({pageInfo:Ye()(o,"fullTitle","originalUrl","normalizedUrl"),creatorReference:i});return r=s.getSharedPageInfoLinkID(a),yield this.cacheRemotePageId(e,r),r})),this.unshareAnnotationsFromAllLists=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.annotationSharingService.removeAnnotationFromAllLists({annotationUrl:e.annotationUrls[0],setBulkShareProtected:e.setBulkShareProtected});if(this.options.analyticsBG)try{yield Object(F.l)(this.options.analyticsBG,{type:"autoShared"})}catch(e){console.error(`Error tracking unshare autoshared annotation event', ${e}`)}return{sharingStates:{[e.annotationUrls[0]]:t}}})),this.shareAnnotationToSomeLists=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.annotationSharingService.addAnnotationToLists({annotationUrl:e.annotationUrl,listIds:e.localListIds,protectAnnotation:e.protectAnnotation,skipListExistenceCheck:e.skipListExistenceCheck});if(this.options.analyticsBG)try{yield Object(F.i)(this.options.analyticsBG,{type:"shared"})}catch(e){console.error(`Error tracking nshare annotation to some lists event', ${e}`)}return{sharingState:t}})),this.unshareAnnotationFromList=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.annotationSharingService.removeAnnotationFromList({annotationUrl:e.annotationUrl,listId:e.localListId});if(this.options.analyticsBG)try{yield Object(F.l)(this.options.analyticsBG,{type:"shared"})}catch(e){console.error(`Error tracking unshare annotation to some lists event', ${e}`)}return{sharingState:t}})),this.unshareAnnotation=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t;const n=yield this.storage.findAnnotationPrivacyLevel({annotation:e.annotationUrl});let r=null!==(t=null==n?void 0:n.privacyLevel)&&void 0!==t?t:re.a.PRIVATE;const i=Object(Ri.d)(r);return yield this.storage.deleteAnnotationMetadata({localIds:[e.annotationUrl]}),i.public&&(r=re.a.PRIVATE,yield this.storage.setAnnotationPrivacyLevel({annotation:e.annotationUrl,privacyLevel:r})),{sharingState:{hasLink:!1,privateListIds:[],sharedListIds:[],privacyLevel:r}}})),this.getListShareMetadata=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.getListShareMetadata({localIds:e.localListIds})})),this.deleteAnnotationShare=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.storage.deleteAnnotationMetadata({localIds:[e.annotationUrl]}),yield this.storage.deleteAnnotationPrivacyLevel({annotation:e.annotationUrl})})),this.findAnnotationPrivacyLevels=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t,n;const r=yield this.storage.getPrivacyLevelsByAnnotation({annotations:e.annotationUrls}),i={};for(const o of e.annotationUrls)i[o]=null!==(n=null===(t=r[o])||void 0===t?void 0:t.privacyLevel)&&void 0!==n?n:re.a.PRIVATE;return i})),this.setAnnotationPrivacyLevel=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){if((e.privacyLevel===re.a.SHARED||e.privacyLevel===re.a.SHARED_PROTECTED)&&this.options.analyticsBG)try{yield Object(F.i)(this.options.analyticsBG,{type:"autoShared"})}catch(e){console.error(`Error tracking space create event', ${e}`)}return this.annotationSharingService.setAnnotationPrivacyLevel(e)})),this.deleteAnnotationPrivacyLevel=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.storage.deleteAnnotationPrivacyLevel(e)})),this.getAnnotationSharingState=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.annotationSharingService.getAnnotationSharingState(e)})),this.getAnnotationSharingStates=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.annotationSharingService.getAnnotationSharingStates(e)})),this.suggestSharedLists=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=e.prefix.toLowerCase(),n=yield this.options.getBgModules().customLists.storage.fetchAllLists({limit:1e4,skip:0}),r=yield this.storage.getAllRemoteListIds(),i=[];for(const e of n)r[e.id]&&e.name.toLowerCase().startsWith(t)&&i.push({localId:e.id,name:e.name,remoteId:r[e.id],createdAt:e.createdAt.getTime()});return i})),this.waitForPageLinkCreation=({fullPageUrl:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t;yield null===(t=this.pageLinkCreationProgress[e])||void 0===t?void 0:t.resolvable})),this.scheduleManyPageLinkCreations=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t;const n=null!==(t=e.now)&&void 0!==t?t:Date.now(),r=this.options.getBgModules(),i=yield r.auth.authService.getCurrentUser();if(!i)throw new Error("Page links cannot be created when logged out");const o={};let s=n;for(const t of e.fullPageUrls){let e=this.pageLinkCreationProgress[t];if(e){o[t]=e.details;continue}const r=s++,a=Object(Ri.b)(new Date(n)),c=this.options.generateServerId("sharedList").toString(),l=this.options.generateServerId("sharedListEntry").toString(),u=this.options.generateServerId("sharedListKey").toString();o[t]={collabKey:u,listTitle:a,localListId:r,remoteListId:c,remoteListEntryId:l},e={details:o[t],resolvable:Object(Ui.a)()},this.pageLinkCreationProgress[t]=e,this.performPageLinkCreation(Object.assign({creator:i.id,skipPageIndexing:!0,fullPageUrl:t,now:n},e.details)).then((()=>{e.resolvable.resolve(),this.pageLinkCreationProgress[t]=null})).catch((n=>{e.resolvable.reject(n),this.pageLinkCreationProgress[t]=null}))}return o})),this.schedulePageLinkCreation=({tab:e},{fullPageUrl:t,now:n=Date.now(),customPageTitle:i,skipPageIndexing:o})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){let r=this.pageLinkCreationProgress[t];if(r)return r.details;const s=this.options.getBgModules(),a=yield s.auth.authService.getCurrentUser();if(!a)throw new Error("Page links cannot be created when logged out");const c=n,l=Object(Ri.b)(new Date(n)),u=this.options.generateServerId("sharedList").toString(),d=this.options.generateServerId("sharedListEntry").toString(),h=this.options.generateServerId("sharedListKey").toString(),f=i;return r={resolvable:Object(Ui.a)(),details:{pageTitle:f,collabKey:h,listTitle:l,localListId:c,remoteListId:u,remoteListEntryId:d}},this.pageLinkCreationProgress[t]=r,this.performPageLinkCreation(Object.assign({creator:a.id,tabId:null==e?void 0:e.id,skipPageIndexing:o,fullPageUrl:t,now:n},r.details)).then((()=>{r.resolvable.resolve(),this.pageLinkCreationProgress[t]=null})).catch((e=>{r.resolvable.reject(e),this.pageLinkCreationProgress[t]=null})),{remoteListId:u,remoteListEntryId:d,listTitle:l,localListId:c,collabKey:h,pageTitle:f}})),this.storage=new Li.a({storageManager:e.storageManager}),this.annotationSharingService=new Ni({storage:this.storage,generateServerId:e.generateServerId,addToListSuggestions:t=>e.getBgModules().customLists.updateListSuggestionsCache({added:t}),listStorage:{insertPageToList:t=>e.getBgModules().customLists.storage.insertPageToList({listId:t.listId,pageUrl:t.normalizedPageUrl,fullUrl:t.fullPageUrl}),getEntriesForPage:t=>e.getBgModules().customLists.storage.fetchPageListEntriesByUrl({normalizedPageUrl:t})},annotationStorage:{getAnnotation:t=>e.getBgModules().directLinking.annotationStorage.getAnnotationByPk({url:t}),getAnnotations:t=>e.getBgModules().directLinking.annotationStorage.getAnnotations(t),getEntriesForAnnotation:t=>e.getBgModules().directLinking.annotationStorage.findListEntriesByUrl({url:t}),getEntriesForAnnotations:t=>e.getBgModules().directLinking.annotationStorage.findListEntriesByUrls({annotationUrls:t}),ensureAnnotationInList:(t,n)=>e.getBgModules().directLinking.annotationStorage.ensureAnnotInList({listId:t.listId,url:t.annotationUrl},n),insertAnnotationToList:(t,n)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return e.getBgModules().directLinking.annotationStorage.insertAnnotToList({listId:t.listId,url:t.annotationUrl},n)})),removeAnnotationFromList:t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return e.getBgModules().directLinking.annotationStorage.removeAnnotFromList({listId:t.listId,url:t.annotationUrl})}))}}),this.listSharingService=new Fi({storage:this.storage,waitForSync:e.waitForSync,generateServerId:e.generateServerId,listKeysService:e.services.contentSharing,annotationSharingService:this.annotationSharingService,listStorage:{getList:t=>e.getBgModules().customLists.storage.fetchListById(t),getListEntriesForPages:({listId:t,normalizedPageUrls:n})=>e.getBgModules().customLists.storage.fetchListPageEntriesByUrls({listId:t,normalizedPageUrls:n}),insertPageToList:({listId:t,fullPageUrl:n,normalizedPageUrl:r})=>e.getBgModules().customLists.storage.insertPageToList({listId:t,fullUrl:n,pageUrl:r,isShared:!0})},annotationStorage:{getAnnotations:t=>e.getBgModules().directLinking.annotationStorage.getAnnotations(t),getEntriesByList:t=>e.getBgModules().directLinking.annotationStorage.findListEntriesByList({listId:t}),insertAnnotationToList:t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return e.getBgModules().directLinking.annotationStorage.insertAnnotToList({listId:t.listId,url:t.annotationUrl})})),removeAnnotationFromList:t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return e.getBgModules().directLinking.annotationStorage.removeAnnotFromList({listId:t.listId,url:t.annotationUrl})}))}}),this.remoteFunctionsByTab={schedulePageLinkCreation:this.schedulePageLinkCreation},this.remoteFunctions={waitForPageLinkCreation:this.waitForPageLinkCreation,getExistingKeyLinksForList:this.getExistingKeyLinksForList,deleteKeyLink:(...t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const{contentSharing:n}=yield e.services;return n.deleteKeyLink(...t)})),scheduleListShare:this.scheduleListShare,waitForListShareSideEffects:this.waitForListShareSideEffects,deleteListAndAllAssociatedData:this.deleteListAndAllAssociatedData,shareAnnotation:this.shareAnnotation,executePendingActions:this.executePendingActions.bind(this),shareAnnotationToSomeLists:this.shareAnnotationToSomeLists,unshareAnnotationFromList:this.unshareAnnotationFromList,ensureRemotePageId:this.ensureRemotePageId,getRemoteAnnotationLink:this.getRemoteAnnotationLink,findAnnotationPrivacyLevels:this.findAnnotationPrivacyLevels.bind(this),setAnnotationPrivacyLevel:this.setAnnotationPrivacyLevel,generateRemoteAnnotationId:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.generateRemoteAnnotationId()})),getRemoteListId:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.getRemoteListId({localId:e.localListId})})),getRemoteAnnotationIds:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.getRemoteAnnotationIds({localIds:e.annotationUrls})})),getRemoteAnnotationMetadata:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.getRemoteAnnotationMetadata({localIds:e.annotationUrls})})),getListShareMetadata:this.getListShareMetadata,updateListPrivacy:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.updateListPrivacy({localId:e.localListId,private:e.isPrivate})})),getAnnotationSharingState:this.getAnnotationSharingState,fetchLocalListDataByRemoteId:this.fetchLocalListDataByRemoteId,getAnnotationSharingStates:this.getAnnotationSharingStates,createListEmailInvite:e=>this.options.backend.createListEmailInvite(e),deleteListEmailInvite:e=>this.options.backend.deleteListEmailInvite(e),acceptListEmailInvite:e=>this.options.backend.acceptListEmailInvite(e),loadListEmailInvites:e=>this.options.backend.loadListEmailInvites(e)}}setupRemoteFunctions(){Object(a.d)(this.remoteFunctionsByTab,{insertExtraArg:!0})}executePendingActions(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){}))}performListShare(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{linksPromise:t,annotationSharingStatesPromise:n}=yield this.listSharingService.shareList(e);if(this.listShareSideEffectPromises[e.localListId]=Promise.all([n,t]),this.options.analyticsBG&&null==e.dontTrack)try{yield Object(F.j)(this.options.analyticsBG,{type:"shared"})}catch(e){console.error(`Error tracking space share event', ${e}`)}}))}shareAnnotations(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.storage.getRemoteAnnotationIds({localIds:e.annotationUrls}),n=yield this.storage.getPrivacyLevelsByAnnotation({annotations:e.annotationUrls}),r=e.annotationUrls.filter((e=>{var t;return![re.a.PROTECTED,re.a.SHARED_PROTECTED].includes(null===(t=n[e])||void 0===t?void 0:t.privacyLevel)}));if(yield this.storage.storeAnnotationMetadata(r.map((n=>{var r,i;return{localId:n,remoteId:null!==(r=t[n])&&void 0!==r?r:this.generateRemoteAnnotationId(),excludeFromLists:null===(i=!e.shareToParentPageLists)||void 0===i||i}}))),yield this.storage.setAnnotationPrivacyLevelBulk({annotations:r,privacyLevel:Object(Ri.j)({public:e.shareToParentPageLists,protected:e.setBulkShareProtected})}),this.options.analyticsBG&&!e.skipAnalytics)try{yield Object(F.i)(this.options.analyticsBG,{type:"bulk"})}catch(e){console.error(`Error tracking space create event', ${e}`)}return{sharingStates:yield this.getAnnotationSharingStates(e)}}))}getRemotePageIdLookupCache(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.options.contentSharingSettingsStore.get("remotePageIdLookup");return null!=e?e:{}}))}cacheRemotePageId(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.getRemotePageIdLookupCache();yield this.options.contentSharingSettingsStore.set("remotePageIdLookup",Object.assign(Object.assign({},n),{[e]:{remoteId:t,asOf:Date.now()}}))}))}lookupRemotePageIdInCache(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=(yield this.getRemotePageIdLookupCache())[e];return!t||Date.now()-t.asOf>Bi.ONE_WEEK_MS?null:null==t?void 0:t.remoteId}))}handlePostStorageChange(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){}))}performPageLinkCreation({remoteListEntryId:e,remoteListId:t,localListId:n,fullPageUrl:i,listTitle:o,collabKey:s,creator:a,tabId:c,now:l,pageTitle:u,skipPageIndexing:d}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=this.options.getBgModules();let h;if(d||(yield r.pages.indexPage({fullUrl:i,visitTime:l,tabId:c,metaData:{pageTitle:u}},{addInboxEntryOnCreate:!1})),h=u||(yield r.pages.getTitleForPage({fullPageUrl:i})),yield r.customLists.createCustomList({id:n,name:o,createdAt:new Date(l),dontTrack:!0,type:"page-link",remoteListId:t,collabKey:s}),yield r.customLists.insertPageToList({id:n,url:i,createdAt:new Date(l),skipPageIndexing:!0,suppressInboxEntry:!0,suppressVisitCreation:!0,pageTitle:h,dontTrack:!0}),yield r.pageActivityIndicator.createFollowedList({creator:a,name:o,sharedList:t,type:ji.PageLink},{invokeCloudSync:!0}),yield r.pageActivityIndicator.createFollowedListEntry({creator:a,normalizedPageUrl:Object(D.c)(i),entryTitle:h,followedList:t,hasAnnotationsFromOthers:!1,sharedListEntry:e,createdWhen:l,updatedWhen:l},{invokeCloudSync:!0}),yield this.options.backend.processListKey({type:ji.PageLink,allowOwnKeyProcessing:!0,listId:t,keyString:s.toString()}),this.options.analyticsBG)try{yield Object(F.g)(this.options.analyticsBG,{source:"extension"})}catch(e){console.error(`Error tracking space create event', ${e}`)}}))}}Bi.ONE_WEEK_MS=6048e5;class Gi{constructor(e){this.options=e,this.remoteFunctions={submitReply:t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const{contentConversations:n}=e.services;return n.submitReply(t)})),editReply:t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const{contentConversations:n}=e.services;return n.editReply(t)})),deleteReply:t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const{contentConversations:n}=e.services;return n.deleteReply(t)})),getThreadsForSharedAnnotations:({sharedAnnotationReferences:e,sharedListReference:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const{contentConversations:n}=this.options.serverStorage;return n.getThreadsForAnnotations({annotationReferences:e,sharedListReference:t})})),getRepliesBySharedAnnotation:({sharedAnnotationReference:e,sharedListReference:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const{contentConversations:n}=this.options.serverStorage;return n.getRepliesByAnnotation({annotationReference:e,sharedListReference:t})})),getOrCreateThread:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var{sharedAnnotationReference:t}=e,n=Object(r.__rest)(e,["sharedAnnotationReference"]);const{contentConversations:i}=this.options.serverStorage;return i.getOrCreateThread(Object.assign(Object.assign({},n),{annotationReference:t}))}))}}setupRemoteFunctions(){Object(a.d)(this.remoteFunctions)}}var qi=n(724);class Hi extends Error{}const $i=["/lib/browser-polyfill.js","/content_script.js"];class Wi{constructor(e){this.options=e,this.events=new At.EventEmitter,this.handleContentScriptInjectionError=e=>t=>{const n=`Cannot inject content-scripts into page "${e.url}" - reason: ${t.message}`;Object(Ve.b)(new Error(n)),console.error(n)},this.remoteFunctions={},e.browserAPIs.tabs.onRemoved.addListener((e=>this.events.emit("tabRemoved",{tabId:e})))}setupRemoteFunctions(){Object(a.f)(this.remoteFunctions)}extractRawPageContent(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t;try{t=yield Object(a.l)(e).extractRawPageContent()}catch(n){const r=yield this.options.browserAPIs.tabs.get(e);yield this.injectContentScripts(r),t=yield Object(a.l)(e).extractRawPageContent()}return t}))}getOpenTabsInCurrentWindow(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=this.options.browserAPIs.windows.WINDOW_ID_CURRENT;return(yield this.options.browserAPIs.tabs.query({windowId:e})).map((e=>({id:e.id,url:e.url}))).filter((e=>e.id&&e.url&&e.id!==this.options.browserAPIs.tabs.TAB_ID_NONE))}))}getFavIcon({tabId:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.options.browserAPIs.tabs.get(e);if(null!=(null==t?void 0:t.favIconUrl))return function(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(null==e)throw new Hi("Cannot fetch missing URL");const t=yield fetch(e);if(t.status>=400&&t.status<600)throw new Hi(t.statusText);const n=yield t.blob();return Object(P.a)(n)}))}(t.favIconUrl)}))}findTabIdByFullUrl(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.options.browserAPIs.tabs.query({url:e});return t.length?t[0].id:null}))}mapTabChunks(e,{chunkSize:t=10,query:n={},onError:i}={}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const o=yield this.options.browserAPIs.tabs.query(n);yield function(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=[];for(const o of hn(e,t)){const e=yield Promise.all(null!=i?o.map(((...e)=>n(...e).catch((t=>i(t,e[0]))))):o.map(n));r.push(...e)}return r}))}(o,t,e,i)}))}canTabRunContentScripts(e){const t=null==e?void 0:e.url;return!(null==t||!Object(De.a)({fullUrl:t})||(e=>e.url.startsWith("chrome-extension://")||e.url.startsWith("moz-extension://"))({url:t})||(e=>e.url.startsWith("chrome:")||e.url.startsWith("about:"))({url:t})||!Object(tn.b)({url:t}))}injectContentScriptsIfNeeded(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.options.browserAPIs.tabs.get(e);if(this.canTabRunContentScripts(t))try{yield Object(a.l)(e,{quietConsole:!0}).confirmTabScriptLoaded()}catch(e){yield this.injectContentScripts(t)}}))}injectContentScripts(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(this.canTabRunContentScripts(e))if("3"===this.options.manifestVersion)yield this.options.browserAPIs.scripting.executeScript({target:{tabId:e.id},files:$i}).catch(this.handleContentScriptInjectionError(e));else for(const t of $i)yield this.options.browserAPIs.tabs.executeScript(e.id,{file:t,runAt:"document_idle"}).catch(this.handleContentScriptInjectionError(e))}))}}Wi.isTabLoaded=e=>"complete"===e.status;const zi="https://readwise.io/api/v2/highlights/";class Vi{constructor(e){this.options=e,this.postHighlights=(e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){try{const n=yield this.options.fetch(zi,{method:"POST",headers:{Authorization:`Token ${e}`,"Content-Type":"application/json"},body:JSON.stringify({highlights:t.map((e=>Object.assign(Object.assign({},e),{highlighted_at:e.highlighted_at.toISOString()})))})});if(!n.ok){const e=yield n.json();throw new Error(`Request failed with status ${n.status}: ${e.message}`)}return{success:200===n.status}}catch(e){return console.error("Error posting highlights:",e),{success:!1,error:e.message}}})),this.validateKey=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.options.fetch(zi,{method:"GET",headers:{Authorization:`Token ${e}`,"Content-Type":"application/json"}});return{success:200===t.status||204===t.status}}))}}n(1249),n(290);const Ki=(e="",t=[])=>{if(!e.length&&!t.length)return;let n="";return t.length&&(n+="."+t.map(Xi).join(" .")+"\n"),e.length&&(n+=e),t.length&&(n+="\n"+t.map(Ji).join(" ")),n},Yi=(e=new Date)=>{const t=e=>e.toString().length<2?"0"+e:e;return"Memex note from: "+(e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate()))+" "+(t(e.getHours())+":"+t(e.getMinutes())+":"+t(e.getSeconds()))},Qi=e=>e?Object(Rn.b)(e,"TextPositionSelector").start:void 0,Xi=e=>e.replace(/\s+/g,"-"),Ji=e=>/\s+/.test(e)?`[[${e}]]`:`#${e}`;class Zi{constructor(e){this.options=e,this._apiKey=null,this._syncOnlyHighlights=null,this.getAnnotationTags=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.options.annotationsBG.annotationStorage.getTagsByAnnotationUrl(e)).map((e=>e.name))})),this.getAnnotationLists=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const{annotationsBG:t,customListsBG:n}=this.options,r=yield t.getListIdsForAnnotation({},{annotationId:e});return(yield n.storage.fetchListByIds(r)).map((e=>e.name))})),this.validateAPIKey=({key:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.readwiseAPI.validateKey(e)})),this.getAPIKey=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){if(null!=this._apiKey)return this._apiKey;const e=yield this.options.settingsStore.get("apiKey");return this._apiKey=null!=e?e:null,this._apiKey})),this.setAPIKey=({validatedKey:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.options.settingsStore.set("apiKey",e),this._apiKey=e})),this.setOnlyHighlightsSetting=({setting:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.options.settingsStore.set("onlyHighlightsSetting",e),this._syncOnlyHighlights=e})),this.getOnlyHighlightsSetting=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.options.settingsStore.get("onlyHighlightsSetting");return this._syncOnlyHighlights=null!=e&&e,e})),this.uploadAllAnnotations=({annotationFilter:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t,n,i;const o=function(e){const t={};return n=>Object(r.__awaiter)(this,void 0,void 0,(function*(){if(t[n])return t[n];const r=yield e.getPageData(n);if(!r)throw new Error("Can't get full URL for annotation to upload to Readwise");return t[n]=r,r}))}({getPageData:this.options.getPageData}),s=null!==(i=this._apiKey)&&void 0!==i?i:yield this.getAPIKey();if(!s)throw new Error("Attempted readwise highlight upload without API key set");const a=[];try{for(var c,l=Object(r.__asyncValues)(this.streamAnnotations());!(c=yield l.next()).done;){const t=c.value;if(null!=e&&!e(t))continue;const[n,r]=yield Promise.all([this.getAnnotationTags(t.url),this.getAnnotationLists(t.url)]);a.push(Object.assign(Object.assign({},t),{listNames:r,tags:n}))}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=l.return)&&(yield n.call(l))}finally{if(t)throw t.error}}const u=(yield Promise.all(a.map((e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield o(e.pageUrl);if(!e.body&&(yield this.getOnlyHighlightsSetting()))return null;const n=yield function(e,t){var n,i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){return{title:null!==(n=t.pageData.fullTitle)&&void 0!==n?n:t.pageData.url,source_url:t.pageData.fullUrl,source_type:"article",highlighted_at:e.createdWhen,location_type:"order",location:Qi(null==e?void 0:e.selector),note:Ki(Vt(null==e?void 0:e.comment),[...e.tags,...e.listNames]),text:(null===(i=null==e?void 0:e.body)||void 0===i?void 0:i.length)?Vt(e.body):Yi(null==e?void 0:e.createdWhen)}}))}(e,{pageData:t});return n}catch(e){return console.error(e),Ve.b(e),null}})))))).filter((e=>!!e));u.length&&(yield this.readwiseAPI.postHighlights(s,u))})),this.readwiseAPI=new Vi({fetch:e.fetch}),this.remoteFunctions={validateAPIKey:Object(a.j)(this.validateAPIKey),getAPIKey:Object(a.j)(this.getAPIKey),setAPIKey:Object(a.j)(this.setAPIKey),setOnlyHighlightsSetting:Object(a.j)(this.setOnlyHighlightsSetting),getOnlyHighlightsSetting:Object(a.j)(this.getOnlyHighlightsSetting),uploadAllAnnotations:Object(a.j)(this.uploadAllAnnotations)}}setupRemoteFunctions(){Object(a.f)(this.remoteFunctions)}streamAnnotations(){return Object(r.__asyncGenerator)(this,arguments,(function*(){yield Object(r.__await)(yield*Object(r.__asyncDelegator)(Object(r.__asyncValues)(yield Object(r.__await)(this.options.storageManager.operation("streamObjects","annotations")))))}))}}class eo{constructor(e){this.deps=e,this.checkActivityStatus=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.deps.authService.getCurrentUser();if(!e)return yield this.deps.setStatusCacheFlag(!1),"not-logged-in";const t=yield this.deps.getStatusCacheFlag();if(!0===t)return"has-unseen";const n=yield this.retreiveServerStatus(e.id),r="has-unseen"===n;return t!==r&&(yield this.deps.setStatusCacheFlag(r)),n})),this.markActivitiesAsSeen=(e=Date.now())=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.deps.authService.getCurrentUser();if(!e)return;yield this.deps.setStatusCacheFlag(!1);const t=Date.now();setTimeout((()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.deps.activityStreamsStorage.updateHomeFeedTimestamp({user:{type:"user-reference",id:e.id},timestamp:t})}))),3e4)}))}retreiveServerStatus(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){try{const[t,n]=yield Promise.all([this.deps.activityStreamsService.getHomeFeedInfo(),this.deps.activityStreamsStorage.retrieveHomeFeedTimestamp({user:{type:"user-reference",id:e}})]);return(null==t?void 0:t.latestActivityTimestamp)?(null==n?void 0:n.timestamp)?t.latestActivityTimestamp>n.timestamp?"has-unseen":"all-seen":"has-unseen":"all-seen"}catch(e){return null===(n=(t=this.deps).captureError)||void 0===n||n.call(t,e),"error"}}))}}class to{constructor(e){this.options=e,this.checkActivityStatus=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.service.checkActivityStatus()})),this.markActivitiesAsSeen=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.service.markActivitiesAsSeen()})),this.service=new eo({authService:e.authServices.auth,activityStreamsService:e.services.activityStreams,activityStreamsStorage:e.activityStreamsStorage,getStatusCacheFlag:()=>e.syncSettings.activityIndicator.get("feedHasActivity"),setStatusCacheFlag:t=>e.syncSettings.activityIndicator.set("feedHasActivity",t),captureError:e=>Ve.b(e)}),this.remoteFunctions={checkActivityStatus:this.checkActivityStatus,markActivitiesAsSeen:this.markActivitiesAsSeen}}setupRemoteFunctions(){Object(a.d)(this.remoteFunctions)}}class no{constructor(e){this.opts=e,this.runningStreamsCount=0,this.shouldInterruptStream=!1}queryAI(e,t,n,i,o,s,a){var c;return Object(r.__asyncGenerator)(this,arguments,(function*(){try{this.runningStreamsCount>0&&!o&&(this.shouldInterruptStream=!0),this.runningStreamsCount++;const l=`${this.opts.serviceURL}/summarize`,u=yield Object(r.__await)(fetch(l,{method:"POST",body:JSON.stringify({originalUrl:e,textToProcess:t,queryPrompt:n,apiKey:i,AImodel:s,promptData:a}),headers:{"Content-Type":"application/json"}}));if(!u.ok)return this.runningStreamsCount--,this.shouldInterruptStream=!1,yield Object(r.__await)(void 0);const d=null===(c=u.body)||void 0===c?void 0:c.getReader();if(!d)return this.runningStreamsCount--,this.shouldInterruptStream=!1,yield Object(r.__await)(void 0);const h=new TextDecoder;for(;;){const{done:e,value:t}=yield Object(r.__await)(d.read());if(e)break;if(this.shouldInterruptStream){this.shouldInterruptStream=!1,yield Object(r.__await)(d.cancel());break}const n=h.decode(t).trim().replace(/(?!\\n|\\")\\/g,"");try{const e=this.processChunk(n);for(let t of e){const e=t;this.shouldInterruptStream=!1,yield yield Object(r.__await)(e)}}catch(e){console.error("Error deserializing page summary value:",n),this.shouldInterruptStream=!1,this.runningStreamsCount--,console.error(e)}}this.shouldInterruptStream=!1,this.runningStreamsCount--}catch(e){this.shouldInterruptStream=!1,this.runningStreamsCount--}}))}processChunk(e){var t=e.match(/{[\s\S]*?}/g);let n=[];if(t&&t.length>0)for(let e of t){let t=e.replace(/\n/g,"\\n");let r=JSON.parse(t).t;r=r.replace(/\\n/g,"\n");const i={t:r};n.push(i)}return n}summarizeText(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=`${this.opts.serviceURL}/summarizeText`,r=yield fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({textSnippet:e,prompt:t})});return yield r.json()}))}isApiKeyValid(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield fetch("https://api.openai.com/v1/engines",{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}});return!!t.ok||(console.error("API key validation failed with status:",t.status),!1)}catch(e){return console.error("Error validating API key:",e),!1}}))}}var ro=n(31);class io{constructor(e){this.options=e,this.summarizationService=new no({serviceURL:tr.b.production}),this.onTabClosed=(e,t)=>{Object(er.f)(this.options.browserAPIs,e)},this.startPageSummaryStream=({tab:e},{fullPageUrl:t,textToProcess:n,queryPrompt:i,apiKey:o,outputLocation:s,chapterSummaryIndex:a,AImodel:c,promptData:l})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var u,d;if(!(yield this.saveActiveTabId((null==o?void 0:o.length)>0,c)))return;let h=null!=o?o:"";if((null==h?void 0:h.length)>0&&"gpt-3"===c){const e=(yield this.options.browserAPIs.storage.local.get(ro.a))[ro.a],t=null==e?void 0:e.pU;t&&(null==t?void 0:t.AIpowerup)&&(h=null)}if(this.options.remoteEventEmitter.emitToTab("startSummaryStream",e.id),this.options.analyticsBG)try{yield Object(F.h)(this.options.analyticsBG)}catch(e){console.error(`Error tracking space create event', ${e}`)}try{for(var f,p=Object(r.__asyncValues)(this.summarizationService.queryAI(t,n,i,o,void 0,c,l));!(f=yield p.next()).done;){const t=f.value,n=null==t?void 0:t.t;(null==n?void 0:n.length)>0&&("editor"===s?this.options.remoteEventEmitter.emitToTab("newSummaryTokenEditor",e.id,{token:n}):"chapterSummary"===s?this.options.remoteEventEmitter.emitToTab("newChapterSummaryToken",e.id,{token:n,chapterSummaryIndex:a}):this.options.remoteEventEmitter.emitToTab("newSummaryToken",e.id,{token:n}))}}catch(e){u={error:e}}finally{try{f&&!f.done&&(d=p.return)&&(yield d.call(p))}finally{if(u)throw u.error}}})),this.isApiKeyValid=({tab:e},{apiKey:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return{isValid:yield this.summarizationService.isApiKeyValid(t)}})),this.setActiveSidebarTab=({tab:e},{activeTab:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){this.options.remoteEventEmitter.emitToTab("setActiveSidebarTab",e.id,{activeTab:t})})),this.remoteFunctions={startPageSummaryStream:this.startPageSummaryStream,isApiKeyValid:this.isApiKeyValid,setActiveSidebarTab:this.setActiveSidebarTab}}setupRemoteFunctions(){Object(a.d)(this.remoteFunctions,{insertExtraArg:!0})}saveActiveTabId(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.options.browserAPIs.tabs.onRemoved.removeListener(this.onTabClosed),this.options.browserAPIs.tabs.onRemoved.addListener(this.onTabClosed);return!!(yield Object(er.f)(this.options.browserAPIs))||(yield Object(er.a)(this.options.browserAPIs,this.options.analyticsBG,e,t))}))}}var oo=n(1071),so=n(1073);class ao{constructor(e){this.options=e,this.storage={remote:new oo.a({storageManager:e.storageManager})},this.backend=new so.a({executeCall:e.callFirebaseFunction})}}class co extends c.a{constructor(){super(...arguments),this.getConfig=()=>({collections:{[xn.a.settings]:{version:Ae.b[25].version,fields:{key:{type:"string"},value:{type:"json"}},indices:[{field:"key",pk:!0}]}},operations:{createSetting:{operation:"createObject",collection:xn.a.settings},findSetting:{operation:"findObject",collection:xn.a.settings,args:{key:"$key:string"}},updateSetting:{operation:"updateObject",collection:xn.a.settings,args:[{key:"$key:string"},{value:"$value:json"}]},deleteSetting:{operation:"deleteObject",collection:xn.a.settings,args:{key:"$key:string"}}}})}setSetting(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("createSetting",e)}))}getSetting(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.operation("findSetting",{key:e});return null!==(t=null==n?void 0:n.value)&&void 0!==t?t:null}))}removeSetting(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findSetting",{key:e});return t?(yield this.operation("deleteSetting",{key:e}),t):null}))}}var lo=n(169);class uo{constructor(e){this.options=e,this.get=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){if("string"==typeof e){const t=yield this.storage.getSetting(e);return{[e]:t}}if(Array.isArray(e)){const t=yield Promise.all(e.map((e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return[e,yield this.storage.getSetting(e)]})))));return uo.formatKeyValsTuplesToDict(t)}const t=yield Promise.all(Object.keys(e).map((e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return[e,yield this.storage.getSetting(e)]})))));return uo.formatKeyValsTuplesToDict(t)})),this.set=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield Promise.all(Object.entries(e).map((([e,t])=>this.storage.setSetting({key:e,value:t}))))})),this.remove=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){"string"==typeof e?yield this.storage.removeSetting(e):yield Promise.all(e.map((e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return[e,yield this.storage.removeSetting(e)]})))))})),this.storage=new co({storageManager:e.storageManager}),this.remoteFunctions={remove:this.remove,get:this.get,set:this.set}}setupRemoteFunctions(){Object(a.d)(this.remoteFunctions)}__migrateLocalStorage(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{localBrowserStorage:e}=this.options,t=yield e.get(null);var n;yield this.set((n=t,{[xn.c.contentSharing.lastSharedAnnotationTimestamp]:n[j.a],[xn.c.dashboard.listSidebarLocked]:n[Zn.f.__OLD_listSidebarLocked],[xn.c.dashboard.onboardingMsgSeen]:n[Zn.f.__OLD_onboardingMsgSeen],[xn.c.searchInjection.hideMemexResults]:n[lo.e],[xn.c.searchInjection.memexResultsPosition]:n[lo.f],[xn.c.searchInjection.searchEnginesEnabled]:n[lo.g],[xn.c.pdfIntegration.shouldAutoOpen]:!0}))}))}}uo.formatKeyValsTuplesToDict=e=>{const t={};for(const[n,r]of e)t[n]=r;return t};var ho=n(243);class fo{constructor(e){this.deps=e,this.getTempPdfAccessUrl=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.deps.pdfUploads.getDownloadToken({uploadId:e}),n=tr.b.production;if("token"in t)return`${n}${ho.a}?token=${t.token}`;throw new Error(t.error)})),this.handlePagePut=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){if(e.isNew&&e.isPdf&&e.isLocalPdf&&e.tabId){if(!!0)return;yield this.uploadPdf({tabId:e.tabId,identifier:e.identifier})}})),this.uploadPdf=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=(yield this.deps.pageStorage.findLocatorsByNormalizedUrl(e.identifier.normalizedUrl)).find((e=>e.locationScheme===Z.f.UploadStorage));let n=null==t?void 0:t.location;if(n||(n=this.deps.generateUploadId(),yield this.deps.pageStorage.storeLocators({identifier:e.identifier,locators:[{format:Z.a.PDF,location:n,locationScheme:Z.f.UploadStorage,locationType:Z.b.Remote,normalizedUrl:e.identifier.normalizedUrl,originalLocation:e.identifier.fullUrl,primary:!0,valid:!0,status:"uploading",version:0,lastVisited:this.deps.getNow()}]})),"uploaded"===(null==t?void 0:t.status))return;const r=Object(a.l)(e.tabId);yield r.setPdfUploadState(!0);{const e=yield this.deps.pdfUploads.getUploadToken({uploadId:n});if(e.error)throw new Error(`Got error while trying to get PDF upload token: ${e.error}`);const{token:t}=e,{objectUrl:i}=yield r.getObjectUrlForPdf(),o=yield this.deps.fetch(i),s=yield o.blob();yield this.deps.pdfUploads.uploadPdfContent({token:t,content:s}),"2"===this.deps.manifestVersion&&URL.revokeObjectURL(i)}yield this.deps.pageStorage.updateLocatorStatus({locationScheme:Z.f.UploadStorage,normalizedUrl:e.identifier.normalizedUrl,status:"uploaded"}),yield r.setPdfUploadState(!1)})),this.remoteFunctions={getTempPdfAccessUrl:this.getTempPdfAccessUrl,openPdfViewerForNextPdf:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield e.storageAPI.local.set({[fo.OPEN_PDF_VIEWER_ONE_TIME_KEY]:!0})})),doNotOpenPdfViewerForNextPdf:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield e.storageAPI.local.set({[fo.OPEN_PDF_VIEWER_ONE_TIME_KEY]:!1})}))}}}fo.OPEN_PDF_VIEWER_ONE_TIME_KEY="@PDFViewer-should_use_viewer_next_open";var po=n(295);class go{constructor(){this._currentJobs=[]}lock(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=this._currentJobs.slice(-1)[0],t=mr()();this._currentJobs.push(t),yield e,this._allJobs||(this._allJobs=mr()());let n=!1;return{releaseMutex:()=>{if(n)return;n=!0,this._currentJobs.shift();const e=!this._currentJobs.length;if(t.resolve(),e){const e=this._allJobs;delete this._allJobs,e.resolve()}}}}))}wait(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this._allJobs}))}}class mo extends c.a{constructor(e){super(e),this.options=e,this.getConfig=()=>({collections:{[this.options.collectionName]:{version:this.options.versions.initial,fields:{createdWhen:{type:"timestamp"},action:{type:"json"}},indices:[{field:"createdWhen"}],backup:!1,watch:!1}},operations:{createAction:{operation:"createObject",collection:this.options.collectionName},getOldestAction:{operation:"findObject",collection:this.options.collectionName,args:[{},{order:[["createdWhen","asc"]]}]},deleteActionById:{operation:"deleteObject",collection:this.options.collectionName,args:{id:"$actionId"}},countPendingActions:{operation:"countObjects",collection:this.options.collectionName,args:{}}}})}queueAction(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{object:t}=yield this.operation("createAction",Object.assign({createdWhen:"$now"},e));return{actionId:t.id}}))}peekAction(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.operation("getOldestAction",{});return e?Object.assign({id:e.id},e.action):null}))}removeAction(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteActionById",e)}))}countPendingActions(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("countPendingActions",{})}))}}class yo{constructor(e){var t;this.options=e,this.events=new At.EventEmitter,this.forceQueueSkip=!1,this.pendingActionCount=0,this._queingAction=new go,this._executingPendingActions=new go,this.scheduleRetry=()=>{this._pendingActionsRetry=mr()(),this._scheduledRetry=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){delete this._scheduledRetry,delete this._scheduledRetryTimeout,yield this.executePendingActions()})),this._scheduledRetryTimeout=this.options.setTimeout(this._scheduledRetry,this.options.retryIntervalInMs)},e.setTimeout=null!==(t=e.setTimeout)&&void 0!==t?t:setTimeout,this.storage=new mo(e)}setup(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=e=>{var t,n;console.error(e),null===(n=(t=this.options).onSetupError)||void 0===n||n.call(t,e)};yield this.resetPendingActionCount().catch(t),(null==e?void 0:e.paused)&&this.pause(),this.executePendingActions().catch(t)}))}get isPaused(){return null!=this._paused}resetPendingActionCount(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.pendingActionCount=yield this.storage.countPendingActions()}))}pause(){this._paused||(this._paused=mr()())}unpause(){const e=this._paused;e&&(delete this._paused,e.resolve())}waitForSync(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this._executingPendingActions.wait()}))}scheduleAction(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.scheduleManyActions([e],t)}))}scheduleManyActions(e,t){var n,i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!t.skipValidation)for(const[t,r]of e.entries()){const o=null===(i=(n=this.options).preprocessAction)||void 0===i?void 0:i.call(n,{action:r});if(o){if(!1===o.valid)throw new Error(`Tried to queue invalid action (${r.type}): ${o.validationError}`);o.processed&&(e[t]=o.processed)}}if("skip-queue"===t.queueInteraction||this.forceQueueSkip){for(const t of e)yield this.options.executeAction({action:t});return}const{releaseMutex:r}=yield this._queingAction.lock();try{for(const t of e)yield this.storage.queueAction({action:t}),this._modifyPendingActionCount(1);r()}finally{r()}const o=this.executePendingActions();"queue-and-await"===t.queueInteraction&&(yield o),o.catch((e=>{}))}))}executePendingActions(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this._paused;const{releaseMutex:e}=yield this._executingPendingActions.lock();try{this._pendingActionsRetry&&(this._pendingActionsRetry.resolve(),delete this._pendingActionsRetry);try{for(;;){yield this._queingAction.wait(),yield this._paused;const e=yield this.storage.peekAction();if(!e)break;try{const t=yield this.options.executeAction({action:e});if(t&&t.pauseAndRetry)return this.pause(),void this.scheduleRetry()}catch(t){throw console.error("Error while executing action (retry scheduled):",e,t),t}this._modifyPendingActionCount(-1),yield this.storage.removeAction({actionId:e.id})}}catch(e){throw this.scheduleRetry(),e}}finally{e()}}))}forcePendingActionsRetry(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this._scheduledRetry()}))}_modifyPendingActionCount(e){this.pendingActionCount+=e,this.events.emit("statsChanged",{pendingActionCount:this.pendingActionCount})}}var vo=n(710);const bo=e=>()=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){const t=yield e.db.table("bookmarks").toCollection().primaryKeys(),n=yield e.db.table("annotations").orderBy("pageUrl").uniqueKeys(),i=yield e.db.table("pageListEntries").orderBy("pageUrl").uniqueKeys(),o=yield e.db.table("tags").orderBy("url").uniqueKeys(),s=new Set([...t,...n,...i,...o]),a=yield e.db.table("pages").toCollection().primaryKeys(),c=new Set(a),l=(u=c,d=s,new Set([...u].filter((e=>!d.has(e)))));var u,d;yield e.db.table("visits").where("url").anyOf([...l]).delete();const h=yield e.db.table("pages").where("url").anyOf([...l]).delete();if(yield function(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=new Map;yield e.db.table("visits").where("url").anyOf([...e.activePageUrls]).eachPrimaryKey((([e,n])=>{var r;const i=null!==(r=t.get(n))&&void 0!==r?r:[];t.set(n,[...i,e])}));const n=[];for(const[r,i]of t){if(i.length<e.visitLimit)continue;const t=i.sort().reverse().slice(e.visitLimit);n.push(...t.map((e=>[e,r])))}n.length&&(yield e.db.table("visits").bulkDelete(n))}))}(Object.assign(Object.assign({},e),{activePageUrls:s})),0===h)return;const f=yield e.db.table("pages").orderBy("hostname").uniqueKeys(),p=new Set(f);yield e.db.table("favIcons").where("hostname").noneOf([...p]).delete()}));class _o{constructor(e){this.options=e,this.pushMutex=new go,this.pullMutex=new go,this.deviceId=null,this.emitEvents=!0,this.debug=!1,this.strictErrorReporting=!1,this.stats={pendingDownloads:0,pendingUploads:0},this.isCloudSyncEnabled=()=>this.options.settingStore.get("isSetUp"),this.countPendingSyncDownloads=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.options.backend.countPendingUpdates({});this.stats.pendingDownloads=null!=e?e:0;return e})),this.invokeSyncDownload=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){this.options.backend.triggerSyncContinuation()})),this.enableSyncForNewInstall=(e=Date.now())=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.enableSync(),yield this.startSync()})),this.waitForSync=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){if(this._debugLog("waitForSync start"),yield this.pushMutex.wait(),this._debugLog("pushMutex done"),yield this.pullMutex.wait(),this._debugLog("pullMutex done"),yield this.actionQueue.waitForSync(),this._debugLog("actionQueue done"),this.strictErrorReporting&&this._integrationError)throw this._integrationError;this._debugLog("waitForSync done")})),this.processPersonalCloudAction=({action:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t;if(null==this.deviceId||null==(yield this.options.getUserId()))return this._debugLog("Tried to execute action without deviceId, so pausing the action queue"),{pauseAndRetry:!0};if(this._debugLog("Executing action",e),null===(t=this.reportExecutingAction)||void 0===t||t.call(this,e),e.type===Dn.PushObject&&e.updates.length>0){const{clientInstructions:t}=yield this.options.backend.pushUpdates(e.updates.map((e=>{var t;return e.type===Nn.c.Overwrite&&e.collection===We.b.pageMetadata&&isNaN(e.object.releaseDate)&&(e.object.releaseDate=void 0),Object.assign(Object.assign({},e),{deviceId:null!==(t=e.deviceId)&&void 0!==t?t:this.deviceId})})));t.length&&(yield this.actionQueue.scheduleAction({type:Dn.ExecuteClientInstructions,clientInstructions:t},{queueInteraction:"skip-queue"}))}else if(e.type===Dn.ExecuteClientInstructions){const{clientInstructions:t}=e;yield Promise.all(t.map((e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t;if(e.type===Nn.a.UploadToStorage){const n="persistent"===e.storage?this.options.persistentStorageManager:this.options.storageManager;if(!n.registry.collections[e.collection]){const t="Non-existing collection in clientInstruction:";return console.error(t,e),Ve.a({clientInstruction:e}),void Ve.b(new Error(t))}let r;try{r=yield n.collection(e.collection).findObject(e.uploadWhere)}catch(t){return console.error("Could not fetch dbObject for instruction",e,t),Ve.a({clientInstruction:e}),void Ve.b(t)}if(!r)return void this._debugLog("Could not find dbObject for clientInstruction:",e);let i=r[e.uploadField];if(e.uploadAsJson&&(i=new Blob([JSON.stringify(i)],{type:null!==(t=e.uploadContentType)&&void 0!==t?t:"application/json"})),!i||"string"!=typeof i&&!(i instanceof Blob)){const t="Don't know how to store object for instruction";return console.error(t,e),Ve.a({clientInstruction:e}),void Ve.b(new Error(t))}try{yield this.options.mediaBackend.uploadToMedia({deviceId:this.deviceId,mediaPath:e.uploadPath,mediaObject:i,changeInfo:e.changeInfo,contentType:e.uploadContentType})}catch(t){console.error("Could not execute client instruction",e),console.error(t),Ve.a({clientInstruction:e}),Ve.b(t)}}})))))}})),this.preprocessAction=e=>(this._debugLog("Scheduling action:",e),{valid:!0}),this.isPassiveDataRemovalNeeded=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const{localExtSettingStore:e}=this.options;return(yield e.get("installTimestamp"))<vo.d.getTime()})),this.actionQueue=new yo({storageManager:e.storageManager,collectionName:"personalCloudAction",versions:{initial:Ae.b[25].version},retryIntervalInMs:vo.e,executeAction:t=>Ft(this.processPersonalCloudAction(t),{runtimeAPI:e.webExtAPIs.runtime}),preprocessAction:this.preprocessAction,onSetupError:e=>Ve.b(e),setTimeout:(t,n)=>(e.webExtAPIs.alarms.create(vo.c,{when:Date.now()+n}),-1)}),this.setupEventListeners(),this.remoteFunctions={runDataMigration:this.waitForSync,isCloudSyncEnabled:this.isCloudSyncEnabled,invokeSyncDownload:this.invokeSyncDownload,countPendingSyncDownloads:this.countPendingSyncDownloads,enableCloudSyncForNewInstall:this.enableSyncForNewInstall,isPassiveDataRemovalNeeded:this.isPassiveDataRemovalNeeded,runPassiveDataClean:()=>{return(e={db:this.dexie,visitLimit:20}).db.transaction("rw!",["tags","pages","visits","favIcons","bookmarks","annotations","pageListEntries"],bo(e));var e}}}get dexie(){return this.options.storageManager.backend.dexie}setupEventListeners(){this.actionQueue.events.on("statsChanged",(e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){this._modifyStats({pendingUploads:e.pendingActionCount}),yield this.options.settingStore.set("lastSyncUpload",Date.now())})))),this.options.backend.events.on("incomingChangesProcessed",(e=>{const t=this.stats.pendingDownloads-e.count;this._modifyStats({pendingDownloads:t<0?0:t})}))}setup(){var e;return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.deviceId=yield this.options.settingStore.get("deviceId"),this.currentSchemaVersion=Object(St.c)(this.options.storageManager),yield this.actionQueue.setup({paused:!0}),this._modifyStats({pendingUploads:null!==(e=this.actionQueue.pendingActionCount)&&void 0!==e?e:0}),yield this.startSync()}))}observeAuthChanges(){var e,t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){try{for(var n,i=Object(r.__asyncValues)(this.options.authChanges());!(n=yield i.next()).done;){const{nextUser:e,deviceId:t}=n.value;this.deviceId=t,null!=e?(this.actionQueue.unpause(),yield this.startSync()):(this.actionQueue.pause(),this._modifyStats({pendingDownloads:0,pendingUploads:0}))}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&(yield t.call(i))}finally{if(e)throw e.error}}}))}enableSync(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.options.settingStore.set("isSetUp",!0)}))}startSync(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){null!=(yield this.options.getUserId())?this.actionQueue.unpause():this.actionQueue.pause(),this.pendingActionsExecuting||(this.pendingActionsExecuting=this.actionQueue.executePendingActions()),this.authChangesObserved||(this.authChangesObserved=this.observeAuthChanges()),this.changesIntegrating||(this.changesIntegrating=this.integrateContinuously())}))}_modifyStats(e){if(this.stats=Object.assign(Object.assign({},this.stats),e),this._debugLog("Updated stats",this.stats),this.emitEvents)try{this.options.remoteEventEmitter.emit("cloudStatsUpdated",{stats:this.stats})}catch(e){console.error("Error while emitting updated stats:",e)}}integrateAllUpdates(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{backend:e,settingStore:t}=this.options,{batch:n,lastSeen:r}=yield e.bulkDownloadUpdates();yield this.integrateUpdates(n),yield t.set("lastSeen",r)}))}integrateContinuously(){var e,t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{backend:n,settingStore:i}=this.options;try{try{for(var o,s=Object(r.__asyncValues)(n.streamUpdates({mode:"continuous-invocation",skipInvocationOnUserChange:!0}));!(o=yield s.next()).done;){const{batch:e,lastSeen:t}=o.value;try{yield Ft((()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.integrateUpdates(e),yield i.set("lastSeen",t)})))(),{runtimeAPI:this.options.webExtAPIs.runtime})}catch(e){if(this.strictErrorReporting)throw this._integrationError=e,e;console.error("Error integrating update from cloud",e),Ve.b(e)}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=s.return)&&(yield t.call(s))}finally{if(e)throw e.error}}}catch(e){this._integrationError=e,this.strictErrorReporting||console.error(e)}}))}__integrateContinuouslyForCollectionFromTime(e,t){var n,i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{backend:o,settingStore:s}=this.options;try{try{for(var a,c=Object(r.__asyncValues)(o.streamCollectionData({collectionNames:e,startTime:t}));!(a=yield c.next()).done;){const{batch:e,lastSeen:t}=a.value;try{yield this.integrateUpdates(e),yield s.set("lastSeen",t)}catch(e){if(this.strictErrorReporting)throw this._integrationError=e,e;console.error("Error integrating update from cloud",e),Ve.b(e)}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=c.return)&&(yield i.call(c))}finally{if(n)throw n.error}}}catch(e){this._integrationError=e,this.strictErrorReporting||console.error(e)}}))}sendCountPendingDownloadsDownUpdate(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(this.emitEvents)try{yield this.options.remoteEventEmitter.emit("cloudStatsUpdated",{stats:{pendingDownloads:this.stats.pendingDownloads-1,pendingUploads:this.stats.pendingUploads}})}catch(e){console.error("Error while emitting updated stats:",e)}}))}integrateUpdates(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this.options.remoteEventEmitter.emit("downloadStarted");const{releaseMutex:t}=yield this.pullMutex.lock();for(const t of e)yield this.integrateUpdate(t);t(),this.options.remoteEventEmitter.emit("downloadStopped")}))}integrateUpdate(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){this._debugLog("Processing update",e);const n=e.type!==Nn.c.Delete&&e.type!==Nn.c.Overwrite||"persistent"!==e.storage?this.options.storageManager:this.options.persistentStorageManager,i=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return!!(yield n.collection("customLists").findOneObject({id:e}))}));if(e.type===Nn.c.Overwrite){if(function(e){const t=e.storageRegistry.collections[e.collection];if(!t)throw new Error(`Got pulled object for non-existing collection: ${e.collection}`);for(const[n,r]of Object.entries(t.fields))"datetime"===r.type&&"number"==typeof e.object[n]&&(e.object[n]=new Date(e.object[n]))}({storageRegistry:n.registry,collection:e.collection,object:e.object}),e.media)try{yield this.downloadMedia(e)}catch(t){const n="Error while downloading media for update";console.error(`${n}:`,t),Ve.a({update:e}),Ve.b(new Error(t))}yield this.options.writeIncomingData({storageType:null!==(t=e.storage)&&void 0!==t?t:Nn.b.Normal,collection:e.collection,updates:e.object,where:e.where})}else if(e.type===Nn.c.Delete)yield n.backend.operation("deleteObjects",e.collection,e.where);else if(e.type===Nn.c.ListTreeMove){if(!(yield i(e.rootNodeLocalListId))||null!=e.parentLocalListId&&!(yield i(e.parentLocalListId)))return void this.sendCountPendingDownloadsDownUpdate();yield n.operation(je.a.moveTree,y.b.listTrees,{localListId:e.rootNodeLocalListId,newParentListId:e.parentLocalListId},{skipSync:!0})}else if(e.type===Nn.c.ListTreeDelete){if(!(yield i(e.rootNodeLocalListId)))return void this.sendCountPendingDownloadsDownUpdate();yield n.operation(je.a.deleteTree,y.b.listTrees,{localListId:e.rootNodeLocalListId},{skipSync:!0})}this.sendCountPendingDownloadsDownUpdate()}))}downloadMedia(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield Promise.all(Object.entries(e.media).map((([t,{path:n,type:i}])=>Object(r.__awaiter)(this,void 0,void 0,(function*(){let r=yield this.options.mediaBackend.downloadFromMedia({path:n});"text"!==i&&"json"!==i||r instanceof Blob&&(r=yield Object(ae.b)(r)),"json"===i&&(r=JSON.parse(r)),e.object[t]=r})))))}))}handleListTreeStorageChange(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.actionQueue.scheduleAction({type:Dn.PushObject,updates:[Object.assign(Object.assign({},e),{deviceId:this.deviceId,schemaVersion:this.currentSchemaVersion})]},{queueInteraction:"queue-and-return"})}))}handlePostStorageChange(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){this._debugLog("Process storage change:",e);const{releaseMutex:t}=yield this.pushMutex.lock();for(const t of e.info.changes){const{collection:e}=t;if("create"===t.type){const n=yield Object(po.c)(this.options.storageManager,e,t.pk);if(!n)continue;yield this.actionQueue.scheduleAction({type:Dn.PushObject,updates:[{type:Nn.c.Overwrite,schemaVersion:this.currentSchemaVersion,deviceId:this.deviceId,collection:e,object:this.preprocessObjectForPush({collection:e,object:n})}]},{queueInteraction:"queue-and-return"})}else if("modify"===t.type){const n=yield Promise.all(t.pks.map((t=>Object(po.c)(this.options.storageManager,e,t))));yield this.actionQueue.scheduleAction({type:Dn.PushObject,updates:n.filter((e=>!!e)).map((t=>({type:Nn.c.Overwrite,schemaVersion:this.currentSchemaVersion,deviceId:this.deviceId,collection:e,object:t})))},{queueInteraction:"queue-and-return"})}else if("delete"===t.type){const n=yield Promise.all(t.pks.map((t=>Object(po.e)(this.options.storageManager.registry,e,t))));yield this.actionQueue.scheduleAction({type:Dn.PushObject,updates:n.map((t=>({type:Nn.c.Delete,schemaVersion:this.currentSchemaVersion,deviceId:this.deviceId,collection:e,where:t})))},{queueInteraction:"queue-and-return"})}}t()}))}preprocessObjectForPush({collection:e,object:t}){for(const n of Object.keys(t))Object(St.e)({collection:e,field:n})&&delete t[n];return"pages"===e&&delete t.text,"favIcons"===e&&delete t.favIcon,t}getBlockStats(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.options.getUserId();if(!e)throw new Error("Cannot get block stats if not authenticated");const t=this.options.serverStorageManager,n=yield t.operation("findObject","personalBlockStats",{user:e});return n?n.usedBlocks:{usedBlocks:0}}))}_debugLog(...e){this.debug&&console.log("Personal Cloud -",...e)}}const wo=e=>function(){return Object(r.__asyncGenerator)(this,arguments,(function*(){var t,n;try{for(var i,o=Object(r.__asyncValues)(function(e){return Object(r.__asyncGenerator)(this,arguments,(function*(){let t=mr()();for(e.events.on("changed",(({user:e})=>{const n=t;t=mr()(),n.resolve(e)}));;){const e=yield Object(r.__await)(t);yield yield Object(r.__await)(e)}}))}(e.authService));!(i=yield Object(r.__await)(o.next())).done;){const t=i.value;if(null==t)yield yield Object(r.__await)({nextUser:t,deviceId:null});else{const n=yield Object(r.__await)(e.getDeviceId());let i=n;if(!n){const n=t.id;if(n){const t=yield Object(r.__await)(e.createDeviceId(n));yield Object(r.__await)(e.setDeviceId(t)),i=t}}yield yield Object(r.__await)({nextUser:t,deviceId:i})}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&(yield Object(r.__await)(n.call(o)))}finally{if(t)throw t.error}}}))};class To{constructor(e){this.options=e,this.events=new At.EventEmitter,this.newUpdateAdded=mr()(),this.continuousSyncCleanedUp=!1,this.countPendingUpdates=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t,n;const{getDeviceId:r,getClientDeviceType:i,getCurrentSchemaVersion:o,getLastUpdateProcessedTime:s}=this.options;let a=null!==(n=null!==(t=e.startTime)&&void 0!==t?t:yield s())&&void 0!==n?n:0;const c=yield r();if(!c)throw new Error("Could not get device ID - needed to query count");return this.options.personalCloudService.countPendingClientUpdates({startTime:a,clientSchemaVersion:o(),clientDeviceType:i(),filterByCollectionNames:e.collectionNames,deviceId:c})}))}countChanges(e){var t;return Object(r.__asyncGenerator)(this,arguments,(function*(){const n=this.options.serverStorageManager;let i=0,o=null!==(t=yield Object(r.__await)(this.options.getLastUpdateProcessedTime()))&&void 0!==t?t:0;for(;;){const t=yield Object(r.__await)(n.operation("findObjects","personalDataChange",{user:e.userReference.id,createdWhen:{$gt:o}},{order:[["createdWhen","asc"]],limit:100}));i+=t.length;const s=t.length>=100;if(yield yield Object(r.__await)({final:!s,totalCount:i}),!s)break;o=t[t.length-1].createdWhen}}))}pushUpdates(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.options.getDeviceId();return this.options.personalCloudService.uploadClientUpdates({updates:e,deviceId:t})}))}downloadUpdates(e){var t,n;return Object(r.__asyncGenerator)(this,arguments,(function*(){const{firebase:i,getDeviceId:o,getClientDeviceType:s,getCurrentSchemaVersion:a,personalCloudService:c,getLastUpdateProcessedTime:l}=this.options;if(!i.getAuth().currentUser)return yield Object(r.__await)(void 0);let u=null!==(n=null!==(t=null==e?void 0:e.startTime)&&void 0!==t?t:yield Object(r.__await)(l()))&&void 0!==n?n:0;for(;;){const e=yield Object(r.__await)(o());if(!e)break;const t=yield Object(r.__await)(c.downloadClientUpdates({startTime:u,clientSchemaVersion:a(),clientDeviceType:s(),deviceId:e}));if(yield yield Object(r.__await)(t),u=t.lastSeen,this.events.emit("incomingChangesProcessed",{count:t.changesProcessed-t.ownChangesProcessed}),!t.maybeHasMore)break}}))}streamCollectionData({collectionNames:e,startTime:t}){var n;return Object(r.__asyncGenerator)(this,arguments,(function*(){const{firebase:i,getDeviceId:o,getClientDeviceType:s,getCurrentSchemaVersion:a,personalCloudService:c,getLastCollectionDataProcessedTime:l}=this.options;if(!i.getAuth().currentUser)return yield Object(r.__await)(void 0);let u=null!==(n=null!=t?t:yield Object(r.__await)(l()))&&void 0!==n?n:0;const d=yield Object(r.__await)(o());for(;;){const t=yield Object(r.__await)(c.downloadClientUpdates({startTime:u,clientSchemaVersion:a(),clientDeviceType:s(),filterByCollectionNames:e,deviceId:d}));if(yield yield Object(r.__await)(t),u=t.lastSeen,this.events.emit("incomingChangesProcessed",{count:t.changesProcessed-t.ownChangesProcessed}),!t.maybeHasMore)break}}))}bulkDownloadUpdates(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const i=[];let o=0;try{for(var s,a=Object(r.__asyncValues)(this.downloadUpdates(e));!(s=yield a.next()).done;){const e=s.value;i.push(...e.batch),o=e.lastSeen}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&(yield n.call(a))}finally{if(t)throw t.error}}return{batch:i,lastSeen:o}}))}triggerSyncContinuation(){this.continuousSyncCleanedUp||this.newUpdateAdded.resolve()}streamUpdates({mode:e,startTime:t,skipInvocationOnUserChange:n}){return Object(r.__asyncGenerator)(this,arguments,(function*(){let i=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){}));const o=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var e,n;this.continuousSyncCleanedUp=!1,this.newUpdateAdded=mr()();let o=()=>{};if(this.options.setupSyncTriggerListener){const r=null!==(e=null!=t?t:yield this.options.getLastUpdateProcessedTime())&&void 0!==e?e:0,i=this.options.setupSyncTriggerListener(r,this.options.getDeviceId,(e=>{this.events.emit("incomingChangesPending",{changeCountDelta:e}),this.triggerSyncContinuation()}));o=null!==(n=null==i?void 0:i.unsubscribe)&&void 0!==n?n:()=>{}}i=this.options.firebase.getAuth().currentUser?()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){this.continuousSyncCleanedUp=!0,o()})):()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){}))}));if(yield Object(r.__await)(o()),"single-invocation"===e)yield Object(r.__await)(yield*Object(r.__asyncDelegator)(Object(r.__asyncValues)(this.downloadUpdates({startTime:t}))));else if("continuous-invocation"===e){const e=this.options.authChanges();for(;;){const t=yield Object(r.__await)(Promise.race([this.newUpdateAdded.then((()=>"added")),e.next().then((()=>"user-change"))]));if("user-change"===t)yield Object(r.__await)(i()),yield Object(r.__await)(o()),n||(yield Object(r.__await)(yield*Object(r.__asyncDelegator)(Object(r.__asyncValues)(this.downloadUpdates()))));else if("added"===t){this.newUpdateAdded=mr()();let e=3;for(;;)try{yield Object(r.__await)(yield*Object(r.__asyncDelegator)(Object(r.__asyncValues)(this.downloadUpdates())));break}catch(t){yield Object(r.__await)(new Promise((t=>setTimeout(t,1e3*e)))),e*=e}}}}}))}}class Eo{constructor(e){this.options=e,this.uploadToMedia=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t,n;const{firebase:i,serverStorageManager:o}=this.options,s=null===(t=i.getAuth().currentUser)||void 0===t?void 0:t.uid;if(!s)throw new Error("User tried to upload to storage without being logged in");let{mediaPath:a}=e;a.startsWith("/")&&(a=a.slice(1));const c=i.ref(i.getStorage(),a);"string"==typeof e.mediaObject?yield i.uploadString(c,e.mediaObject,"raw",{contentType:null!==(n=e.contentType)&&void 0!==n?n:"text/plain"}):yield i.uploadBytes(c,e.mediaObject),yield function(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r={type:Z.c.Modify,createdWhen:null!==(n=null===(t=e.getNow)||void 0===t?void 0:t.call(e))&&void 0!==n?n:"$now",collection:":media",objectId:e.mediaPath,info:e.changeInfo};yield e.storageManager.collection("personalDataChange").createObject(Object.assign(Object.assign({},r),{user:e.userId,createdByDevice:e.deviceId}))}))}(Object.assign(Object.assign({},e),{storageManager:o,userId:s}))})),this.downloadFromMedia=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const{firebase:t}=this.options;let{path:n}=e;n.startsWith("/")&&(n=n.slice(1));const r=t.ref(t.getStorage(),n),i=yield t.getDownloadURL(r);if(!i)return null;const o=yield fetch(i);return yield o.blob()}))}}const Ao=e=>t=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){return(yield e.serverStorage.personalCloud.createDeviceInfo({userId:t,device:e.personalDeviceInfo})).id}));class So extends c.a{constructor(){super(...arguments),this.getConfig=()=>({collections:{[So.BACKLOG_COLL]:{version:Ae.b[18].version,fields:{url:{type:"string"},createdAt:{type:"datetime"},timesRetried:{type:"int"},lastRetry:{type:"datetime"}},indices:[{field:"createdAt"}],watch:!1,backup:!1}},operations:{createEntry:{collection:So.BACKLOG_COLL,operation:"createObject"},findOldestEntry:{collection:So.BACKLOG_COLL,operation:"findObject",args:{}},findOldestEntries:{collection:So.BACKLOG_COLL,operation:"findObjects",args:[{},{limit:"$limit:int"}]},deleteEntry:{collection:So.BACKLOG_COLL,operation:"deleteObject",args:{id:"$id:pk"}},deleteEntries:{collection:So.BACKLOG_COLL,operation:"deleteObjects",args:{id:{$in:"$ids:pk"}}}}})}}So.BACKLOG_COLL="pageFetchBacklog";const Oo=n(889);class Io extends c.a{getConfig(){return{collections:{clientSyncLogEntry:{version:new Date("2020-08-21"),fields:{createdOn:{type:"timestamp"},sharedOn:{type:"timestamp"},deviceId:{type:"json"},needsIntegration:{type:"int"},collection:{type:"string"},pk:{type:"json"},field:{type:"string",optional:!0},operation:{type:"string"},value:{type:"json",optional:!0}},indices:[{field:["deviceId","createdOn"],pk:!0},{field:"createdOn"},{field:["collection","pk"]},{field:"sharedOn"},{field:"needsIntegration"},{field:["createdOn","sharedOn"]}],history:[{version:new Date("2019-02-05"),fields:{createdOn:{type:"timestamp"},sharedOn:{type:"timestamp",optional:!0},deviceId:{type:"json"},needsIntegration:{type:"boolean",optional:!0},collection:{type:"string"},pk:{type:"json"},field:{type:"string",optional:!0},operation:{type:"string"},value:{type:"json",optional:!0}},indices:[{field:["deviceId","createdOn"],pk:!0},{field:"createdOn"},{field:["collection","pk"]}]},{version:new Date("2020-07-15"),fields:{createdOn:{type:"timestamp"},sharedOn:{type:"timestamp"},deviceId:{type:"json"},needsIntegration:{type:"int"},collection:{type:"string"},pk:{type:"json"},field:{type:"string",optional:!0},operation:{type:"string"},value:{type:"json",optional:!0}},indices:[{field:["deviceId","createdOn"],pk:!0},{field:"createdOn"},{field:["collection","pk"]},{field:"sharedOn"},{field:"needsIntegration"}]}]}},operations:{createEntry:{operation:"createObject",collection:"clientSyncLogEntry"},findEntriesCreatedAfter:{operation:"findObjects",collection:"clientSyncLogEntry",args:[{createdOn:{$gte:"$timestamp:timestamp"}}]},updateSharedUntil:{operation:"updateObjects",collection:"clientSyncLogEntry",args:[{createdOn:{$lte:"$until:timestamp"},sharedOn:0},{sharedOn:"$sharedOn:timestamp"}]},findUnsharedEntries:{operation:"findObjects",collection:"clientSyncLogEntry",args:{sharedOn:{$eq:0}}},findUnsharedEntryBatch:{operation:"findObjects",collection:"clientSyncLogEntry",args:[{sharedOn:{$eq:0}},{limit:"$limit:number"}]},markAsIntegrated:{operation:"executeBatch",args:["$batch"]},findFirstUnintegratedEntry:{operation:"findObjects",collection:"clientSyncLogEntry",args:[{needsIntegration:1},{order:[["createdOn","asc"]],limit:1}]},findEntriesByObjectPk:{operation:"findObjects",collection:"clientSyncLogEntry",args:[{collection:"$collection:string",pk:"$pk"},{order:[["createdOn","asc"]]}]},deleteObsoleteEntries:{operation:"deleteObjects",collection:"clientSyncLogEntry",args:{needsIntegration:0,sharedOn:{$gt:0}}}}}}insertEntries(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){for(const t of e)yield this.operation("createEntry",t)}))}insertReceivedEntries(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.insertEntries(e.map((e=>{const n=e.data,r={createdOn:e.createdOn,sharedOn:"string"==typeof t.now?Date.now():t.now,deviceId:e.deviceId,needsIntegration:1,collection:n.collection,pk:n.pk};if("create"===n.operation)return Object.assign(Object.assign({},r),{operation:"create",value:n.value});if("modify"===n.operation)return Object.assign(Object.assign({},r),{operation:"modify",field:n.field,value:n.value});if("delete"===n.operation)return Object.assign(Object.assign({},r),{operation:"delete"});throw new Error(`Unknown operation received: ${n.operation}`)})))}))}getEntriesCreatedAfter(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return Oo(yield this.operation("findEntriesCreatedAfter",{timestamp:e}),"createdOn")}))}updateSharedUntil({until:e,sharedOn:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("updateSharedUntil",{until:e,sharedOn:t})}))}getUnsharedEntries(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t;return t=e&&e.batchSize?yield this.operation("findUnsharedEntryBatch",{limit:e.batchSize}):yield this.operation("findUnsharedEntries",{}),Oo(t,"createdOn")}))}markAsIntegrated(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("markAsIntegrated",{batch:this.getMarkAsIntegratedBatchSteps(e)})}))}getMarkAsIntegratedBatchSteps(e){return e.map((e=>({operation:"updateObjects",collection:"clientSyncLogEntry",where:{deviceId:e.deviceId,createdOn:e.createdOn},updates:{needsIntegration:0}})))}getNextEntriesToIntgrate(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.operation("findFirstUnintegratedEntry",{});if(!e.length)return null;const t=e[0];return yield this.operation("findEntriesByObjectPk",{collection:t.collection,pk:t.pk})}))}deleteObsoleteEntries(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteObsoleteEntries",{})}))}}var Co=n(275),ko=n.n(Co);function Po(e){const t=H()(e.mappings.map((e=>[e.moduleVersion.getTime(),e]))),n=e.mappings.reduce(((e,t)=>Math.min(e,t.moduleVersion.getTime())),new Date("2100-01-01").getTime()),r=t[n].applicationVersion,i=e=>e.version.getTime(),o=(e,n,r,i)=>{const o=t[r];if(!o){if(i.optional)return null;throw new Error("Could not map collection version of collection "+e+" to application version: "+n.version.toISOString())}return Object.assign(Object.assign({},n),{version:o.applicationVersion})};return ko()(e.collectionDefinitions,((e,t)=>{const s=(e.history||[]).map((e=>{const r=i(e);return r<n?null:o(t,e,r,{optional:!1})})).filter((e=>!!e)),a=i(e);let c=o(t,e,a,{optional:!s.length});return c||(c=Object.assign(Object.assign({},e),{version:new Date(r)})),Object.assign(Object.assign({},c),{history:s})}))}class xo extends c.a{getConfig(){return{collections:{syncDeviceInfo:{version:new Date("2019-11-20"),fields:{deviceId:{type:"string"},createdWhen:{type:"timestamp"},productType:{type:"string"},devicePlatform:{type:"string",optional:!0},label:{type:"string",optional:!0}},indices:[{field:"deviceId",pk:!0}]}},operations:{createSyncDeviceInfo:{operation:"createObject",collection:"syncDeviceInfo"},getDevice:{operation:"findObject",collection:"syncDeviceInfo",args:{deviceId:"$deviceId:string"}},getAllDevices:{operation:"findObjects",collection:"syncDeviceInfo",args:{}},removeDevice:{collection:"syncDeviceInfo",operation:"deleteObjects",args:{deviceId:"$deviceId:string"}},removeAllDevices:{collection:"syncDeviceInfo",operation:"deleteObjects",args:{}}}}}createDeviceInfo(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){e=Object.assign(Object.assign({},e),{deviceId:e.deviceId.toString()}),(yield this.operation("getDevice",e))||(yield this.operation("createSyncDeviceInfo",Object.assign(Object.assign({},e),{createdWhen:Date.now()})))}))}listDevices(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("getAllDevices",{})}))}removeDevice(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("removeDevice",{deviceId:e})}))}removeAllDevices(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("removeAllDevices",{})}))}}class Ro extends Io{getConfig(){const e=super.getConfig();e.collections=Po({collectionDefinitions:e.collections,mappings:[{moduleVersion:new Date("2019-02-05"),applicationVersion:Ae.b[18].version},{moduleVersion:new Date("2020-07-15"),applicationVersion:Ae.b[20].version},{moduleVersion:new Date("2020-08-21"),applicationVersion:Ae.b[21].version}]});for(const t of[e.collections.clientSyncLogEntry,...e.collections.clientSyncLogEntry.history])t.backup=!1,t.watch=!1;return e}}class Lo extends xo{getConfig(){var e;const t=super.getConfig();t.collections=Po({collectionDefinitions:t.collections,mappings:[{moduleVersion:new Date("2019-11-20"),applicationVersion:Ae.b[18].version}]});for(const n of[t.collections.syncDeviceInfo,...null!==(e=t.collections.syncDeviceInfo.history)&&void 0!==e?e:[]])n.backup=!1,n.watch=!1;return t}}class Do{constructor({storageManager:e}){this.syncInfoStorage=new Lo({storageManager:e}),this.clientSyncLogStorage=new Ro({storageManager:e}),this.pageFetchBacklogStorage=new So({storageManager:e}),this.readwiseActionQueueStorage=new mo({storageManager:e,collectionName:"readwiseAction",versions:{initial:Ae.b[22].version}})}}var No=n(1054);const jo=(e,t)=>({name:e.title,type:e.type,sharedList:e.id,creator:e.creator,platform:e.platform,lastSync:null==t?void 0:t.lastSync}),Mo=(e,t)=>{var n,r;return{id:null==t?void 0:t.id,sharedListEntry:e.id,followedList:e.sharedList,createdWhen:e.createdWhen,updatedWhen:e.updatedWhen,entryTitle:null!==(n=e.entryTitle)&&void 0!==n?n:"",normalizedPageUrl:e.normalizedUrl,creator:e.creator,hasAnnotationsFromOthers:null!==(r=null==t?void 0:t.hasAnnotationsFromOthers)&&void 0!==r&&r}},Fo=e=>"sharedList"in e?`${e.sharedList}-${e.normalizedUrl}`:`${e.followedList}-${e.normalizedPageUrl}`;class Uo extends c.a{constructor(e){super(e),this.options=e}getConfig(){return{collections:No.a,operations:{createFollowedList:{collection:"followedList",operation:"createObject"},createFollowedListEntry:{collection:"followedListEntry",operation:"createObject"},findFollowedListsByIds:{collection:"followedList",operation:"findObjects",args:{sharedList:{$in:"$followedListIds:string[]"}}},findAllFollowedLists:{collection:"followedList",operation:"findObjects",args:{}},findFollowedListEntries:{collection:"followedListEntry",operation:"findObjects",args:{followedList:"$followedList:string"}},findFollowedListEntriesByPage:{collection:"followedListEntry",operation:"findObjects",args:{normalizedPageUrl:"$normalizedPageUrl:string"}},findFollowedListEntriesForLists:{collection:"followedListEntry",operation:"findObjects",args:[{followedList:{$in:"$followedLists:string[]"}},{order:[["createdWhen","asc"]]}]},deleteAllFollowedLists:{collection:"followedList",operation:"deleteObjects",args:{}},deleteAllFollowedListEntries:{collection:"followedListEntry",operation:"deleteObjects",args:{}},deleteFollowedList:{collection:"followedList",operation:"deleteObject",args:{sharedList:"$sharedList:string"}},deleteFollowedListEntry:{collection:"followedListEntry",operation:"deleteObjects",args:{followedList:"$followedList:string",normalizedPageUrl:"$normalizedPageUrl:string"}}}}}createFollowedList(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n={name:e.name,type:e.type,creator:e.creator,lastSync:e.lastSync,platform:e.platform,sharedList:e.sharedList};if(null==t?void 0:t.invokeCloudSync){const{object:e}=yield this.operation("createFollowedList",n);return e.id}const{object:r}=yield this.options.storageManager.backend.operation("createObject","followedList",n);return r.id}))}createFollowedListEntry(e,t){var n,i,o;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r={creator:e.creator,entryTitle:e.entryTitle,followedList:e.followedList,sharedListEntry:e.sharedListEntry,normalizedPageUrl:e.normalizedPageUrl,hasAnnotationsFromOthers:null!==(n=e.hasAnnotationsFromOthers)&&void 0!==n&&n,createdWhen:null!==(i=e.createdWhen)&&void 0!==i?i:Date.now(),updatedWhen:null!==(o=e.updatedWhen)&&void 0!==o?o:Date.now()};if(null==t?void 0:t.invokeCloudSync){const{object:e}=yield this.operation("createFollowedListEntry",r);return e.id}const{object:s}=yield this.options.storageManager.backend.operation("createObject","followedListEntry",r);return s.id}))}findFollowedListsByIds(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findFollowedListsByIds",{followedListIds:e});return new Map(t.map((e=>[e.sharedList,e])))}))}findAllFollowedLists(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.operation("findAllFollowedLists",{});return new Map(e.map((e=>[e.sharedList,e])))}))}findAllFollowedListEntries(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findFollowedListEntries",{followedList:e.sharedList});return new Map(t.map((e=>[Fo(e),e])))}))}findFollowedListEntriesByPage(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.operation("findFollowedListEntriesByPage",{normalizedPageUrl:e.normalizedPageUrl})}))}findFollowedListEntriesForLists(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){let n=yield this.operation("findFollowedListEntriesForLists",{followedLists:e});n=n.sort(((e,t)=>e.createdWhen-t.createdWhen));const r={};for(const e of n){const n=null!==(t=r[e.followedList])&&void 0!==t?t:[];n.push(e),r[e.followedList]=n}return r}))}updateFollowedListLastSync(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.options.storageManager.backend.operation("updateObject","followedList",{sharedList:e.sharedList},{lastSync:e.lastSync})}))}updateFollowedListEntryHasAnnotations(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.options.storageManager.backend.operation("updateObjects","followedListEntry",{followedList:e.followedList,normalizedPageUrl:e.normalizedPageUrl},{hasAnnotationsFromOthers:e.hasAnnotationsFromOthers,updatedWhen:null!==(t=e.updatedWhen)&&void 0!==t?t:Date.now()})}))}deleteFollowedListEntry(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteFollowedListEntry",{followedList:e.followedList,normalizedPageUrl:e.normalizedPageUrl})}))}deleteFollowedListAndAllEntries(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.options.storageManager.backend.operation("deleteObjects","followedListEntry",{followedList:e.sharedList}),yield this.operation("deleteFollowedList",{sharedList:e.sharedList})}))}deleteAllFollowedListsData(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteAllFollowedLists",{}),yield this.operation("deleteAllFollowedListEntries",{})}))}}var Bo=n(235);class Go{constructor(e){this.deps=e,this.syncFollowedListEntriesWithNewActivity=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.storage.findAllFollowedLists();if(!t.size)return;const n=tr.b.production,r={sharedListIds:[...t.keys()].map((e=>e.toString()))},i=yield this.deps.fetch(n+Bo.a,{method:"POST",body:JSON.stringify(r)});if(!i.ok)return void Ve.b(new Error(`Could not reach Cloudflare worker to check sharedLists' timestamp - response text: ${yield i.text()}`));const o=yield i.json();if(!Array.isArray(o))return void Ve.b(new Error(`Received unexpected response data from Cloudflare worker - data: ${o}`));if(!o.length)return;const s=new Map(o),a=[];for(const[e,n]of t)(null==n.lastSync||s.get(e.toString())>n.lastSync)&&a.push(n);a.length>0&&(yield this.syncFollowedListEntries({forFollowedLists:a,now:null==e?void 0:e.now}))})),this.getAllFollowedLists=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.storage.findAllFollowedLists();return H()([...e.values()].map((e=>[e.sharedList,{sharedList:e.sharedList,creator:e.creator,name:e.name,type:e.type}])))})),this.getPageFollowedLists=(e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=Object(D.c)(e),r=yield this.storage.findFollowedListEntriesByPage({normalizedPageUrl:n}),i=new Map(r.map((e=>[e.followedList,e.hasAnnotationsFromOthers]))),o=yield this.storage.findFollowedListsByIds([...i.keys(),...null!=t?t:[]]);return H()([...o.values()].map((e=>{var t;return[e.sharedList,{hasAnnotationsFromOthers:null!==(t=i.get(e.sharedList))&&void 0!==t&&t,sharedList:e.sharedList,creator:e.creator,name:e.name,type:e.type}]})))})),this.getPageActivityStatus=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=Object(D.c)(e),n=yield this.storage.findFollowedListEntriesByPage({normalizedPageUrl:t}),r=yield this.getCurrentUser();if(null==r)return{status:"no-activity",remoteListIds:[]};const i=n.filter((e=>e.hasAnnotationsFromOthers)).map((e=>e.followedList));if(i.length)return{status:"has-annotations",remoteListIds:i};const o=n.filter((e=>!e.hasAnnotationsFromOthers&&e.creator!==r.id)).map((e=>e.followedList));return o.length?{status:"no-annotations",remoteListIds:o}:{status:"no-activity",remoteListIds:[]}})),this.getEntriesForFollowedLists=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.storage.findFollowedListEntriesForLists(e)})),this.createFollowedList=(e,t)=>this.storage.createFollowedList(e,t),this.createFollowedListEntry=(e,t)=>this.storage.createFollowedListEntry(e,t),this.updateFollowedListEntryHasAnnotations=e=>this.storage.updateFollowedListEntryHasAnnotations(e),this.deleteFollowedListEntry=e=>this.storage.deleteFollowedListEntry(e),this.deleteFollowedListAndAllEntries=e=>this.storage.deleteFollowedListAndAllEntries(e),this.deleteAllFollowedListsData=()=>this.storage.deleteAllFollowedListsData(),this.storage=new Uo({storageManager:e.storageManager,pkmSyncBG:e.pkmSyncBG}),this.remoteFunctions={getAllFollowedLists:this.getAllFollowedLists,getPageFollowedLists:this.getPageFollowedLists,getPageActivityStatus:this.getPageActivityStatus,getEntriesForFollowedLists:this.getEntriesForFollowedLists}}getCurrentUser(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.deps.getCurrentUserId();return null==e?null:{type:"user-reference",id:e}}))}syncFollowedLists(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(null==(yield this.getCurrentUser()))return;const e=yield this.deps.contentSharingBackend.loadUserFollowedLists();if("permission-denied"===e.status)return;const t=e.data,n=yield this.storage.findAllFollowedLists();for(const e of n.values())t.find((t=>t.id===e.sharedList))||(yield this.storage.deleteFollowedListAndAllEntries({sharedList:e.sharedList}));for(const e of t)if(!n.get(e.id)){const t=jo(e);yield this.storage.createFollowedList(t,{invokeCloudSync:!1})}}))}syncFollowedListEntries(e){var t,n,i,o;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=null!==(t=null==e?void 0:e.now)&&void 0!==t?t:Date.now();if(null==(yield this.getCurrentUser()))return;const s=null!==(n=null==e?void 0:e.forFollowedLists)&&void 0!==n?n:[...(yield this.storage.findAllFollowedLists()).values()],a=yield this.deps.contentSharingBackend.loadEntriesForLists({listIds:s.map((e=>({listId:e.sharedList,from:e.lastSync})))});for(const e of s){let t=!1;const n=yield this.storage.findAllFollowedListEntries({sharedList:e.sharedList}),s=a[e.sharedList],c="success"!==s.status?[]:s.data.listEntries,l="success"!==s.status?{}:s.data.annotationListEntries;t=c.length>0;for(const e of c){const t=!!(null===(i=l[e.normalizedUrl])||void 0===i?void 0:i.length),o=n.get(Fo(Object.assign(Object.assign({},e),{sharedList:e.sharedList.id})));if(o)o.hasAnnotationsFromOthers!==t&&(yield this.storage.updateFollowedListEntryHasAnnotations({normalizedPageUrl:e.normalizedUrl,followedList:e.sharedList.id,hasAnnotationsFromOthers:t,updatedWhen:r}));else{const n=Mo(Object.assign(Object.assign({},e),{id:e.reference.id,creator:e.creator.id,sharedList:e.sharedList.id}),{hasAnnotationsFromOthers:t});yield this.storage.createFollowedListEntry(n,{invokeCloudSync:!1})}}const u=Object.values(l).flat().filter((e=>!c.find((t=>t.normalizedUrl===e.normalizedPageUrl))));for(const e of u){const i=n.get(Fo({normalizedUrl:e.normalizedPageUrl,sharedList:e.sharedList.id}));(null==i?void 0:i.hasAnnotationsFromOthers)||(t=!0,yield this.storage.updateFollowedListEntryHasAnnotations({normalizedPageUrl:e.normalizedPageUrl,followedList:e.sharedList.id,updatedWhen:r,hasAnnotationsFromOthers:!0}))}for(const e of n.values())e.hasAnnotationsFromOthers&&!(null===(o=l[e.normalizedPageUrl])||void 0===o?void 0:o.length)&&(t=!0,yield this.storage.updateFollowedListEntryHasAnnotations({normalizedPageUrl:e.normalizedPageUrl,followedList:e.followedList,updatedWhen:r,hasAnnotationsFromOthers:!1}));t&&(yield this.storage.updateFollowedListLastSync({sharedList:e.sharedList,lastSync:r}))}}))}}const qo=e=>({storageType:t,collection:n,updates:i,where:o})=>Object(r.__awaiter)(void 0,void 0,void 0,(function*(){var s;let a=o;const c=t===Nn.b.Persistent?e.persistentStorageManager:e.storageManager;if("annotations"===n){(function(e,t){const n=/!\[.*?\]\((data:image\/(?:png|jpeg|gif);base64,[\w+/=]+)\)/g;if(!n.test(e.comment))return[];n.lastIndex=0;const r=e.comment.matchAll(n),i=new Map,o=[];for(const n of r){const r=null==n?void 0:n[1];if(!r)continue;const s=t.generateImageId();o.push(t.uploadImage({id:s,image:r,annotationUrl:e.url,normalizedPageUrl:e.pageUrl})),i.set(r,s)}e.comment=e.comment.replace(n,((e,t)=>{if(!t)return"";const n=i.get(t);return`<img src="${n}" remoteid="${n}"/>`}))})(i,e.imageSupportBG)}if("customLists"===n&&null!=i.id){null==(yield e.storageManager.backend.operation("findObject",n,{id:i.id}))&&(yield e.customListsBG.updateListSuggestionsCache({added:i.id}))}if("pages"===n){(yield e.storageManager.backend.operation("findObject",n,{url:i.url}))&&(delete i.text,a={url:i.url})}if(yield Object(po.h)({collection:n,updates:i,where:a,storageManager:c,executeOperation:(...e)=>c.backend.operation(...e)}),"followedList"===n&&null!=i.sharedList&&(yield e.pageActivityIndicatorBG.syncFollowedListEntries({forFollowedLists:[{sharedList:i.sharedList}]})),"docContent"===n){const{normalizedUrl:t,storedContentType:n}=null!=a?a:{},{content:r}=i;if(!t||!r)return void console.warn("Got an incoming page, but it didn't include a URL and a body");const o=n===Mr.HtmlBody?Object(Nr.a)({html:r}).text:Object(wr.c)((null!==(s=r.pageTexts)&&void 0!==s?s:[]).join(" ")).text;yield e.storageManager.backend.operation("updateObjects","pages",{url:t},{text:o})}try{yield function(e,t,n,i,o,s){var a,c;return Object(r.__awaiter)(this,void 0,void 0,(function*(){function i({url:e,listNames:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield o.backend.operation("findObjects","annotListEntries",{url:e});if(0===n.length)return!1;for(const e of n){const n=(yield o.backend.operation("findObject","customLists",{id:e.listId})).name;if(t.includes(n))return!0}}))}function l({url:e,listNames:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let n=yield o.backend.operation("findObjects","pageListEntries",{pageUrl:e});if(0===n.length)return!1;n=n.filter((e=>20201014!=e));for(const e of n){const n=(yield o.backend.operation("findObject","customLists",{id:e.listId})).name;if(t.includes(n))return!0}}))}try{if(yield Object(Ce.c)({storageAPI:s.storage})){if("annotations"===t){const t=yield o.collection("pages").findOneObject({url:n.url.split("/#")[0]}),s=(yield o.collection("visits").findOneObject({url:Object(D.c)(n.url.split("/#")[0])})).time,a={annotationId:n.url,pageTitle:n.pageTitle,pageUrl:t.fullUrl,body:n.body,comment:n.comment,createdWhen:n.createdWhen,pageCreatedWhen:s};yield Object(Ie.a)(a,e,((e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield i({url:e,listNames:t})}))))}if("annotListEntries"===t){const t=yield o.collection("customLists").findOneObject({id:n.listId}),s=yield o.collection("pages").findOneObject({url:n.url.split("/#")[0]}),a=yield o.collection("annotations").findOneObject({url:n.url}),c=(yield o.collection("visits").findOneObject({url:Object(D.c)(n.url.split("/#")[0])})).time,l={annotationId:n.url,pageTitle:s.fullTitle,pageUrl:s.fullUrl,annotationSpaces:null==t?void 0:t.name,pageCreatedWhen:c,body:a.body,comment:a.comment,createdWhen:a.createdWhen};yield Object(Ie.a)(l,e,((e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield i({url:e,listNames:t})}))))}if("pages"===t){if(!n.fullTitle){const e=new XMLHttpRequest;e.open("GET",n.fullUrl,!1),e.send();const t=(new DOMParser).parseFromString(e.responseText,"text/html");n.fullTitle=(null===(a=t.querySelector('meta[property="og:title"]'))||void 0===a?void 0:a.getAttribute("content"))||t.title}const t={pageTitle:n.fullTitle,pageUrl:n.fullUrl,createdWhen:Date.now()};yield Object(Ie.b)(t,e)}if("pageListEntries"===t){const t=yield o.collection("customLists").findOneObject({id:n.listId});let i=yield o.collection("pages").findOneObject({url:Object(D.c)(n.fullUrl)});if(!i.fullTitle){const e=new XMLHttpRequest;e.open("GET",n.fullUrl,!1),e.send();const t=(new DOMParser).parseFromString(e.responseText,"text/html");i.fullTitle=(null===(c=t.querySelector('meta[property="og:title"]'))||void 0===c?void 0:c.getAttribute("content"))||t.title}const s={pageTitle:i.fullTitle,createdWhen:Date.now(),pageUrl:n.fullUrl,pageSpaces:t.name};yield Object(Ie.b)(s,e,((e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield l({url:Object(D.c)(e),listNames:t})}))))}}}catch(e){console.error(e)}}))}(e.pkmSyncBG,n,i,0,e.storageManager,e.browserAPIs)}catch(e){}}));class Ho extends c.a{constructor(){super(...arguments),this.getConfig=()=>({collections:{images:{version:Ii.a[31].version,fields:{id:{type:"string"},createdWhen:{type:"timestamp"},normalizedPageUrl:{type:"string"},annotationUrl:{type:"string"}},indices:[{field:"id",pk:!0},{field:"createdWhen"},{field:"normalizedPageUrl"}]}},operations:{createImage:{operation:"createObject",collection:"images"}}})}storeImage(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("createImage",e)}))}}class $o{constructor(e){this.options=e,this.generateImageId=()=>this.options.generateImageId(),this.uploadImage=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.storage.storeImage({id:e.id,createdWhen:Date.now(),normalizedPageUrl:e.normalizedPageUrl,annotationUrl:e.annotationUrl});const t=e.image instanceof Blob?e.image:Object(P.c)(e.image);yield this.options.backend.uploadImage({image:t,id:e.id})})),this.getImageUrl=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.options.backend.getImageUrl(e)}));try{this.storage=new Ho({storageManager:e.storageManager})}catch(e){throw console.error(e),new Error("Failed to initialize image support storage")}this.remoteFunctions={generateImageId:Object(a.j)((()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.generateImageId()})))),uploadImage:Object(a.j)(this.uploadImage),getImageUrl:Object(a.j)(this.getImageUrl)}}setupRemoteFunctions(){Object(a.f)(this.remoteFunctions)}}class Wo{constructor(e){this.options=e,this.fetchCloudFlare=(e,t)=>fetch(this.workerUrl+e,t),this.getUploadToken=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.options.callFirebaseFunction("pdfUploads-requestUpload",{uploadId:e.uploadId})})),this.getDownloadToken=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.options.callFirebaseFunction("pdfUploads-requestDownload",{uploadId:e.uploadId,listId:e.listId})})),this.uploadPdfContent=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.fetchCloudFlare(ho.b+`?token=${e.token}`,{method:"POST",body:e.content})).json()})),this.uploadPdf=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=e.pdfFile instanceof Blob?e.pdfFile:this.options.dataUrlToBlob(e.pdfFile),n=yield this.getUploadToken(e);if(n.error)return n;const{token:r}=n;return yield this.uploadPdfContent({token:r,content:t})})),this.workerUrl="production"===e.env?tr.b.production:tr.b.staging}}const zo="followed-list-entry-sync";function Vo(e){var t,n,i,c,l,u;const d=null!==(t=e.createRemoteEventEmitter)&&void 0!==t?t:a.g,h=null!==(n=e.getNow)&&void 0!==n?n:()=>Date.now(),f=e.fetch,p=null!==(i=e.generateServerId)&&void 0!==i?i:e=>Object(qi.a)().firestore().collection(e).doc().id,{storageManager:g}=e,y=new uo({storageManager:g,localBrowserStorage:e.browserAPIs.storage.local}),v=Object(Pn.a)({syncSettingsBG:y}),b=new Wi({browserAPIs:e.browserAPIs,manifestVersion:e.manifestVersion}),_=(t,...n)=>{const r=e.callFirebaseFunction;if(!r)throw new Error(`Tried to call Firebase Function '${t}', but did not provide a function to call it`);return r(t,...n)},w=new ni(e.analyticsManager,{localBrowserStorage:e.browserAPIs.storage.local,sendBqEvent:e=>_("analytics-trackEvent",e)}),T=w,E=new m({storageManager:g}),A=e.auth||new hr({runtimeAPI:e.browserAPIs.runtime,authServices:e.authServices,remoteEmitter:d("auth"),localStorageArea:e.browserAPIs.storage.local,getFCMRegistrationToken:e.getFCMRegistrationToken,backendFunctions:{registerBetaUser:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return _("registerBetaUser",e)}))},userManagement:e.serverStorage.modules.users}),S=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var e,t;return null!==(t=null===(e=yield A.authService.getCurrentUser())||void 0===e?void 0:e.id)&&void 0!==t?t:null})),O=new Yt({browserAPIs:e.browserAPIs}),I=new qr({persistentStorageManager:e.persistentStorageManager,pageIndexingSettingsStore:new Ne.a(e.browserAPIs.storage.local,{prefix:"pageIndexing."}),fetchPageData:e.fetchPageData,fetchPdfData:e.fetchPDFData,browserAPIs:e.browserAPIs,createInboxEntry:function(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield W.createInboxListEntry({fullUrl:e})}))},storageManager:g,tabManagement:b,getNow:h,authBG:A,pkmSyncBG:O,fetch:f});b.events.on("tabRemoved",(e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield I.handleTabClose(e)}))));const C=new Ze({storageManager:g,pages:I,analytics:w,analyticsBG:T,browserAPIs:e.browserAPIs,manifestVersion:e.manifestVersion}),k=new fe({pages:I,analyticsBG:T,storageManager:g,captureException:e.captureException}),x=new $e({storageManager:g,pages:I,tabManagement:b,queryTabs:Object(Qr.a)(e.browserAPIs.tabs,"query"),searchBackgroundModule:k,analytics:w,localBrowserStorage:e.browserAPIs.storage.local}),R=new xi({storageManager:g}),N=new Wo({callFirebaseFunction:_,dataUrlToBlob:P.c,env:e.backendEnv}),j=new fo({manifestVersion:e.manifestVersion,runtimeAPI:e.browserAPIs.runtime,storageAPI:e.browserAPIs.storage,tabsAPI:e.browserAPIs.tabs,syncSettings:v,generateUploadId:()=>p("uploadAuditLogEntry"),pageStorage:I.storage,pdfUploads:N,getNow:h,fetch:f});I.options.onPagePut=j.handlePagePut;const M=new L({storageManager:g}),F=new to({services:e.services,syncSettings:v,authServices:e.authServices,activityStreamsStorage:e.serverStorage.modules.activityStreams}),B=new $o({backend:e.imageSupportBackend,storageManager:e.storageManager,generateImageId:()=>p("UPLOADED_IMAGES")}),G=new U({browserAPIs:e.browserAPIs,storageManager:g,socialBg:M,pages:I,analytics:w,analyticsBG:T,pkmSyncBG:O,authBG:A,serverStorage:e.serverStorage.modules,preAnnotationDelete:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield $.deleteAnnotationShare(e)}))}),q=new ao({storageManager:g,callFirebaseFunction:_}),H=null!==(c=e.contentSharingBackend)&&void 0!==c?c:Zt("contentSharing",_),$=new Bi({backend:H,remoteEmitter:d("contentSharing",{broadcastToTabs:!0}),analyticsBG:T,waitForSync:()=>re.waitForSync(),storageManager:g,contentSharingSettingsStore:new Ne.a(e.browserAPIs.storage.local,{prefix:"contentSharing."}),analytics:e.analyticsManager,services:e.services,captureException:e.captureException,serverStorage:e.serverStorage.modules,generateServerId:p,getBgModules:()=>({auth:A,pages:I,customLists:W,directLinking:G,pageActivityIndicator:Q})}),W=new Ue({analytics:w,storageManager:g,tabManagement:b,contentSharing:$,contentSharingBackend:H,browserAPIs:e.browserAPIs,pages:I,authServices:e.authServices,removeChildAnnotationsFromList:G.removeChildAnnotationsFromList.bind(G),analyticsBG:T,pkmSyncBG:O});I.options.collectionsBG=W;const z=new Ne.a(y,{prefix:"readwise."}),V=new Zi({fetch:f,storageManager:g,customListsBG:W,annotationsBG:G,settingsStore:z,getPageData:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return Ye()(yield I.storage.getPage(e),"url","fullUrl","fullTitle")}))}),K=new Ne.a(e.browserAPIs.storage.local,{prefix:"localSettings."});const Y=new Ne.a(e.browserAPIs.storage.local,{prefix:"personalCloud."}),Q=new Go({fetch:f,storageManager:g,getCurrentUserId:S,contentSharingBackend:H,pkmSyncBG:O}),X=new io({remoteEventEmitter:d("pageSummary"),browserAPIs:e.browserAPIs,analyticsBG:T}),J=new s.UAParser(e.userAgentString),ee=Ao({serverStorage:e.serverStorage.modules,personalDeviceInfo:{type:Z.h.DesktopBrowser,product:Z.g.Extension,browser:o()(J.getBrowser().name),os:o()(J.getOS().name)}}),te=wo({createDeviceId:ee,authService:A.authService,getDeviceId:()=>Y.get("deviceId"),setDeviceId:e=>Y.set("deviceId",e)}),ne={ref:Jt.r,getAuth:Xt.d,getStorage:Jt.o,uploadBytes:Jt.t,uploadString:Jt.v,getDownloadURL:Jt.m},re=new _o({storageManager:g,syncSettingsStore:v,serverStorageManager:e.serverStorage.manager,webExtAPIs:e.browserAPIs,persistentStorageManager:e.persistentStorageManager,mediaBackend:null!==(l=e.personalCloudMediaBackend)&&void 0!==l?l:new Eo({firebase:ne,serverStorageManager:e.serverStorage.manager}),backend:null!==(u=e.personalCloudBackend)&&void 0!==u?u:new To({firebase:ne,serverStorageManager:e.serverStorage.manager,personalCloudService:Zt("personalCloud",_),getCurrentSchemaVersion:()=>Object(St.c)(e.storageManager),authChanges:te,getLastUpdateProcessedTime:()=>Y.get("lastSeen"),getLastCollectionDataProcessedTime:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return 0})),getDeviceId:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return re.deviceId})),getClientDeviceType:()=>Z.h.DesktopBrowser,setupSyncTriggerListener:e.setupSyncTriggerListener}),remoteEventEmitter:d("personalCloud"),settingStore:Y,localExtSettingStore:K,getUserId:S,authChanges:te,writeIncomingData:qo({customListsBG:W,pageActivityIndicatorBG:Q,persistentStorageManager:e.persistentStorageManager,storageManager:e.storageManager,browserAPIs:e.browserAPIs,pkmSyncBG:O,imageSupportBG:B})}),ie=new Oi({storageManager:g,contentSharing:$,search:k}),oe=new ir({storageChangesMan:e.localStorageChangesManager,urlNormalizer:D.c,runtimeAPI:e.browserAPIs.runtime,browserAPIs:e.browserAPIs,storageAPI:e.browserAPIs.storage,tabsAPI:e.browserAPIs.tabs,captureException:e.captureException,localExtSettingStore:K,syncSettingsStore:v,storageManager:g,analyticsBG:T,bgModules:{readwise:V,copyPaster:ie,customLists:W,syncSettings:y,tabManagement:b,personalCloud:re,notifications:E,pageActivityIndicator:Q,summarizeBG:X,auth:A,contentSharing:$,pkmSyncBG:O}});return{auth:A,social:M,analytics:w,analyticsBG:T,notifications:E,readable:R,pdfBg:j,pkmSyncBG:O,directLinking:G,search:k,eventLog:new _e({storageManager:g}),activityIndicator:F,pageActivityIndicator:Q,summarizeBG:X,customLists:W,tags:x,bookmarks:C,tabManagement:b,readwise:V,syncSettings:y,backupModule:new Bt({storageManager:g,browserAPIs:e.browserAPIs,localBackupSettings:new Ne.a(e.browserAPIs.storage.local,{prefix:"localBackup."}),notifications:E,checkAuthorizedForAutoBackup:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return A.remoteFunctions.isAuthorizedForFeature("backup")}))}),pkmSyncModule:O,storexHub:new Yr({storageManager:g,localBrowserStorage:e.browserAPIs.storage.local,storePageContent:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield I.createOrUpdatePage(e)})),addVisit:e=>I.addVisit(e.normalizedUrl,e.time),addBookmark:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){(yield C.storage.pageHasBookmark(e.normalizedUrl))||(yield C.addBookmark({fullUrl:e.normalizedUrl,timestamp:e.time}))})),addTags:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield x.storage.fetchPageTags({url:e.normalizedUrl});yield Promise.all(e.tags.map((n=>Object(r.__awaiter)(this,void 0,void 0,(function*(){t.includes(n)||(yield x.addTagToPage({url:e.fullUrl,tag:n}))})))))})),addToLists:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield W.storage.fetchListIdsByUrl(e.normalizedUrl);yield Promise.all(e.lists.map((n=>Object(r.__awaiter)(this,void 0,void 0,(function*(){t.includes(n)||(yield W.storage.insertPageToList({listId:n,pageUrl:e.normalizedUrl,fullUrl:e.fullUrl}))})))))}))}),featuresBeta:new pr,pages:I,bgScript:oe,contentScripts:new Xr.a({contentSharingStorage:$.storage,browserAPIs:e.browserAPIs,waitForSync:()=>re.waitForSync(),injectScriptInTab:(t,n)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){"3"===e.manifestVersion?yield e.browserAPIs.scripting.executeScript({target:{tabId:t},files:[n]}):yield e.browserAPIs.tabs.executeScript(t,{file:n})}))}),inPageUI:new Jr.a({tabsAPI:e.browserAPIs.tabs,contextMenuAPI:e.browserAPIs.contextMenus,browserAPIs:e.browserAPIs,fetch:e.fetch}),copyPaster:ie,activityStreams:q,personalCloud:re,contentSharing:$,contentConversations:new Gi({serverStorage:e.serverStorage.modules,services:e.services}),imageSupport:B}}function Ko(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){var i;e.bgScript.setupWebExtAPIHandlers(),i=new yn({storageManager:t,browserAPIs:n}),vn=i,function(e){Object(a.d)({dirtyEstsCache:()=>bn().dirtyEstsCache()}),e.runtimeAPI.onConnect.addListener((t=>{if(t.name===en.f)return new In(Object.assign({port:t},e))}))}({pages:e.pages,tagsModule:e.tags,customListsModule:e.customLists,bookmarks:e.bookmarks,runtimeAPI:n.runtime,storageAPI:n.storage}),e.auth.registerRemoteEmitter(),e.notifications.setupRemoteFunctions(),e.social.setupRemoteFunctions(),e.directLinking.setupRemoteFunctions(),e.contentSharing.setupRemoteFunctions(),e.search.setupRemoteFunctions(),e.activityIndicator.setupRemoteFunctions(),e.summarizeBG.setupRemoteFunctions(),e.eventLog.setupRemoteFunctions(),e.backupModule.setBackendFromStorage(),e.backupModule.setupRemoteFunctions(),e.pkmSyncModule.setupRemoteFunctions(),e.backupModule.startRecordingChangesIfNeeded(),e.bgScript.setupRemoteFunctions(),e.contentScripts.setupRemoteFunctions(),e.inPageUI.setupRemoteFunctions(),e.bookmarks.setupBookmarkListeners(),e.tabManagement.setupRemoteFunctions(),e.readwise.setupRemoteFunctions(),e.contentConversations.setupRemoteFunctions(),e.pages.setupRemoteFunctions(),e.syncSettings.setupRemoteFunctions(),e.imageSupport.setupRemoteFunctions(),Object(f.b)(),e.analytics.setup(),yield e.personalCloud.setup();let o={[zo]:{alarmDefinition:{periodInMinutes:20},job:()=>e.pageActivityIndicator.syncFollowedListEntriesWithNewActivity()},[Ut]:{alarmDefinition:null,job:()=>e.backupModule.doBackup()},[vo.c]:{alarmDefinition:null,job:()=>e.personalCloud.actionQueue.executePendingActions()},[Un]:{alarmDefinition:{periodInMinutes:15},job:()=>function(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){(yield Gn(e))&&(yield e.captureException(new Error("OwnError: Data loss flag was not found in DB")))}))}({captureException:Ve.b,db:t.backend.dexie})},[nr.a]:{alarmDefinition:{periodInMinutes:360},job:()=>Object(nr.b)()}};"firefox"!==Object(Qe.a)()&&(o[vo.b]={alarmDefinition:{periodInMinutes:60},job:()=>e.personalCloud.invokeSyncDownload()}),function(e,t){for(let[n,{alarmDefinition:r}]of Object.entries(t))r&&e.create(n,r);e.onAlarm.addListener((({name:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){e in t&&(yield t[e].job())}))))}(n.alarms,o)}))}function Yo(e){const t=new Do(e);var n,r;Object(c.c)(e.storageManager.registry,(n=e.backgroundModules,r=t,{pageActivityIndicator:n.pageActivityIndicator.storage,pageFetchBacklog:r.pageFetchBacklogStorage,annotations:n.directLinking.annotationStorage,readwiseAction:r.readwiseActionQueueStorage,notifications:n.notifications.storage,customList:n.customLists.storage,bookmarks:n.bookmarks.storage,backup:n.backupModule.storage,eventLog:n.eventLog.storage,search:n.search.storage,social:n.social.storage,tags:n.tags.storage,clientSyncLog:r.clientSyncLogStorage,syncInfo:r.syncInfoStorage,pages:n.pages.storage,copyPaster:n.copyPaster.storage,reader:n.readable.storage,contentSharing:n.contentSharing.storage,syncSettings:n.syncSettings.storage,personalCloudActionQueue:n.personalCloud.actionQueue.storage,imageSupport:n.imageSupport.storage})),Object(c.c)(e.persistentStorageManager.registry,function(e){return{pages:e.pages.persistentStorage}}(e.backgroundModules))}},function(e,t,n){var r=n(219),i=n(198),o=n(138),s=n(48),a=n(109);e.exports=function(e,t,n,c){if(!s(e))return e;for(var l=-1,u=(t=i(t,e)).length,d=u-1,h=e;null!=h&&++l<u;){var f=a(t[l]),p=n;if("__proto__"===f||"constructor"===f||"prototype"===f)return e;if(l!=d){var g=h[f];void 0===(p=c?c(g,f,h):void 0)&&(p=s(g)?g:o(t[l+1])?[]:{})}r(h,f,p),h=h[f]}return e}},function(e,t){e.exports=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o}},function(e,t,n){var r=n(1323)("socket.io-parser"),i=n(1326),o=n(1327),s=n(1177),a=n(1178);function c(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=c,t.Decoder=d;var l=t.ERROR+'"encode error"';function u(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var i=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===i)return l;n+=i}return r("encoded %j as %s",e,n),n}function d(){this.reconstructor=null}function h(e){this.reconPack=e,this.buffers=[]}c.prototype.encode=function(e,n){(r("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)?function(e,t){function n(e){var n=o.deconstructPacket(e),r=u(n.packet),i=n.buffers;i.unshift(r),t(i)}o.removeBlobs(e,n)}(e,n):n([u(e)])},i(d.prototype),d.prototype.add=function(e){var n;if("string"==typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=function(e){var n=0,i={type:Number(e.charAt(0))};if(null==t.types[i.type])return o="unknown packet type "+i.type,{type:t.ERROR,data:"parser error: "+o};var o;if(t.BINARY_EVENT===i.type||t.BINARY_ACK===i.type){for(var a=n+1;"-"!==e.charAt(++n)&&n!=e.length;);var c=e.substring(a,n);if(c!=Number(c)||"-"!==e.charAt(n))throw new Error("Illegal attachments");i.attachments=Number(c)}if("/"===e.charAt(n+1)){for(a=n+1;++n;){if(","===(u=e.charAt(n)))break;if(n===e.length)break}i.nsp=e.substring(a,n)}else i.nsp="/";var l=e.charAt(n+1);if(""!==l&&Number(l)==l){for(a=n+1;++n;){var u;if(null==(u=e.charAt(n))||Number(u)!=u){--n;break}if(n===e.length)break}i.id=Number(e.substring(a,n+1))}if(e.charAt(++n)){var d=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(n));if(!function(e,t){switch(e){case 0:return"object"==typeof t;case 1:return void 0===t;case 4:return"string"==typeof t||"object"==typeof t;case 2:case 5:return s(t)&&("string"==typeof t[0]||"number"==typeof t[0]);case 3:case 6:return s(t)}}(i.type,d))throw new Error("invalid payload");i.data=d}return r("decoded %s as %j",e,i),i}(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new h(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n)}else{if(!a(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},d.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},h.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=o.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},h.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,n){var r=n(1330);e.exports=function(e){var t=e.xdomain,n=e.xscheme,i=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&i)return new XDomainRequest}catch(e){}if(!t)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},function(e,t,n){var r=n(883),i=n(900);function o(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}e.exports=o,i(o.prototype),o.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},o.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},o.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},o.prototype.onPacket=function(e){this.emit("packet",e)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.subselects=t.getNextSiblings=t.ensureIsTag=t.PLACEHOLDER_ELEMENT=void 0;var o=i(n(799)),s=n(1190);function a(e,t){return e===o.default.falseFunc?o.default.falseFunc:function(n){return t.isTag(n)&&e(n)}}function c(e,t){var n=t.getSiblings(e);if(n.length<=1)return[];var r=n.indexOf(e);return r<0||r===n.length-1?[]:n.slice(r+1).filter(t.isTag)}function l(e){return{xmlMode:!!e.xmlMode,lowerCaseAttributeNames:!!e.lowerCaseAttributeNames,lowerCaseTags:!!e.lowerCaseTags,quirksMode:!!e.quirksMode,cacheResults:!!e.cacheResults,pseudos:e.pseudos,adapter:e.adapter,equals:e.equals}}t.PLACEHOLDER_ELEMENT={},t.ensureIsTag=a,t.getNextSiblings=c;var u=function(e,t,n,r,i){var s=i(t,l(n),r);return s===o.default.trueFunc?e:s===o.default.falseFunc?o.default.falseFunc:function(t){return s(t)&&e(t)}};t.subselects={is:u,matches:u,where:u,not:function(e,t,n,r,i){var s=i(t,l(n),r);return s===o.default.falseFunc?e:s===o.default.trueFunc?o.default.falseFunc:function(t){return!s(t)&&e(t)}},has:function(e,n,i,u,d){var h=i.adapter,f=l(i);f.relativeSelector=!0;var p=n.some((function(e){return e.some(s.isTraversal)}))?[t.PLACEHOLDER_ELEMENT]:void 0,g=d(n,f,p);if(g===o.default.falseFunc)return o.default.falseFunc;var m=a(g,h);if(p&&g!==o.default.trueFunc){var y=g.shouldTestNextSiblings,v=void 0!==y&&y;return function(t){if(!e(t))return!1;p[0]=t;var n=h.getChildren(t),i=v?r(r([],n,!0),c(t,h),!0):n;return h.existsOne(m,i)}}return function(t){return e(t)&&h.existsOne(m,h.getChildren(t))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isUndefinedCodePoint=t.isControlCodePoint=t.getSurrogatePairCodePoint=t.isSurrogatePair=t.isSurrogate=t.SEQUENCES=t.CODE_POINTS=t.REPLACEMENT_CHARACTER=void 0;const r=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]);t.REPLACEMENT_CHARACTER="\ufffd",function(e){e[e.EOF=-1]="EOF",e[e.NULL=0]="NULL",e[e.TABULATION=9]="TABULATION",e[e.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",e[e.LINE_FEED=10]="LINE_FEED",e[e.FORM_FEED=12]="FORM_FEED",e[e.SPACE=32]="SPACE",e[e.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",e[e.QUOTATION_MARK=34]="QUOTATION_MARK",e[e.NUMBER_SIGN=35]="NUMBER_SIGN",e[e.AMPERSAND=38]="AMPERSAND",e[e.APOSTROPHE=39]="APOSTROPHE",e[e.HYPHEN_MINUS=45]="HYPHEN_MINUS",e[e.SOLIDUS=47]="SOLIDUS",e[e.DIGIT_0=48]="DIGIT_0",e[e.DIGIT_9=57]="DIGIT_9",e[e.SEMICOLON=59]="SEMICOLON",e[e.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",e[e.EQUALS_SIGN=61]="EQUALS_SIGN",e[e.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",e[e.LATIN_CAPITAL_F=70]="LATIN_CAPITAL_F",e[e.LATIN_CAPITAL_X=88]="LATIN_CAPITAL_X",e[e.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",e[e.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",e[e.GRAVE_ACCENT=96]="GRAVE_ACCENT",e[e.LATIN_SMALL_A=97]="LATIN_SMALL_A",e[e.LATIN_SMALL_F=102]="LATIN_SMALL_F",e[e.LATIN_SMALL_X=120]="LATIN_SMALL_X",e[e.LATIN_SMALL_Z=122]="LATIN_SMALL_Z",e[e.REPLACEMENT_CHARACTER=65533]="REPLACEMENT_CHARACTER"}(t.CODE_POINTS||(t.CODE_POINTS={})),t.SEQUENCES={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"},t.isSurrogate=function(e){return e>=55296&&e<=57343},t.isSurrogatePair=function(e){return e>=56320&&e<=57343},t.getSurrogatePairCodePoint=function(e,t){return 1024*(e-55296)+9216+t},t.isControlCodePoint=function(e){return 32!==e&&10!==e&&13!==e&&9!==e&&12!==e&&e>=1&&e<=31||e>=127&&e<=159},t.isUndefinedCodePoint=function(e){return e>=64976&&e<=65007||r.has(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTokenAttr=t.TokenType=void 0,function(e){e[e.CHARACTER=0]="CHARACTER",e[e.NULL_CHARACTER=1]="NULL_CHARACTER",e[e.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",e[e.START_TAG=3]="START_TAG",e[e.END_TAG=4]="END_TAG",e[e.COMMENT=5]="COMMENT",e[e.DOCTYPE=6]="DOCTYPE",e[e.EOF=7]="EOF",e[e.HIBERNATION=8]="HIBERNATION"}(t.TokenType||(t.TokenType={})),t.getTokenAttr=function(e,t){for(let n=e.attrs.length-1;n>=0;n--)if(e.attrs[n].name===t)return e.attrs[n].value;return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultTreeAdapter=void 0;const r=n(732);function i(e){return{nodeName:"#text",value:e,parentNode:null}}t.defaultTreeAdapter={createDocument:()=>({nodeName:"#document",mode:r.DOCUMENT_MODE.NO_QUIRKS,childNodes:[]}),createDocumentFragment:()=>({nodeName:"#document-fragment",childNodes:[]}),createElement:(e,t,n)=>({nodeName:e,tagName:e,attrs:n,namespaceURI:t,childNodes:[],parentNode:null}),createCommentNode:e=>({nodeName:"#comment",data:e,parentNode:null}),appendChild(e,t){e.childNodes.push(t),t.parentNode=e},insertBefore(e,t,n){const r=e.childNodes.indexOf(n);e.childNodes.splice(r,0,t),t.parentNode=e},setTemplateContent(e,t){e.content=t},getTemplateContent:e=>e.content,setDocumentType(e,n,r,i){const o=e.childNodes.find((e=>"#documentType"===e.nodeName));if(o)o.name=n,o.publicId=r,o.systemId=i;else{const o={nodeName:"#documentType",name:n,publicId:r,systemId:i,parentNode:null};t.defaultTreeAdapter.appendChild(e,o)}},setDocumentMode(e,t){e.mode=t},getDocumentMode:e=>e.mode,detachNode(e){if(e.parentNode){const t=e.parentNode.childNodes.indexOf(e);e.parentNode.childNodes.splice(t,1),e.parentNode=null}},insertText(e,n){if(e.childNodes.length>0){const r=e.childNodes[e.childNodes.length-1];if(t.defaultTreeAdapter.isTextNode(r))return void(r.value+=n)}t.defaultTreeAdapter.appendChild(e,i(n))},insertTextBefore(e,n,r){const o=e.childNodes[e.childNodes.indexOf(r)-1];o&&t.defaultTreeAdapter.isTextNode(o)?o.value+=n:t.defaultTreeAdapter.insertBefore(e,i(n),r)},adoptAttributes(e,t){const n=new Set(e.attrs.map((e=>e.name)));for(let r=0;r<t.length;r++)n.has(t[r].name)||e.attrs.push(t[r])},getFirstChild:e=>e.childNodes[0],getChildNodes:e=>e.childNodes,getParentNode:e=>e.parentNode,getAttrList:e=>e.attrs,getTagName:e=>e.tagName,getNamespaceURI:e=>e.namespaceURI,getTextNodeContent:e=>e.value,getCommentNodeContent:e=>e.data,getDocumentTypeNodeName:e=>e.name,getDocumentTypeNodePublicId:e=>e.publicId,getDocumentTypeNodeSystemId:e=>e.systemId,isTextNode:e=>"#text"===e.nodeName,isCommentNode:e=>"#comment"===e.nodeName,isDocumentTypeNode:e=>"#documentType"===e.nodeName,isElementNode:e=>Object.prototype.hasOwnProperty.call(e,"tagName"),setNodeSourceCodeLocation(e,t){e.sourceCodeLocation=t},getNodeSourceCodeLocation:e=>e.sourceCodeLocation,updateNodeSourceCodeLocation(e,t){e.sourceCodeLocation=Object.assign(Object.assign({},e.sourceCodeLocation),t)}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(1168);n.o(r,"getMessaging")&&n.d(t,"getMessaging",(function(){return r.getMessaging})),n.o(r,"onBackgroundMessage")&&n.d(t,"onBackgroundMessage",(function(){return r.onBackgroundMessage}))},function(e,t,n){"use strict";(function(t,r){var i=n(786).Buffer,o=t.crypto||t.msCrypto;o&&o.getRandomValues?e.exports=function(e,n){if(e>65536)throw new Error("requested too many random bytes");var s=new t.Uint8Array(e);e>0&&o.getRandomValues(s);var a=i.from(s.buffer);if("function"==typeof n)return r.nextTick((function(){n(null,a)}));return a}:e.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this,n(61),n(131))},function(e,t,n){var r,i,o;!function(n,s){"use strict";"object"==typeof e.exports?e.exports=s():(i=[],void 0===(o="function"==typeof(r=s)?r.apply(t,i):r)||(e.exports=o))}(0,(function(){"use strict";var e=Object.prototype.toString;function t(e,t){return null!=e&&Object.prototype.hasOwnProperty.call(e,t)}function n(e){if(!e)return!0;if(i(e)&&0===e.length)return!0;if("string"!=typeof e){for(var n in e)if(t(e,n))return!1;return!0}return!1}function r(t){return e.call(t)}var i=Array.isArray||function(t){return"[object Array]"===e.call(t)};function o(e){var t=parseInt(e);return t.toString()===e?t:e}function s(e){var s,a,c=function(e){return Object.keys(c).reduce((function(t,n){return"create"===n||"function"==typeof c[n]&&(t[n]=c[n].bind(c,e)),t}),{})};function l(e,t){if(s(e,t))return e[t]}function u(e,t,n,r){if("number"==typeof t&&(t=[t]),!t||0===t.length)return e;if("string"==typeof t)return u(e,t.split(".").map(o),n,r);var i=t[0],s=a(e,i);return 1===t.length?(void 0!==s&&r||(e[i]=n),s):(void 0===s&&("number"==typeof t[1]?e[i]=[]:e[i]={}),u(e[i],t.slice(1),n,r))}return s=(e=e||{}).includeInheritedProps?function(){return!0}:function(e,n){return"number"==typeof n&&Array.isArray(e)||t(e,n)},a=e.includeInheritedProps?function(e,t){"string"!=typeof t&&"number"!=typeof t&&(t=String(t));var n=l(e,t);if("__proto__"===t||"prototype"===t||"constructor"===t&&"function"==typeof n)throw new Error("For security reasons, object's magic properties cannot be set");return n}:function(e,t){return l(e,t)},c.has=function(n,r){if("number"==typeof r?r=[r]:"string"==typeof r&&(r=r.split(".")),!r||0===r.length)return!!n;for(var s=0;s<r.length;s++){var a=o(r[s]);if(!("number"==typeof a&&i(n)&&a<n.length||(e.includeInheritedProps?a in Object(n):t(n,a))))return!1;n=n[a]}return!0},c.ensureExists=function(e,t,n){return u(e,t,n,!0)},c.set=function(e,t,n,r){return u(e,t,n,r)},c.insert=function(e,t,n,r){var o=c.get(e,t);r=~~r,i(o)||(o=[],c.set(e,t,o)),o.splice(r,0,n)},c.empty=function(e,t){var o,a;if(!n(t)&&(null!=e&&(o=c.get(e,t)))){if("string"==typeof o)return c.set(e,t,"");if(function(e){return"boolean"==typeof e||"[object Boolean]"===r(e)}(o))return c.set(e,t,!1);if("number"==typeof o)return c.set(e,t,0);if(i(o))o.length=0;else{if(!function(e){return"object"==typeof e&&"[object Object]"===r(e)}(o))return c.set(e,t,null);for(a in o)s(o,a)&&delete o[a]}}},c.push=function(e,t){var n=c.get(e,t);i(n)||(n=[],c.set(e,t,n)),n.push.apply(n,Array.prototype.slice.call(arguments,2))},c.coalesce=function(e,t,n){for(var r,i=0,o=t.length;i<o;i++)if(void 0!==(r=c.get(e,t[i])))return r;return n},c.get=function(e,t,n){if("number"==typeof t&&(t=[t]),!t||0===t.length)return e;if(null==e)return n;if("string"==typeof t)return c.get(e,t.split("."),n);var r=o(t[0]),i=a(e,r);return void 0===i?n:1===t.length?i:c.get(e[r],t.slice(1),n)},c.del=function(e,t){if("number"==typeof t&&(t=[t]),null==e)return e;if(n(t))return e;if("string"==typeof t)return c.del(e,t.split("."));var r=o(t[0]);return a(e,r),s(e,r)?1!==t.length?c.del(e[r],t.slice(1)):(i(e)?e.splice(r,1):delete e[r],e):e},c}var a=s();return a.create=s,a.withInheritedProps=s({includeInheritedProps:!0}),a}))},function(e,t,n){var r=n(232)("escape",n(1375),n(787));r.placeholder=n(164),e.exports=r},function(module,exports,__webpack_require__){(function(Buffer,global,process){var factory;factory=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var r=n(1),i=n(219),o=n(234),s=n(235),a=n(223),c=n(236),l=n(228),u=n(225);if(n(65).isNodeJS){var d=n(237).PDFNodeStream;i.setPDFNetworkStreamFactory((function(e){return new d(e)}))}else{var h,f=n(240).PDFNetworkStream;a.isFetchSupported()&&(h=n(241).PDFFetchStream),i.setPDFNetworkStreamFactory((function(e){return h&&a.isValidFetchUrl(e.url)?new h(e):new f(e)}))}t.build=i.build,t.version=i.version,t.getDocument=i.getDocument,t.LoopbackPort=i.LoopbackPort,t.PDFDataRangeTransport=i.PDFDataRangeTransport,t.PDFWorker=i.PDFWorker,t.renderTextLayer=o.renderTextLayer,t.AnnotationLayer=s.AnnotationLayer,t.createPromiseCapability=r.createPromiseCapability,t.PasswordResponses=r.PasswordResponses,t.InvalidPDFException=r.InvalidPDFException,t.MissingPDFException=r.MissingPDFException,t.SVGGraphics=c.SVGGraphics,t.NativeImageDecoding=r.NativeImageDecoding,t.CMapCompressionType=r.CMapCompressionType,t.PermissionFlag=r.PermissionFlag,t.UnexpectedResponseException=r.UnexpectedResponseException,t.OPS=r.OPS,t.VerbosityLevel=r.VerbosityLevel,t.UNSUPPORTED_FEATURES=r.UNSUPPORTED_FEATURES,t.createValidAbsoluteUrl=r.createValidAbsoluteUrl,t.createObjectURL=r.createObjectURL,t.removeNullCharacters=r.removeNullCharacters,t.shadow=r.shadow,t.Util=r.Util,t.RenderingCancelledException=a.RenderingCancelledException,t.getFilenameFromUrl=a.getFilenameFromUrl,t.LinkTarget=a.LinkTarget,t.addLinkAttributes=a.addLinkAttributes,t.loadScript=a.loadScript,t.PDFDateString=a.PDFDateString,t.GlobalWorkerOptions=l.GlobalWorkerOptions,t.apiCompatibilityParams=u.apiCompatibilityParams},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var o=l(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.VerbosityLevel=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.UNSUPPORTED_FEATURES=t.TextRenderingMode=t.StreamType=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.OPS=t.NativeImageDecoding=t.MissingPDFException=t.IsLittleEndianCached=t.IsEvalSupportedCached=t.InvalidPDFException=t.ImageKind=t.IDENTITY_MATRIX=t.FormatError=t.FontType=t.FONT_IDENTITY_MATRIX=t.CMapCompressionType=t.BaseException=t.AnnotationType=t.AnnotationStateModelType=t.AnnotationReviewState=t.AnnotationReplyType=t.AnnotationMarkedState=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationBorderStyleType=t.AbortException=void 0,t.arrayByteLength=O,t.arraysToBytes=function(e){var t=e.length;if(1===t&&e[0]instanceof Uint8Array)return e[0];for(var n=0,r=0;r<t;r++)n+=O(e[r]);for(var i=0,o=new Uint8Array(n),s=0;s<t;s++){var a=e[s];a instanceof Uint8Array||(a="string"==typeof a?S(a):new Uint8Array(a));var c=a.byteLength;o.set(a,i),i+=c}return o},t.assert=p,t.bytesToString=function(e){p(null!==e&&"object"===i(e)&&void 0!==e.length,"Invalid argument for bytesToString");var t=e.length,n=8192;if(t<n)return String.fromCharCode.apply(null,e);for(var r=[],o=0;o<t;o+=n){var s=Math.min(o+n,t),a=e.subarray(o,s);r.push(String.fromCharCode.apply(null,a))}return r.join("")},t.createObjectURL=void 0,t.createPromiseCapability=function(){var e=Object.create(null),t=!1;return Object.defineProperty(e,"settled",{get:function(){return t}}),e.promise=new Promise((function(n,r){e.resolve=function(e){t=!0,n(e)},e.reject=function(e){t=!0,r(e)}})),e},t.createValidAbsoluteUrl=function(e,t){if(!e)return null;try{var n=t?new URL(e,t):new URL(e);if(function(e){if(!e)return!1;switch(e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(n))return n}catch(e){}return null},t.getVerbosityLevel=function(){return d},t.info=function(e){d>=u.INFOS&&console.log("Info: ".concat(e))},t.isArrayBuffer=function(e){return"object"===i(e)&&null!==e&&void 0!==e.byteLength},t.isArrayEqual=function(e,t){return e.length===t.length&&e.every((function(e,n){return e===t[n]}))},t.isBool=function(e){return"boolean"==typeof e},t.isEmptyObj=function(e){for(var t in e)return!1;return!0},t.isNum=function(e){return"number"==typeof e},t.isSameOrigin=function(e,t){var n;try{if(!(n=new URL(e)).origin||"null"===n.origin)return!1}catch(e){return!1}var r=new URL(t,n);return n.origin===r.origin},t.isString=function(e){return"string"==typeof e},t.removeNullCharacters=function(e){return"string"!=typeof e?(h("The argument for removeNullCharacters must be a string."),e):e.replace(A,"")},t.setVerbosityLevel=function(e){Number.isInteger(e)&&(d=e)},t.shadow=g,t.string32=function(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)},t.stringToBytes=S,t.stringToPDFString=function(e){var t=e.length,n=[];if("\xfe"===e[0]&&"\xff"===e[1])for(var r=2;r<t;r+=2)n.push(String.fromCharCode(e.charCodeAt(r)<<8|e.charCodeAt(r+1)));else if("\xff"===e[0]&&"\xfe"===e[1])for(var i=2;i<t;i+=2)n.push(String.fromCharCode(e.charCodeAt(i+1)<<8|e.charCodeAt(i)));else for(var o=0;o<t;++o){var s=R[e.charCodeAt(o)];n.push(s?String.fromCharCode(s):e.charAt(o))}return n.join("")},t.stringToUTF8String=function(e){return decodeURIComponent(escape(e))},t.unreachable=f,t.utf8StringToString=function(e){return unescape(encodeURIComponent(e))},t.warn=h,n(2),t.IDENTITY_MATRIX=[1,0,0,1,0,0],t.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],t.NativeImageDecoding={NONE:"none",DECODE:"decode",DISPLAY:"display"},t.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},t.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},t.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},t.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},t.AnnotationStateModelType={MARKED:"Marked",REVIEW:"Review"},t.AnnotationMarkedState={MARKED:"Marked",UNMARKED:"Unmarked"},t.AnnotationReviewState={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"},t.AnnotationReplyType={GROUP:"Group",REPLY:"R"},t.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},t.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},t.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},t.StreamType={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"},t.FontType={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};var u={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=u,t.CMapCompressionType={NONE:0,BINARY:1,STREAM:2},t.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},t.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",smask:"smask",shadingPattern:"shadingPattern",font:"font"},t.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};var d=u.WARNINGS;function h(e){d>=u.WARNINGS&&console.log("Warning: ".concat(e))}function f(e){throw new Error(e)}function p(e,t){e||f(t)}function g(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!1}),n}var m=function(){function e(t){this.constructor===e&&f("Cannot initialize BaseException."),this.message=t,this.name=this.constructor.name}return e.prototype=new Error,e.constructor=e,e}();t.BaseException=m;var y=function(e){s(n,e);var t=c(n);function n(e,r){var i;return o(this,n),(i=t.call(this,e)).code=r,i}return n}(m);t.PasswordException=y;var v=function(e){s(n,e);var t=c(n);function n(e,r){var i;return o(this,n),(i=t.call(this,e)).details=r,i}return n}(m);t.UnknownErrorException=v;var b=function(e){s(n,e);var t=c(n);function n(){return o(this,n),t.apply(this,arguments)}return n}(m);t.InvalidPDFException=b;var _=function(e){s(n,e);var t=c(n);function n(){return o(this,n),t.apply(this,arguments)}return n}(m);t.MissingPDFException=_;var w=function(e){s(n,e);var t=c(n);function n(e,r){var i;return o(this,n),(i=t.call(this,e)).status=r,i}return n}(m);t.UnexpectedResponseException=w;var T=function(e){s(n,e);var t=c(n);function n(){return o(this,n),t.apply(this,arguments)}return n}(m);t.FormatError=T;var E=function(e){s(n,e);var t=c(n);function n(){return o(this,n),t.apply(this,arguments)}return n}(m);t.AbortException=E;var A=/\x00/g;function S(e){p("string"==typeof e,"Invalid argument for stringToBytes");for(var t=e.length,n=new Uint8Array(t),r=0;r<t;++r)n[r]=255&e.charCodeAt(r);return n}function O(e){return void 0!==e.length?e.length:(p(void 0!==e.byteLength),e.byteLength)}var I={get value(){return g(this,"value",((e=new Uint8Array(4))[0]=1,1===new Uint32Array(e.buffer,0,1)[0]));var e}};t.IsLittleEndianCached=I;var C={get value(){return g(this,"value",function(){try{return new Function(""),!0}catch(e){return!1}}())}};t.IsEvalSupportedCached=C;var k=["rgb(",0,",",0,",",0,")"],P=function(){function e(){o(this,e)}var t,n,i;return t=e,i=[{key:"makeCssRgb",value:function(e,t,n){return k[1]=e,k[3]=t,k[5]=n,k.join("")}},{key:"transform",value:function(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}},{key:"applyTransform",value:function(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]}},{key:"applyInverseTransform",value:function(e,t){var n=t[0]*t[3]-t[1]*t[2];return[(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n]}},{key:"getAxialAlignedBoundingBox",value:function(t,n){var r=e.applyTransform(t,n),i=e.applyTransform(t.slice(2,4),n),o=e.applyTransform([t[0],t[3]],n),s=e.applyTransform([t[2],t[1]],n);return[Math.min(r[0],i[0],o[0],s[0]),Math.min(r[1],i[1],o[1],s[1]),Math.max(r[0],i[0],o[0],s[0]),Math.max(r[1],i[1],o[1],s[1])]}},{key:"inverseTransform",value:function(e){var t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}},{key:"apply3dTransform",value:function(e,t){return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2],e[3]*t[0]+e[4]*t[1]+e[5]*t[2],e[6]*t[0]+e[7]*t[1]+e[8]*t[2]]}},{key:"singularValueDecompose2dScale",value:function(e){var t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],r=e[0]*t[1]+e[1]*t[3],i=e[2]*t[0]+e[3]*t[2],o=e[2]*t[1]+e[3]*t[3],s=(n+o)/2,a=Math.sqrt((n+o)*(n+o)-4*(n*o-i*r))/2,c=s+a||1,l=s-a||1;return[Math.sqrt(c),Math.sqrt(l)]}},{key:"normalizeRect",value:function(e){var t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}},{key:"intersect",value:function(t,n){function r(e,t){return e-t}var i=[t[0],t[2],n[0],n[2]].sort(r),o=[t[1],t[3],n[1],n[3]].sort(r),s=[];return t=e.normalizeRect(t),n=e.normalizeRect(n),i[0]===t[0]&&i[1]===n[0]||i[0]===n[0]&&i[1]===t[0]?(s[0]=i[1],s[2]=i[2],o[0]===t[1]&&o[1]===n[1]||o[0]===n[1]&&o[1]===t[1]?(s[1]=o[1],s[3]=o[2],s):null):null}}],(n=null)&&r(t.prototype,n),i&&r(t,i),e}();t.Util=P;var x,R=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364],L=(x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",function(e,t){if(!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&URL.createObjectURL){var n=new Blob([e],{type:t});return URL.createObjectURL(n)}for(var r="data:".concat(t,";base64,"),i=0,o=e.length;i<o;i+=3){var s=255&e[i],a=255&e[i+1],c=255&e[i+2];r+=x[s>>2]+x[(3&s)<<4|a>>4]+x[i+1<o?(15&a)<<2|c>>6:64]+x[i+2<o?63&c:64]}return r});t.createObjectURL=L},function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}if("undefined"==typeof globalThis||!globalThis._pdfjsCompatibilityChecked){"undefined"!=typeof globalThis&&globalThis.Math===Math||(globalThis=n(3)),globalThis._pdfjsCompatibilityChecked=!0;var i=n(65).isNodeJS,o="object"===("undefined"==typeof window?"undefined":r(window))&&"object"===("undefined"==typeof document?"undefined":r(document)),s="undefined"!=typeof navigator&&navigator.userAgent||"",a=/Trident/.test(s);!globalThis.btoa&&i&&(globalThis.btoa=function(e){return Buffer.from(e,"binary").toString("base64")}),!globalThis.atob&&i&&(globalThis.atob=function(e){return Buffer.from(e,"base64").toString("binary")}),o&&void 0===Element.prototype.remove&&(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),function(){if(o&&!i){var e=document.createElement("div");if(e.classList.add("testOne","testTwo"),!0!==e.classList.contains("testOne")||!0!==e.classList.contains("testTwo")){var t=DOMTokenList.prototype.add,n=DOMTokenList.prototype.remove;DOMTokenList.prototype.add=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var s=o[i];t.call(this,s)}},DOMTokenList.prototype.remove=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var i=0,o=t;i<o.length;i++){var s=o[i];n.call(this,s)}}}}}(),o&&!i&&!1!==document.createElement("div").classList.toggle("test",0)&&(DOMTokenList.prototype.toggle=function(e){var t=arguments.length>1?!!arguments[1]:!this.contains(e);return this[t?"add":"remove"](e),t}),function(){if(o&&a){var e=window.history.pushState,t=window.history.replaceState;window.history.pushState=function(t,n,r){var i=void 0===r?[t,n]:[t,n,r];e.apply(this,i)},window.history.replaceState=function(e,n,r){var i=void 0===r?[e,n]:[e,n,r];t.apply(this,i)}}}(),String.prototype.startsWith||n(66),String.prototype.endsWith||n(75),String.prototype.includes||n(77),Array.prototype.includes||n(79),Array.from||n(86),Object.assign||n(110),Math.log2||(Math.log2=n(113)),Number.isNaN||(Number.isNaN=n(115)),Number.isInteger||(Number.isInteger=n(117)),globalThis.Promise&&globalThis.Promise.allSettled||(globalThis.Promise=n(120)),globalThis.URL=n(153),function(){var e=!1;if("undefined"!=typeof ReadableStream)try{new ReadableStream({start:function(e){e.close()}}),e=!0}catch(e){}e||(globalThis.ReadableStream=n(160).ReadableStream)}(),globalThis.Map&&globalThis.Map.prototype.entries||(globalThis.Map=n(161)),globalThis.Set&&globalThis.Set.prototype.entries||(globalThis.Set=n(171)),globalThis.WeakMap||(globalThis.WeakMap=n(173)),globalThis.WeakSet||(globalThis.WeakSet=n(180)),String.prototype.codePointAt||n(182),String.fromCodePoint||(String.fromCodePoint=n(184)),globalThis.Symbol||n(186),String.prototype.padStart||n(209),String.prototype.padEnd||n(214),Object.values||(Object.values=n(216))}},function(e,t,n){n(4),e.exports=n(6)},function(e,t,n){n(5)({global:!0},{globalThis:n(6)})},function(e,t,n){var r=n(6),i=n(7).f,o=n(43),s=n(46),a=n(37),c=n(53),l=n(64);e.exports=function(e,t){var n,u,d,h,f,p=e.target,g=e.global,m=e.stat;if(n=g?r:m?r[p]||a(p,{}):(r[p]||{}).prototype)for(u in t){if(h=t[u],d=e.noTargetGet?(f=i(n,u))&&f.value:n[u],!l(g?u:p+(m?".":"#")+u,e.forced)&&void 0!==d){if(typeof h==typeof d)continue;c(h,d)}(e.sham||d&&d.sham)&&o(h,"sham",!0),s(n,u,h,e)}}},function(e,t){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof global&&global)||function(){return this}()||Function("return this")()},function(e,t,n){var r=n(8),i=n(10),o=n(11),s=n(12),a=n(13),c=n(18),l=n(38),u=n(41),d=Object.getOwnPropertyDescriptor;t.f=r?d:function(e,t){if(e=a(e),t=c(t),u)try{return d(e,t)}catch(e){}if(l(e,t))return s(!i(o.f,e,t),e[t])}},function(e,t,n){var r=n(9);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var n=Function.prototype.call;e.exports=n.bind?n.bind(n):function(){return n.apply(n,arguments)}},function(e,t,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);t.f=o?function(e){var t=i(this,e);return!!t&&t.enumerable}:r},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(14),i=n(17);e.exports=function(e){return r(i(e))}},function(e,t,n){var r=n(6),i=n(15),o=n(9),s=n(16),a=r.Object,c=i("".split);e.exports=o((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"==s(e)?c(e,""):a(e)}:a},function(e,t){var n=Function.prototype,r=n.bind,i=n.call,o=r&&r.bind(i);e.exports=r?function(e){return e&&o(i,e)}:function(e){return e&&function(){return i.apply(e,arguments)}}},function(e,t,n){var r=n(15),i=r({}.toString),o=r("".slice);e.exports=function(e){return o(i(e),8,-1)}},function(e,t,n){var r=n(6).TypeError;e.exports=function(e){if(null==e)throw r("Can't call method on "+e);return e}},function(e,t,n){var r=n(19),i=n(22);e.exports=function(e){var t=r(e,"string");return i(t)?t:t+""}},function(e,t,n){var r=n(6),i=n(10),o=n(20),s=n(22),a=n(29),c=n(32),l=n(33),u=r.TypeError,d=l("toPrimitive");e.exports=function(e,t){if(!o(e)||s(e))return e;var n,r=a(e,d);if(r){if(void 0===t&&(t="default"),n=i(r,e,t),!o(n)||s(n))return n;throw u("Can't convert object to primitive value")}return void 0===t&&(t="number"),c(e,t)}},function(e,t,n){var r=n(21);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},function(e,t){e.exports=function(e){return"function"==typeof e}},function(e,t,n){var r=n(6),i=n(23),o=n(21),s=n(24),a=n(25),c=r.Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=i("Symbol");return o(t)&&s(t.prototype,c(e))}},function(e,t,n){var r=n(6),i=n(21);e.exports=function(e,t){return arguments.length<2?(n=r[e],i(n)?n:void 0):r[e]&&r[e][t];var n}},function(e,t,n){var r=n(15);e.exports=r({}.isPrototypeOf)},function(e,t,n){var r=n(26);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,n){var r=n(27),i=n(9);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41}))},function(e,t,n){var r,i,o=n(6),s=n(28),a=o.process,c=o.Deno,l=a&&a.versions||c&&c.version,u=l&&l.v8;u&&(i=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!i&&s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(i=+r[1]),e.exports=i},function(e,t,n){var r=n(23);e.exports=r("navigator","userAgent")||""},function(e,t,n){var r=n(30);e.exports=function(e,t){var n=e[t];return null==n?void 0:r(n)}},function(e,t,n){var r=n(6),i=n(21),o=n(31),s=r.TypeError;e.exports=function(e){if(i(e))return e;throw s(o(e)+" is not a function")}},function(e,t,n){var r=n(6).String;e.exports=function(e){try{return r(e)}catch(e){return"Object"}}},function(e,t,n){var r=n(6),i=n(10),o=n(21),s=n(20),a=r.TypeError;e.exports=function(e,t){var n,r;if("string"===t&&o(n=e.toString)&&!s(r=i(n,e)))return r;if(o(n=e.valueOf)&&!s(r=i(n,e)))return r;if("string"!==t&&o(n=e.toString)&&!s(r=i(n,e)))return r;throw a("Can't convert object to primitive value")}},function(e,t,n){var r=n(6),i=n(34),o=n(38),s=n(40),a=n(26),c=n(25),l=i("wks"),u=r.Symbol,d=u&&u.for,h=c?u:u&&u.withoutSetter||s;e.exports=function(e){if(!o(l,e)||!a&&"string"!=typeof l[e]){var t="Symbol."+e;a&&o(u,e)?l[e]=u[e]:l[e]=c&&d?d(t):h(t)}return l[e]}},function(e,t,n){var r=n(35),i=n(36);(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.19.1",mode:r?"pure":"global",copyright:"\xa9 2021 Denis Pushkarev (zloirock.ru)"})},function(e,t){e.exports=!1},function(e,t,n){var r=n(6),i=n(37),o="__core-js_shared__",s=r[o]||i(o,{});e.exports=s},function(e,t,n){var r=n(6),i=Object.defineProperty;e.exports=function(e,t){try{i(r,e,{value:t,configurable:!0,writable:!0})}catch(n){r[e]=t}return t}},function(e,t,n){var r=n(15),i=n(39),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},function(e,t,n){var r=n(6),i=n(17),o=r.Object;e.exports=function(e){return o(i(e))}},function(e,t,n){var r=n(15),i=0,o=Math.random(),s=r(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+s(++i+o,36)}},function(e,t,n){var r=n(8),i=n(9),o=n(42);e.exports=!r&&!i((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(6),i=n(20),o=r.document,s=i(o)&&i(o.createElement);e.exports=function(e){return s?o.createElement(e):{}}},function(e,t,n){var r=n(8),i=n(44),o=n(12);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(6),i=n(8),o=n(41),s=n(45),a=n(18),c=r.TypeError,l=Object.defineProperty;t.f=i?l:function(e,t,n){if(s(e),t=a(t),s(n),o)try{return l(e,t,n)}catch(e){}if("get"in n||"set"in n)throw c("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(6),i=n(20),o=r.String,s=r.TypeError;e.exports=function(e){if(i(e))return e;throw s(o(e)+" is not an object")}},function(e,t,n){var r=n(6),i=n(21),o=n(38),s=n(43),a=n(37),c=n(47),l=n(48),u=n(52).CONFIGURABLE,d=l.get,h=l.enforce,f=String(String).split("String");(e.exports=function(e,t,n,c){var l,d=!!c&&!!c.unsafe,p=!!c&&!!c.enumerable,g=!!c&&!!c.noTargetGet,m=c&&void 0!==c.name?c.name:t;i(n)&&("Symbol("===String(m).slice(0,7)&&(m="["+String(m).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!o(n,"name")||u&&n.name!==m)&&s(n,"name",m),(l=h(n)).source||(l.source=f.join("string"==typeof m?m:""))),e!==r?(d?!g&&e[t]&&(p=!0):delete e[t],p?e[t]=n:s(e,t,n)):p?e[t]=n:a(t,n)})(Function.prototype,"toString",(function(){return i(this)&&d(this).source||c(this)}))},function(e,t,n){var r=n(15),i=n(21),o=n(36),s=r(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return s(e)}),e.exports=o.inspectSource},function(e,t,n){var r,i,o,s=n(49),a=n(6),c=n(15),l=n(20),u=n(43),d=n(38),h=n(36),f=n(50),p=n(51),g="Object already initialized",m=a.TypeError,y=a.WeakMap;if(s||h.state){var v=h.state||(h.state=new y),b=c(v.get),_=c(v.has),w=c(v.set);r=function(e,t){if(_(v,e))throw new m(g);return t.facade=e,w(v,e,t),t},i=function(e){return b(v,e)||{}},o=function(e){return _(v,e)}}else{var T=f("state");p[T]=!0,r=function(e,t){if(d(e,T))throw new m(g);return t.facade=e,u(e,T,t),t},i=function(e){return d(e,T)?e[T]:{}},o=function(e){return d(e,T)}}e.exports={set:r,get:i,has:o,enforce:function(e){return o(e)?i(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!l(t)||(n=i(t)).type!==e)throw m("Incompatible receiver, "+e+" required");return n}}}},function(e,t,n){var r=n(6),i=n(21),o=n(47),s=r.WeakMap;e.exports=i(s)&&/native code/.test(o(s))},function(e,t,n){var r=n(34),i=n(40),o=r("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},function(e,t){e.exports={}},function(e,t,n){var r=n(8),i=n(38),o=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,a=i(o,"name"),c=a&&"something"===function(){}.name,l=a&&(!r||r&&s(o,"name").configurable);e.exports={EXISTS:a,PROPER:c,CONFIGURABLE:l}},function(e,t,n){var r=n(38),i=n(54),o=n(7),s=n(44);e.exports=function(e,t){for(var n=i(t),a=s.f,c=o.f,l=0;l<n.length;l++){var u=n[l];r(e,u)||a(e,u,c(t,u))}}},function(e,t,n){var r=n(23),i=n(15),o=n(55),s=n(63),a=n(45),c=i([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(a(e)),n=s.f;return n?c(t,n(e)):t}},function(e,t,n){var r=n(56),i=n(62).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(15),i=n(38),o=n(13),s=n(57).indexOf,a=n(51),c=r([].push);e.exports=function(e,t){var n,r=o(e),l=0,u=[];for(n in r)!i(a,n)&&i(r,n)&&c(u,n);for(;t.length>l;)i(r,n=t[l++])&&(~s(u,n)||c(u,n));return u}},function(e,t,n){var r=n(13),i=n(58),o=n(60),s=function(e){return function(t,n,s){var a,c=r(t),l=o(c),u=i(s,l);if(e&&n!=n){for(;l>u;)if((a=c[u++])!=a)return!0}else for(;l>u;u++)if((e||u in c)&&c[u]===n)return e||u||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},function(e,t,n){var r=n(59),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){var t=+e;return t!=t||0===t?0:(t>0?r:n)(t)}},function(e,t,n){var r=n(61);e.exports=function(e){return r(e.length)}},function(e,t,n){var r=n(59),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(9),i=n(21),o=/#|\.prototype\./,s=function(e,t){var n=c[a(e)];return n==u||n!=l&&(i(t)?r(t):!!t)},a=s.normalize=function(e){return String(e).replace(o,".").toLowerCase()},c=s.data={},l=s.NATIVE="N",u=s.POLYFILL="P";e.exports=s},function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.isNodeJS=void 0;var i="object"===(void 0===process?"undefined":r(process))&&process+""=="[object process]"&&!process.versions.nw&&!process.versions.electron;t.isNodeJS=i},function(e,t,n){n(67);var r=n(74);e.exports=r("String","startsWith")},function(e,t,n){"use strict";var r,i=n(5),o=n(15),s=n(7).f,a=n(61),c=n(68),l=n(71),u=n(17),d=n(73),h=n(35),f=o("".startsWith),p=o("".slice),g=Math.min,m=d("startsWith");i({target:"String",proto:!0,forced:!(!h&&!m&&(r=s(String.prototype,"startsWith"),r&&!r.writable)||m)},{startsWith:function(e){var t=c(u(this));l(e);var n=a(g(arguments.length>1?arguments[1]:void 0,t.length)),r=c(e);return f?f(t,r,n):p(t,n,n+r.length)===r}})},function(e,t,n){var r=n(6),i=n(69),o=r.String;e.exports=function(e){if("Symbol"===i(e))throw TypeError("Cannot convert a Symbol value to a string");return o(e)}},function(e,t,n){var r=n(6),i=n(70),o=n(21),s=n(16),a=n(33)("toStringTag"),c=r.Object,l="Arguments"==s(function(){return arguments}());e.exports=i?s:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=c(e),a))?n:l?s(t):"Object"==(r=s(t))&&o(t.callee)?"Arguments":r}},function(e,t,n){var r={};r[n(33)("toStringTag")]="z",e.exports="[object z]"===String(r)},function(e,t,n){var r=n(6),i=n(72),o=r.TypeError;e.exports=function(e){if(i(e))throw o("The method doesn't accept regular expressions");return e}},function(e,t,n){var r=n(20),i=n(16),o=n(33)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t,n){var r=n(33)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,"/./"[e](t)}catch(e){}}return!1}},function(e,t,n){var r=n(6),i=n(15);e.exports=function(e,t){return i(r[e].prototype[t])}},function(e,t,n){n(76);var r=n(74);e.exports=r("String","endsWith")},function(e,t,n){"use strict";var r,i=n(5),o=n(15),s=n(7).f,a=n(61),c=n(68),l=n(71),u=n(17),d=n(73),h=n(35),f=o("".endsWith),p=o("".slice),g=Math.min,m=d("endsWith");i({target:"String",proto:!0,forced:!(!h&&!m&&(r=s(String.prototype,"endsWith"),r&&!r.writable)||m)},{endsWith:function(e){var t=c(u(this));l(e);var n=arguments.length>1?arguments[1]:void 0,r=t.length,i=void 0===n?r:g(a(n),r),o=c(e);return f?f(t,o,i):p(t,i-o.length,i)===o}})},function(e,t,n){n(78);var r=n(74);e.exports=r("String","includes")},function(e,t,n){"use strict";var r=n(5),i=n(15),o=n(71),s=n(17),a=n(68),c=n(73),l=i("".indexOf);r({target:"String",proto:!0,forced:!c("includes")},{includes:function(e){return!!~l(a(s(this)),a(o(e)),arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){n(80);var r=n(74);e.exports=r("Array","includes")},function(e,t,n){"use strict";var r=n(5),i=n(57).includes,o=n(81);r({target:"Array",proto:!0},{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},function(e,t,n){var r=n(33),i=n(82),o=n(44),s=r("unscopables"),a=Array.prototype;null==a[s]&&o.f(a,s,{configurable:!0,value:i(null)}),e.exports=function(e){a[s][e]=!0}},function(e,t,n){var r,i=n(45),o=n(83),s=n(62),a=n(51),c=n(85),l=n(42),u=n(50),d="prototype",h="script",f=u("IE_PROTO"),p=function(){},g=function(e){return"<"+h+">"+e+"</"+h+">"},m=function(e){e.write(g("")),e.close();var t=e.parentWindow.Object;return e=null,t},y=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}var e,t,n;y="undefined"!=typeof document?document.domain&&r?m(r):(t=l("iframe"),n="java"+h+":",t.style.display="none",c.appendChild(t),t.src=String(n),(e=t.contentWindow.document).open(),e.write(g("document.F=Object")),e.close(),e.F):m(r);for(var i=s.length;i--;)delete y[d][s[i]];return y()};a[f]=!0,e.exports=Object.create||function(e,t){var n;return null!==e?(p[d]=i(e),n=new p,p[d]=null,n[f]=e):n=y(),void 0===t?n:o(n,t)}},function(e,t,n){var r=n(8),i=n(44),o=n(45),s=n(13),a=n(84);e.exports=r?Object.defineProperties:function(e,t){o(e);for(var n,r=s(t),c=a(t),l=c.length,u=0;l>u;)i.f(e,n=c[u++],r[n]);return e}},function(e,t,n){var r=n(56),i=n(62);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(23);e.exports=r("document","documentElement")},function(e,t,n){n(87),n(98);var r=n(109);e.exports=r.Array.from},function(e,t,n){"use strict";var r=n(88).charAt,i=n(68),o=n(48),s=n(89),a="String Iterator",c=o.set,l=o.getterFor(a);s(String,"String",(function(e){c(this,{type:a,string:i(e),index:0})}),(function(){var e,t=l(this),n=t.string,i=t.index;return i>=n.length?{value:void 0,done:!0}:(e=r(n,i),t.index+=e.length,{value:e,done:!1})}))},function(e,t,n){var r=n(15),i=n(59),o=n(68),s=n(17),a=r("".charAt),c=r("".charCodeAt),l=r("".slice),u=function(e){return function(t,n){var r,u,d=o(s(t)),h=i(n),f=d.length;return h<0||h>=f?e?"":void 0:(r=c(d,h))<55296||r>56319||h+1===f||(u=c(d,h+1))<56320||u>57343?e?a(d,h):r:e?l(d,h,h+2):u-56320+(r-55296<<10)+65536}};e.exports={codeAt:u(!1),charAt:u(!0)}},function(e,t,n){"use strict";var r=n(5),i=n(10),o=n(35),s=n(52),a=n(21),c=n(90),l=n(92),u=n(96),d=n(94),h=n(43),f=n(46),p=n(33),g=n(95),m=n(91),y=s.PROPER,v=s.CONFIGURABLE,b=m.IteratorPrototype,_=m.BUGGY_SAFARI_ITERATORS,w=p("iterator"),T="keys",E="values",A="entries",S=function(){return this};e.exports=function(e,t,n,s,p,m,O){c(n,t,s);var I,C,k,P=function(e){if(e===p&&N)return N;if(!_&&e in L)return L[e];switch(e){case T:case E:case A:return function(){return new n(this,e)}}return function(){return new n(this)}},x=t+" Iterator",R=!1,L=e.prototype,D=L[w]||L["@@iterator"]||p&&L[p],N=!_&&D||P(p),j="Array"==t&&L.entries||D;if(j&&(I=l(j.call(new e)))!==Object.prototype&&I.next&&(o||l(I)===b||(u?u(I,b):a(I[w])||f(I,w,S)),d(I,x,!0,!0),o&&(g[x]=S)),y&&p==E&&D&&D.name!==E&&(!o&&v?h(L,"name",E):(R=!0,N=function(){return i(D,this)})),p)if(C={values:P(E),keys:m?N:P(T),entries:P(A)},O)for(k in C)(_||R||!(k in L))&&f(L,k,C[k]);else r({target:t,proto:!0,forced:_||R},C);return o&&!O||L[w]===N||f(L,w,N,{name:p}),g[t]=N,C}},function(e,t,n){"use strict";var r=n(91).IteratorPrototype,i=n(82),o=n(12),s=n(94),a=n(95),c=function(){return this};e.exports=function(e,t,n){var l=t+" Iterator";return e.prototype=i(r,{next:o(1,n)}),s(e,l,!1,!0),a[l]=c,e}},function(e,t,n){"use strict";var r,i,o,s=n(9),a=n(21),c=n(82),l=n(92),u=n(46),d=n(33),h=n(35),f=d("iterator"),p=!1;[].keys&&("next"in(o=[].keys())?(i=l(l(o)))!==Object.prototype&&(r=i):p=!0),null==r||s((function(){var e={};return r[f].call(e)!==e}))?r={}:h&&(r=c(r)),a(r[f])||u(r,f,(function(){return this})),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:p}},function(e,t,n){var r=n(6),i=n(38),o=n(21),s=n(39),a=n(50),c=n(93),l=a("IE_PROTO"),u=r.Object,d=u.prototype;e.exports=c?u.getPrototypeOf:function(e){var t=s(e);if(i(t,l))return t[l];var n=t.constructor;return o(n)&&t instanceof n?n.prototype:t instanceof u?d:null}},function(e,t,n){var r=n(9);e.exports=!r((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,t,n){var r=n(44).f,i=n(38),o=n(33)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t){e.exports={}},function(e,t,n){var r=n(15),i=n(45),o=n(97);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=r(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(n,[]),t=n instanceof Array}catch(e){}return function(n,r){return i(n),o(r),t?e(n,r):n.__proto__=r,n}}():void 0)},function(e,t,n){var r=n(6),i=n(21),o=r.String,s=r.TypeError;e.exports=function(e){if("object"==typeof e||i(e))return e;throw s("Can't set "+o(e)+" as a prototype")}},function(e,t,n){var r=n(5),i=n(99);r({target:"Array",stat:!0,forced:!n(108)((function(e){Array.from(e)}))},{from:i})},function(e,t,n){"use strict";var r=n(6),i=n(100),o=n(10),s=n(39),a=n(101),c=n(103),l=n(104),u=n(60),d=n(105),h=n(106),f=n(107),p=r.Array;e.exports=function(e){var t=s(e),n=l(this),r=arguments.length,g=r>1?arguments[1]:void 0,m=void 0!==g;m&&(g=i(g,r>2?arguments[2]:void 0));var y,v,b,_,w,T,E=f(t),A=0;if(!E||this==p&&c(E))for(y=u(t),v=n?new this(y):p(y);y>A;A++)T=m?g(t[A],A):t[A],d(v,A,T);else for(w=(_=h(t,E)).next,v=n?new this:[];!(b=o(w,_)).done;A++)T=m?a(_,g,[b.value,A],!0):b.value,d(v,A,T);return v.length=A,v}},function(e,t,n){var r=n(15),i=n(30),o=r(r.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?o(e,t):function(){return e.apply(t,arguments)}}},function(e,t,n){var r=n(45),i=n(102);e.exports=function(e,t,n,o){try{return o?t(r(n)[0],n[1]):t(n)}catch(t){i(e,"throw",t)}}},function(e,t,n){var r=n(10),i=n(45),o=n(29);e.exports=function(e,t,n){var s,a;i(e);try{if(!(s=o(e,"return"))){if("throw"===t)throw n;return n}s=r(s,e)}catch(e){a=!0,s=e}if("throw"===t)throw n;if(a)throw s;return i(s),n}},function(e,t,n){var r=n(33),i=n(95),o=r("iterator"),s=Array.prototype;e.exports=function(e){return void 0!==e&&(i.Array===e||s[o]===e)}},function(e,t,n){var r=n(15),i=n(9),o=n(21),s=n(69),a=n(23),c=n(47),l=function(){},u=[],d=a("Reflect","construct"),h=/^\s*(?:class|function)\b/,f=r(h.exec),p=!h.exec(l),g=function(e){if(!o(e))return!1;try{return d(l,u,e),!0}catch(e){return!1}};e.exports=!d||i((function(){var e;return g(g.call)||!g(Object)||!g((function(){e=!0}))||e}))?function(e){if(!o(e))return!1;switch(s(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}return p||!!f(h,c(e))}:g},function(e,t,n){"use strict";var r=n(18),i=n(44),o=n(12);e.exports=function(e,t,n){var s=r(t);s in e?i.f(e,s,o(0,n)):e[s]=n}},function(e,t,n){var r=n(6),i=n(10),o=n(30),s=n(45),a=n(31),c=n(107),l=r.TypeError;e.exports=function(e,t){var n=arguments.length<2?c(e):t;if(o(n))return s(i(n,e));throw l(a(e)+" is not iterable")}},function(e,t,n){var r=n(69),i=n(29),o=n(95),s=n(33)("iterator");e.exports=function(e){if(null!=e)return i(e,s)||i(e,"@@iterator")||o[r(e)]}},function(e,t,n){var r=n(33)("iterator"),i=!1;try{var o=0,s={next:function(){return{done:!!o++}},return:function(){i=!0}};s[r]=function(){return this},Array.from(s,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o={};o[r]=function(){return{next:function(){return{done:n=!0}}}},e(o)}catch(e){}return n}},function(e,t,n){var r=n(6);e.exports=r},function(e,t,n){n(111);var r=n(109);e.exports=r.Object.assign},function(e,t,n){var r=n(5),i=n(112);r({target:"Object",stat:!0,forced:Object.assign!==i},{assign:i})},function(e,t,n){"use strict";var r=n(8),i=n(15),o=n(10),s=n(9),a=n(84),c=n(63),l=n(11),u=n(39),d=n(14),h=Object.assign,f=Object.defineProperty,p=i([].concat);e.exports=!h||s((function(){if(r&&1!==h({b:1},h(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),i="abcdefghijklmnopqrst";return e[n]=7,i.split("").forEach((function(e){t[e]=e})),7!=h({},e)[n]||a(h({},t)).join("")!=i}))?function(e,t){for(var n=u(e),i=arguments.length,s=1,h=c.f,f=l.f;i>s;)for(var g,m=d(arguments[s++]),y=h?p(a(m),h(m)):a(m),v=y.length,b=0;v>b;)g=y[b++],r&&!o(f,m,g)||(n[g]=m[g]);return n}:h},function(e,t,n){n(114);var r=n(109);e.exports=r.Math.log2},function(e,t,n){var r=n(5),i=Math.log,o=Math.LN2;r({target:"Math",stat:!0},{log2:function(e){return i(e)/o}})},function(e,t,n){n(116);var r=n(109);e.exports=r.Number.isNaN},function(e,t,n){n(5)({target:"Number",stat:!0},{isNaN:function(e){return e!=e}})},function(e,t,n){n(118);var r=n(109);e.exports=r.Number.isInteger},function(e,t,n){n(5)({target:"Number",stat:!0},{isInteger:n(119)})},function(e,t,n){var r=n(20),i=Math.floor;e.exports=Number.isInteger||function(e){return!r(e)&&isFinite(e)&&i(e)===e}},function(e,t,n){n(121),n(128),n(129),n(131),n(150),n(151),n(152),n(87);var r=n(109);e.exports=r.Promise},function(e,t,n){"use strict";var r=n(5),i=n(6),o=n(24),s=n(92),a=n(96),c=n(53),l=n(82),u=n(43),d=n(12),h=n(122),f=n(124),p=n(125),g=n(126),m=n(33),y=n(127),v=m("toStringTag"),b=i.Error,_=[].push,w=function(e,t){var n,r=arguments.length>2?arguments[2]:void 0,i=o(T,this);a?n=a(new b(void 0),i?s(this):T):(n=i?this:l(T),u(n,v,"Error")),u(n,"message",g(t,"")),y&&u(n,"stack",h(n.stack,1)),f(n,r);var c=[];return p(e,_,{that:c}),u(n,"errors",c),n};a?a(w,b):c(w,b);var T=w.prototype=l(b.prototype,{constructor:d(1,w),message:d(1,""),name:d(1,"AggregateError")});r({global:!0},{AggregateError:w})},function(e,t,n){var r=n(15),i=n(123),o=r("".replace),s=r("".split),a=r([].join),c=String(Error("zxcasd").stack),l=/\n\s*at [^:]*:[^\n]*/,u=l.test(c),d=/@[^\n]*\n/.test(c)&&!/zxcasd/.test(c);e.exports=function(e,t){if("string"!=typeof e)return e;if(u)for(;t--;)e=o(e,l,"");else if(d)return a(i(s(e,"\n"),t),"\n");return e}},function(e,t,n){var r=n(15);e.exports=r([].slice)},function(e,t,n){var r=n(20),i=n(43);e.exports=function(e,t){r(t)&&"cause"in t&&i(e,"cause",t.cause)}},function(e,t,n){var r=n(6),i=n(100),o=n(10),s=n(45),a=n(31),c=n(103),l=n(60),u=n(24),d=n(106),h=n(107),f=n(102),p=r.TypeError,g=function(e,t){this.stopped=e,this.result=t},m=g.prototype;e.exports=function(e,t,n){var r,y,v,b,_,w,T,E=n&&n.that,A=!(!n||!n.AS_ENTRIES),S=!(!n||!n.IS_ITERATOR),O=!(!n||!n.INTERRUPTED),I=i(t,E),C=function(e){return r&&f(r,"normal",e),new g(!0,e)},k=function(e){return A?(s(e),O?I(e[0],e[1],C):I(e[0],e[1])):O?I(e,C):I(e)};if(S)r=e;else{if(!(y=h(e)))throw p(a(e)+" is not iterable");if(c(y)){for(v=0,b=l(e);b>v;v++)if((_=k(e[v]))&&u(m,_))return _;return new g(!1)}r=d(e,y)}for(w=r.next;!(T=o(w,r)).done;){try{_=k(T.value)}catch(e){f(r,"throw",e)}if("object"==typeof _&&_&&u(m,_))return _}return new g(!1)}},function(e,t,n){var r=n(68);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:r(e)}},function(e,t,n){var r=n(9),i=n(12);e.exports=!r((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",i(1,7)),7!==e.stack)}))},function(e,t,n){"use strict";var r=n(13),i=n(81),o=n(95),s=n(48),a=n(89),c="Array Iterator",l=s.set,u=s.getterFor(c);e.exports=a(Array,"Array",(function(e,t){l(this,{type:c,target:r(e),index:0,kind:t})}),(function(){var e=u(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values"),o.Arguments=o.Array,i("keys"),i("values"),i("entries")},function(e,t,n){var r=n(70),i=n(46),o=n(130);r||i(Object.prototype,"toString",o,{unsafe:!0})},function(e,t,n){"use strict";var r=n(70),i=n(69);e.exports=r?{}.toString:function(){return"[object "+i(this)+"]"}},function(e,t,n){"use strict";var r,i,o,s,a=n(5),c=n(35),l=n(6),u=n(23),d=n(10),h=n(132),f=n(46),p=n(133),g=n(96),m=n(94),y=n(134),v=n(30),b=n(21),_=n(20),w=n(135),T=n(47),E=n(125),A=n(108),S=n(136),O=n(138).set,I=n(142),C=n(145),k=n(147),P=n(146),x=n(148),R=n(48),L=n(64),D=n(33),N=n(149),j=n(141),M=n(27),F=D("species"),U="Promise",B=R.get,G=R.set,q=R.getterFor(U),H=h&&h.prototype,$=h,W=H,z=l.TypeError,V=l.document,K=l.process,Y=P.f,Q=Y,X=!!(V&&V.createEvent&&l.dispatchEvent),J=b(l.PromiseRejectionEvent),Z="unhandledrejection",ee=!1,te=L(U,(function(){var e=T($),t=e!==String($);if(!t&&66===M)return!0;if(c&&!W.finally)return!0;if(M>=51&&/native code/.test(e))return!1;var n=new $((function(e){e(1)})),r=function(e){e((function(){}),(function(){}))};return(n.constructor={})[F]=r,!(ee=n.then((function(){}))instanceof r)||!t&&N&&!J})),ne=te||!A((function(e){$.all(e).catch((function(){}))})),re=function(e){var t;return!(!_(e)||!b(t=e.then))&&t},ie=function(e,t){if(!e.notified){e.notified=!0;var n=e.reactions;I((function(){for(var r=e.value,i=1==e.state,o=0;n.length>o;){var s,a,c,l=n[o++],u=i?l.ok:l.fail,h=l.resolve,f=l.reject,p=l.domain;try{u?(i||(2===e.rejection&&ce(e),e.rejection=1),!0===u?s=r:(p&&p.enter(),s=u(r),p&&(p.exit(),c=!0)),s===l.promise?f(z("Promise-chain cycle")):(a=re(s))?d(a,s,h,f):h(s)):f(r)}catch(e){p&&!c&&p.exit(),f(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&se(e)}))}},oe=function(e,t,n){var r,i;X?((r=V.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),l.dispatchEvent(r)):r={promise:t,reason:n},!J&&(i=l["on"+e])?i(r):e===Z&&k("Unhandled promise rejection",n)},se=function(e){d(O,l,(function(){var t,n=e.facade,r=e.value;if(ae(e)&&(t=x((function(){j?K.emit("unhandledRejection",r,n):oe(Z,n,r)})),e.rejection=j||ae(e)?2:1,t.error))throw t.value}))},ae=function(e){return 1!==e.rejection&&!e.parent},ce=function(e){d(O,l,(function(){var t=e.facade;j?K.emit("rejectionHandled",t):oe("rejectionhandled",t,e.value)}))},le=function(e,t,n){return function(r){e(t,r,n)}},ue=function(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,ie(e,!0))},de=function(e,t,n){if(!e.done){e.done=!0,n&&(e=n);try{if(e.facade===t)throw z("Promise can't be resolved itself");var r=re(t);r?I((function(){var n={done:!1};try{d(r,t,le(de,n,e),le(ue,n,e))}catch(t){ue(n,t,e)}})):(e.value=t,e.state=1,ie(e,!1))}catch(t){ue({done:!1},t,e)}}};if(te&&(W=($=function(e){w(this,W),v(e),d(r,this);var t=B(this);try{e(le(de,t),le(ue,t))}catch(e){ue(t,e)}}).prototype,(r=function(e){G(this,{type:U,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=p(W,{then:function(e,t){var n=q(this),r=n.reactions,i=Y(S(this,$));return i.ok=!b(e)||e,i.fail=b(t)&&t,i.domain=j?K.domain:void 0,n.parent=!0,r[r.length]=i,0!=n.state&&ie(n,!1),i.promise},catch:function(e){return this.then(void 0,e)}}),i=function(){var e=new r,t=B(e);this.promise=e,this.resolve=le(de,t),this.reject=le(ue,t)},P.f=Y=function(e){return e===$||e===o?new i(e):Q(e)},!c&&b(h)&&H!==Object.prototype)){s=H.then,ee||(f(H,"then",(function(e,t){var n=this;return new $((function(e,t){d(s,n,e,t)})).then(e,t)}),{unsafe:!0}),f(H,"catch",W.catch,{unsafe:!0}));try{delete H.constructor}catch(e){}g&&g(H,W)}a({global:!0,wrap:!0,forced:te},{Promise:$}),m($,U,!1,!0),y(U),o=u(U),a({target:U,stat:!0,forced:te},{reject:function(e){var t=Y(this);return d(t.reject,void 0,e),t.promise}}),a({target:U,stat:!0,forced:c||te},{resolve:function(e){return C(c&&this===o?$:this,e)}}),a({target:U,stat:!0,forced:ne},{all:function(e){var t=this,n=Y(t),r=n.resolve,i=n.reject,o=x((function(){var n=v(t.resolve),o=[],s=0,a=1;E(e,(function(e){var c=s++,l=!1;a++,d(n,t,e).then((function(e){l||(l=!0,o[c]=e,--a||r(o))}),i)})),--a||r(o)}));return o.error&&i(o.value),n.promise},race:function(e){var t=this,n=Y(t),r=n.reject,i=x((function(){var i=v(t.resolve);E(e,(function(e){d(i,t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}})},function(e,t,n){var r=n(6);e.exports=r.Promise},function(e,t,n){var r=n(46);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t,n){"use strict";var r=n(23),i=n(44),o=n(33),s=n(8),a=o("species");e.exports=function(e){var t=r(e),n=i.f;s&&t&&!t[a]&&n(t,a,{configurable:!0,get:function(){return this}})}},function(e,t,n){var r=n(6),i=n(24),o=r.TypeError;e.exports=function(e,t){if(i(t,e))return e;throw o("Incorrect invocation")}},function(e,t,n){var r=n(45),i=n(137),o=n(33)("species");e.exports=function(e,t){var n,s=r(e).constructor;return void 0===s||null==(n=r(s)[o])?t:i(n)}},function(e,t,n){var r=n(6),i=n(104),o=n(31),s=r.TypeError;e.exports=function(e){if(i(e))return e;throw s(o(e)+" is not a constructor")}},function(e,t,n){var r,i,o,s,a=n(6),c=n(139),l=n(100),u=n(21),d=n(38),h=n(9),f=n(85),p=n(123),g=n(42),m=n(140),y=n(141),v=a.setImmediate,b=a.clearImmediate,_=a.process,w=a.Dispatch,T=a.Function,E=a.MessageChannel,A=a.String,S=0,O={},I="onreadystatechange";try{r=a.location}catch(e){}var C=function(e){if(d(O,e)){var t=O[e];delete O[e],t()}},k=function(e){return function(){C(e)}},P=function(e){C(e.data)},x=function(e){a.postMessage(A(e),r.protocol+"//"+r.host)};v&&b||(v=function(e){var t=p(arguments,1);return O[++S]=function(){c(u(e)?e:T(e),void 0,t)},i(S),S},b=function(e){delete O[e]},y?i=function(e){_.nextTick(k(e))}:w&&w.now?i=function(e){w.now(k(e))}:E&&!m?(s=(o=new E).port2,o.port1.onmessage=P,i=l(s.postMessage,s)):a.addEventListener&&u(a.postMessage)&&!a.importScripts&&r&&"file:"!==r.protocol&&!h(x)?(i=x,a.addEventListener("message",P,!1)):i=I in g("script")?function(e){f.appendChild(g("script"))[I]=function(){f.removeChild(this),C(e)}}:function(e){setTimeout(k(e),0)}),e.exports={set:v,clear:b}},function(e,t){var n=Function.prototype,r=n.apply,i=n.bind,o=n.call;e.exports="object"==typeof Reflect&&Reflect.apply||(i?o.bind(r):function(){return o.apply(r,arguments)})},function(e,t,n){var r=n(28);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},function(e,t,n){var r=n(16),i=n(6);e.exports="process"==r(i.process)},function(e,t,n){var r,i,o,s,a,c,l,u,d=n(6),h=n(100),f=n(7).f,p=n(138).set,g=n(140),m=n(143),y=n(144),v=n(141),b=d.MutationObserver||d.WebKitMutationObserver,_=d.document,w=d.process,T=d.Promise,E=f(d,"queueMicrotask"),A=E&&E.value;A||(r=function(){var e,t;for(v&&(e=w.domain)&&e.exit();i;){t=i.fn,i=i.next;try{t()}catch(e){throw i?s():o=void 0,e}}o=void 0,e&&e.enter()},g||v||y||!b||!_?!m&&T&&T.resolve?((l=T.resolve(void 0)).constructor=T,u=h(l.then,l),s=function(){u(r)}):v?s=function(){w.nextTick(r)}:(p=h(p,d),s=function(){p(r)}):(a=!0,c=_.createTextNode(""),new b(r).observe(c,{characterData:!0}),s=function(){c.data=a=!a})),e.exports=A||function(e){var t={fn:e,next:void 0};o&&(o.next=t),i||(i=t,s()),o=t}},function(e,t,n){var r=n(28),i=n(6);e.exports=/ipad|iphone|ipod/i.test(r)&&void 0!==i.Pebble},function(e,t,n){var r=n(28);e.exports=/web0s(?!.*chrome)/i.test(r)},function(e,t,n){var r=n(45),i=n(20),o=n(146);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var r=n(30),i=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)};e.exports.f=function(e){return new i(e)}},function(e,t,n){var r=n(6);e.exports=function(e,t){var n=r.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))}},function(e,t){e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},function(e,t){e.exports="object"==typeof window},function(e,t,n){"use strict";var r=n(5),i=n(10),o=n(30),s=n(146),a=n(148),c=n(125);r({target:"Promise",stat:!0},{allSettled:function(e){var t=this,n=s.f(t),r=n.resolve,l=n.reject,u=a((function(){var n=o(t.resolve),s=[],a=0,l=1;c(e,(function(e){var o=a++,c=!1;l++,i(n,t,e).then((function(e){c||(c=!0,s[o]={status:"fulfilled",value:e},--l||r(s))}),(function(e){c||(c=!0,s[o]={status:"rejected",reason:e},--l||r(s))}))})),--l||r(s)}));return u.error&&l(u.value),n.promise}})},function(e,t,n){"use strict";var r=n(5),i=n(30),o=n(23),s=n(10),a=n(146),c=n(148),l=n(125),u="No one promise resolved";r({target:"Promise",stat:!0},{any:function(e){var t=this,n=o("AggregateError"),r=a.f(t),d=r.resolve,h=r.reject,f=c((function(){var r=i(t.resolve),o=[],a=0,c=1,f=!1;l(e,(function(e){var i=a++,l=!1;c++,s(r,t,e).then((function(e){l||f||(f=!0,d(e))}),(function(e){l||f||(l=!0,o[i]=e,--c||h(new n(o,u)))}))})),--c||h(new n(o,u))}));return f.error&&h(f.value),r.promise}})},function(e,t,n){"use strict";var r=n(5),i=n(35),o=n(132),s=n(9),a=n(23),c=n(21),l=n(136),u=n(145),d=n(46);if(r({target:"Promise",proto:!0,real:!0,forced:!!o&&s((function(){o.prototype.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=l(this,a("Promise")),n=c(e);return this.then(n?function(n){return u(t,e()).then((function(){return n}))}:e,n?function(n){return u(t,e()).then((function(){throw n}))}:e)}}),!i&&c(o)){var h=a("Promise").prototype.finally;o.prototype.finally!==h&&d(o.prototype,"finally",h,{unsafe:!0})}},function(e,t,n){n(154),n(159),n(157);var r=n(109);e.exports=r.URL},function(e,t,n){"use strict";n(87);var r,i=n(5),o=n(8),s=n(155),a=n(6),c=n(100),l=n(10),u=n(15),d=n(83),h=n(46),f=n(135),p=n(38),g=n(112),m=n(99),y=n(123),v=n(88).codeAt,b=n(156),_=n(68),w=n(94),T=n(157),E=n(48),A=E.set,S=E.getterFor("URL"),O=T.URLSearchParams,I=T.getState,C=a.URL,k=a.TypeError,P=a.parseInt,x=Math.floor,R=Math.pow,L=u("".charAt),D=u(/./.exec),N=u([].join),j=u(1..toString),M=u([].pop),F=u([].push),U=u("".replace),B=u([].shift),G=u("".split),q=u("".slice),H=u("".toLowerCase),$=u([].unshift),W="Invalid scheme",z="Invalid host",V="Invalid port",K=/[a-z]/i,Y=/[\d+-.a-z]/i,Q=/\d/,X=/^0x/i,J=/^[0-7]+$/,Z=/^\d+$/,ee=/^[\da-f]+$/i,te=/[\0\t\n\r #%/:<>?@[\\\]^|]/,ne=/[\0\t\n\r #/:<>?@[\\\]^|]/,re=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,ie=/[\t\n\r]/g,oe=function(e,t){var n,r,i;if("["==L(t,0)){if("]"!=L(t,t.length-1))return z;if(!(n=ae(q(t,1,-1))))return z;e.host=n}else if(ge(e)){if(t=b(t),D(te,t))return z;if(null===(n=se(t)))return z;e.host=n}else{if(D(ne,t))return z;for(n="",r=m(t),i=0;i<r.length;i++)n+=fe(r[i],le);e.host=n}},se=function(e){var t,n,r,i,o,s,a,c=G(e,".");if(c.length&&""==c[c.length-1]&&c.length--,(t=c.length)>4)return e;for(n=[],r=0;r<t;r++){if(""==(i=c[r]))return e;if(o=10,i.length>1&&"0"==L(i,0)&&(o=D(X,i)?16:8,i=q(i,8==o?1:2)),""===i)s=0;else{if(!D(10==o?Z:8==o?J:ee,i))return e;s=P(i,o)}F(n,s)}for(r=0;r<t;r++)if(s=n[r],r==t-1){if(s>=R(256,5-t))return null}else if(s>255)return null;for(a=M(n),r=0;r<n.length;r++)a+=n[r]*R(256,3-r);return a},ae=function(e){var t,n,r,i,o,s,a,c=[0,0,0,0,0,0,0,0],l=0,u=null,d=0,h=function(){return L(e,d)};if(":"==h()){if(":"!=L(e,1))return;d+=2,u=++l}for(;h();){if(8==l)return;if(":"!=h()){for(t=n=0;n<4&&D(ee,h());)t=16*t+P(h(),16),d++,n++;if("."==h()){if(0==n)return;if(d-=n,l>6)return;for(r=0;h();){if(i=null,r>0){if(!("."==h()&&r<4))return;d++}if(!D(Q,h()))return;for(;D(Q,h());){if(o=P(h(),10),null===i)i=o;else{if(0==i)return;i=10*i+o}if(i>255)return;d++}c[l]=256*c[l]+i,2!=++r&&4!=r||l++}if(4!=r)return;break}if(":"==h()){if(d++,!h())return}else if(h())return;c[l++]=t}else{if(null!==u)return;d++,u=++l}}if(null!==u)for(s=l-u,l=7;0!=l&&s>0;)a=c[l],c[l--]=c[u+s-1],c[u+--s]=a;else if(8!=l)return;return c},ce=function(e){var t,n,r,i;if("number"==typeof e){for(t=[],n=0;n<4;n++)$(t,e%256),e=x(e/256);return N(t,".")}if("object"==typeof e){for(t="",r=function(e){for(var t=null,n=1,r=null,i=0,o=0;o<8;o++)0!==e[o]?(i>n&&(t=r,n=i),r=null,i=0):(null===r&&(r=o),++i);return i>n&&(t=r,n=i),t}(e),n=0;n<8;n++)i&&0===e[n]||(i&&(i=!1),r===n?(t+=n?":":"::",i=!0):(t+=j(e[n],16),n<7&&(t+=":")));return"["+t+"]"}return e},le={},ue=g({},le,{" ":1,'"':1,"<":1,">":1,"`":1}),de=g({},ue,{"#":1,"?":1,"{":1,"}":1}),he=g({},de,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),fe=function(e,t){var n=v(e,0);return n>32&&n<127&&!p(t,e)?e:encodeURIComponent(e)},pe={ftp:21,file:null,http:80,https:443,ws:80,wss:443},ge=function(e){return p(pe,e.scheme)},me=function(e){return""!=e.username||""!=e.password},ye=function(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme},ve=function(e,t){var n;return 2==e.length&&D(K,L(e,0))&&(":"==(n=L(e,1))||!t&&"|"==n)},be=function(e){var t;return e.length>1&&ve(q(e,0,2))&&(2==e.length||"/"===(t=L(e,2))||"\\"===t||"?"===t||"#"===t)},_e=function(e){var t=e.path,n=t.length;!n||"file"==e.scheme&&1==n&&ve(t[0],!0)||t.length--},we=function(e){return"."===e||"%2e"===H(e)},Te={},Ee={},Ae={},Se={},Oe={},Ie={},Ce={},ke={},Pe={},xe={},Re={},Le={},De={},Ne={},je={},Me={},Fe={},Ue={},Be={},Ge={},qe={},He=function(e,t,n,i){var o,s,a,c,l,u=n||Te,d=0,h="",f=!1,g=!1,v=!1;for(n||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=U(t,re,"")),t=U(t,ie,""),o=m(t);d<=o.length;){switch(s=o[d],u){case Te:if(!s||!D(K,s)){if(n)return W;u=Ae;continue}h+=H(s),u=Ee;break;case Ee:if(s&&(D(Y,s)||"+"==s||"-"==s||"."==s))h+=H(s);else{if(":"!=s){if(n)return W;h="",u=Ae,d=0;continue}if(n&&(ge(e)!=p(pe,h)||"file"==h&&(me(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=h,n)return void(ge(e)&&pe[e.scheme]==e.port&&(e.port=null));h="","file"==e.scheme?u=Ne:ge(e)&&i&&i.scheme==e.scheme?u=Se:ge(e)?u=ke:"/"==o[d+1]?(u=Oe,d++):(e.cannotBeABaseURL=!0,F(e.path,""),u=Be)}break;case Ae:if(!i||i.cannotBeABaseURL&&"#"!=s)return W;if(i.cannotBeABaseURL&&"#"==s){e.scheme=i.scheme,e.path=y(i.path),e.query=i.query,e.fragment="",e.cannotBeABaseURL=!0,u=qe;break}u="file"==i.scheme?Ne:Ie;continue;case Se:if("/"!=s||"/"!=o[d+1]){u=Ie;continue}u=Pe,d++;break;case Oe:if("/"==s){u=xe;break}u=Ue;continue;case Ie:if(e.scheme=i.scheme,s==r)e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=y(i.path),e.query=i.query;else if("/"==s||"\\"==s&&ge(e))u=Ce;else if("?"==s)e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=y(i.path),e.query="",u=Ge;else{if("#"!=s){e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=y(i.path),e.path.length--,u=Ue;continue}e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,e.path=y(i.path),e.query=i.query,e.fragment="",u=qe}break;case Ce:if(!ge(e)||"/"!=s&&"\\"!=s){if("/"!=s){e.username=i.username,e.password=i.password,e.host=i.host,e.port=i.port,u=Ue;continue}u=xe}else u=Pe;break;case ke:if(u=Pe,"/"!=s||"/"!=L(h,d+1))continue;d++;break;case Pe:if("/"!=s&&"\\"!=s){u=xe;continue}break;case xe:if("@"==s){f&&(h="%40"+h),f=!0,a=m(h);for(var b=0;b<a.length;b++){var _=a[b];if(":"!=_||v){var w=fe(_,he);v?e.password+=w:e.username+=w}else v=!0}h=""}else if(s==r||"/"==s||"?"==s||"#"==s||"\\"==s&&ge(e)){if(f&&""==h)return"Invalid authority";d-=m(h).length+1,h="",u=Re}else h+=s;break;case Re:case Le:if(n&&"file"==e.scheme){u=Me;continue}if(":"!=s||g){if(s==r||"/"==s||"?"==s||"#"==s||"\\"==s&&ge(e)){if(ge(e)&&""==h)return z;if(n&&""==h&&(me(e)||null!==e.port))return;if(c=oe(e,h))return c;if(h="",u=Fe,n)return;continue}"["==s?g=!0:"]"==s&&(g=!1),h+=s}else{if(""==h)return z;if(c=oe(e,h))return c;if(h="",u=De,n==Le)return}break;case De:if(!D(Q,s)){if(s==r||"/"==s||"?"==s||"#"==s||"\\"==s&&ge(e)||n){if(""!=h){var T=P(h,10);if(T>65535)return V;e.port=ge(e)&&T===pe[e.scheme]?null:T,h=""}if(n)return;u=Fe;continue}return V}h+=s;break;case Ne:if(e.scheme="file","/"==s||"\\"==s)u=je;else{if(!i||"file"!=i.scheme){u=Ue;continue}if(s==r)e.host=i.host,e.path=y(i.path),e.query=i.query;else if("?"==s)e.host=i.host,e.path=y(i.path),e.query="",u=Ge;else{if("#"!=s){be(N(y(o,d),""))||(e.host=i.host,e.path=y(i.path),_e(e)),u=Ue;continue}e.host=i.host,e.path=y(i.path),e.query=i.query,e.fragment="",u=qe}}break;case je:if("/"==s||"\\"==s){u=Me;break}i&&"file"==i.scheme&&!be(N(y(o,d),""))&&(ve(i.path[0],!0)?F(e.path,i.path[0]):e.host=i.host),u=Ue;continue;case Me:if(s==r||"/"==s||"\\"==s||"?"==s||"#"==s){if(!n&&ve(h))u=Ue;else if(""==h){if(e.host="",n)return;u=Fe}else{if(c=oe(e,h))return c;if("localhost"==e.host&&(e.host=""),n)return;h="",u=Fe}continue}h+=s;break;case Fe:if(ge(e)){if(u=Ue,"/"!=s&&"\\"!=s)continue}else if(n||"?"!=s)if(n||"#"!=s){if(s!=r&&(u=Ue,"/"!=s))continue}else e.fragment="",u=qe;else e.query="",u=Ge;break;case Ue:if(s==r||"/"==s||"\\"==s&&ge(e)||!n&&("?"==s||"#"==s)){if(".."===(l=H(l=h))||"%2e."===l||".%2e"===l||"%2e%2e"===l?(_e(e),"/"==s||"\\"==s&&ge(e)||F(e.path,"")):we(h)?"/"==s||"\\"==s&&ge(e)||F(e.path,""):("file"==e.scheme&&!e.path.length&&ve(h)&&(e.host&&(e.host=""),h=L(h,0)+":"),F(e.path,h)),h="","file"==e.scheme&&(s==r||"?"==s||"#"==s))for(;e.path.length>1&&""===e.path[0];)B(e.path);"?"==s?(e.query="",u=Ge):"#"==s&&(e.fragment="",u=qe)}else h+=fe(s,de);break;case Be:"?"==s?(e.query="",u=Ge):"#"==s?(e.fragment="",u=qe):s!=r&&(e.path[0]+=fe(s,le));break;case Ge:n||"#"!=s?s!=r&&("'"==s&&ge(e)?e.query+="%27":e.query+="#"==s?"%23":fe(s,le)):(e.fragment="",u=qe);break;case qe:s!=r&&(e.fragment+=fe(s,ue))}d++}},$e=function(e){var t,n,r=f(this,We),i=arguments.length>1?arguments[1]:void 0,s=_(e),a=A(r,{type:"URL"});if(void 0!==i)try{t=S(i)}catch(e){if(n=He(t={},_(i)))throw k(n)}if(n=He(a,s,null,t))throw k(n);var c=a.searchParams=new O,u=I(c);u.updateSearchParams(a.query),u.updateURL=function(){a.query=_(c)||null},o||(r.href=l(ze,r),r.origin=l(Ve,r),r.protocol=l(Ke,r),r.username=l(Ye,r),r.password=l(Qe,r),r.host=l(Xe,r),r.hostname=l(Je,r),r.port=l(Ze,r),r.pathname=l(et,r),r.search=l(tt,r),r.searchParams=l(nt,r),r.hash=l(rt,r))},We=$e.prototype,ze=function(){var e=S(this),t=e.scheme,n=e.username,r=e.password,i=e.host,o=e.port,s=e.path,a=e.query,c=e.fragment,l=t+":";return null!==i?(l+="//",me(e)&&(l+=n+(r?":"+r:"")+"@"),l+=ce(i),null!==o&&(l+=":"+o)):"file"==t&&(l+="//"),l+=e.cannotBeABaseURL?s[0]:s.length?"/"+N(s,"/"):"",null!==a&&(l+="?"+a),null!==c&&(l+="#"+c),l},Ve=function(){var e=S(this),t=e.scheme,n=e.port;if("blob"==t)try{return new $e(t.path[0]).origin}catch(e){return"null"}return"file"!=t&&ge(e)?t+"://"+ce(e.host)+(null!==n?":"+n:""):"null"},Ke=function(){return S(this).scheme+":"},Ye=function(){return S(this).username},Qe=function(){return S(this).password},Xe=function(){var e=S(this),t=e.host,n=e.port;return null===t?"":null===n?ce(t):ce(t)+":"+n},Je=function(){var e=S(this).host;return null===e?"":ce(e)},Ze=function(){var e=S(this).port;return null===e?"":_(e)},et=function(){var e=S(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+N(t,"/"):""},tt=function(){var e=S(this).query;return e?"?"+e:""},nt=function(){return S(this).searchParams},rt=function(){var e=S(this).fragment;return e?"#"+e:""},it=function(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}};if(o&&d(We,{href:it(ze,(function(e){var t=S(this),n=_(e),r=He(t,n);if(r)throw k(r);I(t.searchParams).updateSearchParams(t.query)})),origin:it(Ve),protocol:it(Ke,(function(e){var t=S(this);He(t,_(e)+":",Te)})),username:it(Ye,(function(e){var t=S(this),n=m(_(e));if(!ye(t)){t.username="";for(var r=0;r<n.length;r++)t.username+=fe(n[r],he)}})),password:it(Qe,(function(e){var t=S(this),n=m(_(e));if(!ye(t)){t.password="";for(var r=0;r<n.length;r++)t.password+=fe(n[r],he)}})),host:it(Xe,(function(e){var t=S(this);t.cannotBeABaseURL||He(t,_(e),Re)})),hostname:it(Je,(function(e){var t=S(this);t.cannotBeABaseURL||He(t,_(e),Le)})),port:it(Ze,(function(e){var t=S(this);ye(t)||(""==(e=_(e))?t.port=null:He(t,e,De))})),pathname:it(et,(function(e){var t=S(this);t.cannotBeABaseURL||(t.path=[],He(t,_(e),Fe))})),search:it(tt,(function(e){var t=S(this);""==(e=_(e))?t.query=null:("?"==L(e,0)&&(e=q(e,1)),t.query="",He(t,e,Ge)),I(t.searchParams).updateSearchParams(t.query)})),searchParams:it(nt),hash:it(rt,(function(e){var t=S(this);""!=(e=_(e))?("#"==L(e,0)&&(e=q(e,1)),t.fragment="",He(t,e,qe)):t.fragment=null}))}),h(We,"toJSON",(function(){return l(ze,this)}),{enumerable:!0}),h(We,"toString",(function(){return l(ze,this)}),{enumerable:!0}),C){var ot=C.createObjectURL,st=C.revokeObjectURL;ot&&h($e,"createObjectURL",c(ot,C)),st&&h($e,"revokeObjectURL",c(st,C))}w($e,"URL"),i({global:!0,forced:!s,sham:!o},{URL:$e})},function(e,t,n){var r=n(9),i=n(33),o=n(35),s=i("iterator");e.exports=!r((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,n="";return e.pathname="c%20d",t.forEach((function(e,r){t.delete("b"),n+=r+e})),o&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[s]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://\u0442\u0435\u0441\u0442").host||"#%D0%B1"!==new URL("http://a#\u0431").hash||"a1c3"!==n||"x"!==new URL("http://x",void 0).host}))},function(e,t,n){"use strict";var r=n(6),i=n(15),o=2147483647,s=/[^\0-\u007E]/,a=/[.\u3002\uFF0E\uFF61]/g,c="Overflow: input needs wider integers to process",l=r.RangeError,u=i(a.exec),d=Math.floor,h=String.fromCharCode,f=i("".charCodeAt),p=i([].join),g=i([].push),m=i("".replace),y=i("".split),v=i("".toLowerCase),b=function(e){return e+22+75*(e<26)},_=function(e,t,n){var r=0;for(e=n?d(e/700):e>>1,e+=d(e/t);e>455;r+=36)e=d(e/35);return d(r+36*e/(e+38))},w=function(e){var t=[];e=function(e){for(var t=[],n=0,r=e.length;n<r;){var i=f(e,n++);if(i>=55296&&i<=56319&&n<r){var o=f(e,n++);56320==(64512&o)?g(t,((1023&i)<<10)+(1023&o)+65536):(g(t,i),n--)}else g(t,i)}return t}(e);var n,r,i=e.length,s=128,a=0,u=72;for(n=0;n<e.length;n++)(r=e[n])<128&&g(t,h(r));var m=t.length,y=m;for(m&&g(t,"-");y<i;){var v=o;for(n=0;n<e.length;n++)(r=e[n])>=s&&r<v&&(v=r);var w=y+1;if(v-s>d((o-a)/w))throw l(c);for(a+=(v-s)*w,s=v,n=0;n<e.length;n++){if((r=e[n])<s&&++a>o)throw l(c);if(r==s){for(var T=a,E=36;;E+=36){var A=E<=u?1:E>=u+26?26:E-u;if(T<A)break;var S=T-A,O=36-A;g(t,h(b(A+S%O))),T=d(S/O)}g(t,h(b(T))),u=_(a,w,y==m),a=0,++y}}++a,++s}return p(t,"")};e.exports=function(e){var t,n,r=[],i=y(m(v(e),a,"."),".");for(t=0;t<i.length;t++)n=i[t],g(r,u(s,n)?"xn--"+w(n):n);return p(r,".")}},function(e,t,n){"use strict";n(128);var r=n(5),i=n(6),o=n(23),s=n(10),a=n(15),c=n(155),l=n(46),u=n(133),d=n(94),h=n(90),f=n(48),p=n(135),g=n(21),m=n(38),y=n(100),v=n(69),b=n(45),_=n(20),w=n(68),T=n(82),E=n(12),A=n(106),S=n(107),O=n(33),I=n(158),C=O("iterator"),k="URLSearchParams",P=k+"Iterator",x=f.set,R=f.getterFor(k),L=f.getterFor(P),D=o("fetch"),N=o("Request"),j=o("Headers"),M=N&&N.prototype,F=j&&j.prototype,U=i.RegExp,B=i.TypeError,G=i.decodeURIComponent,q=i.encodeURIComponent,H=a("".charAt),$=a([].join),W=a([].push),z=a("".replace),V=a([].shift),K=a([].splice),Y=a("".split),Q=a("".slice),X=/\+/g,J=Array(4),Z=function(e){return J[e-1]||(J[e-1]=U("((?:%[\\da-f]{2}){"+e+"})","gi"))},ee=function(e){try{return G(e)}catch(t){return e}},te=function(e){var t=z(e,X," "),n=4;try{return G(t)}catch(e){for(;n;)t=z(t,Z(n--),ee);return t}},ne=/[!'()~]|%20/g,re={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},ie=function(e){return re[e]},oe=function(e){return z(q(e),ne,ie)},se=function(e,t){if(t)for(var n,r,i=Y(t,"&"),o=0;o<i.length;)(n=i[o++]).length&&(r=Y(n,"="),W(e,{key:te(V(r)),value:te($(r,"="))}))},ae=function(e){this.entries.length=0,se(this.entries,e)},ce=function(e,t){if(e<t)throw B("Not enough arguments")},le=h((function(e,t){x(this,{type:P,iterator:A(R(e).entries),kind:t})}),"Iterator",(function(){var e=L(this),t=e.kind,n=e.iterator.next(),r=n.value;return n.done||(n.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),n})),ue=function(){p(this,de);var e,t,n,r,i,o,a,c,l,u=arguments.length>0?arguments[0]:void 0,d=[];if(x(this,{type:k,entries:d,updateURL:function(){},updateSearchParams:ae}),void 0!==u)if(_(u))if(e=S(u))for(n=(t=A(u,e)).next;!(r=s(n,t)).done;){if(o=(i=A(b(r.value))).next,(a=s(o,i)).done||(c=s(o,i)).done||!s(o,i).done)throw B("Expected sequence with length 2");W(d,{key:w(a.value),value:w(c.value)})}else for(l in u)m(u,l)&&W(d,{key:l,value:w(u[l])});else se(d,"string"==typeof u?"?"===H(u,0)?Q(u,1):u:w(u))},de=ue.prototype;if(u(de,{append:function(e,t){ce(arguments.length,2);var n=R(this);W(n.entries,{key:w(e),value:w(t)}),n.updateURL()},delete:function(e){ce(arguments.length,1);for(var t=R(this),n=t.entries,r=w(e),i=0;i<n.length;)n[i].key===r?K(n,i,1):i++;t.updateURL()},get:function(e){ce(arguments.length,1);for(var t=R(this).entries,n=w(e),r=0;r<t.length;r++)if(t[r].key===n)return t[r].value;return null},getAll:function(e){ce(arguments.length,1);for(var t=R(this).entries,n=w(e),r=[],i=0;i<t.length;i++)t[i].key===n&&W(r,t[i].value);return r},has:function(e){ce(arguments.length,1);for(var t=R(this).entries,n=w(e),r=0;r<t.length;)if(t[r++].key===n)return!0;return!1},set:function(e,t){ce(arguments.length,1);for(var n,r=R(this),i=r.entries,o=!1,s=w(e),a=w(t),c=0;c<i.length;c++)(n=i[c]).key===s&&(o?K(i,c--,1):(o=!0,n.value=a));o||W(i,{key:s,value:a}),r.updateURL()},sort:function(){var e=R(this);I(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,n=R(this).entries,r=y(e,arguments.length>1?arguments[1]:void 0),i=0;i<n.length;)r((t=n[i++]).value,t.key,this)},keys:function(){return new le(this,"keys")},values:function(){return new le(this,"values")},entries:function(){return new le(this,"entries")}},{enumerable:!0}),l(de,C,de.entries,{name:"entries"}),l(de,"toString",(function(){for(var e,t=R(this).entries,n=[],r=0;r<t.length;)e=t[r++],W(n,oe(e.key)+"="+oe(e.value));return $(n,"&")}),{enumerable:!0}),d(ue,k),r({global:!0,forced:!c},{URLSearchParams:ue}),!c&&g(j)){var he=a(F.has),fe=a(F.set),pe=function(e){if(_(e)){var t,n=e.body;if(v(n)===k)return t=e.headers?new j(e.headers):new j,he(t,"content-type")||fe(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),T(e,{body:E(0,w(n)),headers:E(0,t)})}return e};if(g(D)&&r({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return D(e,arguments.length>1?pe(arguments[1]):{})}}),g(N)){var ge=function(e){return p(this,M),new N(e,arguments.length>1?pe(arguments[1]):{})};M.constructor=ge,ge.prototype=M,r({global:!0,forced:!0},{Request:ge})}}e.exports={URLSearchParams:ue,getState:R}},function(e,t,n){var r=n(123),i=Math.floor,o=function(e,t){var n=e.length,c=i(n/2);return n<8?s(e,t):a(e,o(r(e,0,c),t),o(r(e,c),t),t)},s=function(e,t){for(var n,r,i=e.length,o=1;o<i;){for(r=o,n=e[o];r&&t(e[r-1],n)>0;)e[r]=e[--r];r!==o++&&(e[r]=n)}return e},a=function(e,t,n,r){for(var i=t.length,o=n.length,s=0,a=0;s<i||a<o;)e[s+a]=s<i&&a<o?r(t[s],n[a])<=0?t[s++]:n[a++]:s<i?t[s++]:n[a++];return e};e.exports=o},function(e,t,n){"use strict";var r=n(5),i=n(10);r({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return i(URL.prototype.toString,this)}})},function(e,t,n){!function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol:function(e){return"Symbol("+e+")"};function n(){}var r=Number.isNaN||function(e){return e!=e},i=n;function o(e){return"object"==typeof e&&null!==e||"function"==typeof e}function s(e){return e.slice()}function a(e,t,n,r,i){new Uint8Array(e).set(new Uint8Array(n,r,i),t)}function c(e){return!1!==l(e)&&e!==1/0}function l(e){return!("number"!=typeof e||r(e)||e<0)}function u(e,t,n){if("function"!=typeof e)throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,n)}function d(e,t,n,r){var i=e[t];if(void 0!==i){if("function"!=typeof i)throw new TypeError(i+" is not a method");switch(n){case 0:return function(){return f(i,e,r)};case 1:return function(t){var n=[t].concat(r);return f(i,e,n)}}}return function(){return E(void 0)}}function h(e,t,n){var r=e[t];if(void 0!==r)return u(r,e,n)}function f(e,t,n){try{return E(u(e,t,n))}catch(e){return A(e)}}function p(e){return e}function g(e){return!1}function m(e){if(e=Number(e),r(e)||e<0)throw new RangeError("highWaterMark property of a queuing strategy must be non-negative and non-NaN");return e}function y(e){if(void 0===e)return function(){return 1};if("function"!=typeof e)throw new TypeError("size property of a queuing strategy must be a function");return function(t){return e(t)}}var v=Promise,b=Promise.prototype.then,_=Promise.resolve.bind(v),w=Promise.reject.bind(v);function T(e){return new v(e)}function E(e){return _(e)}function A(e){return w(e)}function S(e,t,n){return b.call(e,t,n)}function O(e,t,n){S(S(e,t,n),void 0,i)}function I(e,t){O(e,t)}function C(e,t){O(e,void 0,t)}function k(e,t,n){return S(e,t,n)}function P(e){S(e,void 0,i)}var x=16384,R=function(){function e(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}return Object.defineProperty(e.prototype,"length",{get:function(){return this._size},enumerable:!0,configurable:!0}),e.prototype.push=function(e){var t=this._back,n=t;t._elements.length===x-1&&(n={_elements:[],_next:void 0}),t._elements.push(e),n!==t&&(this._back=n,t._next=n),++this._size},e.prototype.shift=function(){var e=this._front,t=e,n=this._cursor,r=n+1,i=e._elements,o=i[n];return r===x&&(t=e._next,r=0),--this._size,this._cursor=r,e!==t&&(this._front=t),i[n]=void 0,o},e.prototype.forEach=function(e){for(var t=this._cursor,n=this._front,r=n._elements;!(t===r.length&&void 0===n._next||t===r.length&&(t=0,0===(r=(n=n._next)._elements).length));)e(r[t]),++t},e.prototype.peek=function(){var e=this._front,t=this._cursor;return e._elements[t]},e}();function L(e,t,n){var r=null;!0===n&&(r=Object.prototype);var i=Object.create(r);return i.value=e,i.done=t,i}function D(e,t){e._forAuthorCode=!0,e._ownerReadableStream=t,t._reader=e,"readable"===t._state?F(e):"closed"===t._state?B(e):U(e,t._storedError)}function N(e,t){return Mn(e._ownerReadableStream,t)}function j(e){"readable"===e._ownerReadableStream._state?G(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):q(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function M(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function F(e){e._closedPromise=T((function(t,n){e._closedPromise_resolve=t,e._closedPromise_reject=n}))}function U(e,t){F(e),G(e,t)}function B(e){F(e),H(e)}function G(e,t){P(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}function q(e,t){U(e,t)}function H(e){e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}var $=t("[[CancelSteps]]"),W=t("[[PullSteps]]");function z(e,t){void 0===t&&(t=!1);var n=new Z(e);return n._forAuthorCode=t,n}function V(e){return T((function(t,n){var r={_resolve:t,_reject:n};e._reader._readRequests.push(r)}))}function K(e,t,n){var r=e._reader;r._readRequests.shift()._resolve(L(t,n,r._forAuthorCode))}function Y(e){return e._reader._readRequests.length}function Q(e){var t=e._reader;return void 0!==t&&!!ee(t)}var X,J,Z=function(){function e(e){if(!1===Nn(e))throw new TypeError("ReadableStreamDefaultReader can only be constructed with a ReadableStream instance");if(!0===jn(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");D(this,e),this._readRequests=new R}return Object.defineProperty(e.prototype,"closed",{get:function(){return ee(this)?this._closedPromise:A(ne("closed"))},enumerable:!0,configurable:!0}),e.prototype.cancel=function(e){return ee(this)?void 0===this._ownerReadableStream?A(M("cancel")):N(this,e):A(ne("cancel"))},e.prototype.read=function(){return ee(this)?void 0===this._ownerReadableStream?A(M("read from")):te(this):A(ne("read"))},e.prototype.releaseLock=function(){if(!ee(this))throw ne("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");j(this)}},e}();function ee(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readRequests")}function te(e){var t=e._ownerReadableStream;return t._disturbed=!0,"closed"===t._state?E(L(void 0,!0,e._forAuthorCode)):"errored"===t._state?A(t._storedError):t._readableStreamController[W]()}function ne(e){return new TypeError("ReadableStreamDefaultReader.prototype."+e+" can only be used on a ReadableStreamDefaultReader")}"symbol"==typeof t.asyncIterator&&((X={})[t.asyncIterator]=function(){return this},J=X,Object.defineProperty(J,t.asyncIterator,{enumerable:!1}));var re={next:function(){if(!1===oe(this))return A(se("next"));var e=this._asyncIteratorReader;return void 0===e._ownerReadableStream?A(M("iterate")):k(te(e),(function(t){var n=t.done;return n&&j(e),L(t.value,n,!0)}))},return:function(e){if(!1===oe(this))return A(se("next"));var t=this._asyncIteratorReader;if(void 0===t._ownerReadableStream)return A(M("finish iterating"));if(t._readRequests.length>0)return A(new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled"));if(!1===this._preventCancel){var n=N(t,e);return j(t),k(n,(function(){return L(e,!0,!0)}))}return j(t),E(L(e,!0,!0))}};function ie(e,t){void 0===t&&(t=!1);var n=z(e),r=Object.create(re);return r._asyncIteratorReader=n,r._preventCancel=Boolean(t),r}function oe(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorReader")}function se(e){return new TypeError("ReadableStreamAsyncIterator."+e+" can only be used on a ReadableSteamAsyncIterator")}function ae(e){var t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function ce(e,t,n){if(!c(n=Number(n)))throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:n}),e._queueTotalSize+=n}function le(e){return e._queue.peek().value}function ue(e){e._queue=new R,e._queueTotalSize=0}void 0!==J&&Object.setPrototypeOf(re,J),Object.defineProperty(re,"next",{enumerable:!1}),Object.defineProperty(re,"return",{enumerable:!1});var de=t("[[AbortSteps]]"),he=t("[[ErrorSteps]]"),fe=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={}),me(this);var n=t.size,r=t.highWaterMark;if(void 0!==e.type)throw new RangeError("Invalid type is specified");var i=y(n);void 0===r&&(r=1),Ke(this,e,r=m(r),i)}return Object.defineProperty(e.prototype,"locked",{get:function(){if(!1===ye(this))throw st("locked");return ve(this)},enumerable:!0,configurable:!0}),e.prototype.abort=function(e){return!1===ye(this)?A(st("abort")):!0===ve(this)?A(new TypeError("Cannot abort a stream that already has a writer")):be(this,e)},e.prototype.close=function(){return!1===ye(this)?A(st("close")):!0===ve(this)?A(new TypeError("Cannot close a stream that already has a writer")):!0===ke(this)?A(new TypeError("Cannot close an already-closing stream")):_e(this)},e.prototype.getWriter=function(){if(!1===ye(this))throw st("getWriter");return pe(this)},e}();function pe(e){return new Ne(e)}function ge(e,t,n,r,i,o){void 0===i&&(i=1),void 0===o&&(o=function(){return 1});var s=Object.create(fe.prototype);return me(s),Ve(s,Object.create(We.prototype),e,t,n,r,i,o),s}function me(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new R,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function ye(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")}function ve(e){return void 0!==e._writer}function be(e,t){var n=e._state;if("closed"===n||"errored"===n)return E(void 0);if(void 0!==e._pendingAbortRequest)return e._pendingAbortRequest._promise;var r=!1;"erroring"===n&&(r=!0,t=void 0);var i=T((function(n,i){e._pendingAbortRequest={_promise:void 0,_resolve:n,_reject:i,_reason:t,_wasAlreadyErroring:r}}));return e._pendingAbortRequest._promise=i,!1===r&&Ee(e,t),i}function _e(e){var t=e._state;if("closed"===t||"errored"===t)return A(new TypeError("The stream (in "+t+" state) is not in the writable state and cannot be closed"));var n=T((function(t,n){var r={_resolve:t,_reject:n};e._closeRequest=r})),r=e._writer;return void 0!==r&&!0===e._backpressure&&"writable"===t&&wt(r),Qe(e._writableStreamController),n}function we(e){return T((function(t,n){var r={_resolve:t,_reject:n};e._writeRequests.push(r)}))}function Te(e,t){"writable"!==e._state?Ae(e):Ee(e,t)}function Ee(e,t){var n=e._writableStreamController;e._state="erroring",e._storedError=t;var r=e._writer;void 0!==r&&Ge(r,t),!1===Pe(e)&&!0===n._started&&Ae(e)}function Ae(e){e._state="errored",e._writableStreamController[he]();var t=e._storedError;if(e._writeRequests.forEach((function(e){e._reject(t)})),e._writeRequests=new R,void 0!==e._pendingAbortRequest){var n=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,!0===n._wasAlreadyErroring)return n._reject(t),void Le(e);O(e._writableStreamController[de](n._reason),(function(){n._resolve(),Le(e)}),(function(t){n._reject(t),Le(e)}))}else Le(e)}function Se(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function Oe(e,t){e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,Te(e,t)}function Ie(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,"erroring"===e._state&&(e._storedError=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";var t=e._writer;void 0!==t&&pt(t)}function Ce(e,t){e._inFlightCloseRequest._reject(t),e._inFlightCloseRequest=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._reject(t),e._pendingAbortRequest=void 0),Te(e,t)}function ke(e){return void 0!==e._closeRequest||void 0!==e._inFlightCloseRequest}function Pe(e){return void 0!==e._inFlightWriteRequest||void 0!==e._inFlightCloseRequest}function xe(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function Re(e){e._inFlightWriteRequest=e._writeRequests.shift()}function Le(e){void 0!==e._closeRequest&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);var t=e._writer;void 0!==t&&ht(t,e._storedError)}function De(e,t){var n=e._writer;void 0!==n&&t!==e._backpressure&&(!0===t?bt(n):wt(n)),e._backpressure=t}var Ne=function(){function e(e){if(!1===ye(e))throw new TypeError("WritableStreamDefaultWriter can only be constructed with a WritableStream instance");if(!0===ve(e))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=e,e._writer=this;var t=e._state;if("writable"===t)!1===ke(e)&&!0===e._backpressure?gt(this):yt(this),lt(this);else if("erroring"===t)mt(this,e._storedError),lt(this);else if("closed"===t)yt(this),dt(this);else{var n=e._storedError;mt(this,n),ut(this,n)}}return Object.defineProperty(e.prototype,"closed",{get:function(){return!1===je(this)?A(at("closed")):this._closedPromise},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"desiredSize",{get:function(){if(!1===je(this))throw at("desiredSize");if(void 0===this._ownerWritableStream)throw ct("desiredSize");return qe(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ready",{get:function(){return!1===je(this)?A(at("ready")):this._readyPromise},enumerable:!0,configurable:!0}),e.prototype.abort=function(e){return!1===je(this)?A(at("abort")):void 0===this._ownerWritableStream?A(ct("abort")):Me(this,e)},e.prototype.close=function(){if(!1===je(this))return A(at("close"));var e=this._ownerWritableStream;return void 0===e?A(ct("close")):!0===ke(e)?A(new TypeError("Cannot close an already-closing stream")):Fe(this)},e.prototype.releaseLock=function(){if(!1===je(this))throw at("releaseLock");void 0!==this._ownerWritableStream&&He(this)},e.prototype.write=function(e){return!1===je(this)?A(at("write")):void 0===this._ownerWritableStream?A(ct("write to")):$e(this,e)},e}();function je(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")}function Me(e,t){return be(e._ownerWritableStream,t)}function Fe(e){return _e(e._ownerWritableStream)}function Ue(e){var t=e._ownerWritableStream,n=t._state;return!0===ke(t)||"closed"===n?E(void 0):"errored"===n?A(t._storedError):Fe(e)}function Be(e,t){"pending"===e._closedPromiseState?ht(e,t):ft(e,t)}function Ge(e,t){"pending"===e._readyPromiseState?vt(e,t):_t(e,t)}function qe(e){var t=e._ownerWritableStream,n=t._state;return"errored"===n||"erroring"===n?null:"closed"===n?0:Je(t._writableStreamController)}function He(e){var t=e._ownerWritableStream,n=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");Ge(e,n),Be(e,n),t._writer=void 0,e._ownerWritableStream=void 0}function $e(e,t){var n=e._ownerWritableStream,r=n._writableStreamController,i=Xe(r,t);if(n!==e._ownerWritableStream)return A(ct("write to"));var o=n._state;if("errored"===o)return A(n._storedError);if(!0===ke(n)||"closed"===o)return A(new TypeError("The stream is closing or closed and cannot be written to"));if("erroring"===o)return A(n._storedError);var s=we(n);return Ze(r,t,i),s}var We=function(){function e(){throw new TypeError("WritableStreamDefaultController cannot be constructed explicitly")}return e.prototype.error=function(e){if(!1===ze(this))throw new TypeError("WritableStreamDefaultController.prototype.error can only be used on a WritableStreamDefaultController");"writable"===this._controlledWritableStream._state&&ot(this,e)},e.prototype[de]=function(e){var t=this._abortAlgorithm(e);return Ye(this),t},e.prototype[he]=function(){ue(this)},e}();function ze(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")}function Ve(e,t,n,r,i,o,s,a){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,ue(t),t._started=!1,t._strategySizeAlgorithm=a,t._strategyHWM=s,t._writeAlgorithm=r,t._closeAlgorithm=i,t._abortAlgorithm=o;var c=it(t);De(e,c),O(E(n()),(function(){t._started=!0,et(t)}),(function(n){t._started=!0,Te(e,n)}))}function Ke(e,t,n,r){var i=Object.create(We.prototype);function o(){return h(t,"start",[i])}var s=d(t,"write",1,[i]),a=d(t,"close",0,[]),c=d(t,"abort",1,[]);Ve(e,i,o,s,a,c,n,r)}function Ye(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Qe(e){ce(e,"close",0),et(e)}function Xe(e,t){try{return e._strategySizeAlgorithm(t)}catch(t){return tt(e,t),1}}function Je(e){return e._strategyHWM-e._queueTotalSize}function Ze(e,t,n){var r={chunk:t};try{ce(e,r,n)}catch(t){return void tt(e,t)}var i=e._controlledWritableStream;!1===ke(i)&&"writable"===i._state&&De(i,it(e)),et(e)}function et(e){var t=e._controlledWritableStream;if(!1!==e._started&&void 0===t._inFlightWriteRequest)if("erroring"!==t._state){if(0!==e._queue.length){var n=le(e);"close"===n?nt(e):rt(e,n.chunk)}}else Ae(t)}function tt(e,t){"writable"===e._controlledWritableStream._state&&ot(e,t)}function nt(e){var t=e._controlledWritableStream;xe(t),ae(e);var n=e._closeAlgorithm();Ye(e),O(n,(function(){Ie(t)}),(function(e){Ce(t,e)}))}function rt(e,t){var n=e._controlledWritableStream;Re(n),O(e._writeAlgorithm(t),(function(){Se(n);var t=n._state;if(ae(e),!1===ke(n)&&"writable"===t){var r=it(e);De(n,r)}et(e)}),(function(t){"writable"===n._state&&Ye(e),Oe(n,t)}))}function it(e){return Je(e)<=0}function ot(e,t){var n=e._controlledWritableStream;Ye(e),Ee(n,t)}function st(e){return new TypeError("WritableStream.prototype."+e+" can only be used on a WritableStream")}function at(e){return new TypeError("WritableStreamDefaultWriter.prototype."+e+" can only be used on a WritableStreamDefaultWriter")}function ct(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function lt(e){e._closedPromise=T((function(t,n){e._closedPromise_resolve=t,e._closedPromise_reject=n,e._closedPromiseState="pending"}))}function ut(e,t){lt(e),ht(e,t)}function dt(e){lt(e),pt(e)}function ht(e,t){P(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected"}function ft(e,t){ut(e,t)}function pt(e){e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved"}function gt(e){e._readyPromise=T((function(t,n){e._readyPromise_resolve=t,e._readyPromise_reject=n})),e._readyPromiseState="pending"}function mt(e,t){gt(e),vt(e,t)}function yt(e){gt(e),wt(e)}function vt(e,t){P(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected"}function bt(e){gt(e)}function _t(e,t){mt(e,t)}function wt(e){e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled"}function Tt(e){if("object"!=typeof e||null===e)return!1;try{return"boolean"==typeof e.aborted}catch(e){return!1}}var Et="undefined"!=typeof DOMException?DOMException:void 0;function At(e){if("function"!=typeof e&&"object"!=typeof e)return!1;try{return new e,!0}catch(e){return!1}}function St(){var e=function(e,t){this.message=e||"",this.name=t||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}var Ot=At(Et)?Et:St();function It(e,t,r,i,o,s){var a=z(e),c=pe(t);e._disturbed=!0;var l=!1,u=E(void 0);return T((function(d,h){var f;if(void 0!==s){if(f=function(){var n=new Ot("Aborted","AbortError"),r=[];!1===i&&r.push((function(){return"writable"===t._state?be(t,n):E(void 0)})),!1===o&&r.push((function(){return"readable"===e._state?Mn(e,n):E(void 0)})),_((function(){return Promise.all(r.map((function(e){return e()})))}),!0,n)},!0===s.aborted)return void f();s.addEventListener("abort",f)}function p(){return T((function(e,t){function n(r){r?e():S(g(),n,t)}n(!1)}))}function g(){return!0===l?E(!0):S(c._readyPromise,(function(){return S(te(a),(function(e){return!0===e.done||(u=S($e(c,e.value),void 0,n),!1)}))}))}if(v(e,a._closedPromise,(function(e){!1===i?_((function(){return be(t,e)}),!0,e):w(!0,e)})),v(t,c._closedPromise,(function(t){!1===o?_((function(){return Mn(e,t)}),!0,t):w(!0,t)})),b(e,a._closedPromise,(function(){!1===r?_((function(){return Ue(c)})):w()})),!0===ke(t)||"closed"===t._state){var m=new TypeError("the destination writable stream closed before all data could be piped to it");!1===o?_((function(){return Mn(e,m)}),!0,m):w(!0,m)}function y(){var e=u;return S(u,(function(){return e!==u?y():void 0}))}function v(e,t,n){"errored"===e._state?n(e._storedError):C(t,n)}function b(e,t,n){"closed"===e._state?n():I(t,n)}function _(e,n,r){function i(){O(e(),(function(){return A(n,r)}),(function(e){return A(!0,e)}))}!0!==l&&(l=!0,"writable"===t._state&&!1===ke(t)?I(y(),i):i())}function w(e,n){!0!==l&&(l=!0,"writable"===t._state&&!1===ke(t)?I(y(),(function(){return A(e,n)})):A(e,n))}function A(e,t){He(c),j(a),void 0!==s&&s.removeEventListener("abort",f),e?h(t):d(void 0)}P(p())}))}var Ct=function(){function e(){throw new TypeError}return Object.defineProperty(e.prototype,"desiredSize",{get:function(){if(!1===kt(this))throw Gt("desiredSize");return jt(this)},enumerable:!0,configurable:!0}),e.prototype.close=function(){if(!1===kt(this))throw Gt("close");if(!1===Ft(this))throw new TypeError("The stream is not in a state that permits close");Lt(this)},e.prototype.enqueue=function(e){if(!1===kt(this))throw Gt("enqueue");if(!1===Ft(this))throw new TypeError("The stream is not in a state that permits enqueue");return Dt(this,e)},e.prototype.error=function(e){if(!1===kt(this))throw Gt("error");Nt(this,e)},e.prototype[$]=function(e){ue(this);var t=this._cancelAlgorithm(e);return Rt(this),t},e.prototype[W]=function(){var e=this._controlledReadableStream;if(this._queue.length>0){var t=ae(this);return!0===this._closeRequested&&0===this._queue.length?(Rt(this),Fn(e)):Pt(this),E(L(t,!1,e._reader._forAuthorCode))}var n=V(e);return Pt(this),n},e}();function kt(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")}function Pt(e){!1!==xt(e)&&(!0!==e._pulling?(e._pulling=!0,O(e._pullAlgorithm(),(function(){e._pulling=!1,!0===e._pullAgain&&(e._pullAgain=!1,Pt(e))}),(function(t){Nt(e,t)}))):e._pullAgain=!0)}function xt(e){var t=e._controlledReadableStream;return!1!==Ft(e)&&!1!==e._started&&(!0===jn(t)&&Y(t)>0||jt(e)>0)}function Rt(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Lt(e){var t=e._controlledReadableStream;e._closeRequested=!0,0===e._queue.length&&(Rt(e),Fn(t))}function Dt(e,t){var n=e._controlledReadableStream;if(!0===jn(n)&&Y(n)>0)K(n,t,!1);else{var r=void 0;try{r=e._strategySizeAlgorithm(t)}catch(t){throw Nt(e,t),t}try{ce(e,t,r)}catch(t){throw Nt(e,t),t}}Pt(e)}function Nt(e,t){var n=e._controlledReadableStream;"readable"===n._state&&(ue(e),Rt(e),Un(n,t))}function jt(e){var t=e._controlledReadableStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function Mt(e){return!0!==xt(e)}function Ft(e){var t=e._controlledReadableStream._state;return!1===e._closeRequested&&"readable"===t}function Ut(e,t,n,r,i,o,s){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,ue(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=s,t._strategyHWM=o,t._pullAlgorithm=r,t._cancelAlgorithm=i,e._readableStreamController=t,O(E(n()),(function(){t._started=!0,Pt(t)}),(function(e){Nt(t,e)}))}function Bt(e,t,n,r){var i=Object.create(Ct.prototype);function o(){return h(t,"start",[i])}var s=d(t,"pull",0,[i]),a=d(t,"cancel",1,[]);Ut(e,i,o,s,a,n,r)}function Gt(e){return new TypeError("ReadableStreamDefaultController.prototype."+e+" can only be used on a ReadableStreamDefaultController")}function qt(e,t){var n,r,i,o,a,c=z(e),l=!1,u=!1,d=!1,h=T((function(e){a=e}));function f(){return!0===l||(l=!0,P(k(te(c),(function(e){if(l=!1,!0===e.done)return!1===u&&Lt(i._readableStreamController),void(!1===d&&Lt(o._readableStreamController));var t=e.value,n=t,r=t;!1===u&&Dt(i._readableStreamController,n),!1===d&&Dt(o._readableStreamController,r)})))),E(void 0)}function p(t){if(u=!0,n=t,!0===d){var i=s([n,r]),o=Mn(e,i);a(o)}return h}function g(t){if(d=!0,r=t,!0===u){var i=s([n,r]),o=Mn(e,i);a(o)}return h}function m(){}return i=Ln(m,f,p),o=Ln(m,f,g),C(c._closedPromise,(function(e){Nt(i._readableStreamController,e),Nt(o._readableStreamController,e)})),[i,o]}var Ht=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},$t=function(){function e(){throw new TypeError("ReadableStreamBYOBRequest cannot be used directly")}return Object.defineProperty(e.prototype,"view",{get:function(){if(!1===Vt(this))throw wn("view");return this._view},enumerable:!0,configurable:!0}),e.prototype.respond=function(e){if(!1===Vt(this))throw wn("respond");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");g(this._view.buffer),mn(this._associatedReadableByteStreamController,e)},e.prototype.respondWithNewView=function(e){if(!1===Vt(this))throw wn("respond");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");if(!ArrayBuffer.isView(e))throw new TypeError("You can only respond with array buffer views");g(e.buffer),yn(this._associatedReadableByteStreamController,e)},e}(),Wt=function(){function e(){throw new TypeError("ReadableByteStreamController constructor cannot be used directly")}return Object.defineProperty(e.prototype,"byobRequest",{get:function(){if(!1===zt(this))throw Tn("byobRequest");if(void 0===this._byobRequest&&this._pendingPullIntos.length>0){var e=this._pendingPullIntos.peek(),t=new Uint8Array(e.buffer,e.byteOffset+e.bytesFilled,e.byteLength-e.bytesFilled),n=Object.create($t.prototype);_n(n,this,t),this._byobRequest=n}return this._byobRequest},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"desiredSize",{get:function(){if(!1===zt(this))throw Tn("desiredSize");return gn(this)},enumerable:!0,configurable:!0}),e.prototype.close=function(){if(!1===zt(this))throw Tn("close");if(!0===this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");var e=this._controlledReadableByteStream._state;if("readable"!==e)throw new TypeError("The stream (in "+e+" state) is not in the readable state and cannot be closed");hn(this)},e.prototype.enqueue=function(e){if(!1===zt(this))throw Tn("enqueue");if(!0===this._closeRequested)throw new TypeError("stream is closed or draining");var t=this._controlledReadableByteStream._state;if("readable"!==t)throw new TypeError("The stream (in "+t+" state) is not in the readable state and cannot be enqueued to");if(!ArrayBuffer.isView(e))throw new TypeError("You can only enqueue array buffer views when using a ReadableByteStreamController");g(e.buffer),fn(this,e)},e.prototype.error=function(e){if(!1===zt(this))throw Tn("error");pn(this,e)},e.prototype[$]=function(e){this._pendingPullIntos.length>0&&(this._pendingPullIntos.peek().bytesFilled=0),ue(this);var t=this._cancelAlgorithm(e);return dn(this),t},e.prototype[W]=function(){var e=this._controlledReadableByteStream;if(this._queueTotalSize>0){var t=this._queue.shift();this._queueTotalSize-=t.byteLength,tn(this);var n=void 0;try{n=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}catch(e){return A(e)}return E(L(n,!1,e._reader._forAuthorCode))}var r=this._autoAllocateChunkSize;if(void 0!==r){var i=void 0;try{i=new ArrayBuffer(r)}catch(e){return A(e)}var o={buffer:i,byteOffset:0,byteLength:r,bytesFilled:0,elementSize:1,ctor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(o)}var s=V(e);return Kt(this),s},e}();function zt(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")}function Vt(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")}function Kt(e){!1!==un(e)&&(!0!==e._pulling?(e._pulling=!0,O(e._pullAlgorithm(),(function(){e._pulling=!1,!0===e._pullAgain&&(e._pullAgain=!1,Kt(e))}),(function(t){pn(e,t)}))):e._pullAgain=!0)}function Yt(e){nn(e),e._pendingPullIntos=new R}function Qt(e,t){var n=!1;"closed"===e._state&&(n=!0);var r=Xt(t);"default"===t.readerType?K(e,r,n):Sn(e,r,n)}function Xt(e){var t=e.bytesFilled,n=e.elementSize;return new e.ctor(e.buffer,e.byteOffset,t/n)}function Jt(e,t,n,r){e._queue.push({buffer:t,byteOffset:n,byteLength:r}),e._queueTotalSize+=r}function Zt(e,t){var n=t.elementSize,r=t.bytesFilled-t.bytesFilled%n,i=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),o=t.bytesFilled+i,s=o-o%n,c=i,l=!1;s>r&&(c=s-t.bytesFilled,l=!0);for(var u=e._queue;c>0;){var d=u.peek(),h=Math.min(c,d.byteLength),f=t.byteOffset+t.bytesFilled;a(t.buffer,f,d.buffer,d.byteOffset,h),d.byteLength===h?u.shift():(d.byteOffset+=h,d.byteLength-=h),e._queueTotalSize-=h,en(e,h,t),c-=h}return l}function en(e,t,n){nn(e),n.bytesFilled+=t}function tn(e){0===e._queueTotalSize&&!0===e._closeRequested?(dn(e),Fn(e._controlledReadableByteStream)):Kt(e)}function nn(e){void 0!==e._byobRequest&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=void 0,e._byobRequest=void 0)}function rn(e){for(;e._pendingPullIntos.length>0;){if(0===e._queueTotalSize)return;var t=e._pendingPullIntos.peek();!0===Zt(e,t)&&(ln(e),Qt(e._controlledReadableByteStream,t))}}function on(e,t){var n=e._controlledReadableByteStream,r=1;t.constructor!==DataView&&(r=t.constructor.BYTES_PER_ELEMENT);var i=t.constructor,o={buffer:p(t.buffer),byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:r,ctor:i,readerType:"byob"};if(e._pendingPullIntos.length>0)return e._pendingPullIntos.push(o),An(n);if("closed"===n._state)return E(L(new i(o.buffer,o.byteOffset,0),!0,n._reader._forAuthorCode));if(e._queueTotalSize>0){if(!0===Zt(e,o)){var s=Xt(o);return tn(e),E(L(s,!1,n._reader._forAuthorCode))}if(!0===e._closeRequested){var a=new TypeError("Insufficient bytes to fill elements in the given buffer");return pn(e,a),A(a)}}e._pendingPullIntos.push(o);var c=An(n);return Kt(e),c}function sn(e,t){t.buffer=p(t.buffer);var n=e._controlledReadableByteStream;if(!0===In(n))for(;On(n)>0;)Qt(n,ln(e))}function an(e,t,n){if(n.bytesFilled+t>n.byteLength)throw new RangeError("bytesWritten out of range");if(en(e,t,n),!(n.bytesFilled<n.elementSize)){ln(e);var r=n.bytesFilled%n.elementSize;if(r>0){var i=n.byteOffset+n.bytesFilled,o=n.buffer.slice(i-r,i);Jt(e,o,0,o.byteLength)}n.buffer=p(n.buffer),n.bytesFilled-=r,Qt(e._controlledReadableByteStream,n),rn(e)}}function cn(e,t){var n=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream");sn(e,n)}else an(e,t,n);Kt(e)}function ln(e){var t=e._pendingPullIntos.shift();return nn(e),t}function un(e){var t=e._controlledReadableByteStream;return"readable"===t._state&&!0!==e._closeRequested&&!1!==e._started&&(!0===Q(t)&&Y(t)>0||!0===In(t)&&On(t)>0||gn(e)>0)}function dn(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function hn(e){var t=e._controlledReadableByteStream;if(e._queueTotalSize>0)e._closeRequested=!0;else{if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){var n=new TypeError("Insufficient bytes to fill elements in the given buffer");throw pn(e,n),n}dn(e),Fn(t)}}function fn(e,t){var n=e._controlledReadableByteStream,r=t.buffer,i=t.byteOffset,o=t.byteLength,s=p(r);!0===Q(n)?0===Y(n)?Jt(e,s,i,o):K(n,new Uint8Array(s,i,o),!1):!0===In(n)?(Jt(e,s,i,o),rn(e)):Jt(e,s,i,o),Kt(e)}function pn(e,t){var n=e._controlledReadableByteStream;"readable"===n._state&&(Yt(e),ue(e),dn(e),Un(n,t))}function gn(e){var t=e._controlledReadableByteStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function mn(e,t){if(!1===c(t=Number(t)))throw new RangeError("bytesWritten must be a finite");cn(e,t)}function yn(e,t){var n=e._pendingPullIntos.peek();if(n.byteOffset+n.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(n.byteLength!==t.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");n.buffer=t.buffer,cn(e,t.byteLength)}function vn(e,t,n,r,i,o,s){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=void 0,t._queue=t._queueTotalSize=void 0,ue(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=m(o),t._pullAlgorithm=r,t._cancelAlgorithm=i,t._autoAllocateChunkSize=s,t._pendingPullIntos=new R,e._readableStreamController=t,O(E(n()),(function(){t._started=!0,Kt(t)}),(function(e){pn(t,e)}))}function bn(e,t,n){var r=Object.create(Wt.prototype);function i(){return h(t,"start",[r])}var o=d(t,"pull",0,[r]),s=d(t,"cancel",1,[]),a=t.autoAllocateChunkSize;if(void 0!==a&&(a=Number(a),!1===Ht(a)||a<=0))throw new RangeError("autoAllocateChunkSize must be a positive integer");vn(e,r,i,o,s,n,a)}function _n(e,t,n){e._associatedReadableByteStreamController=t,e._view=n}function wn(e){return new TypeError("ReadableStreamBYOBRequest.prototype."+e+" can only be used on a ReadableStreamBYOBRequest")}function Tn(e){return new TypeError("ReadableByteStreamController.prototype."+e+" can only be used on a ReadableByteStreamController")}function En(e,t){void 0===t&&(t=!1);var n=new Cn(e);return n._forAuthorCode=t,n}function An(e){return T((function(t,n){var r={_resolve:t,_reject:n};e._reader._readIntoRequests.push(r)}))}function Sn(e,t,n){var r=e._reader;r._readIntoRequests.shift()._resolve(L(t,n,r._forAuthorCode))}function On(e){return e._reader._readIntoRequests.length}function In(e){var t=e._reader;return void 0!==t&&!!kn(t)}var Cn=function(){function e(e){if(!Nn(e))throw new TypeError("ReadableStreamBYOBReader can only be constructed with a ReadableStream instance given a byte source");if(!1===zt(e._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");if(jn(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");D(this,e),this._readIntoRequests=new R}return Object.defineProperty(e.prototype,"closed",{get:function(){return kn(this)?this._closedPromise:A(xn("closed"))},enumerable:!0,configurable:!0}),e.prototype.cancel=function(e){return kn(this)?void 0===this._ownerReadableStream?A(M("cancel")):N(this,e):A(xn("cancel"))},e.prototype.read=function(e){return kn(this)?void 0===this._ownerReadableStream?A(M("read from")):ArrayBuffer.isView(e)?(g(e.buffer),0===e.byteLength?A(new TypeError("view must have non-zero byteLength")):Pn(this,e)):A(new TypeError("view must be an array buffer view")):A(xn("read"))},e.prototype.releaseLock=function(){if(!kn(this))throw xn("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");j(this)}},e}();function kn(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")}function Pn(e,t){var n=e._ownerReadableStream;return n._disturbed=!0,"errored"===n._state?A(n._storedError):on(n._readableStreamController,t)}function xn(e){return new TypeError("ReadableStreamBYOBReader.prototype."+e+" can only be used on a ReadableStreamBYOBReader")}var Rn=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={}),Dn(this);var n=t.size,r=t.highWaterMark,i=e.type;if("bytes"===String(i)){if(void 0!==n)throw new RangeError("The strategy for a byte stream cannot have a size function");void 0===r&&(r=0),bn(this,e,r=m(r))}else{if(void 0!==i)throw new RangeError("Invalid type is specified");var o=y(n);void 0===r&&(r=1),Bt(this,e,r=m(r),o)}}return Object.defineProperty(e.prototype,"locked",{get:function(){if(!1===Nn(this))throw Bn("locked");return jn(this)},enumerable:!0,configurable:!0}),e.prototype.cancel=function(e){return!1===Nn(this)?A(Bn("cancel")):!0===jn(this)?A(new TypeError("Cannot cancel a stream that already has a reader")):Mn(this,e)},e.prototype.getReader=function(e){var t=(void 0===e?{}:e).mode;if(!1===Nn(this))throw Bn("getReader");if(void 0===t)return z(this,!0);if("byob"===(t=String(t)))return En(this,!0);throw new RangeError("Invalid mode is specified")},e.prototype.pipeThrough=function(e,t){var n=e.writable,r=e.readable,i=void 0===t?{}:t,o=i.preventClose,s=i.preventAbort,a=i.preventCancel,c=i.signal;if(!1===Nn(this))throw Bn("pipeThrough");if(!1===ye(n))throw new TypeError("writable argument to pipeThrough must be a WritableStream");if(!1===Nn(r))throw new TypeError("readable argument to pipeThrough must be a ReadableStream");if(o=Boolean(o),s=Boolean(s),a=Boolean(a),void 0!==c&&!Tt(c))throw new TypeError("ReadableStream.prototype.pipeThrough's signal option must be an AbortSignal");if(!0===jn(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(!0===ve(n))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");return P(It(this,n,o,s,a,c)),r},e.prototype.pipeTo=function(e,t){var n=void 0===t?{}:t,r=n.preventClose,i=n.preventAbort,o=n.preventCancel,s=n.signal;return!1===Nn(this)?A(Bn("pipeTo")):!1===ye(e)?A(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream")):(r=Boolean(r),i=Boolean(i),o=Boolean(o),void 0===s||Tt(s)?!0===jn(this)?A(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):!0===ve(e)?A(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):It(this,e,r,i,o,s):A(new TypeError("ReadableStream.prototype.pipeTo's signal option must be an AbortSignal")))},e.prototype.tee=function(){if(!1===Nn(this))throw Bn("tee");return s(qt(this))},e.prototype.getIterator=function(e){var t=(void 0===e?{}:e).preventCancel,n=void 0!==t&&t;if(!1===Nn(this))throw Bn("getIterator");return ie(this,n)},e}();function Ln(e,t,n,r,i){void 0===r&&(r=1),void 0===i&&(i=function(){return 1});var o=Object.create(Rn.prototype);return Dn(o),Ut(o,Object.create(Ct.prototype),e,t,n,r,i),o}function Dn(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function Nn(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")}function jn(e){return void 0!==e._reader}function Mn(e,t){return e._disturbed=!0,"closed"===e._state?E(void 0):"errored"===e._state?A(e._storedError):(Fn(e),k(e._readableStreamController[$](t),n))}function Fn(e){e._state="closed";var t=e._reader;void 0!==t&&(ee(t)&&(t._readRequests.forEach((function(e){e._resolve(L(void 0,!0,t._forAuthorCode))})),t._readRequests=new R),H(t))}function Un(e,t){e._state="errored",e._storedError=t;var n=e._reader;void 0!==n&&(ee(n)?(n._readRequests.forEach((function(e){e._reject(t)})),n._readRequests=new R):(n._readIntoRequests.forEach((function(e){e._reject(t)})),n._readIntoRequests=new R),G(n,t))}function Bn(e){return new TypeError("ReadableStream.prototype."+e+" can only be used on a ReadableStream")}"symbol"==typeof t.asyncIterator&&Object.defineProperty(Rn.prototype,t.asyncIterator,{value:Rn.prototype.getIterator,enumerable:!1,writable:!0,configurable:!0});var Gn=function(){function e(e){var t=e.highWaterMark;this.highWaterMark=t}return e.prototype.size=function(e){return e.byteLength},e}(),qn=function(){function e(e){var t=e.highWaterMark;this.highWaterMark=t}return e.prototype.size=function(){return 1},e}(),Hn=function(){function e(e,t,n){void 0===e&&(e={}),void 0===t&&(t={}),void 0===n&&(n={});var r=t.size,i=t.highWaterMark,o=n.size,s=n.highWaterMark;if(void 0!==e.writableType)throw new RangeError("Invalid writable type specified");var a=y(r);if(void 0===i&&(i=1),i=m(i),void 0!==e.readableType)throw new RangeError("Invalid readable type specified");var c,l=y(o);void 0===s&&(s=0),s=m(s),$n(this,T((function(e){c=e})),i,a,s,l),Jn(this,e);var u=h(e,"start",[this._transformStreamController]);c(u)}return Object.defineProperty(e.prototype,"readable",{get:function(){if(!1===Wn(this))throw lr("readable");return this._readable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"writable",{get:function(){if(!1===Wn(this))throw lr("writable");return this._writable},enumerable:!0,configurable:!0}),e}();function $n(e,t,n,r,i,o){function s(){return t}function a(t){return ir(e,t)}function c(t){return or(e,t)}function l(){return sr(e)}function u(){return ar(e)}function d(t){return Vn(e,t),E(void 0)}e._writable=ge(s,a,l,c,n,r),e._readable=Ln(s,u,d,i,o),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,Kn(e,!0),e._transformStreamController=void 0}function Wn(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")}function zn(e,t){Nt(e._readable._readableStreamController,t),Vn(e,t)}function Vn(e,t){Zn(e._transformStreamController),tt(e._writable._writableStreamController,t),!0===e._backpressure&&Kn(e,!1)}function Kn(e,t){void 0!==e._backpressureChangePromise&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=T((function(t){e._backpressureChangePromise_resolve=t})),e._backpressure=t}var Yn=function(){function e(){throw new TypeError("TransformStreamDefaultController instances cannot be created directly")}return Object.defineProperty(e.prototype,"desiredSize",{get:function(){if(!1===Qn(this))throw cr("desiredSize");return jt(this._controlledTransformStream._readable._readableStreamController)},enumerable:!0,configurable:!0}),e.prototype.enqueue=function(e){if(!1===Qn(this))throw cr("enqueue");er(this,e)},e.prototype.error=function(e){if(!1===Qn(this))throw cr("error");tr(this,e)},e.prototype.terminate=function(){if(!1===Qn(this))throw cr("terminate");rr(this)},e}();function Qn(e){return!!o(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")}function Xn(e,t,n,r){t._controlledTransformStream=e,e._transformStreamController=t,t._transformAlgorithm=n,t._flushAlgorithm=r}function Jn(e,t){var n=Object.create(Yn.prototype),r=function(e){try{return er(n,e),E(void 0)}catch(e){return A(e)}},i=t.transform;if(void 0!==i){if("function"!=typeof i)throw new TypeError("transform is not a method");r=function(e){return f(i,t,[e,n])}}var o=d(t,"flush",0,[n]);Xn(e,n,r,o)}function Zn(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0}function er(e,t){var n=e._controlledTransformStream,r=n._readable._readableStreamController;if(!1===Ft(r))throw new TypeError("Readable side is not in a state that permits enqueue");try{Dt(r,t)}catch(e){throw Vn(n,e),n._readable._storedError}Mt(r)!==n._backpressure&&Kn(n,!0)}function tr(e,t){zn(e._controlledTransformStream,t)}function nr(e,t){return k(e._transformAlgorithm(t),void 0,(function(t){throw zn(e._controlledTransformStream,t),t}))}function rr(e){var t=e._controlledTransformStream,n=t._readable._readableStreamController;!0===Ft(n)&&Lt(n),Vn(t,new TypeError("TransformStream terminated"))}function ir(e,t){var n=e._transformStreamController;return!0===e._backpressure?k(e._backpressureChangePromise,(function(){var r=e._writable;if("erroring"===r._state)throw r._storedError;return nr(n,t)})):nr(n,t)}function or(e,t){return zn(e,t),E(void 0)}function sr(e){var t=e._readable,n=e._transformStreamController,r=n._flushAlgorithm();return Zn(n),k(r,(function(){if("errored"===t._state)throw t._storedError;var e=t._readableStreamController;!0===Ft(e)&&Lt(e)}),(function(n){throw zn(e,n),t._storedError}))}function ar(e){return Kn(e,!1),e._backpressureChangePromise}function cr(e){return new TypeError("TransformStreamDefaultController.prototype."+e+" can only be used on a TransformStreamDefaultController")}function lr(e){return new TypeError("TransformStream.prototype."+e+" can only be used on a TransformStream")}e.ByteLengthQueuingStrategy=Gn,e.CountQueuingStrategy=qn,e.ReadableStream=Rn,e.TransformStream=Hn,e.WritableStream=fe,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){n(128),n(162),n(129),n(87);var r=n(109);e.exports=r.Map},function(e,t,n){"use strict";n(163)("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(170))},function(e,t,n){"use strict";var r=n(5),i=n(6),o=n(15),s=n(64),a=n(46),c=n(164),l=n(125),u=n(135),d=n(21),h=n(20),f=n(9),p=n(108),g=n(94),m=n(169);e.exports=function(e,t,n){var y=-1!==e.indexOf("Map"),v=-1!==e.indexOf("Weak"),b=y?"set":"add",_=i[e],w=_&&_.prototype,T=_,E={},A=function(e){var t=o(w[e]);a(w,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(v&&!h(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return v&&!h(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(v&&!h(e))&&t(this,0===e?0:e)}:function(e,n){return t(this,0===e?0:e,n),this})};if(s(e,!d(_)||!(v||w.forEach&&!f((function(){(new _).entries().next()})))))T=n.getConstructor(t,e,y,b),c.enable();else if(s(e,!0)){var S=new T,O=S[b](v?{}:-0,1)!=S,I=f((function(){S.has(1)})),C=p((function(e){new _(e)})),k=!v&&f((function(){for(var e=new _,t=5;t--;)e[b](t,t);return!e.has(-0)}));C||((T=t((function(e,t){u(e,w);var n=m(new _,e,T);return null!=t&&l(t,n[b],{that:n,AS_ENTRIES:y}),n}))).prototype=w,w.constructor=T),(I||k)&&(A("delete"),A("has"),y&&A("get")),(k||O)&&A(b),v&&w.clear&&delete w.clear}return E[e]=T,r({global:!0,forced:T!=_},E),g(T,e),v||n.setStrong(T,e,y),T}},function(e,t,n){var r=n(5),i=n(15),o=n(51),s=n(20),a=n(38),c=n(44).f,l=n(55),u=n(165),d=n(166),h=n(40),f=n(168),p=!1,g=h("meta"),m=0,y=function(e){c(e,g,{value:{objectID:"O"+m++,weakData:{}}})},v=e.exports={enable:function(){v.enable=function(){},p=!0;var e=l.f,t=i([].splice),n={};n[g]=1,e(n).length&&(l.f=function(n){for(var r=e(n),i=0,o=r.length;i<o;i++)if(r[i]===g){t(r,i,1);break}return r},r({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:u.f}))},fastKey:function(e,t){if(!s(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,g)){if(!d(e))return"F";if(!t)return"E";y(e)}return e[g].objectID},getWeakData:function(e,t){if(!a(e,g)){if(!d(e))return!0;if(!t)return!1;y(e)}return e[g].weakData},onFreeze:function(e){return f&&p&&d(e)&&!a(e,g)&&y(e),e}};o[g]=!0},function(e,t,n){var r=n(16),i=n(13),o=n(55).f,s=n(123),a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return a&&"Window"==r(e)?function(e){try{return o(e)}catch(e){return s(a)}}(e):o(i(e))}},function(e,t,n){var r=n(9),i=n(20),o=n(16),s=n(167),a=Object.isExtensible,c=r((function(){a(1)}));e.exports=c||s?function(e){return!!i(e)&&(!s||"ArrayBuffer"!=o(e))&&(!a||a(e))}:a},function(e,t,n){var r=n(9);e.exports=r((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},function(e,t,n){var r=n(9);e.exports=!r((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(e,t,n){var r=n(21),i=n(20),o=n(96);e.exports=function(e,t,n){var s,a;return o&&r(s=t.constructor)&&s!==n&&i(a=s.prototype)&&a!==n.prototype&&o(e,a),e}},function(e,t,n){"use strict";var r=n(44).f,i=n(82),o=n(133),s=n(100),a=n(135),c=n(125),l=n(89),u=n(134),d=n(8),h=n(164).fastKey,f=n(48),p=f.set,g=f.getterFor;e.exports={getConstructor:function(e,t,n,l){var u=e((function(e,r){a(e,f),p(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),d||(e.size=0),null!=r&&c(r,e[l],{that:e,AS_ENTRIES:n})})),f=u.prototype,m=g(t),y=function(e,t,n){var r,i,o=m(e),s=v(e,t);return s?s.value=n:(o.last=s={index:i=h(t,!0),key:t,value:n,previous:r=o.last,next:void 0,removed:!1},o.first||(o.first=s),r&&(r.next=s),d?o.size++:e.size++,"F"!==i&&(o.index[i]=s)),e},v=function(e,t){var n,r=m(e),i=h(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n};return o(f,{clear:function(){for(var e=m(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,d?e.size=0:this.size=0},delete:function(e){var t=this,n=m(t),r=v(t,e);if(r){var i=r.next,o=r.previous;delete n.index[r.index],r.removed=!0,o&&(o.next=i),i&&(i.previous=o),n.first==r&&(n.first=i),n.last==r&&(n.last=o),d?n.size--:t.size--}return!!r},forEach:function(e){for(var t,n=m(this),r=s(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!v(this,e)}}),o(f,n?{get:function(e){var t=v(this,e);return t&&t.value},set:function(e,t){return y(this,0===e?0:e,t)}}:{add:function(e){return y(this,e=0===e?0:e,e)}}),d&&r(f,"size",{get:function(){return m(this).size}}),u},setStrong:function(e,t,n){var r=t+" Iterator",i=g(t),o=g(r);l(e,t,(function(e,t){p(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),u(t)}}},function(e,t,n){n(128),n(129),n(172),n(87);var r=n(109);e.exports=r.Set},function(e,t,n){"use strict";n(163)("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(170))},function(e,t,n){n(128),n(129),n(174);var r=n(109);e.exports=r.WeakMap},function(e,t,n){"use strict";var r,i=n(6),o=n(15),s=n(133),a=n(164),c=n(163),l=n(175),u=n(20),d=n(166),h=n(48).enforce,f=n(49),p=!i.ActiveXObject&&"ActiveXObject"in i,g=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},m=c("WeakMap",g,l);if(f&&p){r=l.getConstructor(g,"WeakMap",!0),a.enable();var y=m.prototype,v=o(y.delete),b=o(y.has),_=o(y.get),w=o(y.set);s(y,{delete:function(e){if(u(e)&&!d(e)){var t=h(this);return t.frozen||(t.frozen=new r),v(this,e)||t.frozen.delete(e)}return v(this,e)},has:function(e){if(u(e)&&!d(e)){var t=h(this);return t.frozen||(t.frozen=new r),b(this,e)||t.frozen.has(e)}return b(this,e)},get:function(e){if(u(e)&&!d(e)){var t=h(this);return t.frozen||(t.frozen=new r),b(this,e)?_(this,e):t.frozen.get(e)}return _(this,e)},set:function(e,t){if(u(e)&&!d(e)){var n=h(this);n.frozen||(n.frozen=new r),b(this,e)?w(this,e,t):n.frozen.set(e,t)}else w(this,e,t);return this}})}},function(e,t,n){"use strict";var r=n(15),i=n(133),o=n(164).getWeakData,s=n(45),a=n(20),c=n(135),l=n(125),u=n(176),d=n(38),h=n(48),f=h.set,p=h.getterFor,g=u.find,m=u.findIndex,y=r([].splice),v=0,b=function(e){return e.frozen||(e.frozen=new _)},_=function(){this.entries=[]},w=function(e,t){return g(e.entries,(function(e){return e[0]===t}))};_.prototype={get:function(e){var t=w(this,e);if(t)return t[1]},has:function(e){return!!w(this,e)},set:function(e,t){var n=w(this,e);n?n[1]=t:this.entries.push([e,t])},delete:function(e){var t=m(this.entries,(function(t){return t[0]===e}));return~t&&y(this.entries,t,1),!!~t}},e.exports={getConstructor:function(e,t,n,r){var u=e((function(e,i){c(e,h),f(e,{type:t,id:v++,frozen:void 0}),null!=i&&l(i,e[r],{that:e,AS_ENTRIES:n})})),h=u.prototype,g=p(t),m=function(e,t,n){var r=g(e),i=o(s(t),!0);return!0===i?b(r).set(t,n):i[r.id]=n,e};return i(h,{delete:function(e){var t=g(this);if(!a(e))return!1;var n=o(e);return!0===n?b(t).delete(e):n&&d(n,t.id)&&delete n[t.id]},has:function(e){var t=g(this);if(!a(e))return!1;var n=o(e);return!0===n?b(t).has(e):n&&d(n,t.id)}}),i(h,n?{get:function(e){var t=g(this);if(a(e)){var n=o(e);return!0===n?b(t).get(e):n?n[t.id]:void 0}},set:function(e,t){return m(this,e,t)}}:{add:function(e){return m(this,e,!0)}}),u}}},function(e,t,n){var r=n(100),i=n(15),o=n(14),s=n(39),a=n(60),c=n(177),l=i([].push),u=function(e){var t=1==e,n=2==e,i=3==e,u=4==e,d=6==e,h=7==e,f=5==e||d;return function(p,g,m,y){for(var v,b,_=s(p),w=o(_),T=r(g,m),E=a(w),A=0,S=y||c,O=t?S(p,E):n||h?S(p,0):void 0;E>A;A++)if((f||A in w)&&(b=T(v=w[A],A,_),e))if(t)O[A]=b;else if(b)switch(e){case 3:return!0;case 5:return v;case 6:return A;case 2:l(O,v)}else switch(e){case 4:return!1;case 7:l(O,v)}return d?-1:i||u?u:O}};e.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6),filterReject:u(7)}},function(e,t,n){var r=n(178);e.exports=function(e,t){return new(r(e))(0===t?0:t)}},function(e,t,n){var r=n(6),i=n(179),o=n(104),s=n(20),a=n(33)("species"),c=r.Array;e.exports=function(e){var t;return i(e)&&(t=e.constructor,(o(t)&&(t===c||i(t.prototype))||s(t)&&null===(t=t[a]))&&(t=void 0)),void 0===t?c:t}},function(e,t,n){var r=n(16);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){n(128),n(129),n(181);var r=n(109);e.exports=r.WeakSet},function(e,t,n){"use strict";n(163)("WeakSet",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),n(175))},function(e,t,n){n(183);var r=n(74);e.exports=r("String","codePointAt")},function(e,t,n){"use strict";var r=n(5),i=n(88).codeAt;r({target:"String",proto:!0},{codePointAt:function(e){return i(this,e)}})},function(e,t,n){n(185);var r=n(109);e.exports=r.String.fromCodePoint},function(e,t,n){var r=n(5),i=n(6),o=n(15),s=n(58),a=i.RangeError,c=String.fromCharCode,l=String.fromCodePoint,u=o([].join);r({target:"String",stat:!0,forced:!!l&&1!=l.length},{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,i=0;r>i;){if(t=+arguments[i++],s(t,1114111)!==t)throw a(t+" is not a valid code point");n[i]=t<65536?c(t):c(55296+((t-=65536)>>10),t%1024+56320)}return u(n,"")}})},function(e,t,n){n(187),n(129),n(189),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(199),n(200),n(201),n(202),n(203),n(204),n(205),n(206),n(207),n(208);var r=n(109);e.exports=r.Symbol},function(e,t,n){"use strict";var r=n(5),i=n(6),o=n(9),s=n(179),a=n(20),c=n(39),l=n(60),u=n(105),d=n(177),h=n(188),f=n(33),p=n(27),g=f("isConcatSpreadable"),m=9007199254740991,y="Maximum allowed index exceeded",v=i.TypeError,b=p>=51||!o((function(){var e=[];return e[g]=!1,e.concat()[0]!==e})),_=h("concat"),w=function(e){if(!a(e))return!1;var t=e[g];return void 0!==t?!!t:s(e)};r({target:"Array",proto:!0,forced:!b||!_},{concat:function(e){var t,n,r,i,o,s=c(this),a=d(s,0),h=0;for(t=-1,r=arguments.length;t<r;t++)if(w(o=-1===t?s:arguments[t])){if(h+(i=l(o))>m)throw v(y);for(n=0;n<i;n++,h++)n in o&&u(a,h,o[n])}else{if(h>=m)throw v(y);u(a,h++,o)}return a.length=h,a}})},function(e,t,n){var r=n(9),i=n(33),o=n(27),s=i("species");e.exports=function(e){return o>=51||!r((function(){var t=[];return(t.constructor={})[s]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},function(e,t,n){"use strict";var r=n(5),i=n(6),o=n(23),s=n(139),a=n(10),c=n(15),l=n(35),u=n(8),d=n(26),h=n(9),f=n(38),p=n(179),g=n(21),m=n(20),y=n(24),v=n(22),b=n(45),_=n(39),w=n(13),T=n(18),E=n(68),A=n(12),S=n(82),O=n(84),I=n(55),C=n(165),k=n(63),P=n(7),x=n(44),R=n(11),L=n(123),D=n(46),N=n(34),j=n(50),M=n(51),F=n(40),U=n(33),B=n(190),G=n(191),q=n(94),H=n(48),$=n(176).forEach,W=j("hidden"),z="Symbol",V="prototype",K=U("toPrimitive"),Y=H.set,Q=H.getterFor(z),X=Object[V],J=i.Symbol,Z=J&&J[V],ee=i.TypeError,te=i.QObject,ne=o("JSON","stringify"),re=P.f,ie=x.f,oe=C.f,se=R.f,ae=c([].push),ce=N("symbols"),le=N("op-symbols"),ue=N("string-to-symbol-registry"),de=N("symbol-to-string-registry"),he=N("wks"),fe=!te||!te[V]||!te[V].findChild,pe=u&&h((function(){return 7!=S(ie({},"a",{get:function(){return ie(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=re(X,t);r&&delete X[t],ie(e,t,n),r&&e!==X&&ie(X,t,r)}:ie,ge=function(e,t){var n=ce[e]=S(Z);return Y(n,{type:z,tag:e,description:t}),u||(n.description=t),n},me=function(e,t,n){e===X&&me(le,t,n),b(e);var r=T(t);return b(n),f(ce,r)?(n.enumerable?(f(e,W)&&e[W][r]&&(e[W][r]=!1),n=S(n,{enumerable:A(0,!1)})):(f(e,W)||ie(e,W,A(1,{})),e[W][r]=!0),pe(e,r,n)):ie(e,r,n)},ye=function(e,t){b(e);var n=w(t),r=O(n).concat(we(n));return $(r,(function(t){u&&!a(ve,n,t)||me(e,t,n[t])})),e},ve=function(e){var t=T(e),n=a(se,this,t);return!(this===X&&f(ce,t)&&!f(le,t))&&(!(n||!f(this,t)||!f(ce,t)||f(this,W)&&this[W][t])||n)},be=function(e,t){var n=w(e),r=T(t);if(n!==X||!f(ce,r)||f(le,r)){var i=re(n,r);return!i||!f(ce,r)||f(n,W)&&n[W][r]||(i.enumerable=!0),i}},_e=function(e){var t=oe(w(e)),n=[];return $(t,(function(e){f(ce,e)||f(M,e)||ae(n,e)})),n},we=function(e){var t=e===X,n=oe(t?le:w(e)),r=[];return $(n,(function(e){!f(ce,e)||t&&!f(X,e)||ae(r,ce[e])})),r};if(d||(J=function(){if(y(Z,this))throw ee("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?E(arguments[0]):void 0,t=F(e),n=function(e){this===X&&a(n,le,e),f(this,W)&&f(this[W],t)&&(this[W][t]=!1),pe(this,t,A(1,e))};return u&&fe&&pe(X,t,{configurable:!0,set:n}),ge(t,e)},D(Z=J[V],"toString",(function(){return Q(this).tag})),D(J,"withoutSetter",(function(e){return ge(F(e),e)})),R.f=ve,x.f=me,P.f=be,I.f=C.f=_e,k.f=we,B.f=function(e){return ge(U(e),e)},u&&(ie(Z,"description",{configurable:!0,get:function(){return Q(this).description}}),l||D(X,"propertyIsEnumerable",ve,{unsafe:!0}))),r({global:!0,wrap:!0,forced:!d,sham:!d},{Symbol:J}),$(O(he),(function(e){G(e)})),r({target:z,stat:!0,forced:!d},{for:function(e){var t=E(e);if(f(ue,t))return ue[t];var n=J(t);return ue[t]=n,de[n]=t,n},keyFor:function(e){if(!v(e))throw ee(e+" is not a symbol");if(f(de,e))return de[e]},useSetter:function(){fe=!0},useSimple:function(){fe=!1}}),r({target:"Object",stat:!0,forced:!d,sham:!u},{create:function(e,t){return void 0===t?S(e):ye(S(e),t)},defineProperty:me,defineProperties:ye,getOwnPropertyDescriptor:be}),r({target:"Object",stat:!0,forced:!d},{getOwnPropertyNames:_e,getOwnPropertySymbols:we}),r({target:"Object",stat:!0,forced:h((function(){k.f(1)}))},{getOwnPropertySymbols:function(e){return k.f(_(e))}}),ne&&r({target:"JSON",stat:!0,forced:!d||h((function(){var e=J();return"[null]"!=ne([e])||"{}"!=ne({a:e})||"{}"!=ne(Object(e))}))},{stringify:function(e,t,n){var r=L(arguments),i=t;if((m(t)||void 0!==e)&&!v(e))return p(t)||(t=function(e,t){if(g(i)&&(t=a(i,this,e,t)),!v(t))return t}),r[1]=t,s(ne,null,r)}}),!Z[K]){var Te=Z.valueOf;D(Z,K,(function(e){return a(Te,this)}))}q(J,z),M[W]=!0},function(e,t,n){var r=n(33);t.f=r},function(e,t,n){var r=n(109),i=n(38),o=n(190),s=n(44).f;e.exports=function(e){var t=r.Symbol||(r.Symbol={});i(t,e)||s(t,e,{value:o.f(e)})}},function(e,t,n){n(191)("asyncIterator")},function(e,t,n){"use strict";var r=n(5),i=n(8),o=n(6),s=n(15),a=n(38),c=n(21),l=n(24),u=n(68),d=n(44).f,h=n(53),f=o.Symbol,p=f&&f.prototype;if(i&&c(f)&&(!("description"in p)||void 0!==f().description)){var g={},m=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:u(arguments[0]),t=l(p,this)?new f(e):void 0===e?f():f(e);return""===e&&(g[t]=!0),t};h(m,f),m.prototype=p,p.constructor=m;var y="Symbol(test)"==String(f("test")),v=s(p.toString),b=s(p.valueOf),_=/^Symbol\((.*)\)[^)]+$/,w=s("".replace),T=s("".slice);d(p,"description",{configurable:!0,get:function(){var e=b(this),t=v(e);if(a(g,e))return"";var n=y?T(t,7,-1):w(t,_,"$1");return""===n?void 0:n}}),r({global:!0,forced:!0},{Symbol:m})}},function(e,t,n){n(191)("hasInstance")},function(e,t,n){n(191)("isConcatSpreadable")},function(e,t,n){n(191)("iterator")},function(e,t,n){n(191)("match")},function(e,t,n){n(191)("matchAll")},function(e,t,n){n(191)("replace")},function(e,t,n){n(191)("search")},function(e,t,n){n(191)("species")},function(e,t,n){n(191)("split")},function(e,t,n){n(191)("toPrimitive")},function(e,t,n){n(191)("toStringTag")},function(e,t,n){n(191)("unscopables")},function(e,t,n){var r=n(6);n(94)(r.JSON,"JSON",!0)},function(e,t,n){n(94)(Math,"Math",!0)},function(e,t,n){var r=n(5),i=n(6),o=n(94);r({global:!0},{Reflect:{}}),o(i.Reflect,"Reflect",!0)},function(e,t,n){n(210);var r=n(74);e.exports=r("String","padStart")},function(e,t,n){"use strict";var r=n(5),i=n(211).start;r({target:"String",proto:!0,forced:n(213)},{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(15),i=n(61),o=n(68),s=n(212),a=n(17),c=r(s),l=r("".slice),u=Math.ceil,d=function(e){return function(t,n,r){var s,d,h=o(a(t)),f=i(n),p=h.length,g=void 0===r?" ":o(r);return f<=p||""==g?h:((d=c(g,u((s=f-p)/g.length))).length>s&&(d=l(d,0,s)),e?h+d:d+h)}};e.exports={start:d(!1),end:d(!0)}},function(e,t,n){"use strict";var r=n(6),i=n(59),o=n(68),s=n(17),a=r.RangeError;e.exports=function(e){var t=o(s(this)),n="",r=i(e);if(r<0||r==1/0)throw a("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}},function(e,t,n){var r=n(28);e.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(r)},function(e,t,n){n(215);var r=n(74);e.exports=r("String","padEnd")},function(e,t,n){"use strict";var r=n(5),i=n(211).end;r({target:"String",proto:!0,forced:n(213)},{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){n(217);var r=n(109);e.exports=r.Object.values},function(e,t,n){var r=n(5),i=n(218).values;r({target:"Object",stat:!0},{values:function(e){return i(e)}})},function(e,t,n){var r=n(8),i=n(15),o=n(84),s=n(13),a=i(n(11).f),c=i([].push),l=function(e){return function(t){for(var n,i=s(t),l=o(i),u=l.length,d=0,h=[];u>d;)n=l[d++],r&&!a(i,n)||c(h,e?[n,i[n]]:i[n]);return h}};e.exports={entries:l(!0),values:l(!1)}},function(module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDataRangeTransport=exports.LoopbackPort=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _regenerator=_interopRequireDefault(__w_pdfjs_require__(220)),_util=__w_pdfjs_require__(1),_display_utils=__w_pdfjs_require__(223),_font_loader=__w_pdfjs_require__(224),_api_compatibility=__w_pdfjs_require__(225),_canvas=__w_pdfjs_require__(226),_worker_options=__w_pdfjs_require__(228),_is_node=__w_pdfjs_require__(65),_message_handler=__w_pdfjs_require__(229),_metadata=__w_pdfjs_require__(230),_transport_stream=__w_pdfjs_require__(232),_webgl=__w_pdfjs_require__(233);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function asyncGeneratorStep(e,t,n,r,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){asyncGeneratorStep(o,r,i,s,a,"next",e)}function a(e){asyncGeneratorStep(o,r,i,s,a,"throw",e)}s(void 0)}))}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}var DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,createPDFNetworkStream;function setPDFNetworkStreamFactory(e){createPDFNetworkStream=e}function getDocument(e){var t,n=new PDFDocumentLoadingTask;if("string"==typeof e)t={url:e};else if((0,_util.isArrayBuffer)(e))t={data:e};else if(e instanceof PDFDataRangeTransport)t={range:e};else{if("object"!==_typeof(e))throw new Error("Invalid parameter in getDocument, need either Uint8Array, string or a parameter object");if(!e.url&&!e.data&&!e.range)throw new Error("Invalid parameter object: need either .data, .range or .url");t=e}var r=Object.create(null),i=null,o=null;for(var s in t)if("url"!==s||"undefined"==typeof window)if("range"!==s)if("worker"!==s)if("data"!==s||t[s]instanceof Uint8Array)r[s]=t[s];else{var a=t[s];if("string"==typeof a)r[s]=(0,_util.stringToBytes)(a);else if("object"!==_typeof(a)||null===a||isNaN(a.length)){if(!(0,_util.isArrayBuffer)(a))throw new Error("Invalid PDF binary data: either typed array, string or array-like object is expected in the data property.");r[s]=new Uint8Array(a)}else r[s]=new Uint8Array(a)}else o=t[s];else i=t[s];else r[s]=new URL(t[s],window.location).href;r.rangeChunkSize=r.rangeChunkSize||DEFAULT_RANGE_CHUNK_SIZE,r.CMapReaderFactory=r.CMapReaderFactory||_display_utils.DOMCMapReaderFactory,r.ignoreErrors=!0!==r.stopAtErrors,r.pdfBug=!0===r.pdfBug;var c=Object.values(_util.NativeImageDecoding);if(void 0!==r.nativeImageDecoderSupport&&c.includes(r.nativeImageDecoderSupport)||(r.nativeImageDecoderSupport=_api_compatibility.apiCompatibilityParams.nativeImageDecoderSupport||_util.NativeImageDecoding.DECODE),Number.isInteger(r.maxImageSize)||(r.maxImageSize=-1),"boolean"!=typeof r.isEvalSupported&&(r.isEvalSupported=!0),"boolean"!=typeof r.disableFontFace&&(r.disableFontFace=_api_compatibility.apiCompatibilityParams.disableFontFace||!1),"boolean"!=typeof r.disableRange&&(r.disableRange=!1),"boolean"!=typeof r.disableStream&&(r.disableStream=!1),"boolean"!=typeof r.disableAutoFetch&&(r.disableAutoFetch=!1),"boolean"!=typeof r.disableCreateObjectURL&&(r.disableCreateObjectURL=_api_compatibility.apiCompatibilityParams.disableCreateObjectURL||!1),(0,_util.setVerbosityLevel)(r.verbosity),!o){var l={verbosity:r.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};o=l.port?PDFWorker.fromPort(l):new PDFWorker(l),n._worker=o}var u=n.docId;return o.promise.then((function(){if(n.destroyed)throw new Error("Loading aborted");return _fetchDocument(o,r,i,u).then((function(e){if(n.destroyed)throw new Error("Loading aborted");var t;i?t=new _transport_stream.PDFDataTransportStream({length:r.length,initialData:r.initialData,progressiveDone:r.progressiveDone,disableRange:r.disableRange,disableStream:r.disableStream},i):r.data||(t=createPDFNetworkStream({url:r.url,length:r.length,httpHeaders:r.httpHeaders,withCredentials:r.withCredentials,rangeChunkSize:r.rangeChunkSize,disableRange:r.disableRange,disableStream:r.disableStream}));var s=new _message_handler.MessageHandler(u,e,o.port);s.postMessageTransfers=o.postMessageTransfers;var a=new WorkerTransport(s,n,t,r);n._transport=a,s.send("Ready",null)}))})).catch(n._capability.reject),n}function _fetchDocument(e,t,n,r){return e.destroyed?Promise.reject(new Error("Worker was destroyed")):(n&&(t.length=n.length,t.initialData=n.initialData,t.progressiveDone=n.progressiveDone),e.messageHandler.sendWithPromise("GetDocRequest",{docId:r,apiVersion:"2.4.457",source:{data:t.data,url:t.url,password:t.password,disableAutoFetch:t.disableAutoFetch,rangeChunkSize:t.rangeChunkSize,length:t.length},maxImageSize:t.maxImageSize,disableFontFace:t.disableFontFace,disableCreateObjectURL:t.disableCreateObjectURL,postMessageTransfers:e.postMessageTransfers,docBaseUrl:t.docBaseUrl,nativeImageDecoderSupport:t.nativeImageDecoderSupport,ignoreErrors:t.ignoreErrors,isEvalSupported:t.isEvalSupported}).then((function(t){if(e.destroyed)throw new Error("Worker was destroyed");return t})))}var PDFDocumentLoadingTask=(nextDocumentId=0,function(){function e(){_classCallCheck(this,e),this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+nextDocumentId++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}return _createClass(e,[{key:"promise",get:function(){return this._capability.promise}},{key:"destroy",value:function(){var e=this;return this.destroyed=!0,(this._transport?this._transport.destroy():Promise.resolve()).then((function(){e._transport=null,e._worker&&(e._worker.destroy(),e._worker=null)}))}},{key:"then",value:function(e,t){throw new Error("Removed API method: PDFDocumentLoadingTask.then, use the `promise` getter instead.")}}]),e}()),nextDocumentId,PDFDataRangeTransport=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,e),this.length=t,this.initialData=n,this.progressiveDone=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}return _createClass(e,[{key:"addRangeListener",value:function(e){this._rangeListeners.push(e)}},{key:"addProgressListener",value:function(e){this._progressListeners.push(e)}},{key:"addProgressiveReadListener",value:function(e){this._progressiveReadListeners.push(e)}},{key:"addProgressiveDoneListener",value:function(e){this._progressiveDoneListeners.push(e)}},{key:"onDataRange",value:function(e,t){var n,r=_createForOfIteratorHelper(this._rangeListeners);try{for(r.s();!(n=r.n()).done;)(0,n.value)(e,t)}catch(e){r.e(e)}finally{r.f()}}},{key:"onDataProgress",value:function(e,t){var n=this;this._readyCapability.promise.then((function(){var r,i=_createForOfIteratorHelper(n._progressListeners);try{for(i.s();!(r=i.n()).done;)(0,r.value)(e,t)}catch(e){i.e(e)}finally{i.f()}}))}},{key:"onDataProgressiveRead",value:function(e){var t=this;this._readyCapability.promise.then((function(){var n,r=_createForOfIteratorHelper(t._progressiveReadListeners);try{for(r.s();!(n=r.n()).done;)(0,n.value)(e)}catch(e){r.e(e)}finally{r.f()}}))}},{key:"onDataProgressiveDone",value:function(){var e=this;this._readyCapability.promise.then((function(){var t,n=_createForOfIteratorHelper(e._progressiveDoneListeners);try{for(n.s();!(t=n.n()).done;)(0,t.value)()}catch(e){n.e(e)}finally{n.f()}}))}},{key:"transportReady",value:function(){this._readyCapability.resolve()}},{key:"requestDataRange",value:function(e,t){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}},{key:"abort",value:function(){}}]),e}();exports.PDFDataRangeTransport=PDFDataRangeTransport;var PDFDocumentProxy=function(){function e(t,n){_classCallCheck(this,e),this._pdfInfo=t,this._transport=n}return _createClass(e,[{key:"numPages",get:function(){return this._pdfInfo.numPages}},{key:"fingerprint",get:function(){return this._pdfInfo.fingerprint}},{key:"getPage",value:function(e){return this._transport.getPage(e)}},{key:"getPageIndex",value:function(e){return this._transport.getPageIndex(e)}},{key:"getDestinations",value:function(){return this._transport.getDestinations()}},{key:"getDestination",value:function(e){return this._transport.getDestination(e)}},{key:"getPageLabels",value:function(){return this._transport.getPageLabels()}},{key:"getPageLayout",value:function(){return this._transport.getPageLayout()}},{key:"getPageMode",value:function(){return this._transport.getPageMode()}},{key:"getViewerPreferences",value:function(){return this._transport.getViewerPreferences()}},{key:"getOpenAction",value:function(){return this._transport.getOpenAction()}},{key:"getOpenActionDestination",value:function(){return(0,_display_utils.deprecated)("getOpenActionDestination, use getOpenAction instead."),this.getOpenAction().then((function(e){return e&&e.dest?e.dest:null}))}},{key:"getAttachments",value:function(){return this._transport.getAttachments()}},{key:"getJavaScript",value:function(){return this._transport.getJavaScript()}},{key:"getOutline",value:function(){return this._transport.getOutline()}},{key:"getPermissions",value:function(){return this._transport.getPermissions()}},{key:"getMetadata",value:function(){return this._transport.getMetadata()}},{key:"getData",value:function(){return this._transport.getData()}},{key:"getDownloadInfo",value:function(){return this._transport.downloadInfoCapability.promise}},{key:"getStats",value:function(){return this._transport.getStats()}},{key:"cleanup",value:function(){return this._transport.startCleanup()}},{key:"destroy",value:function(){return this.loadingTask.destroy()}},{key:"loadingParams",get:function(){return this._transport.loadingParams}},{key:"loadingTask",get:function(){return this._transport.loadingTask}}]),e}();exports.PDFDocumentProxy=PDFDocumentProxy;var PDFPageProxy=function(){function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_classCallCheck(this,e),this._pageIndex=t,this._pageInfo=n,this._transport=r,this._stats=i?new _display_utils.StatTimer:null,this._pdfBug=i,this.commonObjs=r.commonObjs,this.objs=new PDFObjects,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this.intentStates=Object.create(null),this.destroyed=!1}return _createClass(e,[{key:"pageNumber",get:function(){return this._pageIndex+1}},{key:"rotate",get:function(){return this._pageInfo.rotate}},{key:"ref",get:function(){return this._pageInfo.ref}},{key:"userUnit",get:function(){return this._pageInfo.userUnit}},{key:"view",get:function(){return this._pageInfo.view}},{key:"getViewport",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.scale,n=e.rotation,r=void 0===n?this.rotate:n,i=e.offsetX,o=void 0===i?0:i,s=e.offsetY,a=void 0===s?0:s,c=e.dontFlip,l=void 0!==c&&c;if(arguments.length>1||"number"==typeof arguments[0])throw new Error("PDFPageProxy.getViewport is called with obsolete arguments.");return new _display_utils.PageViewport({viewBox:this.view,scale:t,rotation:r,offsetX:o,offsetY:a,dontFlip:l})}},{key:"getAnnotations",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).intent,t=void 0===e?null:e;return this.annotationsPromise&&this.annotationsIntent===t||(this.annotationsPromise=this._transport.getAnnotations(this._pageIndex,t),this.annotationsIntent=t),this.annotationsPromise}},{key:"render",value:function(e){var t=this,n=e.canvasContext,r=e.viewport,i=e.intent,o=void 0===i?"display":i,s=e.enableWebGL,a=void 0!==s&&s,c=e.renderInteractiveForms,l=void 0!==c&&c,u=e.transform,d=void 0===u?null:u,h=e.imageLayer,f=void 0===h?null:h,p=e.canvasFactory,g=void 0===p?null:p,m=e.background,y=void 0===m?null:m;this._stats&&this._stats.time("Overall");var v="print"===o?"print":"display";this.pendingCleanup=!1,this.intentStates[v]||(this.intentStates[v]=Object.create(null));var b=this.intentStates[v];b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null);var _=g||new _display_utils.DOMCanvasFactory,w=new _webgl.WebGLContext({enable:a});b.displayReadyCapability||(b.displayReadyCapability=(0,_util.createPromiseCapability)(),b.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList({pageIndex:this._pageIndex,intent:v,renderInteractiveForms:!0===l}));var T=function(e){var n=b.renderTasks.indexOf(E);n>=0&&b.renderTasks.splice(n,1),(t.cleanupAfterRender||"print"===v)&&(t.pendingCleanup=!0),t._tryCleanup(),e?(E.capability.reject(e),t._abortOperatorList({intentState:b,reason:e})):E.capability.resolve(),t._stats&&(t._stats.timeEnd("Rendering"),t._stats.timeEnd("Overall"))},E=new InternalRenderTask({callback:T,params:{canvasContext:n,viewport:r,transform:d,imageLayer:f,background:y},objs:this.objs,commonObjs:this.commonObjs,operatorList:b.operatorList,pageIndex:this._pageIndex,canvasFactory:_,webGLContext:w,useRequestAnimationFrame:"print"!==v,pdfBug:this._pdfBug});b.renderTasks||(b.renderTasks=[]),b.renderTasks.push(E);var A=E.task;return b.displayReadyCapability.promise.then((function(e){t.pendingCleanup?T():(t._stats&&t._stats.time("Rendering"),E.initializeGraphics(e),E.operatorListChanged())})).catch(T),A}},{key:"getOperatorList",value:function(){var e="oplist";this.intentStates[e]||(this.intentStates[e]=Object.create(null));var t,n=this.intentStates[e];return n.opListReadCapability||((t={}).operatorListChanged=function(){if(n.operatorList.lastChunk){n.opListReadCapability.resolve(n.operatorList);var e=n.renderTasks.indexOf(t);e>=0&&n.renderTasks.splice(e,1)}},n.opListReadCapability=(0,_util.createPromiseCapability)(),n.renderTasks=[],n.renderTasks.push(t),n.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList({pageIndex:this._pageIndex,intent:e})),n.opListReadCapability.promise}},{key:"streamTextContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.normalizeWhitespace,n=void 0!==t&&t,r=e.disableCombineTextItems,i=void 0!==r&&r;return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,normalizeWhitespace:!0===n,combineTextItems:!0!==i},{highWaterMark:100,size:function(e){return e.items.length}})}},{key:"getTextContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.streamTextContent(e);return new Promise((function(e,n){var r=t.getReader(),i={items:[],styles:Object.create(null)};!function t(){r.read().then((function(n){var r,o=n.value;n.done?e(i):(Object.assign(i.styles,o.styles),(r=i.items).push.apply(r,_toConsumableArray(o.items)),t())}),n)}()}))}},{key:"_destroy",value:function(){var e=this;this.destroyed=!0,this._transport.pageCache[this._pageIndex]=null;var t=[];return Object.keys(this.intentStates).forEach((function(n){var r=e.intentStates[n];e._abortOperatorList({intentState:r,reason:new Error("Page was destroyed."),force:!0}),"oplist"!==n&&r.renderTasks.forEach((function(e){var n=e.capability.promise.catch((function(){}));t.push(n),e.cancel()}))})),this.objs.clear(),this.annotationsPromise=null,this.pendingCleanup=!1,Promise.all(t)}},{key:"cleanup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.pendingCleanup=!0,this._tryCleanup(e)}},{key:"_tryCleanup",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!(!this.pendingCleanup||Object.keys(this.intentStates).some((function(t){var n=e.intentStates[t];return 0!==n.renderTasks.length||!n.operatorList.lastChunk}))||(Object.keys(this.intentStates).forEach((function(t){delete e.intentStates[t]})),this.objs.clear(),this.annotationsPromise=null,t&&this._stats&&(this._stats=new _display_utils.StatTimer),this.pendingCleanup=!1,0))}},{key:"_startRenderPage",value:function(e,t){var n=this.intentStates[t];n&&(this._stats&&this._stats.timeEnd("Page Request"),n.displayReadyCapability&&n.displayReadyCapability.resolve(e))}},{key:"_renderPageChunk",value:function(e,t){for(var n=0,r=e.length;n<r;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk;for(var i=0;i<t.renderTasks.length;i++)t.renderTasks[i].operatorListChanged();e.lastChunk&&this._tryCleanup()}},{key:"_pumpOperatorList",value:function(e){var t=this;(0,_util.assert)(e.intent,'PDFPageProxy._pumpOperatorList: Expected "intent" argument.');var n=this._transport.messageHandler.sendWithStream("GetOperatorList",e).getReader(),r=this.intentStates[e.intent];r.streamReader=n,function e(){n.read().then((function(n){var i=n.value;n.done?r.streamReader=null:t._transport.destroyed||(t._renderPageChunk(i,r),e())}),(function(e){if(r.streamReader=null,!t._transport.destroyed){if(r.operatorList){r.operatorList.lastChunk=!0;for(var n=0;n<r.renderTasks.length;n++)r.renderTasks[n].operatorListChanged();t._tryCleanup()}if(r.displayReadyCapability)r.displayReadyCapability.reject(e);else{if(!r.opListReadCapability)throw e;r.opListReadCapability.reject(e)}}}))}()}},{key:"_abortOperatorList",value:function(e){var t=this,n=e.intentState,r=e.reason,i=e.force,o=void 0!==i&&i;if((0,_util.assert)(r instanceof Error||"object"===_typeof(r)&&null!==r,'PDFPageProxy._abortOperatorList: Expected "reason" argument.'),n.streamReader){if(!o){if(0!==n.renderTasks.length)return;if(r instanceof _display_utils.RenderingCancelledException)return void(n.streamReaderCancelTimeout=setTimeout((function(){t._abortOperatorList({intentState:n,reason:r,force:!0}),n.streamReaderCancelTimeout=null}),RENDERING_CANCELLED_TIMEOUT))}n.streamReader.cancel(new _util.AbortException(r&&r.message)),n.streamReader=null,this._transport.destroyed||(Object.keys(this.intentStates).some((function(e){return t.intentStates[e]===n&&(delete t.intentStates[e],!0)})),this.cleanup())}}},{key:"stats",get:function(){return this._stats}}]),e}();exports.PDFPageProxy=PDFPageProxy;var LoopbackPort=function(){function e(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];_classCallCheck(this,e),this._listeners=[],this._defer=t,this._deferred=Promise.resolve(void 0)}return _createClass(e,[{key:"postMessage",value:function(e,t){var n=this;if(this._defer){var r=new WeakMap,i={data:function e(n){if("object"!==_typeof(n)||null===n)return n;if(r.has(n))return r.get(n);var i,o;if((i=n.buffer)&&(0,_util.isArrayBuffer)(i))return o=t&&t.includes(i)?new n.constructor(i,n.byteOffset,n.byteLength):new n.constructor(n),r.set(n,o),o;for(var s in o=Array.isArray(n)?[]:{},r.set(n,o),n){for(var a=void 0,c=n;!(a=Object.getOwnPropertyDescriptor(c,s));)c=Object.getPrototypeOf(c);if(void 0!==a.value)if("function"!=typeof a.value)o[s]=e(a.value);else if(n.hasOwnProperty&&n.hasOwnProperty(s))throw new Error("LoopbackPort.postMessage - cannot clone: ".concat(n[s]))}return o}(e)};this._deferred.then((function(){n._listeners.forEach((function(e){e.call(n,i)}))}))}else this._listeners.forEach((function(t){t.call(n,{data:e})}))}},{key:"addEventListener",value:function(e,t){this._listeners.push(t)}},{key:"removeEventListener",value:function(e,t){var n=this._listeners.indexOf(t);this._listeners.splice(n,1)}},{key:"terminate",value:function(){this._listeners.length=0}}]),e}();exports.LoopbackPort=LoopbackPort;var PDFWorker=function PDFWorkerClosure(){var pdfWorkerPorts=new WeakMap,isWorkerDisabled=!1,fallbackWorkerSrc,nextFakeWorkerId=0,fakeWorkerCapability;if(_is_node.isNodeJS)isWorkerDisabled=!0,fallbackWorkerSrc="./pdf.worker.js";else if("object"===("undefined"==typeof document?"undefined":_typeof(document))&&"currentScript"in document){var pdfjsFilePath=document.currentScript&&document.currentScript.src;pdfjsFilePath&&(fallbackWorkerSrc=pdfjsFilePath.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}function _getWorkerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(void 0!==fallbackWorkerSrc)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}function getMainThreadWorkerMessageHandler(){var e;try{e=globalThis.pdfjsWorker&&globalThis.pdfjsWorker.WorkerMessageHandler}catch(e){}return e||null}function setupFakeWorkerGlobal(){if(fakeWorkerCapability)return fakeWorkerCapability.promise;fakeWorkerCapability=(0,_util.createPromiseCapability)();var loader=function(){var _ref8=_asyncToGenerator(_regenerator.default.mark((function _callee(){var mainWorkerMessageHandler,worker;return _regenerator.default.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(mainWorkerMessageHandler=getMainThreadWorkerMessageHandler(),!mainWorkerMessageHandler){_context.next=3;break}return _context.abrupt("return",mainWorkerMessageHandler);case 3:if(!_is_node.isNodeJS){_context.next=6;break}return worker=eval("require")(_getWorkerSrc()),_context.abrupt("return",worker.WorkerMessageHandler);case 6:return _context.next=8,(0,_display_utils.loadScript)(_getWorkerSrc());case 8:return _context.abrupt("return",window.pdfjsWorker.WorkerMessageHandler);case 9:case"end":return _context.stop()}}),_callee)})));return function(){return _ref8.apply(this,arguments)}}();return loader().then(fakeWorkerCapability.resolve,fakeWorkerCapability.reject),fakeWorkerCapability.promise}function createCDNWrapper(e){var t="importScripts('"+e+"');";return URL.createObjectURL(new Blob([t]))}var PDFWorker=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.name,r=void 0===n?null:n,i=t.port,o=void 0===i?null:i,s=t.verbosity,a=void 0===s?(0,_util.getVerbosityLevel)():s;if(_classCallCheck(this,e),o&&pdfWorkerPorts.has(o))throw new Error("Cannot use more than one PDFWorker per port");if(this.name=r,this.destroyed=!1,this.postMessageTransfers=!0,this.verbosity=a,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,o)return pdfWorkerPorts.set(o,this),void this._initializeFromPort(o);this._initialize()}return _createClass(e,[{key:"promise",get:function(){return this._readyCapability.promise}},{key:"port",get:function(){return this._port}},{key:"messageHandler",get:function(){return this._messageHandler}},{key:"_initializeFromPort",value:function(e){this._port=e,this._messageHandler=new _message_handler.MessageHandler("main","worker",e),this._messageHandler.on("ready",(function(){})),this._readyCapability.resolve()}},{key:"_initialize",value:function(){var e=this;if("undefined"!=typeof Worker&&!isWorkerDisabled&&!getMainThreadWorkerMessageHandler()){var t=_getWorkerSrc();try{(0,_util.isSameOrigin)(window.location.href,t)||(t=createCDNWrapper(new URL(t,window.location).href));var n=new Worker(t),r=new _message_handler.MessageHandler("main","worker",n),i=function(){n.removeEventListener("error",o),r.destroy(),n.terminate(),e.destroyed?e._readyCapability.reject(new Error("Worker was destroyed")):e._setupFakeWorker()},o=function(){e._webWorker||i()};n.addEventListener("error",o),r.on("test",(function(t){n.removeEventListener("error",o),e.destroyed?i():t?(e._messageHandler=r,e._port=n,e._webWorker=n,t.supportTransfers||(e.postMessageTransfers=!1),e._readyCapability.resolve(),r.send("configure",{verbosity:e.verbosity})):(e._setupFakeWorker(),r.destroy(),n.terminate())})),r.on("ready",(function(t){if(n.removeEventListener("error",o),e.destroyed)i();else try{s()}catch(t){e._setupFakeWorker()}}));var s=function(){var t=new Uint8Array([e.postMessageTransfers?255:0]);try{r.send("test",t,[t.buffer])}catch(e){(0,_util.warn)("Cannot use postMessage transfers."),t[0]=0,r.send("test",t)}};return void s()}catch(e){(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}},{key:"_setupFakeWorker",value:function(){var e=this;isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),isWorkerDisabled=!0),setupFakeWorkerGlobal().then((function(t){if(e.destroyed)e._readyCapability.reject(new Error("Worker was destroyed"));else{var n=new LoopbackPort;e._port=n;var r="fake"+nextFakeWorkerId++,i=new _message_handler.MessageHandler(r+"_worker",r,n);t.setup(i,n);var o=new _message_handler.MessageHandler(r,r+"_worker",n);e._messageHandler=o,e._readyCapability.resolve(),o.send("configure",{verbosity:e.verbosity})}})).catch((function(t){e._readyCapability.reject(new Error('Setting up fake worker failed: "'.concat(t.message,'".')))}))}},{key:"destroy",value:function(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),pdfWorkerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}}],[{key:"fromPort",value:function(t){if(!t||!t.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return pdfWorkerPorts.has(t.port)?pdfWorkerPorts.get(t.port):new e(t)}},{key:"getWorkerSrc",value:function(){return _getWorkerSrc()}}]),e}();return PDFWorker}();exports.PDFWorker=PDFWorker;var WorkerTransport=function(){function e(t,n,r,i){_classCallCheck(this,e),this.messageHandler=t,this.loadingTask=n,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:n.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this)}),this._params=i,this.CMapReaderFactory=new i.CMapReaderFactory({baseUrl:i.cMapUrl,isCompressed:i.cMapPacked}),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.pageCache=[],this.pagePromises=[],this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}return _createClass(e,[{key:"destroy",value:function(){var e=this;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));var t=[];this.pageCache.forEach((function(e){e&&t.push(e._destroy())})),this.pageCache.length=0,this.pagePromises.length=0;var n=this.messageHandler.sendWithPromise("Terminate",null);return t.push(n),Promise.all(t).then((function(){e.fontLoader.clear(),e._networkStream&&e._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),e.messageHandler&&(e.messageHandler.destroy(),e.messageHandler=null),e.destroyCapability.resolve()}),this.destroyCapability.reject),this.destroyCapability.promise}},{key:"setupMessageHandler",value:function(){var e=this,t=this.messageHandler,n=this.loadingTask;t.on("GetReader",(function(t,n){(0,_util.assert)(e._networkStream),e._fullReader=e._networkStream.getFullReader(),e._fullReader.onProgress=function(t){e._lastProgress={loaded:t.loaded,total:t.total}},n.onPull=function(){e._fullReader.read().then((function(e){var t=e.value;e.done?n.close():((0,_util.assert)((0,_util.isArrayBuffer)(t)),n.enqueue(new Uint8Array(t),1,[t]))})).catch((function(e){n.error(e)}))},n.onCancel=function(t){e._fullReader.cancel(t)}})),t.on("ReaderHeadersReady",(function(t){var r=(0,_util.createPromiseCapability)(),i=e._fullReader;return i.headersReady.then((function(){i.isStreamingSupported&&i.isRangeSupported||(e._lastProgress&&n.onProgress&&n.onProgress(e._lastProgress),i.onProgress=function(e){n.onProgress&&n.onProgress({loaded:e.loaded,total:e.total})}),r.resolve({isStreamingSupported:i.isStreamingSupported,isRangeSupported:i.isRangeSupported,contentLength:i.contentLength})}),r.reject),r.promise})),t.on("GetRangeReader",(function(t,n){(0,_util.assert)(e._networkStream);var r=e._networkStream.getRangeReader(t.begin,t.end);r?(n.onPull=function(){r.read().then((function(e){var t=e.value;e.done?n.close():((0,_util.assert)((0,_util.isArrayBuffer)(t)),n.enqueue(new Uint8Array(t),1,[t]))})).catch((function(e){n.error(e)}))},n.onCancel=function(e){r.cancel(e)}):n.close()})),t.on("GetDoc",(function(t){var r=t.pdfInfo;e._numPages=r.numPages,n._capability.resolve(new PDFDocumentProxy(r,e))})),t.on("DocException",(function(e){var t;switch(e.name){case"PasswordException":t=new _util.PasswordException(e.message,e.code);break;case"InvalidPDFException":t=new _util.InvalidPDFException(e.message);break;case"MissingPDFException":t=new _util.MissingPDFException(e.message);break;case"UnexpectedResponseException":t=new _util.UnexpectedResponseException(e.message,e.status);break;case"UnknownErrorException":t=new _util.UnknownErrorException(e.message,e.details)}n._capability.reject(t)})),t.on("PasswordRequest",(function(t){if(e._passwordCapability=(0,_util.createPromiseCapability)(),n.onPassword)try{n.onPassword((function(t){e._passwordCapability.resolve({password:t})}),t.code)}catch(t){e._passwordCapability.reject(t)}else e._passwordCapability.reject(new _util.PasswordException(t.message,t.code));return e._passwordCapability.promise})),t.on("DataLoaded",(function(t){n.onProgress&&n.onProgress({loaded:t.length,total:t.length}),e.downloadInfoCapability.resolve(t)})),t.on("StartRenderPage",(function(t){e.destroyed||e.pageCache[t.pageIndex]._startRenderPage(t.transparency,t.intent)})),t.on("commonobj",(function(n){if(!e.destroyed){var r=_slicedToArray(n,3),i=r[0],o=r[1],s=r[2];if(!e.commonObjs.has(i))switch(o){case"Font":var a=e._params;if("error"in s){var c=s.error;(0,_util.warn)("Error during font loading: ".concat(c)),e.commonObjs.resolve(i,c);break}var l=null;a.pdfBug&&globalThis.FontInspector&&globalThis.FontInspector.enabled&&(l={registerFont:function(e,t){globalThis.FontInspector.fontAdded(e,t)}});var u=new _font_loader.FontFaceObject(s,{isEvalSupported:a.isEvalSupported,disableFontFace:a.disableFontFace,ignoreErrors:a.ignoreErrors,onUnsupportedFeature:e._onUnsupportedFeature.bind(e),fontRegistry:l});e.fontLoader.bind(u).then((function(){e.commonObjs.resolve(i,u)}),(function(n){t.sendWithPromise("FontFallback",{id:i}).finally((function(){e.commonObjs.resolve(i,u)}))}));break;case"FontPath":case"FontType3Res":e.commonObjs.resolve(i,s);break;default:throw new Error("Got unknown common object type ".concat(o))}}})),t.on("obj",(function(t){if(!e.destroyed){var n=_slicedToArray(t,4),r=n[0],i=n[1],o=n[2],s=n[3],a=e.pageCache[i];if(!a.objs.has(r))switch(o){case"JpegStream":return new Promise((function(e,t){var n=new Image;n.onload=function(){e(n)},n.onerror=function(){t(new Error("Error during JPEG image loading")),(0,_display_utils.releaseImageResources)(n)},n.src=s})).then((function(e){a.objs.resolve(r,e)}));case"Image":a.objs.resolve(r,s),s&&"data"in s&&s.data.length>8e6&&(a.cleanupAfterRender=!0);break;default:throw new Error("Got unknown object type ".concat(o))}}})),t.on("DocProgress",(function(t){e.destroyed||n.onProgress&&n.onProgress({loaded:t.loaded,total:t.total})})),t.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),t.on("JpegDecode",(function(t){if(e.destroyed)return Promise.reject(new Error("Worker was destroyed"));if("undefined"==typeof document)return Promise.reject(new Error('"document" is not defined.'));var n=_slicedToArray(t,2),r=n[0],i=n[1];return 3!==i&&1!==i?Promise.reject(new Error("Only 3 components or 1 component can be returned")):new Promise((function(e,t){var n=new Image;n.onload=function(){var t=n.width,r=n.height,o=t*r,s=4*o,a=new Uint8ClampedArray(o*i),c=document.createElement("canvas");c.width=t,c.height=r;var l=c.getContext("2d");l.drawImage(n,0,0);var u=l.getImageData(0,0,t,r).data;if(3===i)for(var d=0,h=0;d<s;d+=4,h+=3)a[h]=u[d],a[h+1]=u[d+1],a[h+2]=u[d+2];else if(1===i)for(var f=0,p=0;f<s;f+=4,p++)a[p]=u[f];e({data:a,width:t,height:r}),(0,_display_utils.releaseImageResources)(n),c.width=0,c.height=0,c=null,l=null},n.onerror=function(){t(new Error("JpegDecode failed to load image")),(0,_display_utils.releaseImageResources)(n)},n.src=r}))})),t.on("FetchBuiltInCMap",(function(t,n){if(e.destroyed)n.error(new Error("Worker was destroyed"));else{var r=!1;n.onPull=function(){r?n.close():(r=!0,e.CMapReaderFactory.fetch(t).then((function(e){n.enqueue(e,1,[e.cMapData.buffer])})).catch((function(e){n.error(e)})))}}}))}},{key:"_onUnsupportedFeature",value:function(e){var t=e.featureId;this.destroyed||this.loadingTask.onUnsupportedFeature&&this.loadingTask.onUnsupportedFeature(t)}},{key:"getData",value:function(){return this.messageHandler.sendWithPromise("GetData",null)}},{key:"getPage",value:function(e){var t=this;if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request"));var n=e-1;if(n in this.pagePromises)return this.pagePromises[n];var r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:n}).then((function(e){if(t.destroyed)throw new Error("Transport destroyed");var r=new PDFPageProxy(n,e,t,t._params.pdfBug);return t.pageCache[n]=r,r}));return this.pagePromises[n]=r,r}},{key:"getPageIndex",value:function(e){return this.messageHandler.sendWithPromise("GetPageIndex",{ref:e}).catch((function(e){return Promise.reject(new Error(e))}))}},{key:"getAnnotations",value:function(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}},{key:"getDestinations",value:function(){return this.messageHandler.sendWithPromise("GetDestinations",null)}},{key:"getDestination",value:function(e){return"string"!=typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}},{key:"getPageLabels",value:function(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}},{key:"getPageLayout",value:function(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}},{key:"getPageMode",value:function(){return this.messageHandler.sendWithPromise("GetPageMode",null)}},{key:"getViewerPreferences",value:function(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}},{key:"getOpenAction",value:function(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}},{key:"getAttachments",value:function(){return this.messageHandler.sendWithPromise("GetAttachments",null)}},{key:"getJavaScript",value:function(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}},{key:"getOutline",value:function(){return this.messageHandler.sendWithPromise("GetOutline",null)}},{key:"getPermissions",value:function(){return this.messageHandler.sendWithPromise("GetPermissions",null)}},{key:"getMetadata",value:function(){var e=this;return this.messageHandler.sendWithPromise("GetMetadata",null).then((function(t){return{info:t[0],metadata:t[1]?new _metadata.Metadata(t[1]):null,contentDispositionFilename:e._fullReader?e._fullReader.filename:null}}))}},{key:"getStats",value:function(){return this.messageHandler.sendWithPromise("GetStats",null)}},{key:"startCleanup",value:function(){var e=this;return this.messageHandler.sendWithPromise("Cleanup",null).then((function(){for(var t=0,n=e.pageCache.length;t<n;t++){var r=e.pageCache[t];if(r&&!r.cleanup())throw new Error("startCleanup: Page ".concat(t+1," is currently rendering."))}e.commonObjs.clear(),e.fontLoader.clear()}))}},{key:"loadingParams",get:function(){var e=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e.disableAutoFetch,disableCreateObjectURL:e.disableCreateObjectURL,disableFontFace:e.disableFontFace,nativeImageDecoderSupport:e.nativeImageDecoderSupport})}}]),e}(),PDFObjects=function(){function e(){_classCallCheck(this,e),this._objs=Object.create(null)}return _createClass(e,[{key:"_ensureObj",value:function(e){return this._objs[e]?this._objs[e]:this._objs[e]={capability:(0,_util.createPromiseCapability)(),data:null,resolved:!1}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t)return this._ensureObj(e).capability.promise.then(t),null;var n=this._objs[e];if(!n||!n.resolved)throw new Error("Requesting object that isn't resolved yet ".concat(e,"."));return n.data}},{key:"has",value:function(e){var t=this._objs[e];return!!t&&t.resolved}},{key:"resolve",value:function(e,t){var n=this._ensureObj(e);n.resolved=!0,n.data=t,n.capability.resolve(t)}},{key:"clear",value:function(){for(var e in this._objs){var t=this._objs[e].data;"undefined"!=typeof Image&&t instanceof Image&&(0,_display_utils.releaseImageResources)(t)}this._objs=Object.create(null)}}]),e}(),RenderTask=function(){function e(t){_classCallCheck(this,e),this._internalRenderTask=t,this.onContinue=null}return _createClass(e,[{key:"promise",get:function(){return this._internalRenderTask.capability.promise}},{key:"cancel",value:function(){this._internalRenderTask.cancel()}},{key:"then",value:function(e,t){throw new Error("Removed API method: RenderTask.then, use the `promise` getter instead.")}}]),e}(),InternalRenderTask=function(){var e=new WeakSet,t=function(){function t(e){var n=e.callback,r=e.params,i=e.objs,o=e.commonObjs,s=e.operatorList,a=e.pageIndex,c=e.canvasFactory,l=e.webGLContext,u=e.useRequestAnimationFrame,d=void 0!==u&&u,h=e.pdfBug,f=void 0!==h&&h;_classCallCheck(this,t),this.callback=n,this.params=r,this.objs=i,this.commonObjs=o,this.operatorListIdx=null,this.operatorList=s,this._pageIndex=a,this.canvasFactory=c,this.webGLContext=l,this._pdfBug=f,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===d&&"undefined"!=typeof window,this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=r.canvasContext.canvas}var n;return _createClass(t,[{key:"initializeGraphics",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.cancelled){if(this._canvas){if(e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager&&globalThis.StepperManager.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());var n=this.params,r=n.canvasContext,i=n.viewport,o=n.transform,s=n.imageLayer,a=n.background;this.gfx=new _canvas.CanvasGraphics(r,this.commonObjs,this.objs,this.canvasFactory,this.webGLContext,s),this.gfx.beginDrawing({transform:o,viewport:i,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}}},{key:"cancel",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&e.delete(this._canvas),this.callback(t||new _display_utils.RenderingCancelledException("Rendering cancelled, page ".concat(this._pageIndex+1),"canvas"))}},{key:"operatorListChanged",value:function(){this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}},{key:"_continue",value:function(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}},{key:"_scheduleNext",value:function(){var e=this;this._useRequestAnimationFrame?window.requestAnimationFrame((function(){e._nextBound().catch(e.cancel.bind(e))})):Promise.resolve().then(this._nextBound).catch(this.cancel.bind(this))}},{key:"_next",value:(n=_asyncToGenerator(_regenerator.default.mark((function t(){return _regenerator.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.cancelled){t.next=2;break}return t.abrupt("return");case 2:this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&e.delete(this._canvas),this.callback()));case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})}]),t}();return t}(),version="2.4.457";exports.version=version;var build="384c00ab6";exports.build=build},function(e,t,n){"use strict";e.exports=n(221)},function(e,t,n){"use strict";(function(e){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var n=function(e){var n,r=Object.prototype,i=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof y?t:y,o=Object.create(i.prototype),s=new k(r||[]);return o._invoke=function(e,t,n){var r=h;return function(i,o){if(r===p)throw new Error("Generator is already running");if(r===g){if("throw"===i)throw o;return x()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=O(s,n);if(a){if(a===m)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var c=d(e,t,n);if("normal"===c.type){if(r=n.done?g:f,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=g,n.method="throw",n.arg=c.arg)}}}(e,n,s),o}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var h="suspendedStart",f="suspendedYield",p="executing",g="completed",m={};function y(){}function v(){}function b(){}var _={};l(_,s,(function(){return this}));var w=Object.getPrototypeOf,T=w&&w(w(P([])));T&&T!==r&&i.call(T,s)&&(_=T);var E=b.prototype=y.prototype=Object.create(_);function A(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,n){function r(o,s,a,c){var l=d(e[o],e,s);if("throw"!==l.type){var u=l.arg,h=u.value;return h&&"object"===t(h)&&i.call(h,"__await")?n.resolve(h.__await).then((function(e){r("next",e,a,c)}),(function(e){r("throw",e,a,c)})):n.resolve(h).then((function(e){u.value=e,a(u)}),(function(e){return r("throw",e,a,c)}))}c(l.arg)}var o;this._invoke=function(e,t){function i(){return new n((function(n,i){r(e,t,n,i)}))}return o=o?o.then(i,i):i()}}function O(e,t){var r=e.iterator[t.method];if(r===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,O(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=d(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,m;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function P(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}return{next:x}}function x(){return{value:n,done:!0}}return v.prototype=b,l(E,"constructor",b),l(b,"constructor",v),v.displayName=l(b,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,c,"GeneratorFunction")),e.prototype=Object.create(E),e},e.awrap=function(e){return{__await:e}},A(S.prototype),l(S.prototype,a,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new S(u(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},A(E),l(E,c,"Generator"),l(E,s,(function(){return this})),l(E,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=P,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,i){return a.type="throw",a.arg=e,t.next=r,i&&(t.method="next",t.arg=n),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var c=i.call(s,"catchLoc"),l=i.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;C(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:P(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),m}},e}("object"===t(e)?e.exports:{});try{regeneratorRuntime=n}catch(e){"object"===("undefined"==typeof globalThis?"undefined":t(globalThis))?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}}).call(this,n(222)(e))},function(e,t,n){"use strict";e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.StatTimer=t.RenderingCancelledException=t.PageViewport=t.PDFDateString=t.LinkTarget=t.DOMSVGFactory=t.DOMCanvasFactory=t.DOMCMapReaderFactory=t.DEFAULT_LINK_REL=void 0,t.addLinkAttributes=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.url,r=t.target,i=t.rel,o=t.enabled,a=void 0===o||o;(0,s.assert)(n&&"string"==typeof n,'addLinkAttributes: A valid "url" parameter must provided.');var c=(0,s.removeNullCharacters)(n);a?e.href=e.title=c:(e.href="",e.title="Disabled: ".concat(c),e.onclick=function(){return!1});var l="";switch(r){case A.NONE:break;case A.SELF:l="_self";break;case A.BLANK:l="_blank";break;case A.PARENT:l="_parent";break;case A.TOP:l="_top"}e.target=l,e.rel="string"==typeof i?i:y},t.deprecated=function(e){console.log("Deprecated API usage: "+e)},t.getFilenameFromUrl=function(e){var t=e.indexOf("#"),n=e.indexOf("?"),r=Math.min(t>0?t:e.length,n>0?n:e.length);return e.substring(e.lastIndexOf("/",r)+1,r)},t.isFetchSupported=I,t.isValidFetchUrl=C,t.loadScript=function(e){return new Promise((function(t,n){var r=document.createElement("script");r.src=e,r.onload=t,r.onerror=function(){n(new Error("Cannot load script at: ".concat(r.src)))},(document.head||document.documentElement).appendChild(r)}))},t.releaseImageResources=function(e){(0,s.assert)(e instanceof Image,"Invalid `img` parameter.");var t=e.src;"string"==typeof t&&t.startsWith("blob:")&&URL.revokeObjectURL&&URL.revokeObjectURL(t),e.removeAttribute("src")};var i,o=(i=n(220))&&i.__esModule?i:{default:i},s=n(1);function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=d(e);if(t){var o=d(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function h(e,t,n,r,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){h(o,r,i,s,a,"next",e)}function a(e){h(o,r,i,s,a,"throw",e)}s(void 0)}))}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),e}var y="noopener noreferrer nofollow";t.DEFAULT_LINK_REL=y;var v="http://www.w3.org/2000/svg",b=function(){function e(){p(this,e)}return m(e,[{key:"create",value:function(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");var n=document.createElement("canvas"),r=n.getContext("2d");return n.width=e,n.height=t,{canvas:n,context:r}}},{key:"reset",value:function(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}},{key:"destroy",value:function(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}}]),e}();t.DOMCanvasFactory=b;var _=function(){function e(t){var n=t.baseUrl,r=void 0===n?null:n,i=t.isCompressed,o=void 0!==i&&i;p(this,e),this.baseUrl=r,this.isCompressed=o}return m(e,[{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=f(o.default.mark((function e(t){var n,r,i,a=this;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.name,this.baseUrl){e.next=3;break}throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');case 3:if(n){e.next=5;break}throw new Error("CMap name must be specified.");case 5:if(r=this.baseUrl+n+(this.isCompressed?".bcmap":""),i=this.isCompressed?s.CMapCompressionType.BINARY:s.CMapCompressionType.NONE,!I()||!C(r,document.baseURI)){e.next=9;break}return e.abrupt("return",fetch(r).then(function(){var e=f(o.default.mark((function e(t){var n;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=2;break}throw new Error(t.statusText);case 2:if(!a.isCompressed){e.next=10;break}return e.t0=Uint8Array,e.next=6,t.arrayBuffer();case 6:e.t1=e.sent,n=new e.t0(e.t1),e.next=15;break;case 10:return e.t2=s.stringToBytes,e.next=13,t.text();case 13:e.t3=e.sent,n=(0,e.t2)(e.t3);case 15:return e.abrupt("return",{cMapData:n,compressionType:i});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){throw new Error("Unable to load ".concat(a.isCompressed?"binary ":"")+"CMap at: ".concat(r))})));case 9:return e.abrupt("return",new Promise((function(e,t){var n=new XMLHttpRequest;n.open("GET",r,!0),a.isCompressed&&(n.responseType="arraybuffer"),n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE){var r;if((200===n.status||0===n.status)&&(a.isCompressed&&n.response?r=new Uint8Array(n.response):!a.isCompressed&&n.responseText&&(r=(0,s.stringToBytes)(n.responseText)),r))return void e({cMapData:r,compressionType:i});t(new Error(n.statusText))}},n.send(null)})).catch((function(e){throw new Error("Unable to load ".concat(a.isCompressed?"binary ":"")+"CMap at: ".concat(r))})));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}())}]),e}();t.DOMCMapReaderFactory=_;var w=function(){function e(){p(this,e)}return m(e,[{key:"create",value:function(e,t){(0,s.assert)(e>0&&t>0,"Invalid SVG dimensions");var n=document.createElementNS(v,"svg:svg");return n.setAttribute("version","1.1"),n.setAttribute("width",e+"px"),n.setAttribute("height",t+"px"),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox","0 0 "+e+" "+t),n}},{key:"createElement",value:function(e){return(0,s.assert)("string"==typeof e,"Invalid SVG element type"),document.createElementNS(v,e)}}]),e}();t.DOMSVGFactory=w;var T=function(){function e(t){var n=t.viewBox,r=t.scale,i=t.rotation,o=t.offsetX,s=void 0===o?0:o,a=t.offsetY,c=void 0===a?0:a,l=t.dontFlip,u=void 0!==l&&l;p(this,e),this.viewBox=n,this.scale=r,this.rotation=i,this.offsetX=s,this.offsetY=c;var d,h,f,g,m,y,v,b,_=(n[2]+n[0])/2,w=(n[3]+n[1])/2;switch(i=(i%=360)<0?i+360:i){case 180:d=-1,h=0,f=0,g=1;break;case 90:d=0,h=1,f=1,g=0;break;case 270:d=0,h=-1,f=-1,g=0;break;default:d=1,h=0,f=0,g=-1}u&&(f=-f,g=-g),0===d?(m=Math.abs(w-n[1])*r+s,y=Math.abs(_-n[0])*r+c,v=Math.abs(n[3]-n[1])*r,b=Math.abs(n[2]-n[0])*r):(m=Math.abs(_-n[0])*r+s,y=Math.abs(w-n[1])*r+c,v=Math.abs(n[2]-n[0])*r,b=Math.abs(n[3]-n[1])*r),this.transform=[d*r,h*r,f*r,g*r,m-d*r*_-f*r*w,y-h*r*_-g*r*w],this.width=v,this.height=b}return m(e,[{key:"clone",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.scale,r=void 0===n?this.scale:n,i=t.rotation,o=void 0===i?this.rotation:i,s=t.offsetX,a=void 0===s?this.offsetX:s,c=t.offsetY,l=void 0===c?this.offsetY:c,u=t.dontFlip,d=void 0!==u&&u;return new e({viewBox:this.viewBox.slice(),scale:r,rotation:o,offsetX:a,offsetY:l,dontFlip:d})}},{key:"convertToViewportPoint",value:function(e,t){return s.Util.applyTransform([e,t],this.transform)}},{key:"convertToViewportRectangle",value:function(e){var t=s.Util.applyTransform([e[0],e[1]],this.transform),n=s.Util.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]}},{key:"convertToPdfPoint",value:function(e,t){return s.Util.applyInverseTransform([e,t],this.transform)}}]),e}();t.PageViewport=T;var E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(n,e);var t=u(n);function n(e,r){var i;return p(this,n),(i=t.call(this,e)).type=r,i}return n}(s.BaseException);t.RenderingCancelledException=E;var A={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};t.LinkTarget=A;var S,O=function(){function e(){p(this,e),this.started=Object.create(null),this.times=[]}return m(e,[{key:"time",value:function(e){e in this.started&&(0,s.warn)("Timer is already running for ".concat(e)),this.started[e]=Date.now()}},{key:"timeEnd",value:function(e){e in this.started||(0,s.warn)("Timer has not been started for ".concat(e)),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}},{key:"toString",value:function(){var e,t=[],n=0,r=a(this.times);try{for(r.s();!(e=r.n()).done;){var i=e.value.name;i.length>n&&(n=i.length)}}catch(e){r.e(e)}finally{r.f()}var o,s=a(this.times);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=c.end-c.start;t.push("".concat(c.name.padEnd(n)," ").concat(l,"ms\n"))}}catch(e){s.e(e)}finally{s.f()}return t.join("")}}]),e}();function I(){return"undefined"!=typeof fetch&&"undefined"!=typeof Response&&"body"in Response.prototype&&"undefined"!=typeof ReadableStream}function C(e,t){try{var n=(t?new URL(e,t):new URL(e)).protocol;return"http:"===n||"https:"===n}catch(e){return!1}}t.StatTimer=O;var k=function(){function e(){p(this,e)}return m(e,null,[{key:"toDateObject",value:function(e){if(!e||!(0,s.isString)(e))return null;S||(S=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));var t=S.exec(e);if(!t)return null;var n=parseInt(t[1],10),r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;var i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;var o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;var a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;var c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;var l=t[7]||"Z",u=parseInt(t[8],10);u=u>=0&&u<=23?u:0;var d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,"-"===l?(o+=u,a+=d):"+"===l&&(o-=u,a-=d),new Date(Date.UTC(n,r,i,o,a,c))}}]),e}();t.PDFDateString=k},function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var i,o=(i=n(220))&&i.__esModule?i:{default:i},s=n(1);function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=l(e);if(t){var o=l(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}function u(e,t,n,r,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}var p,g=function(){function e(t){var n=t.docId,r=t.onUnsupportedFeature;d(this,e),this.constructor===e&&(0,s.unreachable)("Cannot initialize BaseFontLoader."),this.docId=n,this._onUnsupportedFeature=r,this.nativeFontFaces=[],this.styleElement=null}var t,n;return f(e,[{key:"addNativeFontFace",value:function(e){this.nativeFontFaces.push(e),document.fonts.add(e)}},{key:"insertRule",value:function(e){var t=this.styleElement;t||((t=this.styleElement=document.createElement("style")).id="PDFJS_FONT_STYLE_TAG_".concat(this.docId),document.documentElement.getElementsByTagName("head")[0].appendChild(t));var n=t.sheet;n.insertRule(e,n.cssRules.length)}},{key:"clear",value:function(){this.nativeFontFaces.forEach((function(e){document.fonts.delete(e)})),this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}},{key:"bind",value:(t=o.default.mark((function e(t){var n,r,i=this;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.attached&&!t.missingFile){e.next=2;break}return e.abrupt("return");case 2:if(t.attached=!0,!this.isFontLoadingAPISupported){e.next=19;break}if(!(n=t.createNativeFontFace())){e.next=18;break}return this.addNativeFontFace(n),e.prev=7,e.next=10,n.loaded;case 10:e.next=18;break;case 12:throw e.prev=12,e.t0=e.catch(7),this._onUnsupportedFeature({featureId:s.UNSUPPORTED_FEATURES.font}),(0,s.warn)("Failed to load font '".concat(n.family,"': '").concat(e.t0,"'.")),t.disableFontFace=!0,e.t0;case 18:return e.abrupt("return");case 19:if(!(r=t.createFontFaceRule())){e.next=26;break}if(this.insertRule(r),!this.isSyncFontLoadingSupported){e.next=24;break}return e.abrupt("return");case 24:return e.next=26,new Promise((function(e){var n=i._queueLoadingCallback(e);i._prepareFontLoadEvent([r],[t],n)}));case 26:case"end":return e.stop()}}),e,this,[[7,12]])})),n=function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(e){u(o,r,i,s,a,"next",e)}function a(e){u(o,r,i,s,a,"throw",e)}s(void 0)}))},function(e){return n.apply(this,arguments)})},{key:"_queueLoadingCallback",value:function(e){(0,s.unreachable)("Abstract method `_queueLoadingCallback`.")}},{key:"isFontLoadingAPISupported",get:function(){var e="undefined"!=typeof document&&!!document.fonts;return(0,s.shadow)(this,"isFontLoadingAPISupported",e)}},{key:"isSyncFontLoadingSupported",get:function(){(0,s.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}},{key:"_loadTestFont",get:function(){(0,s.unreachable)("Abstract method `_loadTestFont`.")}},{key:"_prepareFontLoadEvent",value:function(e,t,n){(0,s.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}]),e}();t.FontLoader=p,t.FontLoader=p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(n,e);var t=c(n);function n(e){var r;return d(this,n),(r=t.call(this,e)).loadingContext={requests:[],nextRequestId:0},r.loadTestFontId=0,r}return f(n,[{key:"isSyncFontLoadingSupported",get:function(){var e=!1;if("undefined"==typeof navigator)e=!0;else{var t=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);t&&t[1]>=14&&(e=!0)}return(0,s.shadow)(this,"isSyncFontLoadingSupported",e)}},{key:"_queueLoadingCallback",value:function(e){var t=this.loadingContext,n={id:"pdfjs-font-loading-".concat(t.nextRequestId++),done:!1,complete:function(){for((0,s.assert)(!n.done,"completeRequest() cannot be called twice."),n.done=!0;t.requests.length>0&&t.requests[0].done;){var e=t.requests.shift();setTimeout(e.callback,0)}},callback:e};return t.requests.push(n),n}},{key:"_loadTestFont",get:function(){return(0,s.shadow)(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}},{key:"_prepareFontLoadEvent",value:function(e,t,n){function r(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function i(e,t,n,r){return e.substring(0,t)+r+e.substring(t+n)}var o,a,c=document.createElement("canvas");c.width=1,c.height=1;var l=c.getContext("2d"),u=0,d="lt".concat(Date.now()).concat(this.loadTestFontId++),h=this._loadTestFont,f=1482184792,p=r(h=i(h,976,d.length,d),16);for(o=0,a=d.length-3;o<a;o+=4)p=p-f+r(d,o)|0;o<d.length&&(p=p-f+r(d+"XXX",o)|0),h=i(h,16,4,(0,s.string32)(p));var g="url(data:font/opentype;base64,".concat(btoa(h),");"),m='@font-face {font-family:"'.concat(d,'";src:').concat(g,"}");this.insertRule(m);var y=[];for(o=0,a=t.length;o<a;o++)y.push(t[o].loadedName);y.push(d);var v=document.createElement("div");for(v.style.visibility="hidden",v.style.width=v.style.height="10px",v.style.position="absolute",v.style.top=v.style.left="0px",o=0,a=y.length;o<a;++o){var b=document.createElement("span");b.textContent="Hi",b.style.fontFamily=y[o],v.appendChild(b)}document.body.appendChild(v),function e(t,n){if(++u>30)return(0,s.warn)("Load test font never loaded."),void n();l.font="30px "+t,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0?n():setTimeout(e.bind(null,t,n))}(d,(function(){document.body.removeChild(v),n.complete()}))}}]),n}(g);var m=function(){function e(t,n){var r=n.isEvalSupported,i=void 0===r||r,o=n.disableFontFace,s=void 0!==o&&o,a=n.ignoreErrors,c=void 0!==a&&a,l=n.onUnsupportedFeature,u=void 0===l?null:l,h=n.fontRegistry,f=void 0===h?null:h;for(var p in d(this,e),this.compiledGlyphs=Object.create(null),t)this[p]=t[p];this.isEvalSupported=!1!==i,this.disableFontFace=!0===s,this.ignoreErrors=!0===c,this._onUnsupportedFeature=u,this.fontRegistry=f}return f(e,[{key:"createNativeFontFace",value:function(){if(!this.data||this.disableFontFace)return null;var e=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),e}},{key:"createFontFaceRule",value:function(){if(!this.data||this.disableFontFace)return null;var e=(0,s.bytesToString)(new Uint8Array(this.data)),t="url(data:".concat(this.mimetype,";base64,").concat(btoa(e),");"),n='@font-face {font-family:"'.concat(this.loadedName,'";src:').concat(t,"}");return this.fontRegistry&&this.fontRegistry.registerFont(this,t),n}},{key:"getPathGenerator",value:function(e,t){if(void 0!==this.compiledGlyphs[t])return this.compiledGlyphs[t];var n,r;try{n=e.get(this.loadedName+"_path_"+t)}catch(e){if(!this.ignoreErrors)throw e;return this._onUnsupportedFeature&&this._onUnsupportedFeature({featureId:s.UNSUPPORTED_FEATURES.font}),(0,s.warn)('getPathGenerator - ignoring character: "'.concat(e,'".')),this.compiledGlyphs[t]=function(e,t){}}if(this.isEvalSupported&&s.IsEvalSupportedCached.value){for(var i,o="",a=0,c=n.length;a<c;a++)i=void 0!==(r=n[a]).args?r.args.join(","):"",o+="c."+r.cmd+"("+i+");\n";return this.compiledGlyphs[t]=new Function("c","size",o)}return this.compiledGlyphs[t]=function(e,t){for(var i=0,o=n.length;i<o;i++)"scale"===(r=n[i]).cmd&&(r.args=[t,-t]),e[r.cmd].apply(e,r.args)}}}]),e}();t.FontFaceObject=m},function(e,t,n){"use strict";var r=Object.create(null),i=n(65).isNodeJS,o="undefined"!=typeof navigator&&navigator.userAgent||"",s=/Trident/.test(o),a=/CriOS/.test(o);(s||a)&&(r.disableCreateObjectURL=!0),i&&(r.disableFontFace=!0,r.nativeImageDecoderSupport="none"),t.apiCompatibilityParams=Object.freeze(r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var r=n(1),i=n(227);function o(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw o}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=4096,c=.65,l=16;function u(e){e.mozCurrentTransform||(e._originalSave=e.save,e._originalRestore=e.restore,e._originalRotate=e.rotate,e._originalScale=e.scale,e._originalTranslate=e.translate,e._originalTransform=e.transform,e._originalSetTransform=e.setTransform,e._transformMatrix=e._transformMatrix||[1,0,0,1,0,0],e._transformStack=[],Object.defineProperty(e,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(e,"mozCurrentTransformInverse",{get:function(){var e=this._transformMatrix,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],s=e[5],a=t*i-n*r,c=n*r-t*i;return[i/a,n/c,r/c,t/a,(i*o-r*s)/c,(n*o-t*s)/a]}}),e.save=function(){var e=this._transformMatrix;this._transformStack.push(e),this._transformMatrix=e.slice(0,6),this._originalSave()},e.restore=function(){var e=this._transformStack.pop();e&&(this._transformMatrix=e,this._originalRestore())},e.translate=function(e,t){var n=this._transformMatrix;n[4]=n[0]*e+n[2]*t+n[4],n[5]=n[1]*e+n[3]*t+n[5],this._originalTranslate(e,t)},e.scale=function(e,t){var n=this._transformMatrix;n[0]=n[0]*e,n[1]=n[1]*e,n[2]=n[2]*t,n[3]=n[3]*t,this._originalScale(e,t)},e.transform=function(t,n,r,i,o,s){var a=this._transformMatrix;this._transformMatrix=[a[0]*t+a[2]*n,a[1]*t+a[3]*n,a[0]*r+a[2]*i,a[1]*r+a[3]*i,a[0]*o+a[2]*s+a[4],a[1]*o+a[3]*s+a[5]],e._originalTransform(t,n,r,i,o,s)},e.setTransform=function(t,n,r,i,o,s){this._transformMatrix=[t,n,r,i,o,s],e._originalSetTransform(t,n,r,i,o,s)},e.rotate=function(e){var t=Math.cos(e),n=Math.sin(e),r=this._transformMatrix;this._transformMatrix=[r[0]*t+r[2]*n,r[1]*t+r[3]*n,r[0]*-n+r[2]*t,r[1]*-n+r[3]*t,r[4],r[5]],this._originalRotate(e)})}var d=function(){function e(e){this.canvasFactory=e,this.cache=Object.create(null)}return e.prototype={getCanvas:function(e,t,n,r){var i;return void 0!==this.cache[e]?(i=this.cache[e],this.canvasFactory.reset(i,t,n),i.context.setTransform(1,0,0,1,0,0)):(i=this.canvasFactory.create(t,n),this.cache[e]=i),r&&u(i.context),i},clear:function(){for(var e in this.cache){var t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}},e}(),h=function(){function e(){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=r.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=r.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=r.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.resumeSMaskCtx=null}return e.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(e,t){this.x=e,this.y=t}},e}(),f=function(){function e(e,t,n,r,i,o){this.ctx=e,this.current=new h,this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=r,this.webGLContext=i,this.imageLayer=o,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.cachedCanvases=new d(this.canvasFactory),e&&u(e),this._cachedGetSinglePixelWidth=null}function t(e,t){if("undefined"!=typeof ImageData&&t instanceof ImageData)e.putImageData(t,0,0);else{var n,i,o,s,a,c=t.height,u=t.width,d=c%l,h=(c-d)/l,f=0===d?h:h+1,p=e.createImageData(u,l),g=0,m=t.data,y=p.data;if(t.kind===r.ImageKind.GRAYSCALE_1BPP){var v=m.byteLength,b=new Uint32Array(y.buffer,0,y.byteLength>>2),_=b.length,w=u+7>>3,T=4294967295,E=r.IsLittleEndianCached.value?4278190080:255;for(i=0;i<f;i++){for(s=i<h?l:d,n=0,o=0;o<s;o++){for(var A=v-g,S=0,O=A>w?u:8*A-7,I=-8&O,C=0,k=0;S<I;S+=8)k=m[g++],b[n++]=128&k?T:E,b[n++]=64&k?T:E,b[n++]=32&k?T:E,b[n++]=16&k?T:E,b[n++]=8&k?T:E,b[n++]=4&k?T:E,b[n++]=2&k?T:E,b[n++]=1&k?T:E;for(;S<O;S++)0===C&&(k=m[g++],C=128),b[n++]=k&C?T:E,C>>=1}for(;n<_;)b[n++]=0;e.putImageData(p,0,i*l)}}else if(t.kind===r.ImageKind.RGBA_32BPP){for(o=0,a=u*l*4,i=0;i<h;i++)y.set(m.subarray(g,g+a)),g+=a,e.putImageData(p,0,o),o+=l;i<f&&(a=u*d*4,y.set(m.subarray(g,g+a)),e.putImageData(p,0,o))}else{if(t.kind!==r.ImageKind.RGB_24BPP)throw new Error("bad image kind: ".concat(t.kind));for(a=u*(s=l),i=0;i<f;i++){for(i>=h&&(a=u*(s=d)),n=0,o=a;o--;)y[n++]=m[g++],y[n++]=m[g++],y[n++]=m[g++],y[n++]=255;e.putImageData(p,0,i*l)}}}}function n(e,t){for(var n=t.height,r=t.width,i=n%l,o=(n-i)/l,s=0===i?o:o+1,a=e.createImageData(r,l),c=0,u=t.data,d=a.data,h=0;h<s;h++){for(var f=h<o?l:i,p=3,g=0;g<f;g++)for(var m=0,y=0;y<r;y++){if(!m){var v=u[c++];m=128}d[p]=v&m?0:255,p+=4,m>>=1}e.putImageData(a,0,h*l)}}function s(e,t){for(var n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"],r=0,i=n.length;r<i;r++){var o=n[r];void 0!==e[o]&&(t[o]=e[o])}void 0!==e.setLineDash&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function f(e){e.strokeStyle="#000000",e.fillStyle="#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",void 0!==e.setLineDash&&(e.setLineDash([]),e.lineDashOffset=0)}function p(e,t,n,r){for(var i=e.length,o=3;o<i;o+=4){var s=e[o];if(0===s)e[o-3]=t,e[o-2]=n,e[o-1]=r;else if(s<255){var a=255-s;e[o-3]=e[o-3]*s+t*a>>8,e[o-2]=e[o-2]*s+n*a>>8,e[o-1]=e[o-1]*s+r*a>>8}}}function g(e,t,n){for(var r=e.length,i=1/255,o=3;o<r;o+=4){var s=n?n[e[o]]:e[o];t[o]=t[o]*s*i|0}}function m(e,t,n){for(var r=e.length,i=3;i<r;i+=4){var o=77*e[i-3]+152*e[i-2]+28*e[i-1];t[i]=n?t[i]*n[o>>8]>>8:t[i]*o>>16}}function y(e,t,n,r){var i=t.canvas,o=t.context;e.setTransform(t.scaleX,0,0,t.scaleY,t.offsetX,t.offsetY);var s=t.backdrop||null;if(!t.transferMap&&r.isEnabled){var a=r.composeSMask({layer:n.canvas,mask:i,properties:{subtype:t.subtype,backdrop:s}});return e.setTransform(1,0,0,1,0,0),void e.drawImage(a,t.offsetX,t.offsetY)}!function(e,t,n,r,i,o,s){var a,c=!!o,l=c?o[0]:0,u=c?o[1]:0,d=c?o[2]:0;a="Luminosity"===i?m:g;for(var h=Math.min(r,Math.ceil(1048576/n)),f=0;f<r;f+=h){var y=Math.min(h,r-f),v=e.getImageData(0,f,n,y),b=t.getImageData(0,f,n,y);c&&p(v.data,l,u,d),a(v.data,b.data,s),e.putImageData(b,0,f)}}(o,n,i.width,i.height,t.subtype,s,t.transferMap),e.drawImage(i,0,0)}var v=["butt","round","square"],b=["miter","round","bevel"],_={},w={};for(var T in e.prototype={beginDrawing:function(e){var t=e.transform,n=e.viewport,r=e.transparency,i=void 0!==r&&r,o=e.background,s=void 0===o?null:o,a=this.ctx.canvas.width,c=this.ctx.canvas.height;if(this.ctx.save(),this.ctx.fillStyle=s||"rgb(255, 255, 255)",this.ctx.fillRect(0,0,a,c),this.ctx.restore(),i){var l=this.cachedCanvases.getCanvas("transparent",a,c,!0);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),f(this.ctx),t&&this.ctx.transform.apply(this.ctx,t),this.ctx.transform.apply(this.ctx,n.transform),this.baseTransform=this.ctx.mozCurrentTransform.slice(),this.imageLayer&&this.imageLayer.beginLayout()},executeOperatorList:function(e,t,n,i){var s=e.argsArray,a=e.fnArray,c=t||0,l=s.length;if(l===c)return c;for(var u,d=l-c>10&&"function"==typeof n,h=d?Date.now()+15:0,f=0,p=this.commonObjs,g=this.objs;;){if(void 0!==i&&c===i.nextBreakPoint)return i.breakIt(c,n),c;if((u=a[c])!==r.OPS.dependency)this[u].apply(this,s[c]);else{var m,y=o(s[c]);try{for(y.s();!(m=y.n()).done;){var v=m.value,b=v.startsWith("g_")?p:g;if(!b.has(v))return b.get(v,n),c}}catch(e){y.e(e)}finally{y.f()}}if(++c===l)return c;if(d&&++f>10){if(Date.now()>h)return n(),c;f=0}}},endDrawing:function(){null!==this.current.activeSMask&&this.endSMaskGroup(),this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),this.webGLContext.clear(),this.imageLayer&&this.imageLayer.endLayout()},setLineWidth:function(e){this.current.lineWidth=e,this.ctx.lineWidth=e},setLineCap:function(e){this.ctx.lineCap=v[e]},setLineJoin:function(e){this.ctx.lineJoin=b[e]},setMiterLimit:function(e){this.ctx.miterLimit=e},setDash:function(e,t){var n=this.ctx;void 0!==n.setLineDash&&(n.setLineDash(e),n.lineDashOffset=t)},setRenderingIntent:function(e){},setFlatness:function(e){},setGState:function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t],i=r[0],o=r[1];switch(i){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"RI":this.setRenderingIntent(o);break;case"FL":this.setFlatness(o);break;case"Font":this.setFont(o[0],o[1]);break;case"CA":this.current.strokeAlpha=r[1];break;case"ca":this.current.fillAlpha=r[1],this.ctx.globalAlpha=r[1];break;case"BM":this.ctx.globalCompositeOperation=o;break;case"SMask":this.current.activeSMask&&(this.stateStack.length>0&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask?this.suspendSMaskGroup():this.endSMaskGroup()),this.current.activeSMask=o?this.tempSMask:null,this.current.activeSMask&&this.beginSMaskGroup(),this.tempSMask=null}}},beginSMaskGroup:function(){var e=this.current.activeSMask,t=e.canvas.width,n=e.canvas.height,r="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(r,t,n,!0),o=this.ctx,a=o.mozCurrentTransform;this.ctx.save();var c=i.context;c.scale(1/e.scaleX,1/e.scaleY),c.translate(-e.offsetX,-e.offsetY),c.transform.apply(c,a),e.startTransformInverse=c.mozCurrentTransformInverse,s(o,c),this.ctx=c,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(o),this.groupLevel++},suspendSMaskGroup:function(){var e=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),y(this.ctx,this.current.activeSMask,e,this.webGLContext),this.ctx.restore(),this.ctx.save(),s(e,this.ctx),this.current.resumeSMaskCtx=e;var t=r.Util.transform(this.current.activeSMask.startTransformInverse,e.mozCurrentTransform);this.ctx.transform.apply(this.ctx,t),e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.restore()},resumeSMaskGroup:function(){var e=this.current.resumeSMaskCtx,t=this.ctx;this.ctx=e,this.groupStack.push(t),this.groupLevel++},endSMaskGroup:function(){var e=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),y(this.ctx,this.current.activeSMask,e,this.webGLContext),this.ctx.restore(),s(e,this.ctx);var t=r.Util.transform(this.current.activeSMask.startTransformInverse,e.mozCurrentTransform);this.ctx.transform.apply(this.ctx,t)},save:function(){this.ctx.save();var e=this.current;this.stateStack.push(e),this.current=e.clone(),this.current.resumeSMaskCtx=null},restore:function(){this.current.resumeSMaskCtx&&this.resumeSMaskGroup(),null===this.current.activeSMask||0!==this.stateStack.length&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask||this.endSMaskGroup(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.ctx.restore(),this.pendingClip=null,this._cachedGetSinglePixelWidth=null)},transform:function(e,t,n,r,i,o){this.ctx.transform(e,t,n,r,i,o),this._cachedGetSinglePixelWidth=null},constructPath:function(e,t){for(var n=this.ctx,i=this.current,o=i.x,s=i.y,a=0,c=0,l=e.length;a<l;a++)switch(0|e[a]){case r.OPS.rectangle:o=t[c++],s=t[c++];var u=t[c++],d=t[c++];0===u&&(u=this.getSinglePixelWidth()),0===d&&(d=this.getSinglePixelWidth());var h=o+u,f=s+d;this.ctx.moveTo(o,s),this.ctx.lineTo(h,s),this.ctx.lineTo(h,f),this.ctx.lineTo(o,f),this.ctx.lineTo(o,s),this.ctx.closePath();break;case r.OPS.moveTo:o=t[c++],s=t[c++],n.moveTo(o,s);break;case r.OPS.lineTo:o=t[c++],s=t[c++],n.lineTo(o,s);break;case r.OPS.curveTo:o=t[c+4],s=t[c+5],n.bezierCurveTo(t[c],t[c+1],t[c+2],t[c+3],o,s),c+=6;break;case r.OPS.curveTo2:n.bezierCurveTo(o,s,t[c],t[c+1],t[c+2],t[c+3]),o=t[c+2],s=t[c+3],c+=4;break;case r.OPS.curveTo3:o=t[c+2],s=t[c+3],n.bezierCurveTo(t[c],t[c+1],o,s,o,s),c+=4;break;case r.OPS.closePath:n.closePath()}i.setCurrentPoint(o,s)},closePath:function(){this.ctx.closePath()},stroke:function(e){e=void 0===e||e;var t=this.ctx,n=this.current.strokeColor;if(t.globalAlpha=this.current.strokeAlpha,n&&n.hasOwnProperty("type")&&"Pattern"===n.type){t.save();var i=t.mozCurrentTransform,o=r.Util.singularValueDecompose2dScale(i)[0];t.strokeStyle=n.getPattern(t,this),t.lineWidth=Math.max(this.getSinglePixelWidth()*c,this.current.lineWidth*o),t.stroke(),t.restore()}else t.lineWidth=Math.max(this.getSinglePixelWidth()*c,this.current.lineWidth),t.stroke();e&&this.consumePath(),t.globalAlpha=this.current.fillAlpha},closeStroke:function(){this.closePath(),this.stroke()},fill:function(e){e=void 0===e||e;var t=this.ctx,n=this.current.fillColor,r=!1;this.current.patternFill&&(t.save(),this.baseTransform&&t.setTransform.apply(t,this.baseTransform),t.fillStyle=n.getPattern(t,this),r=!0),this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill(),r&&t.restore(),e&&this.consumePath()},eoFill:function(){this.pendingEOFill=!0,this.fill()},fillStroke:function(){this.fill(!1),this.stroke(!1),this.consumePath()},eoFillStroke:function(){this.pendingEOFill=!0,this.fillStroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},closeEOFillStroke:function(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()},endPath:function(){this.consumePath()},clip:function(){this.pendingClip=_},eoClip:function(){this.pendingClip=w},beginText:function(){this.current.textMatrix=r.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},endText:function(){var e=this.pendingTextPaths,t=this.ctx;if(void 0!==e){t.save(),t.beginPath();for(var n=0;n<e.length;n++){var r=e[n];t.setTransform.apply(t,r.transform),t.translate(r.x,r.y),r.addToPath(t,r.fontSize)}t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}else t.beginPath()},setCharSpacing:function(e){this.current.charSpacing=e},setWordSpacing:function(e){this.current.wordSpacing=e},setHScale:function(e){this.current.textHScale=e/100},setLeading:function(e){this.current.leading=-e},setFont:function(e,t){var n=this.commonObjs.get(e),i=this.current;if(!n)throw new Error("Can't find font for ".concat(e));if(i.fontMatrix=n.fontMatrix?n.fontMatrix:r.FONT_IDENTITY_MATRIX,0!==i.fontMatrix[0]&&0!==i.fontMatrix[3]||(0,r.warn)("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=n,this.current.fontSize=t,!n.isType3Font){var o=n.loadedName||"sans-serif",s="normal";n.black?s="900":n.bold&&(s="bold");var a=n.italic?"italic":"normal",c='"'.concat(o,'", ').concat(n.fallbackName),l=t;t<16?l=16:t>100&&(l=100),this.current.fontSizeScale=t/l,this.ctx.font="".concat(a," ").concat(s," ").concat(l,"px ").concat(c)}},setTextRenderingMode:function(e){this.current.textRenderingMode=e},setTextRise:function(e){this.current.textRise=e},moveText:function(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t},setLeadingMoveText:function(e,t){this.setLeading(-t),this.moveText(e,t)},setTextMatrix:function(e,t,n,r,i,o){this.current.textMatrix=[e,t,n,r,i,o],this.current.textMatrixScale=Math.sqrt(e*e+t*t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},nextLine:function(){this.moveText(0,this.current.leading)},paintChar:function(e,t,n,i){var o,s=this.ctx,a=this.current,c=a.font,l=a.textRenderingMode,u=a.fontSize/a.fontSizeScale,d=l&r.TextRenderingMode.FILL_STROKE_MASK,h=!!(l&r.TextRenderingMode.ADD_TO_PATH_FLAG),f=a.patternFill&&c.data;(c.disableFontFace||h||f)&&(o=c.getPathGenerator(this.commonObjs,e)),c.disableFontFace||f?(s.save(),s.translate(t,n),s.beginPath(),o(s,u),i&&s.setTransform.apply(s,i),d!==r.TextRenderingMode.FILL&&d!==r.TextRenderingMode.FILL_STROKE||s.fill(),d!==r.TextRenderingMode.STROKE&&d!==r.TextRenderingMode.FILL_STROKE||s.stroke(),s.restore()):(d!==r.TextRenderingMode.FILL&&d!==r.TextRenderingMode.FILL_STROKE||s.fillText(e,t,n),d!==r.TextRenderingMode.STROKE&&d!==r.TextRenderingMode.FILL_STROKE||s.strokeText(e,t,n)),h&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:s.mozCurrentTransform,x:t,y:n,fontSize:u,addToPath:o})},get isFontSubpixelAAEnabled(){var e=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10).context;e.scale(1.5,1),e.fillText("I",0,10);for(var t=e.getImageData(0,0,10,10).data,n=!1,i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){n=!0;break}return(0,r.shadow)(this,"isFontSubpixelAAEnabled",n)},showText:function(e){var t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);var i=t.fontSize;if(0!==i){var o,s=this.ctx,a=t.fontSizeScale,l=t.charSpacing,u=t.wordSpacing,d=t.fontDirection,h=t.textHScale*d,f=e.length,p=n.vertical,g=p?1:-1,m=n.defaultVMetrics,y=i*t.fontMatrix[0],v=t.textRenderingMode===r.TextRenderingMode.FILL&&!n.disableFontFace&&!t.patternFill;if(s.save(),t.patternFill){s.save();var b=t.fillColor.getPattern(s,this);o=s.mozCurrentTransform,s.restore(),s.fillStyle=b}s.transform.apply(s,t.textMatrix),s.translate(t.x,t.y+t.textRise),d>0?s.scale(h,-1):s.scale(h,1);var _=t.lineWidth,w=t.textMatrixScale;if(0===w||0===_){var T=t.textRenderingMode&r.TextRenderingMode.FILL_STROKE_MASK;T!==r.TextRenderingMode.STROKE&&T!==r.TextRenderingMode.FILL_STROKE||(this._cachedGetSinglePixelWidth=null,_=this.getSinglePixelWidth()*c)}else _/=w;1!==a&&(s.scale(a,a),_/=a),s.lineWidth=_;var E,A=0;for(E=0;E<f;++E){var S=e[E];if((0,r.isNum)(S))A+=g*S*i/1e3;else{var O,I,C,k,P,x,R,L=!1,D=(S.isSpace?u:0)+l,N=S.fontChar,j=S.accent,M=S.width;if(p?(P=S.vmetric||m,x=-(x=S.vmetric?P[1]:.5*M)*y,R=P[2]*y,M=P?-P[0]:M,O=x/a,I=(A+R)/a):(O=A/a,I=0),n.remeasure&&M>0){var F=1e3*s.measureText(N).width/i*a;if(M<F&&this.isFontSubpixelAAEnabled){var U=M/F;L=!0,s.save(),s.scale(U,1),O/=U}else M!==F&&(O+=(M-F)/2e3*i/a)}(S.isInFont||n.missingFile)&&(v&&!j?s.fillText(N,O,I):(this.paintChar(N,O,I,o),j&&(C=O+j.offset.x/a,k=I-j.offset.y/a,this.paintChar(j.fontChar,C,k,o)))),A+=p?M*y-D*d:M*y+D*d,L&&s.restore()}}p?t.y-=A:t.x+=A*h,s.restore()}},showType3Text:function(e){var t,n,i,o,s=this.ctx,a=this.current,c=a.font,l=a.fontSize,u=a.fontDirection,d=c.vertical?1:-1,h=a.charSpacing,f=a.wordSpacing,p=a.textHScale*u,g=a.fontMatrix||r.FONT_IDENTITY_MATRIX,m=e.length;if(a.textRenderingMode!==r.TextRenderingMode.INVISIBLE&&0!==l){for(this._cachedGetSinglePixelWidth=null,s.save(),s.transform.apply(s,a.textMatrix),s.translate(a.x,a.y),s.scale(p,u),t=0;t<m;++t)if(n=e[t],(0,r.isNum)(n))o=d*n*l/1e3,this.ctx.translate(o,0),a.x+=o*p;else{var y=(n.isSpace?f:0)+h,v=c.charProcOperatorList[n.operatorListId];v?(this.processingType3=n,this.save(),s.scale(l,l),s.transform.apply(s,g),this.executeOperatorList(v),this.restore(),i=r.Util.applyTransform([n.width,0],g)[0]*l+y,s.translate(i,0),a.x+=i*p):(0,r.warn)('Type3 character "'.concat(n.operatorListId,'" is not available.'))}s.restore(),this.processingType3=null}},setCharWidth:function(e,t){},setCharWidthAndBounds:function(e,t,n,r,i,o){this.ctx.rect(n,r,i-n,o-r),this.clip(),this.endPath()},getColorN_Pattern:function(t){var n,r=this;if("TilingPattern"===t[0]){var o=t[1],s=this.baseTransform||this.ctx.mozCurrentTransform.slice(),a={createCanvasGraphics:function(t){return new e(t,r.commonObjs,r.objs,r.canvasFactory,r.webGLContext)}};n=new i.TilingPattern(t,o,this.ctx,a,s)}else n=(0,i.getShadingPatternFromIR)(t);return n},setStrokeColorN:function(){this.current.strokeColor=this.getColorN_Pattern(arguments)},setFillColorN:function(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0},setStrokeRGBColor:function(e,t,n){var i=r.Util.makeCssRgb(e,t,n);this.ctx.strokeStyle=i,this.current.strokeColor=i},setFillRGBColor:function(e,t,n){var i=r.Util.makeCssRgb(e,t,n);this.ctx.fillStyle=i,this.current.fillColor=i,this.current.patternFill=!1},shadingFill:function(e){var t=this.ctx;this.save();var n=(0,i.getShadingPatternFromIR)(e);t.fillStyle=n.getPattern(t,this,!0);var o=t.mozCurrentTransformInverse;if(o){var s=t.canvas,a=s.width,c=s.height,l=r.Util.applyTransform([0,0],o),u=r.Util.applyTransform([0,c],o),d=r.Util.applyTransform([a,0],o),h=r.Util.applyTransform([a,c],o),f=Math.min(l[0],u[0],d[0],h[0]),p=Math.min(l[1],u[1],d[1],h[1]),g=Math.max(l[0],u[0],d[0],h[0]),m=Math.max(l[1],u[1],d[1],h[1]);this.ctx.fillRect(f,p,g-f,m-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.restore()},beginInlineImage:function(){(0,r.unreachable)("Should not call beginInlineImage")},beginImageData:function(){(0,r.unreachable)("Should not call beginImageData")},paintFormXObjectBegin:function(e,t){if(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(e)&&6===e.length&&this.transform.apply(this,e),this.baseTransform=this.ctx.mozCurrentTransform,t){var n=t[2]-t[0],r=t[3]-t[1];this.ctx.rect(t[0],t[1],n,r),this.clip(),this.endPath()}},paintFormXObjectEnd:function(){this.restore(),this.baseTransform=this.baseTransformStack.pop()},beginGroup:function(e){this.save();var t=this.ctx;e.isolated||(0,r.info)("TODO: Support non-isolated groups."),e.knockout&&(0,r.warn)("Knockout groups not supported.");var n=t.mozCurrentTransform;if(e.matrix&&t.transform.apply(t,e.matrix),!e.bbox)throw new Error("Bounding box is required.");var i=r.Util.getAxialAlignedBoundingBox(e.bbox,t.mozCurrentTransform),o=[0,0,t.canvas.width,t.canvas.height];i=r.Util.intersect(i,o)||[0,0,0,0];var c=Math.floor(i[0]),l=Math.floor(i[1]),u=Math.max(Math.ceil(i[2])-c,1),d=Math.max(Math.ceil(i[3])-l,1),h=1,f=1;u>a&&(h=u/a,u=a),d>a&&(f=d/a,d=a);var p="groupAt"+this.groupLevel;e.smask&&(p+="_smask_"+this.smaskCounter++%2);var g=this.cachedCanvases.getCanvas(p,u,d,!0),m=g.context;m.scale(1/h,1/f),m.translate(-c,-l),m.transform.apply(m,n),e.smask?this.smaskStack.push({canvas:g.canvas,context:m,offsetX:c,offsetY:l,scaleX:h,scaleY:f,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(c,l),t.scale(h,f)),s(t,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++,this.current.activeSMask=null},endGroup:function(e){this.groupLevel--;var t=this.ctx;this.ctx=this.groupStack.pop(),void 0!==this.ctx.imageSmoothingEnabled?this.ctx.imageSmoothingEnabled=!1:this.ctx.mozImageSmoothingEnabled=!1,e.smask?this.tempSMask=this.smaskStack.pop():this.ctx.drawImage(t.canvas,0,0),this.restore()},beginAnnotations:function(){this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)},endAnnotations:function(){this.restore()},beginAnnotation:function(e,t,n){if(this.save(),f(this.ctx),this.current=new h,Array.isArray(e)&&4===e.length){var r=e[2]-e[0],i=e[3]-e[1];this.ctx.rect(e[0],e[1],r,i),this.clip(),this.endPath()}this.transform.apply(this,t),this.transform.apply(this,n)},endAnnotation:function(){this.restore()},paintJpegXObject:function(e,t,n){var i=this.processingType3?this.commonObjs.get(e):this.objs.get(e);if(i){this.save();var o=this.ctx;if(o.scale(1/t,-1/n),o.drawImage(i,0,0,i.width,i.height,0,-n,t,n),this.imageLayer){var s=o.mozCurrentTransformInverse,a=this.getCanvasPosition(0,0);this.imageLayer.appendImage({objId:e,left:a[0],top:a[1],width:t/s[0],height:n/s[3]})}this.restore()}else(0,r.warn)("Dependent image isn't ready yet")},paintImageMaskXObject:function(e){var t=this.ctx,r=e.width,i=e.height,o=this.current.fillColor,s=this.current.patternFill,a=this.processingType3;if(a&&void 0===a.compiled&&(a.compiled=r<=1e3&&i<=1e3?function(e){var t,n,r,i,o=e.width,s=e.height,a=o+1,c=new Uint8Array(a*(s+1)),l=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),u=o+7&-8,d=e.data,h=new Uint8Array(u*s),f=0;for(t=0,i=d.length;t<i;t++)for(var p=128,g=d[t];p>0;)h[f++]=g&p?0:255,p>>=1;var m=0;for(0!==h[f=0]&&(c[0]=1,++m),n=1;n<o;n++)h[f]!==h[f+1]&&(c[n]=h[f]?2:1,++m),f++;for(0!==h[f]&&(c[n]=2,++m),t=1;t<s;t++){r=t*a,h[(f=t*u)-u]!==h[f]&&(c[r]=h[f]?1:8,++m);var y=(h[f]?4:0)+(h[f-u]?8:0);for(n=1;n<o;n++)l[y=(y>>2)+(h[f+1]?4:0)+(h[f-u+1]?8:0)]&&(c[r+n]=l[y],++m),f++;if(h[f-u]!==h[f]&&(c[r+n]=h[f]?2:4,++m),m>1e3)return null}for(r=t*a,0!==h[f=u*(s-1)]&&(c[r]=8,++m),n=1;n<o;n++)h[f]!==h[f+1]&&(c[r+n]=h[f]?4:8,++m),f++;if(0!==h[f]&&(c[r+n]=4,++m),m>1e3)return null;var v=new Int32Array([0,a,-1,0,-a,0,0,0,1]),b=[];for(t=0;m&&t<=s;t++){for(var _=t*a,w=_+o;_<w&&!c[_];)_++;if(_!==w){var T,E=[_%a,t],A=c[_],S=_;do{var O=v[A];do{_+=O}while(!c[_]);5!==(T=c[_])&&10!==T?(A=T,c[_]=0):(A=T&51*A>>4,c[_]&=A>>2|A<<2),E.push(_%a),E.push(_/a|0),c[_]||--m}while(S!==_);b.push(E),--t}}return function(e){e.save(),e.scale(1/o,-1/s),e.translate(0,-s),e.beginPath();for(var t=0,n=b.length;t<n;t++){var r=b[t];e.moveTo(r[0],r[1]);for(var i=2,a=r.length;i<a;i+=2)e.lineTo(r[i],r[i+1])}e.fill(),e.beginPath(),e.restore()}}({data:e.data,width:r,height:i}):null),a&&a.compiled)a.compiled(t);else{var c=this.cachedCanvases.getCanvas("maskCanvas",r,i),l=c.context;l.save(),n(l,e),l.globalCompositeOperation="source-in",l.fillStyle=s?o.getPattern(l,this):o,l.fillRect(0,0,r,i),l.restore(),this.paintInlineImageXObject(c.canvas)}},paintImageMaskXObjectRepeat:function(e,t,r,i){var o=e.width,s=e.height,a=this.current.fillColor,c=this.current.patternFill,l=this.cachedCanvases.getCanvas("maskCanvas",o,s),u=l.context;u.save(),n(u,e),u.globalCompositeOperation="source-in",u.fillStyle=c?a.getPattern(u,this):a,u.fillRect(0,0,o,s),u.restore();for(var d=this.ctx,h=0,f=i.length;h<f;h+=2)d.save(),d.transform(t,0,0,r,i[h],i[h+1]),d.scale(1,-1),d.drawImage(l.canvas,0,0,o,s,0,-1,1,1),d.restore()},paintImageMaskXObjectGroup:function(e){for(var t=this.ctx,r=this.current.fillColor,i=this.current.patternFill,o=0,s=e.length;o<s;o++){var a=e[o],c=a.width,l=a.height,u=this.cachedCanvases.getCanvas("maskCanvas",c,l),d=u.context;d.save(),n(d,a),d.globalCompositeOperation="source-in",d.fillStyle=i?r.getPattern(d,this):r,d.fillRect(0,0,c,l),d.restore(),t.save(),t.transform.apply(t,a.transform),t.scale(1,-1),t.drawImage(u.canvas,0,0,c,l,0,-1,1,1),t.restore()}},paintImageXObject:function(e){var t=this.processingType3?this.commonObjs.get(e):this.objs.get(e);t?this.paintInlineImageXObject(t):(0,r.warn)("Dependent image isn't ready yet")},paintImageXObjectRepeat:function(e,t,n,i){var o=this.processingType3?this.commonObjs.get(e):this.objs.get(e);if(o){for(var s=o.width,a=o.height,c=[],l=0,u=i.length;l<u;l+=2)c.push({transform:[t,0,0,n,i[l],i[l+1]],x:0,y:0,w:s,h:a});this.paintInlineImageXObjectGroup(o,c)}else(0,r.warn)("Dependent image isn't ready yet")},paintInlineImageXObject:function(e){var n=e.width,r=e.height,i=this.ctx;this.save(),i.scale(1/n,-1/r);var o,s,a=i.mozCurrentTransformInverse,c=a[0],l=a[1],u=Math.max(Math.sqrt(c*c+l*l),1),d=a[2],h=a[3],f=Math.max(Math.sqrt(d*d+h*h),1);if("function"==typeof HTMLElement&&e instanceof HTMLElement||!e.data)o=e;else{var p=(s=this.cachedCanvases.getCanvas("inlineImage",n,r)).context;t(p,e),o=s.canvas}for(var g=n,m=r,y="prescale1";u>2&&g>1||f>2&&m>1;){var v=g,b=m;u>2&&g>1&&(u/=g/(v=Math.ceil(g/2))),f>2&&m>1&&(f/=m/(b=Math.ceil(m/2))),(p=(s=this.cachedCanvases.getCanvas(y,v,b)).context).clearRect(0,0,v,b),p.drawImage(o,0,0,g,m,0,0,v,b),o=s.canvas,g=v,m=b,y="prescale1"===y?"prescale2":"prescale1"}if(i.drawImage(o,0,0,g,m,0,-r,n,r),this.imageLayer){var _=this.getCanvasPosition(0,-r);this.imageLayer.appendImage({imgData:e,left:_[0],top:_[1],width:n/a[0],height:r/a[3]})}this.restore()},paintInlineImageXObjectGroup:function(e,n){var r=this.ctx,i=e.width,o=e.height,s=this.cachedCanvases.getCanvas("inlineImage",i,o);t(s.context,e);for(var a=0,c=n.length;a<c;a++){var l=n[a];if(r.save(),r.transform.apply(r,l.transform),r.scale(1,-1),r.drawImage(s.canvas,l.x,l.y,l.w,l.h,0,-1,1,1),this.imageLayer){var u=this.getCanvasPosition(l.x,l.y);this.imageLayer.appendImage({imgData:e,left:u[0],top:u[1],width:i,height:o})}r.restore()}},paintSolidColorImageMask:function(){this.ctx.fillRect(0,0,1,1)},paintXObject:function(){(0,r.warn)("Unsupported 'paintXObject' command.")},markPoint:function(e){},markPointProps:function(e,t){},beginMarkedContent:function(e){},beginMarkedContentProps:function(e,t){},endMarkedContent:function(){},beginCompat:function(){},endCompat:function(){},consumePath:function(){var e=this.ctx;this.pendingClip&&(this.pendingClip===w?e.clip("evenodd"):e.clip(),this.pendingClip=null),e.beginPath()},getSinglePixelWidth:function(e){if(null===this._cachedGetSinglePixelWidth){var t=this.ctx.mozCurrentTransformInverse;this._cachedGetSinglePixelWidth=Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1],t[2]*t[2]+t[3]*t[3]))}return this._cachedGetSinglePixelWidth},getCanvasPosition:function(e,t){var n=this.ctx.mozCurrentTransform;return[n[0]*e+n[2]*t+n[4],n[1]*e+n[3]*t+n[5]]}},r.OPS)e.prototype[r.OPS[T]]=e.prototype[T];return e}();t.CanvasGraphics=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TilingPattern=void 0,t.getShadingPatternFromIR=function(e){var t=i[e[0]];if(!t)throw new Error("Unknown IR type: ".concat(e[0]));return t.fromIR(e)};var r=n(1),i={};function o(e,t){if(t&&"undefined"!=typeof Path2D){var n=t[2]-t[0],r=t[3]-t[1],i=new Path2D;i.rect(t[0],t[1],n,r),e.clip(i)}}i.RadialAxial={fromIR:function(e){var t=e[1],n=e[2],r=e[3],i=e[4],s=e[5],a=e[6],c=e[7];return{type:"Pattern",getPattern:function(e){var l;o(e,n),"axial"===t?l=e.createLinearGradient(i[0],i[1],s[0],s[1]):"radial"===t&&(l=e.createRadialGradient(i[0],i[1],a,s[0],s[1],c));for(var u=0,d=r.length;u<d;++u){var h=r[u];l.addColorStop(h[0],h[1])}return l}}}};var s=function(){function e(e,t,n,r,i,o,s,a){var c,l=t.coords,u=t.colors,d=e.data,h=4*e.width;l[n+1]>l[r+1]&&(c=n,n=r,r=c,c=o,o=s,s=c),l[r+1]>l[i+1]&&(c=r,r=i,i=c,c=s,s=a,a=c),l[n+1]>l[r+1]&&(c=n,n=r,r=c,c=o,o=s,s=c);var f=(l[n]+t.offsetX)*t.scaleX,p=(l[n+1]+t.offsetY)*t.scaleY,g=(l[r]+t.offsetX)*t.scaleX,m=(l[r+1]+t.offsetY)*t.scaleY,y=(l[i]+t.offsetX)*t.scaleX,v=(l[i+1]+t.offsetY)*t.scaleY;if(!(p>=v))for(var b,_,w,T,E,A,S,O,I=u[o],C=u[o+1],k=u[o+2],P=u[s],x=u[s+1],R=u[s+2],L=u[a],D=u[a+1],N=u[a+2],j=Math.round(p),M=Math.round(v),F=j;F<=M;F++){if(F<m){var U=void 0;b=f-(f-g)*(U=F<p?0:p===m?1:(p-F)/(p-m)),_=I-(I-P)*U,w=C-(C-x)*U,T=k-(k-R)*U}else{var B=void 0;b=g-(g-y)*(B=F>v?1:m===v?0:(m-F)/(m-v)),_=P-(P-L)*B,w=x-(x-D)*B,T=R-(R-N)*B}var G=void 0;E=f-(f-y)*(G=F<p?0:F>v?1:(p-F)/(p-v)),A=I-(I-L)*G,S=C-(C-D)*G,O=k-(k-N)*G;for(var q=Math.round(Math.min(b,E)),H=Math.round(Math.max(b,E)),$=h*F+4*q,W=q;W<=H;W++){var z=(b-W)/(b-E);z<0?z=0:z>1&&(z=1),d[$++]=_-(_-A)*z|0,d[$++]=w-(w-S)*z|0,d[$++]=T-(T-O)*z|0,d[$++]=255}}}function t(t,n,r){var i,o,s=n.coords,a=n.colors;switch(n.type){case"lattice":var c=n.verticesPerRow,l=Math.floor(s.length/c)-1,u=c-1;for(i=0;i<l;i++)for(var d=i*c,h=0;h<u;h++,d++)e(t,r,s[d],s[d+1],s[d+c],a[d],a[d+1],a[d+c]),e(t,r,s[d+c+1],s[d+1],s[d+c],a[d+c+1],a[d+1],a[d+c]);break;case"triangles":for(i=0,o=s.length;i<o;i+=3)e(t,r,s[i],s[i+1],s[i+2],a[i],a[i+1],a[i+2]);break;default:throw new Error("illegal figure")}}return function(e,n,r,i,o,s,a,c){var l,u,d,h,f=Math.floor(e[0]),p=Math.floor(e[1]),g=Math.ceil(e[2])-f,m=Math.ceil(e[3])-p,y=Math.min(Math.ceil(Math.abs(g*n[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(m*n[1]*1.1)),3e3),b=g/y,_=m/v,w={coords:r,colors:i,offsetX:-f,offsetY:-p,scaleX:1/b,scaleY:1/_},T=y+4,E=v+4;if(c.isEnabled)l=c.drawFigures({width:y,height:v,backgroundColor:s,figures:o,context:w}),(u=a.getCanvas("mesh",T,E,!1)).context.drawImage(l,2,2),l=u.canvas;else{var A=(u=a.getCanvas("mesh",T,E,!1)).context,S=A.createImageData(y,v);if(s){var O=S.data;for(d=0,h=O.length;d<h;d+=4)O[d]=s[0],O[d+1]=s[1],O[d+2]=s[2],O[d+3]=255}for(d=0;d<o.length;d++)t(S,o[d],w);A.putImageData(S,2,2),l=u.canvas}return{canvas:l,offsetX:f-2*b,offsetY:p-2*_,scaleX:b,scaleY:_}}}();i.Mesh={fromIR:function(e){var t=e[2],n=e[3],i=e[4],a=e[5],c=e[6],l=e[7],u=e[8];return{type:"Pattern",getPattern:function(e,d,h){var f;if(o(e,l),h)f=r.Util.singularValueDecompose2dScale(e.mozCurrentTransform);else if(f=r.Util.singularValueDecompose2dScale(d.baseTransform),c){var p=r.Util.singularValueDecompose2dScale(c);f=[f[0]*p[0],f[1]*p[1]]}var g=s(a,f,t,n,i,h?null:u,d.cachedCanvases,d.webGLContext);return h||(e.setTransform.apply(e,d.baseTransform),c&&e.transform.apply(e,c)),e.translate(g.offsetX,g.offsetY),e.scale(g.scaleX,g.scaleY),e.createPattern(g.canvas,"no-repeat")}}}},i.Dummy={fromIR:function(){return{type:"Pattern",getPattern:function(){return"hotpink"}}}};var a=function(){var e=1,t=2;function n(e,t,n,r,i){this.operatorList=e[2],this.matrix=e[3]||[1,0,0,1,0,0],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.canvasGraphicsFactory=r,this.baseTransform=i,this.type="Pattern",this.ctx=n}return n.prototype={createPatternCanvas:function(e){var t=this.operatorList,n=this.bbox,i=this.xstep,o=this.ystep,s=this.paintType,a=this.tilingType,c=this.color,l=this.canvasGraphicsFactory;(0,r.info)("TilingType: "+a);var u=n[0],d=n[1],h=n[2],f=n[3],p=r.Util.singularValueDecompose2dScale(this.matrix),g=r.Util.singularValueDecompose2dScale(this.baseTransform),m=[p[0]*g[0],p[1]*g[1]],y=this.getSizeAndScale(i,this.ctx.canvas.width,m[0]),v=this.getSizeAndScale(o,this.ctx.canvas.height,m[1]),b=e.cachedCanvases.getCanvas("pattern",y.size,v.size,!0),_=b.context,w=l.createCanvasGraphics(_);return w.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(w,s,c),w.transform(y.scale,0,0,v.scale,0,0),w.transform(1,0,0,1,-u,-d),this.clipBbox(w,n,u,d,h,f),w.executeOperatorList(t),this.ctx.transform(1,0,0,1,u,d),this.ctx.scale(1/y.scale,1/v.scale),b.canvas},getSizeAndScale:function(e,t,n){e=Math.abs(e);var r=Math.max(3e3,t),i=Math.ceil(e*n);return i>=r?i=r:n=i/e,{scale:n,size:i}},clipBbox:function(e,t,n,r,i,o){if(Array.isArray(t)&&4===t.length){var s=i-n,a=o-r;e.ctx.rect(n,r,s,a),e.clip(),e.endPath()}},setFillAndStrokeStyleToContext:function(n,i,o){var s=n.ctx,a=n.current;switch(i){case e:var c=this.ctx;s.fillStyle=c.fillStyle,s.strokeStyle=c.strokeStyle,a.fillColor=c.fillStyle,a.strokeColor=c.strokeStyle;break;case t:var l=r.Util.makeCssRgb(o[0],o[1],o[2]);s.fillStyle=l,s.strokeStyle=l,a.fillColor=l,a.strokeColor=l;break;default:throw new r.FormatError("Unsupported paint type: ".concat(i))}},getPattern:function(e,t){(e=this.ctx).setTransform.apply(e,this.baseTransform),e.transform.apply(e,this.matrix);var n=this.createPatternCanvas(t);return e.createPattern(n,"repeat")}},n}();t.TilingPattern=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalWorkerOptions=void 0;var r=Object.create(null);t.GlobalWorkerOptions=r,r.workerPort=void 0===r.workerPort?null:r.workerPort,r.workerSrc=void 0===r.workerSrc?"":r.workerSrc},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var r,i=(r=n(220))&&r.__esModule?r:{default:r},o=n(1);function s(e,t,n,r,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}var l=1,u=2,d=1,h=2,f=3,p=4,g=5,m=6,y=7,v=8;function b(e){if("object"!==c(e)||null===e)return e;switch(e.name){case"AbortException":return new o.AbortException(e.message);case"MissingPDFException":return new o.MissingPDFException(e.message);case"UnexpectedResponseException":return new o.UnexpectedResponseException(e.message,e.status);case"UnknownErrorException":return new o.UnknownErrorException(e.message,e.details);default:return new o.UnknownErrorException(e.message,e.toString())}}var _=function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sourceName=t,this.targetName=n,this.comObj=r,this.callbackId=1,this.streamId=1,this.postMessageTransfers=!0,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=function(e){var t=e.data;if(t.targetName===i.sourceName)if(t.stream)i._processStreamMessage(t);else if(t.callback){var n=t.callbackId,o=i.callbackCapabilities[n];if(!o)throw new Error("Cannot resolve callback ".concat(n));if(delete i.callbackCapabilities[n],t.callback===l)o.resolve(t.data);else{if(t.callback!==u)throw new Error("Unexpected callback case");o.reject(b(t.reason))}}else{var s=i.actionHandler[t.action];if(!s)throw new Error("Unknown action from worker: ".concat(t.action));if(t.callbackId){var a=i.sourceName,c=t.sourceName;new Promise((function(e){e(s(t.data))})).then((function(e){r.postMessage({sourceName:a,targetName:c,callback:l,callbackId:t.callbackId,data:e})}),(function(e){r.postMessage({sourceName:a,targetName:c,callback:u,callbackId:t.callbackId,reason:b(e)})}))}else t.streamId?i._createStreamSink(t):s(t.data)}},r.addEventListener("message",this._onComObjOnMessage)}var t,n,r,c,_;return t=e,n=[{key:"on",value:function(e,t){var n=this.actionHandler;if(n[e])throw new Error('There is already an actionName called "'.concat(e,'"'));n[e]=t}},{key:"send",value:function(e,t,n){this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}},{key:"sendWithPromise",value:function(e,t,n){var r=this.callbackId++,i=(0,o.createPromiseCapability)();this.callbackCapabilities[r]=i;try{this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},n)}catch(e){i.reject(e)}return i.promise}},{key:"sendWithStream",value:function(e,t,n,r){var i=this,s=this.streamId++,a=this.sourceName,c=this.targetName,l=this.comObj;return new ReadableStream({start:function(n){var l=(0,o.createPromiseCapability)();return i.streamControllers[s]={controller:n,startCall:l,pullCall:null,cancelCall:null,isClosed:!1},i._postMessage({sourceName:a,targetName:c,action:e,streamId:s,data:t,desiredSize:n.desiredSize},r),l.promise},pull:function(e){var t=(0,o.createPromiseCapability)();return i.streamControllers[s].pullCall=t,l.postMessage({sourceName:a,targetName:c,stream:m,streamId:s,desiredSize:e.desiredSize}),t.promise},cancel:function(e){(0,o.assert)(e instanceof Error,"cancel must have a valid reason");var t=(0,o.createPromiseCapability)();return i.streamControllers[s].cancelCall=t,i.streamControllers[s].isClosed=!0,l.postMessage({sourceName:a,targetName:c,stream:d,streamId:s,reason:b(e)}),t.promise}},n)}},{key:"_createStreamSink",value:function(e){var t=this,n=this.actionHandler[e.action],r=e.streamId,i=this.sourceName,s=e.sourceName,a=this.comObj,c={enqueue:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0;if(!this.isCancelled){var c=this.desiredSize;this.desiredSize-=n,c>0&&this.desiredSize<=0&&(this.sinkCapability=(0,o.createPromiseCapability)(),this.ready=this.sinkCapability.promise),t._postMessage({sourceName:i,targetName:s,stream:p,streamId:r,chunk:e},a)}},close:function(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:i,targetName:s,stream:f,streamId:r}),delete t.streamSinks[r])},error:function(e){(0,o.assert)(e instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:i,targetName:s,stream:g,streamId:r,reason:b(e)}))},sinkCapability:(0,o.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};c.sinkCapability.resolve(),c.ready=c.sinkCapability.promise,this.streamSinks[r]=c,new Promise((function(t){t(n(e.data,c))})).then((function(){a.postMessage({sourceName:i,targetName:s,stream:v,streamId:r,success:!0})}),(function(e){a.postMessage({sourceName:i,targetName:s,stream:v,streamId:r,reason:b(e)})}))}},{key:"_processStreamMessage",value:function(e){var t=e.streamId,n=this.sourceName,r=e.sourceName,i=this.comObj;switch(e.stream){case v:e.success?this.streamControllers[t].startCall.resolve():this.streamControllers[t].startCall.reject(b(e.reason));break;case y:e.success?this.streamControllers[t].pullCall.resolve():this.streamControllers[t].pullCall.reject(b(e.reason));break;case m:if(!this.streamSinks[t]){i.postMessage({sourceName:n,targetName:r,stream:y,streamId:t,success:!0});break}this.streamSinks[t].desiredSize<=0&&e.desiredSize>0&&this.streamSinks[t].sinkCapability.resolve(),this.streamSinks[t].desiredSize=e.desiredSize;var s=this.streamSinks[e.streamId].onPull;new Promise((function(e){e(s&&s())})).then((function(){i.postMessage({sourceName:n,targetName:r,stream:y,streamId:t,success:!0})}),(function(e){i.postMessage({sourceName:n,targetName:r,stream:y,streamId:t,reason:b(e)})}));break;case p:if((0,o.assert)(this.streamControllers[t],"enqueue should have stream controller"),this.streamControllers[t].isClosed)break;this.streamControllers[t].controller.enqueue(e.chunk);break;case f:if((0,o.assert)(this.streamControllers[t],"close should have stream controller"),this.streamControllers[t].isClosed)break;this.streamControllers[t].isClosed=!0,this.streamControllers[t].controller.close(),this._deleteStreamController(t);break;case g:(0,o.assert)(this.streamControllers[t],"error should have stream controller"),this.streamControllers[t].controller.error(b(e.reason)),this._deleteStreamController(t);break;case h:e.success?this.streamControllers[t].cancelCall.resolve():this.streamControllers[t].cancelCall.reject(b(e.reason)),this._deleteStreamController(t);break;case d:if(!this.streamSinks[t])break;var a=this.streamSinks[e.streamId].onCancel;new Promise((function(t){t(a&&a(b(e.reason)))})).then((function(){i.postMessage({sourceName:n,targetName:r,stream:h,streamId:t,success:!0})}),(function(e){i.postMessage({sourceName:n,targetName:r,stream:h,streamId:t,reason:b(e)})})),this.streamSinks[t].sinkCapability.reject(b(e.reason)),this.streamSinks[t].isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}},{key:"_deleteStreamController",value:(c=i.default.mark((function e(t){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.allSettled([this.streamControllers[t].startCall,this.streamControllers[t].pullCall,this.streamControllers[t].cancelCall].map((function(e){return e&&e.promise})));case 2:delete this.streamControllers[t];case 3:case"end":return e.stop()}}),e,this)})),_=function(){var e=this,t=arguments;return new Promise((function(n,r){var i=c.apply(e,t);function o(e){s(i,n,r,o,a,"next",e)}function a(e){s(i,n,r,o,a,"throw",e)}o(void 0)}))},function(e){return _.apply(this,arguments)})},{key:"_postMessage",value:function(e,t){t&&this.postMessageTransfers?this.comObj.postMessage(e,t):this.comObj.postMessage(e)}},{key:"destroy",value:function(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}],n&&a(t.prototype,n),r&&a(t,r),e}();t.MessageHandler=_},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var r=n(1),i=n(231);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(0,r.assert)("string"==typeof t,"Metadata: input is not a string"),t=this._repair(t);var n=(new i.SimpleXMLParser).parseFromString(t);this._metadataMap=new Map,n&&this._parse(n)}var t,n,a;return t=e,(n=[{key:"_repair",value:function(e){return e.replace(/^[^<]+/,"").replace(/>\\376\\377([^<]+)/g,(function(e,t){for(var n=t.replace(/\\([0-3])([0-7])([0-7])/g,(function(e,t,n,r){return String.fromCharCode(64*t+8*n+1*r)})).replace(/&(amp|apos|gt|lt|quot);/g,(function(e,t){switch(t){case"amp":return"&";case"apos":return"'";case"gt":return">";case"lt":return"<";case"quot":return'"'}throw new Error("_repair: ".concat(t," isn't defined."))})),r="",i=0,o=n.length;i<o;i+=2){var s=256*n.charCodeAt(i)+n.charCodeAt(i+1);r+=s>=32&&s<127&&60!==s&&62!==s&&38!==s?String.fromCharCode(s):"&#x"+(65536+s).toString(16).substring(1)+";"}return">"+r}))}},{key:"_parse",value:function(e){var t=e.documentElement;if("rdf:rdf"!==t.nodeName.toLowerCase())for(t=t.firstChild;t&&"rdf:rdf"!==t.nodeName.toLowerCase();)t=t.nextSibling;var n=t?t.nodeName.toLowerCase():null;if(t&&"rdf:rdf"===n&&t.hasChildNodes())for(var r=t.childNodes,i=0,o=r.length;i<o;i++){var s=r[i];if("rdf:description"===s.nodeName.toLowerCase())for(var a=0,c=s.childNodes.length;a<c;a++)if("#text"!==s.childNodes[a].nodeName.toLowerCase()){var l=s.childNodes[a],u=l.nodeName.toLowerCase();this._metadataMap.set(u,l.textContent.trim())}}}},{key:"get",value:function(e){return this._metadataMap.has(e)?this._metadataMap.get(e):null}},{key:"getAll",value:function(){var e,t=Object.create(null),n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw o}}}}(this._metadataMap);try{for(n.s();!(e=n.n()).done;){var r=o(e.value,2),i=r[0],a=r[1];t[i]=a}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"has",value:function(e){return this._metadataMap.has(e)}}])&&c(t.prototype,n),a&&c(t,a),e}();t.Metadata=l},function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(){return s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},s.apply(this,arguments)}function a(e,t){return a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},a(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=l(e);if(t){var o=l(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleXMLParser=void 0;var f=0,p=-2,g=-3,m=-4,y=-5,v=-6,b=-9;function _(e,t){var n=e[t];return" "===n||"\n"===n||"\r"===n||"\t"===n}var w=function(){function e(){u(this,e)}return h(e,[{key:"_resolveEntities",value:function(e){var t=this;return e.replace(/&([^;]+);/g,(function(e,n){if("#x"===n.substring(0,2))return String.fromCharCode(parseInt(n.substring(2),16));if("#"===n.substring(0,1))return String.fromCharCode(parseInt(n.substring(1),10));switch(n){case"lt":return"<";case"gt":return">";case"amp":return"&";case"quot":return'"'}return t.onResolveEntity(n)}))}},{key:"_parseContent",value:function(e,t){var n=[],r=t;function i(){for(;r<e.length&&_(e,r);)++r}for(;r<e.length&&!_(e,r)&&">"!==e[r]&&"/"!==e[r];)++r;var o=e.substring(t,r);for(i();r<e.length&&">"!==e[r]&&"/"!==e[r]&&"?"!==e[r];){i();for(var s,a="";r<e.length&&!_(e,r)&&"="!==e[r];)a+=e[r],++r;if(i(),"="!==e[r])return null;++r,i();var c=e[r];if('"'!==c&&"'"!==c)return null;var l=e.indexOf(c,++r);if(l<0)return null;s=e.substring(r,l),n.push({name:a,value:this._resolveEntities(s)}),r=l+1,i()}return{name:o,attributes:n,parsed:r-t}}},{key:"_parseProcessingInstruction",value:function(e,t){for(var n=t;n<e.length&&!_(e,n)&&">"!==e[n]&&"/"!==e[n];)++n;var r=e.substring(t,n);!function(){for(;n<e.length&&_(e,n);)++n}();for(var i=n;n<e.length&&("?"!==e[n]||">"!==e[n+1]);)++n;return{name:r,value:e.substring(i,n),parsed:n-t}}},{key:"parseXml",value:function(e){for(var t=0;t<e.length;){var n=t;if("<"===e[t]){var r=void 0;switch(e[++n]){case"/":if(++n,(r=e.indexOf(">",n))<0)return void this.onError(b);this.onEndElement(e.substring(n,r)),n=r+1;break;case"?":++n;var i=this._parseProcessingInstruction(e,n);if("?>"!==e.substring(n+i.parsed,n+i.parsed+2))return void this.onError(g);this.onPi(i.name,i.value),n+=i.parsed+2;break;case"!":if("--"===e.substring(n+1,n+3)){if((r=e.indexOf("--\x3e",n+3))<0)return void this.onError(y);this.onComment(e.substring(n+3,r)),n=r+3}else if("[CDATA["===e.substring(n+1,n+8)){if((r=e.indexOf("]]>",n+8))<0)return void this.onError(p);this.onCdata(e.substring(n+8,r)),n=r+3}else{if("DOCTYPE"!==e.substring(n+1,n+8))return void this.onError(v);var o=e.indexOf("[",n+8),s=!1;if((r=e.indexOf(">",n+8))<0)return void this.onError(m);if(o>0&&r>o){if((r=e.indexOf("]>",n+8))<0)return void this.onError(m);s=!0}var a=e.substring(n+8,r+(s?1:0));this.onDoctype(a),n=r+(s?2:1)}break;default:var c=this._parseContent(e,n);if(null===c)return void this.onError(v);var l=!1;if("/>"===e.substring(n+c.parsed,n+c.parsed+2))l=!0;else if(">"!==e.substring(n+c.parsed,n+c.parsed+1))return void this.onError(b);this.onBeginElement(c.name,c.attributes,l),n+=c.parsed+(l?2:1)}}else{for(;n<e.length&&"<"!==e[n];)n++;var u=e.substring(t,n);this.onText(this._resolveEntities(u))}t=n}}},{key:"onResolveEntity",value:function(e){return"&".concat(e,";")}},{key:"onPi",value:function(e,t){}},{key:"onComment",value:function(e){}},{key:"onCdata",value:function(e){}},{key:"onDoctype",value:function(e){}},{key:"onText",value:function(e){}},{key:"onBeginElement",value:function(e,t,n){}},{key:"onEndElement",value:function(e){}},{key:"onError",value:function(e){}}]),e}(),T=function(){function e(t,n){u(this,e),this.nodeName=t,this.nodeValue=n,Object.defineProperty(this,"parentNode",{value:null,writable:!0})}return h(e,[{key:"firstChild",get:function(){return this.childNodes&&this.childNodes[0]}},{key:"nextSibling",get:function(){var e=this.parentNode.childNodes;if(e){var t=e.indexOf(this);if(-1!==t)return e[t+1]}}},{key:"textContent",get:function(){return this.childNodes?this.childNodes.map((function(e){return e.textContent})).join(""):this.nodeValue||""}},{key:"hasChildNodes",value:function(){return this.childNodes&&this.childNodes.length>0}}]),e}(),E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(n,e);var t=c(n);function n(){var e;return u(this,n),(e=t.call(this))._currentFragment=null,e._stack=null,e._errorCode=f,e}return h(n,[{key:"parseFromString",value:function(e){if(this._currentFragment=[],this._stack=[],this._errorCode=f,this.parseXml(e),this._errorCode===f){var t=i(this._currentFragment,1)[0];if(t)return{documentElement:t}}}},{key:"onResolveEntity",value:function(e){return"apos"===e?"'":s(l(n.prototype),"onResolveEntity",this).call(this,e)}},{key:"onText",value:function(e){if(!function(e){for(var t=0,n=e.length;t<n;t++)if(!_(e,t))return!1;return!0}(e)){var t=new T("#text",e);this._currentFragment.push(t)}}},{key:"onCdata",value:function(e){var t=new T("#text",e);this._currentFragment.push(t)}},{key:"onBeginElement",value:function(e,t,n){var r=new T(e);r.childNodes=[],this._currentFragment.push(r),n||(this._stack.push(this._currentFragment),this._currentFragment=r.childNodes)}},{key:"onEndElement",value:function(e){this._currentFragment=this._stack.pop()||[];var t=this._currentFragment[this._currentFragment.length-1];if(t)for(var n=0,r=t.childNodes.length;n<r;n++)t.childNodes[n].parentNode=t}},{key:"onError",value:function(e){this._errorCode=e}}]),n}(w);t.SimpleXMLParser=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var r,i=(r=n(220))&&r.__esModule?r:{default:r},o=n(1);function s(e,t,n,r,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){s(o,r,i,a,c,"next",e)}function c(e){s(o,r,i,a,c,"throw",e)}a(void 0)}))}}function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}var f=function(){function e(t,n){var r=this;u(this,e),(0,o.assert)(n),this._queuedChunks=[],this._progressiveDone=t.progressiveDone||!1;var i=t.initialData;if(i&&i.length>0){var s=new Uint8Array(i).buffer;this._queuedChunks.push(s)}this._pdfDataRangeTransport=n,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._contentLength=t.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((function(e,t){r._onReceiveData({begin:e,chunk:t})})),this._pdfDataRangeTransport.addProgressListener((function(e,t){r._onProgress({loaded:e,total:t})})),this._pdfDataRangeTransport.addProgressiveReadListener((function(e){r._onReceiveData({chunk:e})})),this._pdfDataRangeTransport.addProgressiveDoneListener((function(){r._onProgressiveDone()})),this._pdfDataRangeTransport.transportReady()}return h(e,[{key:"_onReceiveData",value:function(e){var t=new Uint8Array(e.chunk).buffer;if(void 0===e.begin)this._fullRequestReader?this._fullRequestReader._enqueue(t):this._queuedChunks.push(t);else{var n=this._rangeReaders.some((function(n){return n._begin===e.begin&&(n._enqueue(t),!0)}));(0,o.assert)(n)}}},{key:"_progressiveDataLength",get:function(){return this._fullRequestReader?this._fullRequestReader._loaded:0}},{key:"_onProgress",value:function(e){if(void 0===e.total){var t=this._rangeReaders[0];t&&t.onProgress&&t.onProgress({loaded:e.loaded})}else{var n=this._fullRequestReader;n&&n.onProgress&&n.onProgress({loaded:e.loaded,total:e.total})}}},{key:"_onProgressiveDone",value:function(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}},{key:"_removeRangeReader",value:function(e){var t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}},{key:"getFullReader",value:function(){(0,o.assert)(!this._fullRequestReader);var e=this._queuedChunks;return this._queuedChunks=null,new p(this,e,this._progressiveDone)}},{key:"getRangeReader",value:function(e,t){if(t<=this._progressiveDataLength)return null;var n=new g(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}},{key:"cancelAllRequests",value:function(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeReaders.slice(0).forEach((function(t){t.cancel(e)})),this._pdfDataRangeTransport.abort()}}]),e}();t.PDFDataTransportStream=f;var p=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];u(this,e),this._stream=t,this._done=r||!1,this._filename=null,this._queuedChunks=n||[],this._loaded=0;var i,o=c(this._queuedChunks);try{for(o.s();!(i=o.n()).done;){var s=i.value;this._loaded+=s.byteLength}}catch(e){o.e(e)}finally{o.f()}this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}var t;return h(e,[{key:"_enqueue",value:function(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}},{key:"headersReady",get:function(){return this._headersReady}},{key:"filename",get:function(){return this._filename}},{key:"isRangeSupported",get:function(){return this._stream._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._stream._isStreamingSupported}},{key:"contentLength",get:function(){return this._stream._contentLength}},{key:"read",value:(t=a(i.default.mark((function e(){var t,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this._queuedChunks.length>0)){e.next=3;break}return t=this._queuedChunks.shift(),e.abrupt("return",{value:t,done:!1});case 3:if(!this._done){e.next=5;break}return e.abrupt("return",{value:void 0,done:!0});case 5:return n=(0,o.createPromiseCapability)(),this._requests.push(n),e.abrupt("return",n.promise);case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(e){this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[]}},{key:"progressiveDone",value:function(){this._done||(this._done=!0)}}]),e}(),g=function(){function e(t,n,r){u(this,e),this._stream=t,this._begin=n,this._end=r,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}var t;return h(e,[{key:"_enqueue",value:function(e){this._done||(0===this._requests.length?this._queuedChunk=e:(this._requests.shift().resolve({value:e,done:!1}),this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[]),this._done=!0,this._stream._removeRangeReader(this))}},{key:"isStreamingSupported",get:function(){return!1}},{key:"read",value:(t=a(i.default.mark((function e(){var t,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._queuedChunk){e.next=4;break}return t=this._queuedChunk,this._queuedChunk=null,e.abrupt("return",{value:t,done:!1});case 4:if(!this._done){e.next=6;break}return e.abrupt("return",{value:void 0,done:!0});case 6:return n=(0,o.createPromiseCapability)(),this._requests.push(n),e.abrupt("return",n.promise);case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(e){this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._stream._removeRangeReader(this)}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLContext=void 0;var r=n(1);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(t){var n=t.enable,r=void 0!==n&&n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._enabled=!0===r}var t,n,o;return t=e,(n=[{key:"isEnabled",get:function(){var e=this._enabled;return e&&(e=s.tryInitGL()),(0,r.shadow)(this,"isEnabled",e)}},{key:"composeSMask",value:function(e){var t=e.layer,n=e.mask,r=e.properties;return s.composeSMask(t,n,r)}},{key:"drawFigures",value:function(e){var t=e.width,n=e.height,r=e.backgroundColor,i=e.figures,o=e.context;return s.drawFigures(t,n,r,i,o)}},{key:"clear",value:function(){s.cleanup()}}])&&i(t.prototype,n),o&&i(t,o),e}();t.WebGLContext=o;var s=function(){function e(e,t,n){var r=e.createShader(n);if(e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(r);throw new Error("Error during shader compilation: "+i)}return r}function t(t,n){return e(t,n,t.VERTEX_SHADER)}function n(t,n){return e(t,n,t.FRAGMENT_SHADER)}function r(e,t){for(var n=e.createProgram(),r=0,i=t.length;r<i;++r)e.attachShader(n,t[r]);if(e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS)){var o=e.getProgramInfoLog(n);throw new Error("Error during program linking: "+o)}return n}function i(e,t,n){e.activeTexture(n);var r=e.createTexture();return e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),r}var o,s;function a(){o||(s=document.createElement("canvas"),o=s.getContext("webgl",{premultipliedalpha:!1}))}var c=null,l=null;return{tryInitGL:function(){try{return a(),!!o}catch(e){}return!1},composeSMask:function(e,l,u){var d=e.width,h=e.height;c||function(){var e,i;a(),e=s,s=null,i=o,o=null;var l=r(i,[t(i,"  attribute vec2 a_position;                                      attribute vec2 a_texCoord;                                                                                                      uniform vec2 u_resolution;                                                                                                      varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec2 clipSpace = (a_position / u_resolution) * 2.0 - 1.0;       gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_texCoord = a_texCoord;                                      }                                                             "),n(i,"  precision mediump float;                                                                                                        uniform vec4 u_backdrop;                                        uniform int u_subtype;                                          uniform sampler2D u_image;                                      uniform sampler2D u_mask;                                                                                                       varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec4 imageColor = texture2D(u_image, v_texCoord);               vec4 maskColor = texture2D(u_mask, v_texCoord);                 if (u_backdrop.a > 0.0) {                                         maskColor.rgb = maskColor.rgb * maskColor.a +                                   u_backdrop.rgb * (1.0 - maskColor.a);         }                                                               float lum;                                                      if (u_subtype == 0) {                                             lum = maskColor.a;                                            } else {                                                          lum = maskColor.r * 0.3 + maskColor.g * 0.59 +                        maskColor.b * 0.11;                                     }                                                               imageColor.a *= lum;                                            imageColor.rgb *= imageColor.a;                                 gl_FragColor = imageColor;                                    }                                                             ")]);i.useProgram(l);var u={};u.gl=i,u.canvas=e,u.resolutionLocation=i.getUniformLocation(l,"u_resolution"),u.positionLocation=i.getAttribLocation(l,"a_position"),u.backdropLocation=i.getUniformLocation(l,"u_backdrop"),u.subtypeLocation=i.getUniformLocation(l,"u_subtype");var d=i.getAttribLocation(l,"a_texCoord"),h=i.getUniformLocation(l,"u_image"),f=i.getUniformLocation(l,"u_mask"),p=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,p),i.bufferData(i.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),i.STATIC_DRAW),i.enableVertexAttribArray(d),i.vertexAttribPointer(d,2,i.FLOAT,!1,0,0),i.uniform1i(h,0),i.uniform1i(f,1),c=u}();var f=c,p=f.canvas,g=f.gl;p.width=d,p.height=h,g.viewport(0,0,g.drawingBufferWidth,g.drawingBufferHeight),g.uniform2f(f.resolutionLocation,d,h),u.backdrop?g.uniform4f(f.resolutionLocation,u.backdrop[0],u.backdrop[1],u.backdrop[2],1):g.uniform4f(f.resolutionLocation,0,0,0,0),g.uniform1i(f.subtypeLocation,"Luminosity"===u.subtype?1:0);var m=i(g,e,g.TEXTURE0),y=i(g,l,g.TEXTURE1),v=g.createBuffer();return g.bindBuffer(g.ARRAY_BUFFER,v),g.bufferData(g.ARRAY_BUFFER,new Float32Array([0,0,d,0,0,h,0,h,d,0,d,h]),g.STATIC_DRAW),g.enableVertexAttribArray(f.positionLocation),g.vertexAttribPointer(f.positionLocation,2,g.FLOAT,!1,0,0),g.clearColor(0,0,0,0),g.enable(g.BLEND),g.blendFunc(g.ONE,g.ONE_MINUS_SRC_ALPHA),g.clear(g.COLOR_BUFFER_BIT),g.drawArrays(g.TRIANGLES,0,6),g.flush(),g.deleteTexture(m),g.deleteTexture(y),g.deleteBuffer(v),p},drawFigures:function(e,i,c,u,d){l||function(){var e,i;a(),e=s,s=null,i=o,o=null;var c=r(i,[t(i,"  attribute vec2 a_position;                                      attribute vec3 a_color;                                                                                                         uniform vec2 u_resolution;                                      uniform vec2 u_scale;                                           uniform vec2 u_offset;                                                                                                          varying vec4 v_color;                                                                                                           void main() {                                                     vec2 position = (a_position + u_offset) * u_scale;              vec2 clipSpace = (position / u_resolution) * 2.0 - 1.0;         gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_color = vec4(a_color / 255.0, 1.0);                         }                                                             "),n(i,"  precision mediump float;                                                                                                        varying vec4 v_color;                                                                                                           void main() {                                                     gl_FragColor = v_color;                                       }                                                             ")]);i.useProgram(c);var u={};u.gl=i,u.canvas=e,u.resolutionLocation=i.getUniformLocation(c,"u_resolution"),u.scaleLocation=i.getUniformLocation(c,"u_scale"),u.offsetLocation=i.getUniformLocation(c,"u_offset"),u.positionLocation=i.getAttribLocation(c,"a_position"),u.colorLocation=i.getAttribLocation(c,"a_color"),l=u}();var h=l,f=h.canvas,p=h.gl;f.width=e,f.height=i,p.viewport(0,0,p.drawingBufferWidth,p.drawingBufferHeight),p.uniform2f(h.resolutionLocation,e,i);var g,m,y,v=0;for(g=0,m=u.length;g<m;g++)switch(u[g].type){case"lattice":v+=((y=u[g].coords.length/u[g].verticesPerRow|0)-1)*(u[g].verticesPerRow-1)*6;break;case"triangles":v+=u[g].coords.length}var b=new Float32Array(2*v),_=new Uint8Array(3*v),w=d.coords,T=d.colors,E=0,A=0;for(g=0,m=u.length;g<m;g++){var S=u[g],O=S.coords,I=S.colors;switch(S.type){case"lattice":var C=S.verticesPerRow;y=O.length/C|0;for(var k=1;k<y;k++)for(var P=k*C+1,x=1;x<C;x++,P++)b[E]=w[O[P-C-1]],b[E+1]=w[O[P-C-1]+1],b[E+2]=w[O[P-C]],b[E+3]=w[O[P-C]+1],b[E+4]=w[O[P-1]],b[E+5]=w[O[P-1]+1],_[A]=T[I[P-C-1]],_[A+1]=T[I[P-C-1]+1],_[A+2]=T[I[P-C-1]+2],_[A+3]=T[I[P-C]],_[A+4]=T[I[P-C]+1],_[A+5]=T[I[P-C]+2],_[A+6]=T[I[P-1]],_[A+7]=T[I[P-1]+1],_[A+8]=T[I[P-1]+2],b[E+6]=b[E+2],b[E+7]=b[E+3],b[E+8]=b[E+4],b[E+9]=b[E+5],b[E+10]=w[O[P]],b[E+11]=w[O[P]+1],_[A+9]=_[A+3],_[A+10]=_[A+4],_[A+11]=_[A+5],_[A+12]=_[A+6],_[A+13]=_[A+7],_[A+14]=_[A+8],_[A+15]=T[I[P]],_[A+16]=T[I[P]+1],_[A+17]=T[I[P]+2],E+=12,A+=18;break;case"triangles":for(var R=0,L=O.length;R<L;R++)b[E]=w[O[R]],b[E+1]=w[O[R]+1],_[A]=T[I[R]],_[A+1]=T[I[R]+1],_[A+2]=T[I[R]+2],E+=2,A+=3}}c?p.clearColor(c[0]/255,c[1]/255,c[2]/255,1):p.clearColor(0,0,0,0),p.clear(p.COLOR_BUFFER_BIT);var D=p.createBuffer();p.bindBuffer(p.ARRAY_BUFFER,D),p.bufferData(p.ARRAY_BUFFER,b,p.STATIC_DRAW),p.enableVertexAttribArray(h.positionLocation),p.vertexAttribPointer(h.positionLocation,2,p.FLOAT,!1,0,0);var N=p.createBuffer();return p.bindBuffer(p.ARRAY_BUFFER,N),p.bufferData(p.ARRAY_BUFFER,_,p.STATIC_DRAW),p.enableVertexAttribArray(h.colorLocation),p.vertexAttribPointer(h.colorLocation,3,p.UNSIGNED_BYTE,!1,0,0),p.uniform2f(h.scaleLocation,d.scaleX,d.scaleY),p.uniform2f(h.offsetLocation,d.offsetX,d.offsetY),p.drawArrays(p.TRIANGLES,0,v),p.flush(),p.deleteBuffer(D),p.deleteBuffer(N),f},cleanup:function(){c&&c.canvas&&(c.canvas.width=0,c.canvas.height=0),l&&l.canvas&&(l.canvas.width=0,l.canvas.height=0),c=null,l=null}}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderTextLayer=void 0;var r=n(1),i=function(){var e=/\S/;function t(t,n,i){var o,s=document.createElement("span"),a={angle:0,canvasWidth:0,isWhitespace:!1,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1};if(t._textDivs.push(s),o=n.str,!e.test(o))return a.isWhitespace=!0,void t._textDivProperties.set(s,a);var c=r.Util.transform(t._viewport.transform,n.transform),l=Math.atan2(c[1],c[0]),u=i[n.fontName];u.vertical&&(l+=Math.PI/2);var d,h,f=Math.sqrt(c[2]*c[2]+c[3]*c[3]),p=f;if(u.ascent?p=u.ascent*p:u.descent&&(p=(1+u.descent)*p),0===l?(d=c[4],h=c[5]-p):(d=c[4]+p*Math.sin(l),h=c[5]-p*Math.cos(l)),s.style.left="".concat(d,"px"),s.style.top="".concat(h,"px"),s.style.fontSize="".concat(f,"px"),s.style.fontFamily=u.fontFamily,s.textContent=n.str,t._fontInspectorEnabled&&(s.dataset.fontName=n.fontName),0!==l&&(a.angle=l*(180/Math.PI)),n.str.length>1&&(u.vertical?a.canvasWidth=n.height*t._viewport.scale:a.canvasWidth=n.width*t._viewport.scale),t._textDivProperties.set(s,a),t._textContentStream&&t._layoutText(s),t._enhanceTextSelection){var g=1,m=0;0!==l&&(g=Math.cos(l),m=Math.sin(l));var y,v,b=(u.vertical?n.height:n.width)*t._viewport.scale,_=f;0!==l?(y=[g,m,-m,g,d,h],v=r.Util.getAxialAlignedBoundingBox([0,0,b,_],y)):v=[d,h,d+b,h+_],t._bounds.push({left:v[0],top:v[1],right:v[2],bottom:v[3],div:s,size:[b,_],m:y})}}function n(e){if(!e._canceled){var t=e._textDivs,n=e._capability,r=t.length;if(r>1e5)return e._renderingDone=!0,void n.resolve();if(!e._textContentStream)for(var i=0;i<r;i++)e._layoutText(t[i]);e._renderingDone=!0,n.resolve()}}function i(e){for(var t=e._bounds,n=e._viewport,i=function(e,t,n){var r=n.map((function(e,t){return{x1:e.left,y1:e.top,x2:e.right,y2:e.bottom,index:t,x1New:void 0,x2New:void 0}}));o(e,r);var i=new Array(n.length);return r.forEach((function(e){var t=e.index;i[t]={left:e.x1New,top:0,right:e.x2New,bottom:0}})),n.map((function(t,n){var o=i[n],s=r[n];s.x1=t.top,s.y1=e-o.right,s.x2=t.bottom,s.y2=e-o.left,s.index=n,s.x1New=void 0,s.x2New=void 0})),o(t,r),r.forEach((function(e){var t=e.index;i[t].top=e.x1New,i[t].bottom=e.x2New})),i}(n.width,n.height,t),s=0;s<i.length;s++){var a=t[s].div,c=e._textDivProperties.get(a);if(0!==c.angle){var l=i[s],u=t[s],d=u.m,h=d[0],f=d[1],p=[[0,0],[0,u.size[1]],[u.size[0],0],u.size],g=new Float64Array(64);p.forEach((function(e,t){var n=r.Util.applyTransform(e,d);g[t+0]=h&&(l.left-n[0])/h,g[t+4]=f&&(l.top-n[1])/f,g[t+8]=h&&(l.right-n[0])/h,g[t+12]=f&&(l.bottom-n[1])/f,g[t+16]=f&&(l.left-n[0])/-f,g[t+20]=h&&(l.top-n[1])/h,g[t+24]=f&&(l.right-n[0])/-f,g[t+28]=h&&(l.bottom-n[1])/h,g[t+32]=h&&(l.left-n[0])/-h,g[t+36]=f&&(l.top-n[1])/-f,g[t+40]=h&&(l.right-n[0])/-h,g[t+44]=f&&(l.bottom-n[1])/-f,g[t+48]=f&&(l.left-n[0])/f,g[t+52]=h&&(l.top-n[1])/-h,g[t+56]=f&&(l.right-n[0])/f,g[t+60]=h&&(l.bottom-n[1])/-h}));var m=function(e,t,n){for(var r=0,i=0;i<n;i++){var o=e[t++];o>0&&(r=r?Math.min(o,r):o)}return r},y=1+Math.min(Math.abs(h),Math.abs(f));c.paddingLeft=m(g,32,16)/y,c.paddingTop=m(g,48,16)/y,c.paddingRight=m(g,0,16)/y,c.paddingBottom=m(g,16,16)/y,e._textDivProperties.set(a,c)}else c.paddingLeft=t[s].left-i[s].left,c.paddingTop=t[s].top-i[s].top,c.paddingRight=i[s].right-t[s].right,c.paddingBottom=i[s].bottom-t[s].bottom,e._textDivProperties.set(a,c)}}function o(e,t){t.sort((function(e,t){return e.x1-t.x1||e.index-t.index}));var n=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];t.forEach((function(e){for(var t=0;t<n.length&&n[t].end<=e.y1;)t++;for(var r,i,o=n.length-1;o>=0&&n[o].start>=e.y2;)o--;var s,a,c=-1/0;for(s=t;s<=o;s++){var l;(l=(i=(r=n[s]).boundary).x2>e.x1?i.index>e.index?i.x1New:e.x1:void 0===i.x2New?(i.x2+e.x1)/2:i.x2New)>c&&(c=l)}for(e.x1New=c,s=t;s<=o;s++)void 0===(i=(r=n[s]).boundary).x2New?i.x2>e.x1?i.index>e.index&&(i.x2New=i.x2):i.x2New=c:i.x2New>c&&(i.x2New=Math.max(c,i.x2));var u=[],d=null;for(s=t;s<=o;s++){var h=(i=(r=n[s]).boundary).x2>e.x2?i:e;d===h?u[u.length-1].end=r.end:(u.push({start:r.start,end:r.end,boundary:h}),d=h)}for(n[t].start<e.y1&&(u[0].start=e.y1,u.unshift({start:n[t].start,end:e.y1,boundary:n[t].boundary})),e.y2<n[o].end&&(u[u.length-1].end=e.y2,u.push({start:e.y2,end:n[o].end,boundary:n[o].boundary})),s=t;s<=o;s++)if(void 0===(i=(r=n[s]).boundary).x2New){var f=!1;for(a=t-1;!f&&a>=0&&n[a].start>=i.y1;a--)f=n[a].boundary===i;for(a=o+1;!f&&a<n.length&&n[a].end<=i.y2;a++)f=n[a].boundary===i;for(a=0;!f&&a<u.length;a++)f=u[a].boundary===i;f||(i.x2New=c)}Array.prototype.splice.apply(n,[t,o-t+1].concat(u))})),n.forEach((function(t){var n=t.boundary;void 0===n.x2New&&(n.x2New=Math.max(e,n.x2))}))}function s(e){var t=this,n=e.textContent,i=e.textContentStream,o=e.container,s=e.viewport,a=e.textDivs,c=e.textContentItemsStr,l=e.enhanceTextSelection;this._textContent=n,this._textContentStream=i,this._container=o,this._viewport=s,this._textDivs=a||[],this._textContentItemsStr=c||[],this._enhanceTextSelection=!!l,this._fontInspectorEnabled=!(!globalThis.FontInspector||!globalThis.FontInspector.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,r.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._capability.promise.finally((function(){t._layoutTextCtx&&(t._layoutTextCtx.canvas.width=0,t._layoutTextCtx.canvas.height=0,t._layoutTextCtx=null)})).catch((function(){}))}return s.prototype={get promise(){return this._capability.promise},cancel:function(){this._canceled=!0,this._reader&&(this._reader.cancel(new r.AbortException("TextLayer task cancelled.")),this._reader=null),null!==this._renderTimer&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))},_processItems:function(e,n){for(var r=0,i=e.length;r<i;r++)this._textContentItemsStr.push(e[r].str),t(this,e[r],n)},_layoutText:function(e){var t=this._textDivProperties.get(e);if(!t.isWhitespace){var n="";if(0!==t.canvasWidth){var r=e.style,i=r.fontSize,o=r.fontFamily;i===this._layoutTextLastFontSize&&o===this._layoutTextLastFontFamily||(this._layoutTextCtx.font="".concat(i," ").concat(o),this._layoutTextLastFontSize=i,this._layoutTextLastFontFamily=o);var s=this._layoutTextCtx.measureText(e.textContent).width;s>0&&(t.scale=t.canvasWidth/s,n="scaleX(".concat(t.scale,")"))}0!==t.angle&&(n="rotate(".concat(t.angle,"deg) ").concat(n)),n.length>0&&(this._enhanceTextSelection&&(t.originalTransform=n),e.style.transform=n),this._textDivProperties.set(e,t),this._container.appendChild(e)}},_render:function(e){var t=this,i=(0,r.createPromiseCapability)(),o=Object.create(null),s=document.createElement("canvas");if(s.mozOpaque=!0,this._layoutTextCtx=s.getContext("2d",{alpha:!1}),this._textContent){var a=this._textContent.items,c=this._textContent.styles;this._processItems(a,c),i.resolve()}else{if(!this._textContentStream)throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');this._reader=this._textContentStream.getReader(),function e(){t._reader.read().then((function(n){var r=n.value;n.done?i.resolve():(Object.assign(o,r.styles),t._processItems(r.items,o),e())}),i.reject)}()}i.promise.then((function(){o=null,e?t._renderTimer=setTimeout((function(){n(t),t._renderTimer=null}),e):n(t)}),this._capability.reject)},expandTextDivs:function(e){if(this._enhanceTextSelection&&this._renderingDone){null!==this._bounds&&(i(this),this._bounds=null);for(var t=[],n=[],r=0,o=this._textDivs.length;r<o;r++){var s=this._textDivs[r],a=this._textDivProperties.get(s);a.isWhitespace||(e?(t.length=0,n.length=0,a.originalTransform&&t.push(a.originalTransform),a.paddingTop>0?(n.push("".concat(a.paddingTop,"px")),t.push("translateY(".concat(-a.paddingTop,"px)"))):n.push(0),a.paddingRight>0?n.push("".concat(a.paddingRight/a.scale,"px")):n.push(0),a.paddingBottom>0?n.push("".concat(a.paddingBottom,"px")):n.push(0),a.paddingLeft>0?(n.push("".concat(a.paddingLeft/a.scale,"px")),t.push("translateX(".concat(-a.paddingLeft/a.scale,"px)"))):n.push(0),s.style.padding=n.join(" "),t.length&&(s.style.transform=t.join(" "))):(s.style.padding=null,s.style.transform=a.originalTransform))}}}},function(e){var t=new s({textContent:e.textContent,textContentStream:e.textContentStream,container:e.container,viewport:e.viewport,textDivs:e.textDivs,textContentItemsStr:e.textContentItemsStr,enhanceTextSelection:e.enhanceTextSelection});return t._render(e.timeout),t}}();t.renderTextLayer=i},function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationLayer=void 0;var i=n(223),o=n(1);function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(){return c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},c.apply(this,arguments)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=f(e);if(t){var o=f(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}(this,n)}}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),e}var y=function(){function e(){p(this,e)}return m(e,null,[{key:"create",value:function(e){switch(e.data.annotationType){case o.AnnotationType.LINK:return new b(e);case o.AnnotationType.TEXT:return new _(e);case o.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new T(e);case"Btn":return e.data.radioButton?new A(e):e.data.checkBox?new E(e):new S(e);case"Ch":return new O(e)}return new w(e);case o.AnnotationType.POPUP:return new I(e);case o.AnnotationType.FREETEXT:return new k(e);case o.AnnotationType.LINE:return new P(e);case o.AnnotationType.SQUARE:return new x(e);case o.AnnotationType.CIRCLE:return new R(e);case o.AnnotationType.POLYLINE:return new L(e);case o.AnnotationType.CARET:return new N(e);case o.AnnotationType.INK:return new j(e);case o.AnnotationType.POLYGON:return new D(e);case o.AnnotationType.HIGHLIGHT:return new M(e);case o.AnnotationType.UNDERLINE:return new F(e);case o.AnnotationType.SQUIGGLY:return new U(e);case o.AnnotationType.STRIKEOUT:return new B(e);case o.AnnotationType.STAMP:return new G(e);case o.AnnotationType.FILEATTACHMENT:return new q(e);default:return new v(e)}}}]),e}(),v=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];p(this,e),this.isRenderable=n,this.data=t.data,this.layer=t.layer,this.page=t.page,this.viewport=t.viewport,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderInteractiveForms=t.renderInteractiveForms,this.svgFactory=t.svgFactory,n&&(this.container=this._createContainer(r))}return m(e,[{key:"_createContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.data,n=this.page,r=this.viewport,i=document.createElement("section"),s=t.rect[2]-t.rect[0],a=t.rect[3]-t.rect[1];i.setAttribute("data-annotation-id",t.id);var c=o.Util.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]);if(i.style.transform="matrix(".concat(r.transform.join(","),")"),i.style.transformOrigin="-".concat(c[0],"px -").concat(c[1],"px"),!e&&t.borderStyle.width>0){i.style.borderWidth="".concat(t.borderStyle.width,"px"),t.borderStyle.style!==o.AnnotationBorderStyleType.UNDERLINE&&(s-=2*t.borderStyle.width,a-=2*t.borderStyle.width);var l=t.borderStyle.horizontalCornerRadius,u=t.borderStyle.verticalCornerRadius;if(l>0||u>0){var d="".concat(l,"px / ").concat(u,"px");i.style.borderRadius=d}switch(t.borderStyle.style){case o.AnnotationBorderStyleType.SOLID:i.style.borderStyle="solid";break;case o.AnnotationBorderStyleType.DASHED:i.style.borderStyle="dashed";break;case o.AnnotationBorderStyleType.BEVELED:(0,o.warn)("Unimplemented border style: beveled");break;case o.AnnotationBorderStyleType.INSET:(0,o.warn)("Unimplemented border style: inset");break;case o.AnnotationBorderStyleType.UNDERLINE:i.style.borderBottomStyle="solid"}t.color?i.style.borderColor=o.Util.makeCssRgb(0|t.color[0],0|t.color[1],0|t.color[2]):i.style.borderWidth=0}return i.style.left="".concat(c[0],"px"),i.style.top="".concat(c[1],"px"),i.style.width="".concat(s,"px"),i.style.height="".concat(a,"px"),i}},{key:"_createPopup",value:function(e,t,n){t||((t=document.createElement("div")).style.height=e.style.height,t.style.width=e.style.width,e.appendChild(t));var r=new C({container:e,trigger:t,color:n.color,title:n.title,modificationDate:n.modificationDate,contents:n.contents,hideWrapper:!0}).render();r.style.left=e.style.width,e.appendChild(r)}},{key:"render",value:function(){(0,o.unreachable)("Abstract method `AnnotationElement.render` called")}}]),e}(),b=function(e){l(n,e);var t=d(n);function n(e){p(this,n);var r=!!(e.data.url||e.data.dest||e.data.action);return t.call(this,e,r)}return m(n,[{key:"render",value:function(){this.container.className="linkAnnotation";var e=this.data,t=this.linkService,n=document.createElement("a");return e.url?(0,i.addLinkAttributes)(n,{url:e.url,target:e.newWindow?i.LinkTarget.BLANK:t.externalLinkTarget,rel:t.externalLinkRel,enabled:t.externalLinkEnabled}):e.action?this._bindNamedAction(n,e.action):this._bindLink(n,e.dest),this.container.appendChild(n),this.container}},{key:"_bindLink",value:function(e,t){var n=this;e.href=this.linkService.getDestinationHash(t),e.onclick=function(){return t&&n.linkService.navigateTo(t),!1},t&&(e.className="internalLink")}},{key:"_bindNamedAction",value:function(e,t){var n=this;e.href=this.linkService.getAnchorUrl(""),e.onclick=function(){return n.linkService.executeNamedAction(t),!1},e.className="internalLink"}}]),n}(v),_=function(e){l(n,e);var t=d(n);function n(e){p(this,n);var r=!!(e.data.hasPopup||e.data.title||e.data.contents);return t.call(this,e,r)}return m(n,[{key:"render",value:function(){this.container.className="textAnnotation";var e=document.createElement("img");return e.style.height=this.container.style.height,e.style.width=this.container.style.width,e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(this.container,e,this.data),this.container.appendChild(e),this.container}}]),n}(v),w=function(e){l(n,e);var t=d(n);function n(){return p(this,n),t.apply(this,arguments)}return m(n,[{key:"render",value:function(){return this.container}}]),n}(v),T=function(e){l(n,e);var t=d(n);function n(e){p(this,n);var r=e.renderInteractiveForms||!e.data.hasAppearance&&!!e.data.fieldValue;return t.call(this,e,r)}return m(n,[{key:"render",value:function(){this.container.className="textWidgetAnnotation";var e=null;if(this.renderInteractiveForms){if(this.data.multiLine?(e=document.createElement("textarea")).textContent=this.data.fieldValue:((e=document.createElement("input")).type="text",e.setAttribute("value",this.data.fieldValue)),e.disabled=this.data.readOnly,null!==this.data.maxLen&&(e.maxLength=this.data.maxLen),this.data.comb){var t=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;e.classList.add("comb"),e.style.letterSpacing="calc(".concat(t,"px - 1ch)")}}else{(e=document.createElement("div")).textContent=this.data.fieldValue,e.style.verticalAlign="middle",e.style.display="table-cell";var n=null;this.data.fontRefName&&this.page.commonObjs.has(this.data.fontRefName)&&(n=this.page.commonObjs.get(this.data.fontRefName)),this._setTextStyle(e,n)}return null!==this.data.textAlignment&&(e.style.textAlign=["left","center","right"][this.data.textAlignment]),this.container.appendChild(e),this.container}},{key:"_setTextStyle",value:function(e,t){var n=e.style;if(n.fontSize="".concat(this.data.fontSize,"px"),n.direction=this.data.fontDirection<0?"rtl":"ltr",t){var r="normal";t.black?r="900":t.bold&&(r="bold"),n.fontWeight=r,n.fontStyle=t.italic?"italic":"normal";var i=t.loadedName?'"'.concat(t.loadedName,'", '):"",o=t.fallbackName||"Helvetica, sans-serif";n.fontFamily=i+o}}}]),n}(w),E=function(e){l(n,e);var t=d(n);function n(e){return p(this,n),t.call(this,e,e.renderInteractiveForms)}return m(n,[{key:"render",value:function(){this.container.className="buttonWidgetAnnotation checkBox";var e=document.createElement("input");return e.disabled=this.data.readOnly,e.type="checkbox",this.data.fieldValue&&"Off"!==this.data.fieldValue&&e.setAttribute("checked",!0),this.container.appendChild(e),this.container}}]),n}(w),A=function(e){l(n,e);var t=d(n);function n(e){return p(this,n),t.call(this,e,e.renderInteractiveForms)}return m(n,[{key:"render",value:function(){this.container.className="buttonWidgetAnnotation radioButton";var e=document.createElement("input");return e.disabled=this.data.readOnly,e.type="radio",e.name=this.data.fieldName,this.data.fieldValue===this.data.buttonValue&&e.setAttribute("checked",!0),this.container.appendChild(e),this.container}}]),n}(w),S=function(e){l(n,e);var t=d(n);function n(){return p(this,n),t.apply(this,arguments)}return m(n,[{key:"render",value:function(){var e=c(f(n.prototype),"render",this).call(this);return e.className="buttonWidgetAnnotation pushButton",e}}]),n}(b),O=function(e){l(n,e);var t=d(n);function n(e){return p(this,n),t.call(this,e,e.renderInteractiveForms)}return m(n,[{key:"render",value:function(){this.container.className="choiceWidgetAnnotation";var e=document.createElement("select");e.disabled=this.data.readOnly,this.data.combo||(e.size=this.data.options.length,this.data.multiSelect&&(e.multiple=!0));var t,n=s(this.data.options);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=document.createElement("option");i.textContent=r.displayValue,i.value=r.exportValue,this.data.fieldValue.includes(r.displayValue)&&i.setAttribute("selected",!0),e.appendChild(i)}}catch(e){n.e(e)}finally{n.f()}return this.container.appendChild(e),this.container}}]),n}(w),I=function(e){l(n,e);var t=d(n);function n(e){p(this,n);var r=!(!e.data.title&&!e.data.contents);return t.call(this,e,r)}return m(n,[{key:"render",value:function(){if(this.container.className="popupAnnotation",["Line","Square","Circle","PolyLine","Polygon","Ink"].includes(this.data.parentType))return this.container;var e='[data-annotation-id="'.concat(this.data.parentId,'"]'),t=this.layer.querySelector(e);if(!t)return this.container;var n=new C({container:this.container,trigger:t,color:this.data.color,title:this.data.title,modificationDate:this.data.modificationDate,contents:this.data.contents}),r=parseFloat(t.style.left),i=parseFloat(t.style.width);return this.container.style.transformOrigin="-".concat(r+i,"px -").concat(t.style.top),this.container.style.left="".concat(r+i,"px"),this.container.appendChild(n.render()),this.container}}]),n}(v),C=function(){function e(t){p(this,e),this.container=t.container,this.trigger=t.trigger,this.color=t.color,this.title=t.title,this.modificationDate=t.modificationDate,this.contents=t.contents,this.hideWrapper=t.hideWrapper||!1,this.pinned=!1}return m(e,[{key:"render",value:function(){var e=document.createElement("div");e.className="popupWrapper",this.hideElement=this.hideWrapper?e:this.container,this.hideElement.setAttribute("hidden",!0);var t=document.createElement("div");t.className="popup";var n=this.color;if(n){var r=.7*(255-n[0])+n[0],s=.7*(255-n[1])+n[1],a=.7*(255-n[2])+n[2];t.style.backgroundColor=o.Util.makeCssRgb(0|r,0|s,0|a)}var c=document.createElement("h1");c.textContent=this.title,t.appendChild(c);var l=i.PDFDateString.toDateObject(this.modificationDate);if(l){var u=document.createElement("span");u.textContent="{{date}}, {{time}}",u.dataset.l10nId="annotation_date_string",u.dataset.l10nArgs=JSON.stringify({date:l.toLocaleDateString(),time:l.toLocaleTimeString()}),t.appendChild(u)}var d=this._formatContents(this.contents);return t.appendChild(d),this.trigger.addEventListener("click",this._toggle.bind(this)),this.trigger.addEventListener("mouseover",this._show.bind(this,!1)),this.trigger.addEventListener("mouseout",this._hide.bind(this,!1)),t.addEventListener("click",this._hide.bind(this,!0)),e.appendChild(t),e}},{key:"_formatContents",value:function(e){for(var t=document.createElement("p"),n=e.split(/(?:\r\n?|\n)/),r=0,i=n.length;r<i;++r){var o=n[r];t.appendChild(document.createTextNode(o)),r<i-1&&t.appendChild(document.createElement("br"))}return t}},{key:"_toggle",value:function(){this.pinned?this._hide(!0):this._show(!0)}},{key:"_show",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(this.pinned=!0),this.hideElement.hasAttribute("hidden")&&(this.hideElement.removeAttribute("hidden"),this.container.style.zIndex+=1)}},{key:"_hide",value:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(this.pinned=!1),this.hideElement.hasAttribute("hidden")||this.pinned||(this.hideElement.setAttribute("hidden",!0),this.container.style.zIndex-=1)}}]),e}(),k=function(e){l(n,e);var t=d(n);function n(e){p(this,n);var r=!!(e.data.hasPopup||e.data.title||e.data.contents);return t.call(this,e,r,!0)}return m(n,[{key:"render",value:function(){return this.container.className="freeTextAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),n}(v),P=function(e){l(n,e);var t=d(n);function n(e){p(this,n);var r=!!(e.data.hasPopup||e.data.title||e.data.contents);return t.call(this,e,r,!0)}return m(n,[{key:"render",value:function(){this.container.className="lineAnnotation";var e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],r=this.svgFactory.create(t,n),i=this.svgFactory.createElement("svg:line");return i.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),i.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),i.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),i.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),i.setAttribute("stroke-width",e.borderStyle.width||1),i.setAttribute("stroke","transparent"),r.appendChild(i),this.container.append(r),this._createPopup(this.container,i,e),this.container}}]),n}(v),x=function(e){l(n,e);var t=d(n);function n(e){p(this,n);var r=!!(e.data.hasPopup||e.data.title||e.data.contents);return t.call(this,e,r,!0)}return m(n,[{key:"render",value:function(){this.container.className="squareAnnotation";var e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],r=this.svgFactory.create(t,n),i=e.borderStyle.width,o=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",i/2),o.setAttribute("y",i/2),o.setAttribute("width",t-i),o.setAttribute("height",n-i),o.setAttribute("stroke-width",i||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","none"),r.appendChild(o),this.container.append(r),this._createPopup(this.container,o,e),this.container}}]),n}(v),R=function(e){l(n,e);var t=d(n);function n(e){p(this,n);var r=!!(e.data.hasPopup||e.data.title||e.data.contents);return t.call(this,e,r,!0)}return m(n,[{key:"render",value:function(){this.container.className="circleAnnotation";var e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],r=this.svgFactory.create(t,n),i=e.borderStyle.width,o=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",t/2),o.setAttribute("cy",n/2),o.setAttribute("rx",t/2-i/2),o.setAttribute("ry",n/2-i/2),o.setAttribute("stroke-width",i||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","none"),r.appendChild(o),this.container.append(r),this._createPopup(this.container,o,e),this.container}}]),n}(v),L=function(e){l(n,e);var t=d(n);function n(e){var r;p(this,n);var i=!!(e.data.hasPopup||e.data.title||e.data.contents);return(r=t.call(this,e,i,!0)).containerClassName="polylineAnnotation",r.svgElementName="svg:polyline",r}return m(n,[{key:"render",value:function(){this.container.className=this.containerClassName;var e,t=this.data,n=t.rect[2]-t.rect[0],r=t.rect[3]-t.rect[1],i=this.svgFactory.create(n,r),o=[],a=s(t.vertices);try{for(a.s();!(e=a.n()).done;){var c=e.value,l=c.x-t.rect[0],u=t.rect[3]-c.y;o.push(l+","+u)}}catch(e){a.e(e)}finally{a.f()}o=o.join(" ");var d=this.svgFactory.createElement(this.svgElementName);return d.setAttribute("points",o),d.setAttribute("stroke-width",t.borderStyle.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","none"),i.appendChild(d),this.container.append(i),this._createPopup(this.container,d,t),this.container}}]),n}(v),D=function(e){l(n,e);var t=d(n);function n(e){var r;return p(this,n),(r=t.call(this,e)).containerClassName="polygonAnnotation",r.svgElementName="svg:polygon",r}return n}(L),N=function(e){l(n,e);var t=d(n);function n(e){p(this,n);var r=!!(e.data.hasPopup||e.data.title||e.data.contents);return t.call(this,e,r,!0)}return m(n,[{key:"render",value:function(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),n}(v),j=function(e){l(n,e);var t=d(n);function n(e){var r;p(this,n);var i=!!(e.data.hasPopup||e.data.title||e.data.contents);return(r=t.call(this,e,i,!0)).containerClassName="inkAnnotation",r.svgElementName="svg:polyline",r}return m(n,[{key:"render",value:function(){this.container.className=this.containerClassName;var e,t=this.data,n=t.rect[2]-t.rect[0],r=t.rect[3]-t.rect[1],i=this.svgFactory.create(n,r),o=s(t.inkLists);try{for(o.s();!(e=o.n()).done;){var a,c=e.value,l=[],u=s(c);try{for(u.s();!(a=u.n()).done;){var d=a.value,h=d.x-t.rect[0],f=t.rect[3]-d.y;l.push("".concat(h,",").concat(f))}}catch(e){u.e(e)}finally{u.f()}l=l.join(" ");var p=this.svgFactory.createElement(this.svgElementName);p.setAttribute("points",l),p.setAttribute("stroke-width",t.borderStyle.width||1),p.setAttribute("stroke","transparent"),p.setAttribute("fill","none"),this._createPopup(this.container,p,t),i.appendChild(p)}}catch(e){o.e(e)}finally{o.f()}return this.container.append(i),this.container}}]),n}(v),M=function(e){l(n,e);var t=d(n);function n(e){p(this,n);var r=!!(e.data.hasPopup||e.data.title||e.data.contents);return t.call(this,e,r,!0)}return m(n,[{key:"render",value:function(){return this.container.className="highlightAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),n}(v),F=function(e){l(n,e);var t=d(n);function n(e){p(this,n);var r=!!(e.data.hasPopup||e.data.title||e.data.contents);return t.call(this,e,r,!0)}return m(n,[{key:"render",value:function(){return this.container.className="underlineAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),n}(v),U=function(e){l(n,e);var t=d(n);function n(e){p(this,n);var r=!!(e.data.hasPopup||e.data.title||e.data.contents);return t.call(this,e,r,!0)}return m(n,[{key:"render",value:function(){return this.container.className="squigglyAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),n}(v),B=function(e){l(n,e);var t=d(n);function n(e){p(this,n);var r=!!(e.data.hasPopup||e.data.title||e.data.contents);return t.call(this,e,r,!0)}return m(n,[{key:"render",value:function(){return this.container.className="strikeoutAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),n}(v),G=function(e){l(n,e);var t=d(n);function n(e){p(this,n);var r=!!(e.data.hasPopup||e.data.title||e.data.contents);return t.call(this,e,r,!0)}return m(n,[{key:"render",value:function(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}]),n}(v),q=function(e){l(n,e);var t=d(n);function n(e){var r;p(this,n);var s=(r=t.call(this,e,!0)).data.file,a=s.filename,c=s.content;return r.filename=(0,i.getFilenameFromUrl)(a),r.content=c,r.linkService.eventBus&&r.linkService.eventBus.dispatch("fileattachmentannotation",{source:h(r),id:(0,o.stringToPDFString)(a),filename:a,content:c}),r}return m(n,[{key:"render",value:function(){this.container.className="fileAttachmentAnnotation";var e=document.createElement("div");return e.style.height=this.container.style.height,e.style.width=this.container.style.width,e.addEventListener("dblclick",this._download.bind(this)),this.data.hasPopup||!this.data.title&&!this.data.contents||this._createPopup(this.container,e,this.data),this.container.appendChild(e),this.container}},{key:"_download",value:function(){this.downloadManager?this.downloadManager.downloadData(this.content,this.filename,""):(0,o.warn)("Download cannot be started due to unavailable download manager")}}]),n}(v),H=function(){function e(){p(this,e)}return m(e,null,[{key:"render",value:function(e){var t,n=[],r=[],a=s(e.annotations);try{for(a.s();!(t=a.n()).done;){var c=t.value;c&&(c.annotationType!==o.AnnotationType.POPUP?n.push(c):r.push(c))}}catch(e){a.e(e)}finally{a.f()}r.length&&n.push.apply(n,r);for(var l=0,u=n;l<u.length;l++){var d=u[l],h=y.create({data:d,layer:e.div,page:e.page,viewport:e.viewport,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderInteractiveForms:e.renderInteractiveForms||!1,svgFactory:new i.DOMSVGFactory});h.isRenderable&&e.div.appendChild(h.render())}}},{key:"update",value:function(e){var t,n=s(e.annotations);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=e.div.querySelector('[data-annotation-id="'.concat(r.id,'"]'));i&&(i.style.transform="matrix(".concat(e.viewport.transform.join(","),")"))}}catch(e){n.e(e)}finally{n.f()}e.div.removeAttribute("hidden")}}]),e}();t.AnnotationLayer=H},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SVGGraphics=void 0;var r=n(1),i=n(223),o=n(65);function s(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}}(e,t)||l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=l(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){a=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function l(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&h(e.prototype,t),n&&h(e,n),e}var p=function(){throw new Error("Not implemented: SVGGraphics")};t.SVGGraphics=p;var g=function(e){if(Number.isInteger(e))return e.toString();var t=e.toFixed(10),n=t.length-1;if("0"!==t[n])return t;do{n--}while("0"===t[n]);return t.substring(0,"."===t[n]?n:n+1)},m=function(e){if(0===e[4]&&0===e[5]){if(0===e[1]&&0===e[2])return 1===e[0]&&1===e[3]?"":"scale(".concat(g(e[0])," ").concat(g(e[3]),")");if(e[0]===e[3]&&e[1]===-e[2]){var t=180*Math.acos(e[0])/Math.PI;return"rotate(".concat(g(t),")")}}else if(1===e[0]&&0===e[1]&&0===e[2]&&1===e[3])return"translate(".concat(g(e[4])," ").concat(g(e[5]),")");return"matrix(".concat(g(e[0])," ").concat(g(e[1])," ").concat(g(e[2])," ").concat(g(e[3])," ").concat(g(e[4])," ")+"".concat(g(e[5]),")")},y={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},v="http://www.w3.org/1999/xlink",b=["butt","round","square"],_=["miter","round","bevel"],w=function(){for(var e=new Uint8Array([137,80,78,71,13,10,26,10]),t=new Int32Array(256),n=0;n<256;n++){for(var i=n,s=0;s<8;s++)i=1&i?3988292384^i>>1&2147483647:i>>1&2147483647;t[n]=i}function a(e,n,r,i){var o=i,s=n.length;r[o]=s>>24&255,r[o+1]=s>>16&255,r[o+2]=s>>8&255,r[o+3]=255&s,r[o+=4]=255&e.charCodeAt(0),r[o+1]=255&e.charCodeAt(1),r[o+2]=255&e.charCodeAt(2),r[o+3]=255&e.charCodeAt(3),o+=4,r.set(n,o);var a=function(e,n,r){for(var i=-1,o=n;o<r;o++){var s=255&(i^e[o]);i=i>>>8^t[s]}return~i}(r,i+4,o+=n.length);r[o]=a>>24&255,r[o+1]=a>>16&255,r[o+2]=a>>8&255,r[o+3]=255&a}function c(e){var t=e.length,n=65535,r=Math.ceil(t/n),i=new Uint8Array(2+t+5*r+4),o=0;i[o++]=120,i[o++]=156;for(var s=0;t>n;)i[o++]=0,i[o++]=255,i[o++]=255,i[o++]=0,i[o++]=0,i.set(e.subarray(s,s+n),o),o+=n,s+=n,t-=n;i[o++]=1,i[o++]=255&t,i[o++]=t>>8&255,i[o++]=255&~t,i[o++]=(65535&~t)>>8&255,i.set(e.subarray(s),o),o+=e.length-s;var a=function(e,t,n){for(var r=1,i=0,o=t;o<n;++o)i=(i+(r=(r+(255&e[o]))%65521))%65521;return i<<16|r}(e,0,e.length);return i[o++]=a>>24&255,i[o++]=a>>16&255,i[o++]=a>>8&255,i[o++]=255&a,i}function l(t,n,i,s){var l,u,d,h=t.width,f=t.height,p=t.data;switch(n){case r.ImageKind.GRAYSCALE_1BPP:u=0,l=1,d=h+7>>3;break;case r.ImageKind.RGB_24BPP:u=2,l=8,d=3*h;break;case r.ImageKind.RGBA_32BPP:u=6,l=8,d=4*h;break;default:throw new Error("invalid format")}for(var g=new Uint8Array((1+d)*f),m=0,y=0,v=0;v<f;++v)g[m++]=0,g.set(p.subarray(y,y+d),m),y+=d,m+=d;if(n===r.ImageKind.GRAYSCALE_1BPP&&s){m=0;for(var b=0;b<f;b++){m++;for(var _=0;_<d;_++)g[m++]^=255}}var w=new Uint8Array([h>>24&255,h>>16&255,h>>8&255,255&h,f>>24&255,f>>16&255,f>>8&255,255&f,l,u,0,0,0]),T=function(e){if(!o.isNodeJS)return c(e);try{var t;t=parseInt(process.versions.node)>=8?e:Buffer.from(e);var n=__webpack_require__(1377).deflateSync(t,{level:9});return n instanceof Uint8Array?n:new Uint8Array(n)}catch(e){(0,r.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+e)}return c(e)}(g),E=e.length+36+w.length+T.length,A=new Uint8Array(E),S=0;return A.set(e,S),a("IHDR",w,A,S+=e.length),a("IDATA",T,A,S+=12+w.length),S+=12+T.length,a("IEND",new Uint8Array(0),A,S),(0,r.createObjectURL)(A,"image/png",i)}return function(e,t,n){return l(e,void 0===e.kind?r.ImageKind.GRAYSCALE_1BPP:e.kind,t,n)}}(),T=function(){function e(){d(this,e),this.fontSizeScale=1,this.fontWeight=y.fontWeight,this.fontSize=0,this.textMatrix=r.IDENTITY_MATRIX,this.fontMatrix=r.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=r.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=y.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}return f(e,[{key:"clone",value:function(){return Object.create(this)}},{key:"setCurrentPoint",value:function(e,t){this.x=e,this.y=t}}]),e}(),E=0,A=0,S=0;t.SVGGraphics=p=function(){function e(t,n,o){for(var s in d(this,e),this.svgFactory=new i.DOMSVGFactory,this.current=new T,this.transformMatrix=r.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=t,this.objs=n,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!o,this._operatorIdMapping=[],r.OPS)this._operatorIdMapping[r.OPS[s]]=s}return f(e,[{key:"save",value:function(){this.transformStack.push(this.transformMatrix);var e=this.current;this.extraStack.push(e),this.current=e.clone()}},{key:"restore",value:function(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}},{key:"group",value:function(e){this.save(),this.executeOpTree(e),this.restore()}},{key:"loadDependencies",value:function(e){for(var t=this,n=e.fnArray,i=e.argsArray,o=0,s=n.length;o<s;o++)if(n[o]===r.OPS.dependency){var a,l=c(i[o]);try{var u=function(){var e=a.value,n=e.startsWith("g_")?t.commonObjs:t.objs,r=new Promise((function(t){n.get(e,t)}));t.current.dependencies.push(r)};for(l.s();!(a=l.n()).done;)u()}catch(e){l.e(e)}finally{l.f()}}return Promise.all(this.current.dependencies)}},{key:"transform",value:function(e,t,n,i,o,s){var a=[e,t,n,i,o,s];this.transformMatrix=r.Util.transform(this.transformMatrix,a),this.tgrp=null}},{key:"getSVG",value:function(e,t){var n=this;this.viewport=t;var i=this._initialize(t);return this.loadDependencies(e).then((function(){return n.transformMatrix=r.IDENTITY_MATRIX,n.executeOpTree(n.convertOpList(e)),i}))}},{key:"convertOpList",value:function(e){for(var t=this._operatorIdMapping,n=e.argsArray,r=e.fnArray,i=[],o=0,s=r.length;o<s;o++){var a=r[o];i.push({fnId:a,fn:t[a],args:n[o]})}return function(e){var t,n=[],r=[],i=c(e);try{for(i.s();!(t=i.n()).done;){var o=t.value;"save"!==o.fn?"restore"===o.fn?n=r.pop():n.push(o):(n.push({fnId:92,fn:"group",items:[]}),r.push(n),n=n[n.length-1].items)}}catch(e){i.e(e)}finally{i.f()}return n}(i)}},{key:"executeOpTree",value:function(e){var t,n=c(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,o=i.fn,s=i.fnId,a=i.args;switch(0|s){case r.OPS.beginText:this.beginText();break;case r.OPS.dependency:break;case r.OPS.setLeading:this.setLeading(a);break;case r.OPS.setLeadingMoveText:this.setLeadingMoveText(a[0],a[1]);break;case r.OPS.setFont:this.setFont(a);break;case r.OPS.showText:case r.OPS.showSpacedText:this.showText(a[0]);break;case r.OPS.endText:this.endText();break;case r.OPS.moveText:this.moveText(a[0],a[1]);break;case r.OPS.setCharSpacing:this.setCharSpacing(a[0]);break;case r.OPS.setWordSpacing:this.setWordSpacing(a[0]);break;case r.OPS.setHScale:this.setHScale(a[0]);break;case r.OPS.setTextMatrix:this.setTextMatrix(a[0],a[1],a[2],a[3],a[4],a[5]);break;case r.OPS.setTextRise:this.setTextRise(a[0]);break;case r.OPS.setTextRenderingMode:this.setTextRenderingMode(a[0]);break;case r.OPS.setLineWidth:this.setLineWidth(a[0]);break;case r.OPS.setLineJoin:this.setLineJoin(a[0]);break;case r.OPS.setLineCap:this.setLineCap(a[0]);break;case r.OPS.setMiterLimit:this.setMiterLimit(a[0]);break;case r.OPS.setFillRGBColor:this.setFillRGBColor(a[0],a[1],a[2]);break;case r.OPS.setStrokeRGBColor:this.setStrokeRGBColor(a[0],a[1],a[2]);break;case r.OPS.setStrokeColorN:this.setStrokeColorN(a);break;case r.OPS.setFillColorN:this.setFillColorN(a);break;case r.OPS.shadingFill:this.shadingFill(a[0]);break;case r.OPS.setDash:this.setDash(a[0],a[1]);break;case r.OPS.setRenderingIntent:this.setRenderingIntent(a[0]);break;case r.OPS.setFlatness:this.setFlatness(a[0]);break;case r.OPS.setGState:this.setGState(a[0]);break;case r.OPS.fill:this.fill();break;case r.OPS.eoFill:this.eoFill();break;case r.OPS.stroke:this.stroke();break;case r.OPS.fillStroke:this.fillStroke();break;case r.OPS.eoFillStroke:this.eoFillStroke();break;case r.OPS.clip:this.clip("nonzero");break;case r.OPS.eoClip:this.clip("evenodd");break;case r.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case r.OPS.paintJpegXObject:this.paintJpegXObject(a[0],a[1],a[2]);break;case r.OPS.paintImageXObject:this.paintImageXObject(a[0]);break;case r.OPS.paintInlineImageXObject:this.paintInlineImageXObject(a[0]);break;case r.OPS.paintImageMaskXObject:this.paintImageMaskXObject(a[0]);break;case r.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(a[0],a[1]);break;case r.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case r.OPS.closePath:this.closePath();break;case r.OPS.closeStroke:this.closeStroke();break;case r.OPS.closeFillStroke:this.closeFillStroke();break;case r.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case r.OPS.nextLine:this.nextLine();break;case r.OPS.transform:this.transform(a[0],a[1],a[2],a[3],a[4],a[5]);break;case r.OPS.constructPath:this.constructPath(a[0],a[1]);break;case r.OPS.endPath:this.endPath();break;case 92:this.group(i.items);break;default:(0,r.warn)("Unimplemented operator ".concat(o))}}}catch(e){n.e(e)}finally{n.f()}}},{key:"setWordSpacing",value:function(e){this.current.wordSpacing=e}},{key:"setCharSpacing",value:function(e){this.current.charSpacing=e}},{key:"nextLine",value:function(){this.moveText(0,this.current.leading)}},{key:"setTextMatrix",value:function(e,t,n,r,i,o){var s=this.current;s.textMatrix=s.lineMatrix=[e,t,n,r,i,o],s.textMatrixScale=Math.sqrt(e*e+t*t),s.x=s.lineX=0,s.y=s.lineY=0,s.xcoords=[],s.tspan=this.svgFactory.createElement("svg:tspan"),s.tspan.setAttributeNS(null,"font-family",s.fontFamily),s.tspan.setAttributeNS(null,"font-size","".concat(g(s.fontSize),"px")),s.tspan.setAttributeNS(null,"y",g(-s.y)),s.txtElement=this.svgFactory.createElement("svg:text"),s.txtElement.appendChild(s.tspan)}},{key:"beginText",value:function(){var e=this.current;e.x=e.lineX=0,e.y=e.lineY=0,e.textMatrix=r.IDENTITY_MATRIX,e.lineMatrix=r.IDENTITY_MATRIX,e.textMatrixScale=1,e.tspan=this.svgFactory.createElement("svg:tspan"),e.txtElement=this.svgFactory.createElement("svg:text"),e.txtgrp=this.svgFactory.createElement("svg:g"),e.xcoords=[]}},{key:"moveText",value:function(e,t){var n=this.current;n.x=n.lineX+=e,n.y=n.lineY+=t,n.xcoords=[],n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size","".concat(g(n.fontSize),"px")),n.tspan.setAttributeNS(null,"y",g(-n.y))}},{key:"showText",value:function(e){var t=this.current,n=t.font,i=t.fontSize;if(0!==i){var o,s=t.charSpacing,a=t.wordSpacing,l=t.fontDirection,u=t.textHScale*l,d=n.vertical,h=i*t.fontMatrix[0],f=0,p=c(e);try{for(p.s();!(o=p.n()).done;){var v=o.value;if(null!==v)if((0,r.isNum)(v))f+=-v*i*.001;else{var b=v.width,_=v.fontChar,w=b*h+((v.isSpace?a:0)+s)*l;v.isInFont||n.missingFile?(t.xcoords.push(t.x+f),t.tspan.textContent+=_,f+=w):f+=w}else f+=l*a}}catch(e){p.e(e)}finally{p.f()}d?t.y-=f*u:t.x+=f*u,t.tspan.setAttributeNS(null,"x",t.xcoords.map(g).join(" ")),t.tspan.setAttributeNS(null,"y",g(-t.y)),t.tspan.setAttributeNS(null,"font-family",t.fontFamily),t.tspan.setAttributeNS(null,"font-size","".concat(g(t.fontSize),"px")),t.fontStyle!==y.fontStyle&&t.tspan.setAttributeNS(null,"font-style",t.fontStyle),t.fontWeight!==y.fontWeight&&t.tspan.setAttributeNS(null,"font-weight",t.fontWeight);var T=t.textRenderingMode&r.TextRenderingMode.FILL_STROKE_MASK;if(T===r.TextRenderingMode.FILL||T===r.TextRenderingMode.FILL_STROKE?(t.fillColor!==y.fillColor&&t.tspan.setAttributeNS(null,"fill",t.fillColor),t.fillAlpha<1&&t.tspan.setAttributeNS(null,"fill-opacity",t.fillAlpha)):t.textRenderingMode===r.TextRenderingMode.ADD_TO_PATH?t.tspan.setAttributeNS(null,"fill","transparent"):t.tspan.setAttributeNS(null,"fill","none"),T===r.TextRenderingMode.STROKE||T===r.TextRenderingMode.FILL_STROKE){var E=1/(t.textMatrixScale||1);this._setStrokeAttributes(t.tspan,E)}var A=t.textMatrix;0!==t.textRise&&((A=A.slice())[5]+=t.textRise),t.txtElement.setAttributeNS(null,"transform","".concat(m(A)," scale(").concat(g(u),", -1)")),t.txtElement.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),t.txtElement.appendChild(t.tspan),t.txtgrp.appendChild(t.txtElement),this._ensureTransformGroup().appendChild(t.txtElement)}}},{key:"setLeadingMoveText",value:function(e,t){this.setLeading(-t),this.moveText(e,t)}},{key:"addFontStyle",value:function(e){this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));var t=(0,r.createObjectURL)(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+='@font-face { font-family: "'.concat(e.loadedName,'";')+" src: url(".concat(t,"); }\n")}},{key:"setFont",value:function(e){var t=this.current,n=this.commonObjs.get(e[0]),i=e[1];t.font=n,this.embedFonts&&n.data&&!this.embeddedFonts[n.loadedName]&&(this.addFontStyle(n),this.embeddedFonts[n.loadedName]=n),t.fontMatrix=n.fontMatrix?n.fontMatrix:r.FONT_IDENTITY_MATRIX;var o="normal";n.black?o="900":n.bold&&(o="bold");var s=n.italic?"italic":"normal";i<0?(i=-i,t.fontDirection=-1):t.fontDirection=1,t.fontSize=i,t.fontFamily=n.loadedName,t.fontWeight=o,t.fontStyle=s,t.tspan=this.svgFactory.createElement("svg:tspan"),t.tspan.setAttributeNS(null,"y",g(-t.y)),t.xcoords=[]}},{key:"endText",value:function(){var e=this.current;e.textRenderingMode&r.TextRenderingMode.ADD_TO_PATH_FLAG&&e.txtElement&&e.txtElement.hasChildNodes()&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())}},{key:"setLineWidth",value:function(e){e>0&&(this.current.lineWidth=e)}},{key:"setLineCap",value:function(e){this.current.lineCap=b[e]}},{key:"setLineJoin",value:function(e){this.current.lineJoin=_[e]}},{key:"setMiterLimit",value:function(e){this.current.miterLimit=e}},{key:"setStrokeAlpha",value:function(e){this.current.strokeAlpha=e}},{key:"setStrokeRGBColor",value:function(e,t,n){this.current.strokeColor=r.Util.makeCssRgb(e,t,n)}},{key:"setFillAlpha",value:function(e){this.current.fillAlpha=e}},{key:"setFillRGBColor",value:function(e,t,n){this.current.fillColor=r.Util.makeCssRgb(e,t,n),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[]}},{key:"setStrokeColorN",value:function(e){this.current.strokeColor=this._makeColorN_Pattern(e)}},{key:"setFillColorN",value:function(e){this.current.fillColor=this._makeColorN_Pattern(e)}},{key:"shadingFill",value:function(e){var t=this.viewport.width,n=this.viewport.height,i=r.Util.inverseTransform(this.transformMatrix),o=r.Util.applyTransform([0,0],i),s=r.Util.applyTransform([0,n],i),a=r.Util.applyTransform([t,0],i),c=r.Util.applyTransform([t,n],i),l=Math.min(o[0],s[0],a[0],c[0]),u=Math.min(o[1],s[1],a[1],c[1]),d=Math.max(o[0],s[0],a[0],c[0]),h=Math.max(o[1],s[1],a[1],c[1]),f=this.svgFactory.createElement("svg:rect");f.setAttributeNS(null,"x",l),f.setAttributeNS(null,"y",u),f.setAttributeNS(null,"width",d-l),f.setAttributeNS(null,"height",h-u),f.setAttributeNS(null,"fill",this._makeShadingPattern(e)),this._ensureTransformGroup().appendChild(f)}},{key:"_makeColorN_Pattern",value:function(e){return"TilingPattern"===e[0]?this._makeTilingPattern(e):this._makeShadingPattern(e)}},{key:"_makeTilingPattern",value:function(e){var t=e[1],n=e[2],i=e[3]||r.IDENTITY_MATRIX,o=a(e[4],4),c=o[0],l=o[1],u=o[2],d=o[3],h=e[5],f=e[6],p=e[7],g="shading".concat(S++),m=a(r.Util.applyTransform([c,l],i),2),y=m[0],v=m[1],b=a(r.Util.applyTransform([u,d],i),2),_=b[0],w=b[1],T=a(r.Util.singularValueDecompose2dScale(i),2),E=h*T[0],A=f*T[1],O=this.svgFactory.createElement("svg:pattern");O.setAttributeNS(null,"id",g),O.setAttributeNS(null,"patternUnits","userSpaceOnUse"),O.setAttributeNS(null,"width",E),O.setAttributeNS(null,"height",A),O.setAttributeNS(null,"x","".concat(y)),O.setAttributeNS(null,"y","".concat(v));var I=this.svg,C=this.transformMatrix,k=this.current.fillColor,P=this.current.strokeColor,x=this.svgFactory.create(_-y,w-v);if(this.svg=x,this.transformMatrix=i,2===p){var R=r.Util.makeCssRgb.apply(r.Util,s(t));this.current.fillColor=R,this.current.strokeColor=R}return this.executeOpTree(this.convertOpList(n)),this.svg=I,this.transformMatrix=C,this.current.fillColor=k,this.current.strokeColor=P,O.appendChild(x.childNodes[0]),this.defs.appendChild(O),"url(#".concat(g,")")}},{key:"_makeShadingPattern",value:function(e){switch(e[0]){case"RadialAxial":var t,n="shading".concat(S++),i=e[3];switch(e[1]){case"axial":var o=e[4],s=e[5];(t=this.svgFactory.createElement("svg:linearGradient")).setAttributeNS(null,"id",n),t.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),t.setAttributeNS(null,"x1",o[0]),t.setAttributeNS(null,"y1",o[1]),t.setAttributeNS(null,"x2",s[0]),t.setAttributeNS(null,"y2",s[1]);break;case"radial":var a=e[4],l=e[5],u=e[6],d=e[7];(t=this.svgFactory.createElement("svg:radialGradient")).setAttributeNS(null,"id",n),t.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),t.setAttributeNS(null,"cx",l[0]),t.setAttributeNS(null,"cy",l[1]),t.setAttributeNS(null,"r",d),t.setAttributeNS(null,"fx",a[0]),t.setAttributeNS(null,"fy",a[1]),t.setAttributeNS(null,"fr",u);break;default:throw new Error("Unknown RadialAxial type: ".concat(e[1]))}var h,f=c(i);try{for(f.s();!(h=f.n()).done;){var p=h.value,g=this.svgFactory.createElement("svg:stop");g.setAttributeNS(null,"offset",p[0]),g.setAttributeNS(null,"stop-color",p[1]),t.appendChild(g)}}catch(e){f.e(e)}finally{f.f()}return this.defs.appendChild(t),"url(#".concat(n,")");case"Mesh":return(0,r.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error("Unknown IR type: ".concat(e[0]))}}},{key:"setDash",value:function(e,t){this.current.dashArray=e,this.current.dashPhase=t}},{key:"constructPath",value:function(e,t){var n,i=this.current,o=i.x,s=i.y,a=[],l=0,u=c(e);try{for(u.s();!(n=u.n()).done;)switch(0|n.value){case r.OPS.rectangle:o=t[l++],s=t[l++];var d=t[l++],h=t[l++],f=o+d,p=s+h;a.push("M",g(o),g(s),"L",g(f),g(s),"L",g(f),g(p),"L",g(o),g(p),"Z");break;case r.OPS.moveTo:o=t[l++],s=t[l++],a.push("M",g(o),g(s));break;case r.OPS.lineTo:o=t[l++],s=t[l++],a.push("L",g(o),g(s));break;case r.OPS.curveTo:o=t[l+4],s=t[l+5],a.push("C",g(t[l]),g(t[l+1]),g(t[l+2]),g(t[l+3]),g(o),g(s)),l+=6;break;case r.OPS.curveTo2:a.push("C",g(o),g(s),g(t[l]),g(t[l+1]),g(t[l+2]),g(t[l+3])),o=t[l+2],s=t[l+3],l+=4;break;case r.OPS.curveTo3:o=t[l+2],s=t[l+3],a.push("C",g(t[l]),g(t[l+1]),g(o),g(s),g(o),g(s)),l+=4;break;case r.OPS.closePath:a.push("Z")}}catch(e){u.e(e)}finally{u.f()}a=a.join(" "),i.path&&e.length>0&&e[0]!==r.OPS.rectangle&&e[0]!==r.OPS.moveTo?a=i.path.getAttributeNS(null,"d")+a:(i.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().appendChild(i.path)),i.path.setAttributeNS(null,"d",a),i.path.setAttributeNS(null,"fill","none"),i.element=i.path,i.setCurrentPoint(o,s)}},{key:"endPath",value:function(){var e=this.current;if(e.path=null,this.pendingClip)if(e.element){var t="clippath".concat(E++),n=this.svgFactory.createElement("svg:clipPath");n.setAttributeNS(null,"id",t),n.setAttributeNS(null,"transform",m(this.transformMatrix));var r=e.element.cloneNode(!0);"evenodd"===this.pendingClip?r.setAttributeNS(null,"clip-rule","evenodd"):r.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,n.appendChild(r),this.defs.appendChild(n),e.activeClipUrl&&(e.clipGroup=null,this.extraStack.forEach((function(e){e.clipGroup=null})),n.setAttributeNS(null,"clip-path",e.activeClipUrl)),e.activeClipUrl="url(#".concat(t,")"),this.tgrp=null}else this.pendingClip=null}},{key:"clip",value:function(e){this.pendingClip=e}},{key:"closePath",value:function(){var e=this.current;if(e.path){var t="".concat(e.path.getAttributeNS(null,"d"),"Z");e.path.setAttributeNS(null,"d",t)}}},{key:"setLeading",value:function(e){this.current.leading=-e}},{key:"setTextRise",value:function(e){this.current.textRise=e}},{key:"setTextRenderingMode",value:function(e){this.current.textRenderingMode=e}},{key:"setHScale",value:function(e){this.current.textHScale=e/100}},{key:"setRenderingIntent",value:function(e){}},{key:"setFlatness",value:function(e){}},{key:"setGState",value:function(e){var t,n=c(e);try{for(n.s();!(t=n.n()).done;){var i=a(t.value,2),o=i[0],s=i[1];switch(o){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s);break;case"CA":this.setStrokeAlpha(s);break;case"ca":this.setFillAlpha(s);break;default:(0,r.warn)("Unimplemented graphic state operator ".concat(o))}}}catch(e){n.e(e)}finally{n.f()}}},{key:"fill",value:function(){var e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())}},{key:"stroke",value:function(){var e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())}},{key:"_setStrokeAttributes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this.current,r=n.dashArray;1!==t&&r.length>0&&(r=r.map((function(e){return t*e}))),e.setAttributeNS(null,"stroke",n.strokeColor),e.setAttributeNS(null,"stroke-opacity",n.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",g(n.miterLimit)),e.setAttributeNS(null,"stroke-linecap",n.lineCap),e.setAttributeNS(null,"stroke-linejoin",n.lineJoin),e.setAttributeNS(null,"stroke-width",g(t*n.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",r.map(g).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",g(t*n.dashPhase)+"px")}},{key:"eoFill",value:function(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}},{key:"fillStroke",value:function(){this.stroke(),this.fill()}},{key:"eoFillStroke",value:function(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}},{key:"closeStroke",value:function(){this.closePath(),this.stroke()}},{key:"closeFillStroke",value:function(){this.closePath(),this.fillStroke()}},{key:"closeEOFillStroke",value:function(){this.closePath(),this.eoFillStroke()}},{key:"paintSolidColorImageMask",value:function(){var e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().appendChild(e)}},{key:"paintJpegXObject",value:function(e,t,n){var r=this.objs.get(e),i=this.svgFactory.createElement("svg:image");i.setAttributeNS(v,"xlink:href",r.src),i.setAttributeNS(null,"width",g(t)),i.setAttributeNS(null,"height",g(n)),i.setAttributeNS(null,"x","0"),i.setAttributeNS(null,"y",g(-n)),i.setAttributeNS(null,"transform","scale(".concat(g(1/t)," ").concat(g(-1/n),")")),this._ensureTransformGroup().appendChild(i)}},{key:"paintImageXObject",value:function(e){var t=this.objs.get(e);t?this.paintInlineImageXObject(t):(0,r.warn)("Dependent image with object ID ".concat(e," is not ready yet"))}},{key:"paintInlineImageXObject",value:function(e,t){var n=e.width,r=e.height,i=w(e,this.forceDataSchema,!!t),o=this.svgFactory.createElement("svg:rect");o.setAttributeNS(null,"x","0"),o.setAttributeNS(null,"y","0"),o.setAttributeNS(null,"width",g(n)),o.setAttributeNS(null,"height",g(r)),this.current.element=o,this.clip("nonzero");var s=this.svgFactory.createElement("svg:image");s.setAttributeNS(v,"xlink:href",i),s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y",g(-r)),s.setAttributeNS(null,"width",g(n)+"px"),s.setAttributeNS(null,"height",g(r)+"px"),s.setAttributeNS(null,"transform","scale(".concat(g(1/n)," ").concat(g(-1/r),")")),t?t.appendChild(s):this._ensureTransformGroup().appendChild(s)}},{key:"paintImageMaskXObject",value:function(e){var t=this.current,n=e.width,r=e.height,i=t.fillColor;t.maskId="mask".concat(A++);var o=this.svgFactory.createElement("svg:mask");o.setAttributeNS(null,"id",t.maskId);var s=this.svgFactory.createElement("svg:rect");s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y","0"),s.setAttributeNS(null,"width",g(n)),s.setAttributeNS(null,"height",g(r)),s.setAttributeNS(null,"fill",i),s.setAttributeNS(null,"mask","url(#".concat(t.maskId,")")),this.defs.appendChild(o),this._ensureTransformGroup().appendChild(s),this.paintInlineImageXObject(e,o)}},{key:"paintFormXObjectBegin",value:function(e,t){if(Array.isArray(e)&&6===e.length&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t){var n=t[2]-t[0],r=t[3]-t[1],i=this.svgFactory.createElement("svg:rect");i.setAttributeNS(null,"x",t[0]),i.setAttributeNS(null,"y",t[1]),i.setAttributeNS(null,"width",g(n)),i.setAttributeNS(null,"height",g(r)),this.current.element=i,this.clip("nonzero"),this.endPath()}}},{key:"paintFormXObjectEnd",value:function(){}},{key:"_initialize",value:function(e){var t=this.svgFactory.create(e.width,e.height),n=this.svgFactory.createElement("svg:defs");t.appendChild(n),this.defs=n;var r=this.svgFactory.createElement("svg:g");return r.setAttributeNS(null,"transform",m(e.transform)),t.appendChild(r),this.svg=r,t}},{key:"_ensureClipGroup",value:function(){if(!this.current.clipGroup){var e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(e),this.current.clipGroup=e}return this.current.clipGroup}},{key:"_ensureTransformGroup",value:function(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",m(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}}]),e}()},function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var i,o=(i=n(220))&&i.__esModule?i:{default:i},s=n(1),a=n(238);function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=d(e);if(t){var o=d(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,n)}}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}function h(e,t,n,r,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){h(o,r,i,s,a,"next",e)}function a(e){h(o,r,i,s,a,"throw",e)}s(void 0)}))}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t,n){return t&&g(e.prototype,t),n&&g(e,n),e}var y=__webpack_require__(1378),v=__webpack_require__(1379),b=__webpack_require__(1380),_=__webpack_require__(1381),w=/^file:\/\/\/[a-zA-Z]:\//,T=function(){function e(t){var n,r;p(this,e),this.source=t,this.url=(n=t.url,"file:"===(r=_.parse(n)).protocol||r.host?r:/^[a-z]:[/\\]/i.test(n)?_.parse("file:///".concat(n)):(r.host||(r.protocol="file:"),r)),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}return m(e,[{key:"_progressiveDataLength",get:function(){return this._fullRequestReader?this._fullRequestReader._loaded:0}},{key:"getFullReader",value:function(){return(0,s.assert)(!this._fullRequestReader),this._fullRequestReader=this.isFsUrl?new C(this):new O(this),this._fullRequestReader}},{key:"getRangeReader",value:function(e,t){if(t<=this._progressiveDataLength)return null;var n=this.isFsUrl?new k(this,e,t):new I(this,e,t);return this._rangeRequestReaders.push(n),n}},{key:"cancelAllRequests",value:function(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeRequestReaders.slice(0).forEach((function(t){t.cancel(e)}))}}]),e}();t.PDFNodeStream=T;var E=function(){function e(t){p(this,e),this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;var n=t.source;this._contentLength=n.length,this._loaded=0,this._filename=null,this._disableRange=n.disableRange||!1,this._rangeChunkSize=n.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!n.disableStream,this._isRangeSupported=!n.disableRange,this._readableStream=null,this._readCapability=(0,s.createPromiseCapability)(),this._headersCapability=(0,s.createPromiseCapability)()}var t;return m(e,[{key:"headersReady",get:function(){return this._headersCapability.promise}},{key:"filename",get:function(){return this._filename}},{key:"contentLength",get:function(){return this._contentLength}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"read",value:(t=f(o.default.mark((function e(){var t,n;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._readCapability.promise;case 2:if(!this._done){e.next=4;break}return e.abrupt("return",{value:void 0,done:!0});case 4:if(!this._storedError){e.next=6;break}throw this._storedError;case 6:if(null!==(t=this._readableStream.read())){e.next=10;break}return this._readCapability=(0,s.createPromiseCapability)(),e.abrupt("return",this.read());case 10:return this._loaded+=t.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),n=new Uint8Array(t).buffer,e.abrupt("return",{value:n,done:!1});case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}},{key:"_error",value:function(e){this._storedError=e,this._readCapability.resolve()}},{key:"_setReadableStream",value:function(e){var t=this;this._readableStream=e,e.on("readable",(function(){t._readCapability.resolve()})),e.on("end",(function(){e.destroy(),t._done=!0,t._readCapability.resolve()})),e.on("error",(function(e){t._error(e)})),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new s.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}]),e}(),A=function(){function e(t){p(this,e),this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,s.createPromiseCapability)();var n=t.source;this._isStreamingSupported=!n.disableStream}var t;return m(e,[{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"read",value:(t=f(o.default.mark((function e(){var t,n;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._readCapability.promise;case 2:if(!this._done){e.next=4;break}return e.abrupt("return",{value:void 0,done:!0});case 4:if(!this._storedError){e.next=6;break}throw this._storedError;case 6:if(null!==(t=this._readableStream.read())){e.next=10;break}return this._readCapability=(0,s.createPromiseCapability)(),e.abrupt("return",this.read());case 10:return this._loaded+=t.length,this.onProgress&&this.onProgress({loaded:this._loaded}),n=new Uint8Array(t).buffer,e.abrupt("return",{value:n,done:!1});case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}},{key:"_error",value:function(e){this._storedError=e,this._readCapability.resolve()}},{key:"_setReadableStream",value:function(e){var t=this;this._readableStream=e,e.on("readable",(function(){t._readCapability.resolve()})),e.on("end",(function(){e.destroy(),t._done=!0,t._readCapability.resolve()})),e.on("error",(function(e){t._error(e)})),this._storedError&&this._readableStream.destroy(this._storedError)}}]),e}();function S(e,t){return{protocol:e.protocol,auth:e.auth,host:e.hostname,port:e.port,path:e.path,method:"GET",headers:t}}var O=function(e){c(n,e);var t=u(n);function n(e){var r;p(this,n);var i=function(t){if(404===t.statusCode){var n=new s.MissingPDFException('Missing PDF "'.concat(r._url,'".'));return r._storedError=n,void r._headersCapability.reject(n)}r._headersCapability.resolve(),r._setReadableStream(t);var i=function(e){return r._readableStream.headers[e.toLowerCase()]},o=(0,a.validateRangeRequestCapabilities)({getResponseHeader:i,isHttp:e.isHttp,rangeChunkSize:r._rangeChunkSize,disableRange:r._disableRange}),c=o.allowRangeRequests,l=o.suggestedLength;r._isRangeSupported=c,r._contentLength=l||r._contentLength,r._filename=(0,a.extractFilenameFromHeader)(i)};return(r=t.call(this,e))._request=null,"http:"===r._url.protocol?r._request=v.request(S(r._url,e.httpHeaders),i):r._request=b.request(S(r._url,e.httpHeaders),i),r._request.on("error",(function(e){r._storedError=e,r._headersCapability.reject(e)})),r._request.end(),r}return n}(E),I=function(e){c(n,e);var t=u(n);function n(e,r,i){var o;for(var a in p(this,n),(o=t.call(this,e))._httpHeaders={},e.httpHeaders){var c=e.httpHeaders[a];void 0!==c&&(o._httpHeaders[a]=c)}o._httpHeaders.Range="bytes=".concat(r,"-").concat(i-1);var l=function(e){if(404!==e.statusCode)o._setReadableStream(e);else{var t=new s.MissingPDFException('Missing PDF "'.concat(o._url,'".'));o._storedError=t}};return o._request=null,"http:"===o._url.protocol?o._request=v.request(S(o._url,o._httpHeaders),l):o._request=b.request(S(o._url,o._httpHeaders),l),o._request.on("error",(function(e){o._storedError=e})),o._request.end(),o}return n}(A),C=function(e){c(n,e);var t=u(n);function n(e){var r;p(this,n),r=t.call(this,e);var i=decodeURIComponent(r._url.path);return w.test(r._url.href)&&(i=i.replace(/^\//,"")),y.lstat(i,(function(e,t){if(e)return"ENOENT"===e.code&&(e=new s.MissingPDFException('Missing PDF "'.concat(i,'".'))),r._storedError=e,void r._headersCapability.reject(e);r._contentLength=t.size,r._setReadableStream(y.createReadStream(i)),r._headersCapability.resolve()})),r}return n}(E),k=function(e){c(n,e);var t=u(n);function n(e,r,i){var o;p(this,n),o=t.call(this,e);var s=decodeURIComponent(o._url.path);return w.test(o._url.href)&&(s=s.replace(/^\//,"")),o._setReadableStream(y.createReadStream(s,{start:r,end:i-1})),o}return n}(A)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createResponseStatusError=function(e,t){return 404===e||0===e&&t.startsWith("file:")?new r.MissingPDFException('Missing PDF "'+t+'".'):new r.UnexpectedResponseException("Unexpected server response ("+e+') while retrieving PDF "'+t+'".',e)},t.extractFilenameFromHeader=function(e){var t=e("Content-Disposition");if(t){var n=(0,i.getFilenameFromContentDispositionHeader)(t);if(n.includes("%"))try{n=decodeURIComponent(n)}catch(e){}if(/\.pdf$/i.test(n))return n}return null},t.validateRangeRequestCapabilities=function(e){var t=e.getResponseHeader,n=e.isHttp,i=e.rangeChunkSize,o=e.disableRange;(0,r.assert)(i>0,"Range chunk size must be larger than zero");var s={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(t("Content-Length"),10);return Number.isInteger(a)?(s.suggestedLength=a,a<=2*i||o||!n||"bytes"!==t("Accept-Ranges")||"identity"!==(t("Content-Encoding")||"identity")||(s.allowRangeRequests=!0),s):s},t.validateResponseStatus=function(e){return 200===e||206===e};var r=n(1),i=n(239)},function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);s=!0);}catch(e){a=!0,i=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw i}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Object.defineProperty(t,"__esModule",{value:!0}),t.getFilenameFromContentDispositionHeader=function(e){var t=!0,n=s("filename\\*","i").exec(e);if(n){var i=l(n=n[1]);return c(i=d(i=u(i=unescape(i))))}if(n=function(e){for(var t,n=[],i=s("filename\\*((?!0\\d)\\d+)(\\*?)","ig");null!==(t=i.exec(e));){var o=r(t,4),a=o[1],c=o[2],d=o[3];if((a=parseInt(a,10))in n){if(0===a)break}else n[a]=[c,d]}for(var h=[],f=0;f<n.length&&f in n;++f){var p=r(n[f],2),g=p[0],m=p[1];m=l(m),g&&(m=unescape(m),0===f&&(m=u(m))),h.push(m)}return h.join("")}(e))return c(d(n));if(n=s("filename","i").exec(e)){var o=l(n=n[1]);return c(o=d(o))}function s(e,t){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',t)}function a(e,n){if(e){if(!/^[\x00-\xFF]+$/.test(n))return n;try{var r=new TextDecoder(e,{fatal:!0}),i=Array.from(n,(function(e){return 255&e.charCodeAt(0)}));n=r.decode(new Uint8Array(i)),t=!1}catch(r){if(/^utf-?8$/i.test(e))try{n=decodeURIComponent(escape(n)),t=!1}catch(e){}}}return n}function c(e){return t&&/[\x80-\xff]/.test(e)&&(e=a("utf-8",e),t&&(e=a("iso-8859-1",e))),e}function l(e){if(e.startsWith('"')){for(var t=e.slice(1).split('\\"'),n=0;n<t.length;++n){var r=t[n].indexOf('"');-1!==r&&(t[n]=t[n].slice(0,r),t.length=n+1),t[n]=t[n].replace(/\\(.)/g,"$1")}e=t.join('"')}return e}function u(e){var t=e.indexOf("'");return-1===t?e:a(e.slice(0,t),e.slice(t+1).replace(/^[^']*'/,""))}function d(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,(function(e,t,n,r){if("q"===n||"Q"===n)return a(t,r=(r=r.replace(/_/g," ")).replace(/=([0-9a-fA-F]{2})/g,(function(e,t){return String.fromCharCode(parseInt(t,16))})));try{r=atob(r)}catch(e){}return a(t,r)}))}return""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNetworkStream=void 0;var r,i=(r=n(220))&&r.__esModule?r:{default:r},o=n(1),s=n(238);function a(e,t,n,r,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){a(o,r,i,s,c,"next",e)}function c(e){a(o,r,i,s,c,"throw",e)}s(void 0)}))}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}var h=function(){function e(t,n){l(this,e),this.url=t,n=n||{},this.isHttp=/^https?:/i.test(t),this.httpHeaders=this.isHttp&&n.httpHeaders||{},this.withCredentials=n.withCredentials||!1,this.getXhr=n.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}return d(e,[{key:"requestRange",value:function(e,t,n){var r={begin:e,end:t};for(var i in n)r[i]=n[i];return this.request(r)}},{key:"requestFull",value:function(e){return this.request(e)}},{key:"request",value:function(e){var t=this.getXhr(),n=this.currXhrId++,r=this.pendingRequests[n]={xhr:t};for(var i in t.open("GET",this.url),t.withCredentials=this.withCredentials,this.httpHeaders){var o=this.httpHeaders[i];void 0!==o&&t.setRequestHeader(i,o)}return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range","bytes=".concat(e.begin,"-").concat(e.end-1)),r.expectedStatus=206):r.expectedStatus=200,t.responseType="arraybuffer",e.onError&&(t.onerror=function(n){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),n}},{key:"onProgress",value:function(e,t){var n=this.pendingRequests[e];n&&n.onProgress&&n.onProgress(t)}},{key:"onStateChange",value:function(e,t){var n=this.pendingRequests[e];if(n){var r=n.xhr;if(r.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),4===r.readyState&&e in this.pendingRequests)if(delete this.pendingRequests[e],0===r.status&&this.isHttp)n.onError&&n.onError(r.status);else{var i=r.status||200;if(200===i&&206===n.expectedStatus||i===n.expectedStatus){var s=function(e){var t=e.response;return"string"!=typeof t?t:(0,o.stringToBytes)(t).buffer}(r);if(206===i){var a=r.getResponseHeader("Content-Range"),c=/bytes (\d+)-(\d+)\/(\d+)/.exec(a);n.onDone({begin:parseInt(c[1],10),chunk:s})}else s?n.onDone({begin:0,chunk:s}):n.onError&&n.onError(r.status)}else n.onError&&n.onError(r.status)}}}},{key:"hasPendingRequests",value:function(){for(var e in this.pendingRequests)return!0;return!1}},{key:"getRequestXhr",value:function(e){return this.pendingRequests[e].xhr}},{key:"isPendingRequest",value:function(e){return e in this.pendingRequests}},{key:"abortAllRequests",value:function(){for(var e in this.pendingRequests)this.abortRequest(0|e)}},{key:"abortRequest",value:function(e){var t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}]),e}(),f=function(){function e(t){l(this,e),this._source=t,this._manager=new h(t.url,{httpHeaders:t.httpHeaders,withCredentials:t.withCredentials}),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}return d(e,[{key:"_onRangeRequestReaderClosed",value:function(e){var t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}},{key:"getFullReader",value:function(){return(0,o.assert)(!this._fullRequestReader),this._fullRequestReader=new p(this._manager,this._source),this._fullRequestReader}},{key:"getRangeReader",value:function(e,t){var n=new g(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}},{key:"cancelAllRequests",value:function(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeRequestReaders.slice(0).forEach((function(t){t.cancel(e)}))}}]),e}();t.PDFNetworkStream=f;var p=function(){function e(t,n){l(this,e),this._manager=t;var r={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=n.url,this._fullRequestId=t.requestFull(r),this._headersReceivedCapability=(0,o.createPromiseCapability)(),this._disableRange=n.disableRange||!1,this._contentLength=n.length,this._rangeChunkSize=n.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}var t;return d(e,[{key:"_onHeadersReceived",value:function(){var e=this._fullRequestId,t=this._manager.getRequestXhr(e),n=function(e){return t.getResponseHeader(e)},r=(0,s.validateRangeRequestCapabilities)({getResponseHeader:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange}),i=r.allowRangeRequests,o=r.suggestedLength;i&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=(0,s.extractFilenameFromHeader)(n),this._isRangeSupported&&this._manager.abortRequest(e),this._headersReceivedCapability.resolve()}},{key:"_onDone",value:function(e){e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,this._cachedChunks.length>0||(this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[])}},{key:"_onError",value:function(e){var t=this._url,n=(0,s.createResponseStatusError)(e,t);this._storedError=n,this._headersReceivedCapability.reject(n),this._requests.forEach((function(e){e.reject(n)})),this._requests=[],this._cachedChunks=[]}},{key:"_onProgress",value:function(e){this.onProgress&&this.onProgress({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}},{key:"filename",get:function(){return this._filename}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"contentLength",get:function(){return this._contentLength}},{key:"headersReady",get:function(){return this._headersReceivedCapability.promise}},{key:"read",value:(t=c(i.default.mark((function e(){var t,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._storedError){e.next=2;break}throw this._storedError;case 2:if(!(this._cachedChunks.length>0)){e.next=5;break}return t=this._cachedChunks.shift(),e.abrupt("return",{value:t,done:!1});case 5:if(!this._done){e.next=7;break}return e.abrupt("return",{value:void 0,done:!0});case 7:return n=(0,o.createPromiseCapability)(),this._requests.push(n),e.abrupt("return",n.promise);case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(e){this._done=!0,this._headersReceivedCapability.reject(e),this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}]),e}(),g=function(){function e(t,n,r){l(this,e),this._manager=t;var i={onDone:this._onDone.bind(this),onProgress:this._onProgress.bind(this)};this._requestId=t.requestRange(n,r,i),this._requests=[],this._queuedChunk=null,this._done=!1,this.onProgress=null,this.onClosed=null}var t;return d(e,[{key:"_close",value:function(){this.onClosed&&this.onClosed(this)}},{key:"_onDone",value:function(e){var t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._close()}},{key:"_onProgress",value:function(e){!this.isStreamingSupported&&this.onProgress&&this.onProgress({loaded:e.loaded})}},{key:"isStreamingSupported",get:function(){return!1}},{key:"read",value:(t=c(i.default.mark((function e(){var t,n;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===this._queuedChunk){e.next=4;break}return t=this._queuedChunk,this._queuedChunk=null,e.abrupt("return",{value:t,done:!1});case 4:if(!this._done){e.next=6;break}return e.abrupt("return",{value:void 0,done:!0});case 6:return n=(0,o.createPromiseCapability)(),this._requests.push(n),e.abrupt("return",n.promise);case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(e){this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var r,i=(r=n(220))&&r.__esModule?r:{default:r},o=n(1),s=n(238);function a(e,t,n,r,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,i)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){a(o,r,i,s,c,"next",e)}function c(e){a(o,r,i,s,c,"throw",e)}s(void 0)}))}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t,n){return t&&u(e.prototype,t),n&&u(e,n),e}function h(e,t,n){return{method:"GET",headers:e,signal:n&&n.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function f(e){var t=new Headers;for(var n in e){var r=e[n];void 0!==r&&t.append(n,r)}return t}var p=function(){function e(t){l(this,e),this.source=t,this.isHttp=/^https?:/i.test(t.url),this.httpHeaders=this.isHttp&&t.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}return d(e,[{key:"_progressiveDataLength",get:function(){return this._fullRequestReader?this._fullRequestReader._loaded:0}},{key:"getFullReader",value:function(){return(0,o.assert)(!this._fullRequestReader),this._fullRequestReader=new g(this),this._fullRequestReader}},{key:"getRangeReader",value:function(e,t){if(t<=this._progressiveDataLength)return null;var n=new m(this,e,t);return this._rangeRequestReaders.push(n),n}},{key:"cancelAllRequests",value:function(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeRequestReaders.slice(0).forEach((function(t){t.cancel(e)}))}}]),e}();t.PDFFetchStream=p;var g=function(){function e(t){var n=this;l(this,e),this._stream=t,this._reader=null,this._loaded=0,this._filename=null;var r=t.source;this._withCredentials=r.withCredentials||!1,this._contentLength=r.length,this._headersCapability=(0,o.createPromiseCapability)(),this._disableRange=r.disableRange||!1,this._rangeChunkSize=r.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),"undefined"!=typeof AbortController&&(this._abortController=new AbortController),this._isStreamingSupported=!r.disableStream,this._isRangeSupported=!r.disableRange,this._headers=f(this._stream.httpHeaders);var i=r.url;fetch(i,h(this._headers,this._withCredentials,this._abortController)).then((function(e){if(!(0,s.validateResponseStatus)(e.status))throw(0,s.createResponseStatusError)(e.status,i);n._reader=e.body.getReader(),n._headersCapability.resolve();var t=function(t){return e.headers.get(t)},r=(0,s.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:n._stream.isHttp,rangeChunkSize:n._rangeChunkSize,disableRange:n._disableRange}),a=r.allowRangeRequests,c=r.suggestedLength;n._isRangeSupported=a,n._contentLength=c||n._contentLength,n._filename=(0,s.extractFilenameFromHeader)(t),!n._isStreamingSupported&&n._isRangeSupported&&n.cancel(new o.AbortException("Streaming is disabled."))})).catch(this._headersCapability.reject),this.onProgress=null}var t;return d(e,[{key:"headersReady",get:function(){return this._headersCapability.promise}},{key:"filename",get:function(){return this._filename}},{key:"contentLength",get:function(){return this._contentLength}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"read",value:(t=c(i.default.mark((function e(){var t,n,r,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._headersCapability.promise;case 2:return e.next=4,this._reader.read();case 4:if(t=e.sent,n=t.value,!(r=t.done)){e.next=9;break}return e.abrupt("return",{value:n,done:r});case 9:return this._loaded+=n.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),o=new Uint8Array(n).buffer,e.abrupt("return",{value:o,done:!1});case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(e){this._reader&&this._reader.cancel(e),this._abortController&&this._abortController.abort()}}]),e}(),m=function(){function e(t,n,r){var i=this;l(this,e),this._stream=t,this._reader=null,this._loaded=0;var a=t.source;this._withCredentials=a.withCredentials||!1,this._readCapability=(0,o.createPromiseCapability)(),this._isStreamingSupported=!a.disableStream,"undefined"!=typeof AbortController&&(this._abortController=new AbortController),this._headers=f(this._stream.httpHeaders),this._headers.append("Range","bytes=".concat(n,"-").concat(r-1));var c=a.url;fetch(c,h(this._headers,this._withCredentials,this._abortController)).then((function(e){if(!(0,s.validateResponseStatus)(e.status))throw(0,s.createResponseStatusError)(e.status,c);i._readCapability.resolve(),i._reader=e.body.getReader()})),this.onProgress=null}var t;return d(e,[{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"read",value:(t=c(i.default.mark((function e(){var t,n,r,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._readCapability.promise;case 2:return e.next=4,this._reader.read();case 4:if(t=e.sent,n=t.value,!(r=t.done)){e.next=9;break}return e.abrupt("return",{value:n,done:r});case 9:return this._loaded+=n.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),o=new Uint8Array(n).buffer,e.abrupt("return",{value:o,done:!1});case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"cancel",value:function(e){this._reader&&this._reader.cancel(e),this._abortController&&this._abortController.abort()}}]),e}()}])},module.exports=factory()}).call(this,__webpack_require__(287).Buffer,__webpack_require__(61),__webpack_require__(131))},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return he})),n.d(t,"a",(function(){return fe}));var r=n(2),i=n(724),o=(n(1235),n(321)),s=n(295),a=n(767);const c=n(30);if(c.isReactNative)try{c.isReactNative=()=>!0}catch(e){}var l;!function(e){e[e.isTimestamp=1]="isTimestamp",e[e.isGroupKey=2]="isGroupKey",e[e.isPrimaryKey=3]="isPrimaryKey",e[e.isOptional=4]="isOptional"}(l||(l={}));const u={$eq:"==",$lt:"<",$lte:"<=",$gt:">",$gte:">=",$in:"in"};class d extends a.b{constructor(e){super(),this.features={executeBatch:!0,collectionGrouping:!0},this.firebaseModules=e.firebaseModules,this.firestore=e.firestore,this.rootRef=e.rootRef}createObject(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=Object(s.b)({operation:"createObject",collection:e,args:t},this.registry),r=Object(s.a)(n),i=yield this.executeBatch(r);for(const r of n.objects){const n=m(this.registry.collections[e]);Object(s.g)(t,[...r.path,n],i.info[r.placeholder].object[n])}return{object:t}}))}findObjects(e,t,n={}){var i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){t=Object.assign({},t);const r=this.registry.collections[e];if(!r)throw new Error(`Unknown collection: ${e}`);const o=r.pkIndex,s=(r.groupBy||[]).map((e=>[e.key,t[e.key]])),a=(e,t)=>{let n;const i=m(r);if("string"==typeof i)n=Object.assign({[i]:t},e);else{n=Object.assign({},e);for(const t of o)n[t]=e[t]}for(const[e,t]of s)n[e]=t;return n},c=yield this.getFirestoreCollection(e,{forObject:t,deleteGroupKeys:!0}),l=m(r);if(1===Object.keys(t).length&&"string"==typeof t[l]){const e=yield c.doc(t[l]).get();if(!e.exists)return[];return[e.data()].map((e=>p(a(e,t[l]),{collectionDefinition:r})))}{let e=c;for(let{field:n,operator:o,value:s}of h(t))"timestamp"===(null===(i=r.fields[n])||void 0===i?void 0:i.type)&&(s=new Date(s)),e=e.where(n===l?this.firebaseModules.documentId():n,u[o],s);for(const[t,r]of n.order||[])e=e.orderBy(t,r);n.limit&&(e=e.limit(n.limit+(n.skip||0)));const o=yield e.get();return(n.skip?o.docs.slice(n.skip):o.docs).map((e=>p(a(e.data(),e.id),{collectionDefinition:r})))}}))}countObjects(e,t,n){var i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){t=Object.assign({},t);const n=this.registry.collections[e];if(!n)throw new Error(`Unknown collection: ${e}`);const r=yield this.getFirestoreCollection(e,{forObject:t,deleteGroupKeys:!0}),o=m(n);let s=r;for(let{field:e,operator:r,value:a}of h(t))"timestamp"===(null===(i=n.fields[e])||void 0===i?void 0:i.type)&&(a=new Date(a)),s=s.where(e===o?this.firebaseModules.documentId():e,u[r],a);const a=yield s.count().get(),{count:c}=a.data();return c}))}updateObjects(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=this.registry.collections[e],i=Object.assign({},t),o=yield this.getFirestoreCollection(e,{forObject:t,deleteGroupKeys:!0}),s=m(r);if(1===Object.keys(t).length&&t[s])yield o.doc(t[s]).update(f(n,{forUpdate:!0,collectionDefinition:r,firebaseModules:this.firebaseModules}));else{const t=yield this.findObjects(e,i),a=this.firestore.batch();for(const e of t)a.update(o.doc(e[s]),f(n,{forUpdate:!0,collectionDefinition:r,firebaseModules:this.firebaseModules}));yield a.commit()}}))}deleteObjects(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=this.registry.collections[e],r=yield this.getFirestoreCollection(e,{forObject:t,deleteGroupKeys:!0}),i=m(n);if(1!==Object.keys(t).length||!t[i])throw new Error("Only deletes by pk are supported for now");if(t[i].$in){const e=this.firestore.batch();for(const n of t[i].$in)e.delete(r.doc(n));yield e.commit()}else yield r.doc(t[i]).delete()}))}executeBatch(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=this.firestore.batch(),i={},o={};for(const s of e)if("createObject"===s.operation){const e=this.registry.collections[s.collection],n=s.args;for(const{path:e,placeholder:t}of s.replace||[])n[e]=o[t];let a,c=yield this.getFirestoreCollection(s.collection,{forObject:n,createGroupContainers:!0});const l=m(e),u=n[l];u||"auto-pk"!==(null===(t=e.fields[l])||void 0===t?void 0:t.type)?(a=c.doc(u),delete n[l]):a=c.doc();const d=f(n,{collectionDefinition:e,firebaseModules:this.firebaseModules});if(r.set(a,d),s.placeholder){const t=a.id;o[s.placeholder]=t;const r=m(e);i[s.placeholder]={object:Object.assign({[r]:t},n)}}}else{if("deleteObjects"!==s.operation&&"updateObjects"!==s.operation)throw new Error(`Unsupported operation in batch: ${s.operation}`);{const e=this.registry.collections[s.collection],t=s.where;let i=yield this.getFirestoreCollection(s.collection,{forObject:t,createGroupContainers:!0});const o=m(e),a=t[o];if(!a)throw new Error(`Cannot ${"deleteObjects"===s.operation?"delete":"update"} ${s.collection} objects in batch by anything other than the primary key (${o}), which was not provided`);const c=null!==(n=a.$in)&&void 0!==n?n:[a];if("deleteObjects"===s.operation)for(const e of c){const t=i.doc(e);r.delete(t)}else if("updateObjects"===s.operation)for(const t of c){const n=i.doc(t),o=f(s.updates,{forUpdate:!0,collectionDefinition:e,firebaseModules:this.firebaseModules});r.update(n,o)}}}return yield r.commit(),{info:i}}))}getFirestoreCollection(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=this.registry.collections[e];let r=this.rootRef?this.rootRef.collection(e):this.firestore.collection(e);if(t&&t.forObject)for(const i of n.groupBy||[]){const n=t.forObject[i.key];if(!n)throw new Error(`Tried to query grouped collection '${e}', but did not find grouped field '${i.key}' in query`);if("string"!=typeof n)throw new Error(`Tried to query grouped collection '${e}', but grouped field '${i.key}' in query is not a single value: ${JSON.stringify(n)}`);const o=r.doc(n);r=o.collection(i.subcollectionName),t.deleteGroupKeys&&delete t.forObject[i.key]}return r}))}operation(e,...t){const n=Object.create(null,{operation:{get:()=>super.operation}});return Object(r.__awaiter)(this,void 0,void 0,(function*(){return n.operation.call(this,e,...t)}))}}function h(e){const t=[];for(const[n,r]of Object.entries(e)){let e=null;try{e=Object.entries(r)}catch(e){if(!(e instanceof TypeError))throw e}if(e&&e.length&&"$"===e[0][0].substr(0,1))for(const[r,i]of e)t.push({field:n,operator:r,value:i});else t.push({field:n,operator:"$eq",value:r})}return t}function f(e,t){const n=g(t.collectionDefinition);if(!n.length)return e;e=Object.assign({},e);for(const{fieldName:r,reason:i}of n)if(i===l.isTimestamp)if("$now"===e[r])e[r]=t.firebaseModules.serverTimestamp();else{const n=e[r];if(null==n)continue;if("number"!=typeof n)throw new Error(`Invalid timestamp provided for ${t.collectionDefinition.name}.${r} in attempted Firestore write`);e[r]=t.firebaseModules.fromMillis(n)}else if(i===l.isGroupKey)delete e[r];else if(i===l.isOptional){null!==e[r]||t.forUpdate||delete e[r]}return e}function p(e,t){const n=g(t.collectionDefinition);if(!n.length)return e;for(const{fieldName:t,reason:r}of n)if(r===l.isTimestamp){const n=e[t];e[t]=n&&n.toMillis()}return e}function g(e){const t=new Set((e.groupBy||[]).map((e=>e.key))),n=[];for(const[r,i]of Object.entries(e.fields)){let e;"timestamp"===i.type?e=l.isTimestamp:t.has(r)&&(e=l.isGroupKey),e&&n.push({fieldName:r,reason:e}),i.optional&&n.push({fieldName:r,reason:l.isOptional})}return n}function m(e){const t=e.pkIndex;if(t instanceof Array)throw new Error(`The Firestore backend doesn't support compound indices. You tried to use one on the collection '${e.name}'`);return"object"==typeof t&&t.relationship?t.relationship:t}var y=n(80),v=n(223),b=n.n(v),_=n(889),w=n.n(_);class T extends y.a{constructor(e){super(e),this.options=e,this.getConfig=()=>function(e){return{operations:e.operations,collections:Object.assign({sharedSyncLogEntry:{version:new Date("2019-02-05"),fields:{userId:{type:e.autoPkType},deviceId:{type:e.autoPkType},createdOn:{type:"timestamp"},sharedOn:{type:"timestamp"},data:{type:"string"}},groupBy:[{key:"userId",subcollectionName:"entries"}]},sharedSyncLogDeviceInfo:{version:new Date("2019-02-05"),fields:{userId:{type:e.autoPkType},sharedUntil:{type:"timestamp",optional:!0}},groupBy:[{key:"userId",subcollectionName:"devices"}]}},e.collections||{}),methods:{createDeviceId:{type:"mutation",args:{userId:e.autoPkType,sharedUntil:"float"},returns:e.autoPkType},writeEntries:{type:"mutation",args:{entries:{type:{array:{collection:"sharedSyncLogEntry"}},positional:!0}},returns:"void"},getUnsyncedEntries:{type:"query",args:{deviceId:{type:e.autoPkType}},returns:{array:{collection:"sharedSyncLogEntry"}}},markAsSeen:{type:"mutation",args:{entries:{type:{array:{object:{createdOn:"float",deviceId:e.autoPkType},singular:"entry"}}},deviceId:{type:e.autoPkType}},returns:"void"}},accessRules:e.accessRules}}({autoPkType:this.options.autoPkType,collections:{sharedSyncLogEntryBatch:{version:new Date("2019-02-05"),fields:{userId:{type:this.options.autoPkType},deviceId:{type:this.options.autoPkType},sharedOn:{type:"timestamp"},data:{type:"string"}},groupBy:[{key:"userId",subcollectionName:"entries"}]}},operations:{createDeviceInfo:{operation:"createObject",collection:"sharedSyncLogDeviceInfo",args:{userId:"$userId:pk"}},getDeviceInfo:{operation:"findObject",collection:"sharedSyncLogDeviceInfo",args:{userId:"$userId:pk",id:"$deviceId:pk"}},updateSharedUntil:{operation:"updateObjects",collection:"sharedSyncLogDeviceInfo",args:[{userId:"$userId:pk",id:"$deviceId:pk"},{sharedUntil:"$sharedUntil:timestamp"}]},createLogEntryBatch:{operation:"createObject",collection:"sharedSyncLogEntryBatch"},findUnseenSyncEntries:{operation:"findObjects",collection:"sharedSyncLogEntryBatch",args:[{userId:"$userId",sharedOn:{$gt:"$after:timestamp"}}]}},accessRules:{ownership:{sharedSyncLogDeviceInfo:{field:"userId",access:["list","read","create","update","delete"]},sharedSyncLogEntryBatch:{field:"userId",access:["list","read","create","delete"]}}}})}createDeviceId(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return void 0===e.sharedUntil&&(e.sharedUntil=0),(yield this.operation("createDeviceInfo",e)).object.id}))}getDeviceInfo(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("getDeviceInfo",e);return t?(t.sharedUntil||(t.sharedUntil=null),t):null}))}writeEntries(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(!e.length)return;const n={data:JSON.stringify({entries:e,extraInfo:t.extraSentInfo}),userId:t.userId,deviceId:t.deviceId,sharedOn:t&&t.now||"$now"};yield this.operation("createLogEntryBatch",n)}))}getUnsyncedEntries(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("getDeviceInfo",e);if(!t)throw new Error(`No such device: ${e.deviceId}`);const n=yield this.operation("findUnseenSyncEntries",{userId:e.userId,after:t.sharedUntil||0}),r=n.length?n[n.length-1]:null,i=r&&r.sharedOn,o=b()(n.filter((t=>t.deviceId!==e.deviceId)).map((t=>{const n=JSON.parse(t.data);return n.entries.map((r=>Object.assign(Object.assign({},r),{sharedOn:t.sharedOn,deviceId:t.deviceId,userId:e.userId,extraInfo:n.extraInfo})))})));return{entries:w()(o,"createdOn"),memo:{lastBatchTime:i}}}))}markAsSeen(e,t){var n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=e.entries.length?e.memo.lastBatchTime:null!==(n=t.now)&&void 0!==n?n:Date.now();yield this.operation("updateSharedUntil",{userId:t.userId,deviceId:t.deviceId,sharedUntil:r})}))}}var E=n(779),A=n.n(E),S=n(78),O=n(328),I=n(167);class C extends y.a{constructor(e){super(e),this.storageManager=e.storageManager}getConfig(){return{collections:{user:{version:S.a[14].date,fields:{id:{type:"string"},displayName:{type:"string",optional:!0},platform:{type:"string",optional:!0},platformId:{type:"string",optional:!0},firebaseId:{type:"string",optional:!0}},indices:[{field:"id",pk:!0}]},userEmail:{version:S.a[0].date,fields:{address:{type:"string"},isPrimary:{type:"boolean"},isActive:{type:"boolean"}},relationships:[{childOf:"user",reverseAlias:"emails"}]},userFCMRegistration:{version:S.a[13].date,fields:{id:{type:"string"},token:{type:"string"},createdWhen:{type:"timestamp"}},relationships:[{childOf:"user",reverseAlias:"fcmRegistration"}],groupBy:[{subcollectionName:"objects",key:"user"}],indices:[{field:"id",pk:!0}]},userPublicProfile:{version:S.a[6].date,fields:{websiteURL:{type:"string",optional:!0},mediumURL:{type:"string",optional:!0},twitterURL:{type:"string",optional:!0},substackURL:{type:"string",optional:!0},bio:{type:"string",optional:!0},avatarURL:{type:"string",optional:!0},paymentPointer:{type:"string",optional:!0}},relationships:[{singleChildOf:"user",reverseAlias:"publicProfile"}],indices:[{field:{relationship:"user"},pk:!0}]}},operations:{createUser:{operation:"createObject",collection:"user"},updateUser:{operation:"updateObject",collection:"user",args:[{id:"$id"},"$updates"]},findUserById:{operation:"findObject",collection:"user",args:{id:"$id:pk"}},findUserByPlatformId:{operation:"findObject",collection:"user",args:{platform:"$platform:string",platformId:"$platformId:string"}},findUsersByIds:{operation:"findObjects",collection:"user",args:{id:{$in:"$ids:array:pk"}}},createUserPublicProfile:{operation:"createObject",collection:"userPublicProfile"},updateUserPublicProfile:{operation:"updateObjects",collection:"userPublicProfile",args:[{user:"$user"},"$updates"]},findUserPublicProfileById:{operation:"findObject",collection:"userPublicProfile",args:{user:"$user:pk"}},findUserPublicProfilesByIds:{operation:"findObjects",collection:"userPublicProfile",args:{user:{$in:"$ids:array:pk"}}},createUserFCMRegistration:{operation:"createObject",collection:"userFCMRegistration"},findUserFcmRegistration:{operation:"findObject",collection:"userFCMRegistration",args:{user:"$user:pk",token:"$token:string"}},findUserFcmRegistrations:{operation:"findObjects",collection:"userFCMRegistration",args:{user:"$user:pk"}},findUserFcmRegistrationsByTokens:{operation:"findObjects",collection:"userFCMRegistration",args:{user:"$user:pk",token:{$in:"$tokens:pk[]"}}},deleteUserFcmRegistrationsByUser:{operation:"deleteObjects",collection:"userFCMRegistration",args:{user:"$user:pk"}},deleteUserFcmRegistrationsByIds:{operation:"deleteObjects",collection:"userFCMRegistration",args:{id:{$in:"$ids:pk[]"},user:"$user:pk"}}},accessRules:{ownership:{user:{field:"id",access:["create","update"]},userPublicProfile:{field:"user",access:["create","update"]},userFCMRegistration:{field:"user",access:"full"}},permissions:{user:{read:{rule:!0}},userPublicProfile:{read:{rule:!0}}}}}}findUserByPlatformId(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findUserByPlatformId",{platform:e,platformId:t})}))}ensureUser(e,t){var n,i,o;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.operation("findUserById",{id:t.id});return r||(yield this.operation("createUser",{id:t.id,displayName:null!==(n=e.displayName)&&void 0!==n?n:null,platformId:null!==(i=e.platformId)&&void 0!==i?i:null,platform:null!==(o=e.platform)&&void 0!==o?o:null})).object}))}getUser(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.operation("findUserById",{id:e.id})}))}updateUser(e,t,n){var i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){"new"===(null!==(i=t.knownStatus)&&void 0!==i?i:(yield this.operation("findUserById",{id:e.id}))?"exists":"new")?yield this.operation("createUser",Object.assign({id:e.id},n)):yield this.operation("updateUser",{id:e.id,updates:n})}))}getUserReference(e){return{type:"user-reference",id:e.userID}}ensureUserPublicProfileExists(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.operation("findUserPublicProfileById",{id:t.id});return n||(yield this.operation("createUserPublicProfile",Object.assign({user:t.id},e))).object}))}getUserPublicProfile(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findUserPublicProfileById",{user:e.id});return Object(O.a)(t,"user-public-profile-reference",{user:"user-reference"})}))}getUsersPublicDetails(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=e.map((e=>e.id)),r=yield this.operation("findUsersByIds",{ids:n}),i=yield this.operation("findUserPublicProfilesByIds",{ids:n}),o={};for(const e of r)o[e.id]={user:A()(e,["id"])};for(const e of i)o[e.user]=Object.assign(Object.assign({},null!==(t=o[e.user])&&void 0!==t?t:{}),{profile:A()(e,["user"])});return o}))}createOrUpdateUserPublicProfile(e,t,n){var i,o;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r={};for(const e of["websiteURL","mediumURL","twitterURL","substackURL","bio","avatarURL","paymentPointer"])r[e]=null!==(i=n[e])&&void 0!==i?i:"";"new"===(null!==(o=t.knownStatus)&&void 0!==o?o:(yield this.operation("findUserPublicProfileById",{user:e.id}))?"exists":"new")?yield this.operation("createUserPublicProfile",Object.assign({user:e.id},r)):yield this.operation("updateUserPublicProfile",{user:e.id,updates:r})}))}addUserFCMRegistrationToken(e,t,n=Date.now()){return Object(r.__awaiter)(this,void 0,void 0,(function*(){null==(yield this.operation("findUserFcmRegistration",{user:e.id,token:t}))&&(yield this.operation("createUserFCMRegistration",{user:e.id,createdWhen:n,token:t}))}))}getUserFCMRegistrationTokens(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.operation("findUserFcmRegistrations",{user:e.id})).sort(((e,t)=>t.createdWhen-e.createdWhen))}))}deleteUserFCMRegistrationsByTokens(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield Object(I.b)(t,(n=>Object(r.__awaiter)(this,void 0,void 0,(function*(){let n=yield this.operation("findUserFcmRegistrationsByTokens",{user:e.id,tokens:t});yield this.operation("deleteUserFcmRegistrationsByIds",{ids:n.map((e=>e.id)),user:e.id})}))),30)}))}deleteUserFCMRegistrations(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteUserFcmRegistrationsByUser",{user:e.id})}))}}const k={contentSharing:{findListsByIDs:!0,findKeysByLists:!0,findListEntryByUrl:!0,findListEntriesByList:!0,findListEntriesByListAfterTime:!0,findListEntriesByUrl:!0,findListEntriesByUrls:!0,findListEntryByListAndId:!0,findListEntriesByListPaginated:!0,findSingleEntryByUserAndUrl:!0,findAnnotationsByIds:!0,findAnnotationsByCreatorAndPageUrl:!0,findSingleAnnotationEntryByListPage:!0,findAnnotationEntriesByCreatorAndPageUrl:!0,findAnnotationEntriesByListPages:!0,findAnnotationEntriesByList:!0,findAnnotationEntriesByLists:!0,findAnnotationEntriesByListsOnPage:!0,findAnnotationEntriesForAnnotations:!0,findListRoles:!0,findPageInfoByCreatorAndUrl:!0,findListRolesByUser:!0,findListsByCreator:!0,findFingerprintInLists:!0,findLocatorsInListsByUrl:!0,findLocatorsInList:!0,findLocatorsInListByUrl:!0,findLocatorsByUrlAndCreator:!0,findLocatorsByUrl:!0},contentConversations:{findThreadsByPages:!0,findThreadByAnnotation:!0,findThreadsByAnnotations:!0,findRepliesByCreatorAndPageUrl:!0,findRepliesByAnnotation:!0,findRepliesByAnnotations:!0},activityFollows:{findFollow:!0,findFollowsByCollection:!0,findFollowsByEntity:!0},users:{findUsersByIds:!0,findUserPublicProfilesByIds:!0},discordRetroSync:{getSyncEntryByChannel:!0},slackRetroSync:{getSyncEntryByChannel:!0}},P={executeStorageModuleOperation:!0};function x(e,t){return n=>e("applicationLayer",{methodName:t,methodArgs:n})}var R=n(1077),L=n(217),D=n.n(L),N=n(1069),j=n.n(N);class M extends y.a{constructor(e){super(e),this.options=e,this.getConfig=()=>({collections:{conversationThread:{version:S.a[6].date,fields:{updatedWhen:{type:"timestamp"},normalizedPageUrl:{type:"string"}},relationships:[{childOf:"user",alias:"pageCreator"},{childOf:"sharedAnnotation"},{childOf:"sharedList"}]},conversationReply:{version:S.a[6].date,fields:{createdWhen:{type:"timestamp"},normalizedPageUrl:{type:"string"},content:{type:"string"}},relationships:[{childOf:"user"},{childOf:"conversationReply",alias:"previousReply"},{childOf:"user",alias:"pageCreator"},{childOf:"conversationThread"},{childOf:"sharedAnnotation"},{childOf:"sharedList"}],groupBy:[{subcollectionName:"replies",key:"sharedAnnotation"}]}},operations:{createThread:{collection:"conversationThread",operation:"createObject"},createReply:{collection:"conversationReply",operation:"createObject"},findRepliesByCreatorAndPageUrl:{operation:"findObjects",collection:"conversationReply",args:{pageCreator:"$pageCreator:pk",normalizedPageUrl:"$normalizedPageUrl:string"}},findRepliesByAnnotation:{operation:"findObjects",collection:"conversationReply",args:{sharedAnnotation:"$sharedAnnotation:pk",sharedList:"$sharedList:string"}},findRepliesByAnnotations:{operation:"findObjects",collection:"conversationReply",args:{sharedAnnotation:{$in:"$sharedAnnotations:pk"},sharedList:"$sharedList:string"}},findReplyById:{operation:"findObject",collection:"conversationReply",args:{id:"$id:pk",sharedAnnotation:"$sharedAnnotation:pk"}},findThreadByAnnotation:{operation:"findObject",collection:"conversationThread",args:{sharedList:"$sharedList:string",sharedAnnotation:"$sharedAnnotation:pk"}},findThreadsByAnnotations:{operation:"findObjects",collection:"conversationThread",args:{sharedList:"$sharedList:string",sharedAnnotation:{$in:"$sharedAnnotations:array:pk"}}},editReplyById:{collection:"conversationReply",operation:"updateObjects",args:[{id:"$id:pk",sharedAnnotation:"$sharedAnnotation:string"},{content:"$content:string"}]},deleteReplyById:{collection:"conversationReply",operation:"deleteObjects",args:{id:"$id:pk",sharedAnnotation:"$sharedAnnotation:string"}}},accessRules:{ownership:{conversationReply:{field:"user",access:["create","update","delete"]}},permissions:{conversationThread:{read:{rule:!0},create:{rule:!0}},conversationReply:{read:{rule:!0}}}}})}getOrCreateThread(e){var t,n,i,o;return Object(r.__awaiter)(this,void 0,void 0,(function*(){let r=yield this.operation("findThreadByAnnotation",{sharedAnnotation:e.annotationReference.id,sharedList:null!==(n=null===(t=e.sharedListReference)||void 0===t?void 0:t.id)&&void 0!==n?n:null});return r||(r=(yield this.operation("createThread",{sharedAnnotation:this.options.contentSharing._idFromReference(e.annotationReference),sharedList:null!==(o=null===(i=e.sharedListReference)||void 0===i?void 0:i.id)&&void 0!==o?o:null,updatedWhen:Date.now(),pageCreator:e.pageCreatorReference.id,normalizedPageUrl:e.normalizedPageUrl})).object),Object(O.a)(r,"conversation-thread-reference",{})}))}createReply(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=e.reply.content.trim();if(!r.length)throw new Error("Cannot create an empty reply");const i=yield this.getOrCreateThread(e),{object:o}=yield this.operation("createReply",{user:e.userReference.id,conversationThread:i.reference.id,previousReply:e.previousReplyReference?e.previousReplyReference.id:null,sharedAnnotation:this.options.contentSharing._idFromReference(e.annotationReference),sharedList:null!==(n=null===(t=e.sharedListReference)||void 0===t?void 0:t.id)&&void 0!==n?n:null,createdWhen:Date.now(),pageCreator:e.pageCreatorReference.id,normalizedPageUrl:e.normalizedPageUrl,content:r});return{reference:{type:"conversation-reply-reference",id:o.id},threadReference:i.reference}}))}getRepliesByCreatorPage(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findRepliesByCreatorAndPageUrl",{pageCreator:this.options.contentSharing._idFromReference(e.pageCreatorReference),normalizedPageUrl:e.normalizedPageUrl});return D()(this._prepareReplies(t),(e=>e.sharedAnnotation.id))}))}getRepliesByAnnotation(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.operation("findRepliesByAnnotation",{sharedList:null!==(n=null===(t=e.sharedListReference)||void 0===t?void 0:t.id)&&void 0!==n?n:null,sharedAnnotation:this.options.contentSharing._idFromReference(e.annotationReference)});return this._prepareReplies(r)}))}getRepliesByAnnotations({sharedListReference:e,annotationReferences:t,sortingFn:n=(e,t)=>e.reply.createdWhen-t.reply.createdWhen}){var i;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield Promise.all(t.map((t=>{var n;return this.operation("findRepliesByAnnotation",{sharedList:null!==(n=null==e?void 0:e.id)&&void 0!==n?n:null,sharedAnnotation:this.options.contentSharing._idFromReference(t)})}))),o={};for(const e of r)for(const t of e)o[t.sharedAnnotation]=[...null!==(i=o[t.sharedAnnotation])&&void 0!==i?i:[],this._prepareReply(t)];for(const e in o)o[e]=o[e].sort(n);return o}))}getReply(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findReplyById",{id:e.replyReference.id,sharedAnnotation:e.annotationReference.id});return t&&this._prepareReply(t)}))}editReply(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("editReplyById",{content:e.content,id:e.replyReference.id,sharedAnnotation:e.annotationReference.id})}))}deleteReply(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteReplyById",{id:e.replyReference.id,sharedAnnotation:e.annotationReference.id})}))}_prepareReplies(e){return j()(e.map((e=>this._prepareReply(e))),(e=>e.reply.createdWhen),"asc")}_prepareReply(e){const t={reference:{type:"conversation-reply-reference",id:e.id},previousReply:e.previousReply?{type:"conversation-reply-reference",id:e.previousReply}:null,reply:A()(e,"sharedPageInfo","sharedAnnotation","user"),sharedAnnotation:{type:"shared-annotation-reference",id:e.sharedAnnotation},userReference:{type:"user-reference",id:e.user}};return e.sharedList&&(t.sharedList={type:"shared-list-reference",id:e.sharedList}),t}getThreadsForAnnotations(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield Object(I.a)(e.annotationReferences.map((e=>e.id)),(t=>{var n,r;return this.operation("findThreadsByAnnotations",{sharedList:null!==(r=null===(n=e.sharedListReference)||void 0===n?void 0:n.id)&&void 0!==r?r:null,sharedAnnotations:t})}))).map((e=>this._prepareThread(e)))}))}_prepareThread(e){return{thread:A()(e,"id","sharedAnnotation","sharedList","pageCreator"),sharedAnnotation:{type:"shared-annotation-reference",id:e.sharedAnnotation},sharedList:null==e.sharedList?null:{type:"shared-list-reference",id:e.sharedList}}}}var F=n(1071);class U extends y.a{constructor(e){super(e),this.getConfig=()=>({collections:{activityFollow:{version:S.a[5].date,fields:{objectId:{type:"string"},collection:{type:"string"},createdWhen:{type:"timestamp"}},indices:[{field:{relationship:"user"}},{field:"collection"},{field:"objectId"}],relationships:[{childOf:"user"}]}},operations:{createFollow:{operation:"createObject",collection:"activityFollow"},deleteFollow:{operation:"deleteObject",collection:"activityFollow",args:{id:"$id:pk"}},findFollow:{operation:"findObject",collection:"activityFollow",args:{collection:"$collection:string",objectId:"$objectId:string",user:"$user:string"}},findFollowsByCollection:{operation:"findObjects",collection:"activityFollow",args:{collection:"$collection:string",user:"$user:string"}},findFollowsByEntity:{operation:"findObjects",collection:"activityFollow",args:{collection:"$collection:string",objectId:"$objectId:string"}}},accessRules:{ownership:{activityFollow:{field:"user",access:["create","delete"]}},permissions:{activityFollow:{read:{rule:!0}}}}}),this.storageManager=e.storageManager}findFollowedEntity({collection:e,objectId:t,userReference:n}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.operation("findFollow",{collection:e,objectId:t,user:n.id});return r?U.prepareFollow(r):null}))}storeFollow({objectId:e,collection:t,userReference:n,createdWhen:i=new Date}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.findFollowedEntity({objectId:e,collection:t,userReference:n});if(r)return r;const{object:o}=yield this.operation("createFollow",{objectId:e,collection:t,user:n.id,createdWhen:i.getTime()});return U.prepareFollow(o)}))}deleteFollow({objectId:e,collection:t,userReference:n}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.findFollowedEntity({objectId:e,collection:t,userReference:n});r&&(yield this.operation("deleteFollow",{id:r.reference.id}))}))}isEntityFollowedByUser({objectId:e,collection:t,userReference:n}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return!!(yield this.findFollowedEntity({objectId:e,collection:t,userReference:n}))}))}getAllEntityFollowers(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.getAllFollowsByEntity(e)).map((e=>e.userReference))}))}getAllFollowsByCollection({collection:e,userReference:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.operation("findFollowsByCollection",{collection:e,user:t.id})).map(U.prepareFollow)}))}getAllFollowsByEntity({collection:e,objectId:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield this.operation("findFollowsByEntity",{collection:e,objectId:t})).map(U.prepareFollow)}))}}U.prepareFollow=e=>{var{id:t,user:n}=e,i=Object(r.__rest)(e,["id","user"]);return Object.assign(Object.assign({},i),{reference:{id:t,type:"activity-follow-reference"},userReference:{id:n,type:"user-reference"}})};var B=n(275),G=n.n(B);const q=()=>({dataUsageEntry:{version:S.a[8].date,fields:{createdWhen:{type:"timestamp"},collection:{type:"string"},objectId:{type:"string"},action:{type:"int"}},relationships:[{childOf:"user"},{childOf:"personalDeviceInfo",alias:"createdByDevice"}]},personalCloudError:{version:S.a[8].date,fields:{createdWhen:{type:"timestamp"},type:{type:"int"},data:{type:"string"}},relationships:[{childOf:"user"},{childOf:"personalDeviceInfo",alias:"createdByDevice"}]}});function H(e,t){return G()(e,(e=>{var n,r;const i=Object.assign(Object.assign({},e.fields),{createdWhen:{type:"timestamp"}});(null==t?void 0:t.excludeUpdatedTimestamp)||(i.updatedWhen={type:"timestamp"});const o=[...null!==(n=e.relationships)&&void 0!==n?n:[],{childOf:"user"}];(null==t?void 0:t.excludeCreationDevice)||o.push({childOf:"personalDeviceInfo",alias:"createdByDevice"});return Object.assign(Object.assign({},e),{fields:i,relationships:o,groupBy:[{subcollectionName:"objects",key:"user"},...null!==(r=e.groupBy)&&void 0!==r?r:[]]})}))}const $=()=>Object.assign(Object.assign(Object.assign({},H({personalDeviceInfo:{version:S.a[8].date,fields:{firebaseId:{type:"string",optional:!0},type:{type:"string"},os:{type:"string"},browser:{type:"string",optional:!0},product:{type:"string"},name:{type:"string",optional:!0}}}},{excludeCreationDevice:!0})),H({personalDataChange:{version:S.a[8].date,fields:{type:{type:"string"},collection:{type:"string"},objectId:{type:"string"},info:{type:"json",optional:!0}}},personalUsageEntry:{version:S.a[9].date,fields:{collection:{type:"string"},objectId:{type:"string"},action:{type:"int"}}}},{excludeUpdatedTimestamp:!0})),H({personalBlockStats:{version:S.a[8].date,fields:{usedBlocks:{type:"int"},lastChange:{type:"int"}}}},{excludeCreationDevice:!0,excludeUpdatedTimestamp:!0})),W=()=>H({personalAnnotationPrivacyLevel:{version:S.a[8].date,fields:{localId:{type:"string"},privacyLevel:{type:"int"}},relationships:[{singleChildOf:"personalAnnotation"}]},personalAnnotationShare:{version:S.a[8].date,fields:{remoteId:{type:"string"},excludeFromLists:{type:"boolean"}},relationships:[{singleChildOf:"personalAnnotation"}]},personalListShare:{version:S.a[8].date,fields:{remoteId:{type:"string"},private:{type:"boolean",optional:!0}},relationships:[{singleChildOf:"personalList"}]}}),z=()=>H({personalTag:{version:S.a[8].date,fields:{name:{type:"string"}}},personalTagConnection:{version:S.a[8].date,fields:{collection:{type:"string"},objectId:{type:"string"}},relationships:[{childOf:"personalTag"}]}}),V=()=>H({personalList:{version:S.a[8].date,fields:{name:{type:"text"},type:{type:"string",optional:!0},localId:{type:"string"},isDeletable:{type:"boolean"},isNestable:{type:"boolean"}}},personalListDescription:{version:S.a[8].date,fields:{description:{type:"text"}},relationships:[{singleChildOf:"personalList"}]},personalListEntry:{version:S.a[8].date,fields:{},relationships:[{childOf:"personalList"},{childOf:"personalContentMetadata"}]},personalListEntryDescription:{version:S.a[8].date,fields:{description:{type:"text"}},relationships:[{singleChildOf:"personalListEntry"}]},personalAnnotationListEntry:{version:S.a[11].date,fields:{},relationships:[{childOf:"personalList"},{childOf:"personalAnnotation"}]},personalFollowedList:{version:S.a[14].date,fields:{name:{type:"string"},type:{type:"string",optional:!0},creator:{type:"string"},sharedList:{type:"string"}}},personalListTree:{version:S.a[20].date,fields:{path:{type:"string"},order:{type:"int"},localId:{type:"int"},localListId:{type:"int"},localPath:{type:"string"},localParentListId:{type:"int"},localLinkTarget:{type:"int"}},relationships:[{singleChildOf:"personalList"},{childOf:"personalList",alias:"linkTarget"},{childOf:"personalList",alias:"parentListId"}]}}),K=()=>H({personalContentMetadata:{version:S.a[21].date,fields:{canonicalUrl:{type:"string"},title:{type:"string",optional:!0},lang:{type:"string",optional:!0},description:{type:"string",optional:!0},doi:{type:"string",optional:!0},metadataTitle:{type:"string",optional:!0},annotation:{type:"string",optional:!0},sourceName:{type:"string",optional:!0},journalName:{type:"string",optional:!0},journalPage:{type:"string",optional:!0},journalIssue:{type:"string",optional:!0},journalVolume:{type:"string",optional:!0},previewImageUrl:{type:"string",optional:!0},releaseDate:{type:"timestamp",optional:!0},accessDate:{type:"timestamp",optional:!0}}},personalContentLocator:{version:S.a[19].date,fields:{locationType:{type:"string"},location:{type:"string"},format:{type:"string"},originalLocation:{type:"string"},locationScheme:{type:"string"},primary:{type:"boolean"},valid:{type:"boolean"},version:{type:"timestamp"},localId:{type:"string",optional:!0},status:{type:"string",optional:!0},fingerprintScheme:{type:"string",optional:!0},fingerprint:{type:"string",optional:!0},lastVisited:{type:"timestamp",optional:!0},contentSize:{type:"int",optional:!0}},relationships:[{childOf:"personalContentMetadata"}]},personalContentEntity:{version:S.a[21].date,fields:{order:{type:"int"},name:{type:"string"},isPrimary:{type:"boolean"},additionalName:{type:"string",optional:!0}},relationships:[{childOf:"personalContentMetadata"}]},personalContentRead:{version:S.a[8].date,fields:{readWhen:{type:"timestamp"},readDuration:{type:"int",optional:!0},scrollMaxPercentage:{type:"float",optional:!0},scrollEndPercentage:{type:"float",optional:!0},scrollMaxPixel:{type:"int",optional:!0},scrollEndPixel:{type:"int",optional:!0},pageTotal:{type:"int",optional:!0},pageEnd:{type:"int",optional:!0},pageMax:{type:"int",optional:!0}},relationships:[{childOf:"personalContentMetadata"},{childOf:"personalContentLocator"}]},personalBookmark:{version:S.a[8].date,fields:{},relationships:[{singleChildOf:"personalContentMetadata"}]}}),Y=()=>H({personalAnnotation:{version:S.a[8].date,fields:{localId:{type:"string"},body:{type:"text",optional:!0},comment:{type:"text",optional:!0}},relationships:[{childOf:"personalContentMetadata"}]},personalAnnotationSelector:{version:S.a[8].date,fields:{selector:{type:"json"}},relationships:[{singleChildOf:"personalAnnotation"}]}}),Q=()=>H({personalTextTemplate:{version:S.a[8].date,fields:{localId:{type:"string"},title:{type:"string"},code:{type:"string"},order:{type:"int",optional:!0},isFavourite:{type:"boolean"},outputFormat:{type:"string",optional:!0}}}}),X=()=>H({personalReadwiseAction:{version:S.a[8].date,fields:{},relationships:[{singleChildOf:"personalAnnotation"}]},personalTwitterAction:{version:S.a[12].date,fields:{},relationships:[{singleChildOf:"personalContentMetadata"}]},personalPageTextFetchAction:{version:S.a[15].date,fields:{},relationships:[{singleChildOf:"personalContentMetadata"}]}},{excludeCreationDevice:!0}),J=()=>H({personalMemexSetting:{version:S.a[8].date,fields:{name:{type:"string"},value:{type:"json"}}}}),Z={createDeviceInfo:{operation:"createObject",collection:"personalDeviceInfo"}},ee=new Set(["dataUsageEntry","personalUsageEntry","personalReadwiseAction","personalCloudError","personalBlockInfo"]);class te extends y.a{constructor(e){super(e),this.options=e,this.getConfig=()=>{const e=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},q()),$()),Y()),Q()),W()),V()),K()),z()),X()),J()),t=function(e){const t={};for(const n of Object.keys(e))ee.has(n)||(t[n]={field:"user",access:"personalBlockStats"!==n?"full":["read","list"]});return t.personalBlockInfo={field:"user",access:["read"]},{ownership:t}}(e);return{collections:e,operations:Z,accessRules:t}}}createDeviceInfo(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{object:t}=yield this.operation("createDeviceInfo",Object.assign(Object.assign({},e.device),{user:e.userId,createdWhen:"$now",updatedWhen:"$now"}));return{id:t.id}}))}}const ne="discordRetroSyncQueue";class re extends y.a{getConfig(){return{collections:{[ne]:{version:S.a[14].date,fields:{guildId:{type:"string"},guildName:{type:"string"},channelId:{type:"string"},lastSyncedMessageId:{type:"string",optional:!0},lastSyncTimestamp:{type:"int",optional:!0},requestTimestamp:{type:"int"}}}},operations:{getAllSyncEntries:{operation:"findObjects",collection:ne,args:{}},getSyncEntryByChannel:{operation:"findObject",collection:ne,args:{channelId:"$channelId:string"}},updateSyncEntry:{operation:"updateObject",collection:ne,args:[{id:"$id:pk"},{lastSyncedMessageId:"$lastSyncedMessageId:string",lastSyncTimestamp:"$lastSyncTimestamp:int"}]},createSyncEntry:{operation:"createObject",collection:ne},deleteSyncEntry:{operation:"deleteObject",collection:ne,args:{id:"$id:pk"}}}}}getAllSyncEntries(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.operation("getAllSyncEntries",{})}))}getSyncEntryByChannel(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("getSyncEntryByChannel",e);return null!=t?t:null}))}updateSyncEntry(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("updateSyncEntry",{id:e,lastSyncedMessageId:t,lastSyncTimestamp:n})}))}createSyncEntry(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.getSyncEntryByChannel(e);if(t)return{type:"discord-sync-entry-reference",id:t.id};const{object:n}=yield this.operation("createSyncEntry",e);return{type:"discord-sync-entry-reference",id:n.id}}))}deleteSyncEntry(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteSyncEntry",{id:e.id})}))}}class ie extends y.a{getConfig(){return{collections:{discordList:{version:S.a[14].date,fields:{guildId:{type:"string"},guildName:{type:"string"},channelId:{type:"string"},channelName:{type:"string"},enabled:{type:"boolean"}},relationships:[{singleChildOf:"sharedList"}],indices:[{field:{relationship:"sharedList"},pk:!0}]},discordEvent:{version:S.a[14].date,fields:{type:{type:"string"},createdWhen:{type:"timestamp"},guildId:{type:"string"},channelId:{type:"string"},messageId:{type:"string"},normalizedPageUrl:{type:"string",optional:!0}},relationships:[{childOf:"sharedList"}]},discordEventAction:{version:S.a[14].date,fields:{},relationships:[{singleChildOf:"discordEvent"}]}},operations:{createDiscordList:{operation:"createObject",collection:"discordList"},findDiscordListForGuildChannel:{operation:"findObject",collection:"discordList",args:{guildId:"$guildId:string",channelId:"$channelId:string"}},findDiscordListForSharedList:{operation:"findObject",collection:"discordList",args:{sharedList:"$sharedList:string"}},findEnabledDiscordListsByGuild:{operation:"findObjects",collection:"discordList",args:{enabled:!0,guildId:"$guildId:string"}},updateDiscordListEnabled:{operation:"updateObjects",collection:"discordList",args:[{sharedList:"$id:pk"},{enabled:"$isEnabled:boolean"}]}},accessRules:{permissions:{discordList:{read:{rule:!0}}}}}}createDiscordList(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{object:n}=yield this.operation("createDiscordList",{guildId:e.guildId,guildName:e.guildName,channelId:e.channelId,channelName:e.channelName,enabled:null!==(t=e.isEnabled)&&void 0!==t&&t,sharedList:e.sharedListReference.id});return{type:"discord-list-reference",id:n.id}}))}findDiscordListForSharedList({id:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findDiscordListForSharedList",{sharedList:e});return null!=t?t:null}))}findDiscordList({channelId:e,guildId:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.operation("findDiscordListForGuildChannel",{channelId:e,guildId:t});return null!=n?n:null}))}findEnabledDiscordListsByGuild(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findEnabledDiscordListsByGuild",{guildId:e.guildId})}))}setDiscordListEnabled(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("updateDiscordListEnabled",{id:e.id,isEnabled:e.isEnabled})}))}}class oe extends y.a{getConfig(){return{collections:{slackList:{version:S.a[15].date,fields:{workspaceId:{type:"string"},workspaceName:{type:"string"},channelId:{type:"string"},channelName:{type:"string"},enabled:{type:"boolean"}},relationships:[{singleChildOf:"sharedList"}],indices:[{field:{relationship:"sharedList"},pk:!0}]},slackEvent:{version:S.a[15].date,fields:{type:{type:"string"},createdWhen:{type:"timestamp"},workspaceId:{type:"string"},channelId:{type:"string"},messageId:{type:"string"},normalizedPageUrl:{type:"string",optional:!0}},relationships:[{childOf:"sharedList"}]},slackEventAction:{version:S.a[15].date,fields:{},relationships:[{singleChildOf:"slackEvent"}]},slackInstall:{version:S.a[15].date,fields:{token:{type:"string"},botId:{type:"string"},userId:{type:"string"},botScopes:{type:"string"},workspaceId:{type:"string"},authVersion:{type:"string"},enterpriseUrl:{type:"string"},isEnterpriseInstall:{type:"boolean"},createdWhen:{type:"timestamp"},updatedWhen:{type:"timestamp"}}}},operations:{createSlackList:{operation:"createObject",collection:"slackList"},createSlackInstall:{operation:"createObject",collection:"slackInstall"},updateSlackInstallToken:{operation:"updateObjects",collection:"slackInstall",args:[{workspaceId:"$workspaceId:string"},{token:"$token:string",botScopes:"$botScopes:string",updatedWhen:"$updatedWhen:number"}]},findSlackListForWorkspaceChannel:{operation:"findObject",collection:"slackList",args:{workspaceId:"$workspaceId:string",channelId:"$channelId:string"}},findSlackListForSharedList:{operation:"findObject",collection:"slackList",args:{sharedList:"$sharedList:string"}},findEnabledSlackListsByWorkspace:{operation:"findObjects",collection:"slackList",args:{enabled:!0,workspaceId:"$workspaceId:string"}},findSlackInstall:{operation:"findObject",collection:"slackInstall",args:{workspaceId:"$workspaceId:string"}},updateSlackListEnabled:{operation:"updateObjects",collection:"slackList",args:[{sharedList:"$id:pk"},{enabled:"$isEnabled:boolean"}]},deleteSlackInstall:{operation:"deleteObject",collection:"slackInstall",args:{workspaceId:"$workspaceId:string"}}},accessRules:{permissions:{slackList:{read:{rule:!0}}}}}}createSlackInstall(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.findSlackInstall(e);if(n)return yield this.operation("updateSlackInstallToken",{token:e.token,botScopes:e.botScopes.join(","),workspaceId:e.workspaceId,updatedWhen:e.createdWhen}),{type:"slack-install-reference",id:n.id};const{object:r}=yield this.operation("createSlackInstall",{token:e.token,botId:e.botId,userId:e.userId,workspaceId:e.workspaceId,authVersion:e.authVersion,isEnterpriseInstall:e.isEnterpriseInstall,enterpriseUrl:null!==(t=e.enterpriseUrl)&&void 0!==t?t:null,botScopes:e.botScopes.join(","),createdWhen:e.createdWhen,updatedWhen:e.createdWhen});return{type:"slack-install-reference",id:r.id}}))}createSlackList(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{object:n}=yield this.operation("createSlackList",{workspaceId:e.workspaceId,workspaceName:e.workspaceName,channelId:e.channelId,channelName:e.channelName,enabled:null!==(t=e.isEnabled)&&void 0!==t&&t,sharedList:e.sharedListReference.id});return{type:"slack-list-reference",id:n.id}}))}findSlackInstall(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.operation("findSlackInstall",{workspaceId:e.workspaceId});return n?Object.assign(Object.assign({},n),{botScopes:n.botScopes.split(","),enterpriseUrl:null!==(t=n.enterpriseUrl)&&void 0!==t?t:void 0}):null}))}findSlackListForSharedList({id:e}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("findSlackListForSharedList",{sharedList:e});return null!=t?t:null}))}findSlackList({channelId:e,workspaceId:t}){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this.operation("findSlackListForWorkspaceChannel",{channelId:e,workspaceId:t});return null!=n?n:null}))}findEnabledSlackListsByWorkspace(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findEnabledSlackListsByWorkspace",{workspaceId:e.workspaceId})}))}setSlackListEnabled(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("updateSlackListEnabled",{id:e.id,isEnabled:e.isEnabled})}))}deleteSlackInstall(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteSlackInstall",{workspaceId:e.workspaceId})}))}}const se="slackRetroSyncQueue";class ae extends y.a{getConfig(){return{collections:{[se]:{version:S.a[15].date,fields:{channelId:{type:"string"},workspaceId:{type:"string"},lastSyncedMessageId:{type:"string",optional:!0},lastSyncTimestamp:{type:"int",optional:!0},requestTimestamp:{type:"int"}}}},operations:{getAllSyncEntries:{operation:"findObjects",collection:se,args:{}},getSyncEntryByChannel:{operation:"findObject",collection:se,args:{channelId:"$channelId:string"}},updateSyncEntry:{operation:"updateObject",collection:se,args:[{id:"$id:pk"},{lastSyncedMessageId:"$lastSyncedMessageId:string",lastSyncTimestamp:"$lastSyncTimestamp:int"}]},createSyncEntry:{operation:"createObject",collection:se},deleteSyncEntry:{operation:"deleteObject",collection:se,args:{id:"$id:pk"}}}}}getAllSyncEntries(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield this.operation("getAllSyncEntries",{})}))}getSyncEntryByChannel(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.operation("getSyncEntryByChannel",e);return null!=t?t:null}))}updateSyncEntry(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("updateSyncEntry",{id:e,lastSyncedMessageId:t,lastSyncTimestamp:n})}))}createSyncEntry(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.getSyncEntryByChannel(e);if(r)return{type:"slack-sync-entry-reference",id:r.id};const{object:i}=yield this.operation("createSyncEntry",{channelId:e.channelId,workspaceId:e.workspaceId,requestTimestamp:e.requestTimestamp,lastSyncTimestamp:null!==(t=e.lastSyncTimestamp)&&void 0!==t?t:null,lastSyncedMessageId:null!==(n=e.lastSyncedMessageId)&&void 0!==n?n:null});return{type:"slack-sync-entry-reference",id:i.id}}))}deleteSyncEntry(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteSyncEntry",{id:e.id})}))}}class ce extends y.a{getConfig(){return{collections:{personalApiKey:{version:S.a[18].date,fields:{createdWhen:{type:"timestamp"},secretHash:{type:"string"},label:{type:"string",optional:!0}},relationships:[{childOf:"user"}],indices:[]}},operations:{createPersonalKey:{operation:"createObject",collection:"personalApiKey"},getPersonalKey:{operation:"findObject",collection:"personalApiKey",args:{id:"$id:pk"}},listPersonalKeys:{operation:"findObjects",collection:"personalApiKey",args:{user:"$user:pk"}},deletePersonalKey:{operation:"deleteObject",collection:"personalApiKey",args:{user:"$user:pk",id:"$id:pk"}}},accessRules:{ownership:{}}}}createPersonalKey(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("createPersonalKey",e)}))}getPersonalKey(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("getPersonalKey",{id:e.id})}))}getPersonalKeys(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("listPersonalKeys",{user:e.id})}))}deletePersonalKey(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("deletePersonalKey",{user:e.id,id:t.id})}))}}class le extends y.a{getConfig(){return{collections:{uploadAuditLogEntry:{version:S.a[19].date,fields:{createdWhen:{type:"timestamp"},uploadType:{type:"string"},uploadId:{type:"string"},status:{type:"string"}},relationships:[{childOf:"user"}],indices:[]}},operations:{}}}}class ue extends y.a{getConfig(){return{collections:{blueskyOAuthState:{version:S.a[22].date,fields:{state:{type:"string"},codeVerifier:{type:"string"},createdWhen:{type:"timestamp"},expiresWhen:{type:"timestamp"}},indices:[{field:"state",pk:!0}],relationships:[]},blueskyUser:{version:S.a[22].date,fields:{did:{type:"string"},handle:{type:"string"},avatar:{type:"string"},displayName:{type:"string"},createdWhen:{type:"timestamp"},updatedWhen:{type:"timestamp"}},relationships:[{singleChildOf:"user"}],indices:[{field:{relationship:"user"},pk:!0}]},blueskyList:{version:S.a[22].date,fields:{linkPostRef:{type:"string"},botMentionPostRef:{type:"string"},createdWhen:{type:"timestamp"},updatedWhen:{type:"timestamp"}},relationships:[{singleChildOf:"sharedList"}],indices:[{field:{relationship:"sharedList"},pk:!0}]}},operations:{createOAuthState:{operation:"createObject",collection:"blueskyOAuthState"},findOAuthState:{operation:"findObject",collection:"blueskyOAuthState",args:{state:"$state:string"}},deleteOAuthState:{operation:"deleteObject",collection:"blueskyOAuthState",args:{state:"$state:string"}},createBlueskyUser:{operation:"createObject",collection:"blueskyUser"},findBlueskyUserByUserId:{operation:"findObject",collection:"blueskyUser",args:{user:"$user:string"}},findBlueskyUsersByUserIds:{operation:"findObjects",collection:"blueskyUser",args:{user:{$in:"$userIds:array"}}},createBlueskyList:{operation:"createObject",collection:"blueskyList"},findBlueskyListBySharedList:{operation:"findObject",collection:"blueskyList",args:{sharedList:"$sharedList:string"}}},accessRules:{permissions:{blueskyUser:{read:{rule:!0}},blueskyList:{read:{rule:!0}}}}}}createOAuthState(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("createOAuthState",{state:e.state,codeVerifier:e.codeVerifier,createdWhen:e.createdWhen,expiresWhen:e.expiresWhen})}))}findOAuthState(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findOAuthState",{state:e.state})}))}deleteOAuthState(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("deleteOAuthState",{state:e.state})}))}findBlueskyUserByUserReference(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findBlueskyUserByUserId",{user:e.user.id})}))}findBlueskyUsersByUserReferences(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){let t=[];for(const n of e.users){const e=yield this.operation("findBlueskyUserByUserId",{user:n.id});e&&t.push(Object.assign(Object.assign({},e),{id:n.id}))}return Object.fromEntries(t.map((e=>[e.id,Object.assign(Object.assign({},e),{user:{type:"user-reference",id:e.id}})])))}))}createBlueskyUserIfNeeded(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){(yield this.findBlueskyUserByUserReference({user:e.user}))||(yield this.operation("createBlueskyUser",{did:e.did,user:e.user.id,handle:e.handle,avatar:e.avatar,displayName:e.displayName,createdWhen:e.createdWhen,updatedWhen:e.updatedWhen}))}))}createBlueskyList(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.operation("createBlueskyList",{sharedList:e.sharedList,linkPostRef:e.linkPostRef,botMentionPostRef:e.botMentionPostRef,createdWhen:e.createdWhen,updatedWhen:e.updatedWhen})}))}findBlueskyListBySharedList(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this.operation("findBlueskyListBySharedList",{sharedList:e.sharedList.id})}))}}let de=!1;function he(e){const t=Object(i.a)();return function(e,t){var n,r;const i=new o.b({backend:e}),s=null!==(r=null===(n=null==t?void 0:t.setupMiddleware)||void 0===n?void 0:n.call(t,i))&&void 0!==r?r:[];s.length&&i.setMiddleware(s);return i}(new d({firestore:t.firestore(),firebaseModules:{serverTimestamp:t.firestore.FieldValue.serverTimestamp,documentId:t.firestore.FieldPath.documentId,fromMillis:t.firestore.Timestamp.fromMillis}}),e)}function fe(e,t){var n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){try{globalThis.setServerStorageLoggingEnabled=e=>de=e}catch(e){}const o=t.skipApplicationLayer?t=>Object(y.b)(e):function(e){const t=Object(i.a)(),n=function(e){const t={};for(const n of Object.keys(P))t[n]=x(e,n);return t}(((e,n)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=t.functions();return(yield r.httpsCallable(e)(n)).data})))),o=Object(y.b)(e),s=e=>t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=k[e];return(null==r?void 0:r[t.name])?n.executeStorageModuleOperation({storageModule:e,operationName:t.name,operationArgs:t.context}):o(t)}));return s}(e),s=null!==(n=t.sharedSyncLog)&&void 0!==n?n:new T({storageManager:e,autoPkType:"string"}),a=new R.b(Object.assign({storageManager:e,operationExecuter:o("contentSharing")},t)),c=new M(Object.assign({storageManager:e,contentSharing:a,operationExecuter:o("contentConversations")},t)),l=new C({storageManager:e,operationExecuter:o("users")}),u=new F.a({storageManager:e}),d=new te({storageManager:e,autoPkType:t.autoPkType}),h=new U({storageManager:e,operationExecuter:o("activityFollows")}),f=new ie({storageManager:e,operationExecuter:o("discord")}),p=new re({storageManager:e,operationExecuter:o("discordRetroSync")}),g=new oe({storageManager:e,operationExecuter:o("slack")}),m=new ae({storageManager:e,operationExecuter:o("slackRetroSync")}),v=new ce({storageManager:e,operationExecuter:o("publicApi")}),b=new le({storageManager:e,operationExecuter:o("uploads")}),_=new ue({storageManager:e,operationExecuter:o("bluesky")}),w={manager:e,modules:{uploads:b,sharedSyncLog:s,users:l,contentSharing:a,activityStreams:u,activityFollows:h,contentConversations:c,personalCloud:d,bluesky:_,discordRetroSync:p,discord:f,slackRetroSync:m,slack:g,publicApi:v}};return Object(y.c)(e.registry,w.modules),yield e.finishInitialization(),w}))}},function(e,t,n){"use strict";n.r(t),n.d(t,"deleteInstallations",(function(){return Z})),n.d(t,"getId",(function(){return Q})),n.d(t,"getInstallations",(function(){return te})),n.d(t,"getToken",(function(){return X})),n.d(t,"onIdChange",(function(){return ee}));var r=n(74),i=n(201),o=n(30),s=n(697);const a="@firebase/installations",c="0.6.6",l=1e4,u=`w:${c}`,d="FIS_v2",h="https://firebaseinstallations.googleapis.com/v1",f=36e5,p={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},g=new o.ErrorFactory("installations","Installations",p);function m(e){return e instanceof o.FirebaseError&&e.code.includes("request-failed")}function y({projectId:e}){return`${h}/projects/${e}/installations`}function v(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function b(e,t){const n=(await t.json()).error;return g.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function _({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function w(e,{refreshToken:t}){const n=_(e);return n.append("Authorization",function(e){return`${d} ${e}`}(t)),n}async function T(e){const t=await e();return t.status>=500&&t.status<600?e():t}function E(e){return new Promise((t=>{setTimeout(t,e)}))}const A=/^[cdef][\w-]{21}$/,S="";function O(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return A.test(t)?t:S}catch(e){return S}}function I(e){return`${e.appName}!${e.appId}`}const C=new Map;function k(e,t){const n=I(e);P(n,t),function(e,t){const n=R();n&&n.postMessage({key:e,fid:t});L()}(n,t)}function P(e,t){const n=C.get(e);if(n)for(const e of n)e(t)}let x=null;function R(){return!x&&"BroadcastChannel"in self&&(x=new BroadcastChannel("[Firebase] FID Change"),x.onmessage=e=>{P(e.data.key,e.data.fid)}),x}function L(){0===C.size&&x&&(x.close(),x=null)}const D="firebase-installations-database",N=1,j="firebase-installations-store";let M=null;function F(){return M||(M=Object(s.openDB)(D,N,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(j)}})),M}async function U(e,t){const n=I(e),r=(await F()).transaction(j,"readwrite"),i=r.objectStore(j),o=await i.get(n);return await i.put(t,n),await r.done,o&&o.fid===t.fid||k(e,t.fid),t}async function B(e){const t=I(e),n=(await F()).transaction(j,"readwrite");await n.objectStore(j).delete(t),await n.done}async function G(e,t){const n=I(e),r=(await F()).transaction(j,"readwrite"),i=r.objectStore(j),o=await i.get(n),s=t(o);return void 0===s?await i.delete(n):await i.put(s,n),await r.done,!s||o&&o.fid===s.fid||k(e,s.fid),s}async function q(e){let t;const n=await G(e.appConfig,(n=>{const r=function(e){const t=e||{fid:O(),registrationStatus:0};return W(t)}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(g.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const r=y(e),i=_(e),o=t.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const s={fid:n,authVersion:d,appId:e.appId,sdkVersion:u},a={method:"POST",headers:i,body:JSON.stringify(s)},c=await T((()=>fetch(r,a)));if(c.ok){const e=await c.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:v(e.authToken)}}throw await b("Create Installation",c)}(e,t);return U(e.appConfig,n)}catch(n){throw m(n)&&409===n.customData.serverCode?await B(e.appConfig):await U(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:H(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}));return n.fid===S?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function H(e){let t=await $(e.appConfig);for(;1===t.registrationStatus;)await E(100),t=await $(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await q(e);return n||t}return t}function $(e){return G(e,(e=>{if(!e)throw g.create("installation-not-found");return W(e)}))}function W(e){return 1===(t=e).registrationStatus&&t.registrationTime+l<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function z({appConfig:e,heartbeatServiceProvider:t},n){const r=function(e,{fid:t}){return`${y(e)}/${t}/authTokens:generate`}(e,n),i=w(e,n),o=t.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const s={installation:{sdkVersion:u,appId:e.appId}},a={method:"POST",headers:i,body:JSON.stringify(s)},c=await T((()=>fetch(r,a)));if(c.ok){return v(await c.json())}throw await b("Generate Auth Token",c)}async function V(e,t=!1){let n;const r=await G(e.appConfig,(r=>{if(!Y(r))throw g.create("not-registered");const i=r.authToken;if(!t&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+f}(e)}(i))return r;if(1===i.requestStatus)return n=async function(e,t){let n=await K(e.appConfig);for(;1===n.authToken.requestStatus;)await E(100),n=await K(e.appConfig);const r=n.authToken;return 0===r.requestStatus?V(e,t):r}(e,t),r;{if(!navigator.onLine)throw g.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return n=async function(e,t){try{const n=await z(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await U(e.appConfig,r),n}catch(n){if(!m(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await U(e.appConfig,n)}else await B(e.appConfig);throw n}}(e,t),t}}));return n?await n:r.authToken}function K(e){return G(e,(e=>{if(!Y(e))throw g.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+l<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n}))}function Y(e){return void 0!==e&&2===e.registrationStatus}async function Q(e){const t=e,{installationEntry:n,registrationPromise:r}=await q(t);return r?r.catch(console.error):V(t).catch(console.error),n.fid}async function X(e,t=!1){const n=e;await async function(e){const{registrationPromise:t}=await q(e);t&&await t}(n);return(await V(n,t)).token}async function J(e,t){const n=function(e,{fid:t}){return`${y(e)}/${t}`}(e,t),r={method:"DELETE",headers:w(e,t)},i=await T((()=>fetch(n,r)));if(!i.ok)throw await b("Delete Installation",i)}async function Z(e){const{appConfig:t}=e,n=await G(t,(e=>{if(!e||0!==e.registrationStatus)return e}));if(n){if(1===n.registrationStatus)throw g.create("delete-pending-registration");if(2===n.registrationStatus){if(!navigator.onLine)throw g.create("app-offline");await J(t,n),await B(t)}}}function ee(e,t){const{appConfig:n}=e;return function(e,t){R();const n=I(e);let r=C.get(n);r||(r=new Set,C.set(n,r)),r.add(t)}(n,t),()=>{!function(e,t){const n=I(e),r=C.get(n);r&&(r.delete(t),0===r.size&&C.delete(n),L())}(n,t)}}function te(e=Object(r.getApp)()){return Object(r._getProvider)(e,"installations").getImmediate()}function ne(e){return g.create("missing-app-config-values",{valueName:e})}const re="installations",ie=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw ne("App Configuration");if(!e.name)throw ne("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw ne(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:Object(r._getProvider)(t,"heartbeat"),_delete:()=>Promise.resolve()}},oe=e=>{const t=e.getProvider("app").getImmediate(),n=Object(r._getProvider)(t,re).getImmediate();return{getId:()=>Q(n),getToken:e=>X(n,e)}};Object(r._registerComponent)(new i.Component(re,ie,"PUBLIC")),Object(r._registerComponent)(new i.Component("installations-internal",oe,"PRIVATE")),Object(r.registerVersion)(a,c),Object(r.registerVersion)(a,c,"esm2017")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(1167);var r,i,o=n(201),s=n(2),a=n(697),c=n(30),l=n(74),u="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",d="FCM_MSG";function h(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,s.__spreadArray([],s.__read(t),!1))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function f(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}!function(e){e[e.DATA_MESSAGE=1]="DATA_MESSAGE",e[e.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"}(r||(r={})),function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(i||(i={}));var p="fcm_token_details_db",g="fcm_token_object_Store";function m(e){return s.__awaiter(this,void 0,void 0,(function(){var t,n,r,i=this;return s.__generator(this,(function(o){switch(o.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(t=o.sent(),n=t.map((function(e){return e.name})),!n.includes(p))return[2,null];o.label=2;case 2:return r=null,[4,a.openDB(p,5,{upgrade:function(t,n,o,a){return s.__awaiter(i,void 0,void 0,(function(){var i,o,c,l;return s.__generator(this,(function(s){switch(s.label){case 0:return n<2?[2]:t.objectStoreNames.contains(g)?[4,(i=a.objectStore(g)).index("fcmSenderId").get(e)]:[2];case 1:return o=s.sent(),[4,i.clear()];case 2:if(s.sent(),!o)return[2];if(2===n){if(!(c=o).auth||!c.p256dh||!c.endpoint)return[2];r={token:c.fcmToken,createTime:null!==(l=c.createTime)&&void 0!==l?l:Date.now(),subscriptionOptions:{auth:c.auth,p256dh:c.p256dh,endpoint:c.endpoint,swScope:c.swScope,vapidKey:"string"==typeof c.vapidKey?c.vapidKey:h(c.vapidKey)}}}else(3===n||4===n)&&(r={token:(c=o).fcmToken,createTime:c.createTime,subscriptionOptions:{auth:h(c.auth),p256dh:h(c.p256dh),endpoint:c.endpoint,swScope:c.swScope,vapidKey:h(c.vapidKey)}});return[2]}}))}))}})];case 3:return o.sent().close(),[4,a.deleteDB(p)];case 4:return o.sent(),[4,a.deleteDB("fcm_vapid_details_db")];case 5:return o.sent(),[4,a.deleteDB("undefined")];case 6:return o.sent(),[2,y(r)?r:null]}}))}))}function y(e){if(!e||!e.subscriptionOptions)return!1;var t=e.subscriptionOptions;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}var v,b="firebase-messaging-store",_=null;function w(){return _||(_=a.openDB("firebase-messaging-database",1,{upgrade:function(e,t){if(0===t)e.createObjectStore(b)}})),_}function T(e){return s.__awaiter(this,void 0,void 0,(function(){var t,n,r;return s.__generator(this,(function(i){switch(i.label){case 0:return t=S(e),[4,w()];case 1:return[4,i.sent().transaction(b).objectStore(b).get(t)];case 2:return(n=i.sent())?[2,n]:[3,3];case 3:return[4,m(e.appConfig.senderId)];case 4:return(r=i.sent())?[4,E(e,r)]:[3,6];case 5:return i.sent(),[2,r];case 6:return[2]}}))}))}function E(e,t){return s.__awaiter(this,void 0,void 0,(function(){var n,r,i;return s.__generator(this,(function(o){switch(o.label){case 0:return n=S(e),[4,w()];case 1:return r=o.sent(),[4,(i=r.transaction(b,"readwrite")).objectStore(b).put(t,n)];case 2:return o.sent(),[4,i.done];case 3:return o.sent(),[2,t]}}))}))}function A(e){return s.__awaiter(this,void 0,void 0,(function(){var t,n,r;return s.__generator(this,(function(i){switch(i.label){case 0:return t=S(e),[4,w()];case 1:return n=i.sent(),[4,(r=n.transaction(b,"readwrite")).objectStore(b).delete(t)];case 2:return i.sent(),[4,r.done];case 3:return i.sent(),[2]}}))}))}function S(e){return e.appConfig.appId}var O=((v={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',v["only-available-in-window"]="This method is available in a Window context.",v["only-available-in-sw"]="This method is available in a service worker context.",v["permission-default"]="The notification permission was not granted and dismissed instead.",v["permission-blocked"]="The notification permission was not granted and blocked instead.",v["unsupported-browser"]="This browser doesn't support the API's required to use the Firebase SDK.",v["indexed-db-unsupported"]="This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)",v["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",v["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",v["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",v["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",v["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",v["token-update-no-token"]="FCM returned no token when updating the user to push.",v["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",v["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",v["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",v["invalid-vapid-key"]="The public VAPID key must be a string.",v["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",v),I=new c.ErrorFactory("messaging","Messaging",O);function C(e,t){return s.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,a,c;return s.__generator(this,(function(s){switch(s.label){case 0:return[4,R(e)];case 1:n=s.sent(),r=L(t),i={method:"POST",headers:n,body:JSON.stringify(r)},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(x(e.appConfig),i)];case 3:return[4,s.sent().json()];case 4:return o=s.sent(),[3,6];case 5:throw a=s.sent(),I.create("token-subscribe-failed",{errorInfo:null==a?void 0:a.toString()});case 6:if(o.error)throw c=o.error.message,I.create("token-subscribe-failed",{errorInfo:c});if(!o.token)throw I.create("token-subscribe-no-token");return[2,o.token]}}))}))}function k(e,t){return s.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,a,c;return s.__generator(this,(function(s){switch(s.label){case 0:return[4,R(e)];case 1:n=s.sent(),r=L(t.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch("".concat(x(e.appConfig),"/").concat(t.token),i)];case 3:return[4,s.sent().json()];case 4:return o=s.sent(),[3,6];case 5:throw a=s.sent(),I.create("token-update-failed",{errorInfo:null==a?void 0:a.toString()});case 6:if(o.error)throw c=o.error.message,I.create("token-update-failed",{errorInfo:c});if(!o.token)throw I.create("token-update-no-token");return[2,o.token]}}))}))}function P(e,t){return s.__awaiter(this,void 0,void 0,(function(){var n,r,i,o,a;return s.__generator(this,(function(s){switch(s.label){case 0:return[4,R(e)];case 1:n=s.sent(),r={method:"DELETE",headers:n},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch("".concat(x(e.appConfig),"/").concat(t),r)];case 3:return[4,s.sent().json()];case 4:if((i=s.sent()).error)throw o=i.error.message,I.create("token-unsubscribe-failed",{errorInfo:o});return[3,6];case 5:throw a=s.sent(),I.create("token-unsubscribe-failed",{errorInfo:null==a?void 0:a.toString()});case 6:return[2]}}))}))}function x(e){var t=e.projectId;return"".concat("https://fcmregistrations.googleapis.com/v1","/projects/").concat(t,"/registrations")}function R(e){var t=e.appConfig,n=e.installations;return s.__awaiter(this,void 0,void 0,(function(){var e;return s.__generator(this,(function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return e=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":"FIS ".concat(e)})]}}))}))}function L(e){var t=e.p256dh,n=e.auth,r=e.endpoint,i=e.vapidKey,o={web:{endpoint:r,auth:n,p256dh:t}};return i!==u&&(o.web.applicationPubKey=i),o}function D(e){return s.__awaiter(this,void 0,void 0,(function(){var t,n,r,i;return s.__generator(this,(function(o){switch(o.label){case 0:return[4,F(e.swRegistration,e.vapidKey)];case 1:return t=o.sent(),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:h(t.getKey("auth")),p256dh:h(t.getKey("p256dh"))},[4,T(e.firebaseDependencies)];case 2:return(r=o.sent())?[3,3]:[2,M(e.firebaseDependencies,n)];case 3:if(s=r.subscriptionOptions,c=(a=n).vapidKey===s.vapidKey,l=a.endpoint===s.endpoint,u=a.auth===s.auth,d=a.p256dh===s.p256dh,c&&l&&u&&d)return[3,8];o.label=4;case 4:return o.trys.push([4,6,,7]),[4,P(e.firebaseDependencies,r.token)];case 5:return o.sent(),[3,7];case 6:return i=o.sent(),console.warn(i),[3,7];case 7:return[2,M(e.firebaseDependencies,n)];case 8:return Date.now()>=r.createTime+6048e5?[2,j(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n})]:[2,r.token];case 9:return[2]}var s,a,c,l,u,d}))}))}function N(e){return s.__awaiter(this,void 0,void 0,(function(){var t,n;return s.__generator(this,(function(r){switch(r.label){case 0:return[4,T(e.firebaseDependencies)];case 1:return(t=r.sent())?[4,P(e.firebaseDependencies,t.token)]:[3,4];case 2:return r.sent(),[4,A(e.firebaseDependencies)];case 3:r.sent(),r.label=4;case 4:return[4,e.swRegistration.pushManager.getSubscription()];case 5:return(n=r.sent())?[2,n.unsubscribe()]:[2,!0]}}))}))}function j(e,t){return s.__awaiter(this,void 0,void 0,(function(){var n,r;return s.__generator(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,k(e.firebaseDependencies,t)];case 1:return n=i.sent(),r=s.__assign(s.__assign({},t),{token:n,createTime:Date.now()}),[4,E(e.firebaseDependencies,r)];case 2:return i.sent(),[2,n];case 3:throw i.sent();case 4:return[2]}}))}))}function M(e,t){return s.__awaiter(this,void 0,void 0,(function(){var n,r;return s.__generator(this,(function(i){switch(i.label){case 0:return[4,C(e,t)];case 1:return n=i.sent(),r={token:n,createTime:Date.now(),subscriptionOptions:t},[4,E(e,r)];case 2:return i.sent(),[2,r.token]}}))}))}function F(e,t){return s.__awaiter(this,void 0,void 0,(function(){var n;return s.__generator(this,(function(r){switch(r.label){case 0:return[4,e.pushManager.getSubscription()];case 1:return(n=r.sent())?[2,n]:[2,e.pushManager.subscribe({userVisibleOnly:!1,applicationServerKey:f(t)})]}}))}))}function U(e,t){return s.__awaiter(this,void 0,void 0,(function(){var n,r,i;return s.__generator(this,(function(o){switch(o.label){case 0:return r=B,i=[t],[4,e.firebaseDependencies.installations.getId()];case 1:return n=r.apply(void 0,i.concat([o.sent()])),function(e,t,n){var r={};r.event_time_ms=Math.floor(Date.now()).toString(),r.source_extension_json_proto3=JSON.stringify(t),!n||(r.compliance_data=function(e){var t={privacy_context:{prequest:{origin_associated_product_id:e}}};return t}(n));e.logEvents.push(r)}(e,n,t.productId),[2]}}))}))}function B(e,t){var n,i,o={};return e.from&&(o.project_number=e.from),e.fcmMessageId&&(o.message_id=e.fcmMessageId),o.instance_id=t,e.notification?o.message_type=r.DISPLAY_NOTIFICATION.toString():o.message_type=r.DATA_MESSAGE.toString(),o.sdk_platform=3..toString(),o.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),e.collapse_key&&(o.collapse_key=e.collapse_key),o.event=1..toString(),(null===(n=e.fcmOptions)||void 0===n?void 0:n.analytics_label)&&(o.analytics_label=null===(i=e.fcmOptions)||void 0===i?void 0:i.analytics_label),o}function G(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function q(e){var t,n;return s.__awaiter(this,void 0,void 0,(function(){var r,o,a,c,l;return s.__generator(this,(function(s){switch(s.label){case 0:return(r=null===(n=null===(t=e.notification)||void 0===t?void 0:t.data)||void 0===n?void 0:n[d])?e.action?[2]:(e.stopImmediatePropagation(),e.notification.close(),o=function(e){var t,n,r,i=null!==(n=null===(t=e.fcmOptions)||void 0===t?void 0:t.link)&&void 0!==n?n:null===(r=e.notification)||void 0===r?void 0:r.click_action;if(i)return i;return o=e.data,"object"==typeof o&&o&&"google.c.a.c_id"in o?self.location.origin:null;var o}(r),o?(a=new URL(o,self.location.href),c=new URL(self.location.origin),a.host!==c.host?[2]:[4,$(a)]):[2]):[2];case 1:return(l=s.sent())?[3,4]:[4,self.clients.openWindow(o)];case 2:return l=s.sent(),[4,(u=3e3,new Promise((function(e){setTimeout(e,u)})))];case 3:return s.sent(),[3,6];case 4:return[4,l.focus()];case 5:l=s.sent(),s.label=6;case 6:return l?(r.messageType=i.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,[2,l.postMessage(r)]):[2]}var u}))}))}function H(e){var t,n=s.__assign({},e.notification);return n.data=((t={})[d]=e,t),n}function $(e){return s.__awaiter(this,void 0,void 0,(function(){var t,n,r,i,o,a,c;return s.__generator(this,(function(l){switch(l.label){case 0:return[4,z()];case 1:t=l.sent();try{for(n=s.__values(t),r=n.next();!r.done;r=n.next())if(i=r.value,o=new URL(i.url,self.location.href),e.host===o.host)return[2,i]}catch(e){a={error:e}}finally{try{r&&!r.done&&(c=n.return)&&c.call(n)}finally{if(a)throw a.error}}return[2,null]}}))}))}function W(e,t){var n,r;t.isFirebaseMessaging=!0,t.messageType=i.PUSH_RECEIVED;try{for(var o=s.__values(e),a=o.next();!a.done;a=o.next()){a.value.postMessage(t)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}function z(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function V(e){var t,n=e.actions,r=Notification.maxActions;return n&&r&&n.length>r&&console.warn("This browser only supports ".concat(r," actions. The remaining actions will not be displayed.")),self.registration.showNotification(null!==(t=e.title)&&void 0!==t?t:"",e)}function K(e){return I.create("missing-app-config-values",{valueName:e})}G("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),G("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");var Y=function(){function e(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;var r=function(e){var t,n;if(!e||!e.options)throw K("App Configuration Object");if(!e.name)throw K("App Name");var r=e.options;try{for(var i=s.__values(["projectId","apiKey","appId","messagingSenderId"]),o=i.next();!o.done;o=i.next()){var a=o.value;if(!r[a])throw K(a)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return{appName:e.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}return e.prototype._delete=function(){return Promise.resolve()},e}(),Q=function(e){var t=new Y(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return self.addEventListener("push",(function(e){e.waitUntil(function(e,t){return s.__awaiter(this,void 0,void 0,(function(){var n,r,i;return s.__generator(this,(function(o){switch(o.label){case 0:return n=function(e){var t=e.data;if(!t)return null;try{return t.json()}catch(e){return null}}(e),n?t.deliveryMetricsExportedToBigQueryEnabled?[4,U(t,n)]:[3,2]:[2];case 1:o.sent(),o.label=2;case 2:return[4,z()];case 3:return function(e){return e.some((function(e){return"visible"===e.visibilityState&&!e.url.startsWith("chrome-extension://")}))}(r=o.sent())?[2,W(r,n)]:n.notification?[4,V(H(n))]:[3,5];case 4:o.sent(),o.label=5;case 5:return t?t.onBackgroundMessageHandler?(i=function(e){var t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(t.notification){e.notification={};var n=t.notification.title;n&&(e.notification.title=n);var r=t.notification.body;r&&(e.notification.body=r);var i=t.notification.image;i&&(e.notification.image=i);var o=t.notification.icon;o&&(e.notification.icon=o)}}(t,e),function(e,t){t.data&&(e.data=t.data)}(t,e),function(e,t){var n,r,i,o,s;if(t.fcmOptions||(null===(n=t.notification)||void 0===n?void 0:n.click_action)){e.fcmOptions={};var a=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(o=t.notification)||void 0===o?void 0:o.click_action;a&&(e.fcmOptions.link=a);var c=null===(s=t.fcmOptions)||void 0===s?void 0:s.analytics_label;c&&(e.fcmOptions.analyticsLabel=c)}}(t,e),t}(n),"function"!=typeof t.onBackgroundMessageHandler?[3,7]:[4,t.onBackgroundMessageHandler(i)]):[3,8]:[2];case 6:return o.sent(),[3,8];case 7:t.onBackgroundMessageHandler.next(i),o.label=8;case 8:return[2]}}))}))}(e,t))})),self.addEventListener("pushsubscriptionchange",(function(e){e.waitUntil(function(e,t){var n,r;return s.__awaiter(this,void 0,void 0,(function(){var i;return s.__generator(this,(function(o){switch(o.label){case 0:return e.newSubscription?[3,2]:[4,N(t)];case 1:case 5:return o.sent(),[2];case 2:return[4,T(t.firebaseDependencies)];case 3:return i=o.sent(),[4,N(t)];case 4:return o.sent(),t.vapidKey=null!==(r=null===(n=null==i?void 0:i.subscriptionOptions)||void 0===n?void 0:n.vapidKey)&&void 0!==r?r:u,[4,D(t)]}}))}))}(e,t))})),self.addEventListener("notificationclick",(function(e){e.waitUntil(q(e))})),t};function X(){return s.__awaiter(this,void 0,void 0,(function(){var e;return s.__generator(this,(function(t){switch(t.label){case 0:return(e=c.isIndexedDBAvailable())?[4,c.validateIndexedDBOpenable()]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return[2,e&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")]}}))}))}l._registerComponent(new o.Component("messaging-sw",Q,"PUBLIC")),t.experimentalSetDeliveryMetricsExportedToBigQueryEnabled=function(e,t){return function(e,t){e.deliveryMetricsExportedToBigQueryEnabled=t}(e=c.getModularInstance(e),t)},t.getMessaging=function(e){return void 0===e&&(e=l.getApp()),X().then((function(e){if(!e)throw I.create("unsupported-browser")}),(function(e){throw I.create("indexed-db-unsupported")})),l._getProvider(c.getModularInstance(e),"messaging-sw").getImmediate()},t.isSupported=X,t.onBackgroundMessage=function(e,t){return function(e,t){if(void 0!==self.document)throw I.create("only-available-in-sw");return e.onBackgroundMessageHandler=t,function(){e.onBackgroundMessageHandler=null}}(e=c.getModularInstance(e),t)}},function(e,t,n){var r=n(214),i=n(213),o=n(193),s=n(1277),a=n(1278),c=n(168),l=n(1279),u=n(140),d=n(41);e.exports=function(e,t,n){t=t.length?r(t,(function(e){return d(e)?function(t){return i(t,1===e.length?e[0]:e)}:e})):[u];var h=-1;t=r(t,c(o));var f=s(e,(function(e,n,i){return{criteria:r(t,(function(t){return t(e)})),index:++h,value:e}}));return a(f,(function(e,t){return l(e,t,n)}))}},function(e,t,n){e.exports=function(){var e=[],t=[],n={},r={},i={};function o(e){return"string"==typeof e?new RegExp("^"+e+"$","i"):e}function s(e,t){return e===t?t:e===e.toLowerCase()?t.toLowerCase():e===e.toUpperCase()?t.toUpperCase():e[0]===e[0].toUpperCase()?t.charAt(0).toUpperCase()+t.substr(1).toLowerCase():t.toLowerCase()}function a(e,t){return e.replace(/\$(\d{1,2})/g,(function(e,n){return t[n]||""}))}function c(e,t){return e.replace(t[0],(function(n,r){var i=a(t[1],arguments);return s(""===n?e[r-1]:n,i)}))}function l(e,t,r){if(!e.length||n.hasOwnProperty(e))return t;for(var i=r.length;i--;){var o=r[i];if(o[0].test(t))return c(t,o)}return t}function u(e,t,n){return function(r){var i=r.toLowerCase();return t.hasOwnProperty(i)?s(r,i):e.hasOwnProperty(i)?s(r,e[i]):l(i,r,n)}}function d(e,t,n,r){return function(r){var i=r.toLowerCase();return!!t.hasOwnProperty(i)||!e.hasOwnProperty(i)&&l(i,i,n)===i}}function h(e,t,n){return(n?t+" ":"")+(1===t?h.singular(e):h.plural(e))}return h.plural=u(i,r,e),h.isPlural=d(i,r,e),h.singular=u(r,i,t),h.isSingular=d(r,i,t),h.addPluralRule=function(t,n){e.push([o(t),n])},h.addSingularRule=function(e,n){t.push([o(e),n])},h.addUncountableRule=function(e){"string"!=typeof e?(h.addPluralRule(e,"$0"),h.addSingularRule(e,"$0")):n[e.toLowerCase()]=!0},h.addIrregularRule=function(e,t){t=t.toLowerCase(),e=e.toLowerCase(),i[e]=t,r[t]=e},[["I","we"],["me","us"],["he","they"],["she","they"],["them","them"],["myself","ourselves"],["yourself","yourselves"],["itself","themselves"],["herself","themselves"],["himself","themselves"],["themself","themselves"],["is","are"],["was","were"],["has","have"],["this","these"],["that","those"],["echo","echoes"],["dingo","dingoes"],["volcano","volcanoes"],["tornado","tornadoes"],["torpedo","torpedoes"],["genus","genera"],["viscus","viscera"],["stigma","stigmata"],["stoma","stomata"],["dogma","dogmata"],["lemma","lemmata"],["schema","schemata"],["anathema","anathemata"],["ox","oxen"],["axe","axes"],["die","dice"],["yes","yeses"],["foot","feet"],["eave","eaves"],["goose","geese"],["tooth","teeth"],["quiz","quizzes"],["human","humans"],["proof","proofs"],["carve","carves"],["valve","valves"],["looey","looies"],["thief","thieves"],["groove","grooves"],["pickaxe","pickaxes"],["passerby","passersby"]].forEach((function(e){return h.addIrregularRule(e[0],e[1])})),[[/s?$/i,"s"],[/[^\u0000-\u007F]$/i,"$0"],[/([^aeiou]ese)$/i,"$1"],[/(ax|test)is$/i,"$1es"],[/(alias|[^aou]us|t[lm]as|gas|ris)$/i,"$1es"],[/(e[mn]u)s?$/i,"$1s"],[/([^l]ias|[aeiou]las|[ejzr]as|[iu]am)$/i,"$1"],[/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1i"],[/(alumn|alg|vertebr)(?:a|ae)$/i,"$1ae"],[/(seraph|cherub)(?:im)?$/i,"$1im"],[/(her|at|gr)o$/i,"$1oes"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)(?:a|um)$/i,"$1a"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)(?:a|on)$/i,"$1a"],[/sis$/i,"ses"],[/(?:(kni|wi|li)fe|(ar|l|ea|eo|oa|hoo)f)$/i,"$1$2ves"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/([^ch][ieo][ln])ey$/i,"$1ies"],[/(x|ch|ss|sh|zz)$/i,"$1es"],[/(matr|cod|mur|sil|vert|ind|append)(?:ix|ex)$/i,"$1ices"],[/\b((?:tit)?m|l)(?:ice|ouse)$/i,"$1ice"],[/(pe)(?:rson|ople)$/i,"$1ople"],[/(child)(?:ren)?$/i,"$1ren"],[/eaux$/i,"$0"],[/m[ae]n$/i,"men"],["thou","you"]].forEach((function(e){return h.addPluralRule(e[0],e[1])})),[[/s$/i,""],[/(ss)$/i,"$1"],[/(wi|kni|(?:after|half|high|low|mid|non|night|[^\w]|^)li)ves$/i,"$1fe"],[/(ar|(?:wo|[ae])l|[eo][ao])ves$/i,"$1f"],[/ies$/i,"y"],[/\b([pl]|zomb|(?:neck|cross)?t|coll|faer|food|gen|goon|group|lass|talk|goal|cut)ies$/i,"$1ie"],[/\b(mon|smil)ies$/i,"$1ey"],[/\b((?:tit)?m|l)ice$/i,"$1ouse"],[/(seraph|cherub)im$/i,"$1"],[/(x|ch|ss|sh|zz|tto|go|cho|alias|[^aou]us|t[lm]as|gas|(?:her|at|gr)o|[aeiou]ris)(?:es)?$/i,"$1"],[/(analy|diagno|parenthe|progno|synop|the|empha|cri|ne)(?:sis|ses)$/i,"$1sis"],[/(movie|twelve|abuse|e[mn]u)s$/i,"$1"],[/(test)(?:is|es)$/i,"$1is"],[/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1us"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|quor)a$/i,"$1um"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)a$/i,"$1on"],[/(alumn|alg|vertebr)ae$/i,"$1a"],[/(cod|mur|sil|vert|ind)ices$/i,"$1ex"],[/(matr|append)ices$/i,"$1ix"],[/(pe)(rson|ople)$/i,"$1rson"],[/(child)ren$/i,"$1"],[/(eau)x?$/i,"$1"],[/men$/i,"man"]].forEach((function(e){return h.addSingularRule(e[0],e[1])})),["adulthood","advice","agenda","aid","aircraft","alcohol","ammo","analytics","anime","athletics","audio","bison","blood","bream","buffalo","butter","carp","cash","chassis","chess","clothing","cod","commerce","cooperation","corps","debris","diabetes","digestion","elk","energy","equipment","excretion","expertise","firmware","flounder","fun","gallows","garbage","graffiti","hardware","headquarters","health","herpes","highjinks","homework","housework","information","jeans","justice","kudos","labour","literature","machinery","mackerel","mail","media","mews","moose","music","mud","manga","news","only","personnel","pike","plankton","pliers","police","pollution","premises","rain","research","rice","salmon","scissors","series","sewage","shambles","shrimp","software","species","staff","swine","tennis","traffic","transportation","trout","tuna","wealth","welfare","whiting","wildebeest","wildlife","you",/pok[e\xe9]mon$/i,/[^aeiou]ese$/i,/deer$/i,/fish$/i,/measles$/i,/o[iu]s$/i,/pox$/i,/sheep$/i].forEach(h.addUncountableRule),h}()},function(e,t,n){var r=n(232)("isPlainObject",n(212),n(787));r.placeholder=n(164),e.exports=r},function(e,t){var n=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return n.test(e)}},function(e,t,n){var r=n(1296),i=n(1297),o=n(1299),s=RegExp("['\u2019]","g");e.exports=function(e){return function(t){return r(o(i(t).replace(s,"")),e,"")}}},function(e,t){e.exports=function(e){return function(t){return null==e?void 0:e[t]}}},function(e,t,n){"use strict";e.exports=function(e,t){return e.hasOwnProperty(t)}},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,i=e.indexOf("["),o=e.indexOf("]");-1!=i&&-1!=o&&(e=e.substring(0,i)+e.substring(i,o).replace(/:/g,";")+e.substring(o,e.length));for(var s=n.exec(e||""),a={},c=14;c--;)a[r[c]]=s[c]||"";return-1!=i&&-1!=o&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){(function(t){e.exports=function(e){return n&&t.isBuffer(e)||r&&(e instanceof ArrayBuffer||i(e))};var n="function"==typeof t&&"function"==typeof t.isBuffer,r="function"==typeof ArrayBuffer,i=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}}).call(this,n(287).Buffer)},function(e,t,n){var r=n(1328),i=n(1185),o=n(900),s=n(1087),a=n(1186),c=n(1187),l=n(730)("socket.io-client:manager"),u=n(1184),d=n(1343),h=Object.prototype.hasOwnProperty;function f(e,t){if(!(this instanceof f))return new f(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new d({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||s;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}e.exports=f,f.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)h.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},f.prototype.updateSocketIds=function(){for(var e in this.nsps)h.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},f.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},o(f.prototype),f.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},f.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},f.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},f.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},f.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},f.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},f.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},f.prototype.open=f.prototype.connect=function(e,t){if(l("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;l("opening %s",this.uri),this.engine=r(this.uri,this.opts);var n=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var o=a(n,"open",(function(){i.onopen(),e&&e()})),s=a(n,"error",(function(t){if(l("connect_error"),i.cleanup(),i.readyState="closed",i.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else i.maybeReconnectOnOpen()}));if(!1!==this._timeout){var c=this._timeout;l("connect attempt will timeout after %d",c);var u=setTimeout((function(){l("connect attempt timed out after %d",c),o.destroy(),n.close(),n.emit("error","timeout"),i.emitAll("connect_timeout",c)}),c);this.subs.push({destroy:function(){clearTimeout(u)}})}return this.subs.push(o),this.subs.push(s),this},f.prototype.onopen=function(){l("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(a(e,"data",c(this,"ondata"))),this.subs.push(a(e,"ping",c(this,"onping"))),this.subs.push(a(e,"pong",c(this,"onpong"))),this.subs.push(a(e,"error",c(this,"onerror"))),this.subs.push(a(e,"close",c(this,"onclose"))),this.subs.push(a(this.decoder,"decoded",c(this,"ondecoded")))},f.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},f.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},f.prototype.ondata=function(e){this.decoder.add(e)},f.prototype.ondecoded=function(e){this.emit("packet",e)},f.prototype.onerror=function(e){l("error",e),this.emitAll("error",e)},f.prototype.socket=function(e,t){var n=this.nsps[e];if(!n){n=new i(this,e,t),this.nsps[e]=n;var r=this;n.on("connecting",o),n.on("connect",(function(){n.id=r.generateId(e)})),this.autoConnect&&o()}function o(){~u(r.connecting,n)||r.connecting.push(n)}return n},f.prototype.destroy=function(e){var t=u(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},f.prototype.packet=function(e){l("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()})))},f.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},f.prototype.cleanup=function(){l("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},f.prototype.close=f.prototype.disconnect=function(){l("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},f.prototype.onclose=function(e){l("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},f.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)l("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();l("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout((function(){e.skipReconnect||(l("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(l("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(l("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(n)}})}},f.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){var r=n(1088),i=n(1331),o=n(1339),s=n(1340);t.polling=function(e){var t=!1,n=!1,s=!1!==e.jsonp;if("undefined"!=typeof location){var a="https:"===location.protocol,c=location.port;c||(c=a?443:80),t=e.hostname!==location.hostname||c!==e.port,n=e.secure!==a}if(e.xdomain=t,e.xscheme=n,"open"in new r(e)&&!e.forceJSONP)return new i(e);if(!s)throw new Error("JSONP disabled");return new o(e)},t.websocket=s},function(e,t,n){var r=n(1089),i=n(1060),o=n(883),s=n(1061),a=n(1183),c=n(730)("engine.io-client:polling");e.exports=u;var l=null!=new(n(1088))({xdomain:!1}).responseType;function u(e){var t=e&&e.forceBase64;l&&!t||(this.supportsBinary=!1),r.call(this,e)}s(u,r),u.prototype.name="polling",u.prototype.doOpen=function(){this.poll()},u.prototype.pause=function(e){var t=this;function n(){c("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(c("we are currently polling - waiting to pause"),r++,this.once("pollComplete",(function(){c("pre-pause polling complete"),--r||n()}))),this.writable||(c("we are currently writing - waiting to pause"),r++,this.once("drain",(function(){c("pre-pause writing complete"),--r||n()})))}else n()},u.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},u.prototype.onData=function(e){var t=this;c("polling got data %s",e);o.decodePayload(e,this.socket.binaryType,(function(e,n,r){if("opening"===t.readyState&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},u.prototype.doClose=function(){var e=this;function t(){c("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(c("transport open - closing"),t()):(c("transport not open - deferring close"),this.once("open",t))},u.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};o.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,n)}))},u.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=a()),this.supportsBinary||e.sid||(e.b64=1),e=i.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(e,t,n){(function(t){var r=n(1333),i=Object.prototype.toString,o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===i.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===i.call(File);e.exports=function e(n){if(!n||"object"!=typeof n)return!1;if(r(n)){for(var i=0,a=n.length;i<a;i++)if(e(n[i]))return!0;return!1}if("function"==typeof t&&t.isBuffer&&t.isBuffer(n)||"function"==typeof ArrayBuffer&&n instanceof ArrayBuffer||o&&n instanceof Blob||s&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return e(n.toJSON(),!0);for(var c in n)if(Object.prototype.hasOwnProperty.call(n,c)&&e(n[c]))return!0;return!1}}).call(this,n(287).Buffer)},function(e,t,n){"use strict";var r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o={},s=0,a=0;function c(e){var t="";do{t=i[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function l(){var e=c(+new Date);return e!==r?(s=0,r=e):e+"."+c(s++)}for(;a<64;a++)o[i[a]]=a;l.encode=c,l.decode=function(e){var t=0;for(a=0;a<e.length;a++)t=64*t+o[e.charAt(a)];return t},e.exports=l},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},function(e,t,n){var r=n(1087),i=n(900),o=n(1342),s=n(1186),a=n(1187),c=n(730)("socket.io-client:socket"),l=n(1060),u=n(1182);e.exports=f;var d={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},h=i.prototype.emit;function f(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}i(f.prototype),f.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[s(e,"open",a(this,"onopen")),s(e,"packet",a(this,"onpacket")),s(e,"close",a(this,"onclose"))]}},f.prototype.open=f.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},f.prototype.send=function(){var e=o(arguments);return e.unshift("message"),this.emit.apply(this,e),this},f.prototype.emit=function(e){if(d.hasOwnProperty(e))return h.apply(this,arguments),this;var t=o(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:u(t))?r.BINARY_EVENT:r.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},f.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},f.prototype.onopen=function(){if(c("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?l.encode(this.query):this.query;c("sending connect packet with query %s",e),this.packet({type:r.CONNECT,query:e})}else this.packet({type:r.CONNECT})},f.prototype.onclose=function(e){c("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},f.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===r.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},f.prototype.onevent=function(e){var t=e.data||[];c("emitting event %j",t),null!=e.id&&(c("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?h.apply(this,t):this.receiveBuffer.push(t)},f.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var i=o(arguments);c("sending ack %j",i),t.packet({type:u(i)?r.BINARY_ACK:r.ACK,id:e,data:i})}}},f.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(c("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):c("bad ack %s",e.id)},f.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},f.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)h.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},f.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},f.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},f.prototype.close=f.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},f.prototype.compress=function(e){return this.flags.compress=e,this},f.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t){e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.flatten=void 0;t.default={xml:!1,decodeEntities:!0};var i={_useHtmlParser2:!0,xmlMode:!0};t.flatten=function(e){return(null==e?void 0:e.xml)?"boolean"==typeof e.xml?i:r(r({},i),e.xml):null!=e?e:void 0}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.aliases=t.pseudos=t.filters=t.is=t.selectOne=t.selectAll=t.prepareContext=t._compileToken=t._compileUnsafe=t.compile=void 0;var a=o(n(319)),c=s(n(799)),l=n(1350),u=n(1090),d=function(e,t){return e===t},h={adapter:a,equals:d};function f(e){var t,n,r,i,o=null!=e?e:h;return null!==(t=o.adapter)&&void 0!==t||(o.adapter=a),null!==(n=o.equals)&&void 0!==n||(o.equals=null!==(i=null===(r=o.adapter)||void 0===r?void 0:r.equals)&&void 0!==i?i:d),o}function p(e){return function(t,n,r){var i=f(n);return e(t,i,r)}}function g(e){return function(t,n,r){var i=f(r);"function"!=typeof t&&(t=(0,l.compileUnsafe)(t,i,n));var o=m(n,i.adapter,t.shouldTestNextSiblings);return e(t,o,i)}}function m(e,t,n){return void 0===n&&(n=!1),n&&(e=function(e,t){for(var n=Array.isArray(e)?e.slice(0):[e],r=n.length,i=0;i<r;i++){var o=(0,u.getNextSiblings)(n[i],t);n.push.apply(n,o)}return n}(e,t)),Array.isArray(e)?t.removeSubsets(e):t.getChildren(e)}t.compile=p(l.compile),t._compileUnsafe=p(l.compileUnsafe),t._compileToken=p(l.compileToken),t.prepareContext=m,t.selectAll=g((function(e,t,n){return e!==c.default.falseFunc&&t&&0!==t.length?n.adapter.findAll(e,t):[]})),t.selectOne=g((function(e,t,n){return e!==c.default.falseFunc&&t&&0!==t.length?n.adapter.findOne(e,t):null})),t.is=function(e,t,n){var r=f(n);return("function"==typeof t?t:(0,l.compile)(t,r))(e)},t.default=t.selectAll;var y=n(1191);Object.defineProperty(t,"filters",{enumerable:!0,get:function(){return y.filters}}),Object.defineProperty(t,"pseudos",{enumerable:!0,get:function(){return y.pseudos}}),Object.defineProperty(t,"aliases",{enumerable:!0,get:function(){return y.aliases}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTraversal=void 0;var r=n(605),i=new Map([[r.SelectorType.Universal,50],[r.SelectorType.Tag,30],[r.SelectorType.Attribute,1],[r.SelectorType.Pseudo,0]]);t.isTraversal=function(e){return!i.has(e.type)};var o=new Map([[r.AttributeAction.Exists,10],[r.AttributeAction.Equals,8],[r.AttributeAction.Not,7],[r.AttributeAction.Start,6],[r.AttributeAction.End,6],[r.AttributeAction.Any,5]]);function s(e){var t,n,a=null!==(t=i.get(e.type))&&void 0!==t?t:-1;return e.type===r.SelectorType.Attribute?(a=null!==(n=o.get(e.action))&&void 0!==n?n:4,e.action===r.AttributeAction.Equals&&"id"===e.name&&(a=9),e.ignoreCase&&(a>>=1)):e.type===r.SelectorType.Pseudo&&(e.data?"has"===e.name||"contains"===e.name?a=0:Array.isArray(e.data)?(a=Math.min.apply(Math,e.data.map((function(e){return Math.min.apply(Math,e.map(s))}))))<0&&(a=0):a=2:a=3),a}t.default=function(e){for(var t=e.map(s),n=1;n<e.length;n++){var r=t[n];if(!(r<0))for(var i=n-1;i>=0&&r<t[i];i--){var o=e[i+1];e[i+1]=e[i],e[i]=o,t[i+1]=t[i],t[i]=r}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compilePseudoSelector=t.aliases=t.pseudos=t.filters=void 0;var r=n(605),i=n(1353);Object.defineProperty(t,"filters",{enumerable:!0,get:function(){return i.filters}});var o=n(1357);Object.defineProperty(t,"pseudos",{enumerable:!0,get:function(){return o.pseudos}});var s=n(1358);Object.defineProperty(t,"aliases",{enumerable:!0,get:function(){return s.aliases}});var a=n(1090);t.compilePseudoSelector=function(e,t,n,c,l){var u,d=t.name,h=t.data;if(Array.isArray(h)){if(!(d in a.subselects))throw new Error("Unknown pseudo-class :".concat(d,"(").concat(h,")"));return a.subselects[d](e,h,n,c,l)}var f=null===(u=n.pseudos)||void 0===u?void 0:u[d],p="string"==typeof f?f:s.aliases[d];if("string"==typeof p){if(null!=h)throw new Error("Pseudo ".concat(d," doesn't have any arguments"));var g=(0,r.parse)(p);return a.subselects.is(e,g,n,c,l)}if("function"==typeof f)return(0,o.verifyPseudoArgs)(f,d,h,1),function(t){return f(t,h)&&e(t)};if(d in i.filters)return i.filters[d](e,h,n,c);if(d in o.pseudos){var m=o.pseudos[d];return(0,o.verifyPseudoArgs)(m,d,h,2),function(t){return m(t,n,h)&&e(t)}}throw new Error("Unknown pseudo-class :".concat(d))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLimit=t.isFilter=t.filterNames=void 0,t.filterNames=new Set(["first","last","eq","gt","nth","lt","even","odd"]),t.isFilter=function e(n){return"pseudo"===n.type&&(!!t.filterNames.has(n.name)||!("not"!==n.name||!Array.isArray(n.data))&&n.data.some((function(t){return t.some(e)})))},t.getLimit=function(e,t,n){var r=null!=t?parseInt(t,10):NaN;switch(e){case"first":return 1;case"nth":case"eq":return isFinite(r)?r>=0?r+1:1/0:0;case"lt":return isFinite(r)?r>=0?Math.min(r,n):1/0:0;case"gt":return isFinite(r)?1/0:0;case"odd":return 2*n;case"even":return 2*n-1;case"last":case"not":return 1/0}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.update=t.getParse=void 0;var r=n(319),i=n(155);function o(e,t){var n=Array.isArray(e)?e:[e];t?t.children=n:t=null;for(var i=0;i<n.length;i++){var o=n[i];o.parent&&o.parent.children!==n&&(0,r.removeElement)(o),t?(o.prev=n[i-1]||null,o.next=n[i+1]||null):o.prev=o.next=null,o.parent=t}return t}t.getParse=function(t){return function(n,r,s,a){if(void 0!==e&&e.isBuffer(n)&&(n=n.toString()),"string"==typeof n)return t(n,r,s,a);var c=n;if(!Array.isArray(c)&&(0,i.isDocument)(c))return c;var l=new i.Document([]);return o(c,l),l}},t.update=o}).call(this,n(287).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFragment=t.parse=t.TokenizerMode=t.Tokenizer=t.Token=t.html=t.foreignContent=t.ErrorCodes=t.serializeOuter=t.serialize=t.Parser=t.defaultTreeAdapter=void 0;const r=n(1195);var i=n(1093);Object.defineProperty(t,"defaultTreeAdapter",{enumerable:!0,get:function(){return i.defaultTreeAdapter}});var o=n(1195);Object.defineProperty(t,"Parser",{enumerable:!0,get:function(){return o.Parser}});var s=n(1368);Object.defineProperty(t,"serialize",{enumerable:!0,get:function(){return s.serialize}}),Object.defineProperty(t,"serializeOuter",{enumerable:!0,get:function(){return s.serializeOuter}});var a=n(1062);Object.defineProperty(t,"ErrorCodes",{enumerable:!0,get:function(){return a.ERR}}),t.foreignContent=n(1197),t.html=n(732),t.Token=n(1092);var c=n(1196);Object.defineProperty(t,"Tokenizer",{enumerable:!0,get:function(){return c.Tokenizer}}),Object.defineProperty(t,"TokenizerMode",{enumerable:!0,get:function(){return c.TokenizerMode}}),t.parse=function(e,t){return r.Parser.parse(e,t)},t.parseFragment=function(e,t,n){"string"==typeof e&&(n=t,t=e,e=null);const i=r.Parser.getFragmentParser(e,n);return i.tokenizer.write(t,!0),i.getFragment()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=void 0;const r=n(1196),i=n(1365),o=n(1366),s=n(1093),a=n(1367),c=n(1197),l=n(1062),u=n(1091),d=n(732),h=n(1092);var f;!function(e){e[e.INITIAL=0]="INITIAL",e[e.BEFORE_HTML=1]="BEFORE_HTML",e[e.BEFORE_HEAD=2]="BEFORE_HEAD",e[e.IN_HEAD=3]="IN_HEAD",e[e.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",e[e.AFTER_HEAD=5]="AFTER_HEAD",e[e.IN_BODY=6]="IN_BODY",e[e.TEXT=7]="TEXT",e[e.IN_TABLE=8]="IN_TABLE",e[e.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",e[e.IN_CAPTION=10]="IN_CAPTION",e[e.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",e[e.IN_TABLE_BODY=12]="IN_TABLE_BODY",e[e.IN_ROW=13]="IN_ROW",e[e.IN_CELL=14]="IN_CELL",e[e.IN_SELECT=15]="IN_SELECT",e[e.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",e[e.IN_TEMPLATE=17]="IN_TEMPLATE",e[e.AFTER_BODY=18]="AFTER_BODY",e[e.IN_FRAMESET=19]="IN_FRAMESET",e[e.AFTER_FRAMESET=20]="AFTER_FRAMESET",e[e.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",e[e.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"}(f||(f={}));const p={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},g=new Set([d.TAG_ID.TABLE,d.TAG_ID.TBODY,d.TAG_ID.TFOOT,d.TAG_ID.THEAD,d.TAG_ID.TR]),m={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:s.defaultTreeAdapter,onParseError:null};function y(e,t){let n=e.activeFormattingElements.getElementEntryInScopeWithTagName(t.tagName);return n?e.openElements.contains(n.element)?e.openElements.hasInScope(t.tagID)||(n=null):(e.activeFormattingElements.removeEntry(n),n=null):q(e,t),n}function v(e,t){let n=null,r=e.openElements.stackTop;for(;r>=0;r--){const i=e.openElements.items[r];if(i===t.element)break;e._isSpecialElement(i,e.openElements.tagIDs[r])&&(n=i)}return n||(e.openElements.shortenToLength(r<0?0:r),e.activeFormattingElements.removeEntry(t)),n}function b(e,t,n){let r=t,i=e.openElements.getCommonAncestor(t);for(let o=0,s=i;s!==n;o++,s=i){i=e.openElements.getCommonAncestor(s);const n=e.activeFormattingElements.getElementEntry(s),a=n&&o>=3;!n||a?(a&&e.activeFormattingElements.removeEntry(n),e.openElements.remove(s)):(s=_(e,n),r===t&&(e.activeFormattingElements.bookmark=n),e.treeAdapter.detachNode(r),e.treeAdapter.appendChild(s,r),r=s)}return r}function _(e,t){const n=e.treeAdapter.getNamespaceURI(t.element),r=e.treeAdapter.createElement(t.token.tagName,n,t.token.attrs);return e.openElements.replace(t.element,r),t.element=r,r}function w(e,t,n){const r=e.treeAdapter.getTagName(t),i=(0,d.getTagID)(r);if(e._isElementCausesFosterParenting(i))e._fosterParentElement(n);else{const r=e.treeAdapter.getNamespaceURI(t);i===d.TAG_ID.TEMPLATE&&r===d.NS.HTML&&(t=e.treeAdapter.getTemplateContent(t)),e.treeAdapter.appendChild(t,n)}}function T(e,t,n){const r=e.treeAdapter.getNamespaceURI(n.element),{token:i}=n,o=e.treeAdapter.createElement(i.tagName,r,i.attrs);e._adoptNodes(t,o),e.treeAdapter.appendChild(t,o),e.activeFormattingElements.insertElementAfterBookmark(o,i),e.activeFormattingElements.removeEntry(n),e.openElements.remove(n.element),e.openElements.insertAfter(t,o,i.tagID)}function E(e,t){for(let n=0;n<8;n++){const n=y(e,t);if(!n)break;const r=v(e,n);if(!r)break;e.activeFormattingElements.bookmark=n;const i=b(e,r,n.element),o=e.openElements.getCommonAncestor(n.element);e.treeAdapter.detachNode(i),o&&w(e,o,i),T(e,r,n)}}function A(e,t){e._appendCommentNode(t,e.openElements.currentTmplContentOrNode)}function S(e,t){if(e.stopped=!0,t.location){const n=e.fragmentContext?0:2;for(let r=e.openElements.stackTop;r>=n;r--)e._setEndLocation(e.openElements.items[r],t);if(!e.fragmentContext&&e.openElements.stackTop>=0){const n=e.openElements.items[0],r=e.treeAdapter.getNodeSourceCodeLocation(n);if(r&&!r.endTag&&(e._setEndLocation(n,t),e.openElements.stackTop>=1)){const n=e.openElements.items[1],r=e.treeAdapter.getNodeSourceCodeLocation(n);r&&!r.endTag&&e._setEndLocation(n,t)}}}}function O(e,t){e._err(t,l.ERR.missingDoctype,!0),e.treeAdapter.setDocumentMode(e.document,d.DOCUMENT_MODE.QUIRKS),e.insertionMode=f.BEFORE_HTML,e._processToken(t)}function I(e,t){e._insertFakeRootElement(),e.insertionMode=f.BEFORE_HEAD,e._processToken(t)}function C(e,t){e._insertFakeElement(d.TAG_NAMES.HEAD,d.TAG_ID.HEAD),e.headElement=e.openElements.current,e.insertionMode=f.IN_HEAD,e._processToken(t)}function k(e,t){switch(t.tagID){case d.TAG_ID.HTML:G(e,t);break;case d.TAG_ID.BASE:case d.TAG_ID.BASEFONT:case d.TAG_ID.BGSOUND:case d.TAG_ID.LINK:case d.TAG_ID.META:e._appendElement(t,d.NS.HTML),t.ackSelfClosing=!0;break;case d.TAG_ID.TITLE:e._switchToTextParsing(t,r.TokenizerMode.RCDATA);break;case d.TAG_ID.NOSCRIPT:e.options.scriptingEnabled?e._switchToTextParsing(t,r.TokenizerMode.RAWTEXT):(e._insertElement(t,d.NS.HTML),e.insertionMode=f.IN_HEAD_NO_SCRIPT);break;case d.TAG_ID.NOFRAMES:case d.TAG_ID.STYLE:e._switchToTextParsing(t,r.TokenizerMode.RAWTEXT);break;case d.TAG_ID.SCRIPT:e._switchToTextParsing(t,r.TokenizerMode.SCRIPT_DATA);break;case d.TAG_ID.TEMPLATE:e._insertTemplate(t),e.activeFormattingElements.insertMarker(),e.framesetOk=!1,e.insertionMode=f.IN_TEMPLATE,e.tmplInsertionModeStack.unshift(f.IN_TEMPLATE);break;case d.TAG_ID.HEAD:e._err(t,l.ERR.misplacedStartTagForHeadElement);break;default:x(e,t)}}function P(e,t){e.openElements.tmplCount>0?(e.openElements.generateImpliedEndTagsThoroughly(),e.openElements.currentTagId!==d.TAG_ID.TEMPLATE&&e._err(t,l.ERR.closingOfElementWithOpenChildElements),e.openElements.popUntilTagNamePopped(d.TAG_ID.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode()):e._err(t,l.ERR.endTagWithoutMatchingOpenElement)}function x(e,t){e.openElements.pop(),e.insertionMode=f.AFTER_HEAD,e._processToken(t)}function R(e,t){const n=t.type===h.TokenType.EOF?l.ERR.openElementsLeftAfterEof:l.ERR.disallowedContentInNoscriptInHead;e._err(t,n),e.openElements.pop(),e.insertionMode=f.IN_HEAD,e._processToken(t)}function L(e,t){e._insertFakeElement(d.TAG_NAMES.BODY,d.TAG_ID.BODY),e.insertionMode=f.IN_BODY,D(e,t)}function D(e,t){switch(t.type){case h.TokenType.CHARACTER:j(e,t);break;case h.TokenType.WHITESPACE_CHARACTER:N(e,t);break;case h.TokenType.COMMENT:A(e,t);break;case h.TokenType.START_TAG:G(e,t);break;case h.TokenType.END_TAG:H(e,t);break;case h.TokenType.EOF:$(e,t)}}function N(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t)}function j(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t),e.framesetOk=!1}function M(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,d.NS.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function F(e){const t=(0,h.getTokenAttr)(e,d.ATTRS.TYPE);return null!=t&&"hidden"===t.toLowerCase()}function U(e,t){e._switchToTextParsing(t,r.TokenizerMode.RAWTEXT)}function B(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,d.NS.HTML)}function G(e,t){switch(t.tagID){case d.TAG_ID.I:case d.TAG_ID.S:case d.TAG_ID.B:case d.TAG_ID.U:case d.TAG_ID.EM:case d.TAG_ID.TT:case d.TAG_ID.BIG:case d.TAG_ID.CODE:case d.TAG_ID.FONT:case d.TAG_ID.SMALL:case d.TAG_ID.STRIKE:case d.TAG_ID.STRONG:!function(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,d.NS.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}(e,t);break;case d.TAG_ID.A:!function(e,t){const n=e.activeFormattingElements.getElementEntryInScopeWithTagName(d.TAG_NAMES.A);n&&(E(e,t),e.openElements.remove(n.element),e.activeFormattingElements.removeEntry(n)),e._reconstructActiveFormattingElements(),e._insertElement(t,d.NS.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}(e,t);break;case d.TAG_ID.H1:case d.TAG_ID.H2:case d.TAG_ID.H3:case d.TAG_ID.H4:case d.TAG_ID.H5:case d.TAG_ID.H6:!function(e,t){e.openElements.hasInButtonScope(d.TAG_ID.P)&&e._closePElement(),(0,d.isNumberedHeader)(e.openElements.currentTagId)&&e.openElements.pop(),e._insertElement(t,d.NS.HTML)}(e,t);break;case d.TAG_ID.P:case d.TAG_ID.DL:case d.TAG_ID.OL:case d.TAG_ID.UL:case d.TAG_ID.DIV:case d.TAG_ID.DIR:case d.TAG_ID.NAV:case d.TAG_ID.MAIN:case d.TAG_ID.MENU:case d.TAG_ID.ASIDE:case d.TAG_ID.CENTER:case d.TAG_ID.FIGURE:case d.TAG_ID.FOOTER:case d.TAG_ID.HEADER:case d.TAG_ID.HGROUP:case d.TAG_ID.DIALOG:case d.TAG_ID.DETAILS:case d.TAG_ID.ADDRESS:case d.TAG_ID.ARTICLE:case d.TAG_ID.SECTION:case d.TAG_ID.SUMMARY:case d.TAG_ID.FIELDSET:case d.TAG_ID.BLOCKQUOTE:case d.TAG_ID.FIGCAPTION:!function(e,t){e.openElements.hasInButtonScope(d.TAG_ID.P)&&e._closePElement(),e._insertElement(t,d.NS.HTML)}(e,t);break;case d.TAG_ID.LI:case d.TAG_ID.DD:case d.TAG_ID.DT:!function(e,t){e.framesetOk=!1;const n=t.tagID;for(let t=e.openElements.stackTop;t>=0;t--){const r=e.openElements.tagIDs[t];if(n===d.TAG_ID.LI&&r===d.TAG_ID.LI||(n===d.TAG_ID.DD||n===d.TAG_ID.DT)&&(r===d.TAG_ID.DD||r===d.TAG_ID.DT)){e.openElements.generateImpliedEndTagsWithExclusion(r),e.openElements.popUntilTagNamePopped(r);break}if(r!==d.TAG_ID.ADDRESS&&r!==d.TAG_ID.DIV&&r!==d.TAG_ID.P&&e._isSpecialElement(e.openElements.items[t],r))break}e.openElements.hasInButtonScope(d.TAG_ID.P)&&e._closePElement(),e._insertElement(t,d.NS.HTML)}(e,t);break;case d.TAG_ID.BR:case d.TAG_ID.IMG:case d.TAG_ID.WBR:case d.TAG_ID.AREA:case d.TAG_ID.EMBED:case d.TAG_ID.KEYGEN:M(e,t);break;case d.TAG_ID.HR:!function(e,t){e.openElements.hasInButtonScope(d.TAG_ID.P)&&e._closePElement(),e._appendElement(t,d.NS.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}(e,t);break;case d.TAG_ID.RB:case d.TAG_ID.RTC:!function(e,t){e.openElements.hasInScope(d.TAG_ID.RUBY)&&e.openElements.generateImpliedEndTags(),e._insertElement(t,d.NS.HTML)}(e,t);break;case d.TAG_ID.RT:case d.TAG_ID.RP:!function(e,t){e.openElements.hasInScope(d.TAG_ID.RUBY)&&e.openElements.generateImpliedEndTagsWithExclusion(d.TAG_ID.RTC),e._insertElement(t,d.NS.HTML)}(e,t);break;case d.TAG_ID.PRE:case d.TAG_ID.LISTING:!function(e,t){e.openElements.hasInButtonScope(d.TAG_ID.P)&&e._closePElement(),e._insertElement(t,d.NS.HTML),e.skipNextNewLine=!0,e.framesetOk=!1}(e,t);break;case d.TAG_ID.XMP:!function(e,t){e.openElements.hasInButtonScope(d.TAG_ID.P)&&e._closePElement(),e._reconstructActiveFormattingElements(),e.framesetOk=!1,e._switchToTextParsing(t,r.TokenizerMode.RAWTEXT)}(e,t);break;case d.TAG_ID.SVG:!function(e,t){e._reconstructActiveFormattingElements(),c.adjustTokenSVGAttrs(t),c.adjustTokenXMLAttrs(t),t.selfClosing?e._appendElement(t,d.NS.SVG):e._insertElement(t,d.NS.SVG),t.ackSelfClosing=!0}(e,t);break;case d.TAG_ID.HTML:!function(e,t){0===e.openElements.tmplCount&&e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs)}(e,t);break;case d.TAG_ID.BASE:case d.TAG_ID.LINK:case d.TAG_ID.META:case d.TAG_ID.STYLE:case d.TAG_ID.TITLE:case d.TAG_ID.SCRIPT:case d.TAG_ID.BGSOUND:case d.TAG_ID.BASEFONT:case d.TAG_ID.TEMPLATE:k(e,t);break;case d.TAG_ID.BODY:!function(e,t){const n=e.openElements.tryPeekProperlyNestedBodyElement();n&&0===e.openElements.tmplCount&&(e.framesetOk=!1,e.treeAdapter.adoptAttributes(n,t.attrs))}(e,t);break;case d.TAG_ID.FORM:!function(e,t){const n=e.openElements.tmplCount>0;e.formElement&&!n||(e.openElements.hasInButtonScope(d.TAG_ID.P)&&e._closePElement(),e._insertElement(t,d.NS.HTML),n||(e.formElement=e.openElements.current))}(e,t);break;case d.TAG_ID.NOBR:!function(e,t){e._reconstructActiveFormattingElements(),e.openElements.hasInScope(d.TAG_ID.NOBR)&&(E(e,t),e._reconstructActiveFormattingElements()),e._insertElement(t,d.NS.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}(e,t);break;case d.TAG_ID.MATH:!function(e,t){e._reconstructActiveFormattingElements(),c.adjustTokenMathMLAttrs(t),c.adjustTokenXMLAttrs(t),t.selfClosing?e._appendElement(t,d.NS.MATHML):e._insertElement(t,d.NS.MATHML),t.ackSelfClosing=!0}(e,t);break;case d.TAG_ID.TABLE:!function(e,t){e.treeAdapter.getDocumentMode(e.document)!==d.DOCUMENT_MODE.QUIRKS&&e.openElements.hasInButtonScope(d.TAG_ID.P)&&e._closePElement(),e._insertElement(t,d.NS.HTML),e.framesetOk=!1,e.insertionMode=f.IN_TABLE}(e,t);break;case d.TAG_ID.INPUT:!function(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,d.NS.HTML),F(t)||(e.framesetOk=!1),t.ackSelfClosing=!0}(e,t);break;case d.TAG_ID.PARAM:case d.TAG_ID.TRACK:case d.TAG_ID.SOURCE:!function(e,t){e._appendElement(t,d.NS.HTML),t.ackSelfClosing=!0}(e,t);break;case d.TAG_ID.IMAGE:!function(e,t){t.tagName=d.TAG_NAMES.IMG,t.tagID=d.TAG_ID.IMG,M(e,t)}(e,t);break;case d.TAG_ID.BUTTON:!function(e,t){e.openElements.hasInScope(d.TAG_ID.BUTTON)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(d.TAG_ID.BUTTON)),e._reconstructActiveFormattingElements(),e._insertElement(t,d.NS.HTML),e.framesetOk=!1}(e,t);break;case d.TAG_ID.APPLET:case d.TAG_ID.OBJECT:case d.TAG_ID.MARQUEE:!function(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,d.NS.HTML),e.activeFormattingElements.insertMarker(),e.framesetOk=!1}(e,t);break;case d.TAG_ID.IFRAME:!function(e,t){e.framesetOk=!1,e._switchToTextParsing(t,r.TokenizerMode.RAWTEXT)}(e,t);break;case d.TAG_ID.SELECT:!function(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,d.NS.HTML),e.framesetOk=!1,e.insertionMode=e.insertionMode===f.IN_TABLE||e.insertionMode===f.IN_CAPTION||e.insertionMode===f.IN_TABLE_BODY||e.insertionMode===f.IN_ROW||e.insertionMode===f.IN_CELL?f.IN_SELECT_IN_TABLE:f.IN_SELECT}(e,t);break;case d.TAG_ID.OPTION:case d.TAG_ID.OPTGROUP:!function(e,t){e.openElements.currentTagId===d.TAG_ID.OPTION&&e.openElements.pop(),e._reconstructActiveFormattingElements(),e._insertElement(t,d.NS.HTML)}(e,t);break;case d.TAG_ID.NOEMBED:U(e,t);break;case d.TAG_ID.FRAMESET:!function(e,t){const n=e.openElements.tryPeekProperlyNestedBodyElement();e.framesetOk&&n&&(e.treeAdapter.detachNode(n),e.openElements.popAllUpToHtmlElement(),e._insertElement(t,d.NS.HTML),e.insertionMode=f.IN_FRAMESET)}(e,t);break;case d.TAG_ID.TEXTAREA:!function(e,t){e._insertElement(t,d.NS.HTML),e.skipNextNewLine=!0,e.tokenizer.state=r.TokenizerMode.RCDATA,e.originalInsertionMode=e.insertionMode,e.framesetOk=!1,e.insertionMode=f.TEXT}(e,t);break;case d.TAG_ID.NOSCRIPT:e.options.scriptingEnabled?U(e,t):B(e,t);break;case d.TAG_ID.PLAINTEXT:!function(e,t){e.openElements.hasInButtonScope(d.TAG_ID.P)&&e._closePElement(),e._insertElement(t,d.NS.HTML),e.tokenizer.state=r.TokenizerMode.PLAINTEXT}(e,t);break;case d.TAG_ID.COL:case d.TAG_ID.TH:case d.TAG_ID.TD:case d.TAG_ID.TR:case d.TAG_ID.HEAD:case d.TAG_ID.FRAME:case d.TAG_ID.TBODY:case d.TAG_ID.TFOOT:case d.TAG_ID.THEAD:case d.TAG_ID.CAPTION:case d.TAG_ID.COLGROUP:break;default:B(e,t)}}function q(e,t){const n=t.tagName,r=t.tagID;for(let t=e.openElements.stackTop;t>0;t--){const i=e.openElements.items[t],o=e.openElements.tagIDs[t];if(r===o&&(r!==d.TAG_ID.UNKNOWN||e.treeAdapter.getTagName(i)===n)){e.openElements.generateImpliedEndTagsWithExclusion(r),e.openElements.stackTop>=t&&e.openElements.shortenToLength(t);break}if(e._isSpecialElement(i,o))break}}function H(e,t){switch(t.tagID){case d.TAG_ID.A:case d.TAG_ID.B:case d.TAG_ID.I:case d.TAG_ID.S:case d.TAG_ID.U:case d.TAG_ID.EM:case d.TAG_ID.TT:case d.TAG_ID.BIG:case d.TAG_ID.CODE:case d.TAG_ID.FONT:case d.TAG_ID.NOBR:case d.TAG_ID.SMALL:case d.TAG_ID.STRIKE:case d.TAG_ID.STRONG:E(e,t);break;case d.TAG_ID.P:!function(e){e.openElements.hasInButtonScope(d.TAG_ID.P)||e._insertFakeElement(d.TAG_NAMES.P,d.TAG_ID.P),e._closePElement()}(e);break;case d.TAG_ID.DL:case d.TAG_ID.UL:case d.TAG_ID.OL:case d.TAG_ID.DIR:case d.TAG_ID.DIV:case d.TAG_ID.NAV:case d.TAG_ID.PRE:case d.TAG_ID.MAIN:case d.TAG_ID.MENU:case d.TAG_ID.ASIDE:case d.TAG_ID.BUTTON:case d.TAG_ID.CENTER:case d.TAG_ID.FIGURE:case d.TAG_ID.FOOTER:case d.TAG_ID.HEADER:case d.TAG_ID.HGROUP:case d.TAG_ID.DIALOG:case d.TAG_ID.ADDRESS:case d.TAG_ID.ARTICLE:case d.TAG_ID.DETAILS:case d.TAG_ID.SECTION:case d.TAG_ID.SUMMARY:case d.TAG_ID.LISTING:case d.TAG_ID.FIELDSET:case d.TAG_ID.BLOCKQUOTE:case d.TAG_ID.FIGCAPTION:!function(e,t){const n=t.tagID;e.openElements.hasInScope(n)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(n))}(e,t);break;case d.TAG_ID.LI:!function(e){e.openElements.hasInListItemScope(d.TAG_ID.LI)&&(e.openElements.generateImpliedEndTagsWithExclusion(d.TAG_ID.LI),e.openElements.popUntilTagNamePopped(d.TAG_ID.LI))}(e);break;case d.TAG_ID.DD:case d.TAG_ID.DT:!function(e,t){const n=t.tagID;e.openElements.hasInScope(n)&&(e.openElements.generateImpliedEndTagsWithExclusion(n),e.openElements.popUntilTagNamePopped(n))}(e,t);break;case d.TAG_ID.H1:case d.TAG_ID.H2:case d.TAG_ID.H3:case d.TAG_ID.H4:case d.TAG_ID.H5:case d.TAG_ID.H6:!function(e){e.openElements.hasNumberedHeaderInScope()&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilNumberedHeaderPopped())}(e);break;case d.TAG_ID.BR:!function(e){e._reconstructActiveFormattingElements(),e._insertFakeElement(d.TAG_NAMES.BR,d.TAG_ID.BR),e.openElements.pop(),e.framesetOk=!1}(e);break;case d.TAG_ID.BODY:!function(e,t){if(e.openElements.hasInScope(d.TAG_ID.BODY)&&(e.insertionMode=f.AFTER_BODY,e.options.sourceCodeLocationInfo)){const n=e.openElements.tryPeekProperlyNestedBodyElement();n&&e._setEndLocation(n,t)}}(e,t);break;case d.TAG_ID.HTML:!function(e,t){e.openElements.hasInScope(d.TAG_ID.BODY)&&(e.insertionMode=f.AFTER_BODY,ce(e,t))}(e,t);break;case d.TAG_ID.FORM:!function(e){const t=e.openElements.tmplCount>0,{formElement:n}=e;t||(e.formElement=null),(n||t)&&e.openElements.hasInScope(d.TAG_ID.FORM)&&(e.openElements.generateImpliedEndTags(),t?e.openElements.popUntilTagNamePopped(d.TAG_ID.FORM):n&&e.openElements.remove(n))}(e);break;case d.TAG_ID.APPLET:case d.TAG_ID.OBJECT:case d.TAG_ID.MARQUEE:!function(e,t){const n=t.tagID;e.openElements.hasInScope(n)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(n),e.activeFormattingElements.clearToLastMarker())}(e,t);break;case d.TAG_ID.TEMPLATE:P(e,t);break;default:q(e,t)}}function $(e,t){e.tmplInsertionModeStack.length>0?ae(e,t):S(e,t)}function W(e,t){if(g.has(e.openElements.currentTagId))switch(e.pendingCharacterTokens.length=0,e.hasNonWhitespacePendingCharacterToken=!1,e.originalInsertionMode=e.insertionMode,e.insertionMode=f.IN_TABLE_TEXT,t.type){case h.TokenType.CHARACTER:Q(e,t);break;case h.TokenType.WHITESPACE_CHARACTER:Y(e,t)}else K(e,t)}function z(e,t){switch(t.tagID){case d.TAG_ID.TD:case d.TAG_ID.TH:case d.TAG_ID.TR:!function(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(d.TAG_NAMES.TBODY,d.TAG_ID.TBODY),e.insertionMode=f.IN_TABLE_BODY,te(e,t)}(e,t);break;case d.TAG_ID.STYLE:case d.TAG_ID.SCRIPT:case d.TAG_ID.TEMPLATE:k(e,t);break;case d.TAG_ID.COL:!function(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(d.TAG_NAMES.COLGROUP,d.TAG_ID.COLGROUP),e.insertionMode=f.IN_COLUMN_GROUP,Z(e,t)}(e,t);break;case d.TAG_ID.FORM:!function(e,t){e.formElement||0!==e.openElements.tmplCount||(e._insertElement(t,d.NS.HTML),e.formElement=e.openElements.current,e.openElements.pop())}(e,t);break;case d.TAG_ID.TABLE:!function(e,t){e.openElements.hasInTableScope(d.TAG_ID.TABLE)&&(e.openElements.popUntilTagNamePopped(d.TAG_ID.TABLE),e._resetInsertionMode(),e._processStartTag(t))}(e,t);break;case d.TAG_ID.TBODY:case d.TAG_ID.TFOOT:case d.TAG_ID.THEAD:!function(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,d.NS.HTML),e.insertionMode=f.IN_TABLE_BODY}(e,t);break;case d.TAG_ID.INPUT:!function(e,t){F(t)?e._appendElement(t,d.NS.HTML):K(e,t),t.ackSelfClosing=!0}(e,t);break;case d.TAG_ID.CAPTION:!function(e,t){e.openElements.clearBackToTableContext(),e.activeFormattingElements.insertMarker(),e._insertElement(t,d.NS.HTML),e.insertionMode=f.IN_CAPTION}(e,t);break;case d.TAG_ID.COLGROUP:!function(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,d.NS.HTML),e.insertionMode=f.IN_COLUMN_GROUP}(e,t);break;default:K(e,t)}}function V(e,t){switch(t.tagID){case d.TAG_ID.TABLE:e.openElements.hasInTableScope(d.TAG_ID.TABLE)&&(e.openElements.popUntilTagNamePopped(d.TAG_ID.TABLE),e._resetInsertionMode());break;case d.TAG_ID.TEMPLATE:P(e,t);break;case d.TAG_ID.BODY:case d.TAG_ID.CAPTION:case d.TAG_ID.COL:case d.TAG_ID.COLGROUP:case d.TAG_ID.HTML:case d.TAG_ID.TBODY:case d.TAG_ID.TD:case d.TAG_ID.TFOOT:case d.TAG_ID.TH:case d.TAG_ID.THEAD:case d.TAG_ID.TR:break;default:K(e,t)}}function K(e,t){const n=e.fosterParentingEnabled;e.fosterParentingEnabled=!0,D(e,t),e.fosterParentingEnabled=n}function Y(e,t){e.pendingCharacterTokens.push(t)}function Q(e,t){e.pendingCharacterTokens.push(t),e.hasNonWhitespacePendingCharacterToken=!0}function X(e,t){let n=0;if(e.hasNonWhitespacePendingCharacterToken)for(;n<e.pendingCharacterTokens.length;n++)K(e,e.pendingCharacterTokens[n]);else for(;n<e.pendingCharacterTokens.length;n++)e._insertCharacters(e.pendingCharacterTokens[n]);e.insertionMode=e.originalInsertionMode,e._processToken(t)}t.Parser=class{constructor(e,t,n=null,s=null){this.fragmentContext=n,this.scriptHandler=s,this.currentToken=null,this.stopped=!1,this.insertionMode=f.INITIAL,this.originalInsertionMode=f.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options=Object.assign(Object.assign({},m),e),this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=null!=t?t:this.treeAdapter.createDocument(),this.tokenizer=new r.Tokenizer(this.options,this),this.activeFormattingElements=new o.FormattingElementList(this.treeAdapter),this.fragmentContextID=n?(0,d.getTagID)(this.treeAdapter.getTagName(n)):d.TAG_ID.UNKNOWN,this._setContextModes(null!=n?n:this.document,this.fragmentContextID),this.openElements=new i.OpenElementStack(this.document,this.treeAdapter,this)}static parse(e,t){const n=new this(t);return n.tokenizer.write(e,!0),n.document}static getFragmentParser(e,t){const n=Object.assign(Object.assign({},m),t);null!=e||(e=n.treeAdapter.createElement(d.TAG_NAMES.TEMPLATE,d.NS.HTML,[]));const r=n.treeAdapter.createElement("documentmock",d.NS.HTML,[]),i=new this(n,r,e);return i.fragmentContextID===d.TAG_ID.TEMPLATE&&i.tmplInsertionModeStack.unshift(f.IN_TEMPLATE),i._initTokenizerForFragmentParsing(),i._insertFakeRootElement(),i._resetInsertionMode(),i._findFormInFragmentContext(),i}getFragment(){const e=this.treeAdapter.getFirstChild(this.document),t=this.treeAdapter.createDocumentFragment();return this._adoptNodes(e,t),t}_err(e,t,n){var r;if(!this.onParseError)return;const i=null!==(r=e.location)&&void 0!==r?r:p,o={code:t,startLine:i.startLine,startCol:i.startCol,startOffset:i.startOffset,endLine:n?i.startLine:i.endLine,endCol:n?i.startCol:i.endCol,endOffset:n?i.startOffset:i.endOffset};this.onParseError(o)}onItemPush(e,t,n){var r,i;null===(i=(r=this.treeAdapter).onItemPush)||void 0===i||i.call(r,e),n&&this.openElements.stackTop>0&&this._setContextModes(e,t)}onItemPop(e,t){var n,r;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(e,this.currentToken),null===(r=(n=this.treeAdapter).onItemPop)||void 0===r||r.call(n,e,this.openElements.current),t){let e,t;0===this.openElements.stackTop&&this.fragmentContext?(e=this.fragmentContext,t=this.fragmentContextID):({current:e,currentTagId:t}=this.openElements),this._setContextModes(e,t)}}_setContextModes(e,t){const n=e===this.document||this.treeAdapter.getNamespaceURI(e)===d.NS.HTML;this.currentNotInHTML=!n,this.tokenizer.inForeignNode=!n&&!this._isIntegrationPoint(t,e)}_switchToTextParsing(e,t){this._insertElement(e,d.NS.HTML),this.tokenizer.state=t,this.originalInsertionMode=this.insertionMode,this.insertionMode=f.TEXT}switchToPlaintextParsing(){this.insertionMode=f.TEXT,this.originalInsertionMode=f.IN_BODY,this.tokenizer.state=r.TokenizerMode.PLAINTEXT}_getAdjustedCurrentElement(){return 0===this.openElements.stackTop&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let e=this.fragmentContext;for(;e;){if(this.treeAdapter.getTagName(e)===d.TAG_NAMES.FORM){this.formElement=e;break}e=this.treeAdapter.getParentNode(e)}}_initTokenizerForFragmentParsing(){if(this.fragmentContext&&this.treeAdapter.getNamespaceURI(this.fragmentContext)===d.NS.HTML)switch(this.fragmentContextID){case d.TAG_ID.TITLE:case d.TAG_ID.TEXTAREA:this.tokenizer.state=r.TokenizerMode.RCDATA;break;case d.TAG_ID.STYLE:case d.TAG_ID.XMP:case d.TAG_ID.IFRAME:case d.TAG_ID.NOEMBED:case d.TAG_ID.NOFRAMES:case d.TAG_ID.NOSCRIPT:this.tokenizer.state=r.TokenizerMode.RAWTEXT;break;case d.TAG_ID.SCRIPT:this.tokenizer.state=r.TokenizerMode.SCRIPT_DATA;break;case d.TAG_ID.PLAINTEXT:this.tokenizer.state=r.TokenizerMode.PLAINTEXT}}_setDocumentType(e){const t=e.name||"",n=e.publicId||"",r=e.systemId||"";if(this.treeAdapter.setDocumentType(this.document,t,n,r),e.location){const t=this.treeAdapter.getChildNodes(this.document).find((e=>this.treeAdapter.isDocumentTypeNode(e)));t&&this.treeAdapter.setNodeSourceCodeLocation(t,e.location)}}_attachElementToTree(e,t){if(this.options.sourceCodeLocationInfo){const n=t&&Object.assign(Object.assign({},t),{startTag:t});this.treeAdapter.setNodeSourceCodeLocation(e,n)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(e);else{const t=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(t,e)}}_appendElement(e,t){const n=this.treeAdapter.createElement(e.tagName,t,e.attrs);this._attachElementToTree(n,e.location)}_insertElement(e,t){const n=this.treeAdapter.createElement(e.tagName,t,e.attrs);this._attachElementToTree(n,e.location),this.openElements.push(n,e.tagID)}_insertFakeElement(e,t){const n=this.treeAdapter.createElement(e,d.NS.HTML,[]);this._attachElementToTree(n,null),this.openElements.push(n,t)}_insertTemplate(e){const t=this.treeAdapter.createElement(e.tagName,d.NS.HTML,e.attrs),n=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(t,n),this._attachElementToTree(t,e.location),this.openElements.push(t,e.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,null)}_insertFakeRootElement(){const e=this.treeAdapter.createElement(d.TAG_NAMES.HTML,d.NS.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(e,null),this.treeAdapter.appendChild(this.openElements.current,e),this.openElements.push(e,d.TAG_ID.HTML)}_appendCommentNode(e,t){const n=this.treeAdapter.createCommentNode(e.data);this.treeAdapter.appendChild(t,n),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,e.location)}_insertCharacters(e){let t,n;if(this._shouldFosterParentOnInsertion()?(({parent:t,beforeElement:n}=this._findFosterParentingLocation()),n?this.treeAdapter.insertTextBefore(t,e.chars,n):this.treeAdapter.insertText(t,e.chars)):(t=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(t,e.chars)),!e.location)return;const r=this.treeAdapter.getChildNodes(t),i=n?r.lastIndexOf(n):r.length,o=r[i-1];if(this.treeAdapter.getNodeSourceCodeLocation(o)){const{endLine:t,endCol:n,endOffset:r}=e.location;this.treeAdapter.updateNodeSourceCodeLocation(o,{endLine:t,endCol:n,endOffset:r})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(o,e.location)}_adoptNodes(e,t){for(let n=this.treeAdapter.getFirstChild(e);n;n=this.treeAdapter.getFirstChild(e))this.treeAdapter.detachNode(n),this.treeAdapter.appendChild(t,n)}_setEndLocation(e,t){if(this.treeAdapter.getNodeSourceCodeLocation(e)&&t.location){const n=t.location,r=this.treeAdapter.getTagName(e),i=t.type===h.TokenType.END_TAG&&r===t.tagName?{endTag:Object.assign({},n),endLine:n.endLine,endCol:n.endCol,endOffset:n.endOffset}:{endLine:n.startLine,endCol:n.startCol,endOffset:n.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(e,i)}}shouldProcessStartTagTokenInForeignContent(e){if(!this.currentNotInHTML)return!1;let t,n;return 0===this.openElements.stackTop&&this.fragmentContext?(t=this.fragmentContext,n=this.fragmentContextID):({current:t,currentTagId:n}=this.openElements),(e.tagID!==d.TAG_ID.SVG||this.treeAdapter.getTagName(t)!==d.TAG_NAMES.ANNOTATION_XML||this.treeAdapter.getNamespaceURI(t)!==d.NS.MATHML)&&(this.tokenizer.inForeignNode||(e.tagID===d.TAG_ID.MGLYPH||e.tagID===d.TAG_ID.MALIGNMARK)&&!this._isIntegrationPoint(n,t,d.NS.HTML))}_processToken(e){switch(e.type){case h.TokenType.CHARACTER:this.onCharacter(e);break;case h.TokenType.NULL_CHARACTER:this.onNullCharacter(e);break;case h.TokenType.COMMENT:this.onComment(e);break;case h.TokenType.DOCTYPE:this.onDoctype(e);break;case h.TokenType.START_TAG:this._processStartTag(e);break;case h.TokenType.END_TAG:this.onEndTag(e);break;case h.TokenType.EOF:this.onEof(e);break;case h.TokenType.WHITESPACE_CHARACTER:this.onWhitespaceCharacter(e)}}_isIntegrationPoint(e,t,n){const r=this.treeAdapter.getNamespaceURI(t),i=this.treeAdapter.getAttrList(t);return c.isIntegrationPoint(e,r,i,n)}_reconstructActiveFormattingElements(){const e=this.activeFormattingElements.entries.length;if(e){const t=this.activeFormattingElements.entries.findIndex((e=>e.type===o.EntryType.Marker||this.openElements.contains(e.element)));for(let n=t<0?e-1:t-1;n>=0;n--){const e=this.activeFormattingElements.entries[n];this._insertElement(e.token,this.treeAdapter.getNamespaceURI(e.element)),e.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=f.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(d.TAG_ID.P),this.openElements.popUntilTagNamePopped(d.TAG_ID.P)}_resetInsertionMode(){for(let e=this.openElements.stackTop;e>=0;e--)switch(0===e&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[e]){case d.TAG_ID.TR:return void(this.insertionMode=f.IN_ROW);case d.TAG_ID.TBODY:case d.TAG_ID.THEAD:case d.TAG_ID.TFOOT:return void(this.insertionMode=f.IN_TABLE_BODY);case d.TAG_ID.CAPTION:return void(this.insertionMode=f.IN_CAPTION);case d.TAG_ID.COLGROUP:return void(this.insertionMode=f.IN_COLUMN_GROUP);case d.TAG_ID.TABLE:return void(this.insertionMode=f.IN_TABLE);case d.TAG_ID.BODY:return void(this.insertionMode=f.IN_BODY);case d.TAG_ID.FRAMESET:return void(this.insertionMode=f.IN_FRAMESET);case d.TAG_ID.SELECT:return void this._resetInsertionModeForSelect(e);case d.TAG_ID.TEMPLATE:return void(this.insertionMode=this.tmplInsertionModeStack[0]);case d.TAG_ID.HTML:return void(this.insertionMode=this.headElement?f.AFTER_HEAD:f.BEFORE_HEAD);case d.TAG_ID.TD:case d.TAG_ID.TH:if(e>0)return void(this.insertionMode=f.IN_CELL);break;case d.TAG_ID.HEAD:if(e>0)return void(this.insertionMode=f.IN_HEAD)}this.insertionMode=f.IN_BODY}_resetInsertionModeForSelect(e){if(e>0)for(let t=e-1;t>0;t--){const e=this.openElements.tagIDs[t];if(e===d.TAG_ID.TEMPLATE)break;if(e===d.TAG_ID.TABLE)return void(this.insertionMode=f.IN_SELECT_IN_TABLE)}this.insertionMode=f.IN_SELECT}_isElementCausesFosterParenting(e){return g.has(e)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let e=this.openElements.stackTop;e>=0;e--){const t=this.openElements.items[e];switch(this.openElements.tagIDs[e]){case d.TAG_ID.TEMPLATE:if(this.treeAdapter.getNamespaceURI(t)===d.NS.HTML)return{parent:this.treeAdapter.getTemplateContent(t),beforeElement:null};break;case d.TAG_ID.TABLE:{const n=this.treeAdapter.getParentNode(t);return n?{parent:n,beforeElement:t}:{parent:this.openElements.items[e-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(e){const t=this._findFosterParentingLocation();t.beforeElement?this.treeAdapter.insertBefore(t.parent,e,t.beforeElement):this.treeAdapter.appendChild(t.parent,e)}_isSpecialElement(e,t){const n=this.treeAdapter.getNamespaceURI(e);return d.SPECIAL_ELEMENTS[n].has(t)}onCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode)!function(e,t){e._insertCharacters(t),e.framesetOk=!1}(this,e);else switch(this.insertionMode){case f.INITIAL:O(this,e);break;case f.BEFORE_HTML:I(this,e);break;case f.BEFORE_HEAD:C(this,e);break;case f.IN_HEAD:x(this,e);break;case f.IN_HEAD_NO_SCRIPT:R(this,e);break;case f.AFTER_HEAD:L(this,e);break;case f.IN_BODY:case f.IN_CAPTION:case f.IN_CELL:case f.IN_TEMPLATE:j(this,e);break;case f.TEXT:case f.IN_SELECT:case f.IN_SELECT_IN_TABLE:this._insertCharacters(e);break;case f.IN_TABLE:case f.IN_TABLE_BODY:case f.IN_ROW:W(this,e);break;case f.IN_TABLE_TEXT:Q(this,e);break;case f.IN_COLUMN_GROUP:ee(this,e);break;case f.AFTER_BODY:le(this,e);break;case f.AFTER_AFTER_BODY:ue(this,e)}}onNullCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode)!function(e,t){t.chars=u.REPLACEMENT_CHARACTER,e._insertCharacters(t)}(this,e);else switch(this.insertionMode){case f.INITIAL:O(this,e);break;case f.BEFORE_HTML:I(this,e);break;case f.BEFORE_HEAD:C(this,e);break;case f.IN_HEAD:x(this,e);break;case f.IN_HEAD_NO_SCRIPT:R(this,e);break;case f.AFTER_HEAD:L(this,e);break;case f.TEXT:this._insertCharacters(e);break;case f.IN_TABLE:case f.IN_TABLE_BODY:case f.IN_ROW:W(this,e);break;case f.IN_COLUMN_GROUP:ee(this,e);break;case f.AFTER_BODY:le(this,e);break;case f.AFTER_AFTER_BODY:ue(this,e)}}onComment(e){if(this.skipNextNewLine=!1,this.currentNotInHTML)A(this,e);else switch(this.insertionMode){case f.INITIAL:case f.BEFORE_HTML:case f.BEFORE_HEAD:case f.IN_HEAD:case f.IN_HEAD_NO_SCRIPT:case f.AFTER_HEAD:case f.IN_BODY:case f.IN_TABLE:case f.IN_CAPTION:case f.IN_COLUMN_GROUP:case f.IN_TABLE_BODY:case f.IN_ROW:case f.IN_CELL:case f.IN_SELECT:case f.IN_SELECT_IN_TABLE:case f.IN_TEMPLATE:case f.IN_FRAMESET:case f.AFTER_FRAMESET:A(this,e);break;case f.IN_TABLE_TEXT:X(this,e);break;case f.AFTER_BODY:!function(e,t){e._appendCommentNode(t,e.openElements.items[0])}(this,e);break;case f.AFTER_AFTER_BODY:case f.AFTER_AFTER_FRAMESET:!function(e,t){e._appendCommentNode(t,e.document)}(this,e)}}onDoctype(e){switch(this.skipNextNewLine=!1,this.insertionMode){case f.INITIAL:!function(e,t){e._setDocumentType(t);const n=t.forceQuirks?d.DOCUMENT_MODE.QUIRKS:a.getDocumentMode(t);a.isConforming(t)||e._err(t,l.ERR.nonConformingDoctype);e.treeAdapter.setDocumentMode(e.document,n),e.insertionMode=f.BEFORE_HTML}(this,e);break;case f.BEFORE_HEAD:case f.IN_HEAD:case f.IN_HEAD_NO_SCRIPT:case f.AFTER_HEAD:this._err(e,l.ERR.misplacedDoctype);break;case f.IN_TABLE_TEXT:X(this,e)}}onStartTag(e){this.skipNextNewLine=!1,this.currentToken=e,this._processStartTag(e),e.selfClosing&&!e.ackSelfClosing&&this._err(e,l.ERR.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(e){this.shouldProcessStartTagTokenInForeignContent(e)?function(e,t){if(c.causesExit(t))de(e),e._startTagOutsideForeignContent(t);else{const n=e._getAdjustedCurrentElement(),r=e.treeAdapter.getNamespaceURI(n);r===d.NS.MATHML?c.adjustTokenMathMLAttrs(t):r===d.NS.SVG&&(c.adjustTokenSVGTagName(t),c.adjustTokenSVGAttrs(t)),c.adjustTokenXMLAttrs(t),t.selfClosing?e._appendElement(t,r):e._insertElement(t,r),t.ackSelfClosing=!0}}(this,e):this._startTagOutsideForeignContent(e)}_startTagOutsideForeignContent(e){switch(this.insertionMode){case f.INITIAL:O(this,e);break;case f.BEFORE_HTML:!function(e,t){t.tagID===d.TAG_ID.HTML?(e._insertElement(t,d.NS.HTML),e.insertionMode=f.BEFORE_HEAD):I(e,t)}(this,e);break;case f.BEFORE_HEAD:!function(e,t){switch(t.tagID){case d.TAG_ID.HTML:G(e,t);break;case d.TAG_ID.HEAD:e._insertElement(t,d.NS.HTML),e.headElement=e.openElements.current,e.insertionMode=f.IN_HEAD;break;default:C(e,t)}}(this,e);break;case f.IN_HEAD:k(this,e);break;case f.IN_HEAD_NO_SCRIPT:!function(e,t){switch(t.tagID){case d.TAG_ID.HTML:G(e,t);break;case d.TAG_ID.BASEFONT:case d.TAG_ID.BGSOUND:case d.TAG_ID.HEAD:case d.TAG_ID.LINK:case d.TAG_ID.META:case d.TAG_ID.NOFRAMES:case d.TAG_ID.STYLE:k(e,t);break;case d.TAG_ID.NOSCRIPT:e._err(t,l.ERR.nestedNoscriptInHead);break;default:R(e,t)}}(this,e);break;case f.AFTER_HEAD:!function(e,t){switch(t.tagID){case d.TAG_ID.HTML:G(e,t);break;case d.TAG_ID.BODY:e._insertElement(t,d.NS.HTML),e.framesetOk=!1,e.insertionMode=f.IN_BODY;break;case d.TAG_ID.FRAMESET:e._insertElement(t,d.NS.HTML),e.insertionMode=f.IN_FRAMESET;break;case d.TAG_ID.BASE:case d.TAG_ID.BASEFONT:case d.TAG_ID.BGSOUND:case d.TAG_ID.LINK:case d.TAG_ID.META:case d.TAG_ID.NOFRAMES:case d.TAG_ID.SCRIPT:case d.TAG_ID.STYLE:case d.TAG_ID.TEMPLATE:case d.TAG_ID.TITLE:e._err(t,l.ERR.abandonedHeadElementChild),e.openElements.push(e.headElement,d.TAG_ID.HEAD),k(e,t),e.openElements.remove(e.headElement);break;case d.TAG_ID.HEAD:e._err(t,l.ERR.misplacedStartTagForHeadElement);break;default:L(e,t)}}(this,e);break;case f.IN_BODY:G(this,e);break;case f.IN_TABLE:z(this,e);break;case f.IN_TABLE_TEXT:X(this,e);break;case f.IN_CAPTION:!function(e,t){const n=t.tagID;J.has(n)?e.openElements.hasInTableScope(d.TAG_ID.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(d.TAG_ID.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=f.IN_TABLE,z(e,t)):G(e,t)}(this,e);break;case f.IN_COLUMN_GROUP:Z(this,e);break;case f.IN_TABLE_BODY:te(this,e);break;case f.IN_ROW:re(this,e);break;case f.IN_CELL:!function(e,t){const n=t.tagID;J.has(n)?(e.openElements.hasInTableScope(d.TAG_ID.TD)||e.openElements.hasInTableScope(d.TAG_ID.TH))&&(e._closeTableCell(),re(e,t)):G(e,t)}(this,e);break;case f.IN_SELECT:oe(this,e);break;case f.IN_SELECT_IN_TABLE:!function(e,t){const n=t.tagID;n===d.TAG_ID.CAPTION||n===d.TAG_ID.TABLE||n===d.TAG_ID.TBODY||n===d.TAG_ID.TFOOT||n===d.TAG_ID.THEAD||n===d.TAG_ID.TR||n===d.TAG_ID.TD||n===d.TAG_ID.TH?(e.openElements.popUntilTagNamePopped(d.TAG_ID.SELECT),e._resetInsertionMode(),e._processStartTag(t)):oe(e,t)}(this,e);break;case f.IN_TEMPLATE:!function(e,t){switch(t.tagID){case d.TAG_ID.BASE:case d.TAG_ID.BASEFONT:case d.TAG_ID.BGSOUND:case d.TAG_ID.LINK:case d.TAG_ID.META:case d.TAG_ID.NOFRAMES:case d.TAG_ID.SCRIPT:case d.TAG_ID.STYLE:case d.TAG_ID.TEMPLATE:case d.TAG_ID.TITLE:k(e,t);break;case d.TAG_ID.CAPTION:case d.TAG_ID.COLGROUP:case d.TAG_ID.TBODY:case d.TAG_ID.TFOOT:case d.TAG_ID.THEAD:e.tmplInsertionModeStack[0]=f.IN_TABLE,e.insertionMode=f.IN_TABLE,z(e,t);break;case d.TAG_ID.COL:e.tmplInsertionModeStack[0]=f.IN_COLUMN_GROUP,e.insertionMode=f.IN_COLUMN_GROUP,Z(e,t);break;case d.TAG_ID.TR:e.tmplInsertionModeStack[0]=f.IN_TABLE_BODY,e.insertionMode=f.IN_TABLE_BODY,te(e,t);break;case d.TAG_ID.TD:case d.TAG_ID.TH:e.tmplInsertionModeStack[0]=f.IN_ROW,e.insertionMode=f.IN_ROW,re(e,t);break;default:e.tmplInsertionModeStack[0]=f.IN_BODY,e.insertionMode=f.IN_BODY,G(e,t)}}(this,e);break;case f.AFTER_BODY:!function(e,t){t.tagID===d.TAG_ID.HTML?G(e,t):le(e,t)}(this,e);break;case f.IN_FRAMESET:!function(e,t){switch(t.tagID){case d.TAG_ID.HTML:G(e,t);break;case d.TAG_ID.FRAMESET:e._insertElement(t,d.NS.HTML);break;case d.TAG_ID.FRAME:e._appendElement(t,d.NS.HTML),t.ackSelfClosing=!0;break;case d.TAG_ID.NOFRAMES:k(e,t)}}(this,e);break;case f.AFTER_FRAMESET:!function(e,t){switch(t.tagID){case d.TAG_ID.HTML:G(e,t);break;case d.TAG_ID.NOFRAMES:k(e,t)}}(this,e);break;case f.AFTER_AFTER_BODY:!function(e,t){t.tagID===d.TAG_ID.HTML?G(e,t):ue(e,t)}(this,e);break;case f.AFTER_AFTER_FRAMESET:!function(e,t){switch(t.tagID){case d.TAG_ID.HTML:G(e,t);break;case d.TAG_ID.NOFRAMES:k(e,t)}}(this,e)}}onEndTag(e){this.skipNextNewLine=!1,this.currentToken=e,this.currentNotInHTML?function(e,t){if(t.tagID===d.TAG_ID.P||t.tagID===d.TAG_ID.BR)return de(e),void e._endTagOutsideForeignContent(t);for(let n=e.openElements.stackTop;n>0;n--){const r=e.openElements.items[n];if(e.treeAdapter.getNamespaceURI(r)===d.NS.HTML){e._endTagOutsideForeignContent(t);break}const i=e.treeAdapter.getTagName(r);if(i.toLowerCase()===t.tagName){t.tagName=i,e.openElements.shortenToLength(n);break}}}(this,e):this._endTagOutsideForeignContent(e)}_endTagOutsideForeignContent(e){switch(this.insertionMode){case f.INITIAL:O(this,e);break;case f.BEFORE_HTML:!function(e,t){const n=t.tagID;n!==d.TAG_ID.HTML&&n!==d.TAG_ID.HEAD&&n!==d.TAG_ID.BODY&&n!==d.TAG_ID.BR||I(e,t)}(this,e);break;case f.BEFORE_HEAD:!function(e,t){const n=t.tagID;n===d.TAG_ID.HEAD||n===d.TAG_ID.BODY||n===d.TAG_ID.HTML||n===d.TAG_ID.BR?C(e,t):e._err(t,l.ERR.endTagWithoutMatchingOpenElement)}(this,e);break;case f.IN_HEAD:!function(e,t){switch(t.tagID){case d.TAG_ID.HEAD:e.openElements.pop(),e.insertionMode=f.AFTER_HEAD;break;case d.TAG_ID.BODY:case d.TAG_ID.BR:case d.TAG_ID.HTML:x(e,t);break;case d.TAG_ID.TEMPLATE:P(e,t);break;default:e._err(t,l.ERR.endTagWithoutMatchingOpenElement)}}(this,e);break;case f.IN_HEAD_NO_SCRIPT:!function(e,t){switch(t.tagID){case d.TAG_ID.NOSCRIPT:e.openElements.pop(),e.insertionMode=f.IN_HEAD;break;case d.TAG_ID.BR:R(e,t);break;default:e._err(t,l.ERR.endTagWithoutMatchingOpenElement)}}(this,e);break;case f.AFTER_HEAD:!function(e,t){switch(t.tagID){case d.TAG_ID.BODY:case d.TAG_ID.HTML:case d.TAG_ID.BR:L(e,t);break;case d.TAG_ID.TEMPLATE:P(e,t);break;default:e._err(t,l.ERR.endTagWithoutMatchingOpenElement)}}(this,e);break;case f.IN_BODY:H(this,e);break;case f.TEXT:!function(e,t){var n;t.tagID===d.TAG_ID.SCRIPT&&(null===(n=e.scriptHandler)||void 0===n||n.call(e,e.openElements.current));e.openElements.pop(),e.insertionMode=e.originalInsertionMode}(this,e);break;case f.IN_TABLE:V(this,e);break;case f.IN_TABLE_TEXT:X(this,e);break;case f.IN_CAPTION:!function(e,t){const n=t.tagID;switch(n){case d.TAG_ID.CAPTION:case d.TAG_ID.TABLE:e.openElements.hasInTableScope(d.TAG_ID.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(d.TAG_ID.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=f.IN_TABLE,n===d.TAG_ID.TABLE&&V(e,t));break;case d.TAG_ID.BODY:case d.TAG_ID.COL:case d.TAG_ID.COLGROUP:case d.TAG_ID.HTML:case d.TAG_ID.TBODY:case d.TAG_ID.TD:case d.TAG_ID.TFOOT:case d.TAG_ID.TH:case d.TAG_ID.THEAD:case d.TAG_ID.TR:break;default:H(e,t)}}(this,e);break;case f.IN_COLUMN_GROUP:!function(e,t){switch(t.tagID){case d.TAG_ID.COLGROUP:e.openElements.currentTagId===d.TAG_ID.COLGROUP&&(e.openElements.pop(),e.insertionMode=f.IN_TABLE);break;case d.TAG_ID.TEMPLATE:P(e,t);break;case d.TAG_ID.COL:break;default:ee(e,t)}}(this,e);break;case f.IN_TABLE_BODY:ne(this,e);break;case f.IN_ROW:ie(this,e);break;case f.IN_CELL:!function(e,t){const n=t.tagID;switch(n){case d.TAG_ID.TD:case d.TAG_ID.TH:e.openElements.hasInTableScope(n)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(n),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=f.IN_ROW);break;case d.TAG_ID.TABLE:case d.TAG_ID.TBODY:case d.TAG_ID.TFOOT:case d.TAG_ID.THEAD:case d.TAG_ID.TR:e.openElements.hasInTableScope(n)&&(e._closeTableCell(),ie(e,t));break;case d.TAG_ID.BODY:case d.TAG_ID.CAPTION:case d.TAG_ID.COL:case d.TAG_ID.COLGROUP:case d.TAG_ID.HTML:break;default:H(e,t)}}(this,e);break;case f.IN_SELECT:se(this,e);break;case f.IN_SELECT_IN_TABLE:!function(e,t){const n=t.tagID;n===d.TAG_ID.CAPTION||n===d.TAG_ID.TABLE||n===d.TAG_ID.TBODY||n===d.TAG_ID.TFOOT||n===d.TAG_ID.THEAD||n===d.TAG_ID.TR||n===d.TAG_ID.TD||n===d.TAG_ID.TH?e.openElements.hasInTableScope(n)&&(e.openElements.popUntilTagNamePopped(d.TAG_ID.SELECT),e._resetInsertionMode(),e.onEndTag(t)):se(e,t)}(this,e);break;case f.IN_TEMPLATE:!function(e,t){t.tagID===d.TAG_ID.TEMPLATE&&P(e,t)}(this,e);break;case f.AFTER_BODY:ce(this,e);break;case f.IN_FRAMESET:!function(e,t){t.tagID!==d.TAG_ID.FRAMESET||e.openElements.isRootHtmlElementCurrent()||(e.openElements.pop(),e.fragmentContext||e.openElements.currentTagId===d.TAG_ID.FRAMESET||(e.insertionMode=f.AFTER_FRAMESET))}(this,e);break;case f.AFTER_FRAMESET:!function(e,t){t.tagID===d.TAG_ID.HTML&&(e.insertionMode=f.AFTER_AFTER_FRAMESET)}(this,e);break;case f.AFTER_AFTER_BODY:ue(this,e)}}onEof(e){switch(this.insertionMode){case f.INITIAL:O(this,e);break;case f.BEFORE_HTML:I(this,e);break;case f.BEFORE_HEAD:C(this,e);break;case f.IN_HEAD:x(this,e);break;case f.IN_HEAD_NO_SCRIPT:R(this,e);break;case f.AFTER_HEAD:L(this,e);break;case f.IN_BODY:case f.IN_TABLE:case f.IN_CAPTION:case f.IN_COLUMN_GROUP:case f.IN_TABLE_BODY:case f.IN_ROW:case f.IN_CELL:case f.IN_SELECT:case f.IN_SELECT_IN_TABLE:$(this,e);break;case f.TEXT:!function(e,t){e._err(t,l.ERR.eofInElementThatCanContainOnlyText),e.openElements.pop(),e.insertionMode=e.originalInsertionMode,e.onEof(t)}(this,e);break;case f.IN_TABLE_TEXT:X(this,e);break;case f.IN_TEMPLATE:ae(this,e);break;case f.AFTER_BODY:case f.IN_FRAMESET:case f.AFTER_FRAMESET:case f.AFTER_AFTER_BODY:case f.AFTER_AFTER_FRAMESET:S(this,e)}}onWhitespaceCharacter(e){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,e.chars.charCodeAt(0)===u.CODE_POINTS.LINE_FEED)){if(1===e.chars.length)return;e.chars=e.chars.substr(1)}if(this.tokenizer.inForeignNode)this._insertCharacters(e);else switch(this.insertionMode){case f.IN_HEAD:case f.IN_HEAD_NO_SCRIPT:case f.AFTER_HEAD:case f.TEXT:case f.IN_COLUMN_GROUP:case f.IN_SELECT:case f.IN_SELECT_IN_TABLE:case f.IN_FRAMESET:case f.AFTER_FRAMESET:this._insertCharacters(e);break;case f.IN_BODY:case f.IN_CAPTION:case f.IN_CELL:case f.IN_TEMPLATE:case f.AFTER_BODY:case f.AFTER_AFTER_BODY:case f.AFTER_AFTER_FRAMESET:N(this,e);break;case f.IN_TABLE:case f.IN_TABLE_BODY:case f.IN_ROW:W(this,e);break;case f.IN_TABLE_TEXT:Y(this,e)}}};const J=new Set([d.TAG_ID.CAPTION,d.TAG_ID.COL,d.TAG_ID.COLGROUP,d.TAG_ID.TBODY,d.TAG_ID.TD,d.TAG_ID.TFOOT,d.TAG_ID.TH,d.TAG_ID.THEAD,d.TAG_ID.TR]);function Z(e,t){switch(t.tagID){case d.TAG_ID.HTML:G(e,t);break;case d.TAG_ID.COL:e._appendElement(t,d.NS.HTML),t.ackSelfClosing=!0;break;case d.TAG_ID.TEMPLATE:k(e,t);break;default:ee(e,t)}}function ee(e,t){e.openElements.currentTagId===d.TAG_ID.COLGROUP&&(e.openElements.pop(),e.insertionMode=f.IN_TABLE,e._processToken(t))}function te(e,t){switch(t.tagID){case d.TAG_ID.TR:e.openElements.clearBackToTableBodyContext(),e._insertElement(t,d.NS.HTML),e.insertionMode=f.IN_ROW;break;case d.TAG_ID.TH:case d.TAG_ID.TD:e.openElements.clearBackToTableBodyContext(),e._insertFakeElement(d.TAG_NAMES.TR,d.TAG_ID.TR),e.insertionMode=f.IN_ROW,re(e,t);break;case d.TAG_ID.CAPTION:case d.TAG_ID.COL:case d.TAG_ID.COLGROUP:case d.TAG_ID.TBODY:case d.TAG_ID.TFOOT:case d.TAG_ID.THEAD:e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=f.IN_TABLE,z(e,t));break;default:z(e,t)}}function ne(e,t){const n=t.tagID;switch(t.tagID){case d.TAG_ID.TBODY:case d.TAG_ID.TFOOT:case d.TAG_ID.THEAD:e.openElements.hasInTableScope(n)&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=f.IN_TABLE);break;case d.TAG_ID.TABLE:e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=f.IN_TABLE,V(e,t));break;case d.TAG_ID.BODY:case d.TAG_ID.CAPTION:case d.TAG_ID.COL:case d.TAG_ID.COLGROUP:case d.TAG_ID.HTML:case d.TAG_ID.TD:case d.TAG_ID.TH:case d.TAG_ID.TR:break;default:V(e,t)}}function re(e,t){switch(t.tagID){case d.TAG_ID.TH:case d.TAG_ID.TD:e.openElements.clearBackToTableRowContext(),e._insertElement(t,d.NS.HTML),e.insertionMode=f.IN_CELL,e.activeFormattingElements.insertMarker();break;case d.TAG_ID.CAPTION:case d.TAG_ID.COL:case d.TAG_ID.COLGROUP:case d.TAG_ID.TBODY:case d.TAG_ID.TFOOT:case d.TAG_ID.THEAD:case d.TAG_ID.TR:e.openElements.hasInTableScope(d.TAG_ID.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=f.IN_TABLE_BODY,te(e,t));break;default:z(e,t)}}function ie(e,t){switch(t.tagID){case d.TAG_ID.TR:e.openElements.hasInTableScope(d.TAG_ID.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=f.IN_TABLE_BODY);break;case d.TAG_ID.TABLE:e.openElements.hasInTableScope(d.TAG_ID.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=f.IN_TABLE_BODY,ne(e,t));break;case d.TAG_ID.TBODY:case d.TAG_ID.TFOOT:case d.TAG_ID.THEAD:(e.openElements.hasInTableScope(t.tagID)||e.openElements.hasInTableScope(d.TAG_ID.TR))&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=f.IN_TABLE_BODY,ne(e,t));break;case d.TAG_ID.BODY:case d.TAG_ID.CAPTION:case d.TAG_ID.COL:case d.TAG_ID.COLGROUP:case d.TAG_ID.HTML:case d.TAG_ID.TD:case d.TAG_ID.TH:break;default:V(e,t)}}function oe(e,t){switch(t.tagID){case d.TAG_ID.HTML:G(e,t);break;case d.TAG_ID.OPTION:e.openElements.currentTagId===d.TAG_ID.OPTION&&e.openElements.pop(),e._insertElement(t,d.NS.HTML);break;case d.TAG_ID.OPTGROUP:e.openElements.currentTagId===d.TAG_ID.OPTION&&e.openElements.pop(),e.openElements.currentTagId===d.TAG_ID.OPTGROUP&&e.openElements.pop(),e._insertElement(t,d.NS.HTML);break;case d.TAG_ID.INPUT:case d.TAG_ID.KEYGEN:case d.TAG_ID.TEXTAREA:case d.TAG_ID.SELECT:e.openElements.hasInSelectScope(d.TAG_ID.SELECT)&&(e.openElements.popUntilTagNamePopped(d.TAG_ID.SELECT),e._resetInsertionMode(),t.tagID!==d.TAG_ID.SELECT&&e._processStartTag(t));break;case d.TAG_ID.SCRIPT:case d.TAG_ID.TEMPLATE:k(e,t)}}function se(e,t){switch(t.tagID){case d.TAG_ID.OPTGROUP:e.openElements.stackTop>0&&e.openElements.currentTagId===d.TAG_ID.OPTION&&e.openElements.tagIDs[e.openElements.stackTop-1]===d.TAG_ID.OPTGROUP&&e.openElements.pop(),e.openElements.currentTagId===d.TAG_ID.OPTGROUP&&e.openElements.pop();break;case d.TAG_ID.OPTION:e.openElements.currentTagId===d.TAG_ID.OPTION&&e.openElements.pop();break;case d.TAG_ID.SELECT:e.openElements.hasInSelectScope(d.TAG_ID.SELECT)&&(e.openElements.popUntilTagNamePopped(d.TAG_ID.SELECT),e._resetInsertionMode());break;case d.TAG_ID.TEMPLATE:P(e,t)}}function ae(e,t){e.openElements.tmplCount>0?(e.openElements.popUntilTagNamePopped(d.TAG_ID.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode(),e.onEof(t)):S(e,t)}function ce(e,t){var n;if(t.tagID===d.TAG_ID.HTML){if(e.fragmentContext||(e.insertionMode=f.AFTER_AFTER_BODY),e.options.sourceCodeLocationInfo&&e.openElements.tagIDs[0]===d.TAG_ID.HTML){e._setEndLocation(e.openElements.items[0],t);const r=e.openElements.items[1];r&&!(null===(n=e.treeAdapter.getNodeSourceCodeLocation(r))||void 0===n?void 0:n.endTag)&&e._setEndLocation(r,t)}}else le(e,t)}function le(e,t){e.insertionMode=f.IN_BODY,D(e,t)}function ue(e,t){e.insertionMode=f.IN_BODY,D(e,t)}function de(e){for(;e.treeAdapter.getNamespaceURI(e.openElements.current)!==d.NS.HTML&&!e._isIntegrationPoint(e.openElements.currentTagId,e.openElements.current);)e.openElements.pop()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tokenizer=t.TokenizerMode=void 0;const r=n(1364),i=n(1091),o=n(1092),s=n(335),a=n(1062),c=n(732),l=new Map([[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);var u;function d(e){return e>=i.CODE_POINTS.DIGIT_0&&e<=i.CODE_POINTS.DIGIT_9}function h(e){return e>=i.CODE_POINTS.LATIN_CAPITAL_A&&e<=i.CODE_POINTS.LATIN_CAPITAL_Z}function f(e){return function(e){return e>=i.CODE_POINTS.LATIN_SMALL_A&&e<=i.CODE_POINTS.LATIN_SMALL_Z}(e)||h(e)}function p(e){return f(e)||d(e)}function g(e){return e>=i.CODE_POINTS.LATIN_CAPITAL_A&&e<=i.CODE_POINTS.LATIN_CAPITAL_F}function m(e){return e>=i.CODE_POINTS.LATIN_SMALL_A&&e<=i.CODE_POINTS.LATIN_SMALL_F}function y(e){return e+32}function v(e){return e===i.CODE_POINTS.SPACE||e===i.CODE_POINTS.LINE_FEED||e===i.CODE_POINTS.TABULATION||e===i.CODE_POINTS.FORM_FEED}function b(e){return v(e)||e===i.CODE_POINTS.SOLIDUS||e===i.CODE_POINTS.GREATER_THAN_SIGN}!function(e){e[e.DATA=0]="DATA",e[e.RCDATA=1]="RCDATA",e[e.RAWTEXT=2]="RAWTEXT",e[e.SCRIPT_DATA=3]="SCRIPT_DATA",e[e.PLAINTEXT=4]="PLAINTEXT",e[e.TAG_OPEN=5]="TAG_OPEN",e[e.END_TAG_OPEN=6]="END_TAG_OPEN",e[e.TAG_NAME=7]="TAG_NAME",e[e.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",e[e.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",e[e.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",e[e.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",e[e.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",e[e.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",e[e.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",e[e.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",e[e.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",e[e.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",e[e.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",e[e.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",e[e.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",e[e.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",e[e.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",e[e.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",e[e.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",e[e.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",e[e.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",e[e.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",e[e.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",e[e.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",e[e.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",e[e.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",e[e.BOGUS_COMMENT=40]="BOGUS_COMMENT",e[e.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",e[e.COMMENT_START=42]="COMMENT_START",e[e.COMMENT_START_DASH=43]="COMMENT_START_DASH",e[e.COMMENT=44]="COMMENT",e[e.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",e[e.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",e[e.COMMENT_END_DASH=49]="COMMENT_END_DASH",e[e.COMMENT_END=50]="COMMENT_END",e[e.COMMENT_END_BANG=51]="COMMENT_END_BANG",e[e.DOCTYPE=52]="DOCTYPE",e[e.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",e[e.DOCTYPE_NAME=54]="DOCTYPE_NAME",e[e.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",e[e.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",e[e.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",e[e.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",e[e.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",e[e.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",e[e.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",e[e.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",e[e.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",e[e.CDATA_SECTION=68]="CDATA_SECTION",e[e.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",e[e.CDATA_SECTION_END=70]="CDATA_SECTION_END",e[e.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",e[e.NAMED_CHARACTER_REFERENCE=72]="NAMED_CHARACTER_REFERENCE",e[e.AMBIGUOUS_AMPERSAND=73]="AMBIGUOUS_AMPERSAND",e[e.NUMERIC_CHARACTER_REFERENCE=74]="NUMERIC_CHARACTER_REFERENCE",e[e.HEXADEMICAL_CHARACTER_REFERENCE_START=75]="HEXADEMICAL_CHARACTER_REFERENCE_START",e[e.HEXADEMICAL_CHARACTER_REFERENCE=76]="HEXADEMICAL_CHARACTER_REFERENCE",e[e.DECIMAL_CHARACTER_REFERENCE=77]="DECIMAL_CHARACTER_REFERENCE",e[e.NUMERIC_CHARACTER_REFERENCE_END=78]="NUMERIC_CHARACTER_REFERENCE_END"}(u||(u={})),t.TokenizerMode={DATA:u.DATA,RCDATA:u.RCDATA,RAWTEXT:u.RAWTEXT,SCRIPT_DATA:u.SCRIPT_DATA,PLAINTEXT:u.PLAINTEXT,CDATA_SECTION:u.CDATA_SECTION};t.Tokenizer=class{constructor(e,t){this.options=e,this.handler=t,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=u.DATA,this.returnState=u.DATA,this.charRefCode=-1,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new r.Preprocessor(t),this.currentLocation=this.getCurrentLocation(-1)}_err(e){var t,n;null===(n=(t=this.handler).onParseError)||void 0===n||n.call(t,this.preprocessor.getError(e))}getCurrentLocation(e){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-e,startOffset:this.preprocessor.offset-e,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const e=this._consume();this._ensureHibernation()||this._callState(e)}this.inLoop=!1}}pause(){this.paused=!0}resume(e){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,this.inLoop||(this._runParsingLoop(),this.paused||null==e||e())}write(e,t,n){this.active=!0,this.preprocessor.write(e,t),this._runParsingLoop(),this.paused||null==n||n()}insertHtmlAtCurrentPos(e){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(e),this._runParsingLoop()}_ensureHibernation(){return!!this.preprocessor.endOfChunkHit&&(this._unconsume(this.consumedAfterSnapshot),this.active=!1,!0)}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_unconsume(e){this.consumedAfterSnapshot-=e,this.preprocessor.retreat(e)}_reconsumeInState(e,t){this.state=e,this._callState(t)}_advanceBy(e){this.consumedAfterSnapshot+=e;for(let t=0;t<e;t++)this.preprocessor.advance()}_consumeSequenceIfMatch(e,t){return!!this.preprocessor.startsWith(e,t)&&(this._advanceBy(e.length-1),!0)}_createStartTagToken(){this.currentToken={type:o.TokenType.START_TAG,tagName:"",tagID:c.TAG_ID.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:o.TokenType.END_TAG,tagName:"",tagID:c.TAG_ID.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(e){this.currentToken={type:o.TokenType.COMMENT,data:"",location:this.getCurrentLocation(e)}}_createDoctypeToken(e){this.currentToken={type:o.TokenType.DOCTYPE,name:e,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(e,t){this.currentCharacterToken={type:e,chars:t,location:this.currentLocation}}_createAttr(e){this.currentAttr={name:e,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var e,t;const n=this.currentToken;if(null===(0,o.getTokenAttr)(n,this.currentAttr.name)){if(n.attrs.push(this.currentAttr),n.location&&this.currentLocation){(null!==(e=(t=n.location).attrs)&&void 0!==e?e:t.attrs=Object.create(null))[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(a.ERR.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(e){this._emitCurrentCharacterToken(e.location),this.currentToken=null,e.location&&(e.location.endLine=this.preprocessor.line,e.location.endCol=this.preprocessor.col+1,e.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const e=this.currentToken;this.prepareToken(e),e.tagID=(0,c.getTagID)(e.tagName),e.type===o.TokenType.START_TAG?(this.lastStartTagName=e.tagName,this.handler.onStartTag(e)):(e.attrs.length>0&&this._err(a.ERR.endTagWithAttributes),e.selfClosing&&this._err(a.ERR.endTagWithTrailingSolidus),this.handler.onEndTag(e)),this.preprocessor.dropParsedChunk()}emitCurrentComment(e){this.prepareToken(e),this.handler.onComment(e),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(e){this.prepareToken(e),this.handler.onDoctype(e),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(e){if(this.currentCharacterToken){switch(e&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=e.startLine,this.currentCharacterToken.location.endCol=e.startCol,this.currentCharacterToken.location.endOffset=e.startOffset),this.currentCharacterToken.type){case o.TokenType.CHARACTER:this.handler.onCharacter(this.currentCharacterToken);break;case o.TokenType.NULL_CHARACTER:this.handler.onNullCharacter(this.currentCharacterToken);break;case o.TokenType.WHITESPACE_CHARACTER:this.handler.onWhitespaceCharacter(this.currentCharacterToken)}this.currentCharacterToken=null}}_emitEOFToken(){const e=this.getCurrentLocation(0);e&&(e.endLine=e.startLine,e.endCol=e.startCol,e.endOffset=e.startOffset),this._emitCurrentCharacterToken(e),this.handler.onEof({type:o.TokenType.EOF,location:e}),this.active=!1}_appendCharToCurrentCharacterToken(e,t){if(this.currentCharacterToken){if(this.currentCharacterToken.type===e)return void(this.currentCharacterToken.chars+=t);this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk()}this._createCharacterToken(e,t)}_emitCodePoint(e){const t=v(e)?o.TokenType.WHITESPACE_CHARACTER:e===i.CODE_POINTS.NULL?o.TokenType.NULL_CHARACTER:o.TokenType.CHARACTER;this._appendCharToCurrentCharacterToken(t,String.fromCodePoint(e))}_emitChars(e){this._appendCharToCurrentCharacterToken(o.TokenType.CHARACTER,e)}_matchNamedCharacterReference(e){let t=null,n=0,r=!1;for(let a=0,c=s.htmlDecodeTree[0];a>=0&&(a=(0,s.determineBranch)(s.htmlDecodeTree,c,a+1,e),!(a<0));e=this._consume()){n+=1,c=s.htmlDecodeTree[a];const l=c&s.BinTrieFlags.VALUE_LENGTH;if(l){const c=(l>>14)-1;if(e!==i.CODE_POINTS.SEMICOLON&&this._isCharacterReferenceInAttribute()&&((o=this.preprocessor.peek(1))===i.CODE_POINTS.EQUALS_SIGN||p(o))?(t=[i.CODE_POINTS.AMPERSAND],a+=c):(t=0===c?[s.htmlDecodeTree[a]&~s.BinTrieFlags.VALUE_LENGTH]:1===c?[s.htmlDecodeTree[++a]]:[s.htmlDecodeTree[++a],s.htmlDecodeTree[++a]],n=0,r=e!==i.CODE_POINTS.SEMICOLON),0===c){this._consume();break}}}var o;return this._unconsume(n),r&&!this.preprocessor.endOfChunkHit&&this._err(a.ERR.missingSemicolonAfterCharacterReference),this._unconsume(1),t}_isCharacterReferenceInAttribute(){return this.returnState===u.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===u.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===u.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(e){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(e):this._emitCodePoint(e)}_callState(e){switch(this.state){case u.DATA:this._stateData(e);break;case u.RCDATA:this._stateRcdata(e);break;case u.RAWTEXT:this._stateRawtext(e);break;case u.SCRIPT_DATA:this._stateScriptData(e);break;case u.PLAINTEXT:this._statePlaintext(e);break;case u.TAG_OPEN:this._stateTagOpen(e);break;case u.END_TAG_OPEN:this._stateEndTagOpen(e);break;case u.TAG_NAME:this._stateTagName(e);break;case u.RCDATA_LESS_THAN_SIGN:this._stateRcdataLessThanSign(e);break;case u.RCDATA_END_TAG_OPEN:this._stateRcdataEndTagOpen(e);break;case u.RCDATA_END_TAG_NAME:this._stateRcdataEndTagName(e);break;case u.RAWTEXT_LESS_THAN_SIGN:this._stateRawtextLessThanSign(e);break;case u.RAWTEXT_END_TAG_OPEN:this._stateRawtextEndTagOpen(e);break;case u.RAWTEXT_END_TAG_NAME:this._stateRawtextEndTagName(e);break;case u.SCRIPT_DATA_LESS_THAN_SIGN:this._stateScriptDataLessThanSign(e);break;case u.SCRIPT_DATA_END_TAG_OPEN:this._stateScriptDataEndTagOpen(e);break;case u.SCRIPT_DATA_END_TAG_NAME:this._stateScriptDataEndTagName(e);break;case u.SCRIPT_DATA_ESCAPE_START:this._stateScriptDataEscapeStart(e);break;case u.SCRIPT_DATA_ESCAPE_START_DASH:this._stateScriptDataEscapeStartDash(e);break;case u.SCRIPT_DATA_ESCAPED:this._stateScriptDataEscaped(e);break;case u.SCRIPT_DATA_ESCAPED_DASH:this._stateScriptDataEscapedDash(e);break;case u.SCRIPT_DATA_ESCAPED_DASH_DASH:this._stateScriptDataEscapedDashDash(e);break;case u.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:this._stateScriptDataEscapedLessThanSign(e);break;case u.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:this._stateScriptDataEscapedEndTagOpen(e);break;case u.SCRIPT_DATA_ESCAPED_END_TAG_NAME:this._stateScriptDataEscapedEndTagName(e);break;case u.SCRIPT_DATA_DOUBLE_ESCAPE_START:this._stateScriptDataDoubleEscapeStart(e);break;case u.SCRIPT_DATA_DOUBLE_ESCAPED:this._stateScriptDataDoubleEscaped(e);break;case u.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:this._stateScriptDataDoubleEscapedDash(e);break;case u.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:this._stateScriptDataDoubleEscapedDashDash(e);break;case u.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:this._stateScriptDataDoubleEscapedLessThanSign(e);break;case u.SCRIPT_DATA_DOUBLE_ESCAPE_END:this._stateScriptDataDoubleEscapeEnd(e);break;case u.BEFORE_ATTRIBUTE_NAME:this._stateBeforeAttributeName(e);break;case u.ATTRIBUTE_NAME:this._stateAttributeName(e);break;case u.AFTER_ATTRIBUTE_NAME:this._stateAfterAttributeName(e);break;case u.BEFORE_ATTRIBUTE_VALUE:this._stateBeforeAttributeValue(e);break;case u.ATTRIBUTE_VALUE_DOUBLE_QUOTED:this._stateAttributeValueDoubleQuoted(e);break;case u.ATTRIBUTE_VALUE_SINGLE_QUOTED:this._stateAttributeValueSingleQuoted(e);break;case u.ATTRIBUTE_VALUE_UNQUOTED:this._stateAttributeValueUnquoted(e);break;case u.AFTER_ATTRIBUTE_VALUE_QUOTED:this._stateAfterAttributeValueQuoted(e);break;case u.SELF_CLOSING_START_TAG:this._stateSelfClosingStartTag(e);break;case u.BOGUS_COMMENT:this._stateBogusComment(e);break;case u.MARKUP_DECLARATION_OPEN:this._stateMarkupDeclarationOpen(e);break;case u.COMMENT_START:this._stateCommentStart(e);break;case u.COMMENT_START_DASH:this._stateCommentStartDash(e);break;case u.COMMENT:this._stateComment(e);break;case u.COMMENT_LESS_THAN_SIGN:this._stateCommentLessThanSign(e);break;case u.COMMENT_LESS_THAN_SIGN_BANG:this._stateCommentLessThanSignBang(e);break;case u.COMMENT_LESS_THAN_SIGN_BANG_DASH:this._stateCommentLessThanSignBangDash(e);break;case u.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:this._stateCommentLessThanSignBangDashDash(e);break;case u.COMMENT_END_DASH:this._stateCommentEndDash(e);break;case u.COMMENT_END:this._stateCommentEnd(e);break;case u.COMMENT_END_BANG:this._stateCommentEndBang(e);break;case u.DOCTYPE:this._stateDoctype(e);break;case u.BEFORE_DOCTYPE_NAME:this._stateBeforeDoctypeName(e);break;case u.DOCTYPE_NAME:this._stateDoctypeName(e);break;case u.AFTER_DOCTYPE_NAME:this._stateAfterDoctypeName(e);break;case u.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._stateAfterDoctypePublicKeyword(e);break;case u.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:this._stateBeforeDoctypePublicIdentifier(e);break;case u.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:this._stateDoctypePublicIdentifierDoubleQuoted(e);break;case u.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:this._stateDoctypePublicIdentifierSingleQuoted(e);break;case u.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:this._stateAfterDoctypePublicIdentifier(e);break;case u.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:this._stateBetweenDoctypePublicAndSystemIdentifiers(e);break;case u.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._stateAfterDoctypeSystemKeyword(e);break;case u.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:this._stateBeforeDoctypeSystemIdentifier(e);break;case u.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:this._stateDoctypeSystemIdentifierDoubleQuoted(e);break;case u.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:this._stateDoctypeSystemIdentifierSingleQuoted(e);break;case u.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:this._stateAfterDoctypeSystemIdentifier(e);break;case u.BOGUS_DOCTYPE:this._stateBogusDoctype(e);break;case u.CDATA_SECTION:this._stateCdataSection(e);break;case u.CDATA_SECTION_BRACKET:this._stateCdataSectionBracket(e);break;case u.CDATA_SECTION_END:this._stateCdataSectionEnd(e);break;case u.CHARACTER_REFERENCE:this._stateCharacterReference(e);break;case u.NAMED_CHARACTER_REFERENCE:this._stateNamedCharacterReference(e);break;case u.AMBIGUOUS_AMPERSAND:this._stateAmbiguousAmpersand(e);break;case u.NUMERIC_CHARACTER_REFERENCE:this._stateNumericCharacterReference(e);break;case u.HEXADEMICAL_CHARACTER_REFERENCE_START:this._stateHexademicalCharacterReferenceStart(e);break;case u.HEXADEMICAL_CHARACTER_REFERENCE:this._stateHexademicalCharacterReference(e);break;case u.DECIMAL_CHARACTER_REFERENCE:this._stateDecimalCharacterReference(e);break;case u.NUMERIC_CHARACTER_REFERENCE_END:this._stateNumericCharacterReferenceEnd(e);break;default:throw new Error("Unknown state")}}_stateData(e){switch(e){case i.CODE_POINTS.LESS_THAN_SIGN:this.state=u.TAG_OPEN;break;case i.CODE_POINTS.AMPERSAND:this.returnState=u.DATA,this.state=u.CHARACTER_REFERENCE;break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),this._emitCodePoint(e);break;case i.CODE_POINTS.EOF:this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateRcdata(e){switch(e){case i.CODE_POINTS.AMPERSAND:this.returnState=u.RCDATA,this.state=u.CHARACTER_REFERENCE;break;case i.CODE_POINTS.LESS_THAN_SIGN:this.state=u.RCDATA_LESS_THAN_SIGN;break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),this._emitChars(i.REPLACEMENT_CHARACTER);break;case i.CODE_POINTS.EOF:this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateRawtext(e){switch(e){case i.CODE_POINTS.LESS_THAN_SIGN:this.state=u.RAWTEXT_LESS_THAN_SIGN;break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),this._emitChars(i.REPLACEMENT_CHARACTER);break;case i.CODE_POINTS.EOF:this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateScriptData(e){switch(e){case i.CODE_POINTS.LESS_THAN_SIGN:this.state=u.SCRIPT_DATA_LESS_THAN_SIGN;break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),this._emitChars(i.REPLACEMENT_CHARACTER);break;case i.CODE_POINTS.EOF:this._emitEOFToken();break;default:this._emitCodePoint(e)}}_statePlaintext(e){switch(e){case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),this._emitChars(i.REPLACEMENT_CHARACTER);break;case i.CODE_POINTS.EOF:this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateTagOpen(e){if(f(e))this._createStartTagToken(),this.state=u.TAG_NAME,this._stateTagName(e);else switch(e){case i.CODE_POINTS.EXCLAMATION_MARK:this.state=u.MARKUP_DECLARATION_OPEN;break;case i.CODE_POINTS.SOLIDUS:this.state=u.END_TAG_OPEN;break;case i.CODE_POINTS.QUESTION_MARK:this._err(a.ERR.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=u.BOGUS_COMMENT,this._stateBogusComment(e);break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break;default:this._err(a.ERR.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=u.DATA,this._stateData(e)}}_stateEndTagOpen(e){if(f(e))this._createEndTagToken(),this.state=u.TAG_NAME,this._stateTagName(e);else switch(e){case i.CODE_POINTS.GREATER_THAN_SIGN:this._err(a.ERR.missingEndTagName),this.state=u.DATA;break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break;default:this._err(a.ERR.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=u.BOGUS_COMMENT,this._stateBogusComment(e)}}_stateTagName(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:this.state=u.BEFORE_ATTRIBUTE_NAME;break;case i.CODE_POINTS.SOLIDUS:this.state=u.SELF_CLOSING_START_TAG;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this.state=u.DATA,this.emitCurrentTagToken();break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),t.tagName+=i.REPLACEMENT_CHARACTER;break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInTag),this._emitEOFToken();break;default:t.tagName+=String.fromCodePoint(h(e)?y(e):e)}}_stateRcdataLessThanSign(e){e===i.CODE_POINTS.SOLIDUS?this.state=u.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=u.RCDATA,this._stateRcdata(e))}_stateRcdataEndTagOpen(e){f(e)?(this.state=u.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(e)):(this._emitChars("</"),this.state=u.RCDATA,this._stateRcdata(e))}handleSpecialEndTag(e){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();this.currentToken.tagName=this.lastStartTagName;switch(this.preprocessor.peek(this.lastStartTagName.length)){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=u.BEFORE_ATTRIBUTE_NAME,!1;case i.CODE_POINTS.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=u.SELF_CLOSING_START_TAG,!1;case i.CODE_POINTS.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=u.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=u.RCDATA,this._stateRcdata(e))}_stateRawtextLessThanSign(e){e===i.CODE_POINTS.SOLIDUS?this.state=u.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=u.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagOpen(e){f(e)?(this.state=u.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(e)):(this._emitChars("</"),this.state=u.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=u.RAWTEXT,this._stateRawtext(e))}_stateScriptDataLessThanSign(e){switch(e){case i.CODE_POINTS.SOLIDUS:this.state=u.SCRIPT_DATA_END_TAG_OPEN;break;case i.CODE_POINTS.EXCLAMATION_MARK:this.state=u.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break;default:this._emitChars("<"),this.state=u.SCRIPT_DATA,this._stateScriptData(e)}}_stateScriptDataEndTagOpen(e){f(e)?(this.state=u.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(e)):(this._emitChars("</"),this.state=u.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=u.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStart(e){e===i.CODE_POINTS.HYPHEN_MINUS?(this.state=u.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=u.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStartDash(e){e===i.CODE_POINTS.HYPHEN_MINUS?(this.state=u.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=u.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscaped(e){switch(e){case i.CODE_POINTS.HYPHEN_MINUS:this.state=u.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break;case i.CODE_POINTS.LESS_THAN_SIGN:this.state=u.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),this._emitChars(i.REPLACEMENT_CHARACTER);break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateScriptDataEscapedDash(e){switch(e){case i.CODE_POINTS.HYPHEN_MINUS:this.state=u.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break;case i.CODE_POINTS.LESS_THAN_SIGN:this.state=u.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),this.state=u.SCRIPT_DATA_ESCAPED,this._emitChars(i.REPLACEMENT_CHARACTER);break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break;default:this.state=u.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedDashDash(e){switch(e){case i.CODE_POINTS.HYPHEN_MINUS:this._emitChars("-");break;case i.CODE_POINTS.LESS_THAN_SIGN:this.state=u.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this.state=u.SCRIPT_DATA,this._emitChars(">");break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),this.state=u.SCRIPT_DATA_ESCAPED,this._emitChars(i.REPLACEMENT_CHARACTER);break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break;default:this.state=u.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedLessThanSign(e){e===i.CODE_POINTS.SOLIDUS?this.state=u.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:f(e)?(this._emitChars("<"),this.state=u.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(e)):(this._emitChars("<"),this.state=u.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagOpen(e){f(e)?(this.state=u.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(e)):(this._emitChars("</"),this.state=u.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=u.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscapeStart(e){if(this.preprocessor.startsWith(i.SEQUENCES.SCRIPT,!1)&&b(this.preprocessor.peek(i.SEQUENCES.SCRIPT.length))){this._emitCodePoint(e);for(let e=0;e<i.SEQUENCES.SCRIPT.length;e++)this._emitCodePoint(this._consume());this.state=u.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=u.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscaped(e){switch(e){case i.CODE_POINTS.HYPHEN_MINUS:this.state=u.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break;case i.CODE_POINTS.LESS_THAN_SIGN:this.state=u.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),this._emitChars(i.REPLACEMENT_CHARACTER);break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDash(e){switch(e){case i.CODE_POINTS.HYPHEN_MINUS:this.state=u.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break;case i.CODE_POINTS.LESS_THAN_SIGN:this.state=u.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),this.state=u.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(i.REPLACEMENT_CHARACTER);break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break;default:this.state=u.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDashDash(e){switch(e){case i.CODE_POINTS.HYPHEN_MINUS:this._emitChars("-");break;case i.CODE_POINTS.LESS_THAN_SIGN:this.state=u.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break;case i.CODE_POINTS.GREATER_THAN_SIGN:this.state=u.SCRIPT_DATA,this._emitChars(">");break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),this.state=u.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(i.REPLACEMENT_CHARACTER);break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break;default:this.state=u.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedLessThanSign(e){e===i.CODE_POINTS.SOLIDUS?(this.state=u.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=u.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateScriptDataDoubleEscapeEnd(e){if(this.preprocessor.startsWith(i.SEQUENCES.SCRIPT,!1)&&b(this.preprocessor.peek(i.SEQUENCES.SCRIPT.length))){this._emitCodePoint(e);for(let e=0;e<i.SEQUENCES.SCRIPT.length;e++)this._emitCodePoint(this._consume());this.state=u.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=u.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateBeforeAttributeName(e){switch(e){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:break;case i.CODE_POINTS.SOLIDUS:case i.CODE_POINTS.GREATER_THAN_SIGN:case i.CODE_POINTS.EOF:this.state=u.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break;case i.CODE_POINTS.EQUALS_SIGN:this._err(a.ERR.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=u.ATTRIBUTE_NAME;break;default:this._createAttr(""),this.state=u.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateAttributeName(e){switch(e){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:case i.CODE_POINTS.SOLIDUS:case i.CODE_POINTS.GREATER_THAN_SIGN:case i.CODE_POINTS.EOF:this._leaveAttrName(),this.state=u.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break;case i.CODE_POINTS.EQUALS_SIGN:this._leaveAttrName(),this.state=u.BEFORE_ATTRIBUTE_VALUE;break;case i.CODE_POINTS.QUOTATION_MARK:case i.CODE_POINTS.APOSTROPHE:case i.CODE_POINTS.LESS_THAN_SIGN:this._err(a.ERR.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(e);break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),this.currentAttr.name+=i.REPLACEMENT_CHARACTER;break;default:this.currentAttr.name+=String.fromCodePoint(h(e)?y(e):e)}}_stateAfterAttributeName(e){switch(e){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:break;case i.CODE_POINTS.SOLIDUS:this.state=u.SELF_CLOSING_START_TAG;break;case i.CODE_POINTS.EQUALS_SIGN:this.state=u.BEFORE_ATTRIBUTE_VALUE;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this.state=u.DATA,this.emitCurrentTagToken();break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInTag),this._emitEOFToken();break;default:this._createAttr(""),this.state=u.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateBeforeAttributeValue(e){switch(e){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:break;case i.CODE_POINTS.QUOTATION_MARK:this.state=u.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break;case i.CODE_POINTS.APOSTROPHE:this.state=u.ATTRIBUTE_VALUE_SINGLE_QUOTED;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this._err(a.ERR.missingAttributeValue),this.state=u.DATA,this.emitCurrentTagToken();break;default:this.state=u.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(e)}}_stateAttributeValueDoubleQuoted(e){switch(e){case i.CODE_POINTS.QUOTATION_MARK:this.state=u.AFTER_ATTRIBUTE_VALUE_QUOTED;break;case i.CODE_POINTS.AMPERSAND:this.returnState=u.ATTRIBUTE_VALUE_DOUBLE_QUOTED,this.state=u.CHARACTER_REFERENCE;break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),this.currentAttr.value+=i.REPLACEMENT_CHARACTER;break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInTag),this._emitEOFToken();break;default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueSingleQuoted(e){switch(e){case i.CODE_POINTS.APOSTROPHE:this.state=u.AFTER_ATTRIBUTE_VALUE_QUOTED;break;case i.CODE_POINTS.AMPERSAND:this.returnState=u.ATTRIBUTE_VALUE_SINGLE_QUOTED,this.state=u.CHARACTER_REFERENCE;break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),this.currentAttr.value+=i.REPLACEMENT_CHARACTER;break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInTag),this._emitEOFToken();break;default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueUnquoted(e){switch(e){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:this._leaveAttrValue(),this.state=u.BEFORE_ATTRIBUTE_NAME;break;case i.CODE_POINTS.AMPERSAND:this.returnState=u.ATTRIBUTE_VALUE_UNQUOTED,this.state=u.CHARACTER_REFERENCE;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this._leaveAttrValue(),this.state=u.DATA,this.emitCurrentTagToken();break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),this.currentAttr.value+=i.REPLACEMENT_CHARACTER;break;case i.CODE_POINTS.QUOTATION_MARK:case i.CODE_POINTS.APOSTROPHE:case i.CODE_POINTS.LESS_THAN_SIGN:case i.CODE_POINTS.EQUALS_SIGN:case i.CODE_POINTS.GRAVE_ACCENT:this._err(a.ERR.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(e);break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInTag),this._emitEOFToken();break;default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAfterAttributeValueQuoted(e){switch(e){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:this._leaveAttrValue(),this.state=u.BEFORE_ATTRIBUTE_NAME;break;case i.CODE_POINTS.SOLIDUS:this._leaveAttrValue(),this.state=u.SELF_CLOSING_START_TAG;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this._leaveAttrValue(),this.state=u.DATA,this.emitCurrentTagToken();break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInTag),this._emitEOFToken();break;default:this._err(a.ERR.missingWhitespaceBetweenAttributes),this.state=u.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateSelfClosingStartTag(e){switch(e){case i.CODE_POINTS.GREATER_THAN_SIGN:this.currentToken.selfClosing=!0,this.state=u.DATA,this.emitCurrentTagToken();break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInTag),this._emitEOFToken();break;default:this._err(a.ERR.unexpectedSolidusInTag),this.state=u.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateBogusComment(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.GREATER_THAN_SIGN:this.state=u.DATA,this.emitCurrentComment(t);break;case i.CODE_POINTS.EOF:this.emitCurrentComment(t),this._emitEOFToken();break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),t.data+=i.REPLACEMENT_CHARACTER;break;default:t.data+=String.fromCodePoint(e)}}_stateMarkupDeclarationOpen(e){this._consumeSequenceIfMatch(i.SEQUENCES.DASH_DASH,!0)?(this._createCommentToken(i.SEQUENCES.DASH_DASH.length+1),this.state=u.COMMENT_START):this._consumeSequenceIfMatch(i.SEQUENCES.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(i.SEQUENCES.DOCTYPE.length+1),this.state=u.DOCTYPE):this._consumeSequenceIfMatch(i.SEQUENCES.CDATA_START,!0)?this.inForeignNode?this.state=u.CDATA_SECTION:(this._err(a.ERR.cdataInHtmlContent),this._createCommentToken(i.SEQUENCES.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=u.BOGUS_COMMENT):this._ensureHibernation()||(this._err(a.ERR.incorrectlyOpenedComment),this._createCommentToken(2),this.state=u.BOGUS_COMMENT,this._stateBogusComment(e))}_stateCommentStart(e){switch(e){case i.CODE_POINTS.HYPHEN_MINUS:this.state=u.COMMENT_START_DASH;break;case i.CODE_POINTS.GREATER_THAN_SIGN:{this._err(a.ERR.abruptClosingOfEmptyComment),this.state=u.DATA;const e=this.currentToken;this.emitCurrentComment(e);break}default:this.state=u.COMMENT,this._stateComment(e)}}_stateCommentStartDash(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.HYPHEN_MINUS:this.state=u.COMMENT_END;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this._err(a.ERR.abruptClosingOfEmptyComment),this.state=u.DATA,this.emitCurrentComment(t);break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInComment),this.emitCurrentComment(t),this._emitEOFToken();break;default:t.data+="-",this.state=u.COMMENT,this._stateComment(e)}}_stateComment(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.HYPHEN_MINUS:this.state=u.COMMENT_END_DASH;break;case i.CODE_POINTS.LESS_THAN_SIGN:t.data+="<",this.state=u.COMMENT_LESS_THAN_SIGN;break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),t.data+=i.REPLACEMENT_CHARACTER;break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInComment),this.emitCurrentComment(t),this._emitEOFToken();break;default:t.data+=String.fromCodePoint(e)}}_stateCommentLessThanSign(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.EXCLAMATION_MARK:t.data+="!",this.state=u.COMMENT_LESS_THAN_SIGN_BANG;break;case i.CODE_POINTS.LESS_THAN_SIGN:t.data+="<";break;default:this.state=u.COMMENT,this._stateComment(e)}}_stateCommentLessThanSignBang(e){e===i.CODE_POINTS.HYPHEN_MINUS?this.state=u.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=u.COMMENT,this._stateComment(e))}_stateCommentLessThanSignBangDash(e){e===i.CODE_POINTS.HYPHEN_MINUS?this.state=u.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=u.COMMENT_END_DASH,this._stateCommentEndDash(e))}_stateCommentLessThanSignBangDashDash(e){e!==i.CODE_POINTS.GREATER_THAN_SIGN&&e!==i.CODE_POINTS.EOF&&this._err(a.ERR.nestedComment),this.state=u.COMMENT_END,this._stateCommentEnd(e)}_stateCommentEndDash(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.HYPHEN_MINUS:this.state=u.COMMENT_END;break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInComment),this.emitCurrentComment(t),this._emitEOFToken();break;default:t.data+="-",this.state=u.COMMENT,this._stateComment(e)}}_stateCommentEnd(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.GREATER_THAN_SIGN:this.state=u.DATA,this.emitCurrentComment(t);break;case i.CODE_POINTS.EXCLAMATION_MARK:this.state=u.COMMENT_END_BANG;break;case i.CODE_POINTS.HYPHEN_MINUS:t.data+="-";break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInComment),this.emitCurrentComment(t),this._emitEOFToken();break;default:t.data+="--",this.state=u.COMMENT,this._stateComment(e)}}_stateCommentEndBang(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.HYPHEN_MINUS:t.data+="--!",this.state=u.COMMENT_END_DASH;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this._err(a.ERR.incorrectlyClosedComment),this.state=u.DATA,this.emitCurrentComment(t);break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInComment),this.emitCurrentComment(t),this._emitEOFToken();break;default:t.data+="--!",this.state=u.COMMENT,this._stateComment(e)}}_stateDoctype(e){switch(e){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:this.state=u.BEFORE_DOCTYPE_NAME;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this.state=u.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e);break;case i.CODE_POINTS.EOF:{this._err(a.ERR.eofInDoctype),this._createDoctypeToken(null);const e=this.currentToken;e.forceQuirks=!0,this.emitCurrentDoctype(e),this._emitEOFToken();break}default:this._err(a.ERR.missingWhitespaceBeforeDoctypeName),this.state=u.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e)}}_stateBeforeDoctypeName(e){if(h(e))this._createDoctypeToken(String.fromCharCode(y(e))),this.state=u.DOCTYPE_NAME;else switch(e){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),this._createDoctypeToken(i.REPLACEMENT_CHARACTER),this.state=u.DOCTYPE_NAME;break;case i.CODE_POINTS.GREATER_THAN_SIGN:{this._err(a.ERR.missingDoctypeName),this._createDoctypeToken(null);const e=this.currentToken;e.forceQuirks=!0,this.emitCurrentDoctype(e),this.state=u.DATA;break}case i.CODE_POINTS.EOF:{this._err(a.ERR.eofInDoctype),this._createDoctypeToken(null);const e=this.currentToken;e.forceQuirks=!0,this.emitCurrentDoctype(e),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(e)),this.state=u.DOCTYPE_NAME}}_stateDoctypeName(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:this.state=u.AFTER_DOCTYPE_NAME;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this.state=u.DATA,this.emitCurrentDoctype(t);break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),t.name+=i.REPLACEMENT_CHARACTER;break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:t.name+=String.fromCodePoint(h(e)?y(e):e)}}_stateAfterDoctypeName(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:break;case i.CODE_POINTS.GREATER_THAN_SIGN:this.state=u.DATA,this.emitCurrentDoctype(t);break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:this._consumeSequenceIfMatch(i.SEQUENCES.PUBLIC,!1)?this.state=u.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(i.SEQUENCES.SYSTEM,!1)?this.state=u.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(a.ERR.invalidCharacterSequenceAfterDoctypeName),t.forceQuirks=!0,this.state=u.BOGUS_DOCTYPE,this._stateBogusDoctype(e))}}_stateAfterDoctypePublicKeyword(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:this.state=u.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break;case i.CODE_POINTS.QUOTATION_MARK:this._err(a.ERR.missingWhitespaceAfterDoctypePublicKeyword),t.publicId="",this.state=u.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break;case i.CODE_POINTS.APOSTROPHE:this._err(a.ERR.missingWhitespaceAfterDoctypePublicKeyword),t.publicId="",this.state=u.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this._err(a.ERR.missingDoctypePublicIdentifier),t.forceQuirks=!0,this.state=u.DATA,this.emitCurrentDoctype(t);break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:this._err(a.ERR.missingQuoteBeforeDoctypePublicIdentifier),t.forceQuirks=!0,this.state=u.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypePublicIdentifier(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:break;case i.CODE_POINTS.QUOTATION_MARK:t.publicId="",this.state=u.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break;case i.CODE_POINTS.APOSTROPHE:t.publicId="",this.state=u.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this._err(a.ERR.missingDoctypePublicIdentifier),t.forceQuirks=!0,this.state=u.DATA,this.emitCurrentDoctype(t);break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:this._err(a.ERR.missingQuoteBeforeDoctypePublicIdentifier),t.forceQuirks=!0,this.state=u.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypePublicIdentifierDoubleQuoted(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.QUOTATION_MARK:this.state=u.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),t.publicId+=i.REPLACEMENT_CHARACTER;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this._err(a.ERR.abruptDoctypePublicIdentifier),t.forceQuirks=!0,this.emitCurrentDoctype(t),this.state=u.DATA;break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:t.publicId+=String.fromCodePoint(e)}}_stateDoctypePublicIdentifierSingleQuoted(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.APOSTROPHE:this.state=u.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),t.publicId+=i.REPLACEMENT_CHARACTER;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this._err(a.ERR.abruptDoctypePublicIdentifier),t.forceQuirks=!0,this.emitCurrentDoctype(t),this.state=u.DATA;break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:t.publicId+=String.fromCodePoint(e)}}_stateAfterDoctypePublicIdentifier(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:this.state=u.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this.state=u.DATA,this.emitCurrentDoctype(t);break;case i.CODE_POINTS.QUOTATION_MARK:this._err(a.ERR.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),t.systemId="",this.state=u.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break;case i.CODE_POINTS.APOSTROPHE:this._err(a.ERR.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),t.systemId="",this.state=u.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:this._err(a.ERR.missingQuoteBeforeDoctypeSystemIdentifier),t.forceQuirks=!0,this.state=u.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBetweenDoctypePublicAndSystemIdentifiers(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:break;case i.CODE_POINTS.GREATER_THAN_SIGN:this.emitCurrentDoctype(t),this.state=u.DATA;break;case i.CODE_POINTS.QUOTATION_MARK:t.systemId="",this.state=u.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break;case i.CODE_POINTS.APOSTROPHE:t.systemId="",this.state=u.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:this._err(a.ERR.missingQuoteBeforeDoctypeSystemIdentifier),t.forceQuirks=!0,this.state=u.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateAfterDoctypeSystemKeyword(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:this.state=u.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break;case i.CODE_POINTS.QUOTATION_MARK:this._err(a.ERR.missingWhitespaceAfterDoctypeSystemKeyword),t.systemId="",this.state=u.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break;case i.CODE_POINTS.APOSTROPHE:this._err(a.ERR.missingWhitespaceAfterDoctypeSystemKeyword),t.systemId="",this.state=u.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this._err(a.ERR.missingDoctypeSystemIdentifier),t.forceQuirks=!0,this.state=u.DATA,this.emitCurrentDoctype(t);break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:this._err(a.ERR.missingQuoteBeforeDoctypeSystemIdentifier),t.forceQuirks=!0,this.state=u.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypeSystemIdentifier(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:break;case i.CODE_POINTS.QUOTATION_MARK:t.systemId="",this.state=u.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break;case i.CODE_POINTS.APOSTROPHE:t.systemId="",this.state=u.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this._err(a.ERR.missingDoctypeSystemIdentifier),t.forceQuirks=!0,this.state=u.DATA,this.emitCurrentDoctype(t);break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:this._err(a.ERR.missingQuoteBeforeDoctypeSystemIdentifier),t.forceQuirks=!0,this.state=u.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypeSystemIdentifierDoubleQuoted(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.QUOTATION_MARK:this.state=u.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),t.systemId+=i.REPLACEMENT_CHARACTER;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this._err(a.ERR.abruptDoctypeSystemIdentifier),t.forceQuirks=!0,this.emitCurrentDoctype(t),this.state=u.DATA;break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:t.systemId+=String.fromCodePoint(e)}}_stateDoctypeSystemIdentifierSingleQuoted(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.APOSTROPHE:this.state=u.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter),t.systemId+=i.REPLACEMENT_CHARACTER;break;case i.CODE_POINTS.GREATER_THAN_SIGN:this._err(a.ERR.abruptDoctypeSystemIdentifier),t.forceQuirks=!0,this.emitCurrentDoctype(t),this.state=u.DATA;break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:t.systemId+=String.fromCodePoint(e)}}_stateAfterDoctypeSystemIdentifier(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.SPACE:case i.CODE_POINTS.LINE_FEED:case i.CODE_POINTS.TABULATION:case i.CODE_POINTS.FORM_FEED:break;case i.CODE_POINTS.GREATER_THAN_SIGN:this.emitCurrentDoctype(t),this.state=u.DATA;break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInDoctype),t.forceQuirks=!0,this.emitCurrentDoctype(t),this._emitEOFToken();break;default:this._err(a.ERR.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=u.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBogusDoctype(e){const t=this.currentToken;switch(e){case i.CODE_POINTS.GREATER_THAN_SIGN:this.emitCurrentDoctype(t),this.state=u.DATA;break;case i.CODE_POINTS.NULL:this._err(a.ERR.unexpectedNullCharacter);break;case i.CODE_POINTS.EOF:this.emitCurrentDoctype(t),this._emitEOFToken()}}_stateCdataSection(e){switch(e){case i.CODE_POINTS.RIGHT_SQUARE_BRACKET:this.state=u.CDATA_SECTION_BRACKET;break;case i.CODE_POINTS.EOF:this._err(a.ERR.eofInCdata),this._emitEOFToken();break;default:this._emitCodePoint(e)}}_stateCdataSectionBracket(e){e===i.CODE_POINTS.RIGHT_SQUARE_BRACKET?this.state=u.CDATA_SECTION_END:(this._emitChars("]"),this.state=u.CDATA_SECTION,this._stateCdataSection(e))}_stateCdataSectionEnd(e){switch(e){case i.CODE_POINTS.GREATER_THAN_SIGN:this.state=u.DATA;break;case i.CODE_POINTS.RIGHT_SQUARE_BRACKET:this._emitChars("]");break;default:this._emitChars("]]"),this.state=u.CDATA_SECTION,this._stateCdataSection(e)}}_stateCharacterReference(e){e===i.CODE_POINTS.NUMBER_SIGN?this.state=u.NUMERIC_CHARACTER_REFERENCE:p(e)?(this.state=u.NAMED_CHARACTER_REFERENCE,this._stateNamedCharacterReference(e)):(this._flushCodePointConsumedAsCharacterReference(i.CODE_POINTS.AMPERSAND),this._reconsumeInState(this.returnState,e))}_stateNamedCharacterReference(e){const t=this._matchNamedCharacterReference(e);if(this._ensureHibernation());else if(t){for(let e=0;e<t.length;e++)this._flushCodePointConsumedAsCharacterReference(t[e]);this.state=this.returnState}else this._flushCodePointConsumedAsCharacterReference(i.CODE_POINTS.AMPERSAND),this.state=u.AMBIGUOUS_AMPERSAND}_stateAmbiguousAmpersand(e){p(e)?this._flushCodePointConsumedAsCharacterReference(e):(e===i.CODE_POINTS.SEMICOLON&&this._err(a.ERR.unknownNamedCharacterReference),this._reconsumeInState(this.returnState,e))}_stateNumericCharacterReference(e){this.charRefCode=0,e===i.CODE_POINTS.LATIN_SMALL_X||e===i.CODE_POINTS.LATIN_CAPITAL_X?this.state=u.HEXADEMICAL_CHARACTER_REFERENCE_START:d(e)?(this.state=u.DECIMAL_CHARACTER_REFERENCE,this._stateDecimalCharacterReference(e)):(this._err(a.ERR.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(i.CODE_POINTS.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(i.CODE_POINTS.NUMBER_SIGN),this._reconsumeInState(this.returnState,e))}_stateHexademicalCharacterReferenceStart(e){!function(e){return d(e)||g(e)||m(e)}(e)?(this._err(a.ERR.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(i.CODE_POINTS.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(i.CODE_POINTS.NUMBER_SIGN),this._unconsume(2),this.state=this.returnState):(this.state=u.HEXADEMICAL_CHARACTER_REFERENCE,this._stateHexademicalCharacterReference(e))}_stateHexademicalCharacterReference(e){g(e)?this.charRefCode=16*this.charRefCode+e-55:m(e)?this.charRefCode=16*this.charRefCode+e-87:d(e)?this.charRefCode=16*this.charRefCode+e-48:e===i.CODE_POINTS.SEMICOLON?this.state=u.NUMERIC_CHARACTER_REFERENCE_END:(this._err(a.ERR.missingSemicolonAfterCharacterReference),this.state=u.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd(e))}_stateDecimalCharacterReference(e){d(e)?this.charRefCode=10*this.charRefCode+e-48:e===i.CODE_POINTS.SEMICOLON?this.state=u.NUMERIC_CHARACTER_REFERENCE_END:(this._err(a.ERR.missingSemicolonAfterCharacterReference),this.state=u.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd(e))}_stateNumericCharacterReferenceEnd(e){if(this.charRefCode===i.CODE_POINTS.NULL)this._err(a.ERR.nullCharacterReference),this.charRefCode=i.CODE_POINTS.REPLACEMENT_CHARACTER;else if(this.charRefCode>1114111)this._err(a.ERR.characterReferenceOutsideUnicodeRange),this.charRefCode=i.CODE_POINTS.REPLACEMENT_CHARACTER;else if((0,i.isSurrogate)(this.charRefCode))this._err(a.ERR.surrogateCharacterReference),this.charRefCode=i.CODE_POINTS.REPLACEMENT_CHARACTER;else if((0,i.isUndefinedCodePoint)(this.charRefCode))this._err(a.ERR.noncharacterCharacterReference);else if((0,i.isControlCodePoint)(this.charRefCode)||this.charRefCode===i.CODE_POINTS.CARRIAGE_RETURN){this._err(a.ERR.controlCharacterReference);const e=l.get(this.charRefCode);void 0!==e&&(this.charRefCode=e)}this._flushCodePointConsumedAsCharacterReference(this.charRefCode),this._reconsumeInState(this.returnState,e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isIntegrationPoint=t.adjustTokenSVGTagName=t.adjustTokenXMLAttrs=t.adjustTokenSVGAttrs=t.adjustTokenMathMLAttrs=t.causesExit=t.SVG_TAG_NAMES_ADJUSTMENT_MAP=void 0;const r=n(732),i="text/html",o="application/xhtml+xml",s=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map((e=>[e.toLowerCase(),e]))),a=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:r.NS.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:r.NS.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:r.NS.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:r.NS.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:r.NS.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:r.NS.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:r.NS.XLINK}],["xml:base",{prefix:"xml",name:"base",namespace:r.NS.XML}],["xml:lang",{prefix:"xml",name:"lang",namespace:r.NS.XML}],["xml:space",{prefix:"xml",name:"space",namespace:r.NS.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:r.NS.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:r.NS.XMLNS}]]);t.SVG_TAG_NAMES_ADJUSTMENT_MAP=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map((e=>[e.toLowerCase(),e])));const c=new Set([r.TAG_ID.B,r.TAG_ID.BIG,r.TAG_ID.BLOCKQUOTE,r.TAG_ID.BODY,r.TAG_ID.BR,r.TAG_ID.CENTER,r.TAG_ID.CODE,r.TAG_ID.DD,r.TAG_ID.DIV,r.TAG_ID.DL,r.TAG_ID.DT,r.TAG_ID.EM,r.TAG_ID.EMBED,r.TAG_ID.H1,r.TAG_ID.H2,r.TAG_ID.H3,r.TAG_ID.H4,r.TAG_ID.H5,r.TAG_ID.H6,r.TAG_ID.HEAD,r.TAG_ID.HR,r.TAG_ID.I,r.TAG_ID.IMG,r.TAG_ID.LI,r.TAG_ID.LISTING,r.TAG_ID.MENU,r.TAG_ID.META,r.TAG_ID.NOBR,r.TAG_ID.OL,r.TAG_ID.P,r.TAG_ID.PRE,r.TAG_ID.RUBY,r.TAG_ID.S,r.TAG_ID.SMALL,r.TAG_ID.SPAN,r.TAG_ID.STRONG,r.TAG_ID.STRIKE,r.TAG_ID.SUB,r.TAG_ID.SUP,r.TAG_ID.TABLE,r.TAG_ID.TT,r.TAG_ID.U,r.TAG_ID.UL,r.TAG_ID.VAR]);t.causesExit=function(e){const t=e.tagID;return t===r.TAG_ID.FONT&&e.attrs.some((({name:e})=>e===r.ATTRS.COLOR||e===r.ATTRS.SIZE||e===r.ATTRS.FACE))||c.has(t)},t.adjustTokenMathMLAttrs=function(e){for(let t=0;t<e.attrs.length;t++)if("definitionurl"===e.attrs[t].name){e.attrs[t].name="definitionURL";break}},t.adjustTokenSVGAttrs=function(e){for(let t=0;t<e.attrs.length;t++){const n=s.get(e.attrs[t].name);null!=n&&(e.attrs[t].name=n)}},t.adjustTokenXMLAttrs=function(e){for(let t=0;t<e.attrs.length;t++){const n=a.get(e.attrs[t].name);n&&(e.attrs[t].prefix=n.prefix,e.attrs[t].name=n.name,e.attrs[t].namespace=n.namespace)}},t.adjustTokenSVGTagName=function(e){const n=t.SVG_TAG_NAMES_ADJUSTMENT_MAP.get(e.tagName);null!=n&&(e.tagName=n,e.tagID=(0,r.getTagID)(e.tagName))},t.isIntegrationPoint=function(e,t,n,s){return(!s||s===r.NS.HTML)&&function(e,t,n){if(t===r.NS.MATHML&&e===r.TAG_ID.ANNOTATION_XML)for(let e=0;e<n.length;e++)if(n[e].name===r.ATTRS.ENCODING){const t=n[e].value.toLowerCase();return t===i||t===o}return t===r.NS.SVG&&(e===r.TAG_ID.FOREIGN_OBJECT||e===r.TAG_ID.DESC||e===r.TAG_ID.TITLE)}(e,t,n)||(!s||s===r.NS.MATHML)&&function(e,t){return t===r.NS.MATHML&&(e===r.TAG_ID.MI||e===r.TAG_ID.MO||e===r.TAG_ID.MN||e===r.TAG_ID.MS||e===r.TAG_ID.MTEXT)}(e,t)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(693),i=n(66),o=n(30),s=n(201);function a(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new i.g("invalid-argument",`Invalid options passed to function ${e}(): You cannot specify both "merge" and "mergeFields".`);return t}function c(){if("undefined"==typeof Uint8Array)throw new i.g("unimplemented","Uint8Arrays are not available in this environment.")}function l(){if(!Object(i.r)())throw new i.g("unimplemented","Blobs are unavailable in Firestore in this environment.")}class u{constructor(e){this._delegate=e}static fromBase64String(e){return l(),new u(i.b.fromBase64String(e))}static fromUint8Array(e){return c(),new u(i.b.fromUint8Array(e))}toBase64(){return l(),this._delegate.toBase64()}toUint8Array(){return c(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function d(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of t)if(e in n&&"function"==typeof n[e])return!0;return!1}(e,["next","error","complete"])}class h{enableIndexedDbPersistence(e,t){return Object(i.F)(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return Object(i.G)(e._delegate)}clearIndexedDbPersistence(e){return Object(i.x)(e._delegate)}}class f{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof i.m||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();e.merge||t.host===e.host||Object(i.s)("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,n={}){Object(i.A)(this._delegate,e,t,n)}enableNetwork(){return Object(i.H)(this._delegate)}disableNetwork(){return Object(i.D)(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,Object(i.t)("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return Object(i.lb)(this._delegate)}onSnapshotsInSync(e){return Object(i.Y)(this._delegate,e)}get app(){if(!this._appCompat)throw new i.g("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new I(this,Object(i.y)(this._delegate,e))}catch(e){throw b(e,"collection()","Firestore.collection()")}}doc(e){try{return new v(this,Object(i.E)(this._delegate,e))}catch(e){throw b(e,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new A(this,Object(i.z)(this._delegate,e))}catch(e){throw b(e,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Object(i.db)(this._delegate,(t=>e(new g(this,t))))}batch(){return Object(i.K)(this._delegate),new m(new i.l(this._delegate,(e=>Object(i.L)(this._delegate,e))))}loadBundle(e){return Object(i.V)(this._delegate,e)}namedQuery(e){return Object(i.W)(this._delegate,e).then((e=>e?new A(this,e):null))}}class p extends i.a{constructor(e){super(),this.firestore=e}convertBytes(e){return new u(new i.b(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return v.forKey(t,this.firestore,null)}}class g{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new p(e)}get(e){const t=C(e);return this._delegate.get(t).then((e=>new T(this._firestore,new i.e(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,t.converter))))}set(e,t,n){const r=C(e);return n?(a("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const i=C(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){const t=C(e);return this._delegate.delete(t),this}}class m{constructor(e){this._delegate=e}set(e,t,n){const r=C(e);return n?(a("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const i=C(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){const t=C(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class y{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){const n=new i.i(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new E(this._firestore,n),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=y.INSTANCES;let r=n.get(e);r||(r=new WeakMap,n.set(e,r));let i=r.get(t);return i||(i=new y(e,new p(e),t),r.set(t,i)),i}}y.INSTANCES=new WeakMap;class v{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new p(e)}static forPath(e,t,n){if(e.length%2!=0)throw new i.g("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new v(t,new i.d(t._delegate,n,new i.n(e)))}static forKey(e,t,n){return new v(t,new i.d(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new I(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new I(this.firestore,Object(i.y)(this._delegate,e))}catch(e){throw b(e,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=Object(o.getModularInstance)(e))instanceof i.d&&Object(i.cb)(this._delegate,e)}set(e,t){t=a("DocumentReference.set",t);try{return t?Object(i.fb)(this._delegate,e,t):Object(i.fb)(this._delegate,e)}catch(e){throw b(e,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return 1===arguments.length?Object(i.kb)(this._delegate,e):Object(i.kb)(this._delegate,e,t,...n)}catch(e){throw b(e,"updateDoc()","DocumentReference.update()")}}delete(){return Object(i.B)(this._delegate)}onSnapshot(...e){const t=_(e),n=w(e,(e=>new T(this.firestore,new i.e(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))));return Object(i.X)(this._delegate,t,n)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?Object(i.N)(this._delegate):"server"===(null==e?void 0:e.source)?Object(i.O)(this._delegate):Object(i.M)(this._delegate),t.then((e=>new T(this.firestore,new i.e(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))))}withConverter(e){return new v(this.firestore,e?this._delegate.withConverter(y.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function b(e,t,n){return e.message=e.message.replace(t,n),e}function _(e){for(const t of e)if("object"==typeof t&&!d(t))return t;return{}}function w(e,t){var n,r;let i;return i=d(e[0])?e[0]:d(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]},{next:e=>{i.next&&i.next(t(e))},error:null===(n=i.error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class T{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new v(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Object(i.hb)(this._delegate,e._delegate)}}class E extends T{data(e){const t=this._delegate.data(e);return this._delegate._converter||Object(i.q)(void 0!==t,"Document in a QueryDocumentSnapshot should exist"),t}}class A{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new p(e)}where(e,t,n){try{return new A(this.firestore,Object(i.ab)(this._delegate,Object(i.mb)(e,t,n)))}catch(e){throw b(e,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new A(this.firestore,Object(i.ab)(this._delegate,Object(i.Z)(e,t)))}catch(e){throw b(e,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new A(this.firestore,Object(i.ab)(this._delegate,Object(i.T)(e)))}catch(e){throw b(e,"limit()","Query.limit()")}}limitToLast(e){try{return new A(this.firestore,Object(i.ab)(this._delegate,Object(i.U)(e)))}catch(e){throw b(e,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new A(this.firestore,Object(i.ab)(this._delegate,Object(i.jb)(...e)))}catch(e){throw b(e,"startAt()","Query.startAt()")}}startAfter(...e){try{return new A(this.firestore,Object(i.ab)(this._delegate,Object(i.ib)(...e)))}catch(e){throw b(e,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new A(this.firestore,Object(i.ab)(this._delegate,Object(i.J)(...e)))}catch(e){throw b(e,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new A(this.firestore,Object(i.ab)(this._delegate,Object(i.I)(...e)))}catch(e){throw b(e,"endAt()","Query.endAt()")}}isEqual(e){return Object(i.bb)(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?Object(i.Q)(this._delegate):"server"===(null==e?void 0:e.source)?Object(i.R)(this._delegate):Object(i.P)(this._delegate),t.then((e=>new O(this.firestore,new i.j(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))))}onSnapshot(...e){const t=_(e),n=w(e,(e=>new O(this.firestore,new i.j(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))));return Object(i.X)(this._delegate,t,n)}withConverter(e){return new A(this.firestore,e?this._delegate.withConverter(y.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class S{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new E(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class O{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new A(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map((e=>new E(this._firestore,e)))}docChanges(e){return this._delegate.docChanges(e).map((e=>new S(this._firestore,e)))}forEach(e,t){this._delegate.forEach((n=>{e.call(t,new E(this._firestore,n))}))}isEqual(e){return Object(i.hb)(this._delegate,e._delegate)}}class I extends A{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new v(this.firestore,e):null}doc(e){try{return new v(this.firestore,void 0===e?Object(i.E)(this._delegate):Object(i.E)(this._delegate,e))}catch(e){throw b(e,"doc()","CollectionReference.doc()")}}add(e){return Object(i.u)(this._delegate,e).then((e=>new v(this.firestore,e)))}isEqual(e){return Object(i.cb)(this._delegate,e._delegate)}withConverter(e){return new I(this.firestore,e?this._delegate.withConverter(y.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function C(e){return Object(i.p)(e,i.d)}class k{constructor(...e){this._delegate=new i.f(...e)}static documentId(){return new k(i.o.keyField().canonicalString())}isEqual(e){return(e=Object(o.getModularInstance)(e))instanceof i.f&&this._delegate._internalPath.isEqual(e._internalPath)}}class P{constructor(e){this._delegate=e}static serverTimestamp(){const e=Object(i.eb)();return e._methodName="FieldValue.serverTimestamp",new P(e)}static delete(){const e=Object(i.C)();return e._methodName="FieldValue.delete",new P(e)}static arrayUnion(...e){const t=Object(i.w)(...e);return t._methodName="FieldValue.arrayUnion",new P(t)}static arrayRemove(...e){const t=Object(i.v)(...e);return t._methodName="FieldValue.arrayRemove",new P(t)}static increment(e){const t=Object(i.S)(e);return t._methodName="FieldValue.increment",new P(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const x={Firestore:f,GeoPoint:i.h,Timestamp:i.k,Blob:u,Transaction:g,WriteBatch:m,DocumentReference:v,DocumentSnapshot:T,Query:A,QueryDocumentSnapshot:E,QuerySnapshot:O,CollectionReference:I,FieldPath:k,FieldValue:P,setLogLevel:function(e){Object(i.gb)(e)},CACHE_SIZE_UNLIMITED:i.c};var R,L;R=r.a,L=(e,t)=>new f(e,t,new h),R.INTERNAL.registerComponent(new s.Component("firestore-compat",(e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("firestore").getImmediate();return L(t,n)}),"PUBLIC").setServiceProps(Object.assign({},x))),R.registerVersion("@firebase/firestore-compat","0.3.29")},function(e,t,n){const r=Symbol("headers"),i=Symbol("response headers"),o=Symbol("AbortController"),s=Symbol("method"),a=Symbol("URL"),c=Symbol("MIME"),l=Symbol("dispatch"),u=Symbol("errored"),d=Symbol("timeout"),h=Symbol("timedOut"),f=Symbol("isResponseText"),p=class extends EventTarget{constructor(){super(),this.readyState=this.constructor.UNSENT,this.response=null,this.responseType="",this.responseURL="",this.status=0,this.statusText="",this.timeout=0,this.withCredentials=!1,this[r]=Object.create(null),this[r].accept="*/*",this[i]=Object.create(null),this[o]=new AbortController,this[s]="",this[a]="",this[c]="",this[u]=!1,this[d]=0,this[h]=!1,this[f]=!0}static get UNSENT(){return 0}static get OPENED(){return 1}static get HEADERS_RECEIVED(){return 2}static get LOADING(){return 3}static get DONE(){return 4}get responseText(){if(this[u])return null;if(this.readyState<this.constructor.HEADERS_RECEIVED)return"";if(this[f])return this.response;throw new DOMException("Response type not set to text","InvalidStateError")}get responseXML(){throw new Error("XML not supported")}[l](e){const t=`on${e.type}`;"function"==typeof this[t]&&this.addEventListener(e.type,this[t].bind(this),{once:!0}),this.dispatchEvent(e)}abort(){this[o].abort(),this.status=0,this.readyState=this.constructor.UNSENT}open(e,t){this.status=0,this[s]=e,this[a]=t,this.readyState=this.constructor.OPENED}setRequestHeader(e,t){e=String(e).toLowerCase(),void 0===this[r][e]?this[r][e]=String(t):this[r][e]+=`, ${t}`}overrideMimeType(e){this[c]=String(e)}getAllResponseHeaders(){return this[u]||this.readyState<this.constructor.HEADERS_RECEIVED?"":Object.entries(this[i]).map((([e,t])=>`${e}: ${t}`)).join("\r\n")}getResponseHeader(e){const t=this[i][String(e).toLowerCase()];return"string"==typeof t?t:null}send(e=null){this.timeout>0&&(this[d]=setTimeout((()=>{this[h]=!0,this[o].abort()}),this.timeout));const t=this.responseType||"text";this[f]="text"===t,fetch(this[a],{method:this[s]||"GET",signal:this[o].signal,headers:this[r],credentials:this.withCredentials?"include":"same-origin",body:e}).finally((()=>{this.readyState=this.constructor.DONE,clearTimeout(this[d]),this[l](new CustomEvent("loadstart"))})).then((async e=>{this.responseURL=e.url,this.status=e.status,this.statusText=e.statusText;const n=this[c]||this[i]["content-type"]||"text/plain";switch(Object.assign(this[i],e.headers),t){case"text":this.response=await e.text();break;case"blob":this.response=new Blob([await e.arrayBuffer()],{type:n});break;case"arraybuffer":this.response=await e.arrayBuffer();break;case"json":this.response=await e.json()}this[l](new CustomEvent("load"))}),(e=>{let t="abort";"AbortError"!==e.name?(this[u]=!0,t="error"):this[h]&&(t="timeout"),this[l](new CustomEvent(t))})).finally((()=>this[l](new CustomEvent("loadend"))))}};e.exports?e.exports=p:(globalThis||self).XMLHttpRequestShim=XMLHttpRequest},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor({storage:e}){this.handleChanges=(e,t)=>{const n=this.listeners.get(t);if(n.size)for(const[t,r]of Object.entries(e)){const e=n.get(t);null!=e&&e(r)}},this.addListener=(e,t,n)=>this.listeners.get(e).set(t,n),this.resetListeners(),this.storage=e,this.storage.onChanged.addListener(this.handleChanges)}resetListeners(){this.listeners=new Map([["sync",new Map],["local",new Map],["managed",new Map]])}}},function(e,t,n){var r=n(1289),i=n(1173)((function(e,t,n){return t=t.toLowerCase(),e+(n?r(t):t)}));e.exports=i},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(321),i=n(1078);function o(e){const t=new i.a({dbName:"memexPersistent",idbImplementation:e.idbImplementation});return new r.b({backend:t})}},function(e,t,n){var r;!function(i,o){"use strict";var s="function",a="undefined",c="object",l="string",u="major",d="model",h="name",f="type",p="vendor",g="version",m="architecture",y="console",v="mobile",b="tablet",_="smarttv",w="wearable",T="embedded",E="Amazon",A="Apple",S="ASUS",O="BlackBerry",I="Browser",C="Chrome",k="Firefox",P="Google",x="Huawei",R="LG",L="Microsoft",D="Motorola",N="Opera",j="Samsung",M="Sharp",F="Sony",U="Xiaomi",B="Zebra",G="Facebook",q="Chromium OS",H="Mac OS",$=" Browser",W=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toUpperCase()]=e[n];return t},z=function(e,t){return typeof e===l&&-1!==V(t).indexOf(V(e))},V=function(e){return e.toLowerCase()},K=function(e,t){if(typeof e===l)return e=e.replace(/^\s\s*/,""),typeof t===a?e:e.substring(0,500)},Y=function(e,t){for(var n,r,i,a,l,u,d=0;d<t.length&&!l;){var h=t[d],f=t[d+1];for(n=r=0;n<h.length&&!l&&h[n];)if(l=h[n++].exec(e))for(i=0;i<f.length;i++)u=l[++r],typeof(a=f[i])===c&&a.length>0?2===a.length?typeof a[1]==s?this[a[0]]=a[1].call(this,u):this[a[0]]=a[1]:3===a.length?typeof a[1]!==s||a[1].exec&&a[1].test?this[a[0]]=u?u.replace(a[1],a[2]):o:this[a[0]]=u?a[1].call(this,u,a[2]):o:4===a.length&&(this[a[0]]=u?a[3].call(this,u.replace(a[1],a[2])):o):this[a]=u||o;d+=2}},Q=function(e,t){for(var n in t)if(typeof t[n]===c&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(z(t[n][r],e))return"?"===n?o:n}else if(z(t[n],e))return"?"===n?o:n;return t.hasOwnProperty("*")?t["*"]:e},X={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},J={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[g,[h,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[g,[h,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[h,g],[/opios[\/ ]+([\w\.]+)/i],[g,[h,N+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[g,[h,N+" GX"]],[/\bopr\/([\w\.]+)/i],[g,[h,N]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[g,[h,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[g,[h,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[h,g],[/quark(?:pc)?\/([-\w\.]+)/i],[g,[h,"Quark"]],[/\bddg\/([\w\.]+)/i],[g,[h,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[g,[h,"UC"+I]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[g,[h,"WeChat"]],[/konqueror\/([\w\.]+)/i],[g,[h,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[g,[h,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[g,[h,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[g,[h,"Smart Lenovo "+I]],[/(avast|avg)\/([\w\.]+)/i],[[h,/(.+)/,"$1 Secure "+I],g],[/\bfocus\/([\w\.]+)/i],[g,[h,k+" Focus"]],[/\bopt\/([\w\.]+)/i],[g,[h,N+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[g,[h,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[g,[h,"Dolphin"]],[/coast\/([\w\.]+)/i],[g,[h,N+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[g,[h,"MIUI"+$]],[/fxios\/([\w\.-]+)/i],[g,[h,k]],[/\bqihoobrowser\/?([\w\.]*)/i],[g,[h,"360"]],[/\b(qq)\/([\w\.]+)/i],[[h,/(.+)/,"$1Browser"],g],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[h,/(.+)/,"$1"+$],g],[/samsungbrowser\/([\w\.]+)/i],[g,[h,j+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[g,[h,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[h,"Sogou Mobile"],g],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[h,g],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[h],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[g,h],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[h,G],g],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[h,g],[/\bgsa\/([\w\.]+) .*safari\//i],[g,[h,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[g,[h,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[g,[h,C+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[h,C+" WebView"],g],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[g,[h,"Android "+I]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[h,g],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[g,[h,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[g,h],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[h,[g,Q,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[h,g],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[h,"Netscape"],g],[/(wolvic|librewolf)\/([\w\.]+)/i],[h,g],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[g,[h,k+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[h,[g,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[h,[g,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[m,"amd64"]],[/(ia32(?=;))/i],[[m,V]],[/((?:i[346]|x)86)[;\)]/i],[[m,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[m,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[m,"armhf"]],[/windows (ce|mobile); ppc;/i],[[m,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[m,/ower/,"",V]],[/(sun4\w)[;\)]/i],[[m,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[m,V]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[d,[p,j],[f,b]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[d,[p,j],[f,v]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[d,[p,A],[f,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[d,[p,A],[f,b]],[/(macintosh);/i],[d,[p,A]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[d,[p,M],[f,v]],[/(?:honor)([-\w ]+)[;\)]/i],[d,[p,"Honor"],[f,v]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[d,[p,x],[f,b]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[d,[p,x],[f,v]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[d,/_/g," "],[p,U],[f,v]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[d,/_/g," "],[p,U],[f,b]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[d,[p,"OPPO"],[f,v]],[/\b(opd2\d{3}a?) bui/i],[d,[p,"OPPO"],[f,b]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[d,[p,"Vivo"],[f,v]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[d,[p,"Realme"],[f,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[d,[p,D],[f,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[d,[p,D],[f,b]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[d,[p,R],[f,b]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[d,[p,R],[f,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[d,[p,"Lenovo"],[f,b]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[d,/_/g," "],[p,"Nokia"],[f,v]],[/(pixel c)\b/i],[d,[p,P],[f,b]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[d,[p,P],[f,v]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[d,[p,F],[f,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[d,"Xperia Tablet"],[p,F],[f,b]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[d,[p,"OnePlus"],[f,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[d,[p,E],[f,b]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[d,/(.+)/g,"Fire Phone $1"],[p,E],[f,v]],[/(playbook);[-\w\),; ]+(rim)/i],[d,p,[f,b]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[d,[p,O],[f,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[d,[p,S],[f,b]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[d,[p,S],[f,v]],[/(nexus 9)/i],[d,[p,"HTC"],[f,b]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[p,[d,/_/g," "],[f,v]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[d,[p,"TCL"],[f,b]],[/(itel) ((\w+))/i],[[p,V],d,[f,Q,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[d,[p,"Acer"],[f,b]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[d,[p,"Meizu"],[f,v]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[d,[p,"Ulefone"],[f,v]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[d,[p,"Energizer"],[f,v]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[d,[p,"Cat"],[f,v]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[d,[p,"Smartfren"],[f,v]],[/droid.+; (a(?:015|06[35]|142p?))/i],[d,[p,"Nothing"],[f,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (imo) ((?!tab)[\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[p,d,[f,v]],[/(imo) (tab \w+)/i,/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[p,d,[f,b]],[/(surface duo)/i],[d,[p,L],[f,b]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[d,[p,"Fairphone"],[f,v]],[/(u304aa)/i],[d,[p,"AT&T"],[f,v]],[/\bsie-(\w*)/i],[d,[p,"Siemens"],[f,v]],[/\b(rct\w+) b/i],[d,[p,"RCA"],[f,b]],[/\b(venue[\d ]{2,7}) b/i],[d,[p,"Dell"],[f,b]],[/\b(q(?:mv|ta)\w+) b/i],[d,[p,"Verizon"],[f,b]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[d,[p,"Barnes & Noble"],[f,b]],[/\b(tm\d{3}\w+) b/i],[d,[p,"NuVision"],[f,b]],[/\b(k88) b/i],[d,[p,"ZTE"],[f,b]],[/\b(nx\d{3}j) b/i],[d,[p,"ZTE"],[f,v]],[/\b(gen\d{3}) b.+49h/i],[d,[p,"Swiss"],[f,v]],[/\b(zur\d{3}) b/i],[d,[p,"Swiss"],[f,b]],[/\b((zeki)?tb.*\b) b/i],[d,[p,"Zeki"],[f,b]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[p,"Dragon Touch"],d,[f,b]],[/\b(ns-?\w{0,9}) b/i],[d,[p,"Insignia"],[f,b]],[/\b((nxa|next)-?\w{0,9}) b/i],[d,[p,"NextBook"],[f,b]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[p,"Voice"],d,[f,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[p,"LvTel"],d,[f,v]],[/\b(ph-1) /i],[d,[p,"Essential"],[f,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[d,[p,"Envizen"],[f,b]],[/\b(trio[-\w\. ]+) b/i],[d,[p,"MachSpeed"],[f,b]],[/\btu_(1491) b/i],[d,[p,"Rotor"],[f,b]],[/(shield[\w ]+) b/i],[d,[p,"Nvidia"],[f,b]],[/(sprint) (\w+)/i],[p,d,[f,v]],[/(kin\.[onetw]{3})/i],[[d,/\./g," "],[p,L],[f,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[d,[p,B],[f,b]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[d,[p,B],[f,v]],[/smart-tv.+(samsung)/i],[p,[f,_]],[/hbbtv.+maple;(\d+)/i],[[d,/^/,"SmartTV"],[p,j],[f,_]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[p,R],[f,_]],[/(apple) ?tv/i],[p,[d,A+" TV"],[f,_]],[/crkey/i],[[d,C+"cast"],[p,P],[f,_]],[/droid.+aft(\w+)( bui|\))/i],[d,[p,E],[f,_]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[d,[p,M],[f,_]],[/(bravia[\w ]+)( bui|\))/i],[d,[p,F],[f,_]],[/(mitv-\w{5}) bui/i],[d,[p,U],[f,_]],[/Hbbtv.*(technisat) (.*);/i],[p,d,[f,_]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[p,K],[d,K],[f,_]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[f,_]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[p,d,[f,y]],[/droid.+; (shield) bui/i],[d,[p,"Nvidia"],[f,y]],[/(playstation [345portablevi]+)/i],[d,[p,F],[f,y]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[d,[p,L],[f,y]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[d,[p,j],[f,w]],[/((pebble))app/i],[p,d,[f,w]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[d,[p,A],[f,w]],[/droid.+; (glass) \d/i],[d,[p,P],[f,w]],[/droid.+; (wt63?0{2,3})\)/i],[d,[p,B],[f,w]],[/droid.+; (glass) \d/i],[d,[p,P],[f,w]],[/(pico) (4|neo3(?: link|pro)?)/i],[p,d,[f,w]],[/; (quest( \d| pro)?)/i],[d,[p,G],[f,w]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[p,[f,T]],[/(aeobc)\b/i],[d,[p,E],[f,T]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[d,[f,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[d,[f,b]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[f,b]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[f,v]],[/(android[-\w\. ]{0,9});.+buil/i],[d,[p,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[g,[h,"EdgeHTML"]],[/(arkweb)\/([\w\.]+)/i],[h,g],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[g,[h,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[h,g],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[g,h]],os:[[/microsoft (windows) (vista|xp)/i],[h,g],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[h,[g,Q,X]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[g,Q,X],[h,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[g,/_/g,"."],[h,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[h,H],[g,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[g,h],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish|openharmony)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[h,g],[/\(bb(10);/i],[g,[h,O]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[g,[h,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[g,[h,k+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[g,[h,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[g,[h,"watchOS"]],[/crkey\/([\d\.]+)/i],[g,[h,C+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[h,q],g],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[h,g],[/(sunos) ?([\w\.\d]*)/i],[[h,"Solaris"],g],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[h,g]]},Z=function(e,t){if(typeof e===c&&(t=e,e=o),!(this instanceof Z))return new Z(e,t).getResult();var n=typeof i!==a&&i.navigator?i.navigator:o,r=e||(n&&n.userAgent?n.userAgent:""),y=n&&n.userAgentData?n.userAgentData:o,_=t?function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n}(J,t):J,w=n&&n.userAgent==r;return this.getBrowser=function(){var e,t={};return t[h]=o,t[g]=o,Y.call(t,r,_.browser),t[u]=typeof(e=t[g])===l?e.replace(/[^\d\.]/g,"").split(".")[0]:o,w&&n&&n.brave&&typeof n.brave.isBrave==s&&(t[h]="Brave"),t},this.getCPU=function(){var e={};return e[m]=o,Y.call(e,r,_.cpu),e},this.getDevice=function(){var e={};return e[p]=o,e[d]=o,e[f]=o,Y.call(e,r,_.device),w&&!e[f]&&y&&y.mobile&&(e[f]=v),w&&"Macintosh"==e[d]&&n&&typeof n.standalone!==a&&n.maxTouchPoints&&n.maxTouchPoints>2&&(e[d]="iPad",e[f]=b),e},this.getEngine=function(){var e={};return e[h]=o,e[g]=o,Y.call(e,r,_.engine),e},this.getOS=function(){var e={};return e[h]=o,e[g]=o,Y.call(e,r,_.os),w&&!e[h]&&y&&y.platform&&"Unknown"!=y.platform&&(e[h]=y.platform.replace(/chrome os/i,q).replace(/macos/i,H)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=typeof e===l&&e.length>500?K(e,500):e,this},this.setUA(r),this};Z.VERSION="0.7.40",Z.BROWSER=W([h,g,u]),Z.CPU=W([m]),Z.DEVICE=W([d,p,f,y,v,_,b,w,T]),Z.ENGINE=Z.OS=W([h,g]),typeof t!==a?(typeof e!==a&&e.exports&&(t=e.exports=Z),t.UAParser=Z):n(1315)?(r=function(){return Z}.call(t,n,t,e))===o||(e.exports=r):typeof i!==a&&(i.UAParser=Z);var ee=typeof i!==a&&(i.jQuery||i.Zepto);if(ee&&!ee.ua){var te=new Z;ee.ua=te.getResult(),ee.ua.get=function(){return te.getUA()},ee.ua.set=function(e){te.setUA(e);var t=te.getResult();for(var n in t)ee.ua[n]=t[n]}}}("object"==typeof window?window:this)},function(e,t,n){var r=n(473),i=n(53).EventEmitter;function o(e){if(!(this instanceof o))return new o(e);i.call(this),e=e||{},this.concurrency=e.concurrency||1/0,this.timeout=e.timeout||0,this.autostart=e.autostart||!1,this.results=e.results||null,this.pending=0,this.session=0,this.running=!1,this.jobs=[],this.timers={}}e.exports=o,e.exports.default=o,r(o,i);["pop","shift","indexOf","lastIndexOf"].forEach((function(e){o.prototype[e]=function(){return Array.prototype[e].apply(this.jobs,arguments)}})),o.prototype.slice=function(e,t){return this.jobs=this.jobs.slice(e,t),this},o.prototype.reverse=function(){return this.jobs.reverse(),this};function s(){for(var e in this.timers){var t=this.timers[e];delete this.timers[e],clearTimeout(t)}}function a(e){var t=this;function n(e){t.end(e)}this.on("error",n),this.on("end",(function r(i){t.removeListener("error",n),t.removeListener("end",r),e(i,this.results)}))}function c(e){this.session++,this.running=!1,this.emit("end",e)}["push","unshift","splice"].forEach((function(e){o.prototype[e]=function(){var t=Array.prototype[e].apply(this.jobs,arguments);return this.autostart&&this.start(),t}})),Object.defineProperty(o.prototype,"length",{get:function(){return this.pending+this.jobs.length}}),o.prototype.start=function(e){if(e&&a.call(this,e),this.running=!0,!(this.pending>=this.concurrency))if(0!==this.jobs.length){var t=this,n=this.jobs.shift(),r=!0,i=this.session,o=null,s=!1,l=null;this.timeout&&(o=setTimeout((function(){s=!0,t.listeners("timeout").length>0?t.emit("timeout",d,n):d()}),this.timeout),this.timers[o]=o),this.results&&(l=this.results.length,this.results[l]=null),this.pending++;var u=n(d);u&&u.then&&"function"==typeof u.then&&u.then((function(e){return d(null,e)})).catch((function(e){return d(e||!0)})),this.running&&this.jobs.length>0&&this.start()}else 0===this.pending&&c.call(this);function d(e,a){r&&t.session===i&&(r=!1,t.pending--,null!==o&&(delete t.timers[o],clearTimeout(o)),e?t.emit("error",e,n):!1===s&&(null!==l&&(t.results[l]=Array.prototype.slice.call(arguments,1)),t.emit("success",a,n)),t.session===i&&(0===t.pending&&0===t.jobs.length?c.call(t):t.running&&t.start()))}},o.prototype.stop=function(){this.running=!1},o.prototype.end=function(e){s.call(this),this.jobs.length=0,this.pending=0,c.call(this,e)}},function(e,t,n){var r=n(219),i=n(1318);e.exports=function(e,t){return i(e||[],t||[],r)}},function(e,t){function n(e){var t=0,n=[];function r(){var r;--t<e&&(r=n.shift(),o.queue=n.length,r&&i(r.fn).then(r.resolve).catch(r.reject))}function i(e){t++;try{return Promise.resolve(e()).then((function(e){return r(),e}),(function(e){throw r(),e}))}catch(e){return r(),Promise.reject(e)}}var o=function(r){return t>=e?function(e){return new Promise((function(t,r){n.push({fn:e,resolve:t,reject:r}),o.queue=n.length}))}(r):i(r)};return o}function r(e,t){var n=!1,r=this;return Promise.all(e.map((function(){var e=arguments;return r((function(){if(!n)return t.apply(void 0,e).catch((function(e){throw n=!0,e}))}))})))}function i(e){return e.queue=0,e.map=r,e}e.exports=function(e){return i(e?n(e):function(e){return e()})}},function(e,t,n){var r=n(238),i=n(1319),o=i;o.v1=r,o.v4=i,e.exports=o},function(e,t,n){var r=n(1320),i=n(1087),o=n(1179),s=n(730)("socket.io-client");e.exports=t=c;var a=t.managers={};function c(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,i=r(e),c=i.source,l=i.id,u=i.path,d=a[l]&&u in a[l].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||d?(s("ignoring socket cache for %s",c),n=o(c,t)):(a[l]||(s("new io instance for %s",c),a[l]=o(c,t)),n=a[l]),i.query&&!t.query&&(t.query=i.query),n.socket(i.path,t)}t.protocol=i.protocol,t.connect=c,t.Manager=n(1179),t.Socket=n(1185)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var r=n(2),i=n(6),o=n(317),s=n(103),a=n(104),c=n(100),l=n(51),u=n(29),d=n(580),h=n(68);class f{constructor(t){this.options=t,this.onTabClosed=(e,t)=>{Object(h.f)(this.options.browserAPIs,e)},this.injectContentScriptComponent=({tab:e},{component:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.options.injectScriptInTab(e.id,`/content_script_${t}.js`)})),this.reloadTab=({tab:e},{bypassCache:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.options.browserAPIs.tabs.reload(e.id,{bypassCache:t})})),this.openPdfInViewer=({tab:e},{fullPageUrl:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield Object(s.c)(t,{tabsAPI:this.options.browserAPIs.tabs,runtimeAPI:this.options.browserAPIs.runtime})})),this.openPageWithSidebarInSelectedListMode=({tab:e},{fullPageUrl:t,sharedListId:n,manuallyPullLocalListData:o})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){if(o&&null!=n){let e=5;for(;e-- >0;){yield Object(c.a)(1e3),yield this.options.waitForSync();if(null!=(yield this.options.contentSharingStorage.getRemoteListShareMetadata({remoteListId:n})))break}}const e=yield this.options.browserAPIs.tabs.query({currentWindow:!0,active:!0});yield this.doSomethingInNewTab(t,(e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield Object(i.l)(e).showSidebar({action:"selected_list_mode_from_web_ui",sharedListId:n,manuallyPullLocalListData:o}),!0}))),(e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield Object(i.l)(e).testIfSidebarSetup(),!0})))),yield Promise.all(e.map((e=>e.url.includes(n)&&e.url.includes("/p/")&&!e.url.includes("?dono")?this.options.browserAPIs.tabs.remove(e.id):Promise.resolve())))})),this.goToAnnotationFromDashboardSidebar=({tab:e},{fullPageUrl:t,annotationCacheId:n})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.doSomethingInNewTab(t,(e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield Object(i.l)(e).showSidebar({annotationCacheId:n,action:"show_annotation"}),yield Object(i.l)(e).goToHighlight(n),!0}))),(e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return yield Object(i.l)(e).showSidebar({annotationCacheId:n,action:"show_annotation"}),!0}))))})),this.remoteFunctions={goToAnnotationFromDashboardSidebar:this.goToAnnotationFromDashboardSidebar,openPageWithSidebarInSelectedListMode:this.openPageWithSidebarInSelectedListMode,reloadTab:this.reloadTab,openPdfInViewer:this.openPdfInViewer,injectContentScriptComponent:this.injectContentScriptComponent,getCurrentTab:({tab:e})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return{id:e.id,url:(yield t.browserAPIs.tabs.get(e.id)).url}})),openBetaFeatureSettings:(t,{email:n,userId:i})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t;const r=(null===(t=e.env.REACT_APP_FIREBASE_PROJECT_ID)||void 0===t?void 0:t.includes("staging"))||!1?u.b.staging:u.b.production,o=yield fetch(r+"/check_rabbithole_beta_status",{method:"POST",body:JSON.stringify({email:n,userId:i}),headers:{"Content-Type":"application/json"}});return yield o.json()})),openAuthSettings:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=this.options.browserAPIs.runtime.getURL("options.html");yield this.options.browserAPIs.tabs.create({active:!0,url:e+"#/account"})}))},this.options.browserAPIs.tabs.onRemoved.addListener(this.onTabClosed),this.options.browserAPIs.webNavigation.onHistoryStateUpdated.addListener((({tabId:e,url:t})=>Object(r.__awaiter)(this,void 0,void 0,(function*(){Object(d.a)({fullUrl:t})&&(yield Object(i.l)(e).handleHistoryStateUpdate(e).catch((e=>{}))),yield Object(h.f)(this.options.browserAPIs,e)})))),this.options.browserAPIs.tabs.onUpdated.addListener(((e,t)=>{var n;(null===(n=null==t?void 0:t.url)||void 0===n?void 0:n.includes("mail.google.com/mail"))&&Object(i.l)(e).handleHistoryStateUpdate(e).catch((e=>{})),Object(l.e)(null==t?void 0:t.url)&&this.options.browserAPIs.tabs.sendMessage(e,{type:"URL_CHANGE",url:null==t?void 0:t.url}),Object(h.f)(this.options.browserAPIs,e)}))}setupRemoteFunctions(){Object(i.d)(this.remoteFunctions,{insertExtraArg:!0})}doSomethingInNewTab(e,t,n,i=150,c=1e3){var l;return Object(r.__awaiter)(this,void 0,void 0,(function*(){let u;if(Object(a.b)(e)){yield Object(s.c)(e,{tabsAPI:this.options.browserAPIs.tabs,runtimeAPI:this.options.browserAPIs.runtime});const t=yield this.options.browserAPIs.tabs.query({currentWindow:!0,active:!0});u=null!==(l=t[0])&&void 0!==l?l:null}else u=yield this.options.browserAPIs.tabs.create({active:!0,url:e});const d=(e,s)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){if(e===(null==u?void 0:u.id)&&"complete"===s.status){yield Object(o.a)(c);try{let r=!1;for(;!r;){(yield Promise.race([Object(o.a)(i),n(e)]))&&(yield Object(o.a)(250),t(e),r=!0)}}catch(e){throw e}finally{this.options.browserAPIs.tabs.onUpdated.removeListener(d)}}}));this.options.browserAPIs.tabs.onUpdated.addListener(d)}))}}}).call(this,n(131))},function(e,t){var n=e.exports=function(e){return new r(e)};function r(e){this.value=e}function i(e,t,n){var r=[],i=[],a=!0;return function e(d){var h=n?o(d):d,f={},p=!0,g={node:h,node_:d,path:[].concat(r),parent:i[i.length-1],parents:i,key:r.slice(-1)[0],isRoot:0===r.length,level:r.length,circular:null,update:function(e,t){g.isRoot||(g.parent.node[g.key]=e),g.node=e,t&&(p=!1)},delete:function(e){delete g.parent.node[g.key],e&&(p=!1)},remove:function(e){c(g.parent.node)?g.parent.node.splice(g.key,1):delete g.parent.node[g.key],e&&(p=!1)},keys:null,before:function(e){f.before=e},after:function(e){f.after=e},pre:function(e){f.pre=e},post:function(e){f.post=e},stop:function(){a=!1},block:function(){p=!1}};if(!a)return g;function m(){if("object"==typeof g.node&&null!==g.node){g.keys&&g.node_===g.node||(g.keys=s(g.node)),g.isLeaf=0==g.keys.length;for(var e=0;e<i.length;e++)if(i[e].node_===d){g.circular=i[e];break}}else g.isLeaf=!0,g.keys=null;g.notLeaf=!g.isLeaf,g.notRoot=!g.isRoot}m();var y=t.call(g,g.node);return void 0!==y&&g.update&&g.update(y),f.before&&f.before.call(g,g.node),p?("object"!=typeof g.node||null===g.node||g.circular||(i.push(g),m(),l(g.keys,(function(t,i){r.push(t),f.pre&&f.pre.call(g,g.node[t],t);var o=e(g.node[t]);n&&u.call(g.node,t)&&(g.node[t]=o.node),o.isLast=i==g.keys.length-1,o.isFirst=0==i,f.post&&f.post.call(g,o),r.pop()})),i.pop()),f.after&&f.after.call(g,g.node),g):g}(e).node}function o(e){if("object"==typeof e&&null!==e){var t;if(c(e))t=[];else if("[object Date]"===a(e))t=new Date(e.getTime?e.getTime():e);else if(function(e){return"[object RegExp]"===a(e)}(e))t=new RegExp(e);else if(function(e){return"[object Error]"===a(e)}(e))t={message:e.message};else if(function(e){return"[object Boolean]"===a(e)}(e))t=new Boolean(e);else if(function(e){return"[object Number]"===a(e)}(e))t=new Number(e);else if(function(e){return"[object String]"===a(e)}(e))t=new String(e);else if(Object.create&&Object.getPrototypeOf)t=Object.create(Object.getPrototypeOf(e));else if(e.constructor===Object)t={};else{var n=e.constructor&&e.constructor.prototype||e.__proto__||{},r=function(){};r.prototype=n,t=new r}return l(s(e),(function(n){t[n]=e[n]})),t}return e}r.prototype.get=function(e){for(var t=this.value,n=0;n<e.length;n++){var r=e[n];if(!t||!u.call(t,r)){t=void 0;break}t=t[r]}return t},r.prototype.has=function(e){for(var t=this.value,n=0;n<e.length;n++){var r=e[n];if(!t||!u.call(t,r))return!1;t=t[r]}return!0},r.prototype.set=function(e,t){for(var n=this.value,r=0;r<e.length-1;r++){var i=e[r];u.call(n,i)||(n[i]={}),n=n[i]}return n[e[r]]=t,t},r.prototype.map=function(e){return i(this.value,e,!0)},r.prototype.forEach=function(e){return this.value=i(this.value,e,!1),this.value},r.prototype.reduce=function(e,t){var n=1===arguments.length,r=n?this.value:t;return this.forEach((function(t){this.isRoot&&n||(r=e.call(this,r,t))})),r},r.prototype.paths=function(){var e=[];return this.forEach((function(t){e.push(this.path)})),e},r.prototype.nodes=function(){var e=[];return this.forEach((function(t){e.push(this.node)})),e},r.prototype.clone=function(){var e=[],t=[];return function n(r){for(var i=0;i<e.length;i++)if(e[i]===r)return t[i];if("object"==typeof r&&null!==r){var a=o(r);return e.push(r),t.push(a),l(s(r),(function(e){a[e]=n(r[e])})),e.pop(),t.pop(),a}return r}(this.value)};var s=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};function a(e){return Object.prototype.toString.call(e)}var c=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},l=function(e,t){if(e.forEach)return e.forEach(t);for(var n=0;n<e.length;n++)t(e[n],n,e)};l(s(r.prototype),(function(e){n[e]=function(t){var n=[].slice.call(arguments,1),i=new r(t);return i[e].apply(i,n)}}));var u=Object.hasOwnProperty||function(e,t){return t in e}},function(e,t,n){e.exports=function(){"use strict";var e=Object.prototype.toString,t=Array.isArray||function(t){return"[object Array]"===e.call(t)};function n(e){return"function"==typeof e}function r(e){return t(e)?"array":typeof e}function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function o(e,t){return null!=e&&"object"==typeof e&&t in e}function s(e,t){return null!=e&&"object"!=typeof e&&e.hasOwnProperty&&e.hasOwnProperty(t)}var a=RegExp.prototype.test;function c(e,t){return a.call(e,t)}var l=/\S/;function u(e){return!c(l,e)}var d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function h(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return d[e]}))}var f=/\s*/,p=/\s+/,g=/\s*=/,m=/\s*\}/,y=/#|\^|\/|>|\{|&|=|!/;function v(e,n){if(!e)return[];var r,o,s,a=!1,c=[],l=[],d=[],h=!1,v=!1,T="",E=0;function S(){if(h&&!v)for(;d.length;)delete l[d.pop()];else d=[];h=!1,v=!1}function O(e){if("string"==typeof e&&(e=e.split(p,2)),!t(e)||2!==e.length)throw new Error("Invalid tags: "+e);r=new RegExp(i(e[0])+"\\s*"),o=new RegExp("\\s*"+i(e[1])),s=new RegExp("\\s*"+i("}"+e[1]))}O(n||A.tags);for(var I,C,k,P,x,R,L=new w(e);!L.eos();){if(I=L.pos,k=L.scanUntil(r))for(var D=0,N=k.length;D<N;++D)u(P=k.charAt(D))?(d.push(l.length),T+=P):(v=!0,a=!0,T+=" "),l.push(["text",P,I,I+1]),I+=1,"\n"===P&&(S(),T="",E=0,a=!1);if(!L.scan(r))break;if(h=!0,C=L.scan(y)||"name",L.scan(f),"="===C?(k=L.scanUntil(g),L.scan(g),L.scanUntil(o)):"{"===C?(k=L.scanUntil(s),L.scan(m),L.scanUntil(o),C="&"):k=L.scanUntil(o),!L.scan(o))throw new Error("Unclosed tag at "+L.pos);if(x=">"==C?[C,k,I,L.pos,T,E,a]:[C,k,I,L.pos],E++,l.push(x),"#"===C||"^"===C)c.push(x);else if("/"===C){if(!(R=c.pop()))throw new Error('Unopened section "'+k+'" at '+I);if(R[1]!==k)throw new Error('Unclosed section "'+R[1]+'" at '+I)}else"name"===C||"{"===C||"&"===C?v=!0:"="===C&&O(k)}if(S(),R=c.pop())throw new Error('Unclosed section "'+R[1]+'" at '+L.pos);return _(b(l))}function b(e){for(var t,n,r=[],i=0,o=e.length;i<o;++i)(t=e[i])&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(r.push(t),n=t));return r}function _(e){for(var t,n=[],r=n,i=[],o=0,s=e.length;o<s;++o)switch((t=e[o])[0]){case"#":case"^":r.push(t),i.push(t),r=t[4]=[];break;case"/":i.pop()[5]=t[2],r=i.length>0?i[i.length-1][4]:n;break;default:r.push(t)}return n}function w(e){this.string=e,this.tail=e,this.pos=0}function T(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function E(){this.templateCache={_cache:{},set:function(e,t){this._cache[e]=t},get:function(e){return this._cache[e]},clear:function(){this._cache={}}}}w.prototype.eos=function(){return""===this.tail},w.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},w.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},T.prototype.push=function(e){return new T(e,this)},T.prototype.lookup=function(e){var t,r=this.cache;if(r.hasOwnProperty(e))t=r[e];else{for(var i,a,c,l=this,u=!1;l;){if(e.indexOf(".")>0)for(i=l.view,a=e.split("."),c=0;null!=i&&c<a.length;)c===a.length-1&&(u=o(i,a[c])||s(i,a[c])),i=i[a[c++]];else i=l.view[e],u=o(l.view,e);if(u){t=i;break}l=l.parent}r[e]=t}return n(t)&&(t=t.call(this.view)),t},E.prototype.clearCache=function(){void 0!==this.templateCache&&this.templateCache.clear()},E.prototype.parse=function(e,t){var n=this.templateCache,r=e+":"+(t||A.tags).join(":"),i=void 0!==n,o=i?n.get(r):void 0;return null==o&&(o=v(e,t),i&&n.set(r,o)),o},E.prototype.render=function(e,t,n,r){var i=this.parse(e,r),o=t instanceof T?t:new T(t,void 0);return this.renderTokens(i,o,n,e,r)},E.prototype.renderTokens=function(e,t,n,r,i){for(var o,s,a,c="",l=0,u=e.length;l<u;++l)a=void 0,"#"===(s=(o=e[l])[0])?a=this.renderSection(o,t,n,r):"^"===s?a=this.renderInverted(o,t,n,r):">"===s?a=this.renderPartial(o,t,n,i):"&"===s?a=this.unescapedValue(o,t):"name"===s?a=this.escapedValue(o,t):"text"===s&&(a=this.rawValue(o)),void 0!==a&&(c+=a);return c},E.prototype.renderSection=function(e,r,i,o){var s=this,a="",c=r.lookup(e[1]);function l(e){return s.render(e,r,i)}if(c){if(t(c))for(var u=0,d=c.length;u<d;++u)a+=this.renderTokens(e[4],r.push(c[u]),i,o);else if("object"==typeof c||"string"==typeof c||"number"==typeof c)a+=this.renderTokens(e[4],r.push(c),i,o);else if(n(c)){if("string"!=typeof o)throw new Error("Cannot use higher-order sections without the original template");null!=(c=c.call(r.view,o.slice(e[3],e[5]),l))&&(a+=c)}else a+=this.renderTokens(e[4],r,i,o);return a}},E.prototype.renderInverted=function(e,n,r,i){var o=n.lookup(e[1]);if(!o||t(o)&&0===o.length)return this.renderTokens(e[4],n,r,i)},E.prototype.indentPartial=function(e,t,n){for(var r=t.replace(/[^ \t]/g,""),i=e.split("\n"),o=0;o<i.length;o++)i[o].length&&(o>0||!n)&&(i[o]=r+i[o]);return i.join("\n")},E.prototype.renderPartial=function(e,t,r,i){if(r){var o=n(r)?r(e[1]):r[e[1]];if(null!=o){var s=e[6],a=e[5],c=e[4],l=o;return 0==a&&c&&(l=this.indentPartial(o,c,s)),this.renderTokens(this.parse(l,i),t,r,l,i)}}},E.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(null!=n)return n},E.prototype.escapedValue=function(e,t){var n=t.lookup(e[1]);if(null!=n)return A.escape(n)},E.prototype.rawValue=function(e){return e[1]};var A={name:"mustache.js",version:"4.0.1",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){S.templateCache=e},get templateCache(){return S.templateCache}},S=new E;return A.clearCache=function(){return S.clearCache()},A.parse=function(e,t){return S.parse(e,t)},A.render=function(e,t,n,i){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+r(e)+'" was given as the first argument for mustache#render(template, view, partials)');return S.render(e,t,n,i)},A.escape=h,A.Scanner=w,A.Context=T,A.Writer=E,A}()},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)},s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.root=t.parseHTML=t.merge=t.contains=t.text=t.xml=t.html=t.load=void 0,o(n(1344),t);var c=n(1345),l=n(1193),u=n(1363),d=a(n(1370)),h=n(800),f=(0,l.getParse)((function(e,t,n,r){return t.xmlMode||t._useHtmlParser2?(0,h.parseDocument)(e,t):(0,u.parseWithParse5)(e,t,n,r)}));t.load=(0,c.getLoad)(f,(function(e,t){return t.xmlMode||t._useHtmlParser2?(0,d.default)(e,t):(0,u.renderWithParse5)(e)})),t.default=(0,t.load)([]);var p=n(884);Object.defineProperty(t,"html",{enumerable:!0,get:function(){return p.html}}),Object.defineProperty(t,"xml",{enumerable:!0,get:function(){return p.xml}}),Object.defineProperty(t,"text",{enumerable:!0,get:function(){return p.text}});var g=s(n(884));t.contains=g.contains,t.merge=g.merge,t.parseHTML=g.parseHTML,t.root=g.root},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var r=n(2),i=n(1273),o=n(316),s=n(711);function a(t,n,a){var l;const u=null!==(l=null==a?void 0:a.modifyMiddleware)&&void 0!==l?l:e=>e,d=new Set(o.c),h=(e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=[n.storexHub.handlePostStorageChange(e),n.contentSharing.handlePostStorageChange(e,{source:t})];"sync"!==t&&r.push(n.personalCloud.handlePostStorageChange(e),n.backupModule.handlePostStorageChange(e)),yield Promise.all(r)})),f=new s.b({moveTree:e=>n.customLists.storage.updateListTreeParent(e),deleteTree:e=>n.contentSharing.performDeleteListAndAllAssociatedData(e)}),p=new i.a({storageManager:t,customOperationWatchers:Object(s.c)({handleListTreeStorageChange:e=>n.personalCloud.handleListTreeStorageChange(e)}),shouldWatchCollection:e=>d.has(e),postprocessOperation:e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield h(e,"local")}))});let g="true"===e.env.LOG_STORAGE_OPERATIONS;return t.setMiddleware(u([c({shouldLog:()=>g}),p,f])),{setStorageLoggingEnabled:e=>g=e}}function c(e){return{process:t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=()=>t.next.process({operation:t.operation});if(!e.shouldLog())return n();const r=[t.operation[0]];"string"==typeof t.operation[1]&&r.push(t.operation[1]);try{const e=yield n();return console.log("done operation",{operation:t.operation,result:e}),e}catch(e){throw console.log("failed operation",{operation:t.operation,result:"error"}),e}}))}}}).call(this,n(131))},function(e,t,n){var r=n(1373),i=n(1374),o=n(193),s=n(41),a=n(347);e.exports=function(e,t,n){var c=s(e)?r:i;return n&&a(e,t,n)&&(t=void 0),c(e,o(t,3))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{handleIncomingMessage(e,t){this.bgModules?"downloadClientUpdates"===e.type&&(this.bgModules.personalCloud.options.backend.events.emit("incomingChangesPending",{changeCountDelta:1}),this.bgModules.personalCloud.invokeSyncDownload()):console.warn("BGModules not yet initialized - skipping incoming sync trigger message")}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),i=n(1161),o=n(315);function s(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield t.fetch(e);if(!n.ok)throw new Error(`PDF fetch failed with HTTP status ${n.status}: ${n.statusText}`);const s=yield n.blob(),a=yield new Promise((function(e,t){const n=new FileReader;n.onload=t=>Object(r.__awaiter)(this,void 0,void 0,(function*(){e(t.target.result)})),n.onerror=e=>t(e.target.error),n.readAsArrayBuffer(s)}));i.GlobalWorkerOptions.workerSrc=t.pdfJSWorkerSrc;const c=yield i.getDocument(a).promise;return Object(o.a)(c)}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),i=n(29),o=n(320),s=n(290);class a{constructor(e){this.options=e,this.uploadImage=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=this.workerUrl+o.b,n={"X-Image-ID":e.id};e.image instanceof Blob&&(n["Content-Type"]=e.image.type),yield globalThis.fetch(t,{method:"POST",headers:n,body:e.image})})),this.getImageUrl=e=>Object(s.a)({id:e.id,env:this.options.env}),this.workerUrl="production"===e.env?i.b.production:i.b.staging}}},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));const r={id:"test@test.com",email:"test@test.com",emailVerified:!0,displayName:"Test User"};var i=n(2),o=n(53);class s{constructor(){this.events=new o.EventEmitter,this.currentUser=null}waitForAuthReady(){return Promise.resolve()}setUser(e){this.currentUser=e,this.events.emit("changed",{user:e})}getCurrentUser(){return Object(i.__awaiter)(this,void 0,void 0,(function*(){return this.currentUser}))}getCurrentToken(){return Object(i.__awaiter)(this,void 0,void 0,(function*(){return this.generateLoginToken()}))}registerWithEmailAndPassword(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function*(){return yield this.loginWithEmailAndPassword(e,t),{result:{status:"registered-and-authenticated"}}}))}generateLoginToken(){return Object(i.__awaiter)(this,void 0,void 0,(function*(){return{token:JSON.stringify({authMockToken:!0,user:this.currentUser})}}))}loginWithToken(e){return Object(i.__awaiter)(this,void 0,void 0,(function*(){const t=JSON.parse(e);if(!t.authMockToken)throw new Error("Tried to log in with invalid token: "+e);this.setUser(t.user)}))}getJWTTokenForFeatureBase(){return Object(i.__awaiter)(this,void 0,void 0,(function*(){return{token:""}}))}loginWithEmailAndPassword(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function*(){if("password"!==t)throw new Error("Tried to log in with invalid password (use 'password'): "+t);this.setUser(Object.assign(Object.assign({},r),{email:e,id:e}))}))}loginWithProvider(e){return Object(i.__awaiter)(this,void 0,void 0,(function*(){const t=`user@${e}.com`;this.setUser(Object.assign(Object.assign({},r),{email:t,id:t}))}))}signupWithEmailAndPassword(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function*(){if("password"!==t)throw new Error("Tried to sign up with invalid password (use 'password'): "+t);this.setUser(Object.assign(Object.assign({},r),{email:e,id:e}))}))}refreshUserInfo(){return Object(i.__awaiter)(this,void 0,void 0,(function*(){}))}signOut(){this.setUser(null)}resetPassword(e){throw new Error("Resetting passwords is not implemented yet in memory auth service")}}const a=e=>{var t;return{id:e.uid,displayName:e.displayName,email:e.email,emailVerified:e.emailVerified,provider:null===(t=e.providerData[0])||void 0===t?void 0:t.providerId,creationTime:e.metadata.creationTime}};class c{constructor(e){this.deps=e,this.events=new o.EventEmitter,e.firebase.getAuth().onAuthStateChanged((e=>{const t=this._getUserFromFirebaseUser(e);this.events.emit("changed",{user:t})}))}waitForAuthReady(){return this._waitForCurrentUser(1e4).then()}getCurrentUser(){var e;return Object(i.__awaiter)(this,void 0,void 0,(function*(){const t=this.deps.firebase.getAuth();return yield null===(e=t.authStateReady)||void 0===e?void 0:e.call(t),this._getUserFromFirebaseUser(t.currentUser)}))}getCurrentToken(){return Object(i.__awaiter)(this,void 0,void 0,(function*(){const e=this.deps.firebase.getAuth().currentUser;return e?{token:yield e.getIdToken()}:{token:null}}))}_waitForCurrentUser(e){return Object(i.__awaiter)(this,void 0,void 0,(function*(){let t;const n=new Promise(((e,n)=>{t=this.deps.firebase.getAuth().onAuthStateChanged((n=>Object(i.__awaiter)(this,void 0,void 0,(function*(){if(!n)return e(null);t(),e(n)}))))})),r=new Promise((n=>setTimeout((()=>{t(),n(null)}),e)));return Promise.race([n,r])}))}refreshUserInfo(){return Object(i.__awaiter)(this,void 0,void 0,(function*(){const e=yield this._waitForCurrentUser(1e3);if(e){try{yield this._callFirebaseFunction("refreshUserClaims")}catch(e){console.error("Failed to refresh user claims:",e)}yield e.reload(),yield e.getIdToken(!0),this.events.emit("changed",{user:yield this.getCurrentUser()})}else console.warn("Failed to refreshUserInfo")}))}generateLoginToken(){return Object(i.__awaiter)(this,void 0,void 0,(function*(){return{token:(yield this._callFirebaseFunction("getLoginToken")).data}}))}getJWTTokenForFeatureBase(){return Object(i.__awaiter)(this,void 0,void 0,(function*(){return{token:(yield this._callFirebaseFunction("getJWTTokenForFeatureBase")).data.encodedTokenForFeatureBase}}))}handlePostLogin(e){var t,n;return Object(i.__awaiter)(this,void 0,void 0,(function*(){const r=a(e);this.events.emit("loginSuccess",{user:r}),yield null===(n=(t=this.deps).onPostLogin)||void 0===n?void 0:n.call(t,a(e))}))}registerWithEmailAndPassword(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function*(){try{const{user:n}=yield this.deps.firebase.createUserWithEmailAndPassword(this.deps.firebase.getAuth(),e,t);return yield this.handlePostLogin(n),{result:{status:"registered-and-authenticated"}}}catch(e){const t=e;return"auth/invalid-email"===t.code?{result:{status:"error",reason:"invalid-email"}}:"auth/email-already-in-use"===t.code?{result:{status:"error",reason:"email-exists"}}:"auth/weak-password"===t.code?{result:{status:"error",reason:"weak-password"}}:(console.error(e),{result:{status:"error",reason:"unknown"}})}}))}loginWithToken(e){return Object(i.__awaiter)(this,void 0,void 0,(function*(){const{user:t}=yield this.deps.firebase.signInWithCustomToken(this.deps.firebase.getAuth(),e);yield this.handlePostLogin(t)}))}loginWithEmailAndPassword(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function*(){const{user:n}=yield this.deps.firebase.signInWithEmailAndPassword(this.deps.firebase.getAuth(),e,t);yield this.handlePostLogin(n)}))}loginWithProvider(e){return Object(i.__awaiter)(this,void 0,void 0,(function*(){const{user:t}=yield this.deps.firebase.signInViaProvider(e);yield this.handlePostLogin(t)}))}resetPassword(e){return Object(i.__awaiter)(this,void 0,void 0,(function*(){yield this.deps.firebase.sendPasswordResetEmail(this.deps.firebase.getAuth(),e)}))}signupWithEmailAndPassword(e,t){return Object(i.__awaiter)(this,void 0,void 0,(function*(){const{user:n}=yield this.deps.firebase.createUserWithEmailAndPassword(this.deps.firebase.getAuth(),e,t);yield this.handlePostLogin(n)}))}signOut(){var e,t;return Object(i.__awaiter)(this,void 0,void 0,(function*(){yield this.deps.firebase.getAuth().signOut(),yield null===(t=(e=this.deps).onPostLogout)||void 0===t?void 0:t.call(e)}))}_getUserFromFirebaseUser(e){var t;return e?{id:e.uid,displayName:e.displayName,email:e.email,emailVerified:e.emailVerified,provider:null===(t=e.providerData[0])||void 0===t?void 0:t.providerId,creationTime:e.metadata.creationTime}:null}_callFirebaseFunction(e,...t){return this.deps.firebase.httpsCallable(this.deps.firebase.getFunctions(),e)(...t)}}class l{constructor(e={}){this.claims=null;const{expiry:t}=e;t&&(this.claims={subscriptions:{},features:{},lastSubscribed:null},this.claims.subscriptions["pro-yearly"]={expiry:t},this.claims.features.backup={expiry:t},this.claims.features.sync={expiry:t})}getCurrentUserClaims(e=!1){return Object(i.__awaiter)(this,void 0,void 0,(function*(){return this.claims}))}getCheckoutLink(e){return Object(i.__awaiter)(this,void 0,void 0,(function*(){return{url:`https://checkout.link?plan=${e.planId}`}}))}getManageLink(e){return Object(i.__awaiter)(this,void 0,void 0,(function*(){return{access_url:"https://manage.link"}}))}}class u{constructor(e,t,n){this.firebase=e,this.getFBAuth=t,this.redirectUrl=n,this.getCurrentUserClaims=(e=!1)=>Object(i.__awaiter)(this,void 0,void 0,(function*(){const t=this.getFBAuth().currentUser;if(null==t)return null;const n=yield t.getIdTokenResult(e);return{features:{},lastSubscribed:null,subscriptions:{},subscriptionExpiry:new Date(n.expirationTime).valueOf()}})),this.getCheckoutLink=e=>Object(i.__awaiter)(this,void 0,void 0,(function*(){e.redirect_url=this.redirectUrl;return(yield this._callFirebaseFunction("getCheckoutLink",e)).data.hosted_page})),this.getManageLink=(e={})=>Object(i.__awaiter)(this,void 0,void 0,(function*(){e.redirect_url=this.redirectUrl,e.forward_url=e.forwardUrl;return(yield this._callFirebaseFunction("getManageLink",e)).data.portal_session}))}_callFirebaseFunction(e,...t){return this.firebase.functiuns().httpsCallable(e)(...t)}}var d=n(724),h=n(517),f=n(896);function p(e){if("memory"===e.backend)return{auth:new s,subscriptions:new l};const t=function(e){var t;const n=e&&e.devAuthState||"";if(""===n||"staging"===n)return{authService:new c(Object.assign(Object.assign({},null!==(t=e.loginHooks)&&void 0!==t?t:{}),{firebase:{getAuth:h.d,getFunctions:f.a,httpsCallable:f.b,signInWithCustomToken:h.f,sendPasswordResetEmail:h.e,signInWithEmailAndPassword:h.g,createUserWithEmailAndPassword:h.c,signInViaProvider:()=>null}})),subscriptionService:new u(Object(d.a)(),h.d,e.redirectUrl)};if("user_signed_out"===n)return{authService:new s,subscriptionService:new l};if("user_signed_in"===n){const e=new s;return e.setUser(r),{authService:e,subscriptionService:new l}}if("user_subscribed"===n){const e=new s;return e.setUser(r),{authService:e,subscriptionService:new l({expiry:Date.now()/1e3+864e5})}}if("user_subscription_expired"===n){const e=new s;return e.setUser(r),{authService:e,subscriptionService:new l({expiry:Date.now()/1e3-36e5})}}if("user_subscription_expires_60s"===n){const e=Date.now()/1e3+6e4;console.log(`Using dev auth state: ${n}, expiring at ${new Date(e).toLocaleString()}`);const t=new s;return t.setUser(r),{authService:t,subscriptionService:new l({expiry:e})}}throw new Error(`Tried to set up auth dependencies with unknown DEV_AUTH_STATE: ${n}`)}({redirectUrl:"https://memex.cloud/auth/chargebee/callback",devAuthState:""});return{auth:t.authService,subscriptions:t.subscriptionService}}},function(e,t,n){"use strict";var r=n(321),i=n(1078);function o(e){const t=e.findIndex((({schema:e})=>null!=e.directLinks));if(-1===t)return e;const n=e[t-1],r={schema:Object.assign(Object.assign({},n.schema),{directLinks:"url, *pageTitle, *body, createdWhen"}),dexieSchemaVersion:n.dexieSchemaVersion+1,storexSchemaVersion:n.storexSchemaVersion};return[...e.slice(0,t),r,...e.slice(t).map((e=>Object.assign(Object.assign({},e),{dexieSchemaVersion:e.dexieSchemaVersion+1})))]}var s=n(709),a=n(595);var c=e=>{let{pathname:t}=Object(a.a)(e);return null==t?new Set:(t=t.replace(/-/g," "),Object(s.a)(t))};const l=e=>"fullUrl"===e.fieldName?c:s.a,u=e=>(e.fieldName,s.a),d=e=>(e.fieldName,s.b);var h=e=>{switch(e.collectionName){case"pages":return l(e);case"annotations":return u(e);default:return d(e)}},f=n(353),p=n(1072);function g(e){const t=new i.a({stemmerSelector:h,schemaPatcher:o,dbName:e.dbName,idbImplementation:e.idbImplementation,legacyMemexCompatibility:!0});for(const e of[new f.a,new p.a,new f.c,new f.b])t.use(e);return new r.b({backend:t})}t.a=()=>g({dbName:"memex",idbImplementation:{factory:self.indexedDB,range:self.IDBKeyRange}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(2),i=n(896),o=n(1073),s=n(779),a=n.n(s),c=n(104);class l{constructor(e){this.options=e,this.follows=[],this.activities=[],this.notificationStates={},this.activityCounter=0,this.followEntity=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this._ensureUserId(`Tried to follow entity wtihout being authenticated: ${e.entityType}, ${e.entity.id}`);this._getFollow(t,{type:e.entityType,id:e.entity.id})||this.follows.push({createdWhen:Date.now(),sourceEntity:{type:"user",id:yield this.options.getCurrentUserId()},targetEntitity:{type:e.entityType,id:e.entity.id},feeds:e.feeds})})),this.unfollowEntity=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this._ensureUserId(`Tried to unfollow entity wtihout being authenticated: ${e.entityType}, ${e.entity.id}`),n=this._getFollowIndex(t,{type:e.entityType,id:e.entity.id});n>=0&&this.follows.splice(n,1)})),this.addActivity=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this._ensureUserId(`Tried to add new activity wtihout being authenticated: ${e.entityType}, ${String(e.activityType)}`),{activity:n}=yield function(e){var t,n;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{contentSharing:r}=e.storage;if("conversationThread"===e.entityType&&"conversationReply"===e.activityType){const i=e.activity,o=yield e.storage.contentConversations.getReply({annotationReference:i.annotationReference,replyReference:i.replyReference});if(!o)throw new Error("Could not concrectize annotation reply activity: reply not found");const s=yield r.getAnnotation({reference:o.sharedAnnotation});if(!s)throw new Error("Could not concrectize annotation reply activity: annotation not found");const c=o.sharedList&&(yield r.getListByReference(o.sharedList));if(o.sharedList&&!c)throw new Error("Could not concretize annotation reply activity: list not found");const l=c&&(yield r.getListEntryByListAndUrl({listReference:c.reference,normalizedPageUrl:o.reply.normalizedPageUrl}));if(o.sharedList&&!l)throw new Error("Could not concretize annotation reply activity: list entry not found");const u=yield r.getPageInfoByCreatorAndUrl({normalizedUrl:o.reply.normalizedPageUrl,creatorReference:null!==(t=null==l?void 0:l.creator)&&void 0!==t?t:s.creatorReference});if(!(null==u?void 0:u.pageInfo))throw new Error("Could not concrectize annotation reply activity: page info not found");const{pageInfo:d,reference:h}=u;d.originalUrl=d.sourceUrl;const[f,p]=yield Promise.all([e.storage.users.getUser(s.creatorReference),e.storage.users.getUser(o.userReference)]);return{activity:{normalizedPageUrl:o.reply.normalizedPageUrl,listEntryId:null===(n=null==l?void 0:l.reference)||void 0===n?void 0:n.id,pageInfo:Object.assign({reference:h},d),replyCreator:Object.assign({reference:o.userReference},p),reply:Object.assign({previousReplyReference:o.previousReply,reference:i.replyReference},o.reply),annotationCreator:Object.assign({reference:s.creatorReference},f),annotation:Object.assign({reference:o.sharedAnnotation},a()(s.annotation,"selector")),sharedList:c&&{reference:c.reference,title:c.title}}}}if("sharedList"===e.entityType&&"sharedListEntry"===e.activityType){const t=e.activity,n=yield r.getListEntryByReference(t.entryReference);if(!n)throw new Error("Could not concretize list entry activity: list entry not found");const i=yield r.getListByReference(n.sharedList);if(!i)throw new Error("Could not concretize list entry activity: list not found");if(Object(c.e)({url:n.normalizedUrl})){const{locators:e}=yield r.getContentLocatorsByUrl({normalizedUrl:n.normalizedUrl,listReference:n.sharedList});e.length>0&&(n.originalUrl=e[0].originalUrl)}const o=n.creator,s=i.creator,[a,l]=yield Promise.all([e.storage.users.getUser(o),e.storage.users.getUser(s)]);if(!a)throw new Error("Could not concretize list entry activity: list entry creator not found");if(!l)throw new Error("Could not concretize list entry activity: list creator not found");return delete n.creator,delete n.sharedList,delete i.creator,{activity:{entry:n,entryCreator:Object.assign({reference:o},a),list:i,listCreator:Object.assign({reference:s},l)}}}if("sharedListEntry"===e.entityType&&"annotationListEntry"===e.activityType){const t=e.activity,n=yield r.getAnnotationEntryByReference(t.annotationEntryReference);if(!n)throw new Error("Could not concretize annotation list entry activity: annotation list entry not found");const[i,o,{annotation:s},a]=yield Promise.all([r.getListByReference(n.sharedList),r.getListEntryByListAndUrl({listReference:n.sharedList,normalizedPageUrl:n.normalizedPageUrl}),r.getAnnotation({reference:n.sharedAnnotation}),e.storage.users.getUser(n.creator)]),c=n.creator;delete n.creator,delete n.sharedList;const l=n.sharedAnnotation;delete n.sharedAnnotation;const u=i.creator;if(delete i.creator,!i)throw new Error("Could not concretize annotation list entry activity: list belonging to annotation entry not found");if(!s)throw new Error("Could not concretize annotation list entry activity: annotation belonging to annotation entry not found");if(!a)throw new Error("Could not concretize annotation list entry activity: annotation creator belonging to annotation entry not found");const[d,h]=yield Promise.all([e.storage.users.getUser(u),e.storage.users.getUser(o.creator)]);if(!d)throw new Error("Could not concretize annotation list entry activity: list creator belonging to annotation entry not found");if(!h)throw new Error("Could not concretize annotation list entry activity: list entry creator belonging to annotation entry not found");const f=yield r.getPageInfoByCreatorAndUrl({normalizedUrl:s.normalizedPageUrl,creatorReference:o.creator});if(!(null==f?void 0:f.pageInfo))throw new Error("Could not concrectize annotation reply activity: page info not found");const{pageInfo:p,reference:g}=f;return{activity:{list:i,listCreator:Object.assign({reference:u},d),listEntryCreator:Object.assign({reference:o.creator},h),annotation:Object.assign({reference:l},s),annotationCreator:Object.assign({reference:c},a),pageInfo:Object.assign({reference:g},p)}}}throw new Error(`Tried to concretize unknown activity: ${e.entityType}, ${String(e.activityType)}`)}))}(Object.assign({storage:this.options.storage},e)),i={id:"act-"+ ++this.activityCounter,createdWhen:Date.now(),entity:{type:e.entityType,id:e.entity.id},userId:t,type:e.activityType,data:n};if(this.activities.push(i),"conversationThread"===e.entityType&&"conversationReply"===e.activityType){const e=n;this.activities.push(Object.assign(Object.assign({},i),{entity:{type:"sharedPageInfo",id:e.pageInfo.reference.id}}))}else if("sharedListEntry"===e.entityType&&"annotationListEntry"===e.activityType){const e=n;this.activities.push(Object.assign(Object.assign({},i),{entity:{type:"sharedPageInfo",id:e.pageInfo.reference.id}}))}e.follow&&(yield this.followEntity({entityType:e.entityType,entity:e.entity,feeds:e.follow}))}))}_getFollow(e,t){const n=this._getFollowIndex(e,t);return n>=0?this.follows[n]:null}_getFollowIndex(e,t){return this.follows.findIndex((n=>"user"===n.sourceEntity.type&&n.sourceEntity.id==e&&n.targetEntitity.type===t.type&&n.targetEntitity.id===t.id))}_followedActivities(e){return this.activities.filter((t=>{if(t.userId===e)return!1;const n=this._getFollow(e,t.entity);return n&&n.createdWhen<=t.createdWhen}))}_ensureUserId(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.options.getCurrentUserId();if(!t)throw new Error(e);return t}))}_getRawHomeFeedActivities(e){var t;return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=yield this._ensureUserId("Tried to get notifications wtihout being authenticated"),r=null!==(t=this.notificationStates[n])&&void 0!==t?t:{seen:new Set,read:new Set};this.notificationStates[n]=r;return function(e,t,n){let r=null;const i=[],o=new Map;for(const s of e){const e=t(s),a=n(e);if(a!==r){if(o.has(a)){const e=o.get(a),t=i.length-1,n=i[e],r=i[t];o.set(n.hash,t),o.set(r.hash,e),i[e]=r,i[t]=n}else o.set(a,i.length),i.push({hash:a,key:e,items:[]});r=a}i[i.length-1].items.push(s)}return i}(this._followedActivities(n),(e=>({id:e.id,entityType:e.entity.type,entity:e.entity,activityType:e.type,activity:e.data})),(e=>`${e.entity.type}${e.entity.id}${e.activityType}`)).reverse().slice(e.offset,e.offset+e.limit)}))}getHomeFeedActivities(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return{hasMore:!1,activityGroups:(yield this._getRawHomeFeedActivities(e)).map((e=>({id:e.items.map((e=>e.id)).join(":"),entityType:e.key.entityType,entity:e.key.entity,activityType:e.key.activityType,activities:e.items.map((e=>({id:e.id,entityType:e.entity.type,entity:e.entity,activityType:e.type,activity:e.data})))})))}}))}getRawFeedActivitiesForDebug(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){return this._getRawHomeFeedActivities(e)}))}getHomeFeedInfo(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const e=yield this.getHomeFeedActivities({offset:0,limit:1});return{latestActivityTimestamp:e.activityGroups.length?e.activityGroups[0].activities[0].activity.reply.createdWhen:null}}))}}var u=n(18);class d{constructor(e){this.deps=e,this.getExistingKeyLinksForList=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return{links:[{link:this.getKeyLink({listReference:e.listReference}),roleID:u.a.Commenter},...(yield this.deps.serverStorage.getListKeys({listReference:e.listReference})).map((t=>{const n=t.reference.id.toString();return{keyString:n,roleID:t.roleID,link:this.getKeyLink({listReference:e.listReference,keyString:n})}}))]}})),this.generateKeyLink=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){let t;if(e.key.roleID!==u.a.Commenter){t=(yield this.deps.serverStorage.createListKey(e)).keyString}return{keyString:t,roleID:e.key.roleID,link:this.getKeyLink({listReference:e.listReference,keyString:t})}})),this.deleteKeyLink=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){yield this.deps.serverStorage.deleteListKey({listReference:e.listReference,keyString:this.getKeyStringFromLink(e)})}))}getKeyStringFromLink(e){const t=e.link.match(/\?key=(\w+)/);if(null==t||t.length<2)throw new Error("Could not find key string in link");return t[1]}}var h=n(36);class f extends d{constructor(){super(...arguments),this.getCurrentKey=()=>{throw new Error("TODO: Implement me")},this.hasCurrentKey=()=>{throw new Error("TODO: Implement me")},this.processCurrentKey=()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){throw new Error("TODO: Implement me")}))}getKeyLink(e){const t=Object(h.e)({remoteListId:e.listReference.id});return e.keyString?`${t}?key=${e.keyString}`:t}}class p{constructor(e){this.options=e,this.submitReply=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const{services:t,storage:n}=this.options,r=yield t.auth.getCurrentUser();if(!r)return{status:"not-authenticated"};if(!e.reply.content.trim().length)return{status:"failure",error:new Error("Cannot create an empty reply")};try{const{reference:t}=yield n.contentConversations.createReply(Object.assign({userReference:{id:r.id,type:"user-reference"}},e));return{status:"success",replyReference:t}}catch(e){return{status:"failure",error:e}}})),this.deleteReply=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.options.services.auth.getCurrentUser();if(!t)return{status:"not-authenticated"};try{return(yield this.hasReplyChangeAuthorization(t,e.replyReference,e.annotationReference))?(yield this.options.storage.contentConversations.deleteReply({replyReference:e.replyReference,annotationReference:e.annotationReference}),{status:"success"}):{status:"not-authenticated"}}catch(e){return{status:"failure",error:e}}})),this.editReply=e=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield this.options.services.auth.getCurrentUser();if(!t)return{status:"not-authenticated"};try{return(yield this.hasReplyChangeAuthorization(t,e.replyReference,e.annotationReference))?(yield this.options.storage.contentConversations.editReply({content:e.content,replyReference:e.replyReference,annotationReference:e.annotationReference}),{status:"success",replyReference:e.replyReference}):{status:"not-authenticated"}}catch(e){return{status:"failure",error:e}}}))}hasReplyChangeAuthorization({id:e},t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=yield this.options.storage.contentConversations.getReply({replyReference:t,annotationReference:n});return(null==r?void 0:r.userReference.id)===e}))}}function g(e){const{modules:t}=e.serverStorage;return"memory"===e.backend?{contentSharing:new f({serverStorage:t.contentSharing}),contentConversations:new p({services:{auth:e.authService},storage:{contentConversations:t.contentConversations}}),activityStreams:new l({storage:{contentConversations:t.contentConversations,contentSharing:t.contentSharing,users:t.users},getCurrentUserId:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){var t;const n=yield e.authService.getCurrentUser();return null!==(t=null==n?void 0:n.id)&&void 0!==t?t:null}))})}:{contentSharing:new f({serverStorage:t.contentSharing}),contentConversations:new p({services:{auth:e.authService},storage:{contentConversations:t.contentConversations}}),activityStreams:new o.a({executeCall:(e,t)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){return(yield Object(i.b)(Object(i.a)(),e)(t)).data}))})}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2);class i extends Error{constructor(e,t){super(e),this.type=t,Object.setPrototypeOf(this,new.target.prototype)}get isTempFailure(){return"temporary"===this.type}}var o=n(777),s=n(511);var a=(e,t=document)=>{try{return function(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield fetch(e);if(t.status>=400&&t.status<600)throw new Error(`Bad response from server: ${t.status}`);const n=yield t.blob();return Object(s.a)(n)}catch(e){return null}}))}(function(e,t){const n=t.querySelector('link[rel*="icon"]'),r=new URL(e);if(null==n?void 0:n.href){let e=n.href;n.href.startsWith("/")&&(e=r.protocol+"//"+r.hostname+n.href);const t=new URL(e);return t.protocol.startsWith("chrome-extension")?e.replace(t.origin,r.origin):e}return`${r.origin}/favicon.ico`}(e,t))}catch(e){return void console.log(e)}};function c(e,t){const n=new AbortController;return{cancel:()=>n.abort(),run:()=>Object(r.__awaiter)(this,void 0,void 0,(function*(){try{const o=yield function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=new AbortController;n.signal&&n.signal.addEventListener("abort",(()=>r.abort()));const i=setTimeout((()=>r.abort()),t),o=yield n.fetch(e,{signal:n.signal});return clearTimeout(i),o}))}(e,t.timeout,{fetch:t.fetch,signal:n.signal});200!==o.status&&function(e){switch(e){case 429:throw new i("Too many requests to server","temporary");case 500:case 503:case 504:throw new i(e+" Server currently unavailable","temporary");default:throw new i(e+" Data fetch failed","permanent")}}(o.status);const s=yield o.text();return t.domParser(s)}catch(e){throw"AbortError"===e.name?new i("Data fetch timeout","temporary"):e}}))}}const l={includePageContent:!1,includeFavIcon:!1},u=({url:e,fetch:t,domParser:n,timeout:s=1e4,transformPageHTML:u,opts:d=l})=>{const h=c(e,{timeout:s,domParser:n,fetch:t});return{cancel:h.cancel,run:function(){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=yield h.run();if(!t)throw new i("Cannot fetch DOM","temporary");const n=Object(o.a)(t,e),r={htmlBody:n.body},s=t.title;if(d.includePageContent){const e=u({html:n.body}).text;r.content=Object.assign(Object.assign({},n),{fullText:e,title:s})}return d.includeFavIcon&&(r.favIconURI=yield a(e,t)),r}))}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return K}));n(1167);var r=n(201),i=n(697),o=n(30),s=n(74);const a="/firebase-messaging-sw.js",c="/firebase-cloud-messaging-push-scope",l="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",u="https://fcmregistrations.googleapis.com/v1",d="google.c.a.c_id";var h,f;function p(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function g(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let e=0;e<n.length;++e)r[e]=n.charCodeAt(e);return r}!function(e){e[e.DATA_MESSAGE=1]="DATA_MESSAGE",e[e.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"}(h||(h={})),function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(f||(f={}));const m="fcm_token_details_db",y=5,v="fcm_token_object_Store";const b="firebase-messaging-database",_=1,w="firebase-messaging-store";let T=null;function E(){return T||(T=Object(i.openDB)(b,_,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(w)}})),T}async function A(e){const t=O(e),n=await E(),r=await n.transaction(w).objectStore(w).get(t);if(r)return r;{const t=await async function(e){if("databases"in indexedDB){const e=(await indexedDB.databases()).map((e=>e.name));if(!e.includes(m))return null}let t=null;return(await Object(i.openDB)(m,y,{upgrade:async(n,r,i,o)=>{var s;if(r<2)return;if(!n.objectStoreNames.contains(v))return;const a=o.objectStore(v),c=await a.index("fcmSenderId").get(e);if(await a.clear(),c)if(2===r){const e=c;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(s=e.createTime)&&void 0!==s?s:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"==typeof e.vapidKey?e.vapidKey:p(e.vapidKey)}}}else if(3===r){const e=c;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:p(e.auth),p256dh:p(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:p(e.vapidKey)}}}else if(4===r){const e=c;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:p(e.auth),p256dh:p(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:p(e.vapidKey)}}}}})).close(),await Object(i.deleteDB)(m),await Object(i.deleteDB)("fcm_vapid_details_db"),await Object(i.deleteDB)("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}(t)?t:null}(e.appConfig.senderId);if(t)return await S(e,t),t}}async function S(e,t){const n=O(e),r=(await E()).transaction(w,"readwrite");return await r.objectStore(w).put(t,n),await r.done,t}function O({appConfig:e}){return e.appId}const I={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},C=new o.ErrorFactory("messaging","Messaging",I);async function k(e,t){const n={method:"DELETE",headers:await x(e)};try{const r=await fetch(`${P(e.appConfig)}/${t}`,n),i=await r.json();if(i.error){const e=i.error.message;throw C.create("token-unsubscribe-failed",{errorInfo:e})}}catch(e){throw C.create("token-unsubscribe-failed",{errorInfo:null==e?void 0:e.toString()})}}function P({projectId:e}){return`${u}/projects/${e}/registrations`}async function x({appConfig:e,installations:t}){const n=await t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function R({p256dh:e,auth:t,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:t,p256dh:e}};return r!==l&&(i.web.applicationPubKey=r),i}const L=6048e5;async function D(e){const t=await async function(e,t){const n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!1,applicationServerKey:g(t)})}(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:p(t.getKey("auth")),p256dh:p(t.getKey("p256dh"))},r=await A(e.firebaseDependencies);if(r){if(function(e,t){const n=t.vapidKey===e.vapidKey,r=t.endpoint===e.endpoint,i=t.auth===e.auth,o=t.p256dh===e.p256dh;return n&&r&&i&&o}(r.subscriptionOptions,n))return Date.now()>=r.createTime+L?async function(e,t){try{const n=await async function(e,t){const n=await x(e),r=R(t.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let o;try{const n=await fetch(`${P(e.appConfig)}/${t.token}`,i);o=await n.json()}catch(e){throw C.create("token-update-failed",{errorInfo:null==e?void 0:e.toString()})}if(o.error){const e=o.error.message;throw C.create("token-update-failed",{errorInfo:e})}if(!o.token)throw C.create("token-update-no-token");return o.token}(e.firebaseDependencies,t),r=Object.assign(Object.assign({},t),{token:n,createTime:Date.now()});return await S(e.firebaseDependencies,r),n}catch(e){throw e}}(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await k(e.firebaseDependencies,r.token)}catch(e){console.warn(e)}return N(e.firebaseDependencies,n)}return N(e.firebaseDependencies,n)}async function N(e,t){const n=await async function(e,t){const n=await x(e),r=R(t),i={method:"POST",headers:n,body:JSON.stringify(r)};let o;try{const t=await fetch(P(e.appConfig),i);o=await t.json()}catch(e){throw C.create("token-subscribe-failed",{errorInfo:null==e?void 0:e.toString()})}if(o.error){const e=o.error.message;throw C.create("token-subscribe-failed",{errorInfo:e})}if(!o.token)throw C.create("token-subscribe-no-token");return o.token}(e,t),r={token:n,createTime:Date.now(),subscriptionOptions:t};return await S(e,r),r.token}function j(e){const t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(!t.notification)return;e.notification={};const n=t.notification.title;n&&(e.notification.title=n);const r=t.notification.body;r&&(e.notification.body=r);const i=t.notification.image;i&&(e.notification.image=i);const o=t.notification.icon;o&&(e.notification.icon=o)}(t,e),function(e,t){if(!t.data)return;e.data=t.data}(t,e),function(e,t){var n,r,i,o,s;if(!t.fcmOptions&&!(null===(n=t.notification)||void 0===n?void 0:n.click_action))return;e.fcmOptions={};const a=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(o=t.notification)||void 0===o?void 0:o.click_action;a&&(e.fcmOptions.link=a);const c=null===(s=t.fcmOptions)||void 0===s?void 0:s.analytics_label;c&&(e.fcmOptions.analyticsLabel=c)}(t,e),t}function M(e,t){const n=[];for(let r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function F(e){return C.create("missing-app-config-values",{valueName:e})}M("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),M("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class U{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=function(e){if(!e||!e.options)throw F("App Configuration Object");if(!e.name)throw F("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const e of t)if(!n[e])throw F(e);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}async function B(e){try{e.swRegistration=await navigator.serviceWorker.register(a,{scope:c}),e.swRegistration.update().catch((()=>{}))}catch(e){throw C.create("failed-service-worker-registration",{browserErrorMessage:null==e?void 0:e.message})}}async function G(e,t){if(!navigator)throw C.create("only-available-in-window");if("default"===Notification.permission&&await Notification.requestPermission(),"granted"!==Notification.permission)throw C.create("permission-blocked");return await async function(e,t){t?e.vapidKey=t:e.vapidKey||(e.vapidKey=l)}(e,null==t?void 0:t.vapidKey),await async function(e,t){if(t||e.swRegistration||await B(e),t||!e.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw C.create("invalid-sw-registration");e.swRegistration=t}}(e,null==t?void 0:t.serviceWorkerRegistration),D(e)}async function q(e,t,n){const r=function(e){switch(e){case f.NOTIFICATION_CLICKED:return"notification_open";case f.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t);(await e.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[d],message_name:n["google.c.a.c_l"],message_time:n["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)})}async function H(e,t){const n=t.data;if(!n.isFirebaseMessaging)return;e.onMessageHandler&&n.messageType===f.PUSH_RECEIVED&&("function"==typeof e.onMessageHandler?e.onMessageHandler(j(n)):e.onMessageHandler.next(j(n)));const r=n.data;var i;"object"==typeof(i=r)&&i&&d in i&&"1"===r["google.c.a.e"]&&await q(e,n.messageType,r)}const $="@firebase/messaging",W="0.12.8",z=e=>{const t=new U(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",(e=>H(t,e))),t},V=e=>{const t=e.getProvider("messaging").getImmediate();return{getToken:e=>G(t,e)}};async function K(e,t){return G(e=Object(o.getModularInstance)(e),t)}Object(s._registerComponent)(new r.Component("messaging",z,"PUBLIC")),Object(s._registerComponent)(new r.Component("messaging-internal",V,"PRIVATE")),Object(s.registerVersion)($,W),Object(s.registerVersion)($,W,"esm2017")},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var r=n(2),i=n(1042),o=n.n(i),s=n(1160),a=n.n(s),c=n(359),l=n.n(c),u=n(768),d=n.n(u);var h=n(877),f=n(73),p=n(162),g=n(107),m=n(98);const y=e=>t=>{const n=a()(function(e,t=50){return(e=e.replace(/^https?:\/\//i,"")).length>t&&(e=e.slice(0,t-3)+"..."),e}(t.url)),r=a()(t.title),i=function(e,t){const n=Object(m.b)(Date.now(),e,"days")<=7;return t?n?`\ud83d\udd52 ${Object(m.d)(e,"HH:mm a ddd")}`:`\ud83d\udd52 ${Object(m.d)(e,"HH:mm a D/M/YYYY")}`:n?Object(m.d)(e,"ddd"):Object(m.d)(e,"D/M/YYYY")}(t.displayTime,e);return{content:t.url,description:"firefox"===Object(p.a)()?`${n} ${r} - ${i}`:`<url>${n}</url> <dim>${r}</dim> - ${i}`}};function v(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=t=>e.browserAPIs.omnibox.setDefaultSuggestion({description:t});let n,i;e.browserAPIs.omnibox.onInputChanged.addListener(o()(500)((function(o,s){return Object(r.__awaiter)(this,void 0,void 0,(function*(){if(n=o,""===o.trim())return t("Enter keywords or start with # to filter by tags"),s([]),void(i=o);t("Searching...(press enter to search in Dashboard)");const r=i,a=Object(h.a)(o),c=yield e.bgModules.search.unifiedSearch({untilWhen:a.to,fromWhen:a.from,query:a.query,filterByDomains:[],filterByListIds:[],limit:5,skip:0});if(n!==o&&i!==r)return;c.docs.length?c.resultsExhausted||t("Found more results - press ENTER to view ALL ."):t("No results found for this query.");const l=c.docs.slice(0,5).map(y(a.from||a.to));s(l),i=o}))}))),e.browserAPIs.omnibox.onInputEntered.addListener(((t,n)=>Object(r.__awaiter)(this,void 0,void 0,(function*(){const r=l()().test(t)?t:(e=>{const t=Object(h.a)(e),n=d.a.stringify(t);return`${f.c}?${n}`})(t);switch(yield Object(g.a)(),n){case"currentTab":e.browserAPIs.tabs.update({url:r});break;case"newForegroundTab":e.browserAPIs.tabs.create({url:r});break;case"newBackgroundTab":e.browserAPIs.tabs.create({url:r,active:!1})}}))))}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(2),i=n(1055),o=n.n(i),s=n(1251),a=n.n(s),c=n(295);const l={shouldWatchOperation(e){const t=e.operation[1];return e.shouldWatchCollection(t)},getInfoBeforeExecution(e){const{operation:t}=e,[n,r,i]=t,o=Object(c.d)(i,r,e.storageManager.registry),s=!!o&&(!(o instanceof Array)||a()(o));return{changes:[Object.assign({type:"create",collection:r,values:Object(c.f)(i,r,e.storageManager.registry)},s?{pk:o}:{})]}},getInfoAfterExecution(e){const{operation:t}=e,[n,r]=t;return{changes:[{type:"create",collection:t[1],pk:Object(c.d)(e.result.object,r,e.storageManager.registry),values:Object(c.f)(t[2],r,e.storageManager.registry)}]}}},u={shouldWatchOperation(e){const t=e.operation[1];return e.shouldWatchCollection(t)},getInfoBeforeExecution(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{operation:t}=e,n=t[1],r=yield f(t,e.storageManager);return{changes:[{type:"modify",collection:t[1],where:t[2],updates:t[3],pks:r.map((t=>Object(c.d)(t,n,e.storageManager.registry)))}]}}))},transformOperation(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=[];let n=-1;for(const r of e.info.changes){if("modify"!==r.type)throw new Error("Something weird happened in updateObject change watcher during operation transform");const i=e.storageManager.registry.collections[r.collection];if("string"==typeof i.pkIndex)n+=1,t.push({placeholder:`change-${n}`,operation:"updateObjects",collection:r.collection,where:{[i.pkIndex]:{$in:r.pks}},updates:r.updates});else for(const e of r.pks)n+=1,t.push({placeholder:`change-${n}`,operation:"updateObjects",collection:r.collection,where:p(e,i),updates:r.updates})}return["executeBatch",t]}))},getInfoAfterExecution(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{operation:t}=e,n=t[1],r=e.preInfo.changes[0];if("modify"!==r.type)throw new Error("Something weird happened in updateObject change watcher");return{changes:[{type:"modify",collection:n,where:t[2],updates:t[3],pks:r.pks}]}}))}},d={shouldWatchOperation(e){const t=e.operation[1];return e.shouldWatchCollection(t)},getInfoBeforeExecution(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{operation:t}=e,n=t[1],r=yield f(t,e.storageManager);return{changes:[{type:"delete",collection:t[1],where:t[2],pks:r.map((t=>Object(c.d)(t,n,e.storageManager.registry)))}]}}))},transformOperation(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=[];let n=-1;for(const r of e.info.changes){if("delete"!==r.type)throw new Error("Something weird happened in updateObject change watcher during operation transform");const i=e.storageManager.registry.collections[r.collection];if("string"==typeof i.pkIndex)n+=1,t.push({placeholder:`change-${n}`,operation:"deleteObjects",collection:r.collection,where:{[i.pkIndex]:{$in:r.pks}}});else for(const e of r.pks)n+=1,t.push({placeholder:`change-${n}`,operation:"deleteObjects",collection:r.collection,where:p(e,i)})}return["executeBatch",t]}))},getInfoAfterExecution(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const{operation:t}=e,n=t[1],r=e.preInfo.changes[0];if("delete"!==r.type)throw new Error("Something weird happened in updateObject change watcher");return{changes:[{type:"delete",collection:n,where:t[2],pks:r.pks}]}}))}},h={shouldWatchOperation(e){const t=e.operation[1];for(const n of t)if(e.shouldWatchCollection(n.collection))return!0;return!1},getInfoBeforeExecution(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=e.operation[1],n=[],r=e=>{n.push(...e.changes)};for(const n of t)if(e.shouldWatchCollection(n.collection)){if(!n.placeholder&&"createObject"===n.operation)throw new Error("ChangeWatchMiddleware cannot handle executeBatch createObject operations without placeholders");if("createObject"===n.operation)r(yield l.getInfoBeforeExecution({operation:["createObject",n.collection,n.args],storageManager:e.storageManager,shouldWatchCollection:e.shouldWatchCollection}));else if("updateObjects"===n.operation)r(yield u.getInfoBeforeExecution({operation:["updateObjects",n.collection,n.where,n.updates],storageManager:e.storageManager,shouldWatchCollection:e.shouldWatchCollection}));else{if("deleteObjects"!==n.operation)throw new Error(`Change watcher middleware encountered unknown batch operation: ${n.operation}`);r(yield d.getInfoBeforeExecution({operation:["deleteObjects",n.collection,n.where],storageManager:e.storageManager,shouldWatchCollection:e.shouldWatchCollection}))}}return{changes:n}}))},getInfoAfterExecution(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=e.operation[1],n=[],r=e=>{n.push(...e.changes)};let i=-1;for(const n of t)if(e.shouldWatchCollection(n.collection))if(i+=1,"createObject"===n.operation)r(yield l.getInfoAfterExecution({operation:["createObject",n.collection,n.args],preInfo:{changes:[e.preInfo.changes[i]]},storageManager:e.storageManager,result:e.result.info[n.placeholder],shouldWatchCollection:e.shouldWatchCollection}));else if("updateObjects"===n.operation)r(yield u.getInfoAfterExecution({operation:["updateObjects",n.collection,n.where,n.updates],preInfo:{changes:[e.preInfo.changes[i]]},storageManager:e.storageManager,result:e.result,shouldWatchCollection:e.shouldWatchCollection}));else{if("deleteObjects"!==n.operation)throw new Error(`Change watcher middleware encountered unknown batch operation: ${n.operation}`);r(yield d.getInfoAfterExecution({operation:["deleteObjects",n.collection,n.where],preInfo:{changes:[e.preInfo.changes[i]]},storageManager:e.storageManager,result:e.result,shouldWatchCollection:e.shouldWatchCollection}))}return{changes:n}}))}};function f(e,t){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const n=e[1];return t.operation("findObjects",n,e[2])}))}function p(e,t){const n={};let r=-1;for(const i of t.pkIndex){if(r+=1,"string"!=typeof i)throw new Error(`Collection ${t.name} has primary type unsupported by change watch middleware`);n[i]=e[r]}return n}const g={createObject:l,updateObject:u,updateObjects:u,deleteObject:d,deleteObjects:d,executeBatch:h};class m{constructor(e){var t,n,r;this.options=e,this.enabled=!0,this.getCollectionDefinition=null!==(t=e.getCollectionDefinition)&&void 0!==t?t:t=>e.storageManager.registry.collections[t],this.operationWatchers=null!==(n=e.operationWatchers)&&void 0!==n?n:g,this.customOperationWatchers=null!==(r=e.customOperationWatchers)&&void 0!==r?r:{}}process(e){return Object(r.__awaiter)(this,void 0,void 0,(function*(){const t=o()(e.operation);let n;const r=r=>(r||(r={changes:[]}),e.next.process({operation:n||o()(t),extraData:{changeInfo:r}}));if(!this.enabled)return r();const i=this.customOperationWatchers[e.operation[0]];if(null!=i){const{skipNextMiddlewares:t}=yield i(e.operation);if(t)return;return r()}const s=this.operationWatchers[e.operation[0]];if(!s)return r();if(!s.shouldWatchOperation({operation:t,shouldWatchCollection:this.options.shouldWatchCollection}))return r();const a=yield s.getInfoBeforeExecution({operation:t,storageManager:this.options.storageManager,shouldWatchCollection:this.options.shouldWatchCollection}),c={changes:a.changes.filter((e=>this.options.shouldWatchCollection(e.collection)))};if(!c.changes.length)return r();s.transformOperation&&(n=(yield s.transformOperation({originalOperation:t,storageManager:this.options.storageManager,info:c,shouldWatchCollection:this.options.shouldWatchCollection}))||void 0),this.options.preprocessOperation&&(yield this.options.preprocessOperation({originalOperation:t,modifiedOperation:n,info:c}));const l=yield r(c),u=yield s.getInfoAfterExecution({operation:t,preInfo:a,result:l,storageManager:this.options.storageManager,shouldWatchCollection:this.options.shouldWatchCollection});return this.options.postprocessOperation&&(yield this.options.postprocessOperation({originalOperation:t,modifiedOperation:n,info:u})),l}))}}},function(e,t,n){n(362),e.exports=n(1275)},function(e,t,n){"use strict";n.r(t),function(e){var t=n(2),r=n(3),i=n.n(r),o=n(1236),s=n.n(o),a=n(705),c=n(894),l=n(1271),u=n(1157),d=n(6),h=n(1237),f=n(49),p=n(1166),g=n(726),m=n(1268),y=n(1239),v=n(724),b=n(1269),_=n(1084),w=n(52),T=n(1250),E=n(1068),A=n(1267),S=n(1252),O=n(1272),I=n(1270),C=n(1253),k=n(1254),P=n(19);e.XMLHttpRequest=s.a,function(){return Object(t.__awaiter)(this,void 0,void 0,(function*(){const e=Object(d.o)({browserAPIs:i.a,sideName:"background",role:"background",paused:!0}),n=Object(v.a)(),r=Object(u.getMessaging)(),o=new S.a;Object(u.onBackgroundMessage)(r,(e=>{const t=e.data;null!=t&&o.handleIncomingMessage(t)}));const s=new h.a({storage:i.a.storage});Object(f.c)({});const x=Object(p.b)(),R=yield Object(p.a)(x,{autoPkType:"string"}),L=Object(m.a)(),D=Object(y.a)({idbImplementation:{factory:self.indexedDB,range:self.IDBKeyRange}}),N=Object(A.a)({backend:"firebase"}),j=Object(b.a)({backend:"firebase",serverStorage:R,authService:N.auth}),M=globalThis.fetch.bind(globalThis),F=Object(_.a)({manifestVersion:"3",authServices:N,services:j,serverStorage:R,analyticsManager:w.a,localStorageChangesManager:s,fetchPageData:e=>Object(t.__awaiter)(this,void 0,void 0,(function*(){return Object(I.a)({url:e,fetch:M,transformPageHTML:c.a,domParser:e=>Object(a.a)(e).document,opts:{includePageContent:!0,includeFavIcon:!0}}).run()})),fetchPDFData:e=>Object(t.__awaiter)(this,void 0,void 0,(function*(){return Object(C.a)(e,{fetch:M,pdfJSWorkerSrc:i.a.runtime.getURL("/build/pdf.worker.js")})})),fetch:M,browserAPIs:i.a,captureException:f.b,storageManager:L,persistentStorageManager:D,callFirebaseFunction:(e,...r)=>Object(t.__awaiter)(this,void 0,void 0,(function*(){const t=n.functions().httpsCallable(e);try{return(yield t(...r)).data}catch(t){throw Object(f.b)(t,{extra:Object.assign({name:e},r)}),t}})),getFCMRegistrationToken:()=>Object(l.a)(r,{vapidKey:"BEfB93dpFiALDvySpcaiBkxrhKsPxl24xuCeltYXLfOQuvZhiMFccBkvzd0n749CF73UleDPwyPWxq-ox6jX0_I",serviceWorkerRegistration:self.registration}),imageSupportBackend:new k.a({env:"production"}),backendEnv:"production"});o.bgModules=F,N.auth.events.on("loginSuccess",(()=>{F.personalCloud.invokeSyncDownload()})),Object(_.b)({storageManager:L,persistentStorageManager:D,backgroundModules:F}),L.backend._onRegistryInitialized();const{setStorageLoggingEnabled:U}=Object(T.a)(L,F);yield L.finishInitialization(),yield D.finishInitialization(),yield Object(_.c)(F,L,i.a),Object(E.a)(L),Object(O.a)({browserAPIs:i.a,bgModules:F}),Object(d.n)({auth:F.auth.remoteFunctions,analytics:F.analytics.remoteFunctions,subscription:{getCheckoutLink:F.auth.subscriptionService.getCheckoutLink,getManageLink:F.auth.subscriptionService.getManageLink,getCurrentUserClaims:F.auth.subscriptionService.getCurrentUserClaims},notifications:{create:g.a},bookmarks:F.bookmarks.remoteFunctions,featuresBeta:F.featuresBeta,tags:F.tags.remoteFunctions,collections:F.customLists.remoteFunctions,readablePageArchives:F.readable.remoteFunctions,copyPaster:F.copyPaster.remoteFunctions,contentSharing:F.contentSharing.remoteFunctions,personalCloud:F.personalCloud.remoteFunctions,pageActivityIndicator:F.pageActivityIndicator.remoteFunctions,pdf:F.pdfBg.remoteFunctions,analyticsBG:F.analyticsBG}),e.unpause(),globalThis.bgServices=j,globalThis.storageMan=L,globalThis.bgModules=F,globalThis.serverStorage=R,globalThis.persistentStorageManager=D,globalThis.setStorageLoggingEnabled=U,globalThis.normalizeUrl=P.c}))}().catch((e=>{throw Object(f.b)(e),e}))}.call(this,n(61))},function(e,t,n){"use strict";const r=(e,t)=>t.some((t=>e instanceof t));let i,o;const s=new WeakMap,a=new WeakMap,c=new WeakMap,l=new WeakMap,u=new WeakMap;let d={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return a.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return p(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function h(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(o||(o=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(g(this),t),p(s.get(this))}:function(...t){return p(e.apply(g(this),t))}:function(t,...n){const r=e.call(g(this),t,...n);return c.set(r,t.sort?t.sort():[t]),p(r)}}function f(e){return"function"==typeof e?h(e):(e instanceof IDBTransaction&&function(e){if(a.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)}));a.set(e,t)}(e),r(e,i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,d):e)}function p(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(p(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)}));return t.then((t=>{t instanceof IDBCursor&&s.set(t,e)})).catch((()=>{})),u.set(t,e),t}(e);if(l.has(e))return l.get(e);const t=f(e);return t!==e&&(l.set(e,t),u.set(t,e)),t}const g=e=>u.get(e);t.instanceOfAny=r,t.replaceTraps=function(e){d=e(d)},t.reverseTransformCache=u,t.unwrap=g,t.wrap=p},function(e,t,n){var r=n(785),i=n(134);e.exports=function(e,t){var n=-1,o=i(e)?Array(e.length):[];return r(e,(function(e,r,i){o[++n]=t(e,r,i)})),o}},function(e,t){e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},function(e,t,n){var r=n(1280);e.exports=function(e,t,n){for(var i=-1,o=e.criteria,s=t.criteria,a=o.length,c=n.length;++i<a;){var l=r(o[i],s[i]);if(l)return i>=c?l:l*("desc"==n[i]?-1:1)}return e.index-t.index}},function(e,t,n){var r=n(115);e.exports=function(e,t){if(e!==t){var n=void 0!==e,i=null===e,o=e==e,s=r(e),a=void 0!==t,c=null===t,l=t==t,u=r(t);if(!c&&!u&&!s&&e>t||s&&a&&l&&!c&&!u||i&&a&&l||!n&&l||!o)return 1;if(!i&&!s&&!u&&e<t||u&&n&&o&&!i&&!s||c&&n&&o||!a&&o||!l)return-1}return 0}},function(e,t,n){var r=n(232)("isArray",n(41),n(787));r.placeholder=n(164),e.exports=r},function(e,t,n){var r=n(232)("fromPairs",n(56));r.placeholder=n(164),e.exports=r},function(e,t,n){(function(e){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},i=/%[sdj%]/g;t.format=function(e){if(!y(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(a(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,s=String(e).replace(i,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),c=r[n];n<o;c=r[++n])g(c)||!_(c)?s+=" "+c:s+=" "+a(c);return s},t.deprecate=function(n,r){if(void 0!==e&&!0===e.noDeprecation)return n;if(void 0===e)return function(){return t.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var o,s={};function a(e,n){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&t._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),u(r,e,r.depth)}function c(e,t){var n=a.styles[t];return n?"\x1b["+a.colors[n][0]+"m"+e+"\x1b["+a.colors[n][1]+"m":e}function l(e,t){return e}function u(e,n,r){if(e.customInspect&&n&&E(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return y(i)||(i=u(e,i,r)),i}var o=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(y(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(m(t))return e.stylize(""+t,"number");if(p(t))return e.stylize(""+t,"boolean");if(g(t))return e.stylize("null","null")}(e,n);if(o)return o;var s=Object.keys(n),a=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(n)),T(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return d(n);if(0===s.length){if(E(n)){var c=n.name?": "+n.name:"";return e.stylize("[Function"+c+"]","special")}if(b(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return e.stylize(Date.prototype.toString.call(n),"date");if(T(n))return d(n)}var l,_="",A=!1,S=["{","}"];(f(n)&&(A=!0,S=["[","]"]),E(n))&&(_=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(_=" "+RegExp.prototype.toString.call(n)),w(n)&&(_=" "+Date.prototype.toUTCString.call(n)),T(n)&&(_=" "+d(n)),0!==s.length||A&&0!=n.length?r<0?b(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),l=A?function(e,t,n,r,i){for(var o=[],s=0,a=t.length;s<a;++s)I(t,String(s))?o.push(h(e,t,n,r,String(s),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(h(e,t,n,r,i,!0))})),o}(e,n,r,a,s):s.map((function(t){return h(e,n,r,a,t,A)})),e.seen.pop(),function(e,t,n){var r=e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(r>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(l,_,S)):S[0]+_+S[1]}function d(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,n,r,i,o){var s,a,c;if((c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),I(r,i)||(s="["+i+"]"),a||(e.seen.indexOf(c.value)<0?(a=g(n)?u(e,c.value,null):u(e,c.value,n-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),v(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function f(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function g(e){return null===e}function m(e){return"number"==typeof e}function y(e){return"string"==typeof e}function v(e){return void 0===e}function b(e){return _(e)&&"[object RegExp]"===A(e)}function _(e){return"object"==typeof e&&null!==e}function w(e){return _(e)&&"[object Date]"===A(e)}function T(e){return _(e)&&("[object Error]"===A(e)||e instanceof Error)}function E(e){return"function"==typeof e}function A(e){return Object.prototype.toString.call(e)}function S(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(v(o)&&(o=e.env.NODE_DEBUG||""),n=n.toUpperCase(),!s[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var r=e.pid;s[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,r,e)}}else s[n]=function(){};return s[n]},t.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=f,t.isBoolean=p,t.isNull=g,t.isNullOrUndefined=function(e){return null==e},t.isNumber=m,t.isString=y,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=v,t.isRegExp=b,t.isObject=_,t.isDate=w,t.isError=T,t.isFunction=E,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(1284);var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function I(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){var e,n;console.log("%s - %s",(e=new Date,n=[S(e.getHours()),S(e.getMinutes()),S(e.getSeconds())].join(":"),[e.getDate(),O[e.getMonth()],n].join(" ")),t.format.apply(t,arguments))},t.inherits=n(473),t._extend=function(e,t){if(!t||!_(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var C="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function k(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(C&&e[C]){var t;if("function"!=typeof(t=e[C]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,C,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,i)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),C&&Object.defineProperty(t,C,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=C,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,s=function(){return i.apply(o,arguments)};t.apply(this,n).then((function(t){e.nextTick(s,null,t)}),(function(t){e.nextTick(k,t,s)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,r(t)),n}}).call(this,n(131))},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t,n){var r=n(198),i=n(1286),o=n(1287),s=n(109);e.exports=function(e,t){return t=r(t,e),null==(e=o(e,t))||delete e[s(i(t))]}},function(e,t){e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},function(e,t,n){var r=n(213),i=n(1086);e.exports=function(e,t){return t.length<2?e:r(e,i(t,0,-1))}},function(e,t,n){var r=n(212);e.exports=function(e){return r(e)?void 0:e}},function(e,t,n){var r=n(203),i=n(1290);e.exports=function(e){return i(r(e).toLowerCase())}},function(e,t,n){var r=n(1291)("toUpperCase");e.exports=r},function(e,t,n){var r=n(1292),i=n(1172),o=n(1293),s=n(203);e.exports=function(e){return function(t){t=s(t);var n=i(t)?o(t):void 0,a=n?n[0]:t.charAt(0),c=n?r(n,1).join(""):t.slice(1);return a[e]()+c}}},function(e,t,n){var r=n(1086);e.exports=function(e,t,n){var i=e.length;return n=void 0===n?i:n,!t&&n>=i?e:r(e,t,n)}},function(e,t,n){var r=n(1294),i=n(1172),o=n(1295);e.exports=function(e){return i(e)?o(e):r(e)}},function(e,t){e.exports=function(e){return e.split("")}},function(e,t){var n="\\ud800-\\udfff",r="["+n+"]",i="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",o="\\ud83c[\\udffb-\\udfff]",s="[^"+n+"]",a="(?:\\ud83c[\\udde6-\\uddff]){2}",c="[\\ud800-\\udbff][\\udc00-\\udfff]",l="(?:"+i+"|"+o+")"+"?",u="[\\ufe0e\\ufe0f]?",d=u+l+("(?:\\u200d(?:"+[s,a,c].join("|")+")"+u+l+")*"),h="(?:"+[s+i+"?",i,a,c,r].join("|")+")",f=RegExp(o+"(?="+o+")|"+h+d,"g");e.exports=function(e){return e.match(f)||[]}},function(e,t){e.exports=function(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}},function(e,t,n){var r=n(1298),i=n(203),o=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,s=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");e.exports=function(e){return(e=i(e))&&e.replace(o,r).replace(s,"")}},function(e,t,n){var r=n(1174)({"\xc0":"A","\xc1":"A","\xc2":"A","\xc3":"A","\xc4":"A","\xc5":"A","\xe0":"a","\xe1":"a","\xe2":"a","\xe3":"a","\xe4":"a","\xe5":"a","\xc7":"C","\xe7":"c","\xd0":"D","\xf0":"d","\xc8":"E","\xc9":"E","\xca":"E","\xcb":"E","\xe8":"e","\xe9":"e","\xea":"e","\xeb":"e","\xcc":"I","\xcd":"I","\xce":"I","\xcf":"I","\xec":"i","\xed":"i","\xee":"i","\xef":"i","\xd1":"N","\xf1":"n","\xd2":"O","\xd3":"O","\xd4":"O","\xd5":"O","\xd6":"O","\xd8":"O","\xf2":"o","\xf3":"o","\xf4":"o","\xf5":"o","\xf6":"o","\xf8":"o","\xd9":"U","\xda":"U","\xdb":"U","\xdc":"U","\xf9":"u","\xfa":"u","\xfb":"u","\xfc":"u","\xdd":"Y","\xfd":"y","\xff":"y","\xc6":"Ae","\xe6":"ae","\xde":"Th","\xfe":"th","\xdf":"ss","\u0100":"A","\u0102":"A","\u0104":"A","\u0101":"a","\u0103":"a","\u0105":"a","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u010e":"D","\u0110":"D","\u010f":"d","\u0111":"d","\u0112":"E","\u0114":"E","\u0116":"E","\u0118":"E","\u011a":"E","\u0113":"e","\u0115":"e","\u0117":"e","\u0119":"e","\u011b":"e","\u011c":"G","\u011e":"G","\u0120":"G","\u0122":"G","\u011d":"g","\u011f":"g","\u0121":"g","\u0123":"g","\u0124":"H","\u0126":"H","\u0125":"h","\u0127":"h","\u0128":"I","\u012a":"I","\u012c":"I","\u012e":"I","\u0130":"I","\u0129":"i","\u012b":"i","\u012d":"i","\u012f":"i","\u0131":"i","\u0134":"J","\u0135":"j","\u0136":"K","\u0137":"k","\u0138":"k","\u0139":"L","\u013b":"L","\u013d":"L","\u013f":"L","\u0141":"L","\u013a":"l","\u013c":"l","\u013e":"l","\u0140":"l","\u0142":"l","\u0143":"N","\u0145":"N","\u0147":"N","\u014a":"N","\u0144":"n","\u0146":"n","\u0148":"n","\u014b":"n","\u014c":"O","\u014e":"O","\u0150":"O","\u014d":"o","\u014f":"o","\u0151":"o","\u0154":"R","\u0156":"R","\u0158":"R","\u0155":"r","\u0157":"r","\u0159":"r","\u015a":"S","\u015c":"S","\u015e":"S","\u0160":"S","\u015b":"s","\u015d":"s","\u015f":"s","\u0161":"s","\u0162":"T","\u0164":"T","\u0166":"T","\u0163":"t","\u0165":"t","\u0167":"t","\u0168":"U","\u016a":"U","\u016c":"U","\u016e":"U","\u0170":"U","\u0172":"U","\u0169":"u","\u016b":"u","\u016d":"u","\u016f":"u","\u0171":"u","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017b":"Z","\u017d":"Z","\u017a":"z","\u017c":"z","\u017e":"z","\u0132":"IJ","\u0133":"ij","\u0152":"Oe","\u0153":"oe","\u0149":"'n","\u017f":"s"});e.exports=r},function(e,t,n){var r=n(1300),i=n(1301),o=n(203),s=n(1302);e.exports=function(e,t,n){return e=o(e),void 0===(t=n?void 0:t)?i(e)?s(e):r(e):e.match(t)||[]}},function(e,t){var n=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;e.exports=function(e){return e.match(n)||[]}},function(e,t){var n=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;e.exports=function(e){return n.test(e)}},function(e,t){var n="\\ud800-\\udfff",r="\\u2700-\\u27bf",i="a-z\\xdf-\\xf6\\xf8-\\xff",o="A-Z\\xc0-\\xd6\\xd8-\\xde",s="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",a="["+s+"]",c="\\d+",l="["+r+"]",u="["+i+"]",d="[^"+n+s+c+r+i+o+"]",h="(?:\\ud83c[\\udde6-\\uddff]){2}",f="[\\ud800-\\udbff][\\udc00-\\udfff]",p="["+o+"]",g="(?:"+u+"|"+d+")",m="(?:"+p+"|"+d+")",y="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",v="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",b="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",_="[\\ufe0e\\ufe0f]?",w=_+b+("(?:\\u200d(?:"+["[^"+n+"]",h,f].join("|")+")"+_+b+")*"),T="(?:"+[l,h,f].join("|")+")"+w,E=RegExp([p+"?"+u+"+"+y+"(?="+[a,p,"$"].join("|")+")",m+"+"+v+"(?="+[a,p+g,"$"].join("|")+")",p+"?"+g+"+"+y,p+"+"+v,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",c,T].join("|"),"g");e.exports=function(e){return e.match(E)||[]}},function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(1304),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(61))},function(e,t,n){(function(e,t){!function(e){"use strict";if(!e.setImmediate){var n,r,i,o,s,a=1,c={},l=!1,u=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?n=function(e){t.nextTick((function(){f(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){f(e.data)},n=function(e){i.port2.postMessage(e)}):u&&"onreadystatechange"in u.createElement("script")?(r=u.documentElement,n=function(e){var t=u.createElement("script");t.onreadystatechange=function(){f(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):n=function(e){setTimeout(f,0,e)}:(o="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&f(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),n=function(t){e.postMessage(o+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var i={callback:e,args:t};return c[a]=i,n(a),a++},d.clearImmediate=h}function h(e){delete c[e]}function f(e){if(l)setTimeout(f,0,e);else{var t=c[e];if(t){l=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{h(e),l=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(61),n(131))},function(e,t,n){var r=n(778),i=n(1306),o=n(220),s=n(1307),a=n(1309),c=n(1310),l=n(1311),u=n(1312),d=n(1313),h=n(1314),f=n(1175),p={$eq:function(e,t){return function(n){return f(n,e)&&n[e]===t}},$gt:function(e,t){return function(n){return f(n,e)&&n[e]>t}},$gte:function(e,t){return function(n){return f(n,e)&&n[e]>=t}},$lt:function(e,t){return function(n){return f(n,e)&&n[e]<t}},$lte:function(e,t){return function(n){return f(n,e)&&n[e]<=t}},$ne:function(e,t){return function(n){return f(n,e)&&n[e]!==t}},$in:function(e,t){return function(n){return f(n,e)&&t.indexOf(n[e])>-1}},$nin:function(e,t){return function(n){return f(n,e)&&-1===t.indexOf(n[e])}},$exists:function(e,t){return function(n){return f(n,e)===t}},$all:function(e,t){return function(n){return f(n,e)&&t.every((function(t){return n[e].indexOf(t)>-1}))}},$size:function(e,t){return function(n){return f(n,e)&&n[e].length===t}},$elemMatch:function(e,t){var n=w(e,t);return function(t){return f(t,e)&&t[e].some((function(t){var r={};return r[e]=t,n.every((function(e){return e(r)}))}))}},$not:function(e,t){var n=w(e,t);return function(t){return!f(t,e)||n.every((function(e){return!e(t)}))}}},g={$and:function(e,t){var n=t.map(_).reduce(s);return function(e){return n.every((function(t){return t(e)}))}},$or:function(e,t){var n=t.map(_);return function(e){return n.some((function(t){return t.every((function(t){return t(e)}))}))}},$nor:function(e,t){var n=this.$and(e,t);return function(e){return!n(e)}}},m={$inc:function(e,t){return E(t,(function(e,n){f(n,e)&&(n[e]+=t[e])}))},$mul:function(e,t){return E(t,(function(e,n){f(n,e)&&(n[e]*=t[e])}))},$rename:function(e,t){return E(t,(function(e,n){var r=n[e];delete n[e],n[t[e]]=r}))},$set:function(e,t){return E(t,(function(e,n){n[e]=t[e]}))},$unset:function(e,t){return E(t,(function(e,t){delete t[e]}))},$min:function(e,t){return E(t,(function(e,n){n[e]=Math.min(n[e],t[e])}))},$max:function(e,t){return E(t,(function(e,n){n[e]=Math.max(n[e],t[e])}))},$addToSet:function(e,t){return E(t,(function(e,n){c(n,e)?-1===n[e].indexOf(t[e])&&n[e].push(t[e]):n[e]=[t[e]]}))},$pop:function(e,t){return E(t,(function(e,n){c(n,e),1===t[e]?n[e].pop():-1===t[e]&&n[e].shift()}))},$push:function(e,t){return E(t,(function(e,n){c(n,e)?n[e].push(t[e]):n[e]=[t[e]]}))},$pullAll:function(e,t){return E(t,(function(e,n){c(n,e);var r=t[e];n[e]=n[e].filter((function(e){return-1===r.indexOf(e)}))}))},$pull:function(e,t){return E(t,(function(e,n){c(n,e);var r=t[e];if(u(r))n[e]=n[e].filter((function(e){return e!==r}));else{var i=w(e,r);n[e]=n[e].filter((function(t){var n={};return n[e]=t,!i.some((function(e){return e(n)}))}))}}))},$slice:function(e,t){return E(t,(function(e,n){c(n,e);var r=t[e];if(u(r))n[e]=d(n[e],r);else{var i=Object.keys(r);n[e]=n[e].map((function(e){return i.reduce((function(e,t){return e[t]=d(e[t],r[t]),e}),e)}))}}))},$sort:function(e,t){return E(t,(function(e,n){c(n,e);var r=t[e];if(u(r))n[e]=n[e].sort((function(e,t){return a(e,t,r)}));else{var i=n[e].slice();n[e]=Object.keys(r).reduce((function(e,t){var n=r[t];return i.sort((function(e,r){var i=e[t],o=r[t];return a(i,o,n)}))}),n[e])}}))}},y={query:Object.keys(p),queryLogical:Object.keys(g),update:Object.keys(m)},v=["upsert"],b=["$set","$addToSet","$push"],_=function(e){return Object.keys(e).map((function(t){return w(t,e[t])})).reduce(s)},w=function(e,t){return Object.keys(t).map((function(n){return L({key:e,type:n,value:t[n]})}))},T=function(e,t){var n=t||Object.keys(e);return function(t){return n.every((function(n){return f(t,n)&&t[n]===e[n]}))}},E=function(e,t){var n=Object.keys(e);return function(e){n.forEach((function(n){t(n,e)}))}},A=function(e){var t=function(e){return e.queryOperators.advanced.map((function(e){return e.operators.map((function(t){return L({type:t,key:e.key,value:e.value[t]})}))})).reduce(s)}(e);return function(e){return t.every((function(t){return t(e)}))}},S=function(e){var t=function(e){return e.updateOperators.advanced.map((function(e){return L({type:e.key,key:null,value:e.value})}))}(e);return function(e){t.forEach((function(t){t(e)}))}},O=function(e){return e.queryOperators.plain.map((function(e){return e.key}))},I={primaryKey:function(e,t,n){var r=t.primaryKey.key,i=t.primaryKey.value,o=n.where(r).equals(i);if(t.queryOperators.plain.length>0){var s=T(e,O(t));o.and(s)}if(t.queryOperators.advanced.length>0){var a=A(t);o.and(a)}return o},indexedProp:function(e,t,n){var r,i=function(e,t){var n=-1,r=-1,i=-1;return t.indexedKeys.forEach((function(e,t){e.unique?n=t:"number"==typeof e.value?r=t:e.plain&&(i=t)})),n>-1?t.indexedKeys[n]:r>-1?t.indexedKeys[r]:t.indexedKeys[i]}(0,t);if(r=i&&i.plain?n.where(i.key).equals(i.value):n.toCollection(),t.queryOperators.plain.length>0){var o=T(e,O(t));r.and(o)}if(t.queryOperators.advanced.length>0){var s=A(t);r.and(s)}return r},fullScan:function(e,t,n){var r=n.toCollection();if(t.queryOperators.plain.length>0){var i=T(e,O(t));r.and(i)}if(t.queryOperators.advanced.length>0){var o=A(t);r.and(o)}return r}},C=function(e,t){var n=t.updateOperators.plain.length>0,r=t.updateOperators.advanced.length>0;return n&&r?h:n?function(e,t){var n=t||Object.keys(e);return function(t){n.forEach((function(n){f(t,n)&&(t[n]=e[n])}))}}(e,t.keys):r?S(t):void 0},k=function(e,t){var n=t&&!0===t.isUpsert,r=n?0:e;return{result:{ok:1,nModified:r},modifiedCount:r,upsertedCount:n?1:0,upsertedId:n?t.id:null}},P=function(e){return{result:{ok:1,n:e},deletedCount:e}},x=function(e,t,n){return new r.Promise((function(s){return e.update(t,n).then((function(s){if(0===s.modifiedCount){var a=function(e,t){var n=Object.keys(e).filter((function(e){var t=f(p,e),n=f(g,e);return!(t||n)})),r=i(e,n),s=b.reduce((function(e,n){var r=t[n];return o(e,r)}),{});return o(r,s)}(t,n);return e.insert(a)}return r.Promise.resolve(s)})).then((function(e){var t=e;return"number"==typeof e.insertedId&&(t=k(1,{isUpsert:!0,id:e.insertedId})),s(t)}))}))},R=function(e,t,n){var r=G(n),i=C(n,r);return e.find(t).modify(i).then((function(e){return k(e,null)}))},L=function(e){var t;return y.query.indexOf(e.type)>-1?t=p:y.queryLogical.indexOf(e.type)>-1?t=g:y.update.indexOf(e.type)>-1&&(t=m),t[e.type](e.key,e.value)},D=function(e,t,n){return t.reduce(n(e,t),{plain:[],advanced:[]})},N=function(e){return function(t,n){var r=e[n],i=u(r),o=y.queryLogical.indexOf(n)>-1;if(i)t.plain.push({key:n,value:r,plain:i});else if(o){var s={};s[n]=r,t.advanced.push({key:n,value:s,plain:i,operators:[n]})}else t.advanced.push({key:n,value:r,plain:i,operators:Object.keys(r).filter((function(e){return y.query.indexOf(e)>-1}))});return t}},j=function(e){return function(t,n){var r=e[n],i=u(r);return i?t.plain.push({key:n,value:r,plain:i}):t.advanced.push({key:n,value:r,plain:i}),t}},M=function(e,t){return D(e,t,N)},F=function(e,t){return D(e,t,j)},U=function(e,t){var n=t.primKey.keyPath,r=e[n],i=typeof r;return"number"===i||"string"===i?{key:n,value:r}:{key:!1}},B=function(e,t,n){return n.indexes.filter((function(e){return t.indexOf(e.keyPath)>-1})).map((function(t){var n=t.keyPath;return{key:n,value:e[n],unique:t.unique,plain:u(e[n])}}))},G=function(e){var t=Object.keys(e);return{keys:t,updateOperators:F(e,t)}},q=function(e,t){var n,r=function(e,t){var n=Object.keys(e);return{keys:n,queryOperators:M(e,n),primaryKey:U(e,t),indexedKeys:B(e,n,t)}}(e,t);return n=r.primaryKey.key?"primaryKey":r.indexedKeys.length>0?"indexedProp":"fullScan",{queryAnalysis:r,execute:I[n]}},H=function(e,t){if(l(t))return e.toCollection();var n=q(t,e.schema);return n.execute(t,n.queryAnalysis,e)};(r=r.default||r).addons.push((function(e){r.prototype.collection=function(t){return e.table(t)},e.Table.prototype.count=function(e){return(l(e)?this.toCollection():H(this,e)).count()},e.Table.prototype.find=function(e){return H(this,e)},e.Table.prototype.findOne=function(e){return H(this,e).first()},e.Table.prototype.insert=function(e){return function(e,t){var n=e.schema.primKey.keyPath;return e.add(t).then((function(e){return i(t,Object.keys(t))[n]=e,function(e,t){return{insertedCount:1,insertedId:t.id,ops:[t.item],result:{ok:1,n:1}}}(0,{item:t,id:e})}))}(this,e)},e.Table.prototype.remove=function(e){return function(e,t){return H(e,t).delete().then(P)}(this,e)},e.Table.prototype.drop=function(){return this.toCollection().delete().then(P)},(e.WriteableTable?e.WriteableTable:e.Table).prototype.update=function(e,t,n){var r=function(e){return l(e)?{}:i(e,v)}(n);return function(e,t,n,r){return(!0===r.upsert?x:R)(e,t,n)}(this,e,t,r)}}))},function(e,t){e.exports=function(e,t){return e=e||{},"string"==typeof t&&(t=t.split(/ +/)),t.reduce((function(t,n){return null==e[n]||(t[n]=e[n]),t}),{})}},function(e,t,n){"use strict";var r=n(1308);e.exports=r((function(e,t){return e.concat(t)}))},function(e,t,n){"use strict";e.exports=function(e,t){var n=function(){return arguments.length>1?e.call(t,arguments[0],arguments[1]):e.bind(t,arguments[0])};return n.uncurry=function(){return e},n}},function(e,t,n){"use strict";e.exports=function(e,t,n){return 1===n?e>t:e<t}},function(e,t,n){"use strict";var r=n(1175);e.exports=function(e,t){var n=r(e,t),i=Array.isArray(e[t]);if(n&&!i)throw new Error("You can't use array update operator on non-array field");return n}},function(e,t){e.exports=function(e){return!("object"==typeof e&&null!==e&&e)||0===Object.keys(e).length}},function(e,t,n){"use strict";e.exports=function(e){var t=typeof e;return"number"===t||"string"===t||"boolean"===t}},function(e,t,n){"use strict";e.exports=function(e,t){return t>=0?e.slice(0,t):e.slice(t)}},function(e,t){e.exports=function(){}},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t){e.exports=function(e){"use strict";if(!window||window.window!==window)throw new Error("This module is only available in browser");var t=window.Blob||window.MozBlob||window.WebKitBlob;if(!t)throw new Error("Blob was not supported");var n=e.match(/^data:((.*?)(;charset=.*?)?)(;base64)?,/);if(!n)throw new Error("invalid dataURI");for(var r=n[2]?n[1]:"text/plain"+(n[3]||";charset=utf-8"),i=!!n[4],o=e.slice(n[0].length),s=i?atob(o):decodeURIComponent(o),a=[],c=0;c<s.length;c++)a.push(s.charCodeAt(c));return new t([new Uint8Array(a)],{type:r})}},function(e,t,n){var r=n(1059),i=n(355);e.exports=function(e,t){return r(e,t,(function(t,n){return i(e,n)}))}},function(e,t){e.exports=function(e,t,n){for(var r=-1,i=e.length,o=t.length,s={};++r<i;){var a=r<o?t[r]:void 0;n(s,e[r],a)}return s}},function(e,t,n){var r=n(357),i=n(358);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var a=0;a<16;++a)t[o+a]=s[a];return t||i(s)}},function(e,t,n){var r=n(1176),i=n(730)("socket.io-client:url");e.exports=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host);"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(i("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),i("parse %s",e),n=r(e));n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443"));n.path=n.path||"/";var o=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+o+":"+n.port,n.href=n.protocol+"://"+o+(t&&t.port===n.port?"":":"+n.port),n}},function(e,t,n){e.exports=function(e){function t(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return r.colors[Math.abs(t)%r.colors.length]}function r(e){let n;function s(...e){if(!s.enabled)return;const t=s,i=Number(new Date),o=i-(n||i);t.diff=o,t.prev=n,t.curr=i,n=i,e[0]=r.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,i)=>{if("%%"===n)return n;a++;const o=r.formatters[i];if("function"==typeof o){const r=e[a];n=o.call(t,r),e.splice(a,1),a--}return n})),r.formatArgs.call(t,e);(t.log||r.log).apply(t,e)}return s.namespace=e,s.enabled=r.enabled(e),s.useColors=r.useColors(),s.color=t(e),s.destroy=i,s.extend=o,"function"==typeof r.init&&r.init(s),r.instances.push(s),s}function i(){const e=r.instances.indexOf(this);return-1!==e&&(r.instances.splice(e,1),!0)}function o(e,t){const n=r(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return r.debug=r,r.default=r,r.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},r.disable=function(){const e=[...r.names.map(s),...r.skips.map(s).map((e=>"-"+e))].join(",");return r.enable(""),e},r.enable=function(e){let t;r.save(e),r.names=[],r.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(t=0;t<i;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?r.skips.push(new RegExp("^"+e.substr(1)+"$")):r.names.push(new RegExp("^"+e+"$")));for(t=0;t<r.instances.length;t++){const e=r.instances[t];e.enabled=r.enabled(e.namespace)}},r.enabled=function(e){if("*"===e[e.length-1])return!0;let t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1},r.humanize=n(1322),Object.keys(e).forEach((t=>{r[t]=e[t]})),r.instances=[],r.names=[],r.skips=[],r.formatters={},r.selectColor=t,r.enable(r.load()),r}},function(e,t){var n=1e3,r=60*n,i=60*r,o=24*i,s=7*o,a=365.25*o;function c(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,t){t=t||{};var l=typeof e;if("string"===l&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var c=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*a;case"weeks":case"week":case"w":return c*s;case"days":case"day":case"d":return c*o;case"hours":case"hour":case"hrs":case"hr":case"h":return c*i;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===l&&!1===isNaN(e))return t.long?function(e){var t=Math.abs(e);if(t>=o)return c(e,t,o,"day");if(t>=i)return c(e,t,i,"hour");if(t>=r)return c(e,t,r,"minute");if(t>=n)return c(e,t,n,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=o)return Math.round(e/o)+"d";if(t>=i)return Math.round(e/i)+"h";if(t>=r)return Math.round(e/r)+"m";if(t>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){(function(r){function i(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}(t=e.exports=n(1324)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))})),e.splice(o,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())}).call(this,n(131))},function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,i=+new Date,o=i-(n||i);e.diff=o,e.prev=n,e.curr=i,n=i;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;c++;var i=t.formatters[r];if("function"==typeof i){var o=s[c];n=i.call(e,o),s.splice(c,1),c--}return n})),t.formatArgs.call(e,s),(r.log||t.log||console.log.bind(console)).apply(e,s)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=i,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function i(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var o=t.instances[n];o.enabled=t.enabled(o.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(1325),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t){var n=1e3,r=60*n,i=60*r,o=24*i,s=365.25*o;function a(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var c,l=typeof e;if("string"===l&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*s;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*i;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(e);if("number"===l&&!1===isNaN(e))return t.long?a(c=e,o,"day")||a(c,i,"hour")||a(c,r,"minute")||a(c,n,"second")||c+" ms":function(e){if(e>=o)return Math.round(e/o)+"d";if(e>=i)return Math.round(e/i)+"h";if(e>=r)return Math.round(e/r)+"m";if(e>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){var r=n(1177),i=n(1178),o=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);function c(e,t){if(!e)return e;if(i(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(r(e)){for(var o=new Array(e.length),s=0;s<e.length;s++)o[s]=c(e[s],t);return o}if("object"==typeof e&&!(e instanceof Date)){o={};for(var a in e)o[a]=c(e[a],t);return o}return e}function l(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"==typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(r(e))for(var n=0;n<e.length;n++)e[n]=l(e[n],t);else if("object"==typeof e)for(var i in e)e[i]=l(e[i],t);return e}t.deconstructPacket=function(e){var t=[],n=e.data,r=e;return r.data=c(n,t),r.attachments=t.length,{packet:r,buffers:t}},t.reconstructPacket=function(e,t){return e.data=l(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,o=e;!function e(c,l,u){if(!c)return c;if(s&&c instanceof Blob||a&&c instanceof File){n++;var d=new FileReader;d.onload=function(){u?u[l]=this.result:o=this.result,--n||t(o)},d.readAsArrayBuffer(c)}else if(r(c))for(var h=0;h<c.length;h++)e(c[h],h,c);else if("object"==typeof c&&!i(c))for(var f in c)e(c[f],f,c)}(o),n||t(o)}},function(e,t,n){e.exports=n(1329),e.exports.parser=n(883)},function(e,t,n){var r=n(1180),i=n(900),o=n(730)("engine.io-client:socket"),s=n(1184),a=n(883),c=n(1176),l=n(1060);function u(e,t){if(!(this instanceof u))return new u(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=c(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=c(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=l.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.withCredentials=!1!==t.withCredentials,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=u,u.priorWebsocketSuccess=!1,i(u.prototype),u.protocol=a.protocol,u.Socket=u,u.Transport=n(1089),u.transports=n(1180),u.parser=n(883),u.prototype.createTransport=function(e){o('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=a.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new r[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,withCredentials:n.withCredentials||this.withCredentials,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},u.prototype.open=function(){var e;if(this.rememberUpgrade&&u.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},u.prototype.setTransport=function(e){o("setting transport %s",e.name);var t=this;this.transport&&(o("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},u.prototype.probe=function(e){o('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;function i(){if(r.onlyBinaryUpgrades){var i=!this.supportsBinary&&r.transport.supportsBinary;n=n||i}n||(o('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(function(i){if(!n)if("pong"===i.type&&"probe"===i.data){if(o('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;u.priorWebsocketSuccess="websocket"===t.name,o('pausing current transport "%s"',r.transport.name),r.transport.pause((function(){n||"closed"!==r.readyState&&(o("changing transport and sending upgrade packet"),h(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())}))}else{o('probe transport "%s" failed',e);var s=new Error("probe error");s.transport=t.name,r.emit("upgradeError",s)}})))}function s(){n||(n=!0,h(),t.close(),t=null)}function a(n){var i=new Error("probe error: "+n);i.transport=t.name,s(),o('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",i)}function c(){a("transport closed")}function l(){a("socket closed")}function d(e){t&&e.name!==t.name&&(o('"%s" works - aborting "%s"',e.name,t.name),s())}function h(){t.removeListener("open",i),t.removeListener("error",a),t.removeListener("close",c),r.removeListener("close",l),r.removeListener("upgrading",d)}u.priorWebsocketSuccess=!1,t.once("open",i),t.once("error",a),t.once("close",c),this.once("close",l),this.once("upgrading",d),t.open()},u.prototype.onOpen=function(){if(o("socket open"),this.readyState="open",u.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},u.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(o('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else o('packet received with socket readyState "%s"',this.readyState)},u.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},u.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},u.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){o("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},u.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},u.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},u.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},u.prototype.write=u.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},u.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}},u.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():t()})):this.upgrading?r():t()}function t(){e.onClose("forced close"),o("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return this},u.prototype.onError=function(e){o("socket error %j",e),u.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},u.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){o('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},u.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~s(this.transports,e[n])&&t.push(e[n]);return t}},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,n){var r=n(1088),i=n(1181),o=n(900),s=n(1061),a=n(730)("engine.io-client:polling-xhr");function c(){}function l(e){if(i.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function u(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}if(e.exports=l,e.exports.Request=u,s(l,i),l.prototype.supportsBinary=!0,l.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.withCredentials=this.withCredentials,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new u(e)},l.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),i=this;r.on("success",t),r.on("error",(function(e){i.onError("xhr post error",e)})),this.sendXhr=r},l.prototype.doPoll=function(){a("xhr poll");var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},o(u.prototype),u.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new r(e),n=this;try{a("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var i in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&t.setRequestHeader(i,this.extraHeaders[i])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.withCredentials),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout((function(){n.onError("number"==typeof t.status?t.status:0)}),0))},a("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout((function(){n.onError(e)}),0)}"undefined"!=typeof document&&(this.index=u.requestsCount++,u.requests[this.index]=this)},u.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},u.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},u.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},u.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete u.requests[this.index],this.xhr=null}},u.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},u.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},u.prototype.abort=function(){this.cleanup()},u.requestsCount=0,u.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",h);else if("function"==typeof addEventListener){var d="onpagehide"in self?"pagehide":"unload";addEventListener(d,h,!1)}function h(){for(var e in u.requests)u.requests.hasOwnProperty(e)&&u.requests[e].abort()}},function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var i=new Uint8Array(e),o=new Uint8Array(n-t),s=t,a=0;s<n;s++,a++)o[a]=i[s];return o.buffer}},function(e,t){function n(){}e.exports=function(e,t,r){var i=!1;return r=r||n,o.count=e,0===e?t():o;function o(e,n){if(o.count<=0)throw new Error("after called too many times");--o.count,e?(i=!0,t(e),t=r):0!==o.count||i||t(null,n)}}},function(e,t){var n,r,i,o=String.fromCharCode;function s(e){for(var t,n,r=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function a(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function c(e,t){return o(e>>t&63|128)}function l(e,t){if(!(4294967168&e))return o(e);var n="";return 4294965248&e?4294901760&e?4292870144&e||(n=o(e>>18&7|240),n+=c(e,12),n+=c(e,6)):(a(e,t)||(e=65533),n=o(e>>12&15|224),n+=c(e,6)):n=o(e>>6&31|192),n+=o(63&e|128)}function u(){if(i>=r)throw Error("Invalid byte index");var e=255&n[i];if(i++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function d(e){var t,o;if(i>r)throw Error("Invalid byte index");if(i==r)return!1;if(t=255&n[i],i++,!(128&t))return t;if(192==(224&t)){if((o=(31&t)<<6|u())>=128)return o;throw Error("Invalid continuation byte")}if(224==(240&t)){if((o=(15&t)<<12|u()<<6|u())>=2048)return a(o,e)?o:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(o=(7&t)<<18|u()<<12|u()<<6|u())>=65536&&o<=1114111)return o;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,r=s(e),i=r.length,o=-1,a="";++o<i;)a+=l(r[o],n);return a},decode:function(e,t){var a=!1!==(t=t||{}).strict;n=s(e),r=n.length,i=0;for(var c,l=[];!1!==(c=d(a));)l.push(c);return function(e){for(var t,n=e.length,r=-1,i="";++r<n;)(t=e[r])>65535&&(i+=o((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=o(t);return i}(l)}}},function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<64;r++)n[e.charCodeAt(r)]=r;t.encode=function(t){var n,r=new Uint8Array(t),i=r.length,o="";for(n=0;n<i;n+=3)o+=e[r[n]>>2],o+=e[(3&r[n])<<4|r[n+1]>>4],o+=e[(15&r[n+1])<<2|r[n+2]>>6],o+=e[63&r[n+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(e){var t,r,i,o,s,a=.75*e.length,c=e.length,l=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var u=new ArrayBuffer(a),d=new Uint8Array(u);for(t=0;t<c;t+=4)r=n[e.charCodeAt(t)],i=n[e.charCodeAt(t+1)],o=n[e.charCodeAt(t+2)],s=n[e.charCodeAt(t+3)],d[l++]=r<<2|i>>4,d[l++]=(15&i)<<4|o>>2,d[l++]=(3&o)<<6|63&s;return u}}()},function(e,t){var n=void 0!==n?n:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,r=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),i=r&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),o=n&&n.prototype.append&&n.prototype.getBlob;function s(e){return e.map((function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e}))}function a(e,t){t=t||{};var r=new n;return s(e).forEach((function(e){r.append(e)})),t.type?r.getBlob(t.type):r.getBlob()}function c(e,t){return new Blob(s(e),t||{})}"undefined"!=typeof Blob&&(a.prototype=Blob.prototype,c.prototype=Blob.prototype),e.exports=r?i?Blob:c:o?a:void 0},function(e,t,n){(function(t){var r=n(1181),i=n(1061);e.exports=u;var o,s=/\n/g,a=/\\n/g;function c(){}function l(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{}}function u(e){if(r.call(this,e),this.query=this.query||{},!o){var t=l();o=t.___eio=t.___eio||[]}this.index=o.length;var n=this;o.push((function(e){n.onData(e)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){n.script&&(n.script.onerror=c)}),!1)}i(u,r),u.prototype.supportsBinary=!1,u.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},u.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},u.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r,i=document.createElement("form"),o=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=c,i.method="POST",i.setAttribute("accept-charset","utf-8"),o.name="d",i.appendChild(o),document.body.appendChild(i),this.form=i,this.area=o}function l(){u(),t()}function u(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(e){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),u(),e=e.replace(a,"\\\n"),this.area.value=e.replace(s,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&l()}:this.iframe.onload=l}}).call(this,n(61))},function(e,t,n){(function(t){var r,i,o=n(1089),s=n(883),a=n(1060),c=n(1061),l=n(1183),u=n(730)("engine.io-client:websocket");if("undefined"!=typeof WebSocket?r=WebSocket:"undefined"!=typeof self&&(r=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{i=n(1341)}catch(e){}var d=r||i;function h(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=r&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(d=i),o.call(this,e)}e.exports=h,c(h,o),h.prototype.name="websocket",h.prototype.supportsBinary=!0,h.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new d(e,t):new d(e):new d(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},h.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},h.prototype.write=function(e){var n=this;this.writable=!1;for(var r=e.length,i=0,o=r;i<o;i++)!function(e){s.encodePacket(e,n.supportsBinary,(function(i){if(!n.usingBrowserWebSocket){var o={};if(e.options&&(o.compress=e.options.compress),n.perMessageDeflate)("string"==typeof i?t.byteLength(i):i.length)<n.perMessageDeflate.threshold&&(o.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(i):n.ws.send(i,o)}catch(e){u("websocket closed before onclose event")}--r||a()}))}(e[i]);function a(){n.emit("flush"),setTimeout((function(){n.writable=!0,n.emit("drain")}),0)}},h.prototype.onClose=function(){o.prototype.onClose.call(this)},h.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},h.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=l()),this.supportsBinary||(e.b64=1),(e=a.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},h.prototype.check=function(){return!(!d||"__initialize"in d&&this.name===h.prototype.name)}}).call(this,n(287).Buffer)},function(e,t){},function(e,t){e.exports=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=1&Math.floor(10*t)?e+n:e-n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&s(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.getLoad=void 0;var l=c(n(1188)),u=c(n(884)),d=n(1346),h=n(885);t.getLoad=function(e,t){return function n(r,s,a){if(void 0===a&&(a=!0),null==r)throw new Error("cheerio.load() expects a string");var c=o(o({},l.default),(0,l.flatten)(s)),f=e(r,c,a,null),p=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return i(r,n),r.prototype._make=function(e,t){var n=g(e,t);return n.prevObject=this,n},r.prototype._parse=function(t,n,r,i){return e(t,n,r,i)},r.prototype._render=function(e){return t(e,this.options)},r}(d.Cheerio);function g(t,n,r,i){if(void 0===r&&(r=f),t&&(0,h.isCheerio)(t))return t;var s=o(o({},c),(0,l.flatten)(i)),a="string"==typeof r?[e(r,s,!1,null)]:"length"in r?r:[r],u=(0,h.isCheerio)(a)?a:new p(a,null,s);if(u._root=u,!t)return new p(void 0,u,s);var d,g="string"==typeof t&&(0,h.isHtml)(t)?e(t,s,!1,null).children:(d=t).name||"root"===d.type||"text"===d.type||"comment"===d.type?[t]:Array.isArray(t)?t:void 0,m=new p(g,u,s);if(g)return m;if("string"!=typeof t)throw new Error("Unexpected type of selector");var y=t,v=n?"string"==typeof n?(0,h.isHtml)(n)?new p([e(n,s,!1,null)],u,s):(y="".concat(n," ").concat(y),u):(0,h.isCheerio)(n)?n:new p(Array.isArray(n)?n:[n],u,s):u;return v?v.find(y):m}return Object.assign(g,u,{load:n,_root:f,_options:c,fn:p.prototype,prototype:p.prototype}),g}}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.Cheerio=void 0;var s=o(n(1347)),a=o(n(1348)),c=o(n(1360)),l=o(n(1361)),u=o(n(1362)),d=function(e,t,n){if(this.length=0,this.options=n,this._root=t,e){for(var r=0;r<e.length;r++)this[r]=e[r];this.length=e.length}};t.Cheerio=d,d.prototype.cheerio="[cheerio object]",d.prototype.splice=Array.prototype.splice,d.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator],Object.assign(d.prototype,s,a,c,l,u)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toggleClass=t.removeClass=t.addClass=t.hasClass=t.removeAttr=t.val=t.data=t.prop=t.attr=void 0;var r=n(884),i=n(885),o=n(319),s=Object.prototype.hasOwnProperty,a=/\s+/,c="data-",l={null:null,true:!0,false:!1},u=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,d=/^{[^]*}$|^\[[^]*]$/;function h(e,t,n){var o;if(e&&(0,i.isTag)(e))return null!==(o=e.attribs)&&void 0!==o||(e.attribs={}),t?s.call(e.attribs,t)?!n&&u.test(t)?t:e.attribs[t]:"option"===e.name&&"value"===t?(0,r.text)(e.children):"input"!==e.name||"radio"!==e.attribs.type&&"checkbox"!==e.attribs.type||"value"!==t?void 0:"on":e.attribs}function f(e,t,n){null===n?v(e,t):e.attribs[t]="".concat(n)}function p(e,t,n){return t in e?e[t]:!n&&u.test(t)?void 0!==h(e,t,!1):h(e,t,n)}function g(e,t,n,r){t in e?e[t]=n:f(e,t,!r&&u.test(t)?n?"":null:"".concat(n))}function m(e,t,n){var r,i=e;null!==(r=i.data)&&void 0!==r||(i.data={}),"object"==typeof t?Object.assign(i.data,t):"string"==typeof t&&void 0!==n&&(i.data[t]=n)}function y(e,t){var n,r,o;null==t?r=(n=Object.keys(e.attribs).filter((function(e){return e.startsWith(c)}))).map((function(e){return(0,i.camelCase)(e.slice(5))})):(n=[c+(0,i.cssCase)(t)],r=[t]);for(var a=0;a<n.length;++a){var u=n[a],h=r[a];if(s.call(e.attribs,u)&&!s.call(e.data,h)){if(o=e.attribs[u],s.call(l,o))o=l[o];else if(o===String(Number(o)))o=Number(o);else if(d.test(o))try{o=JSON.parse(o)}catch(e){}e.data[h]=o}}return null==t?e.data:o}function v(e,t){e.attribs&&s.call(e.attribs,t)&&delete e.attribs[t]}function b(e){return e?e.trim().split(a):[]}t.attr=function(e,t){if("object"==typeof e||void 0!==t){if("function"==typeof t){if("string"!=typeof e)throw new Error("Bad combination of arguments.");return(0,i.domEach)(this,(function(n,r){(0,i.isTag)(n)&&f(n,e,t.call(n,r,n.attribs[e]))}))}return(0,i.domEach)(this,(function(n){(0,i.isTag)(n)&&("object"==typeof e?Object.keys(e).forEach((function(t){var r=e[t];f(n,t,r)})):f(n,e,t))}))}return arguments.length>1?this:h(this[0],e,this.options.xmlMode)},t.prop=function(e,t){var n,r=this;if("string"==typeof e&&void 0===t){var s=this[0];if(!s||!(0,i.isTag)(s))return;switch(e){case"style":var a=this.css(),c=Object.keys(a);return c.forEach((function(e,t){a[t]=e})),a.length=c.length,a;case"tagName":case"nodeName":return s.name.toUpperCase();case"href":case"src":var l=null===(n=s.attribs)||void 0===n?void 0:n[e];return"undefined"==typeof URL||("href"!==e||"a"!==s.tagName&&"link"!==s.name)&&("src"!==e||"img"!==s.tagName&&"iframe"!==s.tagName&&"audio"!==s.tagName&&"video"!==s.tagName&&"source"!==s.tagName)||void 0===l||!this.options.baseURI?l:new URL(l,this.options.baseURI).href;case"innerText":return(0,o.innerText)(s);case"textContent":return(0,o.textContent)(s);case"outerHTML":return this.clone().wrap("<container />").parent().html();case"innerHTML":return this.html();default:return p(s,e,this.options.xmlMode)}}if("object"==typeof e||void 0!==t){if("function"==typeof t){if("object"==typeof e)throw new Error("Bad combination of arguments.");return(0,i.domEach)(this,(function(n,o){(0,i.isTag)(n)&&g(n,e,t.call(n,o,p(n,e,r.options.xmlMode)),r.options.xmlMode)}))}return(0,i.domEach)(this,(function(n){(0,i.isTag)(n)&&("object"==typeof e?Object.keys(e).forEach((function(t){var i=e[t];g(n,t,i,r.options.xmlMode)})):g(n,e,t,r.options.xmlMode))}))}},t.data=function(e,t){var n,r=this[0];if(r&&(0,i.isTag)(r)){var o=r;return null!==(n=o.data)&&void 0!==n||(o.data={}),e?"object"==typeof e||void 0!==t?((0,i.domEach)(this,(function(n){(0,i.isTag)(n)&&("object"==typeof e?m(n,e):m(n,e,t))})),this):s.call(o.data,e)?o.data[e]:y(o,e):y(o)}},t.val=function(e){var t=0===arguments.length,n=this[0];if(!n||!(0,i.isTag)(n))return t?void 0:this;switch(n.name){case"textarea":return this.text(e);case"select":var o=this.find("option:selected");if(!t){if(null==this.attr("multiple")&&"object"==typeof e)return this;this.find("option").removeAttr("selected");for(var s="object"!=typeof e?[e]:e,a=0;a<s.length;a++)this.find('option[value="'.concat(s[a],'"]')).attr("selected","");return this}return this.attr("multiple")?o.toArray().map((function(e){return(0,r.text)(e.children)})):o.attr("value");case"input":case"option":return t?this.attr("value"):this.attr("value",e)}},t.removeAttr=function(e){for(var t=b(e),n=function(e){(0,i.domEach)(r,(function(n){(0,i.isTag)(n)&&v(n,t[e])}))},r=this,o=0;o<t.length;o++)n(o);return this},t.hasClass=function(e){return this.toArray().some((function(t){var n=(0,i.isTag)(t)&&t.attribs.class,r=-1;if(n&&e.length)for(;(r=n.indexOf(e,r+1))>-1;){var o=r+e.length;if((0===r||a.test(n[r-1]))&&(o===n.length||a.test(n[o])))return!0}return!1}))},t.addClass=function e(t){if("function"==typeof t)return(0,i.domEach)(this,(function(n,r){if((0,i.isTag)(n)){var o=n.attribs.class||"";e.call([n],t.call(n,r,o))}}));if(!t||"string"!=typeof t)return this;for(var n=t.split(a),r=this.length,o=0;o<r;o++){var s=this[o];if((0,i.isTag)(s)){var c=h(s,"class",!1);if(c){for(var l=" ".concat(c," "),u=0;u<n.length;u++){var d="".concat(n[u]," ");l.includes(" ".concat(d))||(l+=d)}f(s,"class",l.trim())}else f(s,"class",n.join(" ").trim())}}return this},t.removeClass=function e(t){if("function"==typeof t)return(0,i.domEach)(this,(function(n,r){(0,i.isTag)(n)&&e.call([n],t.call(n,r,n.attribs.class||""))}));var n=b(t),r=n.length,o=0===arguments.length;return(0,i.domEach)(this,(function(e){if((0,i.isTag)(e))if(o)e.attribs.class="";else{for(var t=b(e.attribs.class),s=!1,a=0;a<r;a++){var c=t.indexOf(n[a]);c>=0&&(t.splice(c,1),s=!0,a--)}s&&(e.attribs.class=t.join(" "))}}))},t.toggleClass=function e(t,n){if("function"==typeof t)return(0,i.domEach)(this,(function(r,o){(0,i.isTag)(r)&&e.call([r],t.call(r,o,r.attribs.class||"",n),n)}));if(!t||"string"!=typeof t)return this;for(var r=t.split(a),o=r.length,s="boolean"==typeof n?n?1:-1:0,c=this.length,l=0;l<c;l++){var u=this[l];if((0,i.isTag)(u)){for(var d=b(u.attribs.class),h=0;h<o;h++){var f=d.indexOf(r[h]);s>=0&&f<0?d.push(r[h]):s<=0&&f>=0&&d.splice(f,1)}u.attribs.class=d.join(" ")}}return this}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.addBack=t.add=t.end=t.slice=t.index=t.toArray=t.get=t.eq=t.last=t.first=t.has=t.not=t.is=t.filterArray=t.filter=t.map=t.each=t.contents=t.children=t.siblings=t.prevUntil=t.prevAll=t.prev=t.nextUntil=t.nextAll=t.next=t.closest=t.parentsUntil=t.parents=t.parent=t.find=void 0;var a=n(155),c=o(n(1349)),l=n(885),u=n(884),d=n(319),h=/^\s*[~+]/;function f(e){return function(t){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return function(r){var i,o=e(t,this);return r&&(o=b(o,r,this.options.xmlMode,null===(i=this._root)||void 0===i?void 0:i[0])),this._make(this.length>1&&o.length>1?n.reduce((function(e,t){return t(e)}),o):o)}}}t.find=function(e){var t;if(!e)return this._make([]);var n=this.toArray();if("string"!=typeof e){var r=(0,l.isCheerio)(e)?e.toArray():[e];return this._make(r.filter((function(e){return n.some((function(t){return(0,u.contains)(t,e)}))})))}var i=h.test(e)?n:this.children().toArray(),o={context:n,root:null===(t=this._root)||void 0===t?void 0:t[0],xmlMode:this.options.xmlMode,lowerCaseTags:this.options.lowerCaseTags,lowerCaseAttributeNames:this.options.lowerCaseAttributeNames,pseudos:this.options.pseudos,quirksMode:this.options.quirksMode};return this._make(c.select(e,i,o))};var p=f((function(e,t){for(var n,r=[],i=0;i<t.length;i++){var o=e(t[i]);r.push(o)}return(n=new Array).concat.apply(n,r)})),g=f((function(e,t){for(var n=[],r=0;r<t.length;r++){var i=e(t[r]);null!==i&&n.push(i)}return n}));function m(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=null,i=f((function(e,t){var n=[];return(0,l.domEach)(t,(function(t){for(var i;(i=e(t))&&!(null==r?void 0:r(i,n.length));t=i)n.push(i)})),n})).apply(void 0,s([e],t,!1));return function(e,t){var n=this;r="string"==typeof e?function(t){return c.is(t,e,n.options)}:e?v(e):null;var o=i.call(this,t);return r=null,o}}function y(e){return Array.from(new Set(e))}function v(e){return"function"==typeof e?function(t,n){return e.call(t,n,t)}:(0,l.isCheerio)(e)?function(t){return Array.prototype.includes.call(e,t)}:function(t){return e===t}}function b(e,t,n,r){return"string"==typeof t?c.filter(t,e,{xmlMode:n,root:r}):e.filter(v(t))}t.parent=g((function(e){var t=e.parent;return t&&!(0,a.isDocument)(t)?t:null}),y),t.parents=p((function(e){for(var t=[];e.parent&&!(0,a.isDocument)(e.parent);)t.push(e.parent),e=e.parent;return t}),d.uniqueSort,(function(e){return e.reverse()})),t.parentsUntil=m((function(e){var t=e.parent;return t&&!(0,a.isDocument)(t)?t:null}),d.uniqueSort,(function(e){return e.reverse()})),t.closest=function(e){var t,n=[];if(!e)return this._make(n);var r={xmlMode:this.options.xmlMode,root:null===(t=this._root)||void 0===t?void 0:t[0]},i="string"==typeof e?function(t){return c.is(t,e,r)}:v(e);return(0,l.domEach)(this,(function(e){for(;e&&(0,l.isTag)(e);){if(i(e,0)){n.includes(e)||n.push(e);break}e=e.parent}})),this._make(n)},t.next=g((function(e){return(0,d.nextElementSibling)(e)})),t.nextAll=p((function(e){for(var t=[];e.next;)e=e.next,(0,l.isTag)(e)&&t.push(e);return t}),y),t.nextUntil=m((function(e){return(0,d.nextElementSibling)(e)}),y),t.prev=g((function(e){return(0,d.prevElementSibling)(e)})),t.prevAll=p((function(e){for(var t=[];e.prev;)e=e.prev,(0,l.isTag)(e)&&t.push(e);return t}),y),t.prevUntil=m((function(e){return(0,d.prevElementSibling)(e)}),y),t.siblings=p((function(e){return(0,d.getSiblings)(e).filter((function(t){return(0,l.isTag)(t)&&t!==e}))}),d.uniqueSort),t.children=p((function(e){return(0,d.getChildren)(e).filter(l.isTag)}),y),t.contents=function(){var e=this.toArray().reduce((function(e,t){return(0,a.hasChildren)(t)?e.concat(t.children):e}),[]);return this._make(e)},t.each=function(e){for(var t=0,n=this.length;t<n&&!1!==e.call(this[t],t,this[t]);)++t;return this},t.map=function(e){for(var t=[],n=0;n<this.length;n++){var r=this[n],i=e.call(r,n,r);null!=i&&(t=t.concat(i))}return this._make(t)},t.filter=function(e){var t;return this._make(b(this.toArray(),e,this.options.xmlMode,null===(t=this._root)||void 0===t?void 0:t[0]))},t.filterArray=b,t.is=function(e){var t=this.toArray();return"string"==typeof e?c.some(t.filter(l.isTag),e,this.options):!!e&&t.some(v(e))},t.not=function(e){var t=this.toArray();if("string"==typeof e){var n=new Set(c.filter(e,t,this.options));t=t.filter((function(e){return!n.has(e)}))}else{var r=v(e);t=t.filter((function(e,t){return!r(e,t)}))}return this._make(t)},t.has=function(e){var t=this;return this.filter("string"==typeof e?":has(".concat(e,")"):function(n,r){return t._make(r).find(e).length>0})},t.first=function(){return this.length>1?this._make(this[0]):this},t.last=function(){return this.length>0?this._make(this[this.length-1]):this},t.eq=function(e){var t;return 0===(e=+e)&&this.length<=1?this:(e<0&&(e=this.length+e),this._make(null!==(t=this[e])&&void 0!==t?t:[]))},t.get=function(e){return null==e?this.toArray():this[e<0?this.length+e:e]},t.toArray=function(){return Array.prototype.slice.call(this)},t.index=function(e){var t,n;return null==e?(t=this.parent().children(),n=this[0]):"string"==typeof e?(t=this._make(e),n=this[0]):(t=this,n=(0,l.isCheerio)(e)?e[0]:e),Array.prototype.indexOf.call(t,n)},t.slice=function(e,t){return this._make(Array.prototype.slice.call(this,e,t))},t.end=function(){var e;return null!==(e=this.prevObject)&&void 0!==e?e:this._make([])},t.add=function(e,t){var n=this._make(e,t),r=(0,d.uniqueSort)(s(s([],this.get(),!0),n.get(),!0));return this._make(r)},t.addBack=function(e){return this.prevObject?this.add(e?this.prevObject.filter(e):this.prevObject):this}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.select=t.filter=t.some=t.is=t.aliases=t.pseudos=t.filters=void 0;var c=n(605),l=n(1189),u=s(n(319)),d=s(n(799)),h=n(1359),f=n(1192),p=n(1189);Object.defineProperty(t,"filters",{enumerable:!0,get:function(){return p.filters}}),Object.defineProperty(t,"pseudos",{enumerable:!0,get:function(){return p.pseudos}}),Object.defineProperty(t,"aliases",{enumerable:!0,get:function(){return p.aliases}});var g={type:c.SelectorType.Universal,namespace:null},m={type:c.SelectorType.Pseudo,name:"scope",data:null};function y(e,t,n){if(void 0===n&&(n={}),"function"==typeof t)return e.some(t);var r=(0,h.groupSelectors)((0,c.parse)(t)),i=r[0],o=r[1];return i.length>0&&e.some((0,l._compileToken)(i,n))||o.some((function(t){return b(t,e,n).length>0}))}function v(e,t,n){if(0===t.length)return[];var r,i=(0,h.groupSelectors)(e),o=i[0],s=i[1];if(o.length){var a=E(t,o,n);if(0===s.length)return a;a.length&&(r=new Set(a))}for(var c=0;c<s.length&&(null==r?void 0:r.size)!==t.length;c++){var l=s[c];if(0===(r?t.filter((function(e){return u.isTag(e)&&!r.has(e)})):t).length)break;if((a=b(l,t,n)).length)if(r)a.forEach((function(e){return r.add(e)}));else{if(c===s.length-1)return a;r=new Set(a)}}return void 0!==r?r.size===t.length?t:t.filter((function(e){return r.has(e)})):[]}function b(e,t,n){var i;if(e.some(c.isTraversal)){var o=null!==(i=n.root)&&void 0!==i?i:(0,h.getDocumentRoot)(t[0]),s=r(r({},n),{context:t,relativeSelector:!1});return e.push(m),_(o,e,s,!0,t.length)}return _(t,e,n,!1,t.length)}function _(e,t,n,i,o){var s=t.findIndex(f.isFilter),a=t.slice(0,s),h=t[s],p=t.length-1===s?o:1/0,m=(0,f.getLimit)(h.name,h.data,p);if(0===m)return[];var y=(0!==a.length||Array.isArray(e)?0===a.length?(Array.isArray(e)?e:[e]).filter(u.isTag):i||a.some(c.isTraversal)?w(e,[a],n,m):E(e,[a],n):u.getChildren(e).filter(u.isTag)).slice(0,m),b=function(e,t,n,r){var i="string"==typeof n?parseInt(n,10):NaN;switch(e){case"first":case"lt":return t;case"last":return t.length>0?[t[t.length-1]]:t;case"nth":case"eq":return isFinite(i)&&Math.abs(i)<t.length?[i<0?t[t.length+i]:t[i]]:[];case"gt":return isFinite(i)?t.slice(i+1):[];case"even":return t.filter((function(e,t){return t%2==0}));case"odd":return t.filter((function(e,t){return t%2==1}));case"not":var o=new Set(v(n,t,r));return t.filter((function(e){return!o.has(e)}))}}(h.name,y,h.data,n);if(0===b.length||t.length===s+1)return b;var T=t.slice(s+1),A=T.some(c.isTraversal);if(A){if((0,c.isTraversal)(T[0])){var S=T[0].type;S!==c.SelectorType.Sibling&&S!==c.SelectorType.Adjacent||(b=(0,l.prepareContext)(b,u,!0)),T.unshift(g)}n=r(r({},n),{relativeSelector:!1,rootFunc:function(e){return b.includes(e)}})}else n.rootFunc&&n.rootFunc!==d.trueFunc&&(n=r(r({},n),{rootFunc:d.trueFunc}));return T.some(f.isFilter)?_(b,T,n,!1,o):A?w(b,[T],n,o):E(b,[T],n)}function w(e,t,n,r){return T(e,(0,l._compileToken)(t,n,e),r)}function T(e,t,n){void 0===n&&(n=1/0);var r=(0,l.prepareContext)(e,u,t.shouldTestNextSiblings);return u.find((function(e){return u.isTag(e)&&t(e)}),r,!0,n)}function E(e,t,n){var r=(Array.isArray(e)?e:[e]).filter(u.isTag);if(0===r.length)return r;var i=(0,l._compileToken)(t,n);return i===d.trueFunc?r:r.filter(i)}t.is=function(e,t,n){return void 0===n&&(n={}),y([e],t,n)},t.some=y,t.filter=function(e,t,n){return void 0===n&&(n={}),v((0,c.parse)(e),t,n)},t.select=function(e,t,n,r){if(void 0===n&&(n={}),void 0===r&&(r=1/0),"function"==typeof e)return T(t,e);var i=(0,h.groupSelectors)((0,c.parse)(e)),o=i[0],s=i[1].map((function(e){return _(t,e,n,!0,r)}));return o.length&&s.push(w(t,o,n,r)),0===s.length?[]:1===s.length?s[0]:u.uniqueSort(s.reduce((function(e,t){return a(a([],e,!0),t,!0)})))}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.compileToken=t.compileUnsafe=t.compile=void 0;var a=n(605),c=s(n(799)),l=o(n(1190)),u=n(1351),d=n(1090);function h(e,t,n){return y("string"==typeof e?(0,a.parse)(e):e,t,n)}function f(e){return e.type===a.SelectorType.Pseudo&&("scope"===e.name||Array.isArray(e.data)&&e.data.some((function(e){return e.some(f)})))}t.compile=function(e,t,n){var r=h(e,t,n);return(0,d.ensureIsTag)(r,t.adapter)},t.compileUnsafe=h;var p={type:a.SelectorType.Descendant},g={type:"_flexibleDescendant"},m={type:a.SelectorType.Pseudo,name:"scope",data:null};function y(e,t,n){var r;e.forEach(l.default),n=null!==(r=t.context)&&void 0!==r?r:n;var i=Array.isArray(n),o=n&&(Array.isArray(n)?n:[n]);if(!1!==t.relativeSelector)!function(e,t,n){for(var r=t.adapter,i=!!(null==n?void 0:n.every((function(e){var t=r.isTag(e)&&r.getParent(e);return e===d.PLACEHOLDER_ELEMENT||t&&r.isTag(t)}))),o=0,s=e;o<s.length;o++){var c=s[o];if(c.length>0&&(0,l.isTraversal)(c[0])&&c[0].type!==a.SelectorType.Descendant);else{if(!i||c.some(f))continue;c.unshift(p)}c.unshift(m)}}(e,t,o);else if(e.some((function(e){return e.length>0&&(0,l.isTraversal)(e[0])})))throw new Error("Relative selectors are not allowed when the `relativeSelector` option is disabled");var s=!1,h=e.map((function(e){if(e.length>=2){var n=e[0],r=e[1];n.type!==a.SelectorType.Pseudo||"scope"!==n.name||(i&&r.type===a.SelectorType.Descendant?e[1]=g:r.type!==a.SelectorType.Adjacent&&r.type!==a.SelectorType.Sibling||(s=!0))}return function(e,t,n){var r;return e.reduce((function(e,r){return e===c.default.falseFunc?c.default.falseFunc:(0,u.compileGeneralSelector)(e,r,t,n,y)}),null!==(r=t.rootFunc)&&void 0!==r?r:c.default.trueFunc)}(e,t,o)})).reduce(v,c.default.falseFunc);return h.shouldTestNextSiblings=s,h}function v(e,t){return t===c.default.falseFunc||e===c.default.trueFunc?e:e===c.default.falseFunc||t===c.default.trueFunc?t:function(n){return e(n)||t(n)}}t.compileToken=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.compileGeneralSelector=void 0;var r=n(1352),i=n(1191),o=n(605);function s(e,t){var n=t.getParent(e);return n&&t.isTag(n)?n:null}t.compileGeneralSelector=function(e,t,n,a,c){var l=n.adapter,u=n.equals;switch(t.type){case o.SelectorType.PseudoElement:throw new Error("Pseudo-elements are not supported by css-select");case o.SelectorType.ColumnCombinator:throw new Error("Column combinators are not yet supported by css-select");case o.SelectorType.Attribute:if(null!=t.namespace)throw new Error("Namespaced attributes are not yet supported by css-select");return n.xmlMode&&!n.lowerCaseAttributeNames||(t.name=t.name.toLowerCase()),r.attributeRules[t.action](e,t,n);case o.SelectorType.Pseudo:return(0,i.compilePseudoSelector)(e,t,n,a,c);case o.SelectorType.Tag:if(null!=t.namespace)throw new Error("Namespaced tag names are not yet supported by css-select");var d=t.name;return n.xmlMode&&!n.lowerCaseTags||(d=d.toLowerCase()),function(t){return l.getName(t)===d&&e(t)};case o.SelectorType.Descendant:if(!1===n.cacheResults||"undefined"==typeof WeakSet)return function(t){for(var n=t;n=s(n,l);)if(e(n))return!0;return!1};var h=new WeakSet;return function(t){for(var n=t;n=s(n,l);)if(!h.has(n)){if(l.isTag(n)&&e(n))return!0;h.add(n)}return!1};case"_flexibleDescendant":return function(t){var n=t;do{if(e(n))return!0}while(n=s(n,l));return!1};case o.SelectorType.Parent:return function(t){return l.getChildren(t).some((function(t){return l.isTag(t)&&e(t)}))};case o.SelectorType.Child:return function(t){var n=l.getParent(t);return null!=n&&l.isTag(n)&&e(n)};case o.SelectorType.Sibling:return function(t){for(var n=l.getSiblings(t),r=0;r<n.length;r++){var i=n[r];if(u(t,i))break;if(l.isTag(i)&&e(i))return!0}return!1};case o.SelectorType.Adjacent:return l.prevElementSibling?function(t){var n=l.prevElementSibling(t);return null!=n&&e(n)}:function(t){for(var n,r=l.getSiblings(t),i=0;i<r.length;i++){var o=r[i];if(u(t,o))break;l.isTag(o)&&(n=o)}return!!n&&e(n)};case o.SelectorType.Universal:if(null!=t.namespace&&"*"!==t.namespace)throw new Error("Namespaced universal selectors are not yet supported by css-select");return e}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.attributeRules=void 0;var i=r(n(799)),o=/[-[\]{}()*+?.,\\^$|#\s]/g;function s(e){return e.replace(o,"\\$&")}var a=new Set(["accept","accept-charset","align","alink","axis","bgcolor","charset","checked","clear","codetype","color","compact","declare","defer","dir","direction","disabled","enctype","face","frame","hreflang","http-equiv","lang","language","link","media","method","multiple","nohref","noresize","noshade","nowrap","readonly","rel","rev","rules","scope","scrolling","selected","shape","target","text","type","valign","valuetype","vlink"]);function c(e,t){return"boolean"==typeof e.ignoreCase?e.ignoreCase:"quirks"===e.ignoreCase?!!t.quirksMode:!t.xmlMode&&a.has(e.name)}t.attributeRules={equals:function(e,t,n){var r=n.adapter,i=t.name,o=t.value;return c(t,n)?(o=o.toLowerCase(),function(t){var n=r.getAttributeValue(t,i);return null!=n&&n.length===o.length&&n.toLowerCase()===o&&e(t)}):function(t){return r.getAttributeValue(t,i)===o&&e(t)}},hyphen:function(e,t,n){var r=n.adapter,i=t.name,o=t.value,s=o.length;return c(t,n)?(o=o.toLowerCase(),function(t){var n=r.getAttributeValue(t,i);return null!=n&&(n.length===s||"-"===n.charAt(s))&&n.substr(0,s).toLowerCase()===o&&e(t)}):function(t){var n=r.getAttributeValue(t,i);return null!=n&&(n.length===s||"-"===n.charAt(s))&&n.substr(0,s)===o&&e(t)}},element:function(e,t,n){var r=n.adapter,o=t.name,a=t.value;if(/\s/.test(a))return i.default.falseFunc;var l=new RegExp("(?:^|\\s)".concat(s(a),"(?:$|\\s)"),c(t,n)?"i":"");return function(t){var n=r.getAttributeValue(t,o);return null!=n&&n.length>=a.length&&l.test(n)&&e(t)}},exists:function(e,t,n){var r=t.name,i=n.adapter;return function(t){return i.hasAttrib(t,r)&&e(t)}},start:function(e,t,n){var r=n.adapter,o=t.name,s=t.value,a=s.length;return 0===a?i.default.falseFunc:c(t,n)?(s=s.toLowerCase(),function(t){var n=r.getAttributeValue(t,o);return null!=n&&n.length>=a&&n.substr(0,a).toLowerCase()===s&&e(t)}):function(t){var n;return!!(null===(n=r.getAttributeValue(t,o))||void 0===n?void 0:n.startsWith(s))&&e(t)}},end:function(e,t,n){var r=n.adapter,o=t.name,s=t.value,a=-s.length;return 0===a?i.default.falseFunc:c(t,n)?(s=s.toLowerCase(),function(t){var n;return(null===(n=r.getAttributeValue(t,o))||void 0===n?void 0:n.substr(a).toLowerCase())===s&&e(t)}):function(t){var n;return!!(null===(n=r.getAttributeValue(t,o))||void 0===n?void 0:n.endsWith(s))&&e(t)}},any:function(e,t,n){var r=n.adapter,o=t.name,a=t.value;if(""===a)return i.default.falseFunc;if(c(t,n)){var l=new RegExp(s(a),"i");return function(t){var n=r.getAttributeValue(t,o);return null!=n&&n.length>=a.length&&l.test(n)&&e(t)}}return function(t){var n;return!!(null===(n=r.getAttributeValue(t,o))||void 0===n?void 0:n.includes(a))&&e(t)}},not:function(e,t,n){var r=n.adapter,i=t.name,o=t.value;return""===o?function(t){return!!r.getAttributeValue(t,i)&&e(t)}:c(t,n)?(o=o.toLowerCase(),function(t){var n=r.getAttributeValue(t,i);return(null==n||n.length!==o.length||n.toLowerCase()!==o)&&e(t)}):function(t){return r.getAttributeValue(t,i)!==o&&e(t)}}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.filters=void 0;var i=r(n(1354)),o=r(n(799));function s(e,t){return function(n){var r=t.getParent(n);return null!=r&&t.isTag(r)&&e(n)}}function a(e){return function(t,n,r){var i=r.adapter[e];return"function"!=typeof i?o.default.falseFunc:function(e){return i(e)&&t(e)}}}t.filters={contains:function(e,t,n){var r=n.adapter;return function(n){return e(n)&&r.getText(n).includes(t)}},icontains:function(e,t,n){var r=n.adapter,i=t.toLowerCase();return function(t){return e(t)&&r.getText(t).toLowerCase().includes(i)}},"nth-child":function(e,t,n){var r=n.adapter,a=n.equals,c=(0,i.default)(t);return c===o.default.falseFunc?o.default.falseFunc:c===o.default.trueFunc?s(e,r):function(t){for(var n=r.getSiblings(t),i=0,o=0;o<n.length&&!a(t,n[o]);o++)r.isTag(n[o])&&i++;return c(i)&&e(t)}},"nth-last-child":function(e,t,n){var r=n.adapter,a=n.equals,c=(0,i.default)(t);return c===o.default.falseFunc?o.default.falseFunc:c===o.default.trueFunc?s(e,r):function(t){for(var n=r.getSiblings(t),i=0,o=n.length-1;o>=0&&!a(t,n[o]);o--)r.isTag(n[o])&&i++;return c(i)&&e(t)}},"nth-of-type":function(e,t,n){var r=n.adapter,a=n.equals,c=(0,i.default)(t);return c===o.default.falseFunc?o.default.falseFunc:c===o.default.trueFunc?s(e,r):function(t){for(var n=r.getSiblings(t),i=0,o=0;o<n.length;o++){var s=n[o];if(a(t,s))break;r.isTag(s)&&r.getName(s)===r.getName(t)&&i++}return c(i)&&e(t)}},"nth-last-of-type":function(e,t,n){var r=n.adapter,a=n.equals,c=(0,i.default)(t);return c===o.default.falseFunc?o.default.falseFunc:c===o.default.trueFunc?s(e,r):function(t){for(var n=r.getSiblings(t),i=0,o=n.length-1;o>=0;o--){var s=n[o];if(a(t,s))break;r.isTag(s)&&r.getName(s)===r.getName(t)&&i++}return c(i)&&e(t)}},root:function(e,t,n){var r=n.adapter;return function(t){var n=r.getParent(t);return(null==n||!r.isTag(n))&&e(t)}},scope:function(e,n,r,i){var o=r.equals;return i&&0!==i.length?1===i.length?function(t){return o(i[0],t)&&e(t)}:function(t){return i.includes(t)&&e(t)}:t.filters.root(e,n,r)},hover:a("isHovered"),visited:a("isVisited"),active:a("isActive")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sequence=t.generate=t.compile=t.parse=void 0;var r=n(1355);Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return r.parse}});var i=n(1356);Object.defineProperty(t,"compile",{enumerable:!0,get:function(){return i.compile}}),Object.defineProperty(t,"generate",{enumerable:!0,get:function(){return i.generate}}),t.default=function(e){return(0,i.compile)((0,r.parse)(e))},t.sequence=function(e){return(0,i.generate)((0,r.parse)(e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parse=void 0;var r=new Set([9,10,12,13,32]),i="0".charCodeAt(0),o="9".charCodeAt(0);t.parse=function(e){if("even"===(e=e.trim().toLowerCase()))return[2,0];if("odd"===e)return[2,1];var t=0,n=0,s=c(),a=l();if(t<e.length&&"n"===e.charAt(t)&&(t++,n=s*(null!=a?a:1),u(),t<e.length?(s=c(),u(),a=l()):s=a=0),null===a||t<e.length)throw new Error("n-th rule couldn't be parsed ('".concat(e,"')"));return[n,s*a];function c(){return"-"===e.charAt(t)?(t++,-1):("+"===e.charAt(t)&&t++,1)}function l(){for(var n=t,r=0;t<e.length&&e.charCodeAt(t)>=i&&e.charCodeAt(t)<=o;)r=10*r+(e.charCodeAt(t)-i),t++;return t===n?null:r}function u(){for(;t<e.length&&r.has(e.charCodeAt(t));)t++}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.generate=t.compile=void 0;var i=r(n(799));t.compile=function(e){var t=e[0],n=e[1]-1;if(n<0&&t<=0)return i.default.falseFunc;if(-1===t)return function(e){return e<=n};if(0===t)return function(e){return e===n};if(1===t)return n<0?i.default.trueFunc:function(e){return e>=n};var r=Math.abs(t),o=(n%r+r)%r;return t>1?function(e){return e>=n&&e%r===o}:function(e){return e<=n&&e%r===o}},t.generate=function(e){var t=e[0],n=e[1]-1,r=0;if(t<0){var i=-t,o=(n%i+i)%i;return function(){var e=o+i*r++;return e>n?null:e}}return 0===t?n<0?function(){return null}:function(){return 0==r++?n:null}:(n<0&&(n+=t*Math.ceil(-n/t)),function(){return t*r+++n})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.verifyPseudoArgs=t.pseudos=void 0,t.pseudos={empty:function(e,t){var n=t.adapter;return!n.getChildren(e).some((function(e){return n.isTag(e)||""!==n.getText(e)}))},"first-child":function(e,t){var n=t.adapter,r=t.equals;if(n.prevElementSibling)return null==n.prevElementSibling(e);var i=n.getSiblings(e).find((function(e){return n.isTag(e)}));return null!=i&&r(e,i)},"last-child":function(e,t){for(var n=t.adapter,r=t.equals,i=n.getSiblings(e),o=i.length-1;o>=0;o--){if(r(e,i[o]))return!0;if(n.isTag(i[o]))break}return!1},"first-of-type":function(e,t){for(var n=t.adapter,r=t.equals,i=n.getSiblings(e),o=n.getName(e),s=0;s<i.length;s++){var a=i[s];if(r(e,a))return!0;if(n.isTag(a)&&n.getName(a)===o)break}return!1},"last-of-type":function(e,t){for(var n=t.adapter,r=t.equals,i=n.getSiblings(e),o=n.getName(e),s=i.length-1;s>=0;s--){var a=i[s];if(r(e,a))return!0;if(n.isTag(a)&&n.getName(a)===o)break}return!1},"only-of-type":function(e,t){var n=t.adapter,r=t.equals,i=n.getName(e);return n.getSiblings(e).every((function(t){return r(e,t)||!n.isTag(t)||n.getName(t)!==i}))},"only-child":function(e,t){var n=t.adapter,r=t.equals;return n.getSiblings(e).every((function(t){return r(e,t)||!n.isTag(t)}))}},t.verifyPseudoArgs=function(e,t,n,r){if(null===n){if(e.length>r)throw new Error("Pseudo-class :".concat(t," requires an argument"))}else if(e.length===r)throw new Error("Pseudo-class :".concat(t," doesn't have any arguments"))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.aliases=void 0,t.aliases={"any-link":":is(a, area, link)[href]",link:":any-link:not(:visited)",disabled:":is(\n        :is(button, input, select, textarea, optgroup, option)[disabled],\n        optgroup[disabled] > option,\n        fieldset[disabled]:not(fieldset[disabled] legend:first-of-type *)\n    )",enabled:":not(:disabled)",checked:":is(:is(input[type=radio], input[type=checkbox])[checked], option:selected)",required:":is(input, select, textarea)[required]",optional:":is(input, select, textarea):not([required])",selected:"option:is([selected], select:not([multiple]):not(:has(> option[selected])) > :first-of-type)",checkbox:"[type=checkbox]",file:"[type=file]",password:"[type=password]",radio:"[type=radio]",reset:"[type=reset]",image:"[type=image]",submit:"[type=submit]",parent:":not(:empty)",header:":is(h1, h2, h3, h4, h5, h6)",button:":is(button, input[type=button])",input:":is(input, textarea, select, button)",text:"input:is(:not([type!='']), [type=text])"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.groupSelectors=t.getDocumentRoot=void 0;var r=n(1192);t.getDocumentRoot=function(e){for(;e.parent;)e=e.parent;return e},t.groupSelectors=function(e){for(var t=[],n=[],i=0,o=e;i<o.length;i++){var s=o[i];s.some(r.isFilter)?t.push(s):n.push(s)}return[n,t]}},function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.clone=t.text=t.toString=t.html=t.empty=t.replaceWith=t.remove=t.insertBefore=t.before=t.insertAfter=t.after=t.wrapAll=t.unwrap=t.wrapInner=t.wrap=t.prepend=t.append=t.prependTo=t.appendTo=t._makeDomArray=void 0;var i=n(155),o=n(1193),s=n(884),a=n(885),c=n(319);function l(e){return function(){for(var t=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=this.length-1;return(0,a.domEach)(this,(function(r,s){if((0,i.hasChildren)(r)){var a="function"==typeof n[0]?n[0].call(r,s,t._render(r.children)):n,c=t._makeDomArray(a,s<o);e(c,r.children,r)}}))}}function u(e,t,n,i,o){for(var s,a,c=r([t,n],i,!0),l=0===t?null:e[t-1],u=t+n>=e.length?null:e[t+n],d=0;d<i.length;++d){var h=i[d],f=h.parent;if(f){var p=f.children.indexOf(h);p>-1&&(f.children.splice(p,1),o===f&&t>p&&c[0]--)}h.parent=o,h.prev&&(h.prev.next=null!==(s=h.next)&&void 0!==s?s:null),h.next&&(h.next.prev=null!==(a=h.prev)&&void 0!==a?a:null),h.prev=0===d?l:i[d-1],h.next=d===i.length-1?u:i[d+1]}return l&&(l.next=i[0]),u&&(u.prev=i[i.length-1]),e.splice.apply(e,c)}function d(e){return function(t){for(var n=this.length-1,r=this.parents().last(),o=0;o<this.length;o++){var s=this[o],c="function"==typeof t?t.call(s,o,s):"string"!=typeof t||(0,a.isHtml)(t)?t:r.find(t).clone(),l=this._makeDomArray(c,o<n)[0];if(l&&(0,i.hasChildren)(l)){for(var u=l,d=0;d<u.children.length;){var h=u.children[d];(0,a.isTag)(h)?(u=h,d=0):d++}e(s,u,[l])}}return this}}t._makeDomArray=function(e,t){var n=this;return null==e?[]:(0,a.isCheerio)(e)?t?(0,a.cloneDom)(e.get()):e.get():Array.isArray(e)?e.reduce((function(e,r){return e.concat(n._makeDomArray(r,t))}),[]):"string"==typeof e?this._parse(e,this.options,!1,null).children:t?(0,a.cloneDom)([e]):[e]},t.appendTo=function(e){return((0,a.isCheerio)(e)?e:this._make(e)).append(this),this},t.prependTo=function(e){return((0,a.isCheerio)(e)?e:this._make(e)).prepend(this),this},t.append=l((function(e,t,n){u(t,t.length,0,e,n)})),t.prepend=l((function(e,t,n){u(t,0,0,e,n)})),t.wrap=d((function(e,t,n){var r=e.parent;if(r){var i=r.children,s=i.indexOf(e);(0,o.update)([e],t),u(i,s,0,n,r)}})),t.wrapInner=d((function(e,t,n){(0,i.hasChildren)(e)&&((0,o.update)(e.children,t),(0,o.update)(n,e))})),t.unwrap=function(e){var t=this;return this.parent(e).not("body").each((function(e,n){t._make(n).replaceWith(n.children)})),this},t.wrapAll=function(e){var t=this[0];if(t){for(var n=this._make("function"==typeof e?e.call(t,0,t):e).insertBefore(t),r=void 0,i=0;i<n.length;i++)"tag"===n[i].type&&(r=n[i]);for(var o=0;r&&o<r.children.length;){var s=r.children[o];"tag"===s.type?(r=s,o=0):o++}r&&this._make(r).append(this)}return this},t.after=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this.length-1;return(0,a.domEach)(this,(function(n,o){var s=n.parent;if((0,i.hasChildren)(n)&&s){var a=s.children,c=a.indexOf(n);if(!(c<0)){var l="function"==typeof t[0]?t[0].call(n,o,e._render(n.children)):t;u(a,c+1,0,e._makeDomArray(l,o<r),s)}}}))},t.insertAfter=function(e){var t=this;"string"==typeof e&&(e=this._make(e)),this.remove();var n=[];return this._makeDomArray(e).forEach((function(e){var r=t.clone().toArray(),i=e.parent;if(i){var o=i.children,s=o.indexOf(e);s<0||(u(o,s+1,0,r,i),n.push.apply(n,r))}})),this._make(n)},t.before=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=this.length-1;return(0,a.domEach)(this,(function(n,o){var s=n.parent;if((0,i.hasChildren)(n)&&s){var a=s.children,c=a.indexOf(n);if(!(c<0)){var l="function"==typeof t[0]?t[0].call(n,o,e._render(n.children)):t;u(a,c,0,e._makeDomArray(l,o<r),s)}}}))},t.insertBefore=function(e){var t=this,n=this._make(e);this.remove();var r=[];return(0,a.domEach)(n,(function(e){var n=t.clone().toArray(),i=e.parent;if(i){var o=i.children,s=o.indexOf(e);s<0||(u(o,s,0,n,i),r.push.apply(r,n))}})),this._make(r)},t.remove=function(e){var t=e?this.filter(e):this;return(0,a.domEach)(t,(function(e){(0,c.removeElement)(e),e.prev=e.next=e.parent=null})),this},t.replaceWith=function(e){var t=this;return(0,a.domEach)(this,(function(n,r){var i=n.parent;if(i){var s=i.children,a="function"==typeof e?e.call(n,r,n):e,c=t._makeDomArray(a);(0,o.update)(c,null);var l=s.indexOf(n);u(s,l,1,c,i),c.includes(n)||(n.parent=n.prev=n.next=null)}}))},t.empty=function(){return(0,a.domEach)(this,(function(e){(0,i.hasChildren)(e)&&(e.children.forEach((function(e){e.next=e.prev=e.parent=null})),e.children.length=0)}))},t.html=function(e){var t=this;if(void 0===e){var n=this[0];return n&&(0,i.hasChildren)(n)?this._render(n.children):null}return(0,a.domEach)(this,(function(n){if((0,i.hasChildren)(n)){n.children.forEach((function(e){e.next=e.prev=e.parent=null}));var r=(0,a.isCheerio)(e)?e.toArray():t._parse("".concat(e),t.options,!1,n).children;(0,o.update)(r,n)}}))},t.toString=function(){return this._render(this)},t.text=function(e){var t=this;return void 0===e?(0,s.text)(this):"function"==typeof e?(0,a.domEach)(this,(function(n,r){return t._make(n).text(e.call(n,r,(0,s.text)([n])))})):(0,a.domEach)(this,(function(t){if((0,i.hasChildren)(t)){t.children.forEach((function(e){e.next=e.prev=e.parent=null}));var n=new i.Text("".concat(e));(0,o.update)(n,t)}}))},t.clone=function(){return this._make((0,a.cloneDom)(this.get()))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.css=void 0;var r=n(885);function i(e,t,n,r){if("string"==typeof t){var s=o(e),a="function"==typeof n?n.call(e,r,s[t]):n;""===a?delete s[t]:null!=a&&(s[t]=a),e.attribs.style=(c=s,Object.keys(c).reduce((function(e,t){return"".concat(e).concat(e?" ":"").concat(t,": ").concat(c[t],";")}),""))}else"object"==typeof t&&Object.keys(t).forEach((function(n,r){i(e,n,t[n],r)}));var c}function o(e,t){if(e&&(0,r.isTag)(e)){var n=function(e){if(e=(e||"").trim(),!e)return{};for(var t,n={},r=0,i=e.split(";");r<i.length;r++){var o=i[r],s=o.indexOf(":");if(s<1||s===o.length-1){var a=o.trimEnd();a.length>0&&void 0!==t&&(n[t]+=";".concat(a))}else n[t=o.slice(0,s).trim()]=o.slice(s+1).trim()}return n}(e.attribs.style);if("string"==typeof t)return n[t];if(Array.isArray(t)){var i={};return t.forEach((function(e){null!=n[e]&&(i[e]=n[e])})),i}return n}}t.css=function(e,t){return null!=e&&null!=t||"object"==typeof e&&!Array.isArray(e)?(0,r.domEach)(this,(function(n,o){(0,r.isTag)(n)&&i(n,e,t,o)})):0!==this.length?o(this[0],e):void 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serializeArray=t.serialize=void 0;var r=n(885),i="input,select,textarea,keygen",o=/%20/g,s=/\r?\n/g;t.serialize=function(){return this.serializeArray().map((function(e){return"".concat(encodeURIComponent(e.name),"=").concat(encodeURIComponent(e.value))})).join("&").replace(o,"+")},t.serializeArray=function(){var e=this;return this.map((function(t,n){var o=e._make(n);return(0,r.isTag)(n)&&"form"===n.name?o.find(i).toArray():o.filter(i).toArray()})).filter('[name!=""]:enabled:not(:submit, :button, :image, :reset, :file):matches([checked], :not(:checkbox, :radio))').map((function(t,n){var r,i=e._make(n),o=i.attr("name"),a=null!==(r=i.val())&&void 0!==r?r:"";return Array.isArray(a)?a.map((function(e){return{name:o,value:e.replace(s,"\r\n")}})):{name:o,value:a.replace(s,"\r\n")}})).toArray()}},function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.renderWithParse5=t.parseWithParse5=void 0;var i=n(155),o=n(1194),s=n(1369);t.parseWithParse5=function(e,t,n,r){var i={scriptingEnabled:"boolean"!=typeof t.scriptingEnabled||t.scriptingEnabled,treeAdapter:s.adapter,sourceCodeLocationInfo:t.sourceCodeLocationInfo};return n?(0,o.parse)(e,i):(0,o.parseFragment)(r,e,i)};var a={treeAdapter:s.adapter};t.renderWithParse5=function(e){for(var t,n=("length"in e?e:[e]),s=0;s<n.length;s+=1){var c=n[s];(0,i.isDocument)(c)&&(t=Array.prototype.splice).call.apply(t,r([n,s,1],c.children,!1))}var l="";for(s=0;s<n.length;s+=1){c=n[s];l+=(0,o.serializeOuter)(c,a)}return l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Preprocessor=void 0;const r=n(1091),i=n(1062);t.Preprocessor=class{constructor(e){this.handler=e,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=65536,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+Number(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(e){const{line:t,col:n,offset:r}=this;return{code:e,startLine:t,endLine:t,startCol:n,endCol:n,startOffset:r,endOffset:r}}_err(e){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(e)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(e){if(this.pos!==this.html.length-1){const t=this.html.charCodeAt(this.pos+1);if((0,r.isSurrogatePair)(t))return this.pos++,this._addGap(),(0,r.getSurrogatePairCodePoint)(e,t)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,r.CODE_POINTS.EOF;return this._err(i.ERR.surrogateInInputStream),e}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(e,t){this.html.length>0?this.html+=e:this.html=e,this.endOfChunkHit=!1,this.lastChunkWritten=t}insertHtmlAtCurrentPos(e){this.html=this.html.substring(0,this.pos+1)+e+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(e,t){if(this.pos+e.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(t)return this.html.startsWith(e,this.pos);for(let t=0;t<e.length;t++){if((32|this.html.charCodeAt(this.pos+t))!==e.charCodeAt(t))return!1}return!0}peek(e){const t=this.pos+e;if(t>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,r.CODE_POINTS.EOF;const n=this.html.charCodeAt(t);return n===r.CODE_POINTS.CARRIAGE_RETURN?r.CODE_POINTS.LINE_FEED:n}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,r.CODE_POINTS.EOF;let e=this.html.charCodeAt(this.pos);if(e===r.CODE_POINTS.CARRIAGE_RETURN)return this.isEol=!0,this.skipNextNewLine=!0,r.CODE_POINTS.LINE_FEED;if(e===r.CODE_POINTS.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine))return this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance();this.skipNextNewLine=!1,(0,r.isSurrogate)(e)&&(e=this._processSurrogate(e));return null===this.handler.onParseError||e>31&&e<127||e===r.CODE_POINTS.LINE_FEED||e===r.CODE_POINTS.CARRIAGE_RETURN||e>159&&e<64976||this._checkForProblematicCharacters(e),e}_checkForProblematicCharacters(e){(0,r.isControlCodePoint)(e)?this._err(i.ERR.controlCharacterInInputStream):(0,r.isUndefinedCodePoint)(e)&&this._err(i.ERR.noncharacterInInputStream)}retreat(e){for(this.pos-=e;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpenElementStack=void 0;const r=n(732),i=new Set([r.TAG_ID.DD,r.TAG_ID.DT,r.TAG_ID.LI,r.TAG_ID.OPTGROUP,r.TAG_ID.OPTION,r.TAG_ID.P,r.TAG_ID.RB,r.TAG_ID.RP,r.TAG_ID.RT,r.TAG_ID.RTC]),o=new Set([...i,r.TAG_ID.CAPTION,r.TAG_ID.COLGROUP,r.TAG_ID.TBODY,r.TAG_ID.TD,r.TAG_ID.TFOOT,r.TAG_ID.TH,r.TAG_ID.THEAD,r.TAG_ID.TR]),s=new Map([[r.TAG_ID.APPLET,r.NS.HTML],[r.TAG_ID.CAPTION,r.NS.HTML],[r.TAG_ID.HTML,r.NS.HTML],[r.TAG_ID.MARQUEE,r.NS.HTML],[r.TAG_ID.OBJECT,r.NS.HTML],[r.TAG_ID.TABLE,r.NS.HTML],[r.TAG_ID.TD,r.NS.HTML],[r.TAG_ID.TEMPLATE,r.NS.HTML],[r.TAG_ID.TH,r.NS.HTML],[r.TAG_ID.ANNOTATION_XML,r.NS.MATHML],[r.TAG_ID.MI,r.NS.MATHML],[r.TAG_ID.MN,r.NS.MATHML],[r.TAG_ID.MO,r.NS.MATHML],[r.TAG_ID.MS,r.NS.MATHML],[r.TAG_ID.MTEXT,r.NS.MATHML],[r.TAG_ID.DESC,r.NS.SVG],[r.TAG_ID.FOREIGN_OBJECT,r.NS.SVG],[r.TAG_ID.TITLE,r.NS.SVG]]),a=[r.TAG_ID.H1,r.TAG_ID.H2,r.TAG_ID.H3,r.TAG_ID.H4,r.TAG_ID.H5,r.TAG_ID.H6],c=[r.TAG_ID.TR,r.TAG_ID.TEMPLATE,r.TAG_ID.HTML],l=[r.TAG_ID.TBODY,r.TAG_ID.TFOOT,r.TAG_ID.THEAD,r.TAG_ID.TEMPLATE,r.TAG_ID.HTML],u=[r.TAG_ID.TABLE,r.TAG_ID.TEMPLATE,r.TAG_ID.HTML],d=[r.TAG_ID.TD,r.TAG_ID.TH];t.OpenElementStack=class{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(e,t,n){this.treeAdapter=t,this.handler=n,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=r.TAG_ID.UNKNOWN,this.current=e}_indexOf(e){return this.items.lastIndexOf(e,this.stackTop)}_isInTemplate(){return this.currentTagId===r.TAG_ID.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===r.NS.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(e,t){this.stackTop++,this.items[this.stackTop]=e,this.current=e,this.tagIDs[this.stackTop]=t,this.currentTagId=t,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(e,t,!0)}pop(){const e=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!0)}replace(e,t){const n=this._indexOf(e);this.items[n]=t,n===this.stackTop&&(this.current=t)}insertAfter(e,t,n){const r=this._indexOf(e)+1;this.items.splice(r,0,t),this.tagIDs.splice(r,0,n),this.stackTop++,r===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,r===this.stackTop)}popUntilTagNamePopped(e){let t=this.stackTop+1;do{t=this.tagIDs.lastIndexOf(e,t-1)}while(t>0&&this.treeAdapter.getNamespaceURI(this.items[t])!==r.NS.HTML);this.shortenToLength(t<0?0:t)}shortenToLength(e){for(;this.stackTop>=e;){const t=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,this.stackTop<e)}}popUntilElementPopped(e){const t=this._indexOf(e);this.shortenToLength(t<0?0:t)}popUntilPopped(e,t){const n=this._indexOfTagNames(e,t);this.shortenToLength(n<0?0:n)}popUntilNumberedHeaderPopped(){this.popUntilPopped(a,r.NS.HTML)}popUntilTableCellPopped(){this.popUntilPopped(d,r.NS.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(e,t){for(let n=this.stackTop;n>=0;n--)if(e.includes(this.tagIDs[n])&&this.treeAdapter.getNamespaceURI(this.items[n])===t)return n;return-1}clearBackTo(e,t){const n=this._indexOfTagNames(e,t);this.shortenToLength(n+1)}clearBackToTableContext(){this.clearBackTo(u,r.NS.HTML)}clearBackToTableBodyContext(){this.clearBackTo(l,r.NS.HTML)}clearBackToTableRowContext(){this.clearBackTo(c,r.NS.HTML)}remove(e){const t=this._indexOf(e);t>=0&&(t===this.stackTop?this.pop():(this.items.splice(t,1),this.tagIDs.splice(t,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===r.TAG_ID.BODY?this.items[1]:null}contains(e){return this._indexOf(e)>-1}getCommonAncestor(e){const t=this._indexOf(e)-1;return t>=0?this.items[t]:null}isRootHtmlElementCurrent(){return 0===this.stackTop&&this.tagIDs[0]===r.TAG_ID.HTML}hasInScope(e){for(let t=this.stackTop;t>=0;t--){const n=this.tagIDs[t],i=this.treeAdapter.getNamespaceURI(this.items[t]);if(n===e&&i===r.NS.HTML)return!0;if(s.get(n)===i)return!1}return!0}hasNumberedHeaderInScope(){for(let e=this.stackTop;e>=0;e--){const t=this.tagIDs[e],n=this.treeAdapter.getNamespaceURI(this.items[e]);if((0,r.isNumberedHeader)(t)&&n===r.NS.HTML)return!0;if(s.get(t)===n)return!1}return!0}hasInListItemScope(e){for(let t=this.stackTop;t>=0;t--){const n=this.tagIDs[t],i=this.treeAdapter.getNamespaceURI(this.items[t]);if(n===e&&i===r.NS.HTML)return!0;if((n===r.TAG_ID.UL||n===r.TAG_ID.OL)&&i===r.NS.HTML||s.get(n)===i)return!1}return!0}hasInButtonScope(e){for(let t=this.stackTop;t>=0;t--){const n=this.tagIDs[t],i=this.treeAdapter.getNamespaceURI(this.items[t]);if(n===e&&i===r.NS.HTML)return!0;if(n===r.TAG_ID.BUTTON&&i===r.NS.HTML||s.get(n)===i)return!1}return!0}hasInTableScope(e){for(let t=this.stackTop;t>=0;t--){const n=this.tagIDs[t];if(this.treeAdapter.getNamespaceURI(this.items[t])===r.NS.HTML){if(n===e)return!0;if(n===r.TAG_ID.TABLE||n===r.TAG_ID.TEMPLATE||n===r.TAG_ID.HTML)return!1}}return!0}hasTableBodyContextInTableScope(){for(let e=this.stackTop;e>=0;e--){const t=this.tagIDs[e];if(this.treeAdapter.getNamespaceURI(this.items[e])===r.NS.HTML){if(t===r.TAG_ID.TBODY||t===r.TAG_ID.THEAD||t===r.TAG_ID.TFOOT)return!0;if(t===r.TAG_ID.TABLE||t===r.TAG_ID.HTML)return!1}}return!0}hasInSelectScope(e){for(let t=this.stackTop;t>=0;t--){const n=this.tagIDs[t];if(this.treeAdapter.getNamespaceURI(this.items[t])===r.NS.HTML){if(n===e)return!0;if(n!==r.TAG_ID.OPTION&&n!==r.TAG_ID.OPTGROUP)return!1}}return!0}generateImpliedEndTags(){for(;i.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;o.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(e){for(;this.currentTagId!==e&&o.has(this.currentTagId);)this.pop()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FormattingElementList=t.EntryType=void 0;var r;!function(e){e[e.Marker=0]="Marker",e[e.Element=1]="Element"}(r=t.EntryType||(t.EntryType={}));const i={type:r.Marker};t.FormattingElementList=class{constructor(e){this.treeAdapter=e,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(e,t){const n=[],i=t.length,o=this.treeAdapter.getTagName(e),s=this.treeAdapter.getNamespaceURI(e);for(let e=0;e<this.entries.length;e++){const t=this.entries[e];if(t.type===r.Marker)break;const{element:a}=t;if(this.treeAdapter.getTagName(a)===o&&this.treeAdapter.getNamespaceURI(a)===s){const t=this.treeAdapter.getAttrList(a);t.length===i&&n.push({idx:e,attrs:t})}}return n}_ensureNoahArkCondition(e){if(this.entries.length<3)return;const t=this.treeAdapter.getAttrList(e),n=this._getNoahArkConditionCandidates(e,t);if(n.length<3)return;const r=new Map(t.map((e=>[e.name,e.value])));let i=0;for(let e=0;e<n.length;e++){const t=n[e];t.attrs.every((e=>r.get(e.name)===e.value))&&(i+=1,i>=3&&this.entries.splice(t.idx,1))}}insertMarker(){this.entries.unshift(i)}pushElement(e,t){this._ensureNoahArkCondition(e),this.entries.unshift({type:r.Element,element:e,token:t})}insertElementAfterBookmark(e,t){const n=this.entries.indexOf(this.bookmark);this.entries.splice(n,0,{type:r.Element,element:e,token:t})}removeEntry(e){const t=this.entries.indexOf(e);t>=0&&this.entries.splice(t,1)}clearToLastMarker(){const e=this.entries.indexOf(i);e>=0?this.entries.splice(0,e+1):this.entries.length=0}getElementEntryInScopeWithTagName(e){const t=this.entries.find((t=>t.type===r.Marker||this.treeAdapter.getTagName(t.element)===e));return t&&t.type===r.Element?t:null}getElementEntry(e){return this.entries.find((t=>t.type===r.Element&&t.element===e))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDocumentMode=t.isConforming=void 0;const r=n(732),i="html",o=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],s=[...o,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],a=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),c=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],l=[...c,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function u(e,t){return t.some((t=>e.startsWith(t)))}t.isConforming=function(e){return e.name===i&&null===e.publicId&&(null===e.systemId||"about:legacy-compat"===e.systemId)},t.getDocumentMode=function(e){if(e.name!==i)return r.DOCUMENT_MODE.QUIRKS;const{systemId:t}=e;if(t&&"http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd"===t.toLowerCase())return r.DOCUMENT_MODE.QUIRKS;let{publicId:n}=e;if(null!==n){if(n=n.toLowerCase(),a.has(n))return r.DOCUMENT_MODE.QUIRKS;let e=null===t?s:o;if(u(n,e))return r.DOCUMENT_MODE.QUIRKS;if(e=null===t?c:l,u(n,e))return r.DOCUMENT_MODE.LIMITED_QUIRKS}return r.DOCUMENT_MODE.NO_QUIRKS}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serializeOuter=t.serialize=void 0;const r=n(732),i=n(509),o=n(1093),s=new Set([r.TAG_NAMES.AREA,r.TAG_NAMES.BASE,r.TAG_NAMES.BASEFONT,r.TAG_NAMES.BGSOUND,r.TAG_NAMES.BR,r.TAG_NAMES.COL,r.TAG_NAMES.EMBED,r.TAG_NAMES.FRAME,r.TAG_NAMES.HR,r.TAG_NAMES.IMG,r.TAG_NAMES.INPUT,r.TAG_NAMES.KEYGEN,r.TAG_NAMES.LINK,r.TAG_NAMES.META,r.TAG_NAMES.PARAM,r.TAG_NAMES.SOURCE,r.TAG_NAMES.TRACK,r.TAG_NAMES.WBR]);function a(e,t){return t.treeAdapter.isElementNode(e)&&t.treeAdapter.getNamespaceURI(e)===r.NS.HTML&&s.has(t.treeAdapter.getTagName(e))}const c={treeAdapter:o.defaultTreeAdapter,scriptingEnabled:!0};function l(e,t){let n="";const i=t.treeAdapter.isElementNode(e)&&t.treeAdapter.getTagName(e)===r.TAG_NAMES.TEMPLATE&&t.treeAdapter.getNamespaceURI(e)===r.NS.HTML?t.treeAdapter.getTemplateContent(e):e,o=t.treeAdapter.getChildNodes(i);if(o)for(const e of o)n+=u(e,t);return n}function u(e,t){return t.treeAdapter.isElementNode(e)?function(e,t){const n=t.treeAdapter.getTagName(e);return`<${n}${function(e,{treeAdapter:t}){let n="";for(const o of t.getAttrList(e)){if(n+=" ",o.namespace)switch(o.namespace){case r.NS.XML:n+=`xml:${o.name}`;break;case r.NS.XMLNS:"xmlns"!==o.name&&(n+="xmlns:"),n+=o.name;break;case r.NS.XLINK:n+=`xlink:${o.name}`;break;default:n+=`${o.prefix}:${o.name}`}else n+=o.name;n+=`="${(0,i.escapeAttribute)(o.value)}"`}return n}(e,t)}>${a(e,t)?"":`${l(e,t)}</${n}>`}`}(e,t):t.treeAdapter.isTextNode(e)?function(e,t){const{treeAdapter:n}=t,o=n.getTextNodeContent(e),s=n.getParentNode(e),a=s&&n.isElementNode(s)&&n.getTagName(s);return a&&n.getNamespaceURI(s)===r.NS.HTML&&(0,r.hasUnescapedText)(a,t.scriptingEnabled)?o:(0,i.escapeText)(o)}(e,t):t.treeAdapter.isCommentNode(e)?function(e,{treeAdapter:t}){return`\x3c!--${t.getCommentNodeContent(e)}--\x3e`}(e,t):t.treeAdapter.isDocumentTypeNode(e)?function(e,{treeAdapter:t}){return`<!DOCTYPE ${t.getDocumentTypeNodeName(e)}>`}(e,t):""}t.serialize=function(e,t){const n=Object.assign(Object.assign({},c),t);return a(e,n)?"":l(e,n)},t.serializeOuter=function(e,t){return u(e,Object.assign(Object.assign({},c),t))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adapter=t.serializeDoctypeContent=void 0;const r=n(1194),i=n(155);function o(e){return new i.Text(e)}function s(e){const t=e.includes('"')?"'":'"';return t+e+t}function a(e,t,n){let r="!DOCTYPE ";return e&&(r+=e),t?r+=` PUBLIC ${s(t)}`:n&&(r+=" SYSTEM"),n&&(r+=` ${s(n)}`),r}t.serializeDoctypeContent=a,t.adapter={isCommentNode:i.isComment,isElementNode:i.isTag,isTextNode:i.isText,createDocument(){const e=new i.Document([]);return e["x-mode"]=r.html.DOCUMENT_MODE.NO_QUIRKS,e},createDocumentFragment:()=>new i.Document([]),createElement(e,t,n){const r=Object.create(null),o=Object.create(null),s=Object.create(null);for(let e=0;e<n.length;e++){const t=n[e].name;r[t]=n[e].value,o[t]=n[e].namespace,s[t]=n[e].prefix}const a=new i.Element(e,r,[]);return a.namespace=t,a["x-attribsNamespace"]=o,a["x-attribsPrefix"]=s,a},createCommentNode:e=>new i.Comment(e),appendChild(e,t){const n=e.children[e.children.length-1];n&&(n.next=t,t.prev=n),e.children.push(t),t.parent=e},insertBefore(e,t,n){const r=e.children.indexOf(n),{prev:i}=n;i&&(i.next=t,t.prev=i),n.prev=t,t.next=n,e.children.splice(r,0,t),t.parent=e},setTemplateContent(e,n){t.adapter.appendChild(e,n)},getTemplateContent:e=>e.children[0],setDocumentType(e,n,r,o){const s=a(n,r,o);let c=e.children.find((e=>(0,i.isDirective)(e)&&"!doctype"===e.name));c?c.data=null!=s?s:null:(c=new i.ProcessingInstruction("!doctype",s),t.adapter.appendChild(e,c)),c["x-name"]=null!=n?n:void 0,c["x-publicId"]=null!=r?r:void 0,c["x-systemId"]=null!=o?o:void 0},setDocumentMode(e,t){e["x-mode"]=t},getDocumentMode:e=>e["x-mode"],detachNode(e){if(e.parent){const t=e.parent.children.indexOf(e),{prev:n,next:r}=e;e.prev=null,e.next=null,n&&(n.next=r),r&&(r.prev=n),e.parent.children.splice(t,1),e.parent=null}},insertText(e,n){const r=e.children[e.children.length-1];r&&(0,i.isText)(r)?r.data+=n:t.adapter.appendChild(e,o(n))},insertTextBefore(e,n,r){const s=e.children[e.children.indexOf(r)-1];s&&(0,i.isText)(s)?s.data+=n:t.adapter.insertBefore(e,o(n),r)},adoptAttributes(e,t){for(let n=0;n<t.length;n++){const r=t[n].name;void 0===e.attribs[r]&&(e.attribs[r]=t[n].value,e["x-attribsNamespace"][r]=t[n].namespace,e["x-attribsPrefix"][r]=t[n].prefix)}},getFirstChild:e=>e.children[0],getChildNodes:e=>e.children,getParentNode:e=>e.parent,getAttrList:e=>e.attributes,getTagName:e=>e.name,getNamespaceURI:e=>e.namespace,getTextNodeContent:e=>e.data,getCommentNodeContent:e=>e.data,getDocumentTypeNodeName(e){var t;return null!==(t=e["x-name"])&&void 0!==t?t:""},getDocumentTypeNodePublicId(e){var t;return null!==(t=e["x-publicId"])&&void 0!==t?t:""},getDocumentTypeNodeSystemId(e){var t;return null!==(t=e["x-systemId"])&&void 0!==t?t:""},isDocumentTypeNode:e=>(0,i.isDirective)(e)&&"!doctype"===e.name,setNodeSourceCodeLocation(e,t){t&&(e.startIndex=t.startOffset,e.endIndex=t.endOffset),e.sourceCodeLocation=t},getNodeSourceCodeLocation:e=>e.sourceCodeLocation,updateNodeSourceCodeLocation(e,t){null!=t.endOffset&&(e.endIndex=t.endOffset),e.sourceCodeLocation=Object.assign(Object.assign({},e.sourceCodeLocation),t)}}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.render=void 0;var a=s(n(1371)),c=n(731),l=n(1372),u=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function d(e){return e.replace(/"/g,"&quot;")}var h=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function f(e,t){void 0===t&&(t={});for(var n=("length"in e?e:[e]),r="",i=0;i<n.length;i++)r+=p(n[i],t);return r}function p(e,t){switch(e.type){case a.Root:return f(e.children,t);case a.Doctype:case a.Directive:return"<".concat(e.data,">");case a.Comment:return function(e){return"\x3c!--".concat(e.data,"--\x3e")}(e);case a.CDATA:return function(e){return"<![CDATA[".concat(e.children[0].data,"]]>")}(e);case a.Script:case a.Style:case a.Tag:return function(e,t){var n;"foreign"===t.xmlMode&&(e.name=null!==(n=l.elementNames.get(e.name))&&void 0!==n?n:e.name,e.parent&&g.has(e.parent.name)&&(t=r(r({},t),{xmlMode:!1})));!t.xmlMode&&m.has(e.name)&&(t=r(r({},t),{xmlMode:"foreign"}));var i="<".concat(e.name),o=function(e,t){var n;if(e){var r=!1===(null!==(n=t.encodeEntities)&&void 0!==n?n:t.decodeEntities)?d:t.xmlMode||"utf8"!==t.encodeEntities?c.encodeXML:c.escapeAttribute;return Object.keys(e).map((function(n){var i,o,s=null!==(i=e[n])&&void 0!==i?i:"";return"foreign"===t.xmlMode&&(n=null!==(o=l.attributeNames.get(n))&&void 0!==o?o:n),t.emptyAttrs||t.xmlMode||""!==s?"".concat(n,'="').concat(r(s),'"'):n})).join(" ")}}(e.attribs,t);o&&(i+=" ".concat(o));0===e.children.length&&(t.xmlMode?!1!==t.selfClosingTags:t.selfClosingTags&&h.has(e.name))?(t.xmlMode||(i+=" "),i+="/>"):(i+=">",e.children.length>0&&(i+=f(e.children,t)),!t.xmlMode&&h.has(e.name)||(i+="</".concat(e.name,">")));return i}(e,t);case a.Text:return function(e,t){var n,r=e.data||"";!1===(null!==(n=t.encodeEntities)&&void 0!==n?n:t.decodeEntities)||!t.xmlMode&&e.parent&&u.has(e.parent.name)||(r=t.xmlMode||"utf8"!==t.encodeEntities?(0,c.encodeXML)(r):(0,c.escapeText)(r));return r}(e,t)}}t.render=f,t.default=f;var g=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),m=new Set(["svg","math"])},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Doctype=t.CDATA=t.Tag=t.Style=t.Script=t.Comment=t.Directive=t.Text=t.Root=t.isTag=t.ElementType=void 0,function(e){e.Root="root",e.Text="text",e.Directive="directive",e.Comment="comment",e.Script="script",e.Style="style",e.Tag="tag",e.CDATA="cdata",e.Doctype="doctype"}(r=t.ElementType||(t.ElementType={})),t.isTag=function(e){return e.type===r.Tag||e.type===r.Script||e.type===r.Style},t.Root=r.Root,t.Text=r.Text,t.Directive=r.Directive,t.Comment=r.Comment,t.Script=r.Script,t.Style=r.Style,t.Tag=r.Tag,t.CDATA=r.CDATA,t.Doctype=r.Doctype},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attributeNames=t.elementNames=void 0,t.elementNames=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map((function(e){return[e.toLowerCase(),e]}))),t.attributeNames=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map((function(e){return[e.toLowerCase(),e]})))},function(e,t){e.exports=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}},function(e,t,n){var r=n(785);e.exports=function(e,t){var n=!0;return r(e,(function(e,r,i){return n=!!t(e,r,i)})),n}},function(e,t,n){var r=n(1376),i=n(203),o=/[&<>"']/g,s=RegExp(o.source);e.exports=function(e){return(e=i(e))&&s.test(e)?e.replace(o,r):e}},function(e,t,n){var r=n(1174)({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});e.exports=r},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(693),i=n(874),o=n(30),s=n(201);class a{constructor(e,t){this.app=e,this._delegate=t,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(e,t){return Object(i.c)(this._delegate,e,t)}httpsCallableFromURL(e,t){return Object(i.d)(this._delegate,e,t)}useFunctionsEmulator(e){const t=e.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(null==t)throw new o.FirebaseError("functions","No origin provided to useFunctionsEmulator()");if(null==t[2])throw new o.FirebaseError("functions","Port missing in origin provided to useFunctionsEmulator()");return Object(i.a)(this._delegate,t[1],Number(t[2]))}useEmulator(e,t){return Object(i.a)(this._delegate,e,t)}}const c=(e,{instanceIdentifier:t})=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("functions").getImmediate({identifier:null!=t?t:"us-central1"});return new a(n,r)};!function(){const e={Functions:a};r.a.INTERNAL.registerComponent(new s.Component("functions-compat",c,"PUBLIC").setServiceProps(e).setMultipleInstances(!0))}(),r.a.registerVersion("@firebase/functions-compat","0.3.10")},function(e,t,n){"use strict";var r=n(693),i=n(282),o=n(201);class s{constructor(e,t,n){this._delegate=e,this.task=t,this.ref=n}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class a{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new s(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then((t=>{if(e)return e(new s(t,this,this._ref))}),t)}on(e,t,n,r){let i;return t&&(i="function"==typeof t?e=>t(new s(e,this,this._ref)):{next:t.next?e=>t.next(new s(e,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,i,n||void 0,r||void 0)}}class c{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map((e=>new l(e,this._service)))}get items(){return this._delegate.items.map((e=>new l(e,this._service)))}get nextPageToken(){return this._delegate.nextPageToken||null}}class l{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=Object(i.h)(this._delegate,e);return new l(t,this.storage)}get root(){return new l(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new l(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new a(Object(i.u)(this._delegate,e,t),this)}putString(e,t=i.a.RAW,n){this._throwIfRoot("putString");const r=Object(i.g)(t,e),o=Object.assign({},n);return null==o.contentType&&null!=r.contentType&&(o.contentType=r.contentType),new a(new i.f(this._delegate,new i.b(r.data,!0),o),this)}listAll(){return Object(i.q)(this._delegate).then((e=>new c(e,this.storage)))}list(e){return Object(i.p)(this._delegate,e||void 0).then((e=>new c(e,this.storage)))}getMetadata(){return Object(i.n)(this._delegate)}updateMetadata(e){return Object(i.s)(this._delegate,e)}getDownloadURL(){return Object(i.m)(this._delegate)}delete(){return this._throwIfRoot("delete"),Object(i.l)(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw Object(i.j)(e)}}class u{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(d(e))throw Object(i.i)("ref() expected a child path but got a URL, use refFromURL instead.");return new l(Object(i.r)(this._delegate,e),this)}refFromURL(e){if(!d(e))throw Object(i.i)("refFromURL() expected a full URL but got a child path, use ref() instead.");try{i.c.makeFromUrl(e,this._delegate.host)}catch(e){throw Object(i.i)("refFromUrl() expected a valid full URL but got an invalid one.")}return new l(Object(i.r)(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,n={}){Object(i.k)(this._delegate,e,t,n)}}function d(e){return/^[A-Za-z]+:\/\//.test(e)}function h(e,{instanceIdentifier:t}){const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("storage").getImmediate({identifier:t});return new u(n,r)}!function(e){const t={TaskState:i.e,TaskEvent:i.d,StringFormat:i.a,Storage:u,Reference:l};e.INTERNAL.registerComponent(new o.Component("storage-compat",h,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),e.registerVersion("@firebase/storage-compat","0.3.7")}(r.a)}]);