const e={1:"monday",2:"tuesday",3:"wednesday",4:"thursday",5:"friday",6:"saturday",7:"sunday"},t={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"};var _=[];function a(e,t,_,a){0==$(`#${e}`).length&&$(`.${a}`).append(n(`<label id="${e}" class='${_}'>${t}</label>`))}function n(e){return e.replace(/__MSG_(\w+)__/g,(function(e,t){return t?_[t]?.message:""}))}(async()=>{let r=await chrome.storage.local.get("user_language");if(r){r.user_language=void 0===r.user_language?"en":r.user_language;var s=await fetch(`../../_locales/${r.user_language}/messages.json`),l=await s.json();_=l}!function(){for(var e=$(".popup-main"),t=0;t<e.length;t++){var _=e[t],a=_.innerHTML.toString(),r=n(a);r!=a&&(_.innerHTML=r)}}(),await async function(){let _=await chrome.tabs.query({active:!0,currentWindow:!0});""!==_[0]?.url&&($("#current_tab_url").val(_[0].url),$("#current_scheduled_tab").val(_[0].url));var r=await chrome.storage.local.get(["scheduled_timer","dark_mode_tb","inactive_all_tab","user_language"]);"pt_BR"==r.user_language&&(r.user_language="pt");r.user_language=r.user_language.replace("_","-"),1==r?.dark_mode_tb&&$("body").addClass("dark-mode");var s=await chrome.alarms.getAll(),l=(r.open_tab_data,r.userdata,r.scheduled_timer);_[0].url.replace(/(^\w+:|^)\/\//,"");s.forEach((s=>{1==r.inactive_all_tab&&l&&l.forEach(((l,o)=>{let i=!1;l?.isExtraScheduled&&(i=l.isExtraScheduled);var c=""!==l.title&&void 0!==l.title?`<div class="content_wrap"><b>__MSG_title__</b>: ${l.title}</div>`:"",m=""!==l.description&&void 0!==l.description?`<div class="content_wrap"><b>__MSG_description__</b>: ${l.description}</div>`:"";l.tab_status,l.tab_status;var p=l.url_name.replace(/(^\w+:|^)\/\//,"");let u=l?.open_date+"T"+l?.open_time+":00",d=l?.close_date+"T"+l?.close_time+":00",b=new Date,$=new Date,h=new Date,g="",y="",w=new Date,v=w.getDate(),M=w.getMonth()+1,f=w.getFullYear();l?.open_date&&(b=new Date(u),g=new Intl.DateTimeFormat(r.user_language,t).format(b).split("GMT")[0]),""!==l?.close_date&&($=new Date(d),y=new Intl.DateTimeFormat(r.user_language,t).format($).split("GMT")[0]),h=new Intl.DateTimeFormat(r.user_language,t).format(h).split("GMT")[0];let G="-",S="-";if("none"===l?.timer_repeat)G=""!==g&&h<=g?`__MSG_tabWillOpenOneTime__ <b>${g}</b>`:"-",S=""!==y&&h<=y?`__MSG_tabCloseOneTime__ <b>${y}</b>`:"-";else if("1_min"===l?.timer_repeat)G="__MSG_openInEvery__ <b>__MSG_1_min__</b>",S="__MSG_closeInEvery__ <b>__MSG_1_min__</b>";else if("5_min"===l?.timer_repeat)G="__MSG_openInEvery__ <b>__MSG_5_min__</b>",S="__MSG_closeInEvery__ <b>__MSG_5_min__</b>";else if("10_min"===l?.timer_repeat)G="__MSG_openInEvery__ <b>__MSG_10_min__</b>",S="__MSG_closeInEvery__ <b>__MSG_10_min__</b>";else if("30_min"===l?.timer_repeat)G="__MSG_openInEvery__ <b>__MSG_30_min__</b>",S="__MSG_closeInEvery__ <b>__MSG_30_min__</b>";else if("60_min"===l?.timer_repeat)G="__MSG_openInEvery__ <b>__MSG_60_min__</b>",S="__MSG_closeInEvery__ <b>__MSG_60_min__</b>";else if("day"===l?.timer_repeat)l?.open_time&&(b=new Date(`${f}-${M<10?"0":""}${M}-${v<10?"0":""}${v}T${l?.open_time}:00`),g=new Intl.DateTimeFormat(r.user_language,t).format(b).split("GMT")[0],G=`__MSG_openEveryDayOn__ <b>${g}</b>`),l?.close_time&&($=new Date(`${f}-${M<10?"0":""}${M}-${v<10?"0":""}${v}T${l?.close_time}:00`),y=new Intl.DateTimeFormat(r.user_language,t).format($).split("GMT")[0],S=`__MSG_closeOnEveryDay__ <b>${y}</b>.`);else if("weekly"===l.timer_repeat){var I=l.open_weekday.week_list.map((t=>{var _=parseInt(t.split("_")[0]);return n(`__MSG_${e[_]}__`)}));I.length>0&&l?.open_time&&(b=new Date(`${f}-${M<10?"0":""}${M}-${v<10?"0":""}${v}T${l?.open_time}:00`),g=new Intl.DateTimeFormat(r.user_language,t).format(b).split("GMT")[0].split("at")[1],G=`__MSG_openEveryWeekOn__ <b>${I.length>1?I.join(", "):I[0]} __MSG_at__ ${g}</b>`);var T=l.close_weekday.week_list.map((t=>{var _=parseInt(t.split("_")[0]);return n(`__MSG_${e[_]}__`)}));T.length>0&&l?.close_time&&(b=new Date(`${f}-${M<10?"0":""}${M}-${v<10?"0":""}${v}T${l?.close_time}:00`),g=new Intl.DateTimeFormat(r.user_language,t).format(b).split("GMT")[0].split("at")[1],S=`__MSG_closeOnEveryWeek__ <b>${T.length>1?T.join(", "):T[0]} __MSG_at__ ${g}</b>`)}else if("month"===l?.timer_repeat)""!==l.open_month_day&&""!==l?.open_time&&(b=new Date(`${f}-${M<10?"0":""}${M}-${l.open_month_day<10?"0":""}${l.open_month_day}T${l?.open_time}:00`),g=new Intl.DateTimeFormat(r.user_language,t).format(b).split("GMT")[0],G=`__MSG_openEveryMonthOn__ <b>${l.open_month_day} __MSG_at__ ${g}</b>`),l.close_month_day&&""!==l?.close_time&&(b=new Date(`${f}-${M<10?"0":""}${M}-${l.close_month_day<10?"0":""}${l.close_month_day}T${l?.close_time}:00`),g=new Intl.DateTimeFormat(r.user_language,t).format(b).split("GMT")[0],S=`__MSG_closeOnEveryMonth__ <b>${l.close_month_day} __MSG_at__ ${g}</b>`);else if("year"===l?.timer_repeat)""!==g&&(G=`__MSG_openEveryYearOn__ <b>${g.replace(/, \d{4} at/,",")}</b>`),""!==y&&(S=`__MSG_closeEveryYear__ <b>${y.replace(/, \d{4} at/,",")}</b>`);else if("custom_minute"===l?.timer_repeat)l.custom_open_minute&&(G=`__MSG_openOnEvery__ <b>${l.custom_open_minute} __MSG_minute__ </b>`),l.custom_close_minute&&(S=`__MSG_closeOnEvery__ <b>${l.custom_close_minute} minute</b>`);else if("custom_second"===l?.timer_repeat)l.custom_open_second&&(G=`__MSG_openOnEvery__ <b>${l.custom_open_second} __MSG_second__ </b>`),l.custom_close_second&&(S=`__MSG_closeOnEvery__ <b>${l.custom_close_second} second</b>`);else if("browser_open"===l?.timer_repeat){var E=l.browser_open.week_list.map((t=>{var _=parseInt(t.split("_")[0]);return n(`__MSG_${e[_]}__`)}));G=`__MSG_tabWillOpenWhenBrowserOpen__ <b>${E.length>1?E.join(", "):E[0]}</b>`}i||"close"===l?.schedule_type||("-"!==G&&"weekly"!==l.timer_repeat&&"opentab_"+l.id+"_"+l.timer_repeat==s.name&&1===parseInt(l.tab_status)&&_[0].url?.replace(/\/$/,"").replace(/(^\w+:|^)\/\//,"")==p?.replace(/\/$/,"")&&1===parseInt(l.tab_status)?a(`opentab_${l.id}`,`${G} ${c}  ${m}`,"opentab_schedule","open-tab"):("browser_open"===l.timer_repeat||"close"!==l?.schedule_type&&"weekly"===l.timer_repeat&&s.name.indexOf("weekly")>=0&&s.name.indexOf("opentab")>=0&&l.open_weekday.week_id==s.name?.split("_")[1])&&1===parseInt(l.tab_status)&&_[0].url?.replace(/\/$/,"").replace(/(^\w+:|^)\/\//,"")==p?.replace(/\/$/,"")&&"-"!==G&&a(`opentab_${l.id}`,`${G} ${c} ${m}`,"opentab_schedule","open-tab"));var k=p.slice(-1),D=_[0].url.replace(/(^\w+:|^)\/\//,""),O=!1,x=l.url_filter;if(p.startsWith("*")&&"*"===k)p=(p=p.replace(/\*$/,"")).substring(1),D.indexOf(p)>-1&&(O=!0);else if("*"===k){p=(p=p.replace(/\*$/,"")).replace(/\/$/,""),D.slice(0,-1).replace(/\/$/,"")===p&&1===parseInt(l.tab_status)&&(O=!0)}else if(p.startsWith("*")){D=D.replace(/\/$/,""),p=p.replace(/\/$/,""),D.substr(D.length-(p.length-1)).replace(/\/$/,"")===p.substr(p.length-(p.length-1))&&1===parseInt(l.tab_status)&&(O=!0)}else 1==parseInt(x)&&1==parseInt(l.tab_status)?(p=(p=p.replace(/\*$/,"")).substring(1),D.indexOf(p)>-1&&1===parseInt(l.tab_status)&&(O=!0)):D.replace(/\/$/,"")==p.replace(/\/$/,"")&&1===parseInt(l.tab_status)&&(O=!0);return(1!==parseInt(l?.not_close_pinned_tab)||1!=_[0].pinned)&&((1!==parseInt(l?.close_only_incognito_tab)||0!=_[0]?.incognito)&&void(i||"open"===l?.schedule_type||(l?.timer_repeat&&"weekly"!==l?.timer_repeat&&"open"!==l?.schedule_type&&-1==l?.timer_repeat.indexOf("opentab")&&l.id==s.name.split("_")[1]&&1===parseInt(l.tab_status)&&D.replace(/\/$/,"")==p.replace(/\/$/,"")||"weekly"!==l?.timer_repeat&&O?"-"!==S&&a(`tabclose_${l.id}`,S,"tabclose_schedule","close-tab"):("weekly"===l?.timer_repeat&&"open"!==l?.schedule_type&&-1==l?.timer_repeat.indexOf("opentab")&&1===parseInt(l.tab_status)&&l.close_weekday.week_id==s.name?.split("_")[1]&&D.replace(/\/$/,"")==p.replace(/\/$/,"")||O)&&"-"!==S&&a(`tabclose_${l.id}`,S,"tabclose_schedule","close-tab"))))}))})),l&&0===s.length&&1==r.enable_disable_all_open_url&&$(".schedule_tabs").hide();0===$(".opentab_schedule").length&&0===$(".tabclose_schedule").length&&$(".schedule_tabs").hide();0===$(".opentab_schedule").length&&$(".open-tab").hide();0===$(".tabclose_schedule").length&&$(".close-tab").hide()}(),$(".tab-main-content").removeClass("hide"),$("body").removeClass("loading")})(),$(document).on("click","#open_setting",(function(e){chrome.tabs.query({},(function(e){var t=!1;let _=chrome.runtime.id;for(var a=0;a<e.length;a++)if(e[a]?.url.indexOf(`chrome-extension://${_}/src/html/tab_settings.html`)>-1){chrome.windows.update(e[a].windowId,{focused:!0}),chrome.tabs.update(e[a].id,{active:!0},(e=>{})),t=!0;break}t||chrome.tabs.create({url:`chrome-extension://${_}/src/html/tab_settings.html`,active:!0},(function(e){}))}))})),$(document).on("click","#set_schedule_tab",(function(e){e.preventDefault(),e.stopImmediatePropagation(),chrome.tabs.query({},(function(e){var t=!1;let _=chrome.runtime.id,a=$("#current_tab_url").val();a||(a="");for(var n=0;n<e.length;n++)if(e[n]?.url.indexOf(`chrome-extension://${_}/src/html/tab_settings.html`)>-1){chrome.runtime.sendMessage({action:"add_url",url:a},(function(t){chrome.runtime.lastError,chrome.windows.update(e[n].windowId,{focused:!0}),chrome.tabs.update(e[n].id,{active:!0},(e=>{}))})),t=!0;break}t||chrome.tabs.create({url:`chrome-extension://${_}/src/html/tab_settings.html`,active:!1},(function(e){chrome.tabs.onUpdated.addListener((function(t,_,n){t===e.id&&"complete"===_.status&&(chrome.runtime.sendMessage({action:"add_url",url:a},(function(t){chrome.runtime.lastError,setTimeout((()=>{chrome.tabs.update(e.id,{active:!0},(e=>{}))}),200)})),chrome.tabs.onUpdated.removeListener())}))}))}))}));